(window.webpackJsonp=window.webpackJsonp||[]).push([[109],{1128:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(11),o=n(2),c=n(3),l=(n(60),n(24)),d=n(18),v=n(1075),f=new d.a("observerDirective"),h=function(){function e(){Object(o.a)(this,e),this.refreshOnUpdate=!1}var t;return Object(c.a)(e,[{key:"bind",value:(t=Object(r.a)(regeneratorRuntime.mark((function e(t,n){var r,o,c,d,h,y;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.default.nextTick();case 2:this.refreshOnUpdate="undefined"!==(null===(r=null==n?void 0:n.value)||void 0===r?void 0:r.refreshOnUpdate)&&(null===(o=null==n?void 0:n.value)||void 0===o?void 0:o.refreshOnUpdate),this.observer=new v.a({data:null===(c=null==n?void 0:n.value)||void 0===c?void 0:c.data,rootMargin:(null===(d=null==n?void 0:n.value)||void 0===d?void 0:d.rootMargin)||"0px 0px -100% 0px",el:t,threshold:(null===(h=null==n?void 0:n.value)||void 0===h?void 0:h.threshold)||0,singleIntersection:(null===(y=null==n?void 0:n.value)||void 0===y?void 0:y.singleIntersection)||!1},(function(data){var e;f.log(data);var t=null===(e=null==n?void 0:n.value)||void 0===e?void 0:e.handler;t?t(data):f.warn("No handler specified on Intersection Observer directive")}));case 4:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"update",value:function(){this.observer&&this.refreshOnUpdate&&this.observer.refresh()}},{key:"componentUpdated",value:function(){this.observer&&this.refreshOnUpdate&&this.observer.refresh()}},{key:"unbind",value:function(){this.observer&&this.observer.destroy()}}]),e}()},2012:function(e,t,n){"use strict";n.r(t);n(13);var r=n(11),o=n(16),c=n(2),l=n(3),d=n(7),v=n(10),f=n(4),h=(n(60),n(19),n(8),n(0)),y=n(1069),O=n(65),m=n(70),x=n(51);function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var o=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(v.a)(this,n)}}var P=function(e){Object(d.a)(n,e);var t=j(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).services=["tagular"],r}return Object(l.a)(n,[{key:"defaults",get:function(){return{"@type":"core.InfinitePageScrolled.v1",isInfiniteScroll:!0}}}]),n}(n(97).a);P=Object(h.c)([Object(O.a)(x.a.Transient),Object(h.g)(0,m.a),Object(h.f)("design:paramtypes",[Object])],P);n(21),n(14),n(20),n(25),n(17),n(26);var k=n(5),w=(n(87),n(1071)),$=n(1128);function R(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function S(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?R(Object(source),!0).forEach((function(t){Object(k.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):R(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var o=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(v.a)(this,n)}}var I=new(n(18).a)("SeamlessTriggers"),T=function(e){Object(d.a)(n,e);var t=_(n);function n(){var e;return Object(c.a)(this,n),(e=t.apply(this,arguments)).requested=!1,e}return Object(l.a)(n,[{key:"config",get:function(){return this.$seamless.config}},{key:"requestObserverOptions",get:function(){var e,t;return S({handler:this.requestPage,data:{index:this.index}},(null===(t=null===(e=this.config)||void 0===e?void 0:e.intersectionObservers)||void 0===t?void 0:t.request)||{})}},{key:"enterObserverOptions",get:function(){var e,t;return S({handler:this.enterPage,data:{index:this.index}},(null===(t=null===(e=this.config)||void 0===e?void 0:e.intersectionObservers)||void 0===t?void 0:t.enter)||{})}},{key:"requestPage",value:function(e){var data=e.data,t=e.direction;if("down"===t&&!this.requested){I.log("requestPage",t,data);try{this.$emit("seamless-insert-page",data.index,this.$seamless.requestPage({data:data,direction:t})),this.requested=!0}catch(e){I.error(e)}}}},{key:"enterPage",value:function(e){var data=e.data,t=e.direction;I.log("enterPage",t,data),this.$emit("seamless-enter-page",{data:data,direction:t})}}]),n}(y.Vue);Object(h.c)([Object(y.Prop)({default:!1,required:!0}),Object(h.f)("design:type",Number)],T.prototype,"index",void 0);var D=T=Object(h.c)([y.Component,Object(w.a)("intersection-observer",$.a)],T),B=n(166),C=Object(B.a)(D,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"c-seamlessTriggers"},[t("div",{directives:[{name:"intersection-observer",rawName:"v-intersection-observer",value:e.requestObserverOptions,expression:"requestObserverOptions"}]}),e._v(" "),t("div",{directives:[{name:"intersection-observer",rawName:"v-intersection-observer",value:e.enterObserverOptions,expression:"enterObserverOptions"}]})])}),[],!1,null,null,null).exports,U=n(100),M=n(1293);function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var o=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(v.a)(this,n)}}var F=function(e){Object(d.a)(h,e);var t,n,v,f=E(h);function h(){var e;return Object(c.a)(this,h),(e=f.apply(this,arguments)).pages=[],e.currentParentPage=null,e.listing=null,e.pageRequestPromises=[],e.loading=!1,e}return Object(l.a)(h,[{key:"getPages",value:function(){var e,t=(null===(e=this.$refs)||void 0===e?void 0:e.pages)?this.$refs.pages:[];return[this.currentParentPage].concat(Object(o.a)(t))}},{key:"getPageByIndex",value:function(e){var t;return(null===(t=this.getPages())||void 0===t?void 0:t[e])||null}},{key:"routeChange",value:function(){this.cleanup()}},{key:"beforeDestroy",value:function(){this.cleanup(),this.$nuxt.$off("pageMounted")}},{key:"beforeMount",value:function(){var e=this;this.$nuxt.$on("pageMounted",(function(t){e.currentParentPage=t,e.initializeSeamless()}))}},{key:"initializeSeamless",value:(v=Object(r.a)(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.$services.isFeatureEnabled("seamless")){e.next=3;break}return U.a.warn("Seamless is disabled"),e.abrupt("return");case 3:return this.$seamless.createSeamlessMeta(this.$meta()),e.next=6,this.$seamless.requestSeamlessListing(null===(t=this.currentParentPage)||void 0===t?void 0:t.content);case 6:if(e.t1=n=e.sent,e.t0=null===e.t1,e.t0){e.next=10;break}e.t0=void 0===n;case 10:if(!e.t0){e.next=14;break}e.t2=void 0,e.next=15;break;case 14:e.t2=n.items;case 15:this.listing=e.t2;case 16:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)})},{key:"enterPage",value:(n=Object(r.a)(regeneratorRuntime.mark((function e(t){var data,n,r,o,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return data=t.data,n=t.direction,U.a.log("waiting for page to be requested and inserted"),e.prev=2,e.next=5,this.pageRequestPromises[data.index];case 5:e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(2),U.a.error(e.t0),e.abrupt("return");case 11:U.a.log("enterPage",data,n),r="down"===n?data.index+1:data.index,o=this.getPageByIndex(r),c="down"===n?data.index-1:data.index+1,l=this.getPageByIndex(c),U.a.log("previousPage",l),l&&l.removeAds(),this.$seamless.enterPage(o,l,{data:data,direction:n}),this.$nuxt.$emit("seamless-enter",o);case 20:case"end":return e.stop()}}),e,this,[[2,7]])}))),function(e){return n.apply(this,arguments)})},{key:"preInsertPage",value:function(e,t){var n=this;this.loading=!0;try{this.pageRequestPromises[e]=new Promise((function(r,o){t.then((function(t){var o;if(!(null===(o=null==t?void 0:t.content)||void 0===o?void 0:o.content))throw new Error("no content found on page");n.insertPage(t.content,e,t.pageTypeConfig).then(r),n.loading=!1}))}))}catch(e){U.a.error(e),this.loading=!1}}},{key:"insertPage",value:(t=Object(r.a)(regeneratorRuntime.mark((function e(content,t,n){var component;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.component();case 2:return component=(component=e.sent).extend({data:function(){return{content:content}},beforeCreate:function(){try{this.$options.asyncData(this.$nuxt.context,content)}catch(e){U.a.error("error calling 'asyncData' for page with slug: '".concat(content.id,"'"),e)}}}),this.$config.ads.adDisplay.delayLoad=!0,this.$nuxt.$meta().pause(),this.pages.push(component),e.next=9,this.$nextTick();case 9:try{this.$refs.pages[t]?U.a.log("inserted page: '".concat(content.pageType,"' with slug: '").concat(content.id,"'")):(this.pages.pop(),U.a.warn("could not find a reference to a page at index ".concat(t)))}catch(e){U.a.error("error getting page reference for slug: '".concat(content.id,"'"),e)}case 10:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})},{key:"trackScroll",value:function(e,t){var n,r,o,c,l;if(this.$services.isFeatureEnabled("seamless")){U.a.log("Firing Cohesion scroll event",e,null===(n=null==t?void 0:t.data)||void 0===n?void 0:n.index),this.$track(P).with({scrollDistance:e,pageIndex:null===(r=null==t?void 0:t.data)||void 0===r?void 0:r.index}).fire();var content=null===(l=null===(c=this.getPageByIndex(null===(o=null==t?void 0:t.data)||void 0===o?void 0:o.index))||void 0===c?void 0:c.content)||void 0===l?void 0:l.content;this.$nuxt.$emit("track-scroll",e,content)}else U.a.log("Not firing scroll events, seamless is disabled")}},{key:"cleanup",value:function(){this.$config.ads.adDisplay.delayLoad=!1,this.pages=[],this.pageRequestPromises=[],this.listing=null,this.$store.commit("page/clearSeamless"),this.$nuxt.$meta().resume()}}]),h}(y.Vue);Object(h.c)([Object(y.Watch)("$route"),Object(h.f)("design:type",Function),Object(h.f)("design:paramtypes",[]),Object(h.f)("design:returntype",void 0)],F.prototype,"routeChange",null);var N=F=Object(h.c)([Object(y.Component)({components:{SeamlessTriggers:C,TrackScroll:M.a}})],F),L=Object(B.a)(N,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"c-seamlessListing"},[t("TrackScroll",{attrs:{"tracking-data":{index:0}},on:{"scroll-change":e.trackScroll}},[e._t("default")],2),e._v(" "),e.listing?[t("SeamlessTriggers",{attrs:{index:0},on:{"seamless-insert-page":e.preInsertPage,"seamless-enter-page":e.enterPage}}),e._v(" "),e._l(e.pages,(function(n,r){return[t("TrackScroll",{key:n.slug,attrs:{"tracking-data":{index:r+1}},on:{"scroll-change":e.trackScroll}},[t(n,{ref:"pages",refInFor:!0,tag:"component",attrs:{"is-seamless":!0}})],1),e._v(" "),r<e.listing.length-1?t("SeamlessTriggers",{key:n.slug,attrs:{index:r+1},on:{"seamless-insert-page":e.preInsertPage,"seamless-enter-page":e.enterPage}}):e._e()]}))]:e._e(),e._v(" "),e.loading?e._t("loader"):e._e()],2)}),[],!1,null,null,null);t.default=L.exports}}]);
//# sourceMappingURL=0401078.js.map
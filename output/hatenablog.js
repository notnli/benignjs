(()=>{var e,t={59391:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var n,i=r(67294);function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a.apply(this,arguments)}const o=e=>i.createElement("svg",a({id:"uuid-a3d02a3c-84ce-4deb-88f3-9fe361e6cdff",xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",className:"blogicon"},e),n||(n=i.createElement("g",{id:"uuid-e678194b-13dd-4749-b434-7211fcc2838f"},i.createElement("path",{d:"m13.1,15.9h-7.6c-2.3-1.5-3.6-3.9-3.6-6.5C2,5.3,5.3,1.9,9.5,1.9s7.5,3.4,7.5,7.5-1.3,5-3.6,6.4h-.2Zm-6.8-2h6.2c1.5-1,2.4-2.7,2.4-4.5,0-3-2.5-5.5-5.5-5.5s-5.5,2.5-5.5,5.5.9,3.5,2.4,4.5Z"}),i.createElement("rect",{x:5.9,y:16.9,width:7.1,height:2}),i.createElement("path",{d:"m7.5,19.9s0,0,0,0c0,1.1.9,2,2,2s2-.9,2-2,0,0,0,0h-4Z"}),i.createElement("polygon",{points:"21.4 11.9 20.7 10.2 19 9.4 20.7 8.7 21.4 7 22.2 8.7 23.9 9.4 22.2 10.2 21.4 11.9"}),i.createElement("polygon",{points:"19 6.9 18 4.9 16 3.9 18 3 19 .9 19.9 3 21.9 3.9 19.9 4.9 19 6.9"}))))},26694:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var n,i=r(67294);function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a.apply(this,arguments)}const o=e=>i.createElement("svg",a({id:"uuid-1cb0eb6c-1fe4-4fa6-b17b-0a533ccdf48a",xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",className:"blogicon"},e),i.createElement("g",{id:"uuid-b89be65d-1f4d-41b3-ba8b-f0a1749d1998"},i.createElement("rect",{width:24,height:24,style:{fill:"none"}}),n||(n=i.createElement("path",{d:"M12,20c-.6,0-1-.2-1.4-.6-.4-.4-.6-.9-.6-1.4s.2-1,.6-1.4c.4-.4,.9-.6,1.4-.6s1,.2,1.4,.6c.4,.4,.6,.9,.6,1.4s-.2,1-.6,1.4c-.4,.4-.9,.6-1.4,.6Zm0-6c-.6,0-1-.2-1.4-.6-.4-.4-.6-.9-.6-1.4s.2-1,.6-1.4c.4-.4,.9-.6,1.4-.6s1,.2,1.4,.6c.4,.4,.6,.9,.6,1.4s-.2,1-.6,1.4c-.4,.4-.9,.6-1.4,.6Zm0-6c-.6,0-1-.2-1.4-.6-.4-.4-.6-.9-.6-1.4s.2-1,.6-1.4c.4-.4,.9-.6,1.4-.6s1,.2,1.4,.6,.6,.9,.6,1.4-.2,1-.6,1.4c-.4,.4-.9,.6-1.4,.6Z"}))))},33813:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var n,i,a,o,s=r(67294);function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},l.apply(this,arguments)}const d=e=>s.createElement("svg",l({xmlns:"http://www.w3.org/2000/svg",width:64,height:64,viewBox:"0 0 64 64",className:"blogicon"},e),n||(n=s.createElement("path",{d:"M50,22.1V10.2a4.1,4.1,0,0,0-4.3-4.3H18.2A3.9,3.9,0,0,0,14,10.1V22.3L5.7,27.5V54.3A4.1,4.1,0,0,0,10,58.7H54.4a3.9,3.9,0,0,0,4.2-4.2v-27Zm2.7,5.2L50,28.8V25.6ZM18.2,8.9H45.7c.9,0,1.3.4,1.3,1.3V30.6L32.4,39.1l-.2.2a.3.3,0,0,1-.4,0L17,30.6V10.1C17,9.1,17.3,8.9,18.2,8.9ZM14,28.9l-2.5-1.5L14,25.8ZM55.6,54.5c0,.8-.1,1.2-1.2,1.2H10c-.9,0-1.3-.4-1.3-1.4V29.2L29.9,41.6a3.2,3.2,0,0,0,2.1.8,3.4,3.4,0,0,0,2.1-.8L55.5,29.1h.1Z"})),i||(i=s.createElement("rect",{x:23.8,y:13.8,width:16.7,height:3})),a||(a=s.createElement("rect",{x:23.8,y:21.4,width:16.7,height:3})),o||(o=s.createElement("rect",{x:23.8,y:29.2,width:16.7,height:3})))},91298:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AccessLogViewer=void 0;var n=a(r(65311)),i=a(r(20996));function a(e){return e&&e.__esModule?e:{default:e}}class o{constructor(e,t){this.data=this.generateData(e,t.unit,t.number),this.$parent=t.parent,this.$parent.css({width:this.$parent.parent().width()-(t.graphAreaMarginRight||50),height:+this.$parent.attr("data-graph-height")}).show(),this.graph=this.plot(t.barWidth,t.minTickSize,t.timeformat),this.$tooltip=this.$parent.find(".tooltip"),0===this.$tooltip.length&&(this.$tooltip=(0,n.default)('<div class="tooltip"></div>'),this.$tooltip.appendTo(this.$parent).hide()),this.$parent.on("plothover",this.onMouseOver.bind(this))}generateData(e,t,r){const n=Math.floor((new Date).getTime()/t)*t+t,i=n-t*r,a=60*(new Date).getTimezoneOffset()*1e3,o=[];let s=0;for(let r=i;r<=n;r+=9e5){s+=e[r]||0;const n=r-a;n%t==0&&(o.push([n-t,s]),s=0)}return o}plot(e,t,r){return n.default.plot(this.$parent,[{label:"",data:this.data,bars:{show:!0,lineWidth:e||15},legend:{show:!1}}],{xaxis:{mode:"time",minTickSize:t,timeformat:r},yaxis:{min:0,minTickSize:1,autoscaleMargin:.5,labelWidth:+this.$parent.attr("data-yaxis-width"),tickFormatter:e=>i.default.formatNumber(e)},grid:{axisMargin:5,labelMargin:5,minBorderMargin:0,borderWidth:1,borderColor:"#CCCCCC",hoverable:!0}})}onMouseOver(e,t){const r=this.graph.getAxes();if(t.x<r.xaxis.min||t.x>r.xaxis.max)return;if(t.y<r.yaxis.min||t.y>r.yaxis.max)return;const n=this.graph.getData()[0],a=((e,t)=>{let r;for(r=0;r<e.length;r++)if(t(e[r]))return r;return r})(n.data,(e=>e[0]>t.x)),o=n.data[a-1],s=n.data[a];if(!o&&!s)return;const l=o?s?t.x-o[0]<s[0]-t.x?o:s:o:s;this.showTooltip(r.xaxis.p2c(l[0]),r.yaxis.p2c(l[1]),i.default.formatNumber(l[1]))}showTooltip(e,t,r){this.$tooltip.css({position:"absolute",top:t-25,left:e+13}).text(r).show()}static showGraph(e,t){return new o(e,t)}}t.AccessLogViewer=o},12886:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BackupData=t.Backup=void 0;var n=d(r(65311)),i=d(r(10646)),a=d(r(66419)),o=r(70879),s=d(r(57942)),l=d(r(1606));function d(e){return e&&e.__esModule?e:{default:e}}function u(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class c{constructor(e){this.id=e.id,this.data=e.data,this.modified=e.modified}toJSON(){return{id:this.id,data:this.data,modified:this.modified}}}t.BackupData=c;t.Backup=class{constructor(e){u(this,"localStorageKey","backup"),u(this,"formDataBeforeRestore",""),this.$form=e,this.localStorageEnabled()&&((0,n.default)(document).on("clearBackup",this.clearBackup.bind(this)),this.deletePreviousBackup())}watch(){if(this.timer)return;const e=this.localStorageEnabled()?3e3:9e3,t=1e3*+this.$form.attr("data-backup-interval")||e;this.timer=window.setInterval((()=>this.save()),t)}localStorageEnabled(){let e=!1;try{e=window.localStorage&&"user-blog-config-design-detail"!==(0,s.default)("page")}catch(e){}return e}clearBackup(){localStorage.removeItem(this.localStorageKey)}deletePreviousBackup(){i.default.get("clear_backup")&&(localStorage.removeItem(this.localStorageKey),i.default.remove("clear_backup",{path:"/"}))}load(){const e=this.$form.attr("data-backup-id");this.$form.data("backup",this.serialize());const t=n.default.Deferred();return a.default.defer((()=>{let r;try{const e=localStorage.getItem(this.localStorageKey);if(e){const t=JSON.parse(e);r=new c(t)}}catch(e){}if(!r||r.id!==e)return void t.reject();const n=new Date(1e3*+r.modified);(new Date).getTime()-n.getTime()>36e5?t.reject():((0,o.LOG)(["backup.load",r]),t.resolve(r))})),t.promise()}save(e){const t=this.$form.attr("data-backup-id"),r=this.$form.data("backup"),n=this.serialize();if(r===n&&!e)return;this.$form.trigger("backup-presave"),this.$form.data("backup",n);const i=Math.floor((new Date).getTime()/1e3),a=new c({id:t,data:n,modified:i});localStorage.setItem(this.localStorageKey,JSON.stringify(a)),(0,o.LOG)(["backup.save",a]),this.$form.trigger("backup-save")}serialize(){const e=[],t=this.$form.find('input[type="text"], textarea, input[data-with-backup], input[type="hidden"].backup, input[type="radio"].backup, input[type="checkbox"].backup-button');return a.default.each(t,(t=>{const r=t;r.name&&("radio"!==r.type||r.checked)&&("checkbox"!==r.type||r.checked?e.push({name:r.name,value:r.value}):e.push({name:r.name,value:0}))})),a.default.each(this.$form.find("select"),(t=>{const r=t,i=(0,n.default)(r);if(null!==r.getAttribute("data-without-backup"))return;const a=i.find("option:selected");0!==a.length&&e.push({name:r.name,value:(0,n.default)(a[0]).val()})})),n.default.param(e)}restoreBackup(e){(0,o.LOG)("restore backup"),this.formDataBeforeRestore=this.serialize(),this.assignData(e)}clearRestore(){(0,o.LOG)("clear restore"),this.assignData(this.formDataBeforeRestore)}assignData(e){const t=(0,l.default)(e);for(const e in t)Object.prototype.hasOwnProperty.call(t,e)&&"category"!==e&&this.$form.find(`input[name="${e}"], textarea[name="${e}"]`).val(t[e]);this.$form.data("backup",e),this.$form.trigger("backup-restore",e),this.$form.trigger("backup-restore-params",[t])}}},54793:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BackupMessage=void 0;var n,i=(n=r(65311))&&n.__esModule?n:{default:n},a=r(12886);t.BackupMessage=class{constructor(e,t,r){this.$form=e,this.$editarea=t,this.editor=r,this.model=new a.Backup(e),this.restore(),this.model.watch()}restore(){let e;return this.model.load().then((t=>{if(e=t,e)return this.shouldAutoRestore()?(this.promptAutoRestored(e),!0):this.promptRestore(e)})).then((()=>{e&&this.model.restoreBackup(e.data)})).always((()=>{this.editor&&this.editor.emit("resizeRequired")}))}shouldAutoRestore(){return!1}promptRestore(e){const t=i.default.Deferred();return t.reject(),t}promptAutoRestored(e){}}},36080:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BackupMessagePC=void 0;var n=o(r(65311)),i=o(r(20996)),a=r(54793);function o(e){return e&&e.__esModule?e:{default:e}}class s extends a.BackupMessage{constructor(e,t,r){super(e,t,r),this.editor&&this.editor.on("saveDraft",(()=>{this.model.deletePreviousBackup()})),this.initMessage()}initMessage(){this.$message=(0,n.default)('<div class="backup-message" style="display: none; margin-buttom: -1px;" />'),this.$closeButton=(0,n.default)(`<button type="button" class="backup-message-close" aria-label="${i.default.text("close")}"><i class="blogicon-close"></i></button>`),this.$editarea&&(this.$message.append(this.$closeButton).insertBefore(this.$editarea),this.height=this.$message.outerHeight()-(parseInt(this.$message.css("border-width"),10)||1),this.$form.data("backup-message",this.$message),this.$form.on("backup-presave",(()=>this.closeMessage())),this.$closeButton.on("click",(()=>this.closeMessage())),(0,n.default)("#editor-main .ui-tabs").on("tabsactivate",((e,t)=>{this.$message&&("ui-id-1"===t.newPanel.attr("aria-labelledby")?this.$message.show():this.$message.hide())})))}closeMessage(){this.$message&&this.editor&&(this.$message.remove(),this.editor.emit("resizeRequired"))}shouldAutoRestore(){const e=new RegExp("user/blog/edit-\\d+-new").test(this.$form.attr("data-backup-id")),t=this.$form.find(':input[name="title"]'),r=t[0]&&0===t.val().length,n=this.$form.find(':input[name="body"]'),i=n[0]&&0===n.val().length;return e&&r&&i}promptRestore(e){const t=new Date(1e3*+e.modified),r=n.default.Deferred(),a=i.default.text("backup.notice",`<time data-relative data-epoch="${t.getTime()}"></time>`),o=(0,n.default)(`<a href="javascript:void(0)">(${i.default.text("backup.restore")})</a>`);return this.$message?(this.$message.prepend(a,o).show(),i.default.updateTimestamps(this.$message[0]),o.on("click",(()=>{r.resolve(),this.closeMessage()})),r.promise()):r.promise()}promptAutoRestored(e){const t=new Date(1e3*+e.modified),r=i.default.text("backup.notice.auto_restored",`<time data-relative data-epoch="${t.getTime()}"></time>`),a=(0,n.default)(`<a href="javascript:void(0)">(${i.default.text("backup.clear_restore")})</a>`);this.$message&&(this.$message.prepend(r,a).show(),i.default.updateTimestamps(this.$message[0]),a.on("click",(()=>{this.model.clearRestore(),this.closeMessage()})))}}t.BackupMessagePC=s},53266:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BackupMessageTouch=void 0;var n=o(r(65311)),i=o(r(20996)),a=r(54793);function o(e){return e&&e.__esModule?e:{default:e}}class s extends a.BackupMessage{shouldAutoRestore(){return!1}constructor(e){super(e,void 0,void 0)}promptRestore(e){const t=n.default.Deferred(),r=new Date(1e3*+e.modified);return window.confirm(i.default.text("backup.notice.ask_restore",r))&&t.resolve(),t.promise()}promptAutoRestored(){}}t.BackupMessageTouch=s},50287:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createBackupMessage=function(e,t,r){return"pc"===a.device()&&t&&r?new n.BackupMessagePC(e,t,r):new i.BackupMessageTouch(e)};var n=r(36080),i=r(53266);const a=r(56412)},55248:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BlogPermission=void 0;var n,i=(n=r(65311))&&n.__esModule?n:{default:n};t.BlogPermission=class{constructor(e){this.$element=e,this.$authconfigs=this.$element.find(".permission-authconfigs"),this.$newAuthconfig=this.$element.find("#new-authconfig"),this.$authconfigSelect=this.$element.find("#viewable-id-select"),this.$customConfigs=this.$element.find("#permission-custom-viewable-id"),this.$newCustomConfig=this.$element.find(".authconfig-detail-new"),this.$checkboxes=this.$element.find('[name = "permission"]'),this.$customCheckbox=this.$element.find("#permission-custom"),this.$publicCheckbox=this.$element.find("#permission-public"),this.$inputOverlay=this.$element.find(".config-private-overlay"),this.initEvents()}initEvents(){this.$newAuthconfig.on("click",(()=>{this.$element.find("#create-authconfig").submit()})),this.$authconfigSelect.on("change",(e=>{const t=(0,i.default)(e.currentTarget).find("option:selected").attr("data-ac");this.$authconfigs.find(".authconfig-detail").addClass("hide"),this.$authconfigs.find(`.${t}`).removeClass("hide")})).change(),this.$checkboxes.on("change",(()=>{this.$publicCheckbox.prop("checked")?this.$inputOverlay.show():this.$inputOverlay.hide(),this.customAuthConfigExists()?this.$customCheckbox.prop("checked")?this.$customConfigs.show():this.$customConfigs.hide():(this.$customConfigs.show(),this.$newCustomConfig.show())})).change()}customAuthConfigExists(){return!this.$customCheckbox.attr("disabled")}}},10788:(e,t,r)=>{"use strict";var n=r(86544).Rule,i=r(57180).s;e.exports=class extends i{constructor(e){super(e),this.isEditingNewRule=!0}isEditing(){return!!this.editingRule}canSetPageType(){return!0}canSetCategory(){return this.mayHaveCategory()}startEdit(){this.editingRule=new n("all",null,[])}save(){this.startEdit()}revert(){this.editingRule=null}canDestroy(){return!1}asDefaultEditor(){return new n(this.editingRule)}}},86544:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Rule=void 0;const n=r(66419);class i{constructor(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.pageType=e,this.category=t,this.items=r,this.isEditable=n}getItemsWithFilledLength(e){const t=[...this.items];return n.times(e-t.length,(()=>t.push({}))),t}getItemsForEdit(e){const t=this.getItemsWithFilledLength(e),r=t[t.length-1]||{};return(0===t.length||r.label||r.uri)&&t.push({}),t}getItemsLength(){return this.items.length}getItemsLengthForEdit(){const e=this.items,t=e[e.length-1];return 0===e.length||t.label||t.uri?e.length+1:e.length}equals(e){return this.pageType===e.pageType&&this.category===e.category&&n.isEqual(this.items,e.items)}clone(){return new i(this.pageType,this.category,[...this.items])}pageTypePretty(){return this.pageType}setPageType(e){this.pageType=e}setCategory(e){this.category=e}canSetCategory(){return n.include(["entry","category"],this.pageType)}setItemLabel(e,t){n.times(e-this.items.length+1,(()=>this.items.push({}))),this.items[e].label=t,this._trimItems()}setItemURI(e,t){n.times(e-this.items.length+1,(()=>this.items.push({}))),this.items[e].uri=t,this._trimItems()}_trimItems(){const e=this.items;let t=e[e.length-1];for(;t&&!t.label&&!t.uri;)e.pop(),t=e[e.length-1]}}t.Rule=i},57180:(e,t,r)=>{"use strict";t.s=void 0;var n=r(86544);function i(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class a{constructor(e){this.rule=e,this.editingRule=null,this.id=a.generateId()}canSetPageType(){return!1}canSetCategory(){return!1}mayHaveCategory(){return(this.isEditing()?this.editingRule:this.rule).canSetCategory()}isEditing(){return this.editingRule instanceof n.Rule}startEdit(){this.editingRule=this.rule.clone()}save(){this.isEditing()&&(this.rule=this.editingRule,this.revert())}revert(){this.editingRule=null}getItemsLength(){return this.isEditing()?this.editingRule.getItemsLengthForEdit():this.rule.getItemsLength()}}t.s=a,i(a,"editorId",0),i(a,"generateId",(()=>"RuleEditor-"+a.editorId++))},44188:(e,t,r)=>{"use strict";var n,i=(n=r(57942))&&n.__esModule?n:{default:n};var a=r(65311),o=r(17187).EventEmitter,s=r(37914),l=r(86544).Rule;e.exports=new class extends o{loadRules(){a.ajax({url:"rules.json",data:{spreadsheet_uri:s.param("spreadsheet_uri")},dataType:"json"}).done((e=>{const t=_.map(e,(e=>new l(e.pageType,e.category,e.items,e.isEditable)));this.emit("rulesLoaded",t)}))}startEdit(e){this.emit("startEdit",e)}revert(e){this.emit("revert",e)}create(e){this.postEditingRule("rules/register.json",e.editingRule).done((e=>{const t=_.map(e,(e=>new l(e.pageType,e.category,e.items,e.isEditable)));this.emit("rulesLoaded",t)})).fail((()=>{alert("error")}))}save(e){this.postEditingRule("rules/register.json",e.editingRule).done((e=>{const t=_.map(e,(e=>new l(e.pageType,e.category,e.items,e.isEditable)));this.emit("rulesLoaded",t)})).fail((()=>{alert("error")}))}destroy(e){this.postEditingRule("rules/delete.json",e.rule).done((()=>{this.emit("destroy",e),this.loadRules()})).fail((()=>{alert("error")}))}postEditingRule(e,t){return a.ajax({url:e,method:"POST",data:{page_type:t.pageType,category:t.category,items:JSON.stringify(t.items),rkm:(0,i.default)("rkm"),rkc:(0,i.default)("rkc")},dataType:"json",cache:!1})}setPageType(e,t){this.emit("setPageType",e,t)}setCategory(e,t){this.emit("setCategory",e,t)}setItemLabel(e,t,r){this.emit("setItemLabel",e,t,r)}setItemURI(e,t,r){this.emit("setItemURI",e,t,r)}}},21407:(e,t,r)=>{"use strict";var n=r(66419),i=r(17187).EventEmitter,a=r(44188),o=r(57180).s,s=r(10788);e.exports=new class extends i{constructor(){super(),this.currentEditor=null,this.ruleEditors=[],this.newRuleEditor=new s,a.on("rulesLoaded",(e=>{this.currentEditor=null;const t=e.map((e=>new o(e)));this.setEditors(t),this.emit("change")})),a.on("startEdit",(e=>{this.currentEditor=e,e.startEdit(),this.emit("change")})),a.on("revert",(e=>{this.currentEditor=null,e.revert(),this.emit("change")})),a.on("destroy",(e=>{const t=n.reject(this.ruleEditors,(t=>e===t));this.setEditors(t),this.emit("change")})),a.on("setPageType",((e,t)=>{e.editingRule.setPageType(t),this.emit("change")})),a.on("setCategory",((e,t)=>{e.editingRule.setCategory(t),this.emit("change")})),a.on("setItemLabel",((e,t,r)=>{e.editingRule.setItemLabel(t,r),this.emit("change")})),a.on("setItemURI",((e,t,r)=>{e.editingRule.setItemURI(t,r),this.emit("change")}))}initialize(){a.loadRules()}setEditors(e){this.ruleEditors=e}getState(){return{currentEditor:this.currentEditor,ruleEditors:this.ruleEditors,newRuleEditor:this.newRuleEditor,itemsLength:this.getItemsLength()}}getItemsLength(){const e=this.ruleEditors.map((e=>e.getItemsLength()));return e.push(1),Math.max(...e)}}},71124:(e,t,r)=>{"use strict";var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),a=(n=r(20996))&&n.__esModule?n:{default:n};function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}const s=r(44188);class l extends i.Component{render(){return i.createElement("div",{className:"item-editor"},i.createElement("h4",{className:"item-title"},a.default.text("admin.breadcrumbs.breadcrumbs_item"),this.props.itemIndex+1),i.createElement("div",{className:"item-input"},i.createElement("span",{className:"label-container"},i.createElement("input",{type:"text",placeholder:a.default.text("admin.breadcrumbs.labels"),value:this.props.label,list:"labels",onChange:e=>this.onLabelChanged(e)})),i.createElement("span",{className:"uri-container"},i.createElement("input",{type:"text",placeholder:"URL",value:this.props.uri,list:"uris",onChange:e=>this.onURIChanged(e)}))))}onLabelChanged(e){s.setItemLabel(this.props.editor,this.props.itemIndex,e.target.value)}onURIChanged(e){s.setItemURI(this.props.editor,this.props.itemIndex,e.target.value)}}!function(e,t,r){(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(l,"defaultProps",{label:"",uri:""}),e.exports=l},7623:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RuleEditorPanel=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),a=(n=r(20996))&&n.__esModule?n:{default:n};function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}const s=r(44188),l=r(71124);class d extends i.Component{render(){return i.createElement("div",{className:"rule-editor-panel"},i.createElement("div",{className:"rule-editor-panel-inner"},i.createElement("div",{className:"rule-editor-panel-header"},i.createElement("h1",null,a.default.text("admin.breadcrumbs.breadcrumbs_add")),i.createElement("span",null,i.createElement("a",{href:"",onClick:e=>this.onRevertClicked(e),className:"rule-editor-panel-close-btn"},i.createElement("i",{className:"blogicon-close"})))),i.createElement("div",{className:"rule-editor-panel-embed"},i.createElement("table",{className:"table"},i.createElement("tbody",null,i.createElement("tr",null,i.createElement("th",null,a.default.text("admin.breadcrumbs.page_type")),i.createElement("td",null,this.renderPageType(),i.createElement("p",null,a.default.text("admin.breadcrumbs.breadcrumbs_rule_page_type_tip")))),this.renderCategoryRow(),i.createElement("tr",null,i.createElement("th",null,a.default.text("admin.breadcrumbs.breadcrumbs_rule")),i.createElement("td",null,this.renderRules(),i.createElement("p",{className:"breadcrumb-rules-discription"},a.default.text("admin.breadcrumbs.breadcrumbs_rule_tip"))))))),i.createElement("div",{className:"rule-editor-panel-submit"},i.createElement("input",{type:"submit",value:a.default.text("save"),onClick:e=>this.onSaveClicked(e),className:"save btn btn-primary"}))))}renderPageType(){const e=this.props.editor;if(!e)return null;const t=e.editingRule;return!!t&&(e.canSetPageType()?i.createElement("div",{className:"page-type editing"},i.createElement("select",{value:t.pageType,onChange:e=>this.onPageTypeChanged(e)},i.createElement("option",{value:"all"},"all"),i.createElement("option",{value:"category"},"category"),i.createElement("option",{value:"entry"},"entry"),i.createElement("option",{value:"index"},"index"),i.createElement("option",{value:"archive"},"archive"))):i.createElement("div",{className:"page-type"},t.pageTypePretty()))}renderCategoryRow(){const e=this.props.editor;return e?e.mayHaveCategory()?i.createElement("tr",null,i.createElement("th",null,a.default.text("admin.breadcrumbs.categories")),i.createElement("td",null,this.renderCategory())):void 0:null}renderCategory(){const e=this.props.editor;if(!e)return null;const t=e.editingRule;return!!t&&(e.canSetCategory()?[i.createElement("div",{className:"category editing",key:1},i.createElement("input",{type:"text",placeholder:"Category",value:t.category||"",onChange:e=>this.onCategoryChanged(e)})),i.createElement("p",{key:2},a.default.text("admin.breadcrumbs.breadcrumbs_category_discription"))]:[i.createElement("div",{className:"category",key:1},t.category||a.default.text("none"))])}renderRules(){const e=this.props.editor;if(!e)return null;const t=e.editingRule;if(!t)return!1;return t.getItemsForEdit(this.props.itemsLength).map(((e,t)=>i.createElement(l,{key:t,label:e.label,uri:e.uri,editor:this.props.editor,itemIndex:t})))}onPageTypeChanged(e){s.setPageType(this.props.editor,e.target.value)}onCategoryChanged(e){s.setCategory(this.props.editor,e.target.value)}onSaveClicked(e){e.preventDefault();const t=this.props.editor;t&&("isEditingNewRule"in t?s.create(this.props.editor):s.save(this.props.editor))}onRevertClicked(e){e.preventDefault(),s.revert(this.props.editor)}}t.RuleEditorPanel=d},42713:(e,t,r)=>{"use strict";var n,i=l(r(67294)),a=l(r(55992)),o=(n=r(20996))&&n.__esModule?n:{default:n};function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}function l(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}return n.default=e,r&&r.set(e,n),n}const d=r(66419),u=r(44188);class c extends i.Component{startEdit(){u.startEdit(this.props.editor)}render(){return i.createElement("tr",{className:"rule-row"},i.createElement("th",{className:"page-type"},this.renderPageType()),i.createElement("td",null,this.renderItems()),i.createElement("td",{className:"btn-container"},this.renderEditButton(),this.renderDeleteButton()))}renderEditButton(){return this.props.editor.rule.isEditable?i.createElement("button",{type:"button",onClick:()=>this.startEdit(),className:"edit"},o.default.text("admin.breadcrumbs.edit")):null}renderDeleteButton(){return this.props.editor.rule.isEditable?i.createElement("button",{type:"button",onClick:()=>this.onDeleteClicked(),className:"delete"},o.default.text("admin.breadcrumbs.delete")):null}renderPageType(){const e=this.props.editor.rule;return i.createElement("span",null,i.createElement("span",{className:"type"},e.pageTypePretty()),this.renderCategory())}renderItems(){const e=this.props.editor.rule.items.map(((e,t)=>e.label?[i.createElement("span",{className:"label",key:"label-"+t},this.renderLink(e)),i.createElement("span",{className:"label-slash",key:"label-slash-"+t},">")]:[i.createElement("span",{className:"empty-item",key:"empty-item-"+t})])),t=d.flatten(e);return t.pop(),t}renderCategory(){const e=this.props.editor.rule;if(e.canSetCategory())return i.createElement("span",{className:"category"},i.createElement("span",{className:"category-text"},o.default.text("admin.breadcrumbs.categories")," "),e.category||o.default.text("none"))}formatLabel(e){return e?e.match(/^:/)?i.createElement("i",null,e):i.createElement("b",null,e):e}renderLink(e){if(!e.uri)return this.formatLabel(e.label);if(e.uri.match(/^:/))return i.createElement("a",{href:"#",title:e.uri},this.formatLabel(e.label));const t="/"===e.uri[0]?a.userBlogUrl(e.uri):e.uri;return i.createElement("a",{href:t},this.formatLabel(e.label))}onDeleteClicked(){window.confirm(o.default.text("admin.breadcrumbs.breadcrumbs_rule_delete_confirm"))&&u.destroy(this.props.editor)}}e.exports=c},20967:(e,t,r)=>{"use strict";var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),a=(n=r(20996))&&n.__esModule?n:{default:n},o=r(7623);function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}const l=r(83253),d=r(44188),u=r(21407),c=r(42713);class p extends i.Component{constructor(e){super(e),this.state=u.getState(),this.updateState=this._updateState.bind(this),this.onModalOverlayClicked=this._onModalOverlayClicked.bind(this)}componentDidMount(){u.on("change",this.updateState)}componentWillUnmount(){u.removeListener("change",this.updateState)}_updateState(){const e=u.getState();this.setState(e)}isModalOpen(){return null!=this.state.currentEditor&&this.state.currentEditor.isEditing()}render(){return i.createElement("div",null,i.createElement("table",{className:"rules-table"},i.createElement("thead",null,this.renderHeader()),i.createElement("tbody",null,this.renderRules())),i.createElement("div",null,i.createElement("button",{type:"submit",className:"create btn btn-primary",onClick:e=>this.onCreateClicked()},a.default.text("admin.breadcrumbs.breadcrumbs_add")),i.createElement(l,{contentLabel:a.default.text("admin.breadcrumbs.breadcrumbs_edit"),isOpen:this.isModalOpen(),onRequestClose:this.onModalOverlayClicked,className:"rule-editor-panel-modal",overlayClassName:"rule-editor-panel-overlay"},i.createElement(o.RuleEditorPanel,{editor:this.state.currentEditor,itemsLength:this.state.itemsLength}))))}renderHeader(){return i.createElement("tr",{className:"header"},i.createElement("th",{className:"page-type"},a.default.text("admin.breadcrumbs.page_type")),i.createElement("th",{className:"items"},a.default.text("admin.breadcrumbs.breadcrumbs_preview")),i.createElement("th",{className:"buttons"}))}renderRules(){return this.state.ruleEditors.map((e=>i.createElement(c,{editor:e,itemsLength:this.state.itemsLength,key:e.id})))}onCreateClicked(){d.startEdit(this.state.newRuleEditor)}_onModalOverlayClicked(){d.revert(this.state.currentEditor)}}e.exports=p},52841:(e,t,r)=>{"use strict";var n=r(67294),i=r(73935),a=r(20967),o=r(21407),s={init:function(e){o.initialize(),i.render(n.createElement(a,null),e)}};e.exports=s},50968:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initComments=void 0;var n=a(r(65311)),i=a(r(20996));function a(e){return e&&e.__esModule?e:{default:e}}t.initComments=()=>{const e=(0,n.default)('button[name="mode"][value="delete"]'),t=(0,n.default)(":submit"),r=(0,n.default)(".js-delete-entries-button"),a=(0,n.default)('input[name="comment"]');e.on("click",(()=>confirm(i.default.text("admin.comments.delete.confirm"))));const o=()=>{const e=a.is(":checked");t.prop("disabled",!e),t.toggleClass("disabled",!e),r.toggleClass("btn-danger",e)};a.on("change",o),o()}},68160:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=l(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),a=(n=r(20996))&&n.__esModule?n:{default:n},o=r(8617),s=r(58144);function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(l=function(e){return e?r:t})(e)}var d=e=>{const t=e.blog;return i.createElement("div",{className:"blog-host"},i.createElement("div",{className:"blog-meta-wrapper"},i.createElement(s.BlogVisibilityMeta,{blog:t}),i.createElement(o.BlogOwnerMeta,{blog:t}),i.createElement("div",{className:"blog-meta-item blog-meta-item-uri"},i.createElement("a",{href:t.uri,title:a.default.text("admin.view_blog")},t.uri))))};t.default=d},8617:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BlogOwnerMeta=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),a=(n=r(20996))&&n.__esModule?n:{default:n};function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}t.BlogOwnerMeta=e=>{let{blog:{is_mine:t,owner:r}}=e;return t?null:i.createElement("span",{className:"blog-meta-item"},i.createElement("i",{className:"blogicon-user","data-testid":"blogicon-user"}),a.default.text("admin.blog.members.owner"),": ",i.createElement("a",{href:r.primary_blog_url},r.user_name))}},58144:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BlogVisibilityMeta=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),a=(n=r(20996))&&n.__esModule?n:{default:n};function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}t.BlogVisibilityMeta=e=>{let{blog:{is_public:t}}=e;return t?i.createElement("span",{className:"blog-meta-item"},i.createElement("i",{className:"blogicon-public","data-testid":"blogicon-public"})," ",a.default.text("admin.permission.public")):i.createElement("span",{className:"blog-meta-item"},i.createElement("i",{className:"blogicon-private","data-testid":"blogicon-private"})," ",a.default.text("blog.permission.private"))}},41241:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),a=(n=r(20996))&&n.__esModule?n:{default:n};function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}var s=e=>i.createElement("div",{className:"myblog-config-icon-link"},i.createElement("a",{href:e.blog.path_admin.config,title:a.default.text("admin.edit_delete"),"data-testid":"myblog-config-icon-link"},i.createElement("i",{className:"blogicon-setting"})));t.default=s},19449:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=i(t);if(r&&r.has(e))return r.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=a?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,r&&r.set(e,n);return n}(r(67294));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(i=function(e){return e?r:t})(e)}class a extends n.Component{render(){const e="myblog-box-handle "+(this.props.draggable?"is-open":"");return n.createElement("div",{className:e},n.createElement("div",{className:"myblog-box-handle-reorder"}))}}var o=a;t.default=o},33876:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),a=(n=r(20996))&&n.__esModule?n:{default:n},o=r(3437);function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}function l(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class d extends i.PureComponent{constructor(e){super(e),l(this,"dropdownContainer",null),this.state={isOpen:!1,menuItemsProps:[]}}componentDidMount(){document.addEventListener("click",(e=>this.forceCloseDropdownMenu(e)),!1),this.generateMenuItemProps()}componentWillUnmount(){document.removeEventListener("click",(e=>this.forceCloseDropdownMenu(e)),!1)}render(){const e=this.state.isOpen,t=this.menuItems();return i.createElement("div",{className:"myblog-box-setting-dropdown dropdown-window-wrapper",ref:e=>{this.dropdownContainer=e}},i.createElement("button",{type:"submit",className:"myblog-box-subcontent-btn dropdown-window-wrapper",title:a.default.text("admin.myblog.subcontent.detail"),onClick:e=>this.toggleDropdownMenu(e)},i.createElement(o.IconMoreVertical,null)),i.createElement("div",{className:"myblog-box-setting-dropdown-window dropdown-window "+(e?"is-open":""),"data-testid":"dropdown-window"},i.createElement("ul",{className:"list"},t)))}generateMenuItemProps(){const e=this.props.blog,t=[];e.privilege.can_visit_entries&&t.push({href:e.path_admin.entries,iconClassName:"blogicon-entry",key:"entries",label:a.default.text("admin.entries")}),e.privilege.can_visit_accesslog&&t.push({href:e.path_admin.accesslog,iconClassName:"blogicon-analytics",key:"accesslog",label:a.default.text("admin.accesslog")}),e.privilege.can_configure_setting&&t.push({href:e.path_admin.config,iconClassName:"blogicon-setting",key:"setting",label:a.default.text("settings")}),e.privilege.can_edit_design&&t.push({href:e.path_admin.config_design,iconClassName:"blogicon-design",key:"design",label:a.default.text("design")}),e.privilege.can_set_as_primary_blog&&!e.is_primary&&t.push({href:e.path_admin.primary,iconClassName:null,key:"change-primary",label:a.default.text("epic.change_primary")}),this.setState({menuItemsProps:t})}toggleDropdownMenu(e){e.stopPropagation(),e.preventDefault(),this.setState({isOpen:!this.state.isOpen})}forceCloseDropdownMenu(e){this.dropdownContainer&&!this.dropdownContainer.contains(e.target)&&this.setState({isOpen:!1})}menuItems(){return this.state.menuItemsProps.map((e=>i.createElement("li",{key:e.key},i.createElement("a",{href:e.href,"data-testid":e.key},e.iconClassName?i.createElement("i",{className:e.iconClassName}):null," ",e.label))))}}var u=d;t.default=u},86548:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),i=o(r(41241)),a=o(r(10793));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}class l extends n.Component{render(){const e=this.props.blog;return n.createElement("div",{className:"myblog-blog-icon"},n.createElement("a",{href:e.path_admin.root},n.createElement("img",{src:e.icon_url,alt:e.name})),e.is_mine?null:n.createElement(a.default,{owner:e.owner}),e.privilege.can_configure_setting?n.createElement(i.default,{blog:e}):null)}}var d=l;t.default=d},3437:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IconMoreVertical=void 0;var n=a(r(26694)),i=a(r(67294));function a(e){return e&&e.__esModule?e:{default:e}}t.IconMoreVertical=()=>i.default.createElement(n.default,null)},77158:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),a=(n=r(68160))&&n.__esModule?n:{default:n};function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}class s extends i.Component{render(){const e=this.props.blog;return i.createElement("div",{className:"myblog-box-content"},i.createElement("div",{className:"blog-name-wrapper"},i.createElement("a",{href:e.path_admin.root,className:"blog-name","data-blog-id":e.uuid},e.name)),i.createElement(a.default,{blog:e}))}}var l=s;t.default=l},52695:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=d(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),i=l(r(86548)),a=l(r(77158)),o=r(29784),s=l(r(77765));function l(e){return e&&e.__esModule?e:{default:e}}function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(d=function(e){return e?r:t})(e)}class u extends n.Component{render(){const{blog:e,draggable:t}=this.props;return n.createElement("div",{className:"myblog-box","data-blog-id":e.uuid},n.createElement(i.default,{blog:e}),n.createElement(a.default,{blog:e}),n.createElement(s.default,{blog:e}),n.createElement(o.SortableDragHandle,{draggable:t}))}}var c=u;t.default=c},46754:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=p(r(67294)),i=r(94027),a=u(r(57942)),o=p(r(55992)),s=u(r(20996)),l=u(r(26845)),d=r(37845);function u(e){return e&&e.__esModule?e:{default:e}}function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(c=function(e){return e?r:t})(e)}function p(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=c(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}return n.default=e,r&&r.set(e,n),n}const f=r(26307).default;class h extends n.Component{constructor(e){super(e),this.state={blogs:[...e.blogs],draggable:!1}}render(){const e={className:this.state.draggable?"btn btn-primary":"btn",label:this.state.draggable?s.default.text("admin.myblogs.draghandle.hide"):s.default.text("admin.myblogs.draghandle.show")},t=this.props.shouldLinkToBlogmediaRegistrationForm?o.httpsAdminUrl("/register/blog_media?via=200131"):o.httpsAdminUrl("/register?via=200131");return n.createElement("div",null,n.createElement("div",{className:"main-header"},n.createElement("h1",null,s.default.text("admin.my_blogs"))),this.renderBlogsListOrNotice(),n.createElement("div",{className:"myblog-operations"},n.createElement("a",{href:t,className:"myblog-create-btn","data-testid":"myblog-create-link"},n.createElement("i",{className:"blogicon-add"})," ",s.default.text("create_new_blog")),this.state.blogs.length>1?n.createElement("button",{type:"submit","data-testid":"myblog-create-btn",className:e.className,onClick:()=>{this.toggleDraggable()}},e.label):null))}renderBlogsListOrNotice(){return 0===this.state.blogs.length?n.createElement("div",{className:"alert-box"},s.default.text("admin.myblog.no_blog")):n.createElement(d.SortableBlogList,{blogs:this.state.blogs,draggable:this.state.draggable,onSortStart:()=>{this.onSortStart()},onSortEnd:e=>{this.onSortEnd(e)},useDragHandle:!0})}toggleDraggable(){const{draggable:e}=this.state;this.setState({draggable:!e})}onSortStart(){f.on()}onSortEnd(e){let{oldIndex:t,newIndex:r}=e;const{blogs:n}=this.state,o=(0,i.arrayMove)(n,t,r),s=(0,a.default)("rkc"),d=(0,a.default)("rkm"),u=o.map((e=>e.uuid));s&&d&&(0,l.default)({rkc:s,rkm:d,order:u}),this.setState({blogs:o}),f.off()}}var m=h;t.default=m},10793:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=i(t);if(r&&r.has(e))return r.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=a?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,r&&r.set(e,n);return n}(r(67294));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(i=function(e){return e?r:t})(e)}var a=e=>n.createElement("a",{href:e.owner.primary_blog_url,className:"blog-host-icon-link"},n.createElement("img",{src:e.owner.user_icon_url,className:"blog-host-icon","data-testid":"blog-host-icon"}));t.default=a},55544:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SortableBlog=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),a=r(94027),o=(n=r(52695))&&n.__esModule?n:{default:n};function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}const l=(0,a.SortableElement)((e=>{let{blog:t,draggable:r}=e;return i.createElement(o.default,{blog:t,draggable:r})}));t.SortableBlog=l},37845:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SortableBlogList=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),i=r(94027),a=r(55544);function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}const s=(0,i.SortableContainer)((e=>{let{blogs:t,draggable:r}=e;return n.createElement("div",{className:"main-box"},t.map(((e,t)=>n.createElement(a.SortableBlog,{key:e.uuid,index:t,blog:e,draggable:r}))))}));t.SortableBlogList=s},29784:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SortableDragHandle=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),a=r(94027),o=(n=r(19449))&&n.__esModule?n:{default:n};function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}const l=(0,a.SortableHandle)((e=>{let{draggable:t}=e;return i.createElement(o.default,{draggable:t})}));t.SortableDragHandle=l},77765:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),i=o(r(20996)),a=o(r(33876));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}class l extends n.Component{render(){const e=this.props.blog;return n.createElement("div",{className:"myblog-box-subcontent"},n.createElement("div",{className:"myblog-box-subcontent-row"},e.is_primary?n.createElement("div",null,n.createElement("span",{className:"primary-blog","data-testid":"primary-blog"},i.default.text("epic.primary_blog"))):null,n.createElement("div",null,n.createElement("a",{href:e.path_admin.edit+"?utm_source=admin-myblogBox&utm_medium=referral&utm_campaign=new_entry",title:i.default.text("new_entry"),className:"test-blog-edit-button myblog-edit-button"},i.default.text("new_entry"))),n.createElement(a.default,{blog:e})),n.createElement("div",{className:"myblog-box-overview-digest"},n.createElement("div",{className:"overview-digest-item"},n.createElement("span",{className:"overview-digest-label"},i.default.text("admin.post_count")),n.createElement("a",{href:e.path_admin.entries,className:"overview-digest-count"},e.entry_count)),n.createElement("div",{className:"overview-digest-item"},n.createElement("span",{className:"overview-digest-label"},i.default.text("admin.blog_subscribers_count")),n.createElement("a",{href:e.path_admin.subscribers,className:"overview-digest-count"},e.subscribers_count))))}}var d=l;t.default=d},26845:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(80129)),i=a(r(347));function a(e){return e&&e.__esModule?e:{default:e}}var o=e=>{const t=e.rkc,r=e.rkm,a=e.order.join(",");i.default.request({data:n.default.stringify({rkc:t,rkm:r,order:a}),method:"post",url:"/api/blog/update_blogs_order"})};t.default=o},11596:(e,t,r)=>{"use strict";var n,i=(n=r(46754))&&n.__esModule?n:{default:n};e.exports=i.default},89837:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RecommendItem=void 0;var n=d(r(20996)),i=r(9013),a=r(59880),o=d(r(86010)),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=l(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294));function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(l=function(e){return e?r:t})(e)}function d(e){return e&&e.__esModule?e:{default:e}}t.RecommendItem=e=>{let{result:t,order:r}=e;const l=(0,s.useRef)(null),{isMuted:d,isActionMenuOpen:u,onClickActionButton:c,onClickMuteButton:p}=(0,i.useRecommendItem)({blogId:t.blogId,actionMenuRef:l});return d?s.default.createElement("div",{className:"recommendList-item"},s.default.createElement("p",null,"")):s.default.createElement("div",{className:"recommendList-item"},s.default.createElement("div",{className:"recommendList-tags"},""!==t.category&&s.default.createElement("span",{className:"tag-item"},t.category),t.tags.map((e=>s.default.createElement("span",{className:"tag-item",key:e},"#",e)))),s.default.createElement("div",{className:"recommendList-container"},s.default.createElement("div",{className:"recommendList-header"},s.default.createElement("img",{src:t.iconUrl,width:"32",className:"recommendList-icon"}),s.default.createElement("div",{className:"recommendList-title"},s.default.createElement(a.RecommendTrackingAnchor,{href:t.url,target:"_blank",rel:"noopener",recommendTrackingOption:{component:"title",type:t.type,url:t.url,order:r}},t.title)),s.default.createElement("div",{className:"recommendList-meta"},s.default.createElement(a.RecommendTrackingAnchor,{href:t.blogUrl,className:"blogTitle",target:"_blank",rel:"noopener",recommendTrackingOption:{component:"content",type:t.type,url:t.url,order:r}},t.blogTitle),"",s.default.createElement("span",{className:"time"},n.default.deltaDatetime(t.published)))),s.default.createElement("p",{className:"recommendList-entryContent"},s.default.createElement("a",{href:t.url},t.entryContent)),s.default.createElement("div",{className:"recommendList-action"},s.default.createElement("div",{className:"action-btn-wrapper dropdown-window-wrapper"},s.default.createElement("button",{className:"action-btn",type:"button",onClick:c},s.default.createElement("i",{className:"blogicon-others"})),s.default.createElement("div",{className:(0,o.default)("dropdown-window is-position-right",{"is-open":u}),ref:l},s.default.createElement("ul",{className:"list"},s.default.createElement("li",null,s.default.createElement("button",{type:"button",onClick:p},""))))))))}},59880:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RecommendTrackingAnchor=void 0;var n=r(51534),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=a(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,r&&r.set(e,n);return n}(r(67294));function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(a=function(e){return e?r:t})(e)}function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o.apply(this,arguments)}t.RecommendTrackingAnchor=e=>{let{recommendTrackingOption:t,children:r,...a}=e;const s=(e=>{let{component:t,type:r,url:n,order:a}=e;return(0,i.useMemo)((()=>({eventLabel:`antenna_recommendation_click_${t}_${r}_${a}_${n}`,shouldTrackInviews:!0,eventData:{area:"recommendation",component:t,order:a,payload:{logic:r}}})),[t,r,n,a])})(t);return i.default.createElement(n.AdminEventTrackableAnchor,o({},a,{trackingOption:s}),r)}},74107:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RecommendationComponent=void 0;var n,i=r(55992),a=r(89837),o=r(54991),s=(n=r(86010))&&n.__esModule?n:{default:n},l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=d(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294));function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(d=function(e){return e?r:t})(e)}const u="antenna/recommend/collapsed";t.RecommendationComponent=e=>{let{results:t}=e;const{isCollapsed:r,setCollapsed:n}=(()=>{const[e,t]=(0,l.useState)((()=>!!localStorage&&"true"===localStorage.getItem(u)));return{isCollapsed:e,setCollapsed:(0,l.useCallback)((e=>{localStorage&&(localStorage.setItem(u,e?"true":""),t(e))}),[])}})(),d=(0,l.useCallback)((()=>{n(!r)}),[r,n]),c=t.length>0;return l.default.createElement("div",{className:"recommendList-wrapper"},l.default.createElement("div",{className:"header"},l.default.createElement("h2",null,""),l.default.createElement("p",null,""),l.default.createElement("p",null,l.default.createElement("a",{href:(0,i.helpUrl)("/entry/recommendation#changelog")},""))),l.default.createElement("div",{className:(0,s.default)("list-scroll-wrapper",{"is-collapsed":r})},l.default.createElement("div",{className:(0,s.default)("list-items",{"list-grid-items":t.length>1})},c?t.map(((e,t)=>l.default.createElement(a.RecommendItem,{key:e.url,order:t,result:e}))):l.default.createElement(o.RecommendationEmptyMessage,null))),c&&l.default.createElement("div",{className:"expand-collapse-items"},l.default.createElement("button",{type:"button",onClick:d},r?"":"")),l.default.createElement("aside",{className:"aside"},l.default.createElement("ul",null,l.default.createElement("li",null,l.default.createElement("a",{href:(0,i.helpUrl)("/entry/recommendation")},"")),l.default.createElement("li",null,l.default.createElement("a",{href:"https://forms.gle/683LVsCjpt9ju1zKA"},"")))))}},54991:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RecommendationEmptyMessage=void 0;var n,i=r(55992),a=(n=r(67294))&&n.__esModule?n:{default:n};t.RecommendationEmptyMessage=()=>a.default.createElement("div",{className:"emptyMessage","data-testid":"emptyMessage"},a.default.createElement("h3",null,""),a.default.createElement("ul",null,a.default.createElement("li",null,a.default.createElement("i",{className:"blogicon-check"})," ",a.default.createElement("a",{href:(0,i.helpUrl)("/entry/hatena/star")},""),"",a.default.createElement("a",{href:(0,i.helpUrl)("/entry/blog_bookmark")},""),""),a.default.createElement("li",null,a.default.createElement("i",{className:"blogicon-check"})," ",a.default.createElement("a",{href:(0,i.helpUrl)("/entry/tag#")},""),"")),a.default.createElement("p",null,a.default.createElement("small",null,"",a.default.createElement("a",{href:(0,i.helpUrl)("/entry/recommendation")},""))))},9013:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useRecommendItem=void 0;var n=r(70879),i=r(55992),a=r(61663),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=l(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(347)),s=r(67294);function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(l=function(e){return e?r:t})(e)}t.useRecommendItem=e=>{let{blogId:t,actionMenuRef:r}=e;const[l,d]=(0,s.useState)(!1),[u,c]=(0,s.useState)(!1),p=(0,s.useCallback)((()=>{d(!0),o.default.post((0,i.httpsAdminUrl)("/-/recommendation/mute"),{blog_id:t},{transformRequest:[o.withEpicRKs,o.formDataRequest]}).catch((e=>{(0,n.BUG)(e)}))}),[t]),f=(0,s.useCallback)((()=>{c(!0)}),[]),h=(0,s.useCallback)((()=>{u&&c(!1)}),[u]);return(0,a.useOnClickOutside)(r,h),{isMuted:l,isActionMenuOpen:u,onClickActionButton:f,onClickMuteButton:p}}},552:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RecommendationApp=void 0;var n,i=r(90381),a=(n=r(20996))&&n.__esModule?n:{default:n},o=l(r(67294));function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}function l(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}return n.default=e,r&&r.set(e,n),n}const d=(0,o.lazy)((()=>Promise.resolve().then((()=>l(r(74107)))).then((e=>({default:e.RecommendationComponent})))));t.RecommendationApp=e=>{let{results:t}=e;return o.default.createElement(o.Suspense,{fallback:o.default.createElement(i.LoadingIndicator,{text:a.default.text("loading")})},o.default.createElement(d,{results:t}))}},99171:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(67294)),i=a(r(20996));function a(e){return e&&e.__esModule?e:{default:e}}class o extends n.default.Component{render(){const e=this.props.blog;if(!e.latest_entry&&e.is_public)return null;const t=this.renderIcon(),r=this.renderBlogName(),i=this.renderEntryMetaData(),a=this.renderThumbnail(),o=this.renderEntryTitle(),s=this.renderEntryBody();return n.default.createElement("li",{className:"subscribed-list-list"},n.default.createElement("div",{className:"subscribed-list-item"},t,n.default.createElement("div",{className:"subscribed-list-header"},r),n.default.createElement("div",{className:"entry-unit-content"},n.default.createElement("div",{className:"entry-unit-content-main"},o,s,i),a)))}renderIcon(){const e=this.props.blog;return n.default.createElement("a",{href:e.uri},n.default.createElement("img",{src:e.icon,className:"subscribed-list-icon"}))}renderBlogName(){const e=this.props.blog;return n.default.createElement("a",{href:e.uri,className:"entry-unit-blog-name",target:"_blank",rel:"noopener"},e.title)}renderEntryMetaData(){const e=this.props.blog,t=e.latest_entry;let r=null;if(e.is_public&&t){const e=new Date(t.datetime),a=e.getTime(),o=i.default.deltaDatetime(e);r=n.default.createElement("time",{className:"post-time time",dateTime:t.datetime,"data-epoch":a},o)}return n.default.createElement("div",{className:"entry-unit-entry-footer"},r)}renderThumbnail(){const e=this.props.blog,t=this.props.blog.latest_entry;return e.is_public&&t&&t.image?n.default.createElement("a",{href:t.uri,target:"_blank",rel:"noopener"},n.default.createElement("img",{src:t.image,className:"entry-unit-entry-thumb"})):null}renderEntryTitle(){const e=this.props.blog,t=e.latest_entry;return e.is_public&&t?n.default.createElement("h3",{className:"entry-unit-entry-title"},n.default.createElement("a",{href:t.uri,target:"_blank",rel:"noopener"},t.title)):null}renderEntryBody(){const e=this.props.blog,t=e.latest_entry;let r,a=null;e.is_public||(a=n.default.createElement("i",{className:"blogicon-private"})),r=e.is_public?t.summary:i.default.text("admin.subscribe.private.blog.message");const o=this.renderSeeMoreLink();return n.default.createElement(n.default.Fragment,null,n.default.createElement("p",{className:"entry-unit-entry-content"},a,r),o)}renderSeeMoreLink(){const e=this.props.blog,t=e.latest_entry;return e.is_public&&t.summary_is_trimmed?n.default.createElement("a",{href:t.uri,target:"_blank",rel:"noopener"},i.default.text("see_more")):null}}var s=o;t.default=s},82059:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(67294)),i=a(r(99171));function a(e){return e&&e.__esModule?e:{default:e}}class o extends n.default.Component{render(){const e=this.props.blogs.map((e=>n.default.createElement(i.default,{key:e.id,blog:e})));return n.default.createElement("ul",{className:"subscribed-list"},e)}}var s=o;t.default=s},28430:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FigureSubscribe=void 0;var n=a(r(33813)),i=a(r(67294));function a(e){return e&&e.__esModule?e:{default:e}}t.FigureSubscribe=()=>i.default.createElement(n.default,null)},1379:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(67294)),i=a(r(20996));function a(e){return e&&e.__esModule?e:{default:e}}class o extends n.default.Component{render(){return this.props.hasMore?n.default.createElement("a",{className:"btn",href:"/-/antenna","data-testid":"btn"},i.default.text("epic.more")):null}}var s=o;t.default=s},45288:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i,a,o=f(r(67294)),s=f(r(20996)),l=f(r(347)),d=r(55992),u=r(28430),c=f(r(82059)),p=f(r(1379));function f(e){return e&&e.__esModule?e:{default:e}}class h extends o.default.Component{constructor(e){super(e),this.state={blogs:[],hasMore:!1}}componentDidMount(){this.loadSubscribingBlogs()}render(){return 0===this.state.blogs.length?o.default.createElement(o.default.Fragment,null,o.default.createElement("div",{className:"main-header"},o.default.createElement("h1",null,s.default.text("admin.subscription_list"))),o.default.createElement("aside",{className:"message-subscribe-welcome"},o.default.createElement("a",{className:"subscribe-welcome-content",href:(0,d.helpUrl)("/entry/reading/subscribe"),target:"_blank",rel:"noopener"},o.default.createElement("div",{className:"subscribe-welcome-figure"},o.default.createElement(u.FigureSubscribe,null)),o.default.createElement("span",null,s.default.text("subscribed_list.no_subscribe.message")),o.default.createElement("h3",null,s.default.text("subscribed_list.no_subscribe.how_to_use"))))):o.default.createElement(o.default.Fragment,null,o.default.createElement("div",{className:"main-header"},o.default.createElement("h1",null,s.default.text("admin.subscription_list"))),o.default.createElement(c.default,{blogs:this.state.blogs}),o.default.createElement(p.default,{hasMore:this.state.hasMore}))}loadSubscribingBlogs(){l.default.request({data:{limit:this.props.limit},method:"get",url:"/api/subscribing"}).then((e=>{let{data:t}=e;this.setState({blogs:t.blogs,hasMore:t.has_more})}))}}n=h,a={limit:3},(i=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(i="defaultProps"))in n?Object.defineProperty(n,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[i]=a;var m=h;t.default=m},51731:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FlagToggle=void 0;var n,i=r(55834),a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),o=(n=r(20996))&&n.__esModule?n:{default:n};function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}t.FlagToggle=e=>{let{flagName:t}=e;const[r,n]=(0,a.useState)((0,i.hasFlagVariant)(t));return a.default.createElement("div",null,r?a.default.createElement("button",{type:"button",className:"btn",onClick:()=>{(0,i.removeFlagVariant)(t),n(!1)}},o.default.text("global.deactivate")):a.default.createElement("button",{type:"button",className:"btn btn-primary",onClick:()=>{(0,i.addFlagVariant)(t),n(!0)}},o.default.text("global.activate")))}},99908:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FlagVariantsConfig=void 0;var n,i=r(51731),a=(n=r(67294))&&n.__esModule?n:{default:n};t.FlagVariantsConfig=e=>{let{availableFlags:t}=e;return a.default.createElement("div",{id:"flag-variants-config"},t.map((e=>a.default.createElement(i.FlagToggle,{flagName:e,key:e}))))}},34914:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initializeFlagVariantsConfigIfApplicable=void 0;var n,i=r(99908),a=r(73380),o=(n=r(67294))&&n.__esModule?n:{default:n};const s=r(91269);t.initializeFlagVariantsConfigIfApplicable=e=>{if(e){const{availableFlags:t}=s.get("flagVariants");(0,a.safeRender)(o.default.createElement(i.FlagVariantsConfig,{availableFlags:t}),e)}}},75809:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NotificationsContainer=void 0;var n,i=r(61922),a=r(81433),o=(n=r(67294))&&n.__esModule?n:{default:n};t.NotificationsContainer=()=>{const e=(0,a.useNotifications)();return o.default.createElement(i.NotificationsPresentation,e)}},59958:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContentObject=void 0;var n,i=r(16972),a=(n=r(67294))&&n.__esModule?n:{default:n};t.ContentObject=e=>{let{content:t}=e;switch(typeof t){case"string":case"number":return a.default.createElement(a.default.Fragment,null,t);case"object":switch(t.type){case"link":return a.default.createElement("a",{href:t.href},t.text);case"star":return a.default.createElement(i.Star,{color:t.color});case"user":return a.default.createElement("a",{href:`https://blog.hatena.ne.jp/${t.name}/`,className:"notification-screenName"},t.screen_name);default:return null}default:return null}}},83961:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NoticeLine=void 0;var n=o(r(20996)),i=r(59958),a=o(r(67294));function o(e){return e&&e.__esModule?e:{default:e}}t.NoticeLine=e=>{let{notice:t}=e;const r=new Date(1e3*t.created);return a.default.createElement("div",{className:"notification-item"},a.default.createElement("div",{className:"item-icon"},a.default.createElement("a",{href:"https://blog.hatena.ne.jp/my"},a.default.createElement("img",{src:t.icon,alt:n.default.text("blog.go_to.blog")}))),a.default.createElement("div",{className:"item-content"},t.content.map(((e,t)=>a.default.createElement(i.ContentObject,{content:e,key:t}))),a.default.createElement("div",{className:"item-footer"},t.created&&a.default.createElement("time",{dateTime:r.toISOString()},n.default.deltaDatetime(r)))))}},61922:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NotificationsPresentation=void 0;var n=r(55992),i=r(83961),a=s(r(20996)),o=s(r(67294));function s(e){return e&&e.__esModule?e:{default:e}}t.NotificationsPresentation=e=>{let{data:t,loading:r,error:s}=e;return r||!t?o.default.createElement("div",{className:"notifications-loading"},o.default.createElement("img",{src:(0,n.staticUrl)("/images/loading.gif"),alt:"",className:"loading-spinner"}),a.default.text("loading")):s?o.default.createElement("div",{className:"error-box"},a.default.text("epic.failed_to_load")):o.default.createElement("div",null,t.notices.map((e=>o.default.createElement(i.NoticeLine,{notice:e,key:e.subject+e.verb+e.modified}))))}},16972:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Star=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n};t.Star=e=>{let{color:t}=e;return i.default.createElement("span",{className:`notifications-star-${t}`},"")}},81433:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useNotifications=void 0;var n=r(55992),i=r(91289);t.useNotifications=()=>{const[{data:e,loading:t,error:r}]=(0,i.useXHR)({url:(0,n.httpsAdminUrl)("/-/notifications/api")});return{data:e,loading:t,error:r}}},22230:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CategoryEditor=void 0;var n=s(r(57942)),i=s(r(65311)),a=s(r(49282)),o=s(r(66419));function s(e){return e&&e.__esModule?e:{default:e}}const l={user:"module-category-sortable-container"},d={user:"module-category-sortable-item"};t.CategoryEditor=class{constructor(){this.categoryTemplate=o.default.template((0,i.default)(".js-categories-template").html()),this.categoryContainer=(0,i.default)(".js-categories-container"),this.updateNumberOfItemsInputDisability(),(0,i.default)("input[name=limit_number_of_categories]").change((()=>{this.updateCategoryPreview()})),(0,i.default)("input[name=number_of_items]").change(o.default.throttle((()=>{this.updateCategoryPreview()}),30))}doesLimitNumberOfCategories(){return"limited"===(0,i.default)("input[name=limit_number_of_categories]:checked").val()}updateNumberOfItemsInputDisability(){(0,i.default)("#number_of_items").prop("disabled",!this.doesLimitNumberOfCategories())}updateCategoryPreview(){const e=(0,i.default)(".js-categories-order-type option:selected").val(),t=this.doesLimitNumberOfCategories(),r=(0,i.default)("#number_of_items").val();t&&document.getElementById("number_of_items").reportValidity(),this.updateNumberOfItemsInputDisability(),i.default.ajax({url:this.categoryContainer.data("getUrl"),data:{order_type:e}}).done((n=>{this.categoryContainer.html(this.categoryTemplate({categories:n.categories,sortableContainerClass:l[e]||"",sortableItemClass:d[e]||"",doesLimitNumberOfCategories:t,categoriesCountLimit:r})),"user"===e&&this.setupSortable()}))}setupSortable(){this.categoryContainer.find(".js-categories-sortable").each(((e,t)=>{const r=(0,i.default)(t);a.default.create(r.get(0),{animation:150,group:"shared",forceFallback:!0,onUpdate:()=>{this.updateSortedCategories(r)},onAdd:()=>{this.updateSortedCategories(r)}})}))}updateSortedCategories(e){const t=this.categoryContainer.find(".js-categories-sortable-item").map(((e,t)=>(0,i.default)(t).data("categoryName"))).get();i.default.ajax({type:"POST",url:e.data("sortUrl"),data:{category_names:t,rkm:(0,n.default)("rkm"),rkc:(0,n.default)("rkc")},traditional:!0}).done((()=>{this.updateCategoryPreview()}))}}},4291:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initFotoUploader=function(e,t){const r=a.default.Deferred(),n="undefined"!=typeof FormData,i=e=>{const t=e.match(/f:id:([^:]+):(\d+)([jpg]):image/);if(!t)return;const n=t[1],i=t[2],a=t[3],o=[n.substring(0,1),n,i.substring(0,8),i].join("/"),s=`https://cdn-ak.f.st-hatena.com/images/fotolife/${o}${{j:".jpg",p:".png",g:".gif"}[a]??""}`,l=`https://cdn-ak.f.st-hatena.com/images/fotolife/${o}_120.jpg`;r.notify({fid:e,url:s,thumbnail_url:l})};n?e.on("change",(r=>{const n=r.target;n.files?.length&&l(n,e,"Hatena Blog",t,i)})):d(e,t,i);return r.promise()},t.setIframeUploader=d,t.uploadImage=l;var n=s(r(57942)),i=s(r(20996)),a=s(r(65311)),o=s(r(66419));function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t,r,s,l){t.prop("disabled",!0);const d=new FormData;d.append("rkm",(0,n.default)("rkm")),d.append("append","1"),d.append("fototitle",""),d.append("folder",r),d.append("fotosize",String(s)),d.append("delete-gps","1"),e.files&&d.append("image",e.files[0]);const u=(0,a.default)(e).parent().parent().find(".progress");u.show();const c=u.find("div.bar");c.width("0%");const p=u.find("div.percent"),f=e=>{c.width(`${e}%`),p.text(i.default.text("uploading"))},h=new XMLHttpRequest;h.upload.addEventListener("progress",(e=>{const t=e.lengthComputable?Math.min(e.loaded/e.total*100,100):NaN;f(t)}),!1),h.addEventListener("load",(()=>{t.prop("disabled",!1),t.val(""),f(100),l(h.responseText),u.hide(),o.default.defer((()=>{f(0)}))}),!1),h.addEventListener("error",(()=>{u.addClass("error"),t.val(""),p.text("error"),t.prop("disabled",!1)}),!1),h.open("POST",`/f/${(0,n.default)("name")}/upbysmart`),h.setRequestHeader("X-Requested-With","XMLHttpRequest"),h.send(d)}function d(e,t,r){const n=(0,a.default)("<iframe/>");e.replaceWith(n);const o="/api/upload/fotolife_smart";n.attr("src",o),n.addClass("uploader"),n.load((()=>{const e=n[0];let s;if(e.contentDocument)s=e.contentDocument;else{if(!e.contentWindow)return;s=e.contentWindow.document}s.body.innerHTML.match(/^\s*(f:id:\S+)/)&&e.contentWindow?.location.replace(o),r(s.body.innerHTML),(0,a.default)(s).find('input[name="fotosize"]').val(t);const l=(0,a.default)(s).find('input[type="file"]');(0,a.default)(l[0]).change((()=>{(0,a.default)(s).find("#fotolife-upload-form").submit(),(0,a.default)(l[0]).replaceWith((0,a.default)("<h5>").text(i.default.text("uploading")))}))}))}},72367:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HeaderImage=void 0;var n=a(r(65311)),i=a(r(66419));function a(e){return e&&e.__esModule?e:{default:e}}t.HeaderImage=class{constructor(e,t){this.imageSize=t,this.$imageSrc=e.find(".js-image-src"),this.$imageId=e.find(".js-image-id"),this.$displayArea=e.find(".js-display-area"),i.default.defer((()=>{this.updated()}))}setImage(e,t){this.$imageSrc.val(e),this.$imageId.val(t),this.$displayArea.val(""),this.$displayArea.length||this.updated()}setDisplayArea(e){this.$displayArea.val(JSON.stringify(e)),this.updated()}clear(){this.$imageSrc.val(""),this.$imageId.val(""),this.$displayArea.val(""),this.updated()}getImageSrc(){return this.$imageSrc.val()}getThumbnailSrc(){return this.getImageSrc().replace(/\.(jpg|png|gif)$/,"_120.jpg")}getImageId(){return this.$imageId.val()}getDisplayArea(){let e;try{e=JSON.parse(this.$displayArea.val())}catch{}return e}getTrimmingArea(){const e=this.getDisplayArea();return e?[e.x,e.y,e.x2,e.y2]:[0,0,this.imageSize.width,this.imageSize.height]}updated(){(0,n.default)(this).triggerHandler("updated")}}},84589:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HeaderImagePreview=void 0;var n,i=(n=r(65311))&&n.__esModule?n:{default:n};const a=r(42807);t.HeaderImagePreview=class{constructor(e){if(this.$container=e,!("Jcrop"in(t=i.default))||"function"!=typeof t.Jcrop)throw new Error;var t;this.jcrop=i.default.Jcrop(this.$container.find(".js-header-image-thumbnail"),{bgOpacity:"0.4",addClass:"jcrop-dark",allowSelect:!1,allowResize:!1,allowMove:!1})}render(e,t,r){e?this.jcrop.setImage(t,(()=>{r&&this.setArea(e,t,r)})):r&&this.setArea(e,t,r),this.$container.show()}clear(){this.$container.hide()}setArea(e,t,r){a([e,t]).done((e=>{const t=e[0],n=e[1].height/t.height,i=[0,r.y*n,r.w,r.y2*n];this.jcrop.setSelect(i)}))}}},67875:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initListItemSelector=function(){const e=(0,o.default)("#css"),t=(0,o.default)("#themes .js-theme-item");t.addClass("ui-selectee").on("click",(r=>{const n=(0,o.default)(r.currentTarget),s=n.attr("data-css").replace(/\s+/g," "),l=n.attr("data-id"),d=n.attr("data-store-url"),u=new i.EditDesign(e.val());u.setData("theme",l,`@import "${s}";`),e.val(u.getCSS()),e.trigger("change"),t.removeClass("ui-selected"),n.addClass("ui-selected"),(0,a.updateLinkToCurrentTheme)(d)}));const r=(0,o.default)("#background-image-thumbnail"),n=(0,o.default)("#backgrounds li"),s=(0,o.default)("#background-colors li");n.addClass("ui-selectee").on("click",(t=>{const a=(0,o.default)(t.currentTarget),l=a.attr("data-css").replace(/\s+/g," "),d=a.attr("data-id"),u=new i.EditDesign(e.val());u.setData("background",d,l),e.val(u.getCSS()),e.trigger("change"),n.removeClass("ui-selected"),s.removeClass("ui-selected"),a.addClass("ui-selected"),r.removeClass("ui-selected"),(0,o.default)('input[name="bg-image-selected"]').val(0)})),s.addClass("ui-selectee").on("click",(t=>{const a=(0,o.default)(t.currentTarget),l=new i.EditDesign(e.val());let d=a.attr("data-css").replace(/\s+/g," "),u=a.attr("data-id");const c=l.getData("background")?.content;r.hasClass("ui-selected")&&c&&(d=c.replace(/background-color:(.*?);/,`background-color:#${u};`),u="custom"),n.removeClass("ui-selected"),l.setData("background",u,d),e.val(l.getCSS()),e.trigger("change"),s.removeClass("ui-selected"),a.addClass("ui-selected")}));const l=new i.EditDesign(e.val()),d=l.getData("theme")?.selected;if(d){const e=t.filter(`[data-id="${d}"]`);e.addClass("ui-selected"),(0,a.updateLinkToCurrentTheme)(e.attr("data-store-url"))}else t.removeClass("ui-selected");const u=l.getData("background")?.selected;u?(0,o.default)("#backgrounds, #background-colors").find(`[data-id="${u}"]`).addClass("ui-selected"):n.removeClass("ui-selected")};var n,i=r(37255),a=r(9304),o=(n=r(65311))&&n.__esModule?n:{default:n}},90539:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Module=void 0;var n=d(r(20996)),i=r(17187),a=d(r(65311)),o=r(19575),s=d(r(66419)),l=r(78754);function d(e){return e&&e.__esModule?e:{default:e}}const u=l.z.record(l.z.string(),l.z.union([l.z.string(),l.z.number(),l.z.array(l.z.string()),l.z.null()])),c=/^(?<key>.+)\.base64$/;class p extends i.EventEmitter{constructor(e){super(),this.element=e,this.isNew=!1,this.type=this.element.find("input.js-module-type").val(),this.title=this.element.find("input.js-module-title").val(),this.value={};const t=this.element.find("input.js-module-value").val();0!==t.length&&(this.value=p.decodeModuleValue(JSON.parse(t))),this.element.on("click",".js-edit-module",(()=>(this.edit(),!1))).on("click",".js-remove-module",(()=>(confirm(n.default.text("blog.confirm.delete"))&&this.remove(),!1)))}edit(){this.emit("edit")}remove(){this.element.remove(),this.emit("removed")}update(e,t,r){this.type=e,this.title=t,this.value=r,this.render(),this.emit("updated")}isNewModule(){return this.isNew}setAsNewModule(){this.isNew=!0,this.element.addClass("created")}unsetAsNewModule(){this.isNew=!1,this.element.removeClass("created")}setAsSelected(){this.element.addClass("selected")}unsetAsSelected(){this.element.removeClass("selected")}render(){this.element.find("input.js-module-type").val(this.getType()),this.element.find("input.js-module-title").val(this.getTitle()),this.element.find("input.js-module-value").val(this.getBase64ValueAsJSON()),this.element.addClass(this.getType()),this.element.find(".title, .clipped-content").text(this.getTitleForPreview())}getType(){return this.type}getTitle(){return this.title}getValue(){return this.value}getElement(){return this.element}getTitleForPreview(){let e=this.getTitle();return e||"html"!==this.getType()||(e=this.removeTag(`${this.value["module-value"]??""}`)||n.default.text("blog.module.html")),e}getValueAsJSON(){return JSON.stringify(this.value)}getBase64ValueAsJSON(){return JSON.stringify(p.encodeModuleValueToBase64(this.value))}removeTag(e){return e.replace(/<.*?>/g,"")}static initializeWithModulesPosition(e){const t=(0,a.default)(".new-module-template").html(),r=s.default.template(t)({position:e}),n=(0,a.default)(a.default.parseHTML(r));return new p(n)}static encodeModuleValueToBase64(e){const t={};for(const r in e)if(r in e){const n=e[r];"string"==typeof n&&0!==n.length?t[`${r}.base64`]=(0,o.encode)(n):Array.isArray(n)?t[`${r}.base64`]=n.map((e=>(0,o.encode)(e))):t[r]=n}return t}static decodeModuleValue(e){const t=u.parse(e),r={};for(const e in t)if(e in t){const n=e.match(c);if(n){const i=n.groups?.key;if(i){const n=t[e];"string"==typeof n?r[i]=(0,o.decode)(n):Array.isArray(n)&&(r[i]=n.map((e=>(0,o.decode)(e))))}}else r[e]=t[e]}return r}}t.Module=p},87855:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ModuleEditor=void 0;var n,i=r(41960),a=(n=r(65311))&&n.__esModule?n:{default:n};t.ModuleEditor=class{constructor(e){this.modalWindow=e,this.modalWindow.appendTo(document.body),this.dialogBox=this.modalWindow.find(".js-dialog-modal"),this.dialogOverlay=this.modalWindow.find(".dialog-overray"),this.applyButton=this.modalWindow.find(".submit button.apply"),this.cancelButton=this.modalWindow.find(".submit button.cancel"),this.radios=this.modalWindow.find(".radios"),this.session=a.default.Deferred(),this.session.reject(),this.init()}init(){this.radios.find("input:radio").change((()=>{const e=this.radios.find("input:radio:checked").val();this.selectPanelByType(e),this.updateSettingsAvailability()})),this.modalWindow.find(".radio").click((e=>{const t=(0,a.default)(e.currentTarget).find("input:radio").val();this.selectPanelByType(t),this.updateSettingsAvailability()})),this.modalWindow.find("#module-value-component-link").each(((e,t)=>{const r=(0,a.default)(t);r.find("#add-link-input-button").click((()=>{const e=r.find(".link-input").eq(0).clone();e.find(":input").val(""),e.insertAfter(r.find(".link-input").eq(-1));const t=this.modalWindow.find(".module-value-box-inner");t.scrollTop(t[0].scrollHeight)}))})),this.modalWindow.delegate(".delete-link-input-button","click",(e=>(this.modalWindow.find(".link-input").length>1&&(0,a.default)(e.currentTarget).closest(".link-input")?.remove(),!1))),this.applyButton.click((()=>{this.applyEdit()})),this.dialogOverlay.click((()=>{this.cancelEdit()})),this.cancelButton.click((()=>{this.cancelEdit()})),(0,a.default)(window).keyup((e=>{"S-ESC"===(0,i.keyString)(e)&&this.cancelEdit()})),this.modalWindow.find(".js-categories-order-type").change((()=>{(0,a.default)(this).triggerHandler("change-category-order-type")})),this.modalWindow.find(".js-restrict-entry-title-length").change((()=>{this.updateSettingsAvailability()})),this.modalWindow.find(".js-enable-customize-format").change((()=>{this.updateSettingsAvailability()})),this.modalWindow.find(".js-variable-toggle").click((()=>(this.modalWindow.find(".js-variable-help").slideToggle(),!1)))}editNewModule(e){return this.session.reject(),this.session=a.default.Deferred(),this.editingModule=e,this.setupValues(),this.modalWindow.addClass("created").removeClass("hide-radios"),this.cancelButton.show(),this.show(),this.updateSettingsAvailability(),this.session.promise()}editModule(e){return this.session.reject(),this.session=a.default.Deferred(),this.editingModule=e,this.setupValues(),this.modalWindow.removeClass("created").addClass("hide-radios"),this.cancelButton.hide(),this.selectPanelByType(e.getType()),this.show(),this.fillValuesFromModule(e),this.updateSettingsAvailability(),(0,a.default)(this).triggerHandler("edit-new-module"),this.session.promise()}selectPanelByType(e){this.radios.find(".radio").removeClass("selected");const t=this.radios.find(`.radio.module-${e}`).closest(".radio");t.addClass("selected"),t.find("input:radio").prop("checked",!0),this.modalWindow.find(".module-value-component").hide(),this.modalWindow.find(`#module-value-component-${e}`).show()}getSelectedPanelType(){const e=this.radios.find("input:enabled:checked");return e.length?e.val():null}setupValues(){this.modalWindow.find("textarea, input[type=text], input[type=number]").each(((e,t)=>{const r=(0,a.default)(t);r.attr("data-default-value")?r.val(r.attr("data-default-value")):r.val("")})),this.modalWindow.find("input[type=checkbox]").prop("checked",!1),this.modalWindow.find("select").each(((e,t)=>{const r=(0,a.default)(t);r.attr("data-default-option")?r.val(r.attr("data-default-option")):r.find("option:first").prop("selected",!0)})),this.modalWindow.find("input[type=radio]").prop("checked",!1),this.modalWindow.find("input[type=radio][data-default-radio-choise=true]").prop("checked",!0),this.modalWindow.find("input[data-default-disabled=true]").prop("disabled",!0),this.getSelectedPanelType()||this.selectPanelByType("profile")}show(){const e=(0,a.default)("#tab-customize");e.scrollTop(e[0].scrollHeight),this.modalWindow.show(),this.dialogBox.find("input[type=text]:visible:first").focus()}applyEdit(){const e=this.extractInputToModuleValues();this.session.resolve(e),this.hide()}cancelEdit(){this.session.reject(),this.hide()}hide(){this.modalWindow.hide()}fillValuesFromModule(e){const t=e.getValue(),r=e.getType();for(const e in t)if("link"!==r||"link_title"!==e&&"link_url"!==e){const r=this.dialogBox.find(":input:visible").filter(((t,r)=>(0,a.default)(r).attr("name")===e));"radio"===r.eq(0).attr("type")?r.filter(((r,n)=>(0,a.default)(n).attr("value")===t[e])).prop("checked",!0):(r.eq(0).val(t[e]??""),"checkbox"===r.eq(0).attr("type")&&t[e]&&r.eq(0).prop("checked",!0))}else this.setLinkInput(this.dialogBox,t,e);this.dialogBox.find("input[name=module-title]:visible").val(e.getTitle())}updateSettingsAvailability(){const e=this.dialogBox.find(".js-enable-customize-format:visible").prop("checked"),t=this.dialogBox.find(".js-basic-config-wrapper:visible");if(this.dialogBox.find(".js-customize-format-textarea:visible").prop("disabled",!e),t.find(":input:not(.js-display-entry-image-input)").prop("disabled",e),e)t.find("label").addClass("disabled");else{t.find("label").removeClass("disabled");const e="0"===this.dialogBox.find(".js-restrict-entry-title-length:visible").val();this.dialogBox.find(".js-display-entry-title-length:visible").prop("disabled",e)}}extractInputToModuleValues(){if(void 0===this.editingModule)throw new Error("unexpected: editingModule is undefined");let e,t=this.dialogBox.find("input[name=module-title]:visible").val();e=this.editingModule.isNewModule()?this.getSelectedPanelType():this.editingModule.getType();const r={};if(!t&&"html"!==e){t=this.radios.find("input:checked").attr("data-default-module-title")}return this.dialogBox.find(":input:visible").each(((e,t)=>{const n=(0,a.default)(t),i=n.attr("name");let o=n.val();if("module-title"===i)return;if("checkbox"===n.attr("type")&&(o=n.prop("checked")?1:0),"radio"===n.attr("type")&&!n.prop("checked"))return;if(!i)return;let s=r[i];void 0===s?s=o:Array.isArray(s)?s.push(String(o)):s=[String(s),String(o)],r[i]=s})),{type:e,title:t,value:r}}setLinkInput(e,t,r){let n,i=e.find(":input:visible").filter(((e,t)=>t.getAttribute("name")===r));const o=t[r];if(Array.isArray(o)){const t=o.length>i.length,s=t?o.length-i.length:i.length-o.length;for(let r=0;r<s;r++)t?(n=e.find(".link-input:visible").eq(0).clone(),n.find(":input").val(""),n.insertAfter(e.find(".link-input").eq(-1))):(n=e.find(".link-input:visible").eq(-1),n.remove());i=e.find(":input:visible").filter(((e,t)=>(0,a.default)(t).attr("name")===r)),i.each(((e,t)=>{(0,a.default)(t).val(o[e])}))}else{for(;i.length>1;)n=e.find(".link-input:visible").eq(-1),n.remove(),i=e.find(":input:visible").filter(((e,t)=>(0,a.default)(t).attr("name")===r));i.eq(0).val(o??"")}}}},4221:(e,t,r)=>{"use strict";e=r.nmd(e),Object.defineProperty(t,"__esModule",{value:!0}),t.Modules=void 0;var n=r(90539),i=s(r(65311)),a=s(r(49282)),o=r(78754);function s(e){return e&&e.__esModule?e:{default:e}}const l=o.z.object({type:o.z.string().nullable(),title:o.z.string(),value:o.z.record(o.z.union([o.z.string(),o.z.number(),o.z.array(o.z.string())]))}),d=o.z.array(l);function u(t){return Object.prototype.hasOwnProperty.call(e,"getElement")}t.Modules=class{constructor(e,t){this.$element=e,this.editor=t,this.modules=[],this.position="",this.init()}init(){this.position=this.$element.attr("data-modules-type"),this.$element.on("click",".js-add-module",(()=>(this.addNewModule(),!1))),this.$element.find(".module").each(((e,t)=>{this.addModuleFromElement((0,i.default)(t))}));const e=this.$element.find(".modules")[0];a.default.create(e,{animation:150,onUpdate:()=>{this.onSorted()}})}addModuleFromElement(e){const t=new n.Module(e);this.awareModule(t),t.render()}awareModule(e){this.modules.push(e),e.on("removed",(()=>{this.onModuleRemoved(e)})).on("updated",(()=>{this.onUpdated()})).on("edit",(()=>{this.editModule(e)}))}onSorted(){const e=this.$element.find(".module").map(((e,t)=>this.modules.find((e=>!!u()&&e.getElement()[0]===t)))).toArray();this.modules=d.parse(e),this.onUpdated()}onModuleRemoved(e){this.modules=this.modules.filter((t=>t===e)),this.onUpdated()}editModule(e){const t=this.editor.editModule(e);e.setAsSelected(),t.done((t=>{const{type:r,title:n,value:i}=l.parse(t);if(null===r)throw new Error("type is null");e.update(r,n,i)})).always((()=>{e.unsetAsSelected()}))}addNewModule(){const e=n.Module.initializeWithModulesPosition(this.position);e.setAsNewModule(),e.setAsSelected(),this.$element.find(".modules").append(e.getElement());this.editor.editNewModule(e).done((t=>{const{type:r,title:n,value:i}=l.parse(t);if(null===r)throw new Error("type is null");this.awareModule(e),e.update(r,n,i),e.unsetAsNewModule(),e.unsetAsSelected()})).fail((()=>{e.remove()}))}onUpdated(){(0,i.default)(this).triggerHandler("updated")}}},51634:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PreviewUpdater=void 0;var n=s(r(65311)),i=r(19575),a=r(78754),o=s(r(57942));function s(e){return e&&e.__esModule?e:{default:e}}const l=a.z.object({signature:a.z.string(),preview_token:a.z.string()});t.PreviewUpdater=class{constructor(e){this.$form=e.$form,this.$loading=e.$loading,this.$preview=e.$preview,this.formState=e.formState,this.$deviceInput=this.$form.find(":input[name=device]"),this.device=this.$deviceInput.val(),this.pageType="index",this.failedCount=0,this.serialized="",this.setupFormBase64UpdateEvent(this.$form.get(0),e.htmlFormNames)}setupFormBase64UpdateEvent(e,t){e.addEventListener("formdata",(e=>{const r=e.formData;t.forEach((e=>{const t=r.get(e);if(t&&"string"==typeof t){const n=(0,i.encode)(t.toString());r.set(`${e}.base64`,n),r.delete(e)}}))}))}setAsIndexPreview(){this.pageType="index"}setAsPermalinkPreview(){this.pageType="permalink"}getPageType(){return this.pageType}setDeviceAsPC(){this._setDevice("pc")}setDeviceAsTouch(){this._setDevice("touch")}_setDevice(e){this.device!==e&&(this.device=e,this.$deviceInput.val(this.device),this.requestPreview(),this.$preview.toggleClass("device-touch","touch"===e))}requestPreview(){const e=this.getSerialized();e!==this.serialized&&(this.serialized=e,this.preview())}preview(){if(this.failedCount>10)return;this.showEffect(),this.serialized||(this.serialized=this.getSerialized());this.getSignature().done((e=>{void 0!==e&&(this.onGotSignature(e),this.failedCount=0)})).fail((()=>{this.failedCount++,this.requestPreview()}))}getSerialized(){const e=this.$form.get(0),t=new FormData(e);return new URLSearchParams(t).toString()}getSignature(){const e=n.default.Deferred();return n.default.ajax({url:"../../preview/design",type:"post",dataType:"json",data:this.serialized}).done((t=>{if(this.serialized===this.getSerialized()){const r=l.parse(t);e.resolve(r)}else e.reject()})).fail((()=>{e.reject()})),e.promise()}onGotSignature(e){let{signature:t,preview_token:r}=e;const i=(0,n.default)("#preview-iframe"),a=i.clone();i.replaceWith(a),this.$preview=a;const o=this.$form,s=o.attr("action"),l=o.attr("target"),d=this.formState.isWatching;o.attr("action",this.getAction()),o.attr("target",this.$preview.attr("name"));const u=(0,n.default)("<textarea/>").attr("name","signature").val(t);u.appendTo(o);const c=(0,n.default)("<textarea/>").attr("name","token").val(r);c.appendTo(o),o.submit(),u.remove(),c.remove(),o.attr("action",s),o.attr("target",l),this.formState.isWatching=d}showEffect(){this.$loading.fadeIn("fast"),setTimeout((()=>{this.$loading.fadeOut("fast")}),1e3)}getAction(){return`${(0,o.default)("blogs-uri-base")}/preview/${this.pageType}_design`}}},95278:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TrimmingWindow=void 0;var n,i=(n=r(65311))&&n.__esModule?n:{default:n};const a=r(26410);t.TrimmingWindow=class{constructor(e){if(this.$container=e,this.$container.appendTo(document.body),this.session=i.default.Deferred(),this.session.reject(),!("Jcrop"in(t=i.default))||"function"!=typeof t.Jcrop)throw new Error;var t;this.jcrop=i.default.Jcrop(this.$container.find(".js-header-image-resizer"),{bgOpacity:"0.4",addClass:"jcrop-dark",allowSelect:!1,keySupport:!1,allowResize:!1}),this.$container.on("click",".js-header-image-apply-button",(()=>(this.save(),!1))).on("click",".js-header-image-cancel-button",(()=>(this.cancel(),!1)))}trim(e,t){return this.cancel(),this.session=i.default.Deferred(),this.session.always((()=>{this._hide()})),this.jcrop.setImage(e,(()=>{this.jcrop.setSelect(t),this._show()})),this.session.promise()}save(){this.session.resolve(this.jcrop.tellSelect())}cancel(){this.session.reject(this.jcrop.tellSelect())}_show(){a.show(this.$container,{center:!0,showBackground:!0,closeExplicitly:!0})}_hide(){a.hide(this.$container)}}},69503:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setupTextareaHider=function(){r.forEach((e=>{const[t,r]=e,n=document.querySelectorAll(`input[name=${t}]`);if(0===n.length)return;const i=document.querySelector(r);if(!i)return;const a=()=>{const e=document.querySelector(`input[name=${t}]:checked`);e&&("1"===e.value?i.style.display="none":i.style.display="block")};n.forEach((e=>{e.addEventListener("change",(()=>{a()}))})),a()}))};const r=[["header-touch-show-html-for-pc",".js-hide-on-header-touch-show-html-for-pc"],["display-touch",".js-hide-on-display-touch"],["footer-touch-show-html-for-pc",".js-hide-on-footer-touch-show-html-for-pc"],["header-touch-show-image-for-pc",".js-hide-on-header-touch-show-image-for-pc"]]},37448:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setupTouchHeaderImageComponent=function(e){const t=e.$container,r=e.previewUpdater,s={width:+t.attr("data-max-width"),height:+t.attr("data-max-height")},l=new a.HeaderImage(t,s),d=t.find(".js-header-image-item"),u=t.find(".js-header-image-thumbnail");(0,o.default)(l).on("updated",(()=>{l.getImageSrc()?(u.attr("src",l.getThumbnailSrc()).show(),d.show()):(u.hide(),d.hide()),r&&r.requestPreview()}));(0,i.initFotoUploader)(t.find(".js-header-image-input"),s.width).progress((e=>{l.setImage(e.url,e.fid)})),t.on("click",".js-delete-header-image",(()=>!!confirm(n.default.text("admin.design.stop_header_image_confirm"))&&(l.clear(),!1)))};var n=s(r(20996)),i=r(4291),a=r(72367),o=s(r(65311));function s(e){return e&&e.__esModule?e:{default:e}}},9304:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateLinkToCurrentTheme=function(e){const t=document.querySelector(".js-link-to-currently-selected-theme");t&&(e?(t.classList.remove("is-hidden"),t.setAttribute("href",e)):t.classList.add("is-hidden"))}},37255:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EditDesign=void 0;class r{constructor(e){this.data={},this.userCSS="",this.setCSS(e)}setCSS(e){const{userCSS:t,sectionCSSList:r}=this.scanCSS(e);this.userCSS=t,r.forEach((e=>{const{sectionName:t,selected:r,content:n}=this.scanSection(e);t&&this.setData(t,r,n)}))}scanCSS(e){const t=[];return{userCSS:e.replace(/\n?\/\* <system([^>]+)> \*\/\n*([\s\S]+?)\n*\/\* <\/system> \*\/\n?/g,(e=>(t.push(e),""))),sectionCSSList:t}}scanSection(e){const t=e.match(/\n?\/\* <system([^>]+)> \*\/\n*([\s\S]+?)\n*\/\* <\/system> \*\/\n?/);if(!t)throw new Error("scanSection failed");const[,r,n]=t,i={};return r.replace(/(\S+)="([^"]+)"/g,((e,t,r)=>(i[t]=r,""))),{sectionName:i.section,selected:i.selected,content:n}}getCSS(){const e=[];return new Set([r.sections,Object.keys(this.data).sort()].flat()).forEach((t=>{e.push(this.getSectionAsCSS(t))})),e.push(this.userCSS),e.join("").trim()}getSectionAsCSS(e){if(!this.data[e])return"";const t=this.data[e];return[`\n/* <system section="${e}" selected="${t.selected}"> */`,`${t.content}`,"/* </system> */\n"].join("\n")}getData(e){if(Object.prototype.hasOwnProperty.call(this.data,e))return this.data[e]}setData(e,t,r){this.data[e]={selected:t,content:r}}}var n,i,a;t.EditDesign=r,n=r,a=["theme","background"],(i=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(i="sections"))in n?Object.defineProperty(n,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[i]=a},17723:e=>{"use strict";e.exports=class{setModalDisabled(){try{localStorage["Hatena.Diary.Admin.User.Blog.Edit.Done.ExternalAuthModal.disabled"]=!0}catch(e){}}isModalDisabled(){try{return!!localStorage["Hatena.Diary.Admin.User.Blog.Edit.Done.ExternalAuthModal.disabled"]}catch(e){}}}},26028:(e,t,r)=>{"use strict";var n,i=(n=r(57942))&&n.__esModule?n:{default:n};const a=r(26410),o=r(17723);e.exports=class{constructor(e){this.$el=e,this.modal=new o,this.$el.length&&!this.modal.isModalDisabled()&&this.showModal(),this.$el.on("click","button",(()=>{window.open(`${(0,i.default)("admin-domain")}/-/config/external`)})),this.$el.on("click",".js-skip-button",(()=>(this.$el.find(".js-non-display-checkbox").prop("checked")&&this.modal.setModalDisabled(),this.hideModal(),!1)))}showModal(){a.show(this.$el,{center:1,showBackground:!0})}hideModal(){a.hide(this.$el)}}},49634:(e,t,r)=>{"use strict";var n,i=(n=r(76804))&&n.__esModule?n:{default:n};e.exports=class{constructor(e,t,r,n,i){this.url=e,this.width=t,this.height=r,this.screenWidth=n,this.screenHeight=i,this.setLeft(),this.setTop(),this.openWindow()}setLeft(){this.left=Math.floor((this.screenWidth-this.width)/2)}setTop(){this.top=Math.floor((this.screenHeight-this.height)/2)}openWindow(){window.open(this.url,"share_window",(0,i.default)({width:this.width,height:this.height,left:this.left,top:this.top,scrollbars:"yes"}))}}},67677:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TwitterShareForm=void 0;var n=s(r(65311)),i=s(r(57942)),a=r(13964),o=s(r(20996));function s(e){return e&&e.__esModule?e:{default:e}}t.TwitterShareForm=class{constructor(e,t,r,n,i,a){this.$shareForm=e,this.$textarea=this.$shareForm.find(".js-share-message"),this.userNameSelector=i,this.$shareSuccessMessage=t,this.$shareExecuteButton=this.$shareForm.find(".js-share-execute-button"),this.accountSelectBox=n,this.entryId=a,this.serviceName="twitter",this.isPosted=!1,this.isShareButtonDisabled=!1,this.officialTweetButton=r,this.initEvents()}initEvents(){this.updateShareExecuteButton(),this.hideShareSuccessMessage(),this.$textarea.on("input",(()=>{this.validateMessage(this.$textarea.val())?(this.$shareForm.find(".js-validation-error").hide(),this.isShareButtonDisabled=!1,this.updateShareExecuteButton()):(this.$shareForm.find(".js-validation-error").show(),this.isShareButtonDisabled=!0,this.updateShareExecuteButton())})),this.userNameSelector.addEventListener("change",(()=>{this.updateShareExecuteButton()})),this.$shareExecuteButton.on("click",(e=>{if(e.preventDefault(),this.isPosted||this.isShareButtonDisabled)return;const t=this.$textarea.val(),r=this.getUserName();this.validateMessage(t)&&r&&this.post(t,r)}))}getUserName(){return this.userNameSelector.checked?this.userNameSelector.value:""}updateShareExecuteButton(){!this.getUserName()||this.isShareButtonDisabled||this.isPosted?(this.$shareExecuteButton.prop("disabled",!0),this.$shareForm.hide(),this.officialTweetButton.style.visibility="visible"):(this.$shareExecuteButton.prop("disabled",!1),this.$shareForm.show(),this.officialTweetButton.style.visibility="hidden")}validateMessage(e){return(0,a.validateTweetLength)(e)}showShareSuccessMessage(){this.$shareSuccessMessage.find("p").text(o.default.text("blog.social.share.success",o.default.text(`blog.social.service.name.${this.serviceName}`))),this.$shareSuccessMessage.show()}hideShareSuccessMessage(){this.$shareSuccessMessage.hide()}post(e,t){window.confirm(`${o.default.text("blog.edit_done.confirm.tweet")}\n${e}`)&&(this.isPosted=!0,this.updateShareExecuteButton(),n.default.ajax({url:"post_to_social_service",type:"POST",data:{rkm:(0,i.default)("rkm"),rkc:(0,i.default)("rkc"),service_name:this.serviceName,entry_id:this.entryId,user_name:t,message:e}}).done((()=>{this.$shareForm.hide(),this.accountSelectBox.style.display="none",this.showShareSuccessMessage()})).fail((()=>{this.isPosted=!1})))}}},34525:(e,t,r)=>{"use strict";var n=o(r(65311)),i=o(r(66419)),a=r(92008);function o(e){return e&&e.__esModule?e:{default:e}}const s=r(64300);e.exports=class{constructor(){this.load()}load(){n.default.ajax({url:"categories.json"}).done((e=>{this.onLoaded(e)}))}reload(){this.load()}onLoaded(e){this.categories?(this.newCategories=[],i.default.each(e.categories,(e=>{var t=this.getCategory(e.name);t?t.setEntriesCount(e.count):(t=new a.Category(e),this.categories.push(t),this.newCategories.push(t))}))):(this.categories=i.default.map(e.categories,(e=>new a.Category(e))),this.newCategories=this.categories),s.categories=this,(0,n.default)(this).triggerHandler("loaded")}getNewCategories(){return this.newCategories}getCategory(e){return i.default.find(this.categories,(t=>t.getName()===e))}}},10281:(e,t,r)=>{"use strict";const n=r(65311);e.exports=class{constructor(){this.$dropdown=n(".js-category-dropdown-list"),this.$dropdownToggle=n(".js-category-dropdown-toggle"),this.$dropdownToggle.on("click",(()=>(this.toggleDropdown(),!1))),n(document).on("click",(()=>{this.hideDropdown()}))}toggleDropdown(){this.$dropdown.toggle()}hideDropdown(){this.$dropdown.hide()}}},69864:(e,t,r)=>{"use strict";var n,i=(n=r(20996))&&n.__esModule?n:{default:n},a=r(24367);const o=r(65311),s=r(66419),l=r(11135),d=r(45660);e.exports=class{constructor(e,t){this.categories=e,this.entries=t,this.$categoriesSelector=o(".js-categories-selector"),this.$createNewCategory=o(".js-create-new-category"),o(e).on("loaded",(()=>{this.render()})),o(".js-create-new-category").on("click",(()=>{const e=(0,a.formatCategoryName)(window.prompt(i.default.text("create_category")));if(!e)return;this.entries.addCategoryToSelectedEntries(e).always((()=>{this.categories.reload()}))}))}render(){s.each(this.categories.getNewCategories(),(e=>{const t=new d(e);this.$categoriesSelector.append(t.getElement());const r=new l(e,this.entries);this.$createNewCategory.before(r.getElement())}))}}},92008:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Category=void 0;var n,i=(n=r(65311))&&n.__esModule?n:{default:n};t.Category=class{constructor(e){this.data=e}getName(){return this.data.name}getEntriesCount(){return this.data.count}setEntriesCount(e){this.data.count=e,(0,i.default)(this).triggerHandler("change")}}},11135:(e,t,r)=>{"use strict";const n=r(65311),i=r(64300);e.exports=class{constructor(e,t){this.category=e,this.entries=t,this.render(),this.$element.on("click",(()=>{this.entries.addCategoryToSelectedEntries(this.category.getName()).always((()=>{i.categories.reload()}))})),n(this.category).on("change",(()=>{this.render()}))}render(){this.$element||(this.$element=n("<li>"));const e=this.category.getName(),t=this.category.getEntriesCount();this.$element.text(`${e} (${t})`)}getElement(){return this.$element}}},45660:(e,t,r)=>{"use strict";r(65311);e.exports=class{constructor(e){this.category=e,this.render()}render(){if(!this.element){this.element=document.createElement("option");const e=this.category.getName();this.element.setAttribute("value",`category-${e}`),this.element.textContent=e}}getElement(){return this.element}}},64300:e=>{"use strict";e.exports={entries:null,categories:null}},99266:(e,t,r)=>{"use strict";var n,i=(n=r(57942))&&n.__esModule?n:{default:n};const a=r(65311),o=r(66419),s=r(64300),l=r(60191);e.exports=class{load(){const e={};this.keyword&&(e.q=this.keyword),this.category&&("unset"===this.category?e.unset_categories=!0:e.category=this.category.slice(9)),this.hatenaId&&(e.hatena_id=this.hatenaId),this.datetimeFrom&&(e.datetime_from=this.datetimeFrom),this.datetimeTo&&(e.datetime_to=this.datetimeTo),"all"!==this.getPermission()&&(e.permission=this.getPermission());const t=o.last(this.entries);t&&(e.until=t.getCreatedTime()/1e3),a.ajax({url:"entries.json",data:e}).done((e=>{this.onLoaded(e)}))}onLoaded(e){const t=a(this);this.receivedEntries=o.map(e.entries,(e=>new l(e))),a(this.receivedEntries).on("select",(()=>{t.triggerHandler("select")})).on("remove",(()=>{t.triggerHandler("remove")})),this.entries||(this.entries=[]),this.entries=this.entries.concat(this.receivedEntries),this.hasMore=e.has_more,s.entries=this,a(this).triggerHandler("loaded")}reset(){o.each(this.entries,(e=>{e.remove()})),this.entries=[],this.receivedEntries=[],this.hasMore=void 0,a(this).triggerHandler("reset"),this.load()}getEntries(){return this.entries}getReceivedEntries(){return this.receivedEntries}hasMoreEntries(){return this.hasMore}setKeyword(e){this.keyword=e}getKeyword(){return this.keyword}setCategory(e){this.category=e}setHatenaID(e){this.hatenaId=e}setDatetimeFrom(e){this.datetimeFrom=e}setDatetimeTo(e){this.datetimeTo=e}setPermission(e){this.permission=e,a(this).triggerHandler("permissionChanged",e)}getPermission(){return this.permission}getSelectedEntries(){return o.filter(this.entries,(e=>e.isSelected()))}deleteSelectedEntries(){const e=this.getSelectedEntries();if(!e.length)return;const t=a.ajax({type:"post",url:"entries.delete.json",data:{entry:o.map(e,(e=>e.getUUID())),rkm:(0,i.default)("rkm"),rkc:(0,i.default)("rkc")},traditional:!0});return t.done((()=>{this.entries=o.difference(this.entries,e),o.each(e,(e=>{e.remove()}))})),t}addCategoryToSelectedEntries(e){const t=this.getSelectedEntries();if(!t.length)return;o.each(t,(t=>{t.addCategory(e)}));return a.ajax({type:"post",url:"entries.add_category.json",data:{entry:o.map(t,(e=>e.getUUID())),category:e,rkm:(0,i.default)("rkm"),rkc:(0,i.default)("rkc")},traditional:!0})}}},27866:(e,t,r)=>{"use strict";const n=r(65311);e.exports=class{constructor(e){this.$element=n(e)}show(){this.$element.stop().show().delay(1e4).fadeOut()}}},29130:(e,t,r)=>{"use strict";var n,i=(n=r(20996))&&n.__esModule?n:{default:n},a=r(79855);function o(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const s=r(65311),l=r(66419),d=r(64300),u=r(202),c=r(27866);e.exports=class{constructor(e){o(this,"isSetSearchFormParam",(()=>[this.$keywordField,this.$categoryField,this.$hatenaIdField,this.$datetimeFromField,this.$datetimeToField].some((e=>!!e.val())))),this.entries=e;var t=s(e);this.entriesDeletedView=new c(document.querySelector(".js-entry-deleted-message")),this.scheduledUpdateCanceledView=new c(document.querySelector(".js-scheduled-update-canceled-message")),this.$entriesContainer=s(".js-entries-container"),this.$loadNextPage=s(".js-load-next-page"),this.$form=s(".js-entry-search-form"),this.$keywordField=this.$form.find(':input[name="q"]'),this.$categoryField=this.$form.find(':input[name="category"]'),this.$hatenaIdField=this.$form.find(':input[name="hatena_id"]'),this.$datetimeFromField=this.$form.find(':input[name="datetime_from"]'),this.$datetimeToField=this.$form.find(':input[name="datetime_to"]'),this.entriesAdvancedSearchButton=document.querySelector(".js-entries-advanced-search"),this.resetFormButton=document.querySelector(".js-entry-search-form-reset"),t.on("loaded",(()=>{this.render()})),t.on("select remove",(()=>{this.renderButtons()})),this.$loadNextPage.on("click",(()=>{this.entries.load()})),s(".js-delete-entries-button").on("click",(()=>{const e=this.entries.getSelectedEntries().length;confirm(i.default.text("epic.entry.delete.confirm_with_entries_num",e))&&this.entries.deleteSelectedEntries().always((()=>{d.categories.reload(),this.entriesDeletedView.show()}))})),this.entriesAdvancedSearchButton.addEventListener("click",(()=>{this.entriesAdvancedSearchButton.classList.contains("open")?this.closeEntriesAdvancedSearchBox():this.openEntriesAdvancedSearchBox()})),this.$form.on("submit",(t=>{t.preventDefault(),e.setKeyword(this.$keywordField.val()),e.setCategory(this.$categoryField.val()),e.setHatenaID(this.$hatenaIdField.val()),e.setDatetimeFrom(this.$datetimeFromField.val()),e.setDatetimeTo(this.$datetimeToField.val()),e.reset()})),s(".js-select-all-entries").on("change",(t=>{s(t.currentTarget).is(":checked")?e.getEntries().forEach((e=>{e.select()})):e.getEntries().forEach((e=>{e.unselect()})),this.renderButtons()})),new URL(window.location.href).searchParams.get("deleted")&&this.entriesDeletedView.show(),new URL(window.location.href).searchParams.get("scheduled_update_canceled")&&this.scheduledUpdateCanceledView.show(),this.$form.on("change",(()=>{this.renderResetButton()})),s(".js-entry-search-box-input").on("input",(()=>{this.renderResetButton()})),document.querySelector(".js-entry-search-form").addEventListener("reset",(()=>{this.resetEntriesSearch(),e.reset(),this.resetFormButton.style.display="none"})),a.EntryListDropdownView.setupCloseHandler()}render(){l.each(this.entries.getReceivedEntries(),(e=>{const t=new u(e);this.$entriesContainer.append(t.getElement())})),this.entries.hasMoreEntries()?this.$loadNextPage.show():this.$loadNextPage.hide(),this.renderButtons(),s(this).triggerHandler("rendered")}renderButtons(){const e=s(".js-delete-entries-button"),t=s(".js-category-dropdown-toggle");this.entries.getSelectedEntries().length>0?(e.prop("disabled",!1).removeClass("disabled").addClass("btn-danger"),t.prop("disabled",!1).removeClass("disabled")):(e.prop("disabled",!0).addClass("disabled").removeClass("btn-danger"),t.prop("disabled",!0).addClass("disabled"))}closeEntriesAdvancedSearchBox(){this.entriesAdvancedSearchButton.classList.remove("open"),document.querySelector(".js-table-blog-entries-advanced-search").style.display="none"}openEntriesAdvancedSearchBox(){this.entriesAdvancedSearchButton.classList.add("open"),document.querySelector(".js-table-blog-entries-advanced-search").style.display="block"}resetEntriesSearch(){this.entries.setKeyword(void 0),this.entries.setCategory(void 0),this.entries.setHatenaID(void 0),this.entries.setDatetimeFrom(void 0),this.entries.setDatetimeTo(void 0)}renderResetButton(){this.isSetSearchFormParam()?this.resetFormButton.style.display="":this.resetFormButton.style.display="none"}}},60191:(e,t,r)=>{"use strict";var n,i=(n=r(23218))&&n.__esModule?n:{default:n};const a=r(65311),o=r(66419);e.exports=class{constructor(e){this.data=e}getUUID(){return this.data.uuid}getURL(){return this.data.url}getEditURL(){return this.data.edit_url}getEditScheduledUpdateURL(){return this.data.edit_scheduled_update_url}getRevisionsURL(){return this.data.revisions_url}getMakingACopyURL(){return this.data.making_a_copy_url}getTitle(){return this.data.title}getSummary(){return this.data.summary}getThumbnailImage(){if(this.data.thumbnails&&this.data.thumbnails[60])return this.data.thumbnails[60]}getCreated(){return this.data.created}getCreatedTime(){return this.getCreatedDate().getTime()}getCreatedDate(){return(0,i.default)(this.data.created)}getDatetime(){return this.data.datetime}getDatetimeTime(){var e=this.getDatetimeDate();return e?e.getTime():null}getDatetimeDate(){return(0,i.default)(this.data.datetime)}getAuthorName(){return this.data.author_name}getCommentCount(){return this.data.comment_count}getCategories(){return this.data.categories}isPublic(){return this.data.is_public}isScheduledEntry(){return this.data.is_scheduled_entry}hasScheduledUpdate(){return!!this.data.scheduled_update_at}getScheduledUpdateAt(){return this.data.scheduled_update_at}getScheduledUpdateDate(){return(0,i.default)(this.data.scheduled_update_at)}getScheduledUpdateTime(){return this.getScheduledUpdateDate().getTime()}select(){this.data.isSelected=!0,a(this).triggerHandler("change")}unselect(){this.data.isSelected=!1,a(this).triggerHandler("change")}isSelected(){return this.data.isSelected}remove(){a(this).triggerHandler("remove")}addCategory(e){o.contains(this.data.categories,e)||(this.data.categories||(this.data.categories=[]),this.data.categories.push(e),a(this).triggerHandler("change"))}canBeManageEntry(){return this.data.can_be_manage_entry}canCreateDraftPreviewToken(){return this.data.can_create_draft_preview_token}}},79855:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EntryListDropdownView=void 0;var n,i=(n=r(65311))&&n.__esModule?n:{default:n};class a{constructor(e){this.$dropdown=e,this.$dropdown.find(".dropdown-toggle").on("click",(e=>{e.preventDefault(),e.stopPropagation();const t=(0,i.default)(e.currentTarget).next(".dropdown-window"),r=t.hasClass("is-open");a.closeAllDropdowns(),r?t.removeClass("is-open"):t.addClass("is-open")}))}static closeAllDropdowns(){(0,i.default)(".dropdown-window").removeClass("is-open")}static setupCloseHandler(){(0,i.default)(document).on("click",(()=>{this.closeAllDropdowns()}))}}t.EntryListDropdownView=a},50825:(e,t,r)=>{"use strict";const n=r(65311);e.exports=class{constructor(e){this.entries=e,this.$tabs=n(".js-entry-type-select-tabs"),this.$tabs.on("click","a",(e=>{this.clicked(e)}));const t=this.$tabs.find(".ui-tabs-active").find("a").attr("data-permission");this.entries.setPermission(t)}clicked(e){e.preventDefault(),this.$tabs.find(".ui-tabs-active").removeClass("ui-tabs-active"),n(e.target).parents("li").addClass("ui-tabs-active");var t=n(e.target).attr("data-permission");this.entries.getPermission()!==t&&(this.entries.setPermission(t),this.entries.reset())}}},202:(e,t,r)=>{"use strict";var n,i=(n=r(20996))&&n.__esModule?n:{default:n},a=r(79855);const o=r(65311),s=r(66419),l=r(64300);e.exports=class{constructor(e){this.entry=e,this.permission=o(".ui-tabs-active a")[0].dataset.permission,this.rootTemplate=s.template(o(".js-entry-root-template").html().replace(/^\s*/,"").replace(/\s*$/,"")),this.elementTemplate=s.template(o(".js-entry-inner-template").html()),this.render(),o(this.entry).on("change",(()=>{this.render()})).on("remove",(()=>{this.remove()})),this.$element.on("change","input",(e=>{o(e.currentTarget).is(":checked")?this.entry.select():this.entry.unselect(),o(this.entry).triggerHandler("select")}))}render(){if(this.$element||(this.$element=o(o.parseHTML(this.rootTemplate({entry:this.entry,permission:this.permission})))),this.$element.html(this.elementTemplate({entry:this.entry,permission:this.permission})),l.entries&&l.entries.getKeyword()){var e=s.escape(l.entries.getKeyword());this.$element.find(".js-search-entry-title").html(((t,r)=>{const n=`<span class="entry-search-keyword">${e}</span>`;return r.split(e).join(n)})),this.$element.find(".js-search-entry-body").html(((t,r)=>{const n=`<span class="entry-search-keyword">${e}</span>`;return r.split(e).join(n)}))}new a.EntryListDropdownView(this.$element),i.default.updateTimestamps(this.$element[0])}remove(){this.$element.remove()}getElement(){return this.$element}}},90847:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HatenaIdDataList=void 0;var n,i=(n=r(347))&&n.__esModule?n:{default:n},a=r(70879);class o{constructor(){this.container=document.querySelector(".js-hatena-ids-selector"),o._load().then((e=>{void 0!==e&&(this.data=e,this._render())}))}static async _load(){try{return(await i.default.get("./entries_member.json")).data}catch(e){return void(0,a.BUG)(e,"Load entries member")}}_render(){if(this.container)for(const e of this.data.members){const t=document.createElement("option");t.value=e.name,this.container.appendChild(t)}}}t.HatenaIdDataList=o},10256:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShareDraftBox=void 0;var n=o(r(65311)),i=r(55992),a=o(r(57942));function o(e){return e&&e.__esModule?e:{default:e}}t.ShareDraftBox=class{constructor(e){this.section=(0,n.default)("section")[0],this.$shareBoxWrapper=(0,n.default)(".js-share-draft-box-wrapper"),this.$shareBox=(0,n.default)(".js-share-draft-box"),this.$tokenInput=this.$shareBox.find("input"),this.$closeButton=this.$shareBox.find(".btn-close"),this.$mask=this.$shareBoxWrapper.find(".mask"),this.pos={top:-9999,left:-9999},(0,n.default)(e).on("rendered",(()=>{this.initEvent()}))}initEvent(){this.$shareButton=(0,n.default)(".js-icon-share-draft"),this.$shareButton.on("click",(e=>{const t=e.currentTarget,r=this.section.getBoundingClientRect(),i=t.getBoundingClientRect();this.setWindowPosition({top:i.bottom-r.top,left:i.right-r.left});const a=(0,n.default)(t).data("publicationType"),o=(0,n.default)(t).data("uuid");return this.openShareDraftWindow(a,o),!1})),this.$closeButton.on("click",(()=>(this.closeShareDraftWindow(),!1))),this.$mask.on("click",(()=>(this.closeShareDraftWindow(),!1)))}setWindowPosition(e){this.pos=e}openShareDraftWindow(e,t){const r={rkm:(0,a.default)("rkm"),rkc:(0,a.default)("rkc"),publication_type:e,uuid:t};n.default.ajax({url:"./share_existing_draft",type:"POST",dataType:"json",data:r}).done((t=>{this.$shareBoxWrapper.addClass("visible");const r=+this.$shareBox.css("margin").slice(0,-2),n=this.pos.top+this.$shareBox[0].getBoundingClientRect().height+2*r-this.section.offsetHeight;n>0&&(this.pos.top=Math.max(this.pos.top-n+10,20)),this.$shareBox.css(this.pos);const a=t.token,o=(0,i.userBlogUrl)(`/draft/${e}/${a}`);this.$tokenInput.val(o).focus().select()}))}closeShareDraftWindow(){this.$shareBoxWrapper.removeClass("visible")}}},21593:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TopPlacedActivateButtonsHandler=void 0;var n=a(r(65311)),i=a(r(20996));function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}t.TopPlacedActivateButtonsHandler=class{constructor(e){o(this,"_setupActivateButtonListeners",(()=>{(0,n.default)(this.entriesView).on("rendered",(()=>{(0,n.default)(".js-top-placed-activate-button").on("click",(e=>{const t=e.currentTarget;e.stopPropagation(),e.preventDefault(),t.disabled=!0;const r=t.dataset.uuid;if(!r)return t.disabled=!1,!1;if(!window.confirm(i.default.text("admin.entries.top_placed_publication.confirm_activation")))return t.disabled=!1,!1;const n=this.switcherPanel.getBlogId();if(!n)return t.disabled=!1,!1;const a=this._successfulActivationHandlerGenerator(t),o=this._errorActivationHandlerGenerator(t);this.controller.activate(n,r).then(a).catch(o)}))}))})),o(this,"_topPlacedEntryLabelFactory",((e,t,r)=>e&&""!==e?e:t?t.substr(0,30):r)),o(this,"_successfulActivationHandlerGenerator",(e=>()=>{this.switcherPanel.isPublicationTopPlaced()?window.alert(i.default.text("admin.entries.top_placed_publication.activated_overwritten")):window.alert(i.default.text("admin.entries.top_placed_publication.activated"));const t=e.dataset.url,r=e.dataset.title,n=e.dataset.summary,a=this._topPlacedEntryLabelFactory(r,n,t);this.switcherPanel.configureTopPlacedPublication(a,t),e.disabled=!1})),o(this,"_errorActivationHandlerGenerator",(e=>t=>{throw t.response&&404===t.response.status?window.alert(i.default.text("admin.entries.top_placed_publication.not_found")):window.alert(i.default.text("admin.entries.top_placed_publication.comm_failed")),e.disabled=!1,t})),this.controller=e.controller,this.switcherPanel=e.switcherPanel,this.entriesView=e.entriesView,this._setupActivateButtonListeners()}}},13118:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TopPlacedEntrySwitcher=void 0;var n=a(r(20996)),i=a(r(65311));function a(e){return e&&e.__esModule?e:{default:e}}t.TopPlacedEntrySwitcher=class{constructor(e){this.controller=e.controller,this.containerSet=e.containerSet;const t=this.containerSet.querySelector(".js-deactivate-button");if(!t)throw Error(".js-deactivate-button and .js-top-publication-name-box required");this.deactivateButton=t,this._updateVisibility(),this._registerEvents()}_registerEvents(){this.deactivateButton.addEventListener("click",(e=>{e.stopPropagation(),e.preventDefault(),this.deactivateButton.setAttribute("disabled","1");const t=this.getBlogId();if(!t)return this.deactivateButton.removeAttribute("disabled");if(!window.confirm(n.default.text("admin.entries.top_placed_publication.confirm_deactivation")))return this.deactivateButton.removeAttribute("disabled");this.controller.deactivate(t).then((()=>{window.alert(n.default.text("admin.entries.top_placed_publication.deactivated")),this._inactivateTopPlacedPublication(),this.deactivateButton.removeAttribute("disabled")})).catch((e=>{throw window.alert(n.default.text("admin.entries.top_placed_publication.comm_failed")),this.deactivateButton.removeAttribute("disabled"),e}))})),(0,i.default)(".js-entry-type-select-tabs a").on("click",(e=>{e.target instanceof HTMLElement&&this._updateVisibility(e.target.dataset.permission)}))}getBlogId(){return this.containerSet.dataset.blogUuid}_getChosenTab(){const e=document.querySelector(".ui-tabs-active > a");if(null===e)throw Error(".ui-tabs-active > a required");return e.dataset.permission}_updateVisibility(e){"public"===(e||this._getChosenTab())&&this.isPublicationTopPlaced()?this.containerSet.classList.add("is-open"):this.containerSet.classList.remove("is-open")}isPublicationTopPlaced(){return"set"===this.containerSet.dataset.isTopPlaced}configureTopPlacedPublication(e,t){const r=this.containerSet.querySelector(".js-top-placed-entry-title");r&&(r.innerText=e,r.setAttribute("href",t),this.containerSet.dataset.isTopPlaced="set",this._updateVisibility())}_inactivateTopPlacedPublication(){this.containerSet.dataset.isTopPlaced="unset",this._updateVisibility()}}},46044:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Item=void 0;var n=r(17187),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=a(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,r&&r.set(e,n);return n}(r(78265));function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(a=function(e){return e?r:t})(e)}var o=function(e){return e.NEW="new",e.UPLOADING="uploading",e.SUCCESS="success",e.FAILED="failed",e}(o||{});class s extends n.EventEmitter{constructor(e,t){super(),this.folder=t,this.file=e,this.publicURL=null,this.uploadedAt=null,this.fileInfo={filename:this.file.name,contentType:this.file.type,previewURL:this.file.preview,isImage:i.isImage(this.file.type)},this.uploadStatus=o.NEW}getFile(){return this.file}getFolder(){return this.folder}getContentType(){return this.fileInfo.contentType}isWaitingForUpload(){return this.uploadStatus===o.NEW}hasUploadStarted(){return this.uploadStatus!==o.NEW}isUploading(){return this.uploadStatus===o.UPLOADING}isSuccess(){return this.uploadStatus===o.SUCCESS}isFailed(){return this.uploadStatus===o.FAILED}isCompleted(){return this.isSuccess()||this.isFailed()}emitChange(){this.emit("change")}uploadStart(){this.uploadStatus=o.UPLOADING,this.emitChange()}uploadSuccess(e){this.uploadStatus=o.SUCCESS,this.publicURL=e,this.uploadedAt=new Date,delete this.file,this.emitChange()}uploadFailed(){this.uploadStatus=o.FAILED,delete this.file,this.emitChange()}getState(){return{...this.fileInfo,publicURL:this.publicURL,uuid:null,hasUploadStarted:this.hasUploadStarted(),isUploading:this.isUploading(),isSuccess:this.isSuccess(),isFailed:this.isFailed(),uploadedAt:this.uploadedAt,showPreview:!0}}}t.Item=s},66977:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ItemsRepository=void 0;var n=r(17187),i=r(46044),a=r(55171),o=r(94676),s=r(8251);class l extends n.EventEmitter{constructor(e){super(),this.items=[],this.previousItems=[],this.uploadQueue=[],this.folder=e}emitChange(){this.emit("change")}loadPreviousItems(){(0,a.loadPreviousItems)().then((e=>{this.previousItems=e,this.emitChange()}))}filesDropped(e){const t=e.map((e=>{const t=new i.Item(e,this.folder);return t.on("change",(()=>{this.checkForUpload(),this.emitChange()})),t}));this.items=t.concat(this.items),this.uploadQueue=this.uploadQueue.concat(t),this.checkForUpload(),this.emitChange()}checkForUpload(){const e=this.uploadQueue[0];if(e)return e.isCompleted()?(this.uploadQueue.shift(),void this.checkForUpload()):void(e.isWaitingForUpload()&&(0,o.uploadItem)(e))}async deleteItem(e){await(0,s.deleteItem)(e),this.previousItems=this.previousItems.filter((t=>t.uuid!==e.uuid)),this.emitChange()}getState(){return{folder:this.folder,items:this.items.map((e=>e.getState())),previousItems:this.previousItems.map((e=>e.getState()))}}}t.ItemsRepository=l},78265:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isWebP=t.isSVG=t.isImage=void 0;t.isImage=e=>null!==e.match(/^image\//i);t.isSVG=e=>"image/svg+xml"===e;t.isWebP=e=>"image/webp"===e},75651:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PreviousItem=void 0;var n=r(78265);t.PreviousItem=class{constructor(e){this.filename=e.filename,this.uuid=e.uuid,this.contentType=e.contentType,this.uploadedAt=new Date(1e3*e.uploadedAt),this.publicURL=e.publicURL}getState(){return{filename:this.filename,uuid:this.uuid,contentType:this.contentType,isImage:(0,n.isImage)(this.contentType),uploadedAt:this.uploadedAt,previewURL:this.publicURL,publicURL:this.publicURL,hasUploadStarted:!1,isUploading:!1,isSuccess:!1,isFailed:!1,showPreview:!1}}}},44711:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CopyButton=void 0;var n=a(r(67294)),i=a(r(20996));function a(e){return e&&e.__esModule?e:{default:e}}t.CopyButton=e=>{let{item:t,onClick:r}=e;return t.publicURL?n.default.createElement("div",{className:"uploader-items-copy-btn"},n.default.createElement("button",{type:"button",onClick:r,className:"btn"},i.default.text("epic.file_uploader.copy"))):null}},53214:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DeleteButton=void 0;var n=a(r(67294)),i=a(r(20996));function a(e){return e&&e.__esModule?e:{default:e}}t.DeleteButton=e=>{let{item:t,deleteFile:r}=e;return n.default.createElement("div",{className:"uploader-items-delete-btn"},n.default.createElement("button",{type:"button",onClick:()=>{confirm(i.default.text("epic.file_uploader.delete.alert"))&&r(t)},className:"btn btn-danger"},i.default.text("epic.file_uploader.delete")))}},81757:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileContainerComponent=void 0;var n=s(r(27484)),i=s(r(67294)),a=r(55992),o=s(r(20996));function s(e){return e&&e.__esModule?e:{default:e}}t.FileContainerComponent=e=>{let{item:t}=e;return i.default.createElement("div",{className:"uploader-items-file-container"},i.default.createElement("div",{className:"uploader-items-filename"},i.default.createElement("a",{href:t.publicURL||void 0,target:"_blank",rel:"noopener noreferrer",className:"uploader-items-filename-link"},t.filename)),t.isUploading&&i.default.createElement("img",{src:(0,a.staticUrl)("/images/loading.gif"),alt:o.default.text("loading"),className:"loading-spinner"}),t.isSuccess&&i.default.createElement("span",{className:"badge badge-success"},"done"),t.isFailed&&i.default.createElement("span",{className:"badge badge-warning"},"failed"),t.uploadedAt&&i.default.createElement("div",{className:"uploader-items-date"},(0,n.default)(t.uploadedAt).format("YYYY/MM/DD HH:mm")))}},33858:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ItemRowComponent=void 0;var n=u(r(67294)),i=r(67426),a=r(21497),o=r(44711),s=r(53214),l=r(81757),d=u(r(20996));function u(e){return e&&e.__esModule?e:{default:e}}t.ItemRowComponent=e=>{let{input:t,copied:r,item:u,onClickCopyButton:c,onClickPublicURL:p,onClickDeleteButton:f}=e;return n.default.createElement("tr",null,n.default.createElement(i.PreviewHeading,{item:u}),n.default.createElement("td",{className:"uploader-items-item"},n.default.createElement(l.FileContainerComponent,{item:u}),n.default.createElement("div",{className:"uploader-items-url-container"},n.default.createElement("div",{className:"uploader-items-url-txtarea-content"},n.default.createElement(a.PublicURL,{item:u,inputRef:t,onClick:p})),n.default.createElement("div",{className:"uploader-items-url-btn-container"},n.default.createElement(o.CopyButton,{item:u,onClick:c})),!u.showPreview&&n.default.createElement("div",{className:"uploader-items-url-btn-container"},n.default.createElement(s.DeleteButton,{item:u,deleteFile:f}))),n.default.createElement("div",{className:"uploader-items-copy-msg"},r&&d.default.text("epic.file_uploader.copied"))))}},78559:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ItemsComponent=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n},a=r(26441);t.ItemsComponent=e=>{let{items:t,headlineText:r,deleteItem:n}=e;return i.default.createElement(i.default.Fragment,null,t.length>0&&i.default.createElement("div",{className:"uploader-items","data-testid":"uploader-items"},i.default.createElement("h1",null,r),i.default.createElement("table",{className:"uploader-items-table table"},i.default.createElement("tbody",null,t.map(((e,r)=>i.default.createElement(a.ItemRow,{item:e,key:t.length-r,deleteItem:n})))))))}},54573:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Preview=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n},a=r(90855);t.Preview=e=>{let{item:t}=e;return i.default.createElement("div",{className:"uploader-items-preview"},t.publicURL?i.default.createElement("a",{href:t.publicURL,target:"_blank",rel:"noopener noreferrer"},i.default.createElement(a.Thumbnail,{filename:t.filename,isImage:t.isImage,previewURL:t.previewURL})):i.default.createElement(a.Thumbnail,{filename:t.filename,isImage:t.isImage,previewURL:t.previewURL}))}},67426:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PreviewHeading=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n},a=r(54573);t.PreviewHeading=e=>{let{item:t}=e;return i.default.createElement("td",{className:"uploader-items-thumb"},i.default.createElement(a.Preview,{item:t}))}},21497:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PublicURL=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n};t.PublicURL=e=>{let{item:t,onClick:r,inputRef:n}=e;return t.publicURL?i.default.createElement("div",null,i.default.createElement("input",{type:"text",className:"uploader-items-url-txtarea","data-testid":"uploader-items-url-txtarea",value:t.publicURL,readOnly:!0,ref:n,onClick:r})):null}},90855:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Thumbnail=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n},a=r(45260);t.Thumbnail=e=>{let{isImage:t,filename:r,previewURL:n}=e;const o=(0,a.getExtnameWithFilename)(r);return t?i.default.createElement("img",{src:n,"data-testid":"thumbnail-img"}):o?i.default.createElement("div",{className:"extname"},o):null}},59226:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Uploader=void 0;var n=s(r(67294)),i=r(78559),a=r(99528),o=s(r(20996));function s(e){return e&&e.__esModule?e:{default:e}}t.Uploader=e=>{let{onDrop:t,items:r,previousItems:s,deleteItem:l}=e;return n.default.createElement(n.default.Fragment,null,n.default.createElement(a.ItemDropZone,{onDrop:t}),n.default.createElement(i.ItemsComponent,{items:r,deleteItem:()=>{},headlineText:o.default.text("epic.file_uploader.upload_result")}),n.default.createElement(i.ItemsComponent,{items:s,deleteItem:l,headlineText:o.default.text("epic.file_uploader.previous_items")}))}},99528:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ItemDropZone=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),a=r(13356),o=(n=r(20996))&&n.__esModule?n:{default:n};function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}t.ItemDropZone=e=>{let{onDrop:t}=e;const r=(0,i.useCallback)((e=>{t(e.map((e=>Object.assign(e,{preview:URL.createObjectURL(e)}))))}),[t]),{getRootProps:n,getInputProps:s,isDragActive:l,isDragReject:d}=(0,a.useDropzone)({onDrop:r}),u=(0,i.useMemo)((()=>{const e=["uploader-dropzone"];return l?[...e,"is-active"]:d?[...e,"is-rejected"]:e}),[l,d]);return i.default.createElement("div",{className:"uploader-container","data-testid":"uploader-container"},i.default.createElement("div",n(),i.default.createElement("input",s()),i.default.createElement("div",{className:u.join(" ")},o.default.text("epic.file_uploader.drop_here"))))}},26441:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ItemRow=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n},a=r(33858),o=r(3028);t.ItemRow=e=>{let{item:t,deleteItem:r}=e;const{input:n,copied:s,copyPublicURL:l,selectURL:d}=(0,o.useItemRowHook)();return i.default.createElement(a.ItemRowComponent,{input:n,copied:s,item:t,onClickCopyButton:l,onClickPublicURL:d,onClickDeleteButton:r})}},4277:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LazyUploaderLoader=void 0;var n,i=l(r(67294)),a=(n=r(20996))&&n.__esModule?n:{default:n},o=r(90381);function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}function l(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}return n.default=e,r&&r.set(e,n),n}const d=(0,i.lazy)((()=>Promise.resolve().then((()=>l(r(76713)))).then((e=>({default:e.UploaderContainer})))));t.LazyUploaderLoader=e=>{let{onDrop:t,repository:r}=e;return i.default.createElement(i.Suspense,{fallback:i.default.createElement(o.LoadingIndicator,{text:a.default.text("loading")})},i.default.createElement(d,{onDrop:t,repository:r}))}},76713:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UploaderContainer=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),i=r(96276),a=r(59226);function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}t.UploaderContainer=e=>{let{onDrop:t,repository:r}=e;const{items:o,previousItems:s}=(0,i.useRepository)(r);return(0,n.useEffect)((()=>{r.loadPreviousItems()}),[r]),n.default.createElement(a.Uploader,{onDrop:t,items:o,previousItems:s,deleteItem:r.deleteItem.bind(r)})}},8251:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deleteItem=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=a(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,r&&r.set(e,n);return n}(r(347)),i=r(55992);function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(a=function(e){return e?r:t})(e)}t.deleteItem=async e=>{if(!e.uuid)throw new Error("uuid is not set");return n.default.post((0,i.protocolRelativeAdminUserBlogUrl)("/files/delete"),{uuid:e.uuid},{transformRequest:[n.withEpicRKs,n.formDataRequest],responseType:"json"})}},45260:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getExtnameWithFilename=void 0;t.getExtnameWithFilename=e=>{const t=e.split(".");return t.length<2?"":t[t.length-1].toUpperCase()}},3028:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useItemRowHook=void 0;var n=r(67294),i=r(43805);t.useItemRowHook=()=>{const[e,t]=(0,n.useState)(!1),{inputRef:r,select:a}=(0,i.useInput)(),o=(0,n.useCallback)((()=>{a(),document.execCommand("copy");const e=window.getSelection();e&&(e.removeAllRanges(),t(!0))}),[a]);return{input:r,copied:e,selectURL:a,copyPublicURL:o}}},96276:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useRepository=void 0;var n=r(67294);const i={folder:"",items:[],previousItems:[]};t.useRepository=e=>{const[t,r]=(0,n.useState)(i);return(0,n.useEffect)((()=>{r(i),e.on("change",(()=>{r(e.getState())}))}),[e]),t}},96337:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;var n,i=r(73380),a=(n=r(67294))&&n.__esModule?n:{default:n},o=r(66977),s=r(4277);t.init=e=>{const t=new o.ItemsRepository("Hatena Blog Files");(0,i.safeRender)(a.default.createElement(s.LazyUploaderLoader,{onDrop:t.filesDropped.bind(t),repository:t}),e)}},55171:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadPreviousItems=void 0;var n,i=(n=r(347))&&n.__esModule?n:{default:n},a=r(75651);t.loadPreviousItems=async()=>(await i.default.get("./list")).data.map((e=>new a.PreviousItem(e)))},94676:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uploadItem=void 0;var n=a(r(57942)),i=a(r(347));function a(e){return e&&e.__esModule?e:{default:e}}t.uploadItem=e=>{const t=e.getFile();if(!t)return;e.uploadStart();const r=new FormData,a=(0,n.default)("rkm");a&&r.append("rkm",a);const o=(0,n.default)("rkc");o&&r.append("rkc",o),r.append("file",t),i.default.request({url:"upload",method:"post",data:r,responseType:"json"}).then((t=>{const r=t.data;e.uploadSuccess(r.publicURL)})).catch((()=>{e.uploadFailed()}))}},93358:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.respondOnVisitorAttributeEvent=void 0;var n=o(r(27484)),i=o(r(57942)),a=r(36414);function o(e){return e&&e.__esModule?e:{default:e}}const s=r(36500);t.respondOnVisitorAttributeEvent=(e,t)=>{if(t!==(0,i.default)("global-domain"))return;const r=(0,a.getVisitorAttribute)(),o=(0,a.getUserConfig)(),l=(0,n.default)(o);let d;if(o&&l.isValid()){d=(0,n.default)().diff(l,"days")}s.send("visitorAttribute",{visitorAttribute:r,daysSinceRegister:d})}},39338:(e,t,r)=>{"use strict";const n=r(67321),i={init(e,t,r){var i=new n(t);i.on("progress",(t=>{e.css("width",`${t}%`)})),i.on("complete",(()=>{setTimeout((()=>{location.href=r}),1500)}))}};e.exports=i},67321:(e,t,r)=>{"use strict";var n,i=(n=r(65311))&&n.__esModule?n:{default:n};var a=r(17187).EventEmitter;e.exports=class extends a{constructor(e){super(),this.url=e,this.checkProgress()}checkProgress(){i.default.ajax({url:this.url,type:"GET",cache:!1,dataType:"json"}).done((e=>{this.handleResponse(e)}))}handleResponse(e){e.progress&&this.emit("progress",e.progress),"complete"!==e.status&&"failed"!==e.status||this.emit("complete"),"started"!==e.status&&"new"!==e.status||setTimeout((()=>this.checkProgress()),1e3)}}},47535:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n};function a(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class o extends i.default.PureComponent{constructor(e){super(e),a(this,"renderDropdown",(()=>i.default.createElement("select",{name:this.props.inputName,defaultValue:this.props.currentCourse.name,onChange:e=>{const t=e.target.value,r=this.coursesByName[t];r&&this.props.onCourseChange(r)}},this.props.availableCourses.map((e=>i.default.createElement("option",{key:e.name,value:e.name},`${e.label} (${e.durationDays})`)))))),this.state={editing:!1},this.coursesByName={},e.availableCourses.forEach((e=>{this.coursesByName[e.name]=e}))}render(){return this.state.editing?this.renderDropdown():i.default.createElement("span",null,i.default.createElement("span",{className:"text-bigger"},this.props.currentCourse.label),"(",this.props.currentCourse.durationDays,")",i.default.createElement("span",{className:"btn btn-link",role:"button",onClick:()=>this.setState({editing:!0})},""),i.default.createElement("input",{type:"hidden",name:this.props.inputName,value:this.props.currentCourse.name}))}}var s=o;t.default=s},73722:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=d(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(55992)),i=l(r(849)),a=r(76809),o=l(r(9560)),s=l(r(67294));function l(e){return e&&e.__esModule?e:{default:e}}function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(d=function(e){return e?r:t})(e)}function u(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class c extends s.default.Component{constructor(e){super(e),u(this,"confirm",(()=>{this.setState({confirmed:!0})})),u(this,"buildConfirmButton",(()=>s.default.createElement("div",{className:"pro-btn-wrapper"},void 0!==this.props.onCancelPath&&s.default.createElement("a",{href:this.props.onCancelPath,className:"btn"},""),s.default.createElement("button",{type:"submit",onClick:()=>this.confirm(),className:"btn btn-primary track-click-by-gtm","data-gtm-event-action":"click","data-gtm-event-label":"admin_pro_confirm_button"},"")))),u(this,"buildRegisterCardURL",(()=>{const e=new URL(this.props.registerCardUrlBase);return e.searchParams.append("redirect_uri",this.props.redirectUrl),e.href})),u(this,"buildRegisterCardLink",(()=>{const e=this.buildRegisterCardURL();return s.default.createElement("a",{href:e,className:"btn btn-primary",role:"button","data-js-register-card-link":!0},"")})),u(this,"renderConfirmForm",(()=>s.default.createElement("section",{id:this.props.confirmFormId,className:"pro-confirm-form"},s.default.createElement("h1",null,this.props.course.label,""),s.default.createElement("p",null,""),s.default.createElement("table",{className:"table"},s.default.createElement("tbody",null,s.default.createElement("tr",null,s.default.createElement("th",null,""),s.default.createElement("td",null,s.default.createElement("span",{className:"text-bigger"},this.props.course.label),"(",this.props.course.durationDays,")")),s.default.createElement("tr",null,s.default.createElement("th",null,""),s.default.createElement("td",null,s.default.createElement("span",{className:"text-bigger text-bold"},(0,i.default)(this.props.course.price),"")," ()",s.default.createElement("br",null),this.props.course.isCampaign&&s.default.createElement("div",null," "))),s.default.createElement(a.FirstPaymentDateRow,{shouldShowFirstPaymentOn:this.props.shouldShowFirstPaymentOn,firstPaymentOn:this.props.firstPaymentOn}),s.default.createElement(a.ExpiresOnDateRow,{expiresOn:this.props.expiresOn}))),s.default.createElement("div",{className:"admin-notice"},s.default.createElement("h3",null,""),s.default.createElement("ul",null,s.default.createElement("li",null,"VISAMastercardJCBAmerican ExpressDiners Club"),s.default.createElement("li",null,""),s.default.createElement("li",{"data-js-plus-abolished-note":!0},"Pro",s.default.createElement("a",{href:"https://help.hatenablog.com/entry/kyash",target:"_blank"},"")))),this.props.registeredCard?this.buildConfirmButton():this.buildRegisterCardLink()))),u(this,"renderStartProForm",(()=>{if(!this.props.registeredCard)return null;const e=this.props.registeredCard;return s.default.createElement("div",null,s.default.createElement("h1",null,this.props.course.label,""),s.default.createElement("p",null,""," "),s.default.createElement(o.default,{actionPath:this.props.actionPath,formId:this.props.startProFormId,course:this.props.course,courseStructureVersion:this.props.courseStructureVersion,expiresOn:this.props.expiresOn,shouldShowFirstPaymentOn:this.props.shouldShowFirstPaymentOn,firstPaymentOn:this.props.firstPaymentOn,registerCardUrlBase:this.props.registerCardUrlBase,redirectUrl:this.props.redirectUrl,onCancelPath:this.props.onCancelPath,registeredCard:e,courseInput:s.default.createElement("span",null,s.default.createElement("span",{className:"text-bigger"},this.props.course.label),"(",this.props.course.durationDays,")",s.default.createElement("input",{type:"hidden",name:"course_name",value:this.props.course.name})),plusVia:this.props.plusVia,plusViaTerm:this.props.plusViaTerm}),s.default.createElement("aside",{className:"pro-confirm-aside"},""),this.props.course.isCampaign&&s.default.createElement("div",{className:"admin-notice"},s.default.createElement("h3",null,""),s.default.createElement("ul",null,s.default.createElement("li",null,"11"),s.default.createElement("li",null,""),s.default.createElement("li",null,"30"))),s.default.createElement("div",{className:"admin-notice"},s.default.createElement("h3",null,""),s.default.createElement("ul",null,s.default.createElement("li",null,""),s.default.createElement("li",null,"7",this.props.tier,""),s.default.createElement("li",null,"",this.props.tier,"",this.props.tier,"",this.props.tier,""),s.default.createElement("li",null,"",s.default.createElement("a",{href:n.helpUrl("/entry/refund-policy"),target:"_blank",rel:"noopener"},""),""),s.default.createElement("li",null,s.default.createElement("a",{href:n.helpUrl("/entry/guideline"),target:"_blank",rel:"noopener"},""),"",s.default.createElement("a",{href:"https://policies.hatena.ne.jp/rule",target:"_blank",rel:"noopener"},""),""),s.default.createElement("li",null,"",s.default.createElement("a",{href:"https://hatena.co.jp/tokutei",target:"_blank",rel:"noopener","data-testid":"tokutei"},""),""))))})),this.state={confirmed:!1}}render(){return this.state.confirmed?this.renderStartProForm():this.renderConfirmForm()}}var p=c;t.default=p},76809:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FirstPaymentDateRow=t.ExpiresOnDateRow=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n};t.FirstPaymentDateRow=e=>e.shouldShowFirstPaymentOn?i.default.createElement("tr",{className:"pro-first-payment-date-row"},i.default.createElement("th",null,""),i.default.createElement("td",null,e.firstPaymentOn)):null;t.ExpiresOnDateRow=e=>i.default.createElement("tr",{className:"pro-expires-on-date-row"},i.default.createElement("th",null,""),i.default.createElement("td",null,e.expiresOn))},9560:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(r(57942)),i=s(r(849)),a=r(76809),o=s(r(67294));function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class d extends o.default.PureComponent{constructor(e){super(e),l(this,"onSubmit",(()=>{this.setState({submitting:!0})})),l(this,"buildRegisteredCardURL",(()=>{const e=new URL(this.props.registerCardUrlBase);return e.searchParams.append("redirect_uri",this.props.redirectUrl),e.href})),l(this,"renderMigrateViaInput",(()=>{const{migrateVia:e}=this.props;return e?o.default.createElement("input",{type:"hidden",name:"migrate_via",value:e}):null})),l(this,"renderPlusViaInput",(()=>{const{plusVia:e}=this.props;return e?o.default.createElement("input",{type:"hidden",name:"plus_via",value:e}):null})),l(this,"renderPlusViaTermInput",(()=>{const{plusViaTerm:e}=this.props;return e?o.default.createElement("input",{type:"hidden",name:"plus_via_term",value:e}):null})),this.state={submitting:!1}}render(){const e=(0,n.default)("rkm")??void 0,t=(0,n.default)("rkc")??void 0,r=["btn","btn-primary"],s=this.state.submitting?r.concat("disabled"):r,l=this.buildRegisteredCardURL(),d=this.props.courseStructureVersion;return o.default.createElement("form",{action:this.props.actionPath,method:"POST",id:this.props.formId,onSubmit:this.onSubmit,"data-testid":"start-pro-form"},o.default.createElement("table",{className:"table"},o.default.createElement("tbody",null,o.default.createElement("tr",null,o.default.createElement("th",null,""),o.default.createElement("td",null,o.default.createElement("span",null,"****-****-****-",this.props.registeredCard.lastCardNumbers),o.default.createElement("a",{href:l,className:"btn btn-link pro-link-change-card"},""))),o.default.createElement("tr",null,o.default.createElement("th",null,""),o.default.createElement("td",null,this.props.courseInput,this.props.course.isCampaign&&o.default.createElement("div",null," "))),o.default.createElement("tr",null,o.default.createElement("th",null,""),o.default.createElement("td",null,o.default.createElement("span",{className:"text-bigger text-bold"},(0,i.default)(this.props.course.price)," "),"()")),o.default.createElement(a.FirstPaymentDateRow,{shouldShowFirstPaymentOn:this.props.shouldShowFirstPaymentOn,firstPaymentOn:this.props.firstPaymentOn}),o.default.createElement(a.ExpiresOnDateRow,{expiresOn:this.props.expiresOn}))),o.default.createElement("input",{type:"hidden",name:"rkm",value:e}),o.default.createElement("input",{type:"hidden",name:"rkc",value:t}),d&&o.default.createElement("input",{type:"hidden",name:"course_structure_version",value:d}),this.renderMigrateViaInput(),this.renderPlusViaInput(),this.renderPlusViaTermInput(),o.default.createElement("div",{className:"pro-btn-wrapper"},void 0!==this.props.onCancelPath&&o.default.createElement("a",{href:this.props.onCancelPath,className:"btn"},""),o.default.createElement("input",{type:"submit",className:s.join(" "),value:"",disabled:this.state.submitting})))}}var u=d;t.default=u},71617:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=l(r(67294)),i=l(r(47535)),a=l(r(9560)),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(55992));function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}function l(e){return e&&e.__esModule?e:{default:e}}function d(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class u extends n.default.PureComponent{constructor(e){super(e),d(this,"buildRegisterCardURL",(()=>{const e=new URL(this.props.registerCardUrlBase);return e.searchParams.append("redirect_uri",this.props.redirectUrl),e.href})),d(this,"renderRegisterCardLink",(()=>{const e=this.buildRegisterCardURL();return n.default.createElement("a",{href:e,className:"btn btn-primary",role:"button","data-js-register-card-link":!0},"")})),d(this,"renderConfirm",(()=>{if(!this.props.registeredCard)return null;const e=this.props.registeredCard,{migrateVia:t}=this.props;return n.default.createElement(a.default,{actionPath:"/-/pro/migrate",formId:"pro-form-will-migrate",course:this.state.course,expiresOn:this.props.expiresOn,shouldShowFirstPaymentOn:!1,registerCardUrlBase:this.props.registerCardUrlBase,redirectUrl:this.props.redirectUrl,registeredCard:e,migrateVia:t,courseInput:n.default.createElement(i.default,{inputName:"course_name",currentCourse:this.state.course,availableCourses:this.props.availableCourses,onCourseChange:e=>this.setState({course:e})})})})),this.state={course:e.initialCourse}}render(){return n.default.createElement("div",null,n.default.createElement("h1",null,""),n.default.createElement("p",null,"Pro"),this.props.registeredCard?this.renderConfirm():null,n.default.createElement("div",{className:"admin-notice"},n.default.createElement("h3",null,""),n.default.createElement("ul",null,n.default.createElement("li",null,n.default.createElement("strong",null,""),"Pro "),n.default.createElement("li",null," ",n.default.createElement("a",{href:"https://www.hatena.ne.jp/my/point/creditcard"},""),"")),n.default.createElement("h3",null,""),n.default.createElement("ul",null,n.default.createElement("li",null,""),n.default.createElement("li",null,"7Pro"),n.default.createElement("li",null,"Pro"),n.default.createElement("li",null,"ProPro Pro"),n.default.createElement("li",null,"",n.default.createElement("a",{href:o.helpUrl("/entry/refund-policy"),target:"_blank",rel:"noopener"},""),""),n.default.createElement("li",null,n.default.createElement("a",{href:o.helpUrl("/entry/guideline"),target:"_blank",rel:"noopener"},""),"",n.default.createElement("a",{href:"https://policies.hatena.ne.jp/rule",target:"_blank",rel:"noopener"},"")," "))),this.props.registeredCard?null:this.renderRegisterCardLink())}}var c=u;t.default=c},30044:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=l(r(67294)),i=r(55992),a=l(r(20996)),o=l(r(57942)),s=r(76809);function l(e){return e&&e.__esModule?e:{default:e}}function d(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class u extends n.default.PureComponent{constructor(e){super(e),d(this,"buildRegisterCardURL",(()=>{const e=new URL(this.props.registerCardUrlBase);return e.searchParams.append("redirect_uri",this.props.redirectUrl),e.href})),d(this,"renderCardInfo",(()=>{const e=this.buildRegisterCardURL();return this.props.registeredCard?n.default.createElement("div",null,n.default.createElement("span",null,""),n.default.createElement("div",null,n.default.createElement("span",null,"****-****-****-",this.props.registeredCard.lastCardNumbers),n.default.createElement("a",{href:e,className:"btn btn-link pro-link-change-card"},""))):n.default.createElement("a",{href:e,className:"btn btn-primary",role:"button","data-js-register-card-link":!0},"")})),d(this,"renderRequestButton",(()=>{const e=(0,o.default)("rkm"),t=(0,o.default)("rkc"),r=this.props.courseStructureVersion,i=this.props.destinationCourse.name,a=["btn","btn-primary"],s=this.state.submitting?a.concat("disabled"):a;return n.default.createElement("form",{action:"/-/pro/migrate/pay",method:"POST",onSubmit:this.onSubmit},n.default.createElement("input",{type:"hidden",name:"rkm",value:e}),n.default.createElement("input",{type:"hidden",name:"rkc",value:t}),n.default.createElement("input",{type:"hidden",name:"course_name",value:i}),r&&n.default.createElement("input",{type:"hidden",name:"course_structure_version",value:r}),this.renderMigrateViaInput(),n.default.createElement("div",{className:"planMigration-submit"},n.default.createElement("input",{type:"submit",className:s.join(" "),value:"",disabled:this.state.submitting}),n.default.createElement("p",null,"")))})),d(this,"onSubmit",(()=>{this.setState({submitting:!0})})),d(this,"renderMigrateViaInput",(()=>{const{migrateVia:e}=this.props;return e?n.default.createElement("input",{type:"hidden",name:"migrate_via",value:e}):null})),this.state={submitting:!1}}render(){return n.default.createElement("div",null,n.default.createElement("div",{className:"planMigration-summary"},n.default.createElement("div",null,n.default.createElement("div",{className:"summary-title"},""),n.default.createElement("div",{className:"summary-courseName"},this.props.currentCourse.label),n.default.createElement("ul",{className:"summary-courseMeta"},n.default.createElement("li",null,"",a.default.formatNumber(this.props.currentCourse.price)),n.default.createElement("li",null,": ",this.props.expiresOn," (",this.props.daysUntilExpiration,")"))),n.default.createElement("div",null,n.default.createElement("div",{className:"summary-title"},""),n.default.createElement("div",{className:"summary-courseName"},this.props.destinationCourse.label),n.default.createElement("ul",{className:"summary-courseMeta"},n.default.createElement("li",null,"",a.default.formatNumber(this.props.destinationCourse.price)),n.default.createElement("li",null,": ",this.props.newExpiresOn," (",this.props.destinationCourse.durationDays," +"," ",this.props.daysToExtend,")")))),n.default.createElement("div",{className:"planMigration-extendDays-breakdown"},n.default.createElement("div",{className:"extendDays-breakdown-heading"},n.default.createElement("h4",null,""),n.default.createElement("p",null,"")),n.default.createElement("table",{className:"extendDays-breakdown-table"},n.default.createElement("tbody",null,n.default.createElement("tr",null,n.default.createElement("th",null,"",n.default.createElement("div",{className:"table-value-notice"},"1 ",this.props.currentCourse.pricePerDay," x  ",this.props.daysUntilExpiration,"")),n.default.createElement("td",null,this.props.unusedAmount,"")),n.default.createElement("tr",null,n.default.createElement("th",null,"1"),n.default.createElement("td",null,this.props.destinationCourse.pricePerDay,"")),n.default.createElement("tr",null,n.default.createElement("th",null,n.default.createElement("strong",null,""),n.default.createElement("div",{className:"table-value-notice"},this.props.unusedAmount," / ",this.props.destinationCourse.pricePerDay)),n.default.createElement("td",null,n.default.createElement("strong",{className:"bigger"},this.props.daysToExtend),"",n.default.createElement("div",{className:"table-value-notice"}," ")))))),n.default.createElement("h3",null,""),this.renderCardInfo(),n.default.createElement("h3",null,""),n.default.createElement("div",{className:"planMigration-amount"},n.default.createElement("span",{className:"amount-value"},a.default.formatNumber(this.props.destinationCourse.price))," ()",n.default.createElement("p",null,""),n.default.createElement("table",{className:"planMigration-amount-detail"},n.default.createElement(s.ExpiresOnDateRow,{expiresOn:this.props.newExpiresOn}))),n.default.createElement("div",{className:"planMigration-notice"},n.default.createElement("div",{className:"planMigration-notice-heading"},n.default.createElement("h4",null,"")),n.default.createElement("ul",null,n.default.createElement("li",null,""),n.default.createElement("li",null,"7"),n.default.createElement("li",null,""),n.default.createElement("li",null,""),n.default.createElement("li",null,n.default.createElement("a",{href:(0,i.helpUrl)("/entry/guideline"),target:"_blank",rel:"noopener"},""),"",n.default.createElement("a",{href:"https://policies.hatena.ne.jp/rule",target:"_blank",rel:"noopener"},""),""))),this.props.registeredCard?this.renderRequestButton():null)}}var c=u;t.default=c},74213:(e,t,r)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.saveCard=t.modifyProfileCardAdvancedSettings=t.modifyProfileCard=t.loadProfileCards=t.editProfileCard=t.duplicateProfileCard=t.deleteCard=t.createProfileCard=t.changeSearchQuery=t.cancelEdit=void 0;const i=(0,((n=r(99308))&&n.__esModule?n:{default:n}).default)("ProfileCardManager"),a=i.async("FETCH_CARDS");t.loadProfileCards=a;const o=i.async("SAVE_CARD");t.saveCard=o;const s=i.async("DELETE_CARD");t.deleteCard=s;const l=i("CREATE_CARD");t.createProfileCard=l;const d=i("MODIFY_CARD");t.modifyProfileCard=d;const u=i("ADVANCED_MODIFY_CARD");t.modifyProfileCardAdvancedSettings=u;const c=i("DUPLICATE_CARD");t.duplicateProfileCard=c;const p=i("CANCEL_EDIT");t.cancelEdit=p;const f=i("EDIT_CARD");t.editProfileCard=f;const h=i("CHANGE_SEARCH_QUERY");t.changeSearchQuery=h},92349:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.postNewCard=t.postEditedCard=t.postDeleteCard=t.getFetchProfileCardsOption=t.fetchProfileCards=void 0;var n,i=(n=r(57942))&&n.__esModule?n:{default:n},a=l(r(55992)),o=l(r(347));function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}function l(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}return n.default=e,r&&r.set(e,n),n}const d=()=>({url:a.httpsAdminUserBlogUrl("/profile_cards.json")});t.getFetchProfileCardsOption=d;t.fetchProfileCards=async()=>(await(0,o.default)(d())).data.entries;const u=(e,t)=>{const r=(0,i.default)("rkm"),n=(0,i.default)("rkc");return r&&n?o.default.post(a.httpsAdminUserBlogUrl(e),{...t,rkm:r,rkc:n},{transformRequest:o.traditionalDataRequest}):Promise.reject("Failed to retrieve credentials")};t.postNewCard=e=>{const{title:t,body:r,author:n,author_urls:i}=e;return u("/add_profile_card.json",{body:r,title:t,author:n,author_urls:i})};t.postEditedCard=e=>{const{title:t,body:r,author:n,author_urls:i}=e;return u(`/profile_card/${e.uuid}/edit.json`,{body:r,title:t,author:n,author_urls:i})};t.postDeleteCard=e=>u(`/profile_card/${e.uuid}/delete.json`,{})},32240:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AddProfileCardButton=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n};t.AddProfileCardButton=e=>{let{onClick:t}=e;return i.default.createElement("button",{type:"submit",className:"btn test-add-profile-card-button",onClick:t},"")}},27825:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProfileCardEditorFormInputTableRow=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n};t.ProfileCardEditorFormInputTableRow=e=>{let{tableHeader:t,value:r,placeholder:n,onChange:a,children:o}=e;return i.default.createElement("tr",null,i.default.createElement("th",null,t),i.default.createElement("td",null,i.default.createElement("input",{placeholder:n,type:"text",value:r,onChange:a,className:"full-width"}),o))}},72003:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProfileCardEditorFormOuter=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n};t.ProfileCardEditorFormOuter=e=>{let{children:t,submitDisabled:r,onClickCloseButton:n,onSubmit:a,isEditingNewCard:o,modalState:s}=e;return i.default.createElement("div",{className:"profile_cards-modal"},i.default.createElement("div",{className:"profile_cards-modal-inner"},i.default.createElement("form",{onSubmit:a},i.default.createElement("div",{className:"profile_cards-modal-header"},i.default.createElement("h2",null,"edit"===s&&(o?"":""),"advanced"===s&&""),i.default.createElement("span",null,i.default.createElement("a",{href:"",onClick:n,className:"rule-editor-panel-close-btn"},i.default.createElement("i",{className:"blogicon-close"})))),i.default.createElement("div",{className:"profile_cards-modal-body"},t),i.default.createElement("div",{className:"profile_cards-modal-footer"},i.default.createElement("button",{type:"submit",className:"btn btn-primary",onClick:a,disabled:r},"")))))}},31011:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProfileCardEditorFormTextAreaTableRaw=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n};t.ProfileCardEditorFormTextAreaTableRaw=e=>{let{tableHeader:t,value:r,placeholder:n,onChange:a,children:o}=e;return i.default.createElement("tr",null,i.default.createElement("th",null,t),i.default.createElement("td",null,i.default.createElement("textarea",{placeholder:n,value:r,onChange:a,className:"full-width profile_cards-body-text-area"}),o))}},2448:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SearchProfileCardsFormComponent=void 0;var n=a(r(67294)),i=a(r(20996));function a(e){return e&&e.__esModule?e:{default:e}}t.SearchProfileCardsFormComponent=e=>{let{onKeyPress:t,onChange:r,value:a,onClick:o}=e;return n.default.createElement("div",{className:"profile-card-search"},n.default.createElement("div",{className:"profile-card-search-form"},n.default.createElement("input",{type:"text",onKeyPress:t,onChange:r,value:a,placeholder:i.default.text("admin.profile_card.search")}),n.default.createElement("button",{type:"button",onClick:o,className:"btn profile-card-search-btn"},i.default.text("admin.profile_card.search.button"))))}},18150:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProfileCardsManagerComponent=void 0;var n=o(r(67294)),i=r(32240),a=o(r(83253));function o(e){return e&&e.__esModule?e:{default:e}}t.ProfileCardsManagerComponent=e=>{let{modalState:t,SearchProfileCardsForm:r,ProfileCardEditorForm:o,ProfileCardAdvancedSettingsForm:s,shouldShowTopButton:l,ProfileCardsListTable:d,onClickAddProfileCardButton:u,onRequestClose:c}=e;return n.default.createElement("div",null,n.default.createElement("div",{className:"main-header"},n.default.createElement("h1",null,"")),n.default.createElement(r,null),n.default.createElement("div",{className:"main-box"},l&&n.default.createElement(i.AddProfileCardButton,{onClick:u}),n.default.createElement(a.default,{className:"profile-cards-editor-modal",overlayClassName:"profile-cards-editor-modal-overlay",portalClassName:"profile-cards-editor-modal-portal",isOpen:"closed"!==t,shouldCloseOnOverlayClick:!0,onRequestClose:c},"edit"===t&&n.default.createElement(o,null),"advanced"===t&&n.default.createElement(s,null)),n.default.createElement(d,null),n.default.createElement(i.AddProfileCardButton,{onClick:u})))}},32905:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProfileCardRow=void 0;var n=o(r(27484)),i=o(r(67294)),a=r(83521);function o(e){return e&&e.__esModule?e:{default:e}}t.ProfileCardRow=e=>{let{card:t,onClickEditButton:r,onClickAdvancedSettingsButton:o,onClickDuplicateButton:s,onClickDeleteButton:l}=e;return i.default.createElement("tr",{key:`card-row-${t.uuid}`,"data-testid":"profile-card-row"},i.default.createElement("td",{className:"profile-table-card-name"},t.title),i.default.createElement("td",{className:"profile-table-card-author"},t.author),i.default.createElement("td",{className:"profile-table-card-description"},t.body_preview),i.default.createElement("td",{className:"profile-table-card-modified"},(e=>e.modified?(0,n.default)(e.modified).format("YYYY/MM/DD HH:mm:ss"):null)(t)),i.default.createElement("td",{className:"td-admin-button profile-table-btn"},i.default.createElement(a.Dropdown,{items:[{label:"",icon:"blogicon-edit",className:"test-blogicon-edit",onClick:()=>r(t)},{label:"",icon:"blogicon-cog",className:"test-blogicon-cog",onClick:()=>o(t)},{label:"",icon:"blogicon-entry",className:"test-blogicon-entry",onClick:()=>s(t)},{label:"",icon:"blogicon-close",className:"test-blogicon-close",onClick:()=>l(t)}]})))}},74953:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProfileCardsListTableComponent=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=a(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,r&&r.set(e,n);return n}(r(67294)),i=r(32905);function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(a=function(e){return e?r:t})(e)}t.ProfileCardsListTableComponent=e=>{let{profileCards:t,onClickEditButton:r,onClickAdvancedSettingsButton:a,onClickDuplicateButton:o,onClickDeleteButton:s}=e;return n.createElement("table",{className:"table profile-cards-list"},n.createElement("thead",null,n.createElement("tr",null,n.createElement("th",{className:"profile-table-card-name"},""),n.createElement("th",{className:"profile-table-card-author"},""),n.createElement("th",{className:"profile-table-card-description"},""),n.createElement("th",{className:"profile-table-card-modified"},""),n.createElement("th",{className:"profile-table-btn"}))),n.createElement("tbody",null,t.map((e=>n.createElement(i.ProfileCardRow,{key:e.uuid,card:e,onClickEditButton:r,onClickAdvancedSettingsButton:a,onClickDuplicateButton:o,onClickDeleteButton:s})))))}},58733:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProfileCardAdvancedSettingsForm=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=p(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),i=r(72003),a=r(13410),o=r(27825),s=r(31011),l=r(57295),d=r(81305),u=r(33095),c=r(62803);function p(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(p=function(e){return e?r:t})(e)}t.ProfileCardAdvancedSettingsForm=()=>{const{title:e,author:t,setAuthor:r,authorURLsText:p,setAuthorURLsText:f,cancelEdit:h}=(0,a.useProfileCardEditorForm)(),{maxAuthorURLsCount:m}=(0,n.useContext)(c.MaxAuthorURLsCountContext),{save:g}=(0,d.useSaveProfileCard)(m),v=(0,l.useCanSave)(m),b=(0,u.useSelector)((e=>e.modal.modalState));return n.default.createElement(i.ProfileCardEditorFormOuter,{onSubmit:g,isEditingNewCard:!1,onClickCloseButton:h,submitDisabled:!v,modalState:b},n.default.createElement("table",{className:"admin-table"},n.default.createElement("tbody",null,n.default.createElement("tr",null,n.default.createElement("th",null,""),n.default.createElement("td",null,e)),n.default.createElement(o.ProfileCardEditorFormInputTableRow,{tableHeader:"",placeholder:"author",value:t,onChange:e=>r(e.target.value)},n.default.createElement("p",null,"",n.default.createElement("br",null),"Author")),n.default.createElement(s.ProfileCardEditorFormTextAreaTableRaw,{tableHeader:"URL",placeholder:"",value:p,onChange:e=>f(e.target.value)},n.default.createElement("p",null,"URL")))))}},90482:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProfileCardEditorForm=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=p(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),i=r(72003),a=r(13410),o=r(27825),s=r(31011),l=r(57295),d=r(81305),u=r(33095),c=r(62803);function p(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(p=function(e){return e?r:t})(e)}t.ProfileCardEditorForm=()=>{const{title:e,setTitle:t,body:r,setBody:p,isEditingNewCard:f,cancelEdit:h}=(0,a.useProfileCardEditorForm)(),{maxAuthorURLsCount:m}=(0,n.useContext)(c.MaxAuthorURLsCountContext),{save:g}=(0,d.useSaveProfileCard)(m),v=(0,l.useCanSave)(m),b=(0,u.useSelector)((e=>e.modal.modalState));return n.default.createElement(i.ProfileCardEditorFormOuter,{onSubmit:g,isEditingNewCard:f,onClickCloseButton:h,submitDisabled:!v,modalState:b},n.default.createElement("table",{className:"admin-table"},n.default.createElement("tbody",null,n.default.createElement(o.ProfileCardEditorFormInputTableRow,{tableHeader:"",placeholder:"title",value:e,onChange:e=>t(e.target.value)},n.default.createElement("p",null,"",n.default.createElement("br",null),"")),n.default.createElement(s.ProfileCardEditorFormTextAreaTableRaw,{tableHeader:"",placeholder:"body",value:r,onChange:e=>p(e.target.value)},n.default.createElement("p",null,"",n.default.createElement("br",null),"HTML")))))}},9751:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProfileCardsListTable=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=l(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),i=r(74953),a=r(33095),o=r(80060),s=r(74213);function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(l=function(e){return e?r:t})(e)}t.ProfileCardsListTable=()=>{const e=(0,a.useSelector)((e=>e.cards.cards)),t=(0,a.useSelector)((e=>e.cards.searchQuery)),r=(0,n.useMemo)((()=>""===t?e:e.filter((e=>-1!==e.title.indexOf(t)||-1!==e.body.indexOf(t)))),[e,t]),{confirmDeleteCard:l}=(0,o.useDeleteProfileCard)(),d=(0,a.useDispatch)();return n.default.createElement(i.ProfileCardsListTableComponent,{profileCards:r,onClickEditButton:e=>{d((0,s.modifyProfileCard)({card:e}))},onClickAdvancedSettingsButton:e=>{d((0,s.modifyProfileCardAdvancedSettings)({card:e}))},onClickDuplicateButton:e=>{d((0,s.duplicateProfileCard)({card:e}))},onClickDeleteButton:e=>{l(e)}})}},71900:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProfileCardsManager=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=c(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),i=r(34963),a=r(33095),o=r(14890),s=r(65400),l=r(71822),d=r(62803),u=r(56290);function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(c=function(e){return e?r:t})(e)}const p=()=>((0,u.useProfileCardsManager)(),null);t.ProfileCardsManager=e=>{let{maxAuthorURLsCount:t}=e;const[r]=(0,n.useState)((()=>({store:(0,o.createStore)(l.reducer,(0,s.composeEnhancers)()),storeState:l.INITIAL_STATE})));return n.default.createElement(a.ProfileCardManagerReduxContext.Provider,{value:r},n.default.createElement(d.MaxAuthorURLsCountContext.Provider,{value:{maxAuthorURLsCount:t}},n.default.createElement(p,null),n.default.createElement(i.ProfileCardsManagerConsumer,null)))}},34963:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProfileCardsManagerConsumer=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n},a=r(67124),o=r(9751),s=r(90482),l=r(58733),d=r(18150),u=r(33095),c=r(74213);t.ProfileCardsManagerConsumer=()=>{const e=(0,u.useSelector)((e=>e.cards.cards.length>0)),t=(0,u.useSelector)((e=>e.modal.modalState)),r=(0,u.useDispatch)();return i.default.createElement(d.ProfileCardsManagerComponent,{modalState:t,SearchProfileCardsForm:a.SearchProfileCardsForm,ProfileCardsListTable:o.ProfileCardsListTable,ProfileCardEditorForm:s.ProfileCardEditorForm,ProfileCardAdvancedSettingsForm:l.ProfileCardAdvancedSettingsForm,onClickAddProfileCardButton:()=>{r((0,c.createProfileCard)())},onRequestClose:()=>{r((0,c.cancelEdit)())},shouldShowTopButton:e})}},67124:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SearchProfileCardsForm=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n},a=r(2448),o=r(80465);t.SearchProfileCardsForm=()=>{const{localSearchQuery:e,onChange:t,onKeyPress:r,onClick:n}=(0,o.useSearchProfileCardsForm)();return i.default.createElement(a.SearchProfileCardsFormComponent,{onKeyPress:r,onChange:t,onClick:n,value:e})}},62803:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.maxAuthorURLsCountContextDefault=t.MaxAuthorURLsCountContext=void 0;var n=r(67294);const i={maxAuthorURLsCount:0};t.maxAuthorURLsCountContextDefault=i;const a=(0,n.createContext)(i);t.MaxAuthorURLsCountContext=a},33095:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useSelector=t.useDispatch=t.profileCardManagerStore=t.ProfileCardManagerReduxContext=void 0;var n=r(14890),i=r(67294),a=r(96841),o=r(71822);const s=(0,n.createStore)(o.reducer);t.profileCardManagerStore=s;const l=(0,i.createContext)({store:s,storeState:o.INITIAL_STATE});t.ProfileCardManagerReduxContext=l;const d=(0,a.createDispatchHook)(l);t.useDispatch=d;const u=(0,a.createSelectorHook)(l);t.useSelector=u},57295:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useCanSave=t.canSaveSelector=void 0;var n=r(33095);const i=["title","body","author"],a=new RegExp("^https?://"),o=(e,t)=>{let{cards:{editingCard:r,isSavingCard:n,targetCard:o}}=e;return!!r&&(!n&&(""!==r.title&&""!==r.body&&(null===o||!(0!==r.author_urls.length&&!r.author)&&(!!((e,t)=>e.length<=t&&e.every((e=>a.test(e))))(r.author_urls,t)&&(!!i.some((e=>r[e]!==o[e]))||r.author_urls.join("\n")!==o.author_urls.join("\n"))))))};t.canSaveSelector=o;t.useCanSave=e=>(0,n.useSelector)((t=>o(t,e)))},80060:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useDeleteProfileCard=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(74213)),i=r(92349),a=r(33095),o=r(67294);function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}t.useDeleteProfileCard=()=>{const e=(0,a.useDispatch)(),t=(0,a.useSelector)((e=>e.cards.isDeletingCard)),r=(0,o.useCallback)((async r=>{if(!t){e(n.deleteCard.started({data:{uuid:r.uuid}}));try{const t=await(0,i.postDeleteCard)({uuid:r.uuid});e(n.deleteCard.done({params:{data:r},result:{data:t.data}}))}catch(t){e(n.deleteCard.failed({error:{error:t},params:{data:r}}))}}}),[e,t]);return{confirmDeleteCard:(0,o.useCallback)((async e=>{window.confirm("")&&await r(e)}),[r])}}},6352:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useFetchProfileCards=void 0;var n=r(91289),i=r(92349);t.useFetchProfileCards=()=>(0,n.useXHR)((0,i.getFetchProfileCardsOption)())},13410:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useProfileCardEditorForm=void 0;var n=r(67294),i=r(33095),a=r(74213);t.useProfileCardEditorForm=()=>{const e=(0,i.useSelector)((e=>e.cards.editingCard)),t=(0,i.useSelector)((e=>null===e.cards.targetCard)),r=(0,i.useDispatch)(),[o,s]=(0,n.useState)((()=>e?.body||"")),[l,d]=(0,n.useState)((()=>e?.title||"")),[u,c]=(0,n.useState)((()=>e?.author||"")),[[p,f],h]=(0,n.useState)((()=>{const t=e?.author_urls||[];return[t.join("\n"),t]})),m=(0,n.useCallback)((e=>{const t=e.split("\n").map((e=>e.trim())).filter((e=>e));h([e,t])}),[]),g=(0,n.useCallback)((e=>{e.preventDefault(),r((0,a.cancelEdit)())}),[r]);return(0,n.useEffect)((()=>{r((0,a.editProfileCard)({card:{title:l,body:o,author:u,author_urls:f}}))}),[r,l,o,u,p]),{title:l,setTitle:d,body:o,setBody:s,isEditingNewCard:t,cancelEdit:g,author:u,setAuthor:c,authorURLsText:p,setAuthorURLsText:m}}},56290:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useProfileCardsManager=void 0;var n=r(34665),i=r(6352);t.useProfileCardsManager=()=>{const[{loading:e,error:t,data:r}]=(0,i.useFetchProfileCards)();(0,n.useProfileCardsManagerEffects)({loading:e,error:t,data:r})}},34665:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useProfileCardsManagerEffects=void 0;var n=r(33095),i=r(67294),a=r(74213);t.useProfileCardsManagerEffects=e=>{let{loading:t,data:r,error:o}=e;const s=(0,n.useDispatch)();(0,i.useEffect)((()=>{if(!t){if(o)return void s(a.loadProfileCards.failed({params:{},error:{error:o}}));if(!r)throw new TypeError("'data' doesn't exist");s(a.loadProfileCards.done({params:{},result:{profileCards:r.entries}}))}}),[t,r,o,s])}},81305:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useSaveProfileCard=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=l(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(74213)),i=r(92349),a=r(33095),o=r(57295),s=r(67294);function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(l=function(e){return e?r:t})(e)}t.useSaveProfileCard=e=>{const t=(0,o.useCanSave)(e),r=(0,a.useSelector)((e=>e.cards.targetCard)),l=(0,a.useSelector)((e=>e.cards.editingCard)),d=(0,a.useDispatch)(),u=(0,s.useCallback)((async e=>{d(n.saveCard.started({}));try{await e;const t=await(0,i.fetchProfileCards)();d(n.saveCard.done({params:{},result:{profileCards:t}}))}catch(e){d(n.saveCard.failed({error:{error:e},params:{}}))}}),[d]);return{save:(0,s.useCallback)((async e=>{if(e.preventDefault(),t&&l){const{body:e,title:t,author:n,author_urls:a}=l;r?await u((0,i.postEditedCard)({uuid:r.uuid,body:e,title:t,author:n,author_urls:a})):await u((0,i.postNewCard)({body:e,title:t,author:n,author_urls:a}))}}),[t,l,r,u])}}},80465:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useSearchProfileCardsForm=void 0;var n=r(67294),i=r(33095),a=r(74213),o=r(41960);t.useSearchProfileCardsForm=()=>{const e=(0,i.useSelector)((e=>e.cards.searchQuery)),[t,r]=(0,n.useState)((()=>e)),s=(0,i.useDispatch)(),l=(0,n.useCallback)((e=>{r(e.target.value)}),[r]),d=(0,n.useCallback)((e=>{"RET"===(0,o.keyString)(e)&&(e.preventDefault(),s((0,a.changeSearchQuery)({searchQuery:t})))}),[s,t]),u=(0,n.useCallback)((()=>{s((0,a.changeSearchQuery)({searchQuery:t}))}),[s,t]);return{localSearchQuery:t,onChange:l,onKeyPress:d,onClick:u}}},66383:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cardsReducer=t.INITIAL_CARDS_STATE=void 0;var n=r(76983),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=a(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,r&&r.set(e,n);return n}(r(74213));function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(a=function(e){return e?r:t})(e)}const o={cards:[],searchQuery:"",isLoadingCard:!0,isSavingCard:!1,isDeletingCard:!1,editingCard:null,targetCard:null,deletingCard:null};t.INITIAL_CARDS_STATE=o;const s={body:"",title:"",author:"",author_urls:[]},l=e=>({body:e.body,author:e.author,title:e.title,author_urls:e.author_urls}),d=(0,n.reducerWithInitialState)(o).case(i.loadProfileCards.started,(e=>({...e,isLoadingCard:!0}))).case(i.saveCard.started,(e=>({...e,isSavingCard:!0}))).case(i.deleteCard.started,((e,t)=>({...e,isDeletingCard:!0,deletingCard:t.data}))).case(i.loadProfileCards.done,((e,t)=>({...e,isLoadingCard:!1,cards:t.result.profileCards}))).case(i.saveCard.done,((e,t)=>({...e,isSavingCard:!1,cards:t.result.profileCards,editingCard:null,targetCard:null}))).case(i.deleteCard.done,(e=>({...e,isDeletingCard:!1,cards:e.cards.filter((t=>t.uuid!==e.deletingCard?.uuid)),deletingCard:null}))).case(i.createProfileCard,(e=>({...e,targetCard:null,editingCard:s}))).case(i.modifyProfileCard,((e,t)=>({...e,targetCard:t.card,editingCard:l(t.card)}))).case(i.modifyProfileCardAdvancedSettings,((e,t)=>({...e,targetCard:t.card,editingCard:l(t.card)}))).case(i.duplicateProfileCard,((e,t)=>({...e,targetCard:null,editingCard:l(t.card)}))).case(i.editProfileCard,((e,t)=>({...e,editingCard:t.card}))).case(i.cancelEdit,(e=>({...o,isLoadingCard:!1,searchQuery:e.searchQuery,cards:e.cards}))).case(i.changeSearchQuery,((e,t)=>({...e,searchQuery:t.searchQuery}))).build();t.cardsReducer=d},12810:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorReducer=t.INITIAL_ERROR_STATE=void 0;var n=r(76983),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=a(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,r&&r.set(e,n);return n}(r(74213));function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(a=function(e){return e?r:t})(e)}const o={isError:!1,error:void 0};t.INITIAL_ERROR_STATE=o;const s=(0,n.reducerWithInitialState)(o).cases([i.loadProfileCards.failed,i.saveCard.failed,i.deleteCard.failed],((e,t)=>({...e,isError:!0,error:t.error.error}))).build();t.errorReducer=s},71822:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reducer=t.INITIAL_STATE=void 0;var n=r(14890),i=r(59703),a=r(12810),o=r(66383);const s=(0,n.combineReducers)({modal:i.modalReducer,error:a.errorReducer,cards:o.cardsReducer});t.reducer=s;const l={modal:i.INITIAL_MODAL_STATE,error:a.INITIAL_ERROR_STATE,cards:o.INITIAL_CARDS_STATE};t.INITIAL_STATE=l},59703:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.modalReducer=t.INITIAL_MODAL_STATE=void 0;var n=r(76983),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=a(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,r&&r.set(e,n);return n}(r(74213));function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(a=function(e){return e?r:t})(e)}const o={modalState:"closed",disableEditorModal:!1};t.INITIAL_MODAL_STATE=o;const s=(0,n.reducerWithInitialState)(o).cases([i.createProfileCard,i.modifyProfileCard,i.duplicateProfileCard],(e=>({...e,modalState:"edit"}))).cases([i.modifyProfileCardAdvancedSettings],(e=>({...e,modalState:"advanced"}))).cases([i.saveCard.started,i.deleteCard.started],(e=>({...e,disableEditorModal:!0}))).cases([i.saveCard.done,i.deleteCard.done,i.cancelEdit],(()=>o)).build();t.modalReducer=s},51534:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AdminEventTrackableAnchor=void 0;var n,i=(n=r(86010))&&n.__esModule?n:{default:n},a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294));function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s.apply(this,arguments)}t.AdminEventTrackableAnchor=e=>{let{trackingOption:{eventLabel:t,eventValue:r,isNonInteractionHit:n,eventData:o,shouldTrackInviews:l},className:d,...u}=e;const c=(0,a.useMemo)((()=>JSON.stringify(o)),[o]);return a.default.createElement("a",s({},u,{className:(0,i.default)([d,"track-click-by-gtm",l&&"track-inview-by-gtm"]),"data-gtm-event-action":"click","data-gtm-event-label":t,"data-gtm-event-value":r,"data-gtm-track-json":c,"data-gtm-event-is-non-interaction-hit":n||void 0}))}},43614:(e,t,r)=>{"use strict";var n,i=(n=r(57942))&&n.__esModule?n:{default:n};var a=r(65311),o=r(66419),s=r(61875),l={init:function(){var e=function(e){if(e.length<2)throw"invalid name";this.name=e};e.prototype={getName:function(){return this.name},getProfileImage:function(){return`https://cdn.profile-image.st-hatena.com/users/${this.getName()}/profile.png`},getURL:function(){return`http://profile.hatena.ne.jp/${this.getName()}/`},getHatenaID:function(){return`id:${this.getName()}`},equals:function(e){return this.name===e.name}},e.loadUserNames=function(t){return o.map(t,(t=>new e(t)))};var t=function(){this.init.apply(this,arguments)};t.prototype={init:function(){this.refusals=[]},load:function(e){this.refusals=e,a(this).trigger("refusalsChanged")},add:function(e){var t=this;if(!t.isRefused(e)){var r=t.refusals.concat(e);this._save(r).done((()=>{a(t).trigger("refusalAdded")})).fail((()=>{a(t).trigger("refusalSaveFailed")}))}},remove:function(e){var t=this;if(t.isRefused(e)){var r=o.reject(t.refusals,(r=>t.isEqual(e,r)));this._save(r).done((()=>{a(t).trigger("refusalRemoved")})).fail((()=>{a(t).trigger("refusalSaveFailed")}))}},isEqual:function(e,t){return e===t},isRefused:function(e){var t=this;return o.find(this.refusals,(r=>t.isEqual(e,r)))},getRefusals:function(){return this.refusals},_save_url:"specify this",_getSaveParams:function(e){throw new Error("implement this")},_save:function(e){var t=this,r=a.Deferred();return a.ajax({url:t._save_url,type:"POST",data:o.extend(t._getSaveParams(e),{rkm:(0,i.default)("rkm"),rkc:(0,i.default)("rkc")}),traditional:!0,dataType:"json"}).done((()=>{t.refusals=e,a(t).trigger("refusalsChanged"),r.resolve()})).fail((()=>{r.reject()})),r}};var r=function(){this.init.apply(this,arguments)};r.prototype={getUserNames:function(){return o.map(this.refusals,(e=>e.getName()))},isEqual:function(e,t){return e.equals(t)},_save_url:"/-/refusal/save",_getSaveParams:function(e){return{user_names:o.map(e,(e=>e.getName()))}}},s(r.prototype,t.prototype);var n=function(){this.init.apply(this,arguments)};n.prototype={_save_url:"/-/refusal/save_refused_ips",_getSaveParams:function(e){return{ips:e}}},s(n.prototype,t.prototype);var l=function(e,t){this.$refusalsContainer=e.find(".js-refusals-container"),this.refusalsTemplate=o.template(e.find(".js-refusals-template").html()),this.$alertAdded=t.find(".js-alert-added"),this.$alertRemoved=t.find(".js-alert-removed"),this.$alertNotFound=t.find(".js-alert-not-found")};l.prototype={onChanged:function(e){this.$refusalsContainer.html(this.refusalsTemplate({refusals:e.getRefusals()}))},onAdded:function(e){this.showAlert(this.$alertAdded)},onRemoved:function(e){this.showAlert(this.$alertRemoved)},onNotFound:function(e){this.showAlert(this.$alertNotFound)},showAlert:function(e){o.each([this.$alertAdded,this.$alertRemoved,this.$alertNotFound],(e=>{e.hide()})),e.show(),setTimeout((()=>{e.fadeOut("slow")}),3e3)}};var d=new r,u=new n,c=new l(a(".js-refuse-users"),a(".js-refuse-users-alert-wrapper")),p=new l(a(".js-refuse-ips"),a(".js-refuse-ips-alert-wrapper"));a(d).on("refusalsChanged",(function(){c.onChanged(this)})).on("refusalAdded",(function(){c.onAdded(this)})).on("refusalRemoved",(function(){c.onRemoved(this)})).on("refusalSaveFailed",(function(){c.onNotFound(this)})),a(u).on("refusalsChanged",(function(){p.onChanged(this)})).on("refusalAdded",(function(){p.onAdded(this)})).on("refusalRemoved",(function(){p.onRemoved(this)})).on("refusalSaveFailed",(function(){p.onNotFound(this)}));var f=a(".js-refused-users-container").data("user-names");if(f.length>0){var h=e.loadUserNames(f.split(","));d.load(h)}var m=a(".js-refused-ips-container").data("ips");m.length>0&&u.load(m.split(","));a(".js-refuse-users").on("submit",(t=>{t.preventDefault();var r=a('input[name="refusal_input"]'),n=r.val();if(/^(\d{1,3}(\.\d{1,3}){3})|([0-9a-fA-F]{1,4}(:[0-9a-fA-F]{1,4})+)$/.test(n))u.add(n);else{var i;try{i=new e(n)}catch(e){}i&&d.add(i)}return r.val("").focus(),!1})),a(".js-refuse-users").on("click",".js-delete-refused-user",(function(){var t=a(this).closest(".refused-user").data("user-name");d.remove(new e(t))})),a(".js-refuse-ips").on("click",".js-delete-refusal",(function(){var e=a(this).closest(".refused-ip").data("ip");u.remove(e)}))}};e.exports=l},93687:(e,t,r)=>{"use strict";var n,i=(n=r(76804))&&n.__esModule?n:{default:n};var a=r(65311),o=r(28507),s={setup:function(e,t){var r=this;r.entry_id=e,r.refresh_callback=t,r.saveExternalAuthorizeConfig(),r.setupExternalAuthLink()},setupExternalAuthLink:function(){var e=this,t=`${a("html").attr("data-admin-domain")}/-/config/external?with_parent_window=1`;a(document).on("click","[data-open-external-auth-link=1]",(r=>{r.preventDefault();var n={width:900,height:600,scrollbars:"yes"};n.left=Math.floor((screen.width-n.width)/2),n.top=Math.floor((screen.height-n.height)/2);var s=window.open(t,"external_auth",(0,i.default)(n));return o((()=>s.closed),(()=>{var t=a(".js-socialize-modal");t.length>0&&(t.hide(),a(".modal-window-background").fadeOut("fast")),e.getExternalAuthStatus().done((t=>{e.saveExternalAuthorizeConfig(),e.refreshSocializeBox(t)}))})),!1}))},refreshSocializeBox:function(e){a(".js-refresh-socialize-box").empty().html(e),this.refresh_callback&&this.refresh_callback()},saveExternalAuthorizeConfig:function(){this.externalAuthorizeConfig={twitter:1===a(".js-authenticated-twitter").size()}},isExternalAuthorizeFinished:function(){return!1===this.externalAuthorizeConfig.twitter&&1===a(".js-authenticated-twitter").size()},getExternalAuthStatus:function(){var e=a.Deferred();return a.ajax({url:"socialize_box",type:"GET",dataType:"html",data:{entry_id:this.entry_id}}).done((t=>{e.resolve(t)})).fail((()=>{e.reject()})),e.promise()}};e.exports=s},17235:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.attachSubscriptionConfig=function(e,t){(0,n.default)(e).on("click",t,(e=>{const t=(0,n.default)(e.currentTarget);if(u.shouldHandle(e)){u.newFromContainer(t).unsubscribe().then((()=>{t.hide()}),i.noop)}else if(l.shouldHandle(e,t)){l.newFromContainer(t).toggle()}})),(0,n.default)(e).on("click",(e=>{(0,n.default)(".js-subscription-config-dropdown-container").get().every((t=>!n.default.contains(t,e.target)))&&l.visibleDropdowns().addClass("is-hidden")}))};var n=s(r(65311)),i=r(66419),a=r(70879),o=s(r(57942));function s(e){return e&&e.__esModule?e:{default:e}}class l{static shouldHandle(e,t){const r=t.find(".js-subscription-config-dropdown-btn"),i=(0,n.default)(e.target).is(r),a=n.default.contains(r.get(0),e.target);return i||a}static visibleDropdowns(){return(0,n.default)(".js-subscription-config-dropdown-content:not(.is-hidden)")}static newFromContainer(e){const t=e.find(".js-subscription-config-dropdown-btn"),r=e.find(".js-subscription-config-dropdown-content");return new l(t,r)}constructor(e,t){this.$button=e,this.$content=t}toggle(){this.$content.toggleClass("is-open")}}class d extends Error{}class u{static shouldHandle(e){return(0,n.default)(e.target).is(".js-unsubscribe-btn")}static newFromContainer(e){const t=e.find(".js-unsubscribe-btn");return new u(t.get(0))}constructor(e){this._$el=(0,n.default)(e)}get blogUri(){return this._$el.attr("data-blog-uri")}get confirmingMessage(){return this._$el.attr("data-confirm-msg")}get completionMessage(){return this._$el.attr("data-completion-msg")}async unsubscribe(){if(!this.confirmed())return Promise.reject(new d);return[()=>this.toggleState(),()=>this.requestUnsubscribe(),()=>this.notifyCompletion()].reduce((async(e,t)=>e.then(t)),Promise.resolve()).catch((e=>this.onFailure(e)))}onFailure(e){this.toggleState(),(0,a.BUG)(e,"UnsubscribeButton")}confirmed(){return window.confirm(this.confirmingMessage)}toggleState(){this._$el.prop("disabled",!this._$el.prop("disabled")),this._$el.toggleClass("disabled")}requestUnsubscribe(){return n.default.ajax({type:"POST",url:"/api/1/json/unsubscribe",data:{uri:this.blogUri,rkm:(0,o.default)("rkm"),rkc:(0,o.default)("rkc")}})}notifyCompletion(){alert(this.completionMessage)}}},65939:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.trackGlobalHeaderLinkClick=t.trackGlobalHeaderClick=t.initGlobalHeaderEventTracker=void 0;var n=r(50025);const i="ghTracker";let a;const o=e=>{let{eventCategory:t,eventLabel:r}=e;a&&a()(`${i}.send`,{hitType:"event",eventCategory:t,eventAction:"click",eventLabel:r,nonInteraction:!0,transport:"beacon"})};t.trackGlobalHeaderClick=e=>{o({eventCategory:e,eventLabel:""})};t.trackGlobalHeaderLinkClick=(e,t)=>{o({eventCategory:e,eventLabel:t})};t.initGlobalHeaderEventTracker=()=>{(0,n.createGoogleAnalyticsTrackerWithReceivedClientId)(((e,t)=>{a=e,e()("create","UA-29716941-46","auto",i,{clientId:t,storage:"none"})})),document.querySelectorAll("[data-gh-track-category]").forEach((e=>e.addEventListener("click",(t=>{const r=e.getAttribute("data-gh-track-category")||"",n=e.getAttribute("href")||"";o({eventCategory:r,eventLabel:n})}))))}},1493:(e,t,r)=>{"use strict";const n=r(65311),i={init:function(){var e=this,t=n("#android-app-banner");0!==t.length&&(n("#android-app-banner-close").click((r=>{t.slideToggle(400),e.setDismiss(!0)})),e.isDismissed()||setTimeout((()=>{t.slideToggle(400)}),0))},_localStorageKey:"Hatena.Diary.Pages.AdminTouch.dismissAndroidAppBanner",_localStorageEnabled:function(){try{if(window.localStorage)return!0}catch(e){}return!1},isDismissed:function(){return!!this._localStorageEnabled()&&"true"===localStorage.getItem(this._localStorageKey)},setDismiss:function(e){this._localStorageEnabled()&&localStorage.setItem(this._localStorageKey,e?"true":"false")}};e.exports=i},85798:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Actions=void 0;t.Actions=class{constructor(e){this.editor=e}}},40626:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HTMLActions=void 0;var n,i=(n=r(20996))&&n.__esModule?n:{default:n},a=r(85798);class o extends a.Actions{constructor(e){super(e),this.editor=e}formatBlock(e){this.editor.execCommand("FormatBlock","p"),this.editor.execCommand("FormatBlock",e)}defaultParagraph(){this.editor.execCommand("FormatBlock","p")}largeHeading(){this.formatBlock("h3")}middleHeading(){this.formatBlock("h4")}smallHeading(){this.formatBlock("h5")}italic(){this.editor.execCommand("Italic")}bold(){this.editor.execCommand("Bold")}strike(){this.editor.execCommand("StrikeThrough")}unorderedList(){this.editor.execCommand("InsertUnorderedList")}orderedList(){this.editor.execCommand("InsertOrderedList")}link(){if(this.editor.selectedNode?.closest("a[href]")||this.editor.selectedNodeRange?.cloneContents().querySelector("a[href]"))this.editor.execCommand("Unlink");else{const e="https://",t=prompt(i.default.text("edit_form.link_url_prompt"),e);if(!t||t===e)return;this.editor.execCommand("CreateLink",t)}}insertSeeMore(){this.editor.insertLines(["\x3c!-- more --\x3e",""])}insertTOC(){this.editor.insertLines(["[:contents]",""])}blockquote(){this.editor.execCommand("mceBlockQuote")}footnote(){const e=this.editor.selectedHTML;if(e.length)this.editor.replace(`((${e}))`);else{const e=i.default.text("edit_form.footnote_message");this.editor.insertAndSelectText(`((${e}))`,2,2+e.length)}this.editor.focus()}left(){this.editor.execCommand("JustifyLeft")}center(){this.editor.execCommand("JustifyCenter")}right(){this.editor.execCommand("JustifyRight")}}t.HTMLActions=o},60405:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HatenaActions=void 0;var n,i=r(70879),a=(n=r(20996))&&n.__esModule?n:{default:n},o=r(85798);const s="not implemented";class l extends o.Actions{constructor(e){super(e),this.editor=e}defaultParagraph(){const e=this.editor.getSelectionBlock();e.togglePrefix("",/^(?:\*+\s*)?/,/^\*+\s*/,!1),this.editor.setSelectionBlock(e)}largeHeading(){const e=this.editor.getSelectionBlock();e.togglePrefix("*",/^(?!)/,/^\*+\s*/,!1),this.editor.setSelectionBlock(e)}middleHeading(){const e=this.editor.getSelectionBlock();e.togglePrefix("**",/^(?!)/,/^\*+\s*/,!1),this.editor.setSelectionBlock(e)}smallHeading(){const e=this.editor.getSelectionBlock();e.togglePrefix("***",/^(?!)/,/^\*+\s*/,!1),this.editor.setSelectionBlock(e)}italic(){this.editor.wrapString("<em>","</em>","<i>","</i>")}bold(){this.editor.wrapString("<strong>","</strong>","<b>","</b>")}strike(){this.editor.wrapString("<s>","</s>")}unorderedList(){const e=this.editor.getSelectionBlock();e.togglePrefix("-",/^-\s?/,/^\+\s?/,!1),this.editor.setSelectionBlock(e)}orderedList(){const e=this.editor.getSelectionBlock();e.togglePrefix("+",/^\+\s?/,/^-\s?/,!1),this.editor.setSelectionBlock(e)}link(){const e=this.editor.getSelectionText(),t=this.editor.getSelectionRange(),r=a.default.text("edit_form.link_url_message");""===e?this.editor.insert(`[${r}:title]`):this.editor.wrapString(`[${r}:title=`,"]"),t.start+=1,t.end=t.start+r.length,this.editor.setSelectionRange(t)}insertSeeMore(){this.editor.insertLines(["====",""])}insertTOC(){this.editor.insertLines(["[:contents]",""])}blockquote(){const e=this.editor.getSelectionRange(),t=this.editor.wholeText,r="\n"===(t.charAt(e.start-1)||"\n")?">>\n":"\n>>\n",n="\n"===(t.charAt(e.end)||"\n")?"\n<<":"\n<<\n";this.editor.wrapString(r,n)}footnote(){this.editor.wrapStringAroundLabel("((",a.default.text("edit_form.footnote_message"),"))")}left(){(0,i.BUG)(s)}center(){(0,i.BUG)(s)}right(){(0,i.BUG)(s)}}t.HatenaActions=l},20507:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MarkdownActions=void 0;var n,i=(n=r(20996))&&n.__esModule?n:{default:n},a=r(60405);class o extends a.HatenaActions{constructor(e){super(e),this.editor=e}defaultParagraph(){const e=this.editor.getSelectionBlock();e.togglePrefix("",/^(?:#+\s+)?/,/^#+\s+/,!1),this.editor.setSelectionBlock(e)}largeHeading(){const e=this.editor.getSelectionBlock();e.togglePrefix("###",/^(?!)/,/^#+\s+/,!1),this.editor.setSelectionBlock(e)}middleHeading(){const e=this.editor.getSelectionBlock();e.togglePrefix("####",/^(?!)/,/^#+\s+/,!1),this.editor.setSelectionBlock(e)}smallHeading(){const e=this.editor.getSelectionBlock();e.togglePrefix("#####",/^(?!)/,/^#+\s+/,!1),this.editor.setSelectionBlock(e)}italic(){this.editor.wrapString("*","*","<i>","</i>")}bold(){this.editor.wrapString("**","**","<b>","</b>")}unorderedList(){const e=this.editor.getSelectionBlock();e.togglePrefix("*",/^[*\-+]\s/,/^[0-9]+\.\s/,!0),this.editor.setSelectionBlock(e)}orderedList(){const e=this.editor.getSelectionBlock();e.togglePrefixNumber(/^[0-9]+\.\s/,/^[*\-+]\s/,!0),this.editor.setSelectionBlock(e)}insertSeeMore(){this.editor.insertLines(["\x3c!-- more --\x3e",""])}blockquote(){const e=this.editor.getSelectionBlock();e.togglePrefix(">",/^>\s?/,/^>\s?/,!0),this.editor.setSelectionBlock(e)}link(){const e=this.editor.getSelectionText(),t=this.editor.getSelectionRange(),r=i.default.text("edit_form.link_url_message");this.editor.wrapString("[",`](${r})`),t.start+=`[${e}](`.length,t.end=t.start+r.length,this.editor.setSelectionRange(t)}}t.MarkdownActions=o},48631:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RawActions=void 0;var n=r(60405);class i extends n.HatenaActions{constructor(e){super(e),this.editor=e}}t.RawActions=i},63307:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Editor=void 0;var n=r(10714);t.Editor=class{constructor(e){this.textarea=e,this.actions=this.createActions(),n.EditorConnector.registerCurrentTouchEditor(this)}get syntaxForInsertLines(){return this.mode}invokeAction(e){this.actions[e]()}createActions(){throw new Error("Editor#createActions() is not implemented.")}}},71835:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HTMLEditor=void 0;var n=r(55992),i=r(46613),a=r(40626),o=r(63307);class s extends o.Editor{constructor(e){super(e),this.tinyEditor=null,tinymce.init({...i.TINY_MCE_CONFIGS,target:e,content_css:(0,n.staticUrl)("/css/touch/blog-edit.css"),setup:e=>{this.onTinymceSetup(e)}}),this.textarea.addEventListener("change",(()=>{this.tinyEditor&&(this.tinyEditor.load(),this.tinyEditor.save())}))}get mode(){return"html"}get selectedHTML(){return this.tinyEditor?.selection.getContent()||""}get selectedNode(){return this.tinyEditor?.selection.getNode()||null}get selectedNodeRange(){return this.tinyEditor?.selection.getRng()||null}onTinymceSetup(e){this.tinyEditor=e,e.on("Change",(()=>{e.save()}))}insert(e){const t=this.tinyEditor;t&&t.insertContent(e)}createActions(){return new a.HTMLActions(this)}insertLines(e){this.insert(e.map((e=>`<p>${e}</p>`)).join(""))}execCommand(e,t){this.tinyEditor&&this.tinyEditor.execCommand(e,!1,t)}replace(e){this.tinyEditor?.selection.setContent(e)}insertAndSelectText(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length;if(!this.tinyEditor)return;const n=this.tinyEditor.selection.getRng(),i=this.tinyEditor.getDoc().createTextNode(e);n.insertNode(i),n.setStart(i,t),n.setEnd(i,r),this.tinyEditor.selection.setRng(n)}focus(){this.tinyEditor&&!this.tinyEditor.isHidden()?this.tinyEditor.focus():this.textarea.focus()}switchToWYSIWYG(){this.tinyEditor&&this.tinyEditor.show()}switchToSource(){this.tinyEditor&&this.tinyEditor.hide()}}t.HTMLEditor=s},91027:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HatenaEditor=void 0;var n=r(13994),i=r(60405),a=r(63307);class o extends a.Editor{constructor(e){super(e),this.setupEventHandler()}get mode(){return"hatena"}get wholeText(){return this.textarea.value}insert(e){const t=this.getSelectionRange();this.replaceInternally(e,t),this.textarea.setSelectionRange(t.start+e.length,t.start+e.length),this.textarea.dispatchEvent(new InputEvent("input"))}insertLines(e){const t=this.getSelectionRange(),r=this.textarea.value[t.start-1],n=void 0===r||"\n"===r?"":"\n";this.insert(`${n}${e.join("\n")}\n`)}wrapString(e,t,r,n){let i,a=this.getSelectionText();return a.startsWith(e)&&a.endsWith(t)?(a=a.substring(e.length,a.length-t.length),i=this.replace(a)):r&&n&&a.startsWith(r)&&a.endsWith(n)?(a=a.substring(r.length,a.length-n.length),i=this.replace(a)):(i=this.replace(e+a+t),""===a&&(i.start+=e.length,i.end=i.start)),this.setSelectionRange(i),i}getSelectionText(e){return e=e||this.getSelectionRange(),this.textarea.value.substring(e.start,e.end)}setSelectionRange(e){this.textarea.setSelectionRange(e.start,e.end)}getSelectionRange(){return{start:this.textarea.selectionStart,end:this.textarea.selectionEnd}}replace(e,t){return t=t||this.getSelectionRange(),this.replaceInternally(e,t),this.textarea.dispatchEvent(new InputEvent("input")),{start:t.start,end:t.start+e.length}}replaceInternally(e,t){const r=this.textarea;r.setSelectionRange(t.start,t.end),r.focus();let n=!1;try{n=document.execCommand("insertText",!1,e)}catch(e){}n||r.setRangeText(e)}deleteSelection(){const e=this.textarea;e.focus();let t=!1;try{t=document.execCommand("delete")}catch{}t||(e.setRangeText(""),e.dispatchEvent(new InputEvent("input")))}getSelectionBlock(){const e=this.getSelectionRange(),t=this.textarea.value;return new n.SelectionTextBlock(t,e)}setSelectionBlock(e){const t=e.getRange(),r=e.getBlockText();this.replaceInternally(r,t),this.setSelectionRange(e.getSelectionRange()),this.textarea.dispatchEvent(new InputEvent("input"))}createActions(){return new i.HatenaActions(this)}moveCaretBy(e){const t=this.getSelectionRange();t.start+=e,t.end=t.start,this.setSelectionRange(t)}wrapStringAroundLabel(e,t,r){const n=this.getSelectionText();if(this.wrapString(e,r),0===n.length){const e=this.replace(t);this.setSelectionRange(e)}}setupEventHandler(){this.textarea.addEventListener("keydown",(e=>{if("Enter"!==e.key)return;if(["Alt","Control","Shift","Meta"].some((t=>e.getModifierState(t))))return;const t=this.getSelectionBlock(),r=t.getLines()[0],n=this.detectListItem(r);if(!n)return;const i=t.getRange(),a=this.getSelectionRange();a.start<i.start+n.marker.length||(e.preventDefault(),n.hasContent?this.insert(`\n${n.nextMarker}`):(this.setSelectionRange({start:i.start,end:a.end}),this.deleteSelection()))}))}detectListItem(e){const t=e.match(/^([+-]+\s*)(.?)/);return t?{marker:t[1],nextMarker:t[1],hasContent:!!t[2]}:null}}t.HatenaEditor=o},38995:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MarkdownEditor=void 0;var n=r(20507),i=r(91027);class a extends i.HatenaEditor{constructor(e){super(e)}get mode(){return"markdown"}createActions(){return new n.MarkdownActions(this)}detectListItem(e){const t=e.match(/^(?<marker>\s*(?:[*\-+]|(?<number>[0-9]+)\.)\s)(?<content>.?)/);if(!t||!t.groups)return null;const r=t.groups.marker,n=t.groups.number,i=!!t.groups.content;if(n){const e=Number(n)+1,t=r.replace(n,String(e));return{marker:r,nextMarker:t,hasContent:i}}return{marker:r,nextMarker:r,hasContent:i}}}t.MarkdownEditor=a},33918:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Preview=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=a(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,r&&r.set(e,n);return n}(r(347)),i=r(19575);function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(a=function(e){return e?r:t})(e)}t.Preview=class{constructor(e){this.editorId=`editor-${Math.random().toString(32).substring(2)}`,this.editorForm=e;const t=e.querySelector(".js-preview-button"),r=e.querySelector(".js-preview-close-button"),n=e.querySelector(".js-preview-wrapper"),i=e.querySelector(".js-category-editor");if(!(t instanceof HTMLButtonElement))throw new Error("previewButton not found");if(this.previewButton=t,!(r instanceof HTMLButtonElement))throw new Error("previewCloseButton not found");if(this.previewCloseButton=r,!(n instanceof HTMLDivElement))throw new Error("dialog not found");if(this.dialog=n,!(i instanceof HTMLDivElement))throw new Error("categoryEditor not found");this.categoryEditor=i,this.setupEvent()}setupEvent(){this.previewButton.addEventListener("click",(()=>{this.showPreview()})),this.previewCloseButton.addEventListener("click",(()=>{this.hidePreview()}))}hidePreview(){this.dialog.classList.remove("is-visible")}showPreview(){this.dialog.classList.add("is-visible"),this.updatePreviewHTML("hatena-preview-iframe");const e=document.querySelector('input[name="is_touch_preview_used"]');e&&(e.value="1")}async updatePreviewHTML(e){const t=this.editorForm.querySelector('input[name="title"]')?.value??"",r=this.editorForm.querySelector('textarea[name="body"]')?.value??"",a=this.editorForm.querySelector('input[name="customurl"]')?.value??"",o=this.editorForm.querySelector('input[name="syntax"]')?.value??"",s=this.editorForm.dataset.authorName,l=Number(this.editorForm.dataset.forcePcView)?1:0,d=this.editorForm.querySelector('input[name="datetime"]')?.value??"",u=this.editorForm.querySelector('input[name="publication_type"]')?.value??"",c=(0,i.encode)(r),p=await n.default.post("./preview",{title:t,"body.base64":c,og_description:"",datetime:d,author_name:s,publication_type:u,customurl:a,device:"touch",syntax:o,editor_id:this.editorId,"force-pc-view":l},{transformRequest:[n.withEpicRKs,n.formDataRequest]}),f={title:t,"body.base64":c,og_description:"",datetime:d,author_name:s,publication_type:u,layout:"",customurl:a,device:"touch",syntax:o,datetime_tz:p.data.datetime_tz,signature:p.data.signature,editor_id:this.editorId,token:p.data.preview_token,"force-pc-view":l},h=p.data.uri,m=document.createElement("form");m.style.display="none",m.method="POST",m.target=e,m.action=h;for(const[e,t]of Object.entries(f)){const r=document.createElement("textarea");r.name=e,r.value=t,m.appendChild(r)}this.getCategories().forEach((e=>{const t=document.createElement("textarea");t.name="category",t.value=e,m.appendChild(t)})),document.body.appendChild(m),m.submit(),m.remove()}getCategories(){return Array.from(this.categoryEditor.querySelectorAll('input[name="category"]')).map((e=>e.value))}}},82788:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RawEditor=void 0;var n=r(48631),i=r(91027);class a extends i.HatenaEditor{constructor(e){super(e)}get mode(){return"raw"}get syntaxForInsertLines(){return"html"}createActions(){return new n.RawActions(this)}setupEventHandler(){}}t.RawEditor=a},36524:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Toolbar=void 0;t.Toolbar=class{constructor(e,t){this.toolbar=e,this.editor=t,this.setupEventListeners()}setupEventListeners(){this.toolbar.querySelectorAll("button[data-action]").forEach((e=>{const t=e.dataset.action||"";e.addEventListener("click",(()=>{this.editor.invokeAction(t)}))}));const e=this.toolbar.querySelector(".js-toolbar-heading");e&&e.querySelectorAll("button[data-action]").forEach((t=>{t.addEventListener("click",(()=>{e.open=!1}))}))}}},56663:(e,t,r)=>{"use strict";var n,i=(n=r(20996))&&n.__esModule?n:{default:n};const a=r(65311),o=r(48211),s={init(e){a(".js-toolbar").show(),s.setupAjaxUpload(e)},setupAjaxUpload(e){var t=a(".js-toolbar").find("input[type=file]");t.change((function(){this.files.length&&o({$input:t,$progress:a(".js-progress")}).done(e).fail((()=>{alert(i.default.text("admin.blog.config.image_upload_failure"))}))}))}};e.exports=s},1889:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEditor=void 0;var n=r(71835),i=r(91027),a=r(38995),o=r(82788);t.createEditor=e=>{const t=document.querySelector('textarea[name="body"]');if(!t)throw new Error("Failed to create Editor, textarea not found.");switch(e){case"html":return new n.HTMLEditor(t);case"markdown":return new a.MarkdownEditor(t);case"hatena":return new i.HatenaEditor(t);case"raw":return new o.RawEditor(t);default:throw new Error(`Failed to createEditor() due to invalid syntax: ${e}`)}}},96140:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerHTMLEditorTabButtons=void 0;var n=r(71835);t.registerHTMLEditorTabButtons=e=>{let{editor:t,editorContainer:r,wysiwygEditorButton:i,sourceEditorButton:a}=e;a&&i&&r&&t instanceof n.HTMLEditor&&(a.addEventListener("click",(()=>{(e=>{let{editor:t,editorContainer:r,wysiwygEditorButton:n,sourceEditorButton:i}=e;t.switchToSource();const a=r.offsetHeight;r.style.setProperty("height",`${a}px`),r.classList.add("is-editing-source"),n.classList.remove("is-active"),i.classList.add("is-active"),t.focus()})({editor:t,editorContainer:r,wysiwygEditorButton:i,sourceEditorButton:a})})),i.addEventListener("click",(()=>{(e=>{let{editor:t,editorContainer:r,wysiwygEditorButton:n,sourceEditorButton:i}=e;t.switchToWYSIWYG(),r.classList.remove("is-editing-source"),r.style.removeProperty("height"),n.classList.add("is-active"),i.classList.remove("is-active"),t.focus()})({editor:t,editorContainer:r,wysiwygEditorButton:i,sourceEditorButton:a})})))}},83391:(e,t,r)=>{"use strict";const n=r(65311);e.exports=function(){n(".post-options .js-datetime").show();var e=n(".js-datetime-input-date"),t=n(".js-datetime-input-time"),r=n("input[name=datetime]"),i=function(e){r.val(e).trigger("change")},a=r.val()||"",o=a.match(/^(\d{4}-\d{2}-\d{2})T(\d{2}:\d{2}:\d{2})\+(\d{2}:\d{2})$/);if(o){var s=o[1],l=o[2];e.val(s),t.val(l)}e.change((()=>{var r=e.val(),n=t.val();r?(n||(t.val("00:00"),n="00:00"),i(`${r}T${n}`)):i(a)})),t.change((()=>{var r=e.val(),n=t.val();if(n){if(!r){var o=function(){var e=new Date,t=[];return t.push((1900+e.getYear()).toString()),t.push(`0${(1+e.getMonth()).toString()}`.slice(-2)),t.push(`0${e.getDate().toString()}`.slice(-2)),t.join("-")}();e.val(o),r=o}i(`${r}T${n}`)}else i(a)}))}},48211:(e,t,r)=>{"use strict";var n=a(r(20996)),i=a(r(57942));function a(e){return e&&e.__esModule?e:{default:e}}const o=r(65311);e.exports=function(e){var t=e.folder||"Hatena Blog",r=e.fotosize||1200,a=e.$input,s=a.prop("files")[0],l=e.$progress,d=o.Deferred();a.prop("disabled",!0);var u=new FormData;u.append("rkm",(0,i.default)("rkm")),u.append("append",1),u.append("fototitle",""),u.append("folder",t),u.append("fotosize",r),u.append("image",s),u.append("delete-gps",1),l.show();var c=l.find(".bar");c.width("0%");var p=l.find(".percent"),f=function(e){e>100&&(e=100),c.width(`${e}%`),p.text(n.default.text("uploading"))},h=new XMLHttpRequest;return h.upload.addEventListener("progress",(e=>{var t=e.lengthComputable?e.loaded/e.total*100:NaN;f(t)}),!1),h.addEventListener("load",(e=>{if(f(100),l.hide(),a.prop("disabled",!1),200===h.status){var t=h.responseText;d.resolve(t)}else d.reject(h.responseText)}),!1),h.addEventListener("error",(e=>{l.hide(),a.prop("disabled",!1),d.reject(e)}),!1),h.open("POST",`/f/${(0,i.default)("name")}/upbysmart?dummy=${(new Date).getTime()}`),h.setRequestHeader("X-Requested-With","XMLHttpRequest"),h.send(u),d}},30546:(e,t,r)=>{"use strict";var n=r(13964);const i=function(){this.init.apply(this,arguments)};i.prototype={init:function(e){this.$el=e,this.$textarea=e.find("textarea"),this.$errorMessage=e.find(".js-twitter-length-error"),this.$checkBox=e.find('input[name="post_to_twitter"]'),this.$shareButton=e.find(".js-touch-share-button"),this.bindEvents()},bindEvents:function(){var e=this;e.$textarea.keyup((()=>{!1===(0,n.validateTweetLength)(e.$textarea.val())?(e.showErrorMessage(),e.disabledCheckBox(),e.disabledShareButton()):(e.hideErrorMessage(),e.enabledCheckBox(),e.enabledShareButton())}))},hideErrorMessage:function(){this.$errorMessage.hide()},showErrorMessage:function(){this.$errorMessage.show()},disabledCheckBox:function(){this.$checkBox.attr("disabled",!0)},enabledCheckBox:function(){this.$checkBox.attr("disabled",!1)},disabledShareButton:function(){this.$shareButton.attr("disabled",!0)},enabledShareButton:function(){this.$shareButton.attr("disabled",!1)}},e.exports=i},39769:(e,t,r)=>{"use strict";r(65311);const n=r(66419),i={_setup:function(){this._reloadStarImplement||(this._reloadStarImplement=n.throttle((()=>{document.dispatchEvent(new Event("hatena:star:requestreload"))}),1e3))},reloadStar:function(){this._setup(),this._reloadStarImplement()}};e.exports=i},6636:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AccessLogger=void 0;var n=s(r(65311)),i=s(r(57942)),a=r(55992),o=s(r(80129));function s(e){return e&&e.__esModule?e:{default:e}}const l={ping(){if(!(0,i.default)("blogs-uri-base"))return;const e=(0,a.protocolRelativeAdminUrl)("/api/log"),t={uri:location.href,referer:document.referrer};n.default.ajax({url:e,type:"get",cache:!1,data:t,xhrFields:{withCredentials:!0}}).fail((()=>{const r=o.default.stringify({...t,_:(new Date).getTime()});(new Image).src=`${e}?${r}`}))}};t.AccessLogger=l},59662:e=>{"use strict";const t=e=>-1!==navigator.userAgent.indexOf(e),r=t("MSIE")||t("Trident/"),n=t("MSIE 6."),i=t("MSIE 7."),a=t("MSIE 8."),o=t("MSIE 9."),s=t("MSIE 10."),l=t("Trident/")&&t("rv:11."),d=t("Mozilla")&&!t("compatible")&&!t("WebKit"),u=!!window.opera,c=t("WebKit")&&t("Chrome/"),p=t("Chrome/"),f=t("Firefox/"),h=t("Nintendo DSi"),m=t("Nintendo Wii"),g=t("Android"),v=t("Android")&&t("Mobile"),b=t("Android")&&!t("Mobile"),y=t("iPod;")||t("iPhone;")||t("iPhone Simulator;"),_=t("Windows Phone"),w=t("iPad"),E=t("Mobile"),S={isIE:r,isIE6:n,isIE7:i,isIE8:a,isIE9:o,isIE10:s,isIE11:l,isMozilla:d,isOpera:u,isSafari:c,isChrome:p,isFirefox:f,isDSi:h,isWii:m,isAndroid:g,isAndroidMobile:v,isAndroidTablet:b,isIPhone:y,isWindowsPhone:_,isIPad:w,isMac:t("Mac OS"),isTouch:E&&!w,isSmartPhone:y||v||_,isHatenaBlogNativeApp:t("HatenaBlog/"),isTablet:b||w,isObsolete:n||i||a||o||s};e.exports=S},56882:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(65311)),i=a(r(57942));function a(e){return e&&e.__esModule?e:{default:e}}var o={updateMembershipCategory(e){const t=e.attr("data-circle-id"),r=e.attr("data-blog-id"),a=e.find("option:selected").val();let o,s;return"delete"===a?o="delete":(o="update",s=a),n.default.ajax({url:"/api/circle/membership/category",type:"POST",data:{rkm:(0,i.default)("rkm"),rkc:(0,i.default)("rkc"),operation:o,circle_id:t,blog_id:r,category_id:s}})}};t.default=o},24264:(e,t,r)=>{"use strict";var n=r(59662),i={userAgent:function(){return n.isTouch?"touch":"pc"}};e.exports=i},73287:(e,t,r)=>{"use strict";const n=r(17187).EventEmitter,i=new n;i.on("__DISPATCH__",(e=>{i.emit(e.type,e.payload)}));function a(e){return e}i.Actions=class{emit(e,t){i.emit("__DISPATCH__",{type:e,payload:t})}},i.Store=class extends n{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;super(),this.state=e(void 0,{}),i.on("__DISPATCH__",(t=>{this.state=e(this.state,t||{}),this.emit("change")}))}getState(){return this.state}},e.exports=i},96371:(e,t,r)=>{"use strict";var n,i=r(70879),a=(n=r(57942))&&n.__esModule?n:{default:n};var o=r(65311),s=r(26410),l=r(36500),d="hatena-diary-dropdown",u={toggle:function(e,t,r,n){r=d+(r?`-${r}`:e.replace(/\//,"-")),"object"!=typeof(n=n||{})&&(0,i.BUG)(`Wrong type of options given: ${n}`);var u,c=o(document.getElementById(r));if(n.key&&c.length&&c.attr("data-dropdown-key")!==n.key&&(c.remove(),c=o()),c.length)u="show"in n?!!n.show:!c.is(":visible"),c[u?"fadeIn":"fadeOut"]("fast"),c.trigger(`dropdown:${u?"show":"hide"}:start`);else if("show"in n&&!1===n.show);else{if(c=o('<div class="hatena-globalheader-window"></div>').hide().attr("id",r).appendTo(document.body),n.key&&c.attr("data-dropdown-key",n.key),n.parent){var p=document.getElementById(`${d}-${n.parent}`);o(p).on("dropdown:hide:start",(()=>{c.fadeOut("fast")}))}n.className&&c.addClass(n.className);var f=o('<iframe frameborder="0" width="150" height="300"></iframe>').appendTo(c),h=f[0];/^https?:/.test(e)||(e=(0,a.default)("admin-domain")+e);var m=l.createForFrame(h,e);if(m.addEventListener("close",(()=>{s.hide(f)})),m.addEventListener("init",(e=>{e&&c.css(e),m.send("init",t)})),m.addEventListener("resize",(e=>{e&&c.css(e)})),m.addEventListener("reload",(e=>{location.reload(!0)})),n.callback&&n.callback(h,m),s.show(c,{destroy:function(){c.remove(),m.destroy()},keepOthers:!!n.parent||!1}),t){if("left"in t||"right"in t||"top"in t){var g=c.offset();"left"in t?g.left=t.left:"right"in t&&(g.left=t.right-c.width()),"top"in t&&(g.top=t.top),c.offset(g)}"height"in t&&c.height(t.height)}}}};e.exports=u},10714:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EditorConnector=void 0;var n=a(r(65311)),i=a(r(1606));function a(e){return e&&e.__esModule?e:{default:e}}const o=r(36500),s=r(56412);let l=null,d=null;const u={insertLines(e){this._validate(e),this._setup(),this._insertLinesImplement(e)},isiOS:()=>Boolean((0,i.default)(location.search.substr(1)).ios),isAndroid:()=>Boolean((0,i.default)(location.search.substr(1)).android),loadServiceOnChildWindow(e){const t=window.open();o.createForWindow(t,e).addEventListener("insertLines",(e=>{this.insertLines(e)}))},_validate(e){["html","hatena","markdown"].forEach((t=>{if(!e[t])throw`missing ${t}`}))},_setup(){if(this._insertLinesImplement)return;const e="pc"===s.device()&&l,t="touch"===s.device(),r=window.opener,n=this.isiOS(),i=this.isAndroid();if(n||i)this._insertLinesImplement=this._insertLinesOpenURL;else if(e)this._insertLinesImplement=this._insertLinesPC;else if(t)this._insertLinesImplement=this._insertLinesTouch;else{if(!r)throw"handling failed";this._insertLinesImplement=this._insertLinesMessenger}},_insertLinesImplement:null,_insertLinesPC(e){if(!l)return;const t=e[l.syntaxForInsertLines];l.insertLines(t)},_insertLinesTouch(e){if(!d)return;const t=e[d.syntaxForInsertLines];d.insert(t.join("\n"))},_insertLinesMessenger(e){o.createForParent().send("insertLines",e),window.close()},_insertLinesOpenURL(e){const t=e.html.map((e=>`<p>${e}</p>`));location.href=`hatenablog:/entry/body/insert?${n.default.param({hatena:e.hatena.join("\n"),html:t.join(""),markdown:e.markdown.join("\n\n"),version:1})}`},registerCurrentEditor(e){l=e},registerCurrentTouchEditor(e){d=e},emit(){l&&l.emit(...arguments)},getEntryId(){const e=document.querySelector('#edit-form input[name="entry"]');if(e instanceof HTMLInputElement&&0!=e.value.length)return e.value}};t.EditorConnector=u},41730:(e,t,r)=>{"use strict";var n,i=(n=r(57942))&&n.__esModule?n:{default:n};var a=r(65311),o=r(26410),s=r(36500),l="hatena-diary-feedback",d={toggle:function(e){var t=document.getElementById(l);if(t)a(t).fadeToggle("fast");else{var r=a('<iframe frameborder="0" width="320" height="320"></iframe>').hide().attr("id",l).appendTo(document.body);t=r[0];var n=s.createForFrame(t,`${e}?uri=${encodeURIComponent(location.href)}&page_id=${encodeURIComponent((0,i.default)("page"))}`);n.addEventListener("close",(()=>{o.hide(r)})),n.addEventListener("resize",(e=>{e&&r.css(e)})),o.show(r,{destroy:function(){r.remove(),n.destroy()},fixScroll:!0})}}};e.exports=d},60802:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FormState=void 0;var n=a(r(20996)),i=a(r(65311));function a(e){return e&&e.__esModule?e:{default:e}}const o=void 0!==window.onbeforeunload?"beforeunload":"unload";t.FormState=class{constructor(e){this.$form=e,this.isWatching=!0,this.initialState="",this.commit(),this.$form.on("submit",(()=>{this.isWatching=!1})),this.onLeave=()=>this.confirm(),(0,i.default)(window).on(o,this.onLeave)}confirm(){if((0,i.default)(window).triggerHandler("close-preview-window"),this.isWatching&&this.hasFormChanged())return n.default.text("form.confirm.changed.epic")}hasFormChanged(){return this.$form.serialize()!==this.initialState}commit(){this.initialState=this.$form.serialize()}unWatch(){(0,i.default)(window).off(o,this.onLeave)}}},56769:(e,t,r)=>{"use strict";var n=r(86965),i=r(70879),a=r(55834),o=l(r(57942)),s=l(r(65311));function l(e){return e&&e.__esModule?e:{default:e}}const d=r(36500),u=r(24264),c=r(56412);e.exports=class{constructor(){const e=!!(0,a.hasFlagVariant)("gh-ng");this.globalheader=this.createGlobalHeader(),this.color=this.getColor(),this.bgColor=this.getBackgroundColor(),this.circleId=this.getCircleId(),this.pageCategory=this.getPageCategory(),this.params=this.getParams();const t=e?this.getURLNextGen():this.getURL();d.listenToFrame(this.globalheader,t),d.addEventListener("init",(e=>{(0,s.default)((()=>{(0,i.LOG)(["init",e]),c.resolveInfo(e)}))}))}createGlobalHeader(){const e=document.querySelector("iframe#globalheader");if(e)return e;{const e=(0,s.default)('<iframe id="globalheader" style="display: none"></iframe>');return e.appendTo(document.body),e[0]}}getColor(){return(0,n.canonicalizeColor)((0,s.default)(this.globalheader).css("color"))||"000000"}getBackgroundColor(){let e=null,t=this.globalheader;for(;!e&&t&&t!==document.documentElement;){const r=(0,s.default)(t).css("backgroundColor");e=(0,n.canonicalizeColor)(r),t=t.parentNode}return e||(e="ffffff"),e}getDevice(){const e=(0,o.default)("globalheader-type")||"auto";return"auto"===e?u.userAgent():e}getCircleId(){return(0,o.default)("circle-id")}getPageCategory(){return/\.hatena\.ne\.jp(:\d+)?$/.test(location.host)?"admin":(0,o.default)("blog")?"blogs":this.circleId?"circle":"global"}showUpgradePro(){return"admin"===this.pageCategory&&(0,o.default)("dont-recommend-pro")&&"false"===(0,o.default)("dont-recommend-pro")&&(0,o.default)("pro")&&"false"===(0,o.default)("pro")}showGMOCampaignLink(){return"admin"===this.pageCategory&&(0,o.default)("dont-recommend-pro")&&"false"===(0,o.default)("dont-recommend-pro")}getBrand(){return(0,o.default)("brand")}getParams(){const e={device:this.getDevice()};return this.circleId&&(e.circle_id=this.circleId),this.showGMOCampaignLink()&&(e.show_upgrade_pro="yes"),this.showGMOCampaignLink()&&(e.show_campaign="yes"),(0,o.default)("brand")&&(e.brand=(0,o.default)("brand")),e}getURL(){const e=(0,o.default)("admin-domain"),t=encodeURIComponent(this.color),r=encodeURIComponent(this.bgColor),n=s.default.param(this.params),i=encodeURIComponent(location.href);return`${e}/-/globalheader/${t}/${r}/${this.pageCategory}?${n}#${i}`}getURLNextGen(){return`${(0,o.default)("admin-origin")}/-/globalheader_ng?${s.default.param(this.params)}#${encodeURIComponent(location.href)}`}}},36843:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initForGlobalHeaderNextGeneration=t.GlobalHeaderSubscriber=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(55992)),a=(n=r(57942))&&n.__esModule?n:{default:n},o=r(50025);function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}const l=r(65311),d=r(36500),u=r(56412),c=r(96371),p=r(26410),f=r(10912),h=r(43302),m=()=>{d.addEventListener("resizeGlobalHeader",(e=>{"100vh"===e?document.body.classList.add("globalheader-expanded"):document.body.classList.remove("globalheader-expanded")}))};t.initForGlobalHeaderNextGeneration=m;const g={navigateToEditNewEntry:function(e){u.infoLoaded.then((t=>{t.can_open_editor?f.newEntry({openedFrom:e.openedFrom}):location.href=i.protocolRelativeAdminUrl("/my/edit")}))},navigateToEditNewEntryWithQuote:function(){u.infoLoaded.then((()=>{location.href=i.protocolRelativeAdminUrl("/my/edit?sidebar=quote#auto_fillin")}))},navigateToEditNewEntryWithReQuote:function(){u.infoLoaded.then((()=>{location.href=i.protocolRelativeAdminUrl("/my/edit")}))},init:function(){if(window!==window.parent)return null;if(!d.messenger)return null;m(),(0,o.setupAnalyticsClientIdBroadcaster)(),d.addEventListener("new-entry",(()=>{g.navigateToEditNewEntry({openedFrom:"globalheader-new-entry"})})),d.addEventListener("new-entry-with-quote",(()=>{g.navigateToEditNewEntryWithQuote()})),d.addEventListener("new-entry-with-requote",(()=>{g.navigateToEditNewEntryWithReQuote()})),d.addEventListener("mymenu",(e=>{h.toggle(e)})),d.addEventListener("servicesmenu",(e=>{c.toggle("/-/menu/services",e)})),d.addEventListener("unread",(()=>{location.href=i.protocolRelativeAdminUrl("/-/antenna")}));const e=l('\n          <div id="notify-window" class="hatena-globalheader-window" style="display: none;">\n            <iframe style="border:none" frameBorder="0"\n              class="notify" width="250" height="300"\n              ></iframe>\n          </div>\n        '.trim());let t;d.addEventListener("notify",(r=>{const n=r.BASE;if(t){if(t.is(":visible"))return void p.hide(t);t.remove()}t=e.clone(),t.css({left:r.left-250+32});t.find("iframe").attr("src",`https://www${n}/notify/notices.iframe?${(new Date).getTime()}`),t.appendTo(document.body).fadeIn("fast"),p.show(t,{fixScroll:!0})})),d.addEventListener("blogmenu",(e=>{const t={};(0,a.default)("blog")&&(t.blog=location.href,"entry"===(0,a.default)("page")&&l('article.entry:not([class~="no-entry"])').length>0&&(t.blog_permalink=1));const r=`/-/menu/blogmenu?${l.param(t)}`;c.toggle(r,e,"blogmenu",{callback:(e,t)=>{t.addEventListener("request-report-abuse-info",(()=>{t.send("response-report-abuse-info",window.location.href)})),t.addEventListener("edit-this-entry",(()=>{var e=l("article.entry").first();f.editEntryInPlace(e,{openedFrom:"blogmenu-edit-this-entry"})})),t.addEventListener("new-entry",(()=>{g.navigateToEditNewEntry({openedFrom:"blogmenu-new-entry"})})),t.addEventListener("subscribe",(e=>{l(document).trigger("subscribe",e)}))}})}))}};t.GlobalHeaderSubscriber=g},75225:(e,t,r)=>{"use strict";const n=r(65311),i=r(56769);e.exports={init:function(){return function(){if("fixed"===n("#globalheader-container").css("position")){var e=n("#globalheader-container").height(),t=n(document);t.on("click",'a[href^="#"]',(()=>{var r=t.scrollTop(),n=0,i=function(){t.scrollTop()!==r?window.scrollBy(0,-e):n++<10&&setTimeout(i,0)};setTimeout(i,0)}))}}(),new i}}},54102:(e,t,r)=>{"use strict";const n=r(67294);class i extends n.Component{render(){return n.createElement("span",{dangerouslySetInnerHTML:(()=>({__html:this.props.body}))()})}}e.exports=i},91269:(e,t,r)=>{"use strict";var n,i,a,o=r(70879);class s{static load(){const e=document.querySelector("html").getAttribute("data-initial-state");if(e)try{s.__STATE__=JSON.parse(e)}catch(e){(0,o.BUG)(e,"Cannot parse embedded data-initial-state")}}static get(e){return s.__STATE__[e]}static dumpAllForTest(){return s.__STATE__}}n=s,a={},(i=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(i="__STATE__"))in n?Object.defineProperty(n,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[i]=a,e.exports=s},22592:(e,t,r)=>{"use strict";var n=r(65311),i=function(){this.init.apply(this,arguments)};i.prototype={init:function(e,t){if(!n.isFunction(e))throw`generator must be a function (${e})`;if(this.generator=e,t){if(!(t instanceof i))throw"prev must be a instance of LazyList";this._prev=t}},promise:function(){if(!this._promise){var e=this.generator(this.prev());if(!n.isFunction(e.promise))throw`generator must return a Deferred Object (${e})`;this._promise=e.promise()}return this._promise},prev:function(){return this._prev},next:function(){return this._next||(this._next=new i(this.generator,this)),this._next},root:function(){return this._prev?this._prev.root():this}},e.exports=i},37914:(e,t,r)=>{"use strict";var n,i,a=s(r(1606)),o=s(r(57942));function s(e){return e&&e.__esModule?e:{default:e}}const l={setup:function(e){e||(e=window.location);const t=e.search.slice(1);i=(0,a.default)(t),n=e.host},param:function(e){return this.params()[e]?this.params()[e][0]:null},params:function(){return i||this.setup(),i},domainType:function(){n||this.setup();const e=(0,o.default)("router-type"),t=(0,o.default)("admin-domain");if(e){if("global"===e)return this.Global;if("admin"===e)return this.Admin;if("blogs"===e)return this.Blogs}return t?t===`//${n}`?this.Admin:this.Blogs:/\.hatena\.ne\.jp(:\d+)?$/.test(n)?this.Admin:this.Blogs},Admin:"Admin",Blogs:"Blogs",Global:"Global"};e.exports=l},70879:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.REPORT_BUG=t.LOG=t.BUG=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(33646)),a=r(49651),o=(n=r(57942))&&n.__esModule?n:{default:n};function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}const l=r(59662);let d;try{d=JSON.parse(window.localStorage?.getItem("Hatena.Diary.isVerbose")||"false")}catch{d=!1}const u=d||"production"!==a.env.NODE_ENV?console.log:()=>{};t.LOG=u;const c=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{reportToSentry:!0};l.isObsolete||("production"===a.env.NODE_ENV?(0,o.default)("sentry-dsn")&&r.reportToSentry&&(e instanceof Error?i.captureException(e):i.captureException(new Error(String(e)))):console.warn(e))};t.BUG=c;t.REPORT_BUG=e=>t=>c(t,e)},50477:(e,t,r)=>{"use strict";var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=i(t);if(r&&r.has(e))return r.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=a?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,r&&r.set(e,n);return n}(r(55992));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(i=function(e){return e?r:t})(e)}var a,o=r(65311),s=n.staticUrl("/js/external/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"),l={load:function(e){var t=e.find('img[src*="chart.apis.google.com/chart?cht=tx&chl="]');t.length&&(a||(window.MathJax={AuthorInit:function(){MathJax.Ajax.fileRev=function(e){var t=MathJax.cdnFileVersions[e]||MathJax.cdnVersion||"",r=n.versionParameter();return t?`?v=${t}${r?`&${r}`:""}`:r?`?${r}`:""}}},a=o.ajax({url:s,dataType:"script",cache:!0})),a.done((()=>{MathJax.Hub.Config({tex2jax:{inlineMath:[],displayMath:[]}}),t.each((function(){var e=o(this),t=e.attr("alt");if(t){var r=o('<script type="math/tex">');e.replaceWith(r),MathJax.HTML.setScript(r[0],t)}})),MathJax.Hub.Queue(["Typeset",MathJax.Hub,e[0]])})))}};e.exports=l},26410:(e,t,r)=>{"use strict";var n=o(r(65311)),i=o(r(66419)),a=o(r(99349));function o(e){return e&&e.__esModule?e:{default:e}}const s={shown:[],init:function(){(0,n.default)(document.body).click((e=>{i.default.any(this.shown,(t=>t.win[0]===e.target||n.default.contains(t.win[0],e.target)))||this.hideAll()})),this.init=function(){}},show:function(e,t){t||(t={}),this.init(),t.keepOthers||this.hideAll(),t.fixScroll&&a.default.enable(),t.center&&s._setCenter(e),t.showBackground&&s._showBackground(),this.shown.push({closeExplicitly:!!t.closeExplicitly,win:e,destroy:t.destroy||function(){},fixScroll:!!t.fixScroll,showBackground:!!t.showBackground}),t.then?e.fadeIn("fast",t.then):e.fadeIn("fast")},hide:function(e){for(let t=0,r=this.shown.length;t<r;t++){const r=this.shown[t];if(r.win===e){e.fadeOut("fast",r.destroy),(0,n.default)(".modal-window-background").fadeOut("fast"),r.fixScroll&&a.default.disable();break}}},hideAll:function(){const e=[];for(let t=0,r=this.shown.length;t<r;t++)this.shown[t].closeExplicitly?e.push(this.shown[t]):this.hide(this.shown[t].win);this.shown=e},toggle:function(e,t){return e.is(":visible")?(this.hide(e),!1):(this.show(e,t),!0)},_setCenter:function(e){const t=i.default.throttle((()=>{if(!(0,n.default)(e).is(":visible"))return void(0,n.default)(window).off("resize",t);const r=((0,n.default)(window).height()-(0,n.default)(e).height())/2,i=((0,n.default)(window).width()-(0,n.default)(e).width())/2;(0,n.default)(e).css({top:r,left:i})}),100);(0,n.default)(window).on("resize",t),t()},_showBackground:function(){(0,n.default)("<div>").addClass("modal-window-background").appendTo(document.body)}};e.exports=s},56412:(e,t,r)=>{"use strict";var n,i=(n=r(57942))&&n.__esModule?n:{default:n},a=r(70879);const o=r(65311),s=r(37914),l=r(36500);let d=null;const u={Controllers:null,infoLoaded:new Promise((e=>{d=e})),resolveInfo:e=>d(e),setControllers:function(e){u.Controllers=e},loadInfo:function(){const e=decodeURIComponent(location.hash.substring(1)),t=s.param("circle_id");let r;r=t?o.ajax({url:"/api/init/circle",type:"get",dataType:"json",data:{circle_id:t}}):o.ajax({url:"/api/init",type:"get",dataType:"json",data:{name:(0,i.default)("name"),blog:e}});const n=o.Deferred();return r.done((e=>{const t=e.private;delete e.private,l.send("init",e),n.resolve(e,t)})),n.promise()},device:function(){const e=(0,i.default)("device");if(!e){const e=`device is undefined, page: ${(0,i.default)("page")}, location: ${location.href}`;(0,a.BUG)(e)}return e||"pc"},loadPage:function(){const e=s.domainType()+("pc"===u.device()?"":"Touch"),t=(0,i.default)("page");try{u.loadDomainController(e),u.loadController(e,t)}catch(e){(0,a.BUG)(e,"toplevel")}},loadDomainController:function(e){if(!u.Controllers)throw new Error("Pages.Controllers not initialized");(0,a.LOG)(`Controllers["${e}"]`);const t=u.Controllers[e].__domain__;t&&t.init(),(0,a.LOG)(`Controllers["${e}"] done`)},loadController:function(e,t){if(!u.Controllers)throw new Error("Pages.Controllers not initialized");(0,a.LOG)(`Controllers["${e}"]["${t}"]`);const r=u.Controllers[e][t];r&&r.init(),(0,a.LOG)(`Controllers["${e}"]["${t}"] done`)}};e.exports=u},99349:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(65311))&&n.__esModule?n:{default:n};let a=0,o=!1;function s(){(0,i.default)(window).scrollTop()!==a&&(0,i.default)(window).scrollTop(a)}var l={enable(){o||(a=(0,i.default)(window).scrollTop(),(0,i.default)(window).on("scroll",s),o=!0)},disable(){o&&((0,i.default)(window).off("scroll",s),o=!1)}};t.default=l},83092:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(65311))&&n.__esModule?n:{default:n};var a=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.$el=e;const r=e.children("ol, ul");r.attr("role","tabs"),r.addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header");const n=r.children('li:has(a[href^="#"])');n.attr({role:"tab",tabIndex:-1}),n.addClass("ui-tabs-tab ui-state-default");const a=n.children("a[href]:first-child");a.attr("tabIndex",-1),a.addClass("ui-tabs-anchor"),a.each(((e,t)=>{(0,i.default)(t).data("index",e)})),a.on("click",(e=>{e.isDefaultPrevented()||(e.preventDefault(),this.show(+(0,i.default)(e.currentTarget).data("index")))})),this.tabs=[];let o=(0,i.default)();a.each((t=>{const r=a.eq(t),i=n.eq(t),s=r.attr("href"),l=s.substring(1),d=e.find((u=s)?u.replace(/[!"$%&'()*+,./:;<=>?@[\]^`{|}~]/g,"\\$&"):"");var u;if(!d.length)return;const c=i.attr("aria-controls");c&&i.data("ui-tabs-aria-controls",c),i.attr({"aria-controls":l,"aria-labelledby":l}),d.attr({"aria-labelledby":l,role:"tabpanel"}),d.addClass("ui-tabs-panel ui-widget-content"),o=o.add(d),this.tabs.push({$anchor:r,$panel:d,$tab:i})})),this.$tabs=n,this.$anchors=a,this.$panels=o,this.show(t)}show(e){this.$tabs.removeClass("ui-tabs-active ui-state-active"),this.$tabs.attr({tabIndex:-1,"aria-expanded":"false","aria-selected":"false"}),this.$anchors.attr("tabIndex",-1),this.$panels.attr("aria-hidden","true"),this.$panels.hide();const t=this.tabs[e];t.$tab.addClass("ui-tabs-active ui-state-active"),t.$tab.attr({tabIndex:0,"aria-expanded":"true","aria-selected":"true"}),t.$anchor.attr("tabIndex",0),t.$panel.attr("aria-hidden","false"),t.$panel.show(),this.$el.triggerHandler("tabsactivate",{newPanel:t.$panel})}};t.default=a},46658:(e,t,r)=>{"use strict";var n,i=(n=r(20996))&&n.__esModule?n:{default:n};var a=r(65311);const o=void 0!==window.onbeforeunload?"beforeunload":"unload";e.exports=class{constructor(){this.isWatching=!1,a(window).on(o,(()=>this.confirm()))}confirm(){if(this.isWatching)return i.default.text("form.confirm.changed")}enable(){this.isWatching=!0}disable(){this.isWatching=!1}}},55992:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.versionParameter=t.userBlogUrl=t.staticUrl=t.protocolRelativeAdminUserBlogUrl=t.protocolRelativeAdminUrl=t.partsUrl=t.httpsAdminUserBlogUrl=t.httpsAdminUrl=t.httpAdminUserBlogUrl=t.httpAdminUrl=t.helpUrl=t.globalUrl=t.adminUserBlogPath=t.adminHostname=void 0;var n,i=(n=r(57942))&&n.__esModule?n:{default:n};const a=()=>{const e=(0,i.default)("version");return e?`version=${e}`:""};t.versionParameter=a;t.userBlogUrl=e=>(0,i.default)("blogs-uri-base")+e;t.staticUrl=e=>{const t=(0,i.default)("static-domain");let r;return r=e.indexOf("?")>=0?"&":"?",t+e+r+a()};const o=()=>(0,i.default)("admin-domain");t.adminHostname=o;const s=e=>`http:${o()}${e}`;t.httpAdminUrl=s;const l=e=>`https:${o()}${e}`;t.httpsAdminUrl=l;const d=e=>`${(0,i.default)("admin-domain")}${e}`;t.protocolRelativeAdminUrl=d;t.partsUrl=e=>`${(0,i.default)("parts-domain")}${e}`;t.globalUrl=e=>`${(0,i.default)("global-domain")}${e}`;const u=()=>{const e=(0,i.default)("blog-owner"),t=(0,i.default)("blog-host");if(!e||!t)throw new Error("Failed to retrieve properties to build API endpoint URL");return`/${e}/${t}`};t.adminUserBlogPath=u;t.httpAdminUserBlogUrl=e=>`${s(u())}${e}`;t.httpsAdminUserBlogUrl=e=>`${l(u())}${e}`;t.protocolRelativeAdminUserBlogUrl=e=>`${d(u())}${e}`;t.helpUrl=e=>`${(0,i.default)("help-url")}${e}`},97050:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.replaceImageToPlain=t.extractFotolifeSyntax=void 0;var n,i=r(92477),a=(n=r(65311))&&n.__esModule?n:{default:n};t.extractFotolifeSyntax=function(e){const t=a.default.Deferred(),r=e.match(/f:id:([^:]+):(\d+)([jpg]):image/);if(!r)return t.reject(`Invalid format? ${e}`).promise();const[n,o,s,l]=r,d=`[${n.replace(/:image$/,":plain")}]`,u=[o.substring(0,1),o,s.substring(0,8),s].join("/"),c=`https://cdn-ak.f.st-hatena.com/images/fotolife/${u}_120.jpg`,p=`https://cdn-ak.f.st-hatena.com/images/fotolife/${u}.${(e=>{const t=e.toLowerCase();return"g"===t?"gif":"p"===t?"png":"jpg"})(l)}`;return(0,i.extractSyntax)(d).done((e=>{t.resolve({image:c,largeImage:p,syntax:d,html:e.html})})).fail((e=>{t.reject(e)})),t.promise()};t.replaceImageToPlain=e=>e.replace(/:image$/,":plain")},92477:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.extractSyntax=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(65311)),a=(n=r(57942))&&n.__esModule?n:{default:n};function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}t.extractSyntax=e=>{const t=i.Deferred();let r=e;return Array.isArray(r)&&(r=r.join("\n\n")),i.ajax({url:"/api/support.expand",type:"POST",data:{syntax:r,rkm:(0,a.default)("rkm"),rkc:(0,a.default)("rkc")},dataType:"json"}).done((e=>{t.resolve({html:e.html})})).fail((e=>{t.reject(e)})),t}},55834:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeFlagVariant=t.hasFlagVariant=t.getFlagVariants=t.addFlagVariant=void 0;var n,i=(n=r(10646))&&n.__esModule?n:{default:n};const a="epic_flag_variants";t.addFlagVariant=e=>{i.default.set(a,[...o(),e].join(","))};t.removeFlagVariant=e=>{i.default.set(a,o().filter((t=>t!==e)).join(","))};const o=()=>{const e=i.default.get(a);return e?e.replace(/\s+/,"").split(",").filter((e=>!!e)):[]};t.getFlagVariants=o;t.hasFlagVariant=e=>o().includes(e)},57942:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=e=>{const t=document.documentElement;return t?t.getAttribute(`data-${e}`):null};t.default=r},33671:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setViaToUrl=t.inheritVia=void 0;t.inheritVia=function(e){e&&document.querySelectorAll("a[data-inherit-via]").forEach((t=>{const n=t.getAttribute("href");n&&t.setAttribute("href",r(n,e))}))};const r=(e,t)=>{const r=new URL(e);return r.searchParams.set("via",t),r.toString()};t.setViaToUrl=r},43459:(e,t,r)=>{"use strict";var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=i(t);if(r&&r.has(e))return r.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=a?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,r&&r.set(e,n);return n}(r(55992));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(i=function(e){return e?r:t})(e)}const a=r(80570);e.exports=function(e){a(n.staticUrl(e))}},85814:(e,t,r)=>{"use strict";const n=r(65311);e.exports=function(){window!==window.parent&&n("form").each((function(){var e=n(this);if(!e.attr("data-pass-through-click-jacking-validation")){var t=e.find("input[type=submit][name!=delete][name!=draft]"),r=e.find("input[type=submit][name=delete], input[type=submit][name=draft]"),i=function(e){return n({elements:e.find(":input:not([data-ignore-click-jacking])")}).serialize()};e.addClass("unedited"),t.attr("disabled","disabled"),r.attr("disabled","disabled");var a=i(e),o=setInterval((()=>{r.removeAttr("disabled"),a!==i(e)&&(clearInterval(o),e.removeClass("unedited"),t.removeAttr("disabled"))}),1500)}}))}},8659:(e,t,r)=>{"use strict";var n=r(65311),i=r(36500),a=r(26410);e.exports=function(){n(".open-pro-modal").css("visibility","visible"),n(document.body).on("click",".open-pro-modal",(function(){return function(e){var t=n('<div class="hatena-iframe-container pro-modal-container">').appendTo(document.body),r=n('<iframe frameborder="0"></iframe>').appendTo(t),o=i.createForFrame(r[0],e);o.addEventListener("close",(()=>{a.hide(t)})),a.show(t,{destroy:function(){r.remove(),o.destroy()},fixScroll:!0,center:!0,showBackground:!0})}(n(this).attr("data-guide-pro-modal-ad-url")),!1}))}},50025:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setupAnalyticsClientIdBroadcaster=t.createGoogleAnalyticsTrackerWithReceivedClientId=void 0;var n,i=(n=r(57942))&&n.__esModule?n:{default:n};const a=r(36500),o="syncClientId",s="requestSyncClientId";let l=!1;t.createGoogleAnalyticsTrackerWithReceivedClientId=e=>{c(),a.addEventListener(o,(t=>{l||(l=!0,e((()=>window.specialGACommandQueueForClientIdSync),t))})),a.send(s)};t.setupAnalyticsClientIdBroadcaster=()=>{a.addEventListener(s,d)};const d=()=>{u(),ga((e=>{const t=(e||ga.getAll().find((e=>!!e.get("clientId"))))?.get("clientId"),r=`${location.protocol}${(0,i.default)("admin-domain")}`;a.send(o,t,r)}))},u=()=>{window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date},c=()=>{var e,t,r,n,i,a;e=window,t=document,r="script",n="specialGACommandQueueForClientIdSync",e.GoogleAnalyticsObject=n,e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)},e[n].l=1*new Date,i=t.createElement(r),a=t.getElementsByTagName(r)[0],i.async=1,i.src="https://www.google-analytics.com/analytics.js",a.parentNode.insertBefore(i,a)}},38600:(e,t,r)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=((n=r(65311))&&n.__esModule?n:{default:n}).default.Deferred();t.default=i},36414:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getVisitorAttribute=t.getUserConfig=t.getShowSleepingAds=t.getShowAds=t.getSentryEnvironment=t.getRouterType=t.getPageId=t.getDeviceType=t.getBlogUUID=t.UNKNOWN_PAGE_ID=t.UNKNOWN_BLOG_UUID=t.SentryEnvironment=t.RouterType=t.DeviceType=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(78754)),a=(n=r(57942))&&n.__esModule?n:{default:n};function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}const s={Admin:"admin",Blogs:"blogs",Global:"global",Unknown:"unknown"};t.RouterType=s;const l=i.nativeEnum(s);t.getRouterType=()=>{const e=l.safeParse((0,a.default)("router-type"));return e.success?e.data:s.Unknown};const d={Dev:"dev",Local:"local",Staging:"staging",Productrion:"production",Unknown:"unknown"};t.SentryEnvironment=d;const u=i.nativeEnum(d);t.getSentryEnvironment=()=>{const e=u.safeParse((0,a.default)("sentry-environment"));return e.success?e.data:d.Unknown};const c={PC:"pc",Touch:"touch",Unknown:"unknown"};t.DeviceType=c;const p=i.nativeEnum(c);t.getDeviceType=()=>{const e=p.safeParse((0,a.default)("device"));return e.success?e.data:c.Unknown};const f="unknown";t.UNKNOWN_PAGE_ID=f;t.getPageId=()=>{const e=i.string().safeParse((0,a.default)("page"));return e.success?e.data:f};const h="unknown";t.UNKNOWN_BLOG_UUID=h;t.getBlogUUID=()=>{const e=i.string().safeParse((0,a.default)("blog-uuid"));return e.success?e.data:h};t.getShowSleepingAds=()=>Boolean((0,a.default)("blog-show-sleeping-ads"));t.getShowAds=()=>Boolean((0,a.default)("blog-show-ads"));t.getUserConfig=()=>{const e=i.string().safeParse((0,a.default)("userconfig"));return e.success?e.data:null};t.getVisitorAttribute=()=>{const e=i.string().safeParse((0,a.default)("visitor-attribute"));return e.success?e.data:null}},13964:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateTweetLength=void 0;var n,i=(n=r(72778))&&n.__esModule?n:{default:n};t.validateTweetLength=e=>{const t=`${e||""}\nhttps://hatenablog.com/`;return i.default.parseTweet(t).valid}},23226:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AboutSubscribersElement=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),a=(n=r(20996))&&n.__esModule?n:{default:n};function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}t.AboutSubscribersElement=e=>{let{subscribers:t,subscribeCount:r,hasMoreSubscribers:n}=e;return i.createElement("div",null,i.createElement("span",{className:"about-subscription-count"},a.default.textN("unit_person",r,r)),t.map(((e,t)=>i.createElement(i.Fragment,null," ",i.createElement("a",{href:e.blog_url,className:"subscriber",rel:"nofollow",key:t},i.createElement("img",{src:e.profile_image_url,width:"16",height:"16",alt:e.name,title:e.name,className:"profile-icon"}))))),n&&i.createElement("span",null,a.default.text("hidden_subscribes")))}},43348:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AboutSubscribers=void 0;var n,i=r(55992),a=r(91289),o=r(23226),s=(n=r(67294))&&n.__esModule?n:{default:n};t.AboutSubscribers=()=>{const[{data:e,loading:t,error:r}]=(0,a.useXHR)((0,i.userBlogUrl)("/api/about_subscribers"));if(t)return s.default.createElement(s.default.Fragment,null);if(r)return null;if(!e)throw new TypeError("'data' doesn't exist");const n=e.subscribers,l=e.subscribe_count,d=e.has_more_subscribers;return s.default.createElement(o.AboutSubscribersElement,{subscribers:n,subscribeCount:l,hasMoreSubscribers:d})}},92688:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AdInEntry=void 0;var n=r(70879);t.AdInEntry=class{constructor(e,t){this.slotId=e,this.insertElementClassName=t}insertAd(){return this.insertAdOnHeading()||this.insertAdOnPre()||this.insertAdOnTable()||this.insertAdOnP()}insertAdOnHeading(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const t=document.querySelectorAll(".hatenablog-entry > h1,\n       .hatenablog-entry > h2,\n       .hatenablog-entry > h3,\n       .hatenablog-entry > h4,\n       .hatenablog-entry > h5,\n       .hatenablog-entry > h6");for(let r=e;r<t.length;r++){const e=t[r];if(this.isOutsideFirstView(e))return this.insertCustomPosition(e,"before")}return!1}insertAdOnP(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const t=document.querySelectorAll(".hatenablog-entry > p:not(.footnote)");for(let r=e;r<t.length;r++){const e=t[r];if(this.isOutsideFirstView(e)&&this.canInsertAdOnP(e))return this.insertCustomPosition(e,"before")}return!1}insertAdOnPre(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const t=document.querySelectorAll(".hatenablog-entry > pre");for(let r=e;r<t.length;r++){const e=t[r];if(this.isOutsideFirstView(e))return this.insertCustomPosition(e,"before")}return!1}insertAdOnTable(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const t=document.querySelectorAll(".hatenablog-entry > table");for(let r=e;r<t.length;r++){const e=t[r];if(this.isOutsideFirstView(e))return this.insertCustomPosition(e,"before")}return!1}canInsertAdOnP(e){const t=e.textContent??"";if(""===t)return this.testAdjacentPElement(e);const r=t.length,n=window.getComputedStyle(e),i=e.clientHeight-parseFloat(n.paddingTop)-parseFloat(n.paddingBottom);return r>=30&&i>=40&&this.testAdjacentPElement(e)}testAdjacentPElement(e){const t=e.nextElementSibling,r=e.previousElementSibling;return!(!t||!r)&&("P"===t.tagName&&"P"===r.tagName&&!r.querySelector("img"))}isOutsideFirstView(e){return e.getBoundingClientRect().top+window.pageYOffset>1.1*window.innerHeight}insertCustomPosition(e,t){(0,n.LOG)(`added ad ${t} ${e.nodeName} element`);const r=this.addAdElement();switch(t){case"before":return e.before(r),!0;case"after":return e.after(r),!0;case"append":return e.appendChild(r),!0;default:return!1}}addAdElement(){const e=document.createElement("div");return e.id=this.slotId,e.classList.add(this.insertElementClassName),e}displayAd(){(0,n.LOG)(`Display ad. slot id: ${this.slotId} `),void 0===window.valve&&(window.valve=[]),window.valve.push((e=>{e.displaySlot(this.slotId)}))}}},73354:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.insertAdInEntry=function(){if(!a.isTouch)return;if("entry"!==(0,n.getPageId)())return;if(!(0,n.getShowAds)())return;if((0,n.getShowSleepingAds)())return;const e=new i.AdInEntry(o,"variable-rectangle-ad");let t=e.insertAd();if(!t){const r=document.querySelector("div.social-buttons");null!==r&&(t=e.insertCustomPosition(r,"after"))}t&&e.displayAd()};var n=r(36414),i=r(92688);const a=r(59662),o="ad-in-entry"},65758:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.insertSleepingAdInEntry=function(){if("entry"!==(0,n.getPageId)())return;if(!(0,n.getShowSleepingAds)())return;const e=new i.AdInEntry(a,"sleeping-ad-in-entry");e.insertAd()&&e.displayAd()};var n=r(36414),i=r(92688);const a="sleeping-ad-in-entry"},58430:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"AdInEntry",{enumerable:!0,get:function(){return n.AdInEntry}}),Object.defineProperty(t,"insertAdInEntry",{enumerable:!0,get:function(){return i.insertAdInEntry}}),Object.defineProperty(t,"insertSleepingAdInEntry",{enumerable:!0,get:function(){return a.insertSleepingAdInEntry}});var n=r(92688),i=r(73354),a=r(65758)},56866:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setupBlogcardTrackingMessageReceiver=function(){window.addEventListener("message",(e=>{var t;e.origin===(0,n.partsUrl)("")&&((t=e.data)&&"blogcardTracking"===t.kind)&&(0,i.pushToDataLayer)(e.data.data)}))};var n=r(55992),i=r(99057)},10912:(e,t,r)=>{"use strict";var n=r(82667),i=r(78899),a=r(85183),o=r(9736);const s=r(65311),l={editEntryInPlace:function(e,t){e&&o.InPlaceEditor.showEditInPlace(e,{openedFrom:t.openedFrom,update:function(t){var r=s(t.entry.trim());r.length?(e.replaceWith(r),l.initEntry(r),(0,i.updateDynamicPieces)(r.parent())):e.remove()}})},newEntry:function(e){let{openedFrom:t}=e;o.InPlaceEditor.showEditInPlace(null,{openedFrom:t,update:function(e){const t=s(e.entry.replace(/^\s+/,"").replace(/\s+$/,""));t.length&&(t.insertBefore("#main article.entry:first"),l.initEntry(t),(0,i.updateDynamicPieces)(t.parent()),s("[data-remove-on-new-entry=1]").remove())}})},initEntry:function(e){(0,n.replaceYoutubeURL)(e),e.attr("data-uuid")&&new a.Entry(e)}};e.exports=l},568:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AddCommentBox=void 0;var n=u(r(65311)),i=u(r(10646)),a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=d(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(55992)),o=u(r(57942)),s=u(r(20996)),l=u(r(76804));function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(d=function(e){return e?r:t})(e)}function u(e){return e&&e.__esModule?e:{default:e}}const c=r(59662),p=r(26410),f=r(36500),h={render(e){let{entryId:t,$target:r,onUpdate:a}=e;const s=`${(0,o.default)("admin-origin")}/${(0,o.default)("author")}/${(0,o.default)("blog")}/comment?${n.default.param({entry:t,token:i.default.get("bk")})}`;c.isHatenaBlogNativeApp?h.renderIframe(s,r,a):h.renderWindow(s,a)},renderWindow(e,t){const r=(0,l.default)({width:400,height:240,left:Math.floor((screen.width-400)/2),top:Math.floor((screen.height-120)/2)}),n=window.open("","comment",r);if(!n)throw new Error("Failed to open commentWindow");const i=f.createForWindow(n,e);i.addEventListener("close",(()=>{i.destroy(),n.close()})),i.addEventListener("update",(e=>{t(e.comment)}))},renderIframe(e,t,r){const i=(0,n.default)(`\n      <div class="hatena-iframe-container" style="display: none;">\n        <div class="loading" style="display: none;">\n          <img src="${a.staticUrl("/images/loading.gif")}" class="loading-spinner" alt="loading"/>\n          ${s.default.text("loading")}\n        </div>\n        <iframe frameborder="0"></iframe>\n      </div>\n    `.trim()).appendTo(document.body),l=t.offset(),d=(0,n.default)(window).width();let u=440;u+20>d&&(u=d-20,l.left=10);const c=235,h=(0,o.default)("blog-comments-top-is-new");h&&(l.top-=c,l.top+=t.height()),i.css({width:u,height:c,position:"absolute"}).offset(l);const m=i.find("iframe"),g=i.find(".loading");setTimeout((()=>g.show()),250),m.load((()=>g.remove()));const v=m[0],b=f.createForFrame(v,e);b.addEventListener("update",(e=>{r(e.comment)})),b.addEventListener("close",(()=>{p.hide(i)})),b.addEventListener("resize",(e=>{e&&(h&&e.height!==c&&(e.top=Number(i.css("top"))+c-e.height),i.css(e))})),p.show(i,{closeExplicitly:!0,destroy:()=>{m.remove(),b.destroy()}})}};t.AddCommentBox=h},57035:(e,t,r)=>{"use strict";var n=u(r(65311)),i=u(r(20996)),a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=d(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(55992)),o=u(r(57942)),s=u(r(76804)),l=r(59662);function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(d=function(e){return e?r:t})(e)}function u(e){return e&&e.__esModule?e:{default:e}}const c=r(26410),p={render(e){let{commentId:t,$target:r,onDelete:i}=e;const a=`${(0,o.default)("admin-origin")}/${(0,o.default)("author")}/${(0,o.default)("blog")}/comment/delete?${n.default.param({comment:t.slice(8)})}`;l.isHatenaBlogNativeApp?p.renderIframe(a,r,i):p.renderWindow(a,i)},renderWindow(e,t){const r=(0,s.default)({width:300,height:150,left:Math.floor((screen.width-300)/2),top:Math.floor((screen.height-150)/2)}),i=window.open("","delete_comment",r);var a=Messenger.createForWindow(i,e),o=()=>{a.destroy(),i.close()};a.addEventListener("delete",(()=>{t()})),a.addEventListener("close",o),(0,n.default)(document.body).one("focus",o)},renderIframe(e,t,r){const o=(0,n.default)(`\n          <div class="hatena-iframe-container">\n            <div class="loading" style="display: none;">\n              <img src="${a.staticUrl("/images/loading.gif")}" class="loading-spinner" alt="loading"/>\n              ${i.default.text("loading")}\n            </div>\n            <iframe frameborder="0"></iframe>\n          </div>\n        `.trim()).appendTo(document.body);o.css({width:440,height:120,position:"absolute"}).offset(t.offset());const s=o.find("iframe"),l=o.find(".loading");setTimeout((()=>l.show()),250),s.load((()=>l.remove()));const d=Messenger.createForFrame(s[0],e);d.addEventListener("delete",(()=>{r()})),d.addEventListener("close",(()=>{c.hide(o)})),c.show(o,{destroy:()=>{s.remove(),d.destroy()}})}};e.exports=p},91367:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Entry=void 0;var n=l(r(65311)),i=r(78899),a=l(r(57942)),o=r(568),s=r(54948);function l(e){return e&&e.__esModule?e:{default:e}}const d=r(56412),u=r(57035);t.Entry=class{constructor(e){if(this.$entry=e,this.$container=e.find(".js-comment-box .js-comment"),this.$readMoreLine=this.$entry.find(".read-more-comments"),this.$readMoreButton=this.$readMoreLine.find("a"),this.$leaveCommentButton=this.$entry.find(".js-leave-comment-title"),this.entryId=this.$entry.attr("data-uuid"),this.comments=[],this.hasMore=!1,this.topIsNew=(0,a.default)("blog-comments-top-is-new"),!this.$container.length)return;this.loadComments(3),d.infoLoaded.then((e=>{this.$leaveCommentButton.toggle(!e.cookie_received||e.commentable)})),this.initEvents()}initEvents(){this.$readMoreButton.on("click",(()=>(this.expandComments(),!1))),this.$leaveCommentButton.on("click",(()=>(this.showAddCommentBox(),!1))),this.$container.on("click",".comment-delete-button",(e=>(this.showDeleteCommentBox((0,n.default)(e.currentTarget)),!1)))}expandComments(){this.loadComments(0).then((()=>{if("entry"===(0,a.default)("page"))return;const e=sessionStorage.getItem("entriesExpandedComments"),t=e?JSON.parse(e):{};t[this.entryId]=!0,sessionStorage.setItem("entriesExpandedComments",JSON.stringify(t))})).catch((()=>{}))}async loadComments(e){return(0,s.requestForComments)(this.entryId,e,(()=>{})).then((e=>{e&&e.comments&&(this.comments=e.comments,this.hasMore=e.has_more,this.renderComments())}))}shouldExpandComments(){if("entry"===(0,a.default)("page"))return!1;let e=!1;try{const t=sessionStorage.getItem("entriesExpandedComments");e=!!(t?JSON.parse(t):{})[this.entryId]}catch(e){}return e}renderComments(){if(0===this.comments.length)return;this.$container.find(".js-entry-comment").remove();const e=n.default.parseHTML(this.comments.join(""));this.$container.prepend(e),this.hasMore?this.$readMoreLine.show():(this.$readMoreLine.hide(),this.$entry.attr("data-comments-expanded","true")),(0,i.updateDynamicPieces)(this.$container)}addComment(e){this.topIsNew?this.comments.unshift(e):this.comments.push(e),this.renderComments()}removeComment(e){(0,n.default)(`#${e}`).fadeOut();const t=this.comments.findIndex((t=>n.default.parseHTML(t)[0].id===e));-1!==t&&(this.comments.splice(t,1),this.renderComments())}showAddCommentBox(){o.AddCommentBox.render({entryId:this.entryId,$target:this.$leaveCommentButton,onUpdate:e=>this.addComment(e)})}showDeleteCommentBox(e){const t=e.closest("li.entry-comment").attr("id");u.render({commentId:t,$target:e,onDelete:()=>this.removeComment(t)})}}},85183:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Entry",{enumerable:!0,get:function(){return n.Entry}});var n=r(91367)},40793:(e,t,r)=>{"use strict";var n=r(70879),i=r(65311),a=function(e,t){this.init(e,t)};a.prototype={init:function(e,t){t||(t={});var r=this;r.moveInProgress=!1,r.$containerElem=e,r.$goBackElem=i(i.parseHTML('<a class="module-entries-carousel-button back"><span>Back</span<</a>')),r.$goForwardElem=i(i.parseHTML('<a class="module-entries-carousel-button forward"><span>Forward</span></a>')),r.isAutoScroll=t.isAutoScroll||!1,r.autoScrollInterval=t.autoScrollInterval||5e3,r.displayEntrySizeAtOnce=t.displayEntrySizeAtOnce||2,r.isAutoScroll&&(r.autoScrollIntervalId=window.setInterval((e=>{e.goForwardWithLoop()}),r.autoScrollInterval,r)),r.$containerElem.on("click",".module-entries-carousel-button.back.active",(()=>{r.isAutoScroll&&window.clearInterval(r.autoScrollIntervalId),r.goBack()})),r.$containerElem.on("click",".module-entries-carousel-button.forward.active",(()=>{r.isAutoScroll&&window.clearInterval(r.autoScrollIntervalId),r.goForward()})),r.currentPosition=0;var n=r.getCarouselBodyElem();r.carouselList=n.find(".urllist-item"),r.carouselElementsSize=r.carouselList.length,r.carouselSize=r.carouselElementsSize-(r.displayEntrySizeAtOnce-1),r.$directNavigationListElem=i(i.parseHTML('<ol class="module-entries-carousel-navigation">'));for(var a=0;a<r.carouselSize;)r.$directNavigationListElem.append(i(i.parseHTML(`<li><a data-carousel-index="${a}"><span>${a}</span></a></li>`))),a++;r.$containerElem.on("click",".module-entries-carousel-navigation a.active",(function(e){r.isAutoScroll&&window.clearInterval(r.autoScrollIntervalId),r.goToIndex(Number(i(this).attr("data-carousel-index")))})),r.updateNavigationElementsClass(),r.$containerElem.append(r.$goBackElem),r.$containerElem.append(r.$goForwardElem),r.$containerElem.append(r.$directNavigationListElem)},canGoBack:function(){return this.currentPosition>0},canGoForward:function(){var e=this;return e.currentPosition<e.carouselSize-(e.displayEntrySizeAtOnce-1)},updateNavigationElementsClass:function(){var e=this;e.$goBackElem.toggleClass("active",e.canGoBack()),e.$goForwardElem.toggleClass("active",e.canGoForward()),e.$directNavigationListElem.find("a").removeClass("current"),e.$directNavigationListElem.find(`a[data-carousel-index="${e.currentPosition}"]`).addClass("current"),e.$directNavigationListElem.find("a").addClass("active"),e.$directNavigationListElem.find("a.current").removeClass("active")},getUnitWidth:function(){var e=this.getCarouselBodyElem().find(".urllist-item");return 0===e.length?((0,n.BUG)("Can't get unit width"),200):1===e.length?e.width():i(e[1]).offset().left-i(e[0]).offset().left},getCarouselBodyElem:function(){return i(this.$containerElem).find(".urllist-with-thumbnails")},goToIndex:function(e){var t=this;if(!(e<0||e>=t.carouselSize||t.moveInProgress)){t.moveInProgress=!0;var r=t.getCarouselBodyElem(),n=(r.offset(),`-=${t.getUnitWidth()*(e-t.currentPosition)}px`);r.animate({left:n},300,(()=>{t.currentPosition=e,t.updateNavigationElementsClass(),t.moveInProgress=!1}))}},goBack:function(){this.goToIndex(this.currentPosition-1)},goForward:function(){this.goToIndex(this.currentPosition+1)},goForwardWithLoop:function(){this.canGoForward()?this.goForward():this.goToIndex(0)}},e.exports=a},9736:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InPlaceEditor=void 0;var n=a(r(65311)),i=a(r(57942));function a(e){return e&&e.__esModule?e:{default:e}}t.InPlaceEditor=class{static showEditInPlace(e,t){this.$entry=e,this.opts=t;const r=this.getEditorUrl();window.location.assign(r)}static getEditorUrl(){const e={openedFrom:this.opts.openedFrom};this.$entry&&(e.entry=this.$entry.attr("data-uuid")),this.opts.title&&(e.title=this.opts.title),this.opts.body&&(e.body=this.opts.body);return`${(0,i.default)("admin-domain")}/${(0,i.default)("author")}/${(0,i.default)("blog")}/edit?${n.default.param(e)}`}}},50686:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;var n=r(78754),i=r(70879),a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=d(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(55992)),o=l(r(57942)),s=l(r(347));function l(e){return e&&e.__esModule?e:{default:e}}function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(d=function(e){return e?r:t})(e)}const u=n.z.array(n.z.object({year:n.z.number(),count:n.z.number(),months:n.z.array(n.z.object({year:n.z.number(),month:n.z.number(),count:n.z.number()}))})),c=()=>{if("archive"===(0,o.default)("page")){const e=document.querySelector("section.archive-entry");if(!e)return;const t=e.querySelector("div.date > a > time")?.getAttribute("datetime"),r=t?.match(/^(\d{4})-(\d{2})-\d{2}/);if(!r)return;return{year:r[1],month:r[2]}}const e=document.querySelector("article.entry");if(!e)return;const t=e.querySelector("header time > span.date-year")?.textContent,r=e.querySelector("header time > span.date-month")?.textContent;return t&&r?{year:t,month:r}:void 0},p=e=>{let t=null;const r=c();r&&r.year&&(t=e.querySelector(`li.archive-module-year[data-year="${r.year}"]`)),t=t??e.querySelector("li.archive-module-year"),t?.classList.remove("archive-module-year-hidden"),e.addEventListener("click",(e=>{if(!e.target)return;const t=e.target.closest(".archive-module-button");if(!t)return;const r=t?.closest(".archive-module-year");r&&r.classList.toggle("archive-module-year-hidden")}))},f=(e,t)=>{const r=e.selectedOptions;if(1===r.length){const e=r[0].dataset.year,n=r[0].dataset.month;e&&n&&s.default.get(a.userBlogUrl("/archive_module_calendar"),{params:{month:n,year:e}}).then((e=>{if(200===e.status){const r=t.querySelector(".js-archive-module-calendar-container");r&&(r.innerHTML=e.data)}})).catch((e=>(0,i.BUG)(e)))}},h=(e,t)=>{for(const r of t){const t=e.querySelector(`.archive-module-year-${r.year}`);t&&t.appendChild(document.createTextNode(` (${r.count})`));for(const t of r.months){const n=e.querySelector(`.archive-module-month-${r.year}-${t.month}`);n&&n.appendChild(document.createTextNode(` (${t.count})`))}}};t.init=()=>{const e=document.querySelectorAll(".hatena-module-archive");e&&e.forEach((e=>{const t=e.getAttribute("data-archive-type");if(t)return"default"===t&&e.querySelector(".archive-module-year")?(e=>{p(e),s.default.get(a.userBlogUrl("/api/number_of_entries_per_month")).then((t=>{const r=u.safeParse(t.data);if(!r.success)return(0,i.BUG)(r.error);h(e,r.data)})).catch((e=>(0,i.BUG)(e)))})(e):void(e.querySelector(".no-entry-text")||s.default.get(a.userBlogUrl("/archive_module"),{params:{archive_type:t}}).then((r=>{if(200===r.status){const n=e.querySelector(".hatena-module-body");if(!n)return;n.innerHTML=r.data,"calendar"===t?(e=>{const t=e.querySelector(".js-archive-module-calendar-selector");if(!t)return;const r=c();r?t.value=`${r.year} ${r.month}`:t.selectedIndex=0,f(t,e),t.addEventListener("change",(()=>{f(t,e)}))})(e):p(e)}})).catch((e=>(0,i.BUG)(e))))}))}},49445:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;var n,i=r(70879),a=r(55992),o=(n=r(65311))&&n.__esModule?n:{default:n},s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=l(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(78754));function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(l=function(e){return e?r:t})(e)}const d=s.object({circles:s.record(s.object({html:s.string().optional().nullable()}).nonstrict())}).nonstrict();t.init=function(){const e=(0,o.default)(".hatena-module-circles");if(0===e.length)return;const t=[],r={};let n=0;e.find("[data-circle-id][data-circle-mtime]").each(((e,i)=>{const a=(0,o.default)(i),s=a.attr("data-circle-id");t.push(s),r[s]=a;const l=Number(a.attr("data-circle-mtime"));l>n&&(n=l)})),0!==t.length&&o.default.ajax({type:"GET",url:(0,a.userBlogUrl)("/api/module/circles"),data:{mtime:n,circle_id:t},traditional:!0,dataType:"json"}).done((e=>{const t=d.safeParse(e);if(!t.success)return void(0,i.BUG)(t.error);const{data:{circles:n}}=t;Object.entries(n).forEach((e=>{let[t,n]=e;r[t].replaceWith(o.default.parseHTML(n.html||" "))}))}))}},9885:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;var n=s(r(65311)),i=s(r(66419)),a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(55992));function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}function s(e){return e&&e.__esModule?e:{default:e}}t.init=()=>{const e=(0,n.default)(".hatena-module-entries-access-ranking");0!==e.length&&e.each(((e,t)=>{const r=(0,n.default)(t),o={};i.default.each(r[0].attributes,(e=>{e.name.match(/^data-/)&&(o[e.name.replace(/^data-/,"")]=e.value)})),n.default.ajax({type:"GET",url:a.userBlogUrl("/entries_access_ranking_module"),data:o,dataType:"html"}).done((e=>{r.find(".hatena-module-body").append(e)}))}))}},60151:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;var n,i=(n=r(65311))&&n.__esModule?n:{default:n};t.init=()=>{const e=(0,i.default)(".profile-running-duration"),t=Math.floor(Date.now()/1e3);e.each(((e,r)=>{const n=(0,i.default)(r),a=parseInt(n.attr("data-show-until"))||t;t<a&&n.removeClass("is-hidden")}))}},3850:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;var n=l(r(65311)),i=l(r(66419)),a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(55992)),o=r(78899);function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}function l(e){return e&&e.__esModule?e:{default:e}}t.init=()=>{const e=(0,n.default)(".hatena-module-recent-comments");if(0===e.length)return;const t=i.default.template((0,n.default)(".recent-comments-template").html());let r=0;e.each(((e,t)=>{const i=(0,n.default)(t).find(".hatena-module-body"),a=Number(i.attr("data-count"));r=Math.max(r,a)})),0!==r&&n.default.ajax({url:a.userBlogUrl("/api/recent_comments"),dataType:"json",data:{count:r}}).done((r=>{e.each(((e,i)=>{const a=(0,n.default)(i),s=a.find(".hatena-module-body"),l=parseInt(s.attr("data-count"));let d="";for(let e=0;e<l&&r[e];e++)d+=t({comment:r[e]});a.find(".recent-comments").html(d),(0,o.updateDynamicPieces)(a)}))}))}},75781:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;var n=d(r(50686)),i=d(r(49445)),a=d(r(9885)),o=d(r(60151)),s=d(r(3850));function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(l=function(e){return e?r:t})(e)}function d(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=l(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}return n.default=e,r&&r.set(e,n),n}t.init=()=>{[n,i,a,s,o].forEach((e=>{e.init()}))}},43302:(e,t,r)=>{"use strict";const n=r(65311),i=r(66419),a=r(96371),o=r(41730),s={dropdown:null,$activeContainer:null,blogToDropdownContainer:{},toggle:function(e){const t=`/-/menu/mymenu?location=${encodeURIComponent(location.href)}`;a.toggle(t,e,"mymenu",{callback:(e,t)=>{s.dropdown=e,t.addEventListener("feedback",(e=>{o.toggle(e.uri)})),t.addEventListener("myblogmenu.init",(e=>{this.initMyBlogMenu(e)})),t.addEventListener("myblogmenu.open",(e=>{var t=this.blogToDropdownContainer[e.blogUri];t.show(),this.$activeContainer=t})),t.addEventListener("myblogmenu.close",(e=>{this.blogToDropdownContainer[e.blogUri].hide(),this.$activeContainer=null}))}}),this.$activeContainer&&this.$activeContainer.is(":hidden")&&this.$activeContainer.fadeIn("fast")},initMyBlogMenu:function(e){var t={top:n(this.dropdown).offset().top+e.top,right:n(this.dropdown).offset().left-2,height:266};const r=`/-/menu/myblogmenu?blog=${encodeURIComponent(e.blogUri)}`;a.toggle(r,t,null,{callback:t=>{this.blogToDropdownContainer[e.blogUri]=n(t).parent(),i.delay((()=>n(t).parent().hide()))},key:e.blogUri,parent:"mymenu",className:"hatena-diary-dropdown-myblogs"})}};e.exports=s},30618:(e,t,r)=>{"use strict";var n=r(65311),i=r(36500),a=function(){this.init()};a.prototype={init:function(){this.quote={body:"",url:"",title:""};const e=n("#js-requote-button-template");e[0]&&(this.$reQuoteButton=n(e.html().trim()),this.bindEvents())},getSelectedText:function(){return window.getSelection?`${window.getSelection()||""}`:document.getSelection?document.getSelection():document.selection?document.selection.createRange().text:""},selectedTextExists:function(){return this.getSelectedText().length>0},bindEvents:function(){var e=this;n(document).on("mouseenter","blockquote",(t=>{if(!1===e.selectedTextExists()){var r=n(t.target).closest("blockquote");if(r.find("blockquote").length>0)return;e.focusOnBlockquote(r),e.showButton()}})),n(document).on("mouseleave","blockquote",(t=>{!1===n(t.toElement).hasClass("js-select_quote_panel")&&e.hideButton()})),n(document).on("mouseup","blockquote",(()=>{e.selectedTextExists()?e.hideButton():e.showButton()})),e.$reQuoteButton.on("click",(()=>(i.send("requote-edit-entry",{quote:e.quote}),!1)))},focusOnBlockquote:function(e){this.$blockquote=e,this.setButtonData(e),this.$blockquote.append(this.$reQuoteButton)},setButtonData:function(e){this.setQuoteBody(e),this.setQuoteMeta(e),""===this.quote.body&&(this.quote.body=this.quote.title,this.quote.title=this.quote.url)},setQuoteBody:function(e){var t=e.children(":not(cite, .js-requote-button)");t.length<=0?this.quote.body=e.contents().get(0).nodeValue||"":this.quote.body=t.text()},setQuoteMeta:function(e){var t=e.find("cite"),r=t.find("a"),n=e.attr("cite")||r.attr("href");void 0===n&&(n=e.closest("article").find(".entry-title .entry-title-link").attr("href"));var i=r.text()||t.text()||n;this.quote.url=n,this.quote.title=i},showButton:function(){this.$reQuoteButton.addClass("is-visible")},hideButton:function(){this.$reQuoteButton.removeClass("is-visible")}},e.exports=a},23249:(e,t,r)=>{"use strict";var n=a(r(65311)),i=a(r(57942));function a(e){return e&&e.__esModule?e:{default:e}}const o=r(36500),s=r(92901);e.exports={init:function(e,t){const r=(0,i.default)("blog-uri"),a=(0,i.default)("blog-host"),l={isSubscribing:e,isGuest:!((0,i.default)("rkm")&&(0,i.default)("rkc"))},d={subscribersCount:t,blogUrl:r,blogName:(0,i.default)("blog-name"),requestUrl:[(0,i.default)("admin-domain"),(0,i.default)("author"),a,"subscribe"].join("/")},u=o.createForCurrentWindow();(0,n.default)(".hatena-follow-button-box").map((function(){return new s.Blogs((0,n.default)(this),l,d,u,"hatena-follow-button-box")})).toArray();o.addEventListener("subscription",(e=>{u.send("subscription",e)})),u.addEventListener("subscription",(e=>{o.send("subscription",e)}));const c=(0,n.default)("#hidden-subscribe-button > .hatena-follow-button-box");this.subscribeButtonForMessage=new s.Blogs(c,l,d,u,"globalheader");const p=this;o.addEventListener("subscribe",(e=>{const t={left:e.left+5};p.subscribeButtonForMessage.openSubscribeWindow(t,!0)})),u.addEventListener("subscription",(e=>{!0===e[r]&&o.send("subscribed-current-blog")})),(0,n.default)(document).on("subscribe",((e,t)=>{const r={left:t.left+5};p.subscribeButtonForMessage.openSubscribeWindow(r,!0)}))}}},90757:(e,t,r)=>{"use strict";const n=r(65311),i={init:function(e){n(e||document.body).on("click","a[data-hatenablog-tumblr-share-button]",(e=>{const t=n(e.currentTarget),r=`${window.getSelection?window.getSelection():document.getSelection?document.getSelection():document.selection?document.selection.createRange().text:0}`,i=`http://www.tumblr.com/share?${n.param({v:3,u:t.attr("data-share-url")||location.href,t:t.attr("data-share-title")||document.title,s:r})}`,a=()=>{window.open(i,"t","toolbar=0,resizable=0,status=1,width=450,height=430")||(location.href=i)};return/Firefox/.test(navigator.userAgent)?setTimeout(a,0):a(),!1}))}};e.exports=i},57525:(e,t)=>{"use strict";function r(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(t,"__esModule",{value:!0}),t.YouTubeEmbed=void 0;const n=/^https:\/\/www.youtube.com\/embed\//;class i{static async init(){return this.cachedInitPromise||(this.cachedInitPromise=new Promise((e=>{window.onYouTubeIframeAPIReady=()=>{this.updatePlayers(),e()};const t=document.createElement("script");t.src="https://www.youtube.com/iframe_api";const r=document.querySelector("script");r&&r.parentNode&&r.parentNode.insertBefore(t,r)}))),this.cachedInitPromise}static async updatePlayers(){this.init().then((()=>{this.collectYouTubeEmbeddedIframes().forEach((e=>{this.registeredIframes.has(e)||this.createPlayer(e)}))}))}static collectYouTubeEmbeddedIframes(){const e=document.querySelectorAll("iframe"),t=document.querySelector("#body_ifr")?.contentWindow?.document.querySelectorAll("iframe")||[];return Array.from(e).concat(Array.from(t)).filter((e=>n.test(e.src||"")))}static createPlayer(e){this.registeredIframes.add(e);const t=new YT.Player(e,{events:{onStateChange:e=>{e.data===YT.PlayerState.PLAYING&&this.pauseAllExcept(e.target)}}});this.players.push(t)}static pauseAllExcept(e){for(const t of this.players)t!==e&&t.getPlayerState()===YT.PlayerState.PLAYING&&t.pauseVideo()}}t.YouTubeEmbed=i,r(i,"cachedInitPromise",null),r(i,"players",[]),r(i,"registeredIframes",new WeakSet)},54948:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.requestForComments=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;if(u[e])try{return new Promise(((t,r)=>{u[e].resolves.push(t),u[e].rejects.push(r)}))}catch(e){return void(0,i.BUG)(e,"loadEntryInfo")}d||(d=window.setTimeout((()=>{!async function(e,t,r,n){const i={e:Object.keys(e),limit:r};try{const t=(await o.default.get(l,{params:i})).data;Object.keys(t).forEach((r=>{e[r].resolves.forEach((e=>e(t[r])))})),n&&n()}catch(r){const n=r instanceof Error?r:new Error(String(r));e[t].rejects.forEach((e=>e(n)))}}(u,e,t,r),d=null,u={}}),0));try{return new Promise(((r,n)=>{u[e]={entryId:e,limit:t,rejects:[n],resolves:[r]}}))}catch(e){return void(0,i.BUG)(e,"loadEntryInfo")}};var n,i=r(70879),a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(55992)),o=(n=r(347))&&n.__esModule?n:{default:n};function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}const l=a.userBlogUrl("/api/entry/info");let d=null,u={}},44504:(e,t,r)=>{"use strict";var n,i=(n=r(57942))&&n.__esModule?n:{default:n};const a=r(2933);e.exports=class{constructor(e){this.$element=e,this.uuid=e.attr("id"),this.initDeleteButton()}initDeleteButton(){this.deleteBox=new a(this.$element,this.getDeleteUrl()),this.deleteBox.on("delete",(()=>this.delete())),this.$element.on("click",".js-comment-delete-button",(()=>(this.deleteBox.show(),!1)))}getDeleteUrl(){return`${(0,i.default)("admin-origin")}/${(0,i.default)("author")}/${(0,i.default)("blog")}/comment/delete?comment=${encodeURIComponent(this.uuid.slice(8))}`}delete(){this.$element.fadeOut()}getElement(){return this.$element}}},94508:(e,t,r)=>{"use strict";var n=r(82667),i=c(r(2933)),a=r(59662),o=c(r(57942)),s=r(54948),l=c(r(36500)),d=r(96486),u=r(78899);function c(e){return e&&e.__esModule?e:{default:e}}const p=r(65311),f=r(10646),h=r(56412),m=r(44504);e.exports=class{constructor(e){(0,n.replaceYoutubeURL)(e),this.$element=e,this.$commentBox=e.find(".js-comment-box"),this.$commentList=e.find(".js-comment-box .js-comment"),this.$showCommentInputButton=e.find(".js-leave-comment-title"),this.$readMoreBox=e.find(".js-read-more-comments"),this.$readMoreButton=e.find(".js-read-more-comments-button"),this.uuid=this.$element.attr("data-uuid"),this.comments=[],this.hasMoreComments=!1,this.summaryCommentCount=3,this.initArticleBar(),this.$commentBox.length&&(this.initComments(),this.initCommentInputBox()),this.initEditButton()}initArticleBar(){const e=document.querySelector(".js-entry-header"),t=document.querySelector(".js-article-bar");if(!e||!t)return;const r=e.getBoundingClientRect().top+window.pageYOffset;window.addEventListener("scroll",(0,d.throttle)((()=>{r<window.pageYOffset?t.classList.add("is-visible"):t.classList.remove("is-visible")}),100))}initComments(){return this.uuid?(0,s.requestForComments)(this.uuid,this.summaryCommentCount).then((e=>{e&&e.comments&&(this.comments=e.comments.map((e=>new m(p(e)))),this.hasMoreComments=e.has_more,this.renderComments(this.comments),this.initCommentsExpansion())})):null}initCommentsExpansion(){this.hasMoreComments&&(this.$readMoreBox.show(),this.$readMoreButton.on("click",(()=>((0,s.requestForComments)(this.uuid).then((e=>{e.comments&&(this.comments=e.comments.map((e=>new m(p(e)))),this.$readMoreBox.hide(),this.$commentList.empty(),this.renderComments(this.comments))})),!1))))}initCommentInputBox(){this.$showCommentInputButton.on("click",(e=>{e.preventDefault(),this.renderCommentInputBox()}))}renderCommentInputBox(){a.isHatenaBlogNativeApp?this._renderCommentInputIframe():this._renderCommentInputWindow()}_renderCommentInputWindow(){const e=this.getCommentInputUrl(),t=window.open("","comment"),r=l.default.createForWindow(t,e);r.addEventListener("close",(()=>{r.destroy(),t.close()})),r.addEventListener("update",(e=>{this.addComment(new m(p(e.comment))),this.renderComments(this.comments)}))}_renderCommentInputIframe(){const e=this.getCommentInputUrl();this.inputBox=new i.default(this.$commentBox,e),this.inputBox.on("update",(e=>{this.addComment(new m(p(e.comment))),this.renderComments(this.comments)})),this.inputBox.show()}initEditButton(){const e=this.$element.find(".js-entry-edit-button-container"),t=e.find(".js-entry-edit-button");h.infoLoaded.then((r=>{r.editable&&(e.show(),t.attr("href",this.getEditorUrl()))}))}getCommentInputUrl(){return`${(0,o.default)("admin-origin")}/touch/${(0,o.default)("author")}/${(0,o.default)("blog")}/comment?${p.param({entry:this.uuid,token:f.get("bk")})}`}getEditorUrl(){return`${(0,o.default)("admin-domain")}/${(0,o.default)("author")}/${(0,o.default)("blog")}/edit?entry=${this.uuid}`}addComment(e){(0,o.default)("blog-comments-top-is-new")?this.comments.unshift(e):this.comments.push(e)}renderComments(e){e.forEach((e=>{this.$commentList.append(e.getElement())})),(0,u.updateDynamicPieces)(this.$commentList)}}},2933:(e,t,r)=>{"use strict";var n=s(r(65311)),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(55992)),a=s(r(20996));function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}function s(e){return e&&e.__esModule?e:{default:e}}const l=r(66419),d=r(36500);class u{constructor(e,t){this.url=t,this.$container=(0,n.default)(u.TEMPLATE({image:i.staticUrl("/images/loading.gif"),text:a.default.text("loading")})).css({position:"relative"}).appendTo(e),this.$loading=this.$container.find(".js-loading"),this.eventListeners={}}show(){this.$iframe=(0,n.default)('<iframe frameborder="0"></iframe>'),this.$container.append(this.$iframe),this.messenger=d.createForFrame(this.$iframe[0],this.url),this.messenger.addEventListener("close",(()=>{this.$container.fadeOut(),this.$iframe.remove(),this.messenger.destroy()})),this.messenger.addEventListener("resize",(e=>{e&&this.$container.css(e)})),Object.keys(this.eventListeners).forEach((e=>{this.eventListeners[e].forEach((t=>{this.messenger.addEventListener(e,t)}))})),this.$container.fadeIn()}on(e,t){this.eventListeners[e]=this.eventListeners[e]||[],this.eventListeners[e].push(t)}}u.TEMPLATE=l.template('<div class="hatena-iframe-container" style="display: none;">  <div class="loading js-loading" style="display: none;">    <img src="<%- image %>" alt="loading" class="loading-spinner" />    <%- text %>  </div></div>'),e.exports=u},99109:(e,t,r)=>{"use strict";e.exports=r(94508)},92687:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderRecommendation=void 0;var n,i=r(552),a=r(68853),o=r(45724),s=r(73380),l=(n=r(67294))&&n.__esModule?n:{default:n};t.renderRecommendation=async e=>{let{rootId:t,attrName:r,targetListElementSelector:n}=e;const d=document.getElementById(t);if(!d)return;const u=d.dataset[r];if(!u)return;const c=(0,o.parseRecommendationData)(u);if(!c)return;const p=document.querySelector(n);if(!p)return;const f=document.createElement("li");p.children.length<3?p.appendChild(f):p.insertBefore(f,p.children[2]);const h=await(0,a.createNicknameDataloader)(),m=async e=>{try{return(await h.load(e)).nickname||e}catch(t){return e}},g=await Promise.all(c.map((async e=>({...e,authorName:await m(e.authorId),published:new Date(1e3*e.publishedTime)}))));(0,s.safeRender)(l.default.createElement(i.RecommendationApp,{results:g}),f)}},45724:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseRecommendationData=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=i(t);if(r&&r.has(e))return r.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=a?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,r&&r.set(e,n);return n}(r(78754));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(i=function(e){return e?r:t})(e)}const a=n.array(n.object({title:n.string(),iconUrl:n.string().url(),authorId:n.string(),url:n.string().url(),blogUrl:n.string().url(),blogTitle:n.string(),blogId:n.string(),category:n.string(),tags:n.array(n.string()),publishedTime:n.number(),entryContent:n.string(),type:n.string()}));t.parseRecommendationData=e=>{try{return a.parse(JSON.parse(e))}catch(e){return}}},56764:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;var n=a(r(65311)),i=a(r(1780));function a(e){return e&&e.__esModule?e:{default:e}}t.init=()=>{const e=(0,n.default)("form#create-circle-form");e.on("submit",(()=>{(0,i.default)(e)}))}},8078:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;var n=a(r(65311)),i=a(r(56882));function a(e){return e&&e.__esModule?e:{default:e}}const o=r(36500);t.init=()=>{o.listenToParent(),o.send("resize",{height:(0,n.default)(document.body).height()+50}),o.send("done"),(0,n.default)(".close").on("click",(()=>(o.send("close",{name:window.name}),!1)));const e=(0,n.default)(".js-options"),t=e.find(".membership-category-select"),r=t.find("option:selected").val(),a=e.find(".indicator");t.change((()=>{i.default.updateMembershipCategory(t).done((()=>{a.find(".success").show(),a.find(".fail").hide()})).fail((()=>{t.val(r),a.find(".success").hide(),a.find(".fail").show()}))}))}},13796:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;var n,i=(n=r(65311))&&n.__esModule?n:{default:n};const a=r(36500),o=r(67279);t.init=()=>{a.listenToParent(),(0,i.default)(".close").on("click",(()=>(a.send("close",{name:window.name}),!1))),o()}},33576:(e,t,r)=>{"use strict";var n,i=(n=r(65311))&&n.__esModule?n:{default:n};var a=r(55540),o=r(13605),s={init:function(){new a({container:(0,i.default)("#editor-amazon-search"),sidebar:new o})}};e.exports=s},68850:(e,t,r)=>{"use strict";var n,i=(n=r(65311))&&n.__esModule?n:{default:n};const a=r(52570),o=r(13605),s={init:function(){(0,i.default)("#editor-flickr.enabled").get(0)&&a.init({container:document.querySelector("#editor-flickr"),sidebar:new o})}};e.exports=s},88956:(e,t,r)=>{"use strict";var n,i=(n=r(65311))&&n.__esModule?n:{default:n};var a=r(90036),o=r(13605),s={init:function(){if((0,i.default)("#editor-gourmet.enabled").get(0)){new a({container:(0,i.default)("#editor-gourmet"),sidebar:new o}).requestLoadItems()}}};e.exports=s},10555:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;var n=r(10714),i=r(40304),a=l(r(67294)),o=l(r(73935)),s=r(78754);function l(e){return e&&e.__esModule?e:{default:e}}const d=r(91269),u=s.z.array(s.z.object({groupId:s.z.string(),groupTitle:s.z.string(),imageUrl:s.z.string().url()}));t.init=()=>{const e=document.getElementById("gruop");if(!e)return;const t=d.get("editor.group.group"),r=u.safeParse(t);if(!r.success)return;const s=r.data;o.default.render(a.default.createElement(i.GroupBannerSelector,{banners:s.map((e=>({...e,imageUrl:new URL(e.imageUrl)}))),onSubmitGroup:e=>{const t=`[blog:g:${e}:banner]`;n.EditorConnector.insertLines({html:[t],hatena:[t],markdown:[t]})}}),e)}},37013:(e,t,r)=>{"use strict";var n,i=(n=r(65311))&&n.__esModule?n:{default:n},a=r(30871);var o=r(13605),s={init:function(){if((0,i.default)("#editor-instagram.enabled").get(0)){new a.Instagram({container:(0,i.default)("#editor-instagram"),sidebar:new o}).requestLoadItems()}}};e.exports=s},62492:(e,t,r)=>{"use strict";var n,i=(n=r(65311))&&n.__esModule?n:{default:n};var a=r(35227),o=r(13605),s={init:function(){new a({container:(0,i.default)("#editor-itunes"),sidebar:new o}).requestLoadItems()}};e.exports=s},41516:(e,t,r)=>{"use strict";var n=r(58972),i=r(67294),a=r(73935),o=r(14674),s=r(40746),l=r(50525),d=r(73287).Store,u={init:function(){const e=new d(l);a.render(i.createElement(n.PromotionTouch,{store:e}),document.querySelector("#promotion")),o.init(),s.loadOdais();const{entryIds:t}=e.getState().entries;t.length>0&&o.showEntry(t[0])}};e.exports=u},55431:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(57942)),i=a(r(347));function a(e){return e&&e.__esModule?e:{default:e}}var o=class{activate(e,t){return i.default.put("/api/blog/top_placed_publication",{blog_id:e,entry_id:t},{params:{rkc:(0,n.default)("rkc"),rkm:(0,n.default)("rkm")}})}deactivate(e){return i.default.delete("/api/blog/top_placed_publication",{params:{blog_id:e,rkc:(0,n.default)("rkc"),rkm:(0,n.default)("rkm")}})}};t.default=o},5927:(e,t,r)=>{"use strict";var n=r(65939);const i=r(65311),a=r(36500),o=r(67279),s={init:function(){a.listenToParent(),o(),(0,n.initGlobalHeaderEventTracker)(),a.send("init"),a.addEventListener("init",(e=>{i(".subscribe").click((()=>(a.send("subscribe",{left:e.left?e.left:0}),!1))),a.send("request-report-abuse-info",{}),a.addEventListener("response-report-abuse-info",(e=>{const t=i(".js-report-abuse-link");t.attr("href",`${t.attr("href")}?target_url=${encodeURIComponent(e)}`)}))})),i(".edit-this-entry").click((()=>(a.send("edit-this-entry"),!1))),i(".new-entry").click((()=>(a.send("new-entry"),!1)))}};e.exports=s},39212:(e,t,r)=>{"use strict";var n=r(65939);const i=r(65311),a=r(36500),o=r(67279),s=r(28507),l={init:function(){a.listenToParent(),(0,n.initGlobalHeaderEventTracker)(),s((()=>i(document.body).is(":visible")),(()=>{o()}),100),i(document.body).mouseenter((()=>{a.send("mouseenter")}))}};e.exports=l},35358:(e,t,r)=>{"use strict";var n=r(65939);const i=r(65311),a=r(36500),o=r(67279),s={init:function(){a.listenToParent(),o(),(0,n.initGlobalHeaderEventTracker)();const e=i("#help");if(e.click((()=>(a.send("feedback",{uri:e.attr("data-feedback-url")}),!1))),window.matchMedia("(hover: none)").matches){let e;i("a.myblog").on("click",(function(t){t.preventDefault();const r=i(this).attr("href");e&&a.send("myblogmenu.close",{blogUri:e}),a.send("myblogmenu.open",{blogUri:r}),e=r}))}else i(".dropdown-mymenu").menuAim({activate:function(e){if(!i(e).hasClass("dropdown-mymenu-submenu"))return;const t=i(e).find("a").attr("href");a.send("myblogmenu.open",{blogUri:t})},deactivate:function(e){if(!i(e).hasClass("dropdown-mymenu-submenu"))return;const t=i(e).find("a").attr("href");a.send("myblogmenu.close",{blogUri:t})},submenuDirection:"left"});i("a.myblog").each((function(){const e=i(this).position().top,t=i(this).attr("href");a.send("myblogmenu.init",{top:e,blogUri:t})}))}};e.exports=s},966:(e,t,r)=>{"use strict";var n,i=(n=r(20996))&&n.__esModule?n:{default:n},a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(55992));function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}const s=r(65311),l=r(36500),d=r(67279),u={init:function(){l.listenToParent(),l.addEventListener("init",(e=>{const t=e.BASE,r=e.info.services,n=s("#username-window");s('<dt class="label"><span>Services in Use</span></dt>').find("span").text(i.default.text("services_in_use")).end().appendTo(n);const o=[];for(const e in r)r[e].is_beta||r[e].portal_top_priority&&o.push(e);o.sort(((e,t)=>r[t].portal_top_priority-r[e].portal_top_priority));for(let e=0,i=o.length;e<i;e++){const i=o[e],a=r[i];if(!a)continue;const l=`http://www${t}/me/${a.name}/`,d=`//www.hatena.com/images/favicon/${a.name}.png`;s('<dd><a href="" rel="noreferrer" target="_blank"><img alt="" width="16" height="16"/></a></dd>').find("a").find("img").attr("src",d).end().attr("href",l).append(document.createTextNode(a.text)).end().appendTo(n)}s('<dt class="label"><span>Lang</span></td>').find("span").text(i.default.text("lang")).end().appendTo(n);const u=i.default.getAvailLangs();for(let e=0;e<u.length;e++){const t=u[e];u[e]===i.default.getTextLang()?s('<dd><span class="selected">lang</span></dd>').find("span").text(i.default.text(`lang.${t}.native`)).end().appendTo(n):s('<dd><a href="#">lang</a></dd>').find("a").attr("data-lang",t).text(i.default.text(`lang.${t}.native`)).end().appendTo(n)}n.find("a[data-lang]").click((function(){const e=s(this).attr("data-lang");return i.default.setAcceptLang(e),l.send("reload"),!1})),s('<dt class="label"><span>My Hatena</span></dt>').find("span").text(i.default.text("my_hatena")).end().appendTo(n),s(`<dd><a href="" rel="noreferrer" target="_blank"><img src="${a.staticUrl("/images/favicon/my.png")}" width="16" height="16" alt=""></a></dd>`).find("a").attr("href",`http://www${t}/my/`).append(i.default.text("profile")).end().appendTo(n),s(`<dd><a href="" rel="noreferrer" class="logout" target="_parent"><img src="${a.staticUrl("/images/favicon/logout.gif")}" width="16" height="16"></a></dd>`).find("a").attr("href",`http://www${t}/logout?location=${encodeURIComponent(e.location)}`).append(i.default.text("logout")).end().appendTo(n),d()})),l.send("init")}};e.exports=u},10175:(e,t,r)=>{"use strict";var n=a(r(20996)),i=a(r(57942));function a(e){return e&&e.__esModule?e:{default:e}}const o=r(65311),s={init(){this.$form=o("#odai"),this.$submit=this.$form.find("input[type=submit]"),this.$period=o("input[name=period]"),this.$dateWrapper=o(".admin-odai-period-date-wrapper"),this.$startDate=o("input[name=start_date]"),this.$endDate=o("input[name=end_date]"),this.$periodError=o(".admin-odai-period-error"),o(".delete-odai").on("submit",(()=>this.confirmDelete())),this.$period.on("change",(()=>this.togglePeriod())),this.$form.on("change",(()=>this.validatePeriod())),this.togglePeriod()},confirmDelete(){const e=this.$form.attr("data-odai-title"),t=this.$form.attr("data-odai-id"),r=`${(0,i.default)("admin-domain")}/${t}`;return window.confirm(n.default.text("admin.odai.delete_odai.confirm",e,r))},togglePeriod(){this.$dateWrapper.toggle(this.$period.prop("checked"))},validatePeriod(){const e=!this.isPeriodValid();this.$submit.attr("disabled",e),this.$periodError.toggle(e)},isPeriodValid(){if(!this.$period.prop("checked"))return!0;const e=new Date(this.$startDate.val()),t=new Date(this.$endDate.val());return isNaN(e)||isNaN(t)||t-e>=0}};e.exports=s},63931:(e,t,r)=>{"use strict";var n=r(65311),i={init:function(){n("form").submit((function(){n(this).find("input:submit").attr("disabled","disabled")}))}};e.exports=i},3136:e=>{"use strict";const t={init(){document.querySelectorAll(".js-pro-survey-required-checkbox").forEach((e=>{e.addEventListener("change",(()=>{this.updateSubmitState()}))})),document.querySelectorAll(".js-pro-survey-required-textarea").forEach((e=>{e.addEventListener("keyup",(()=>{this.updateSubmitState()}))})),this.updateSubmitState()},updateSubmitState(){const e=Array.from(document.querySelectorAll(".js-pro-survey-required-checkbox")).some((e=>e.checked))||Array.from(document.querySelectorAll(".js-pro-survey-required-textarea")).some((e=>""!==e.value));document.querySelector(".js-pro-survey-submit-button").disabled=!e}};e.exports=t},47814:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;var n=r(99057);const i=r(91269);t.init=()=>{const e=i.get("eCommerceTransaction");e&&((0,n.pushToDataLayer)(e),(0,n.pushToDataLayer)({event:"submitECommerceTransaction"}))}},84032:(e,t,r)=>{"use strict";var n=o(r(67294)),i=r(73380),a=o(r(71617));function o(e){return e&&e.__esModule?e:{default:e}}const s=r(91269),l={init(){const e=s.get("pro.registerCardUrlBase"),t=s.get("pro.redirectUrl"),r=s.get("pro.registeredCard"),o=s.get("pro.expiresOn"),l={durationDays:s.get("pro.durationDays"),label:s.get("pro.courseLabel"),name:s.get("pro.courseName"),price:s.get("pro.price"),isCampaign:s.get("pro.isCampaign")},d=s.get("pro.availableCourses"),u=s.get("pro.migrateVia");(0,i.safeRender)(n.default.createElement(a.default,{registerCardUrlBase:e,redirectUrl:t,registeredCard:r,expiresOn:o,initialCourse:l,availableCourses:d,migrateVia:u}),document.querySelector("main"))}};e.exports=l},60680:(e,t,r)=>{"use strict";var n=o(r(67294)),i=r(73380),a=o(r(30044));function o(e){return e&&e.__esModule?e:{default:e}}const s=r(91269),l={init(){const e=s.get("pro.registerCardUrlBase"),t=s.get("pro.redirectUrl"),r=s.get("pro.registeredCard"),o={durationDays:s.get("pro.currentCourseDurationDays"),label:s.get("pro.currentCourseLabel"),name:s.get("pro.currentCourseName"),price:s.get("pro.currentCoursePrice"),isCampaign:s.get("pro.currentCourseIsCampaign"),pricePerDay:s.get("pro.currentCoursePricePerDay")},l={durationDays:s.get("pro.destinationCourseDurationDays"),label:s.get("pro.destinationCourseLabel"),name:s.get("pro.destinationCourseName"),price:s.get("pro.destinationCoursePrice"),isCampaign:s.get("pro.destinationCourseIsCampaign"),pricePerDay:s.get("pro.destinationCoursePricePerDay")},d=s.get("pro.expiresOn"),u=s.get("pro.migrateVia"),c=s.get("pro.daysUntilExpiration"),p=s.get("pro.unusedAmount"),f=s.get("pro.daysToExtend"),h=s.get("pro.newExpiresOn"),m=s.get("pro.courseStructureVersion");(0,i.safeRender)(n.default.createElement(a.default,{registerCardUrlBase:e,redirectUrl:t,registeredCard:r,currentCourse:o,destinationCourse:l,expiresOn:d,migrateVia:u,daysUntilExpiration:c,unusedAmount:p,daysToExtend:f,newExpiresOn:h,courseStructureVersion:m}),document.querySelector("main"))}};e.exports=l},98924:(e,t,r)=>{"use strict";var n=o(r(73722)),i=r(73380),a=o(r(67294));function o(e){return e&&e.__esModule?e:{default:e}}const s=r(91269),l={init(){const e=s.get("pro.expiresOn"),t={durationDays:s.get("pro.durationDays"),label:s.get("pro.courseLabel"),name:s.get("pro.courseName"),price:s.get("pro.price"),isCampaign:s.get("pro.isCampaign")},r=s.get("pro.tier"),o=s.get("pro.registeredCard"),l=s.get("pro.registerCardUrlBase"),d=s.get("pro.redirectUrl");(0,i.safeRender)(a.default.createElement(n.default,{actionPath:"/-/pro/resume",confirmFormId:"pro-form-confirm-will-resume",startProFormId:"pro-form-will-resume",registeredCard:o,course:t,tier:r,expiresOn:e,shouldShowFirstPaymentOn:!1,registerCardUrlBase:l,redirectUrl:d,onCancelPath:void 0}),document.querySelector("main"))}};e.exports=l},97812:(e,t,r)=>{"use strict";var n=o(r(73722)),i=r(73380),a=o(r(67294));function o(e){return e&&e.__esModule?e:{default:e}}const s=r(91269),l={init(){const e=s.get("pro.isChangingCourse"),t=e?"/-/pro/change_course":"/-/pro/start",r=e?"pro-form-confirm-will-change-course":"pro-form-confirm-will-start",o=e?"pro-form-will-change-course":"pro-form-will-start",l=s.get("pro.expiresOn"),d=s.get("pro.shouldShowFirstPaymentOn"),u=s.get("pro.firstPaymentOn"),c={durationDays:s.get("pro.durationDays"),label:s.get("pro.courseLabel"),name:s.get("pro.courseName"),price:s.get("pro.price"),isCampaign:s.get("pro.isCampaign")},p=s.get("pro.tier"),f=s.get("pro.registeredCard"),h=s.get("pro.registerCardUrlBase"),m=s.get("pro.redirectUrl"),g=s.get("pro.onCancelPath"),v=s.get("pro.plusVia"),b=s.get("pro.plusViaTerm"),y=s.get("pro.courseStructureVersion");(0,i.safeRender)(a.default.createElement(n.default,{courseStructureVersion:y,actionPath:t,confirmFormId:r,startProFormId:o,registeredCard:f,course:c,tier:p,expiresOn:l,shouldShowFirstPaymentOn:d,firstPaymentOn:u,registerCardUrlBase:h,redirectUrl:m,onCancelPath:g,plusVia:v,plusViaTerm:b}),document.querySelector("main"))}};e.exports=l},86968:(e,t,r)=>{"use strict";var n,i=(n=r(57942))&&n.__esModule?n:{default:n},a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(55992));function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}const s=r(65311),l=r(66419),d=r(17187).EventEmitter,u=r(91269);class c extends d{setState(e){this.state=e,this.emit("change",this.state)}saveTask(e,t){return s.ajax({url:`../task/${e}/save`,method:"POST",data:{value:t?1:0,rkm:(0,i.default)("rkm"),rkc:(0,i.default)("rkc")}}).done((e=>{this.setState(e)}))}}class p{constructor(e,t){this.series=e,s("input").on("change",(e=>{const t=s(e.target);this.series.saveTask(t.attr("data-task-id"),t.is(":checked"))})),this.series.on("change",(e=>{t.render(e)}))}}class f{render(e){const t=s(".challenge-indicator-gauge"),r=s(".achieved-count"),n=e.user_status,i=`${e.achieved_rate}%`;t.css({width:i}),r.text(i),s(".js-user-title").text(n.title),s(".js-user-level").text(n.level),s(".js-user-point").text(n.point),s(".js-user-achieved-count").text(n.achieved_tasks_count),s(".js-challenge-status").removeClass("is-bronze").removeClass("is-silver").removeClass("is-gold"),s(".js-rank-label").text(""),n.rank&&(s(".js-challenge-status").addClass(`is-${n.rank}`),s(".js-rank-label").text(`(${n.rank})`)),100===e.achieved_rate?(s(".js-congratulations").show(),document.body.style.backgroundImage=`url('${a.staticUrl("/images/special/challenge/kira-bg.jpg")}')`):(s(".js-congratulations").hide(),document.body.style.backgroundImage=""),this.setSocialURLs(e.links)}setSocialURLs(e){s(".js-post-completed-to-blog").attr({href:e.post_completed_to_blog_link}),s(".js-post-completed-to-twitter").attr({href:e.post_completed_to_twitter_link}),s(".js-post-name-to-twitter").attr({href:e.post_name_to_twitter_link})}}class h{constructor(e){const t=s(window);t.on("load scroll",l.throttle((()=>{const r={isFixed:t.scrollTop()>1e3};e.render(r)}),100))}}class m{constructor(){this.$challengeStatus=s(".l-challenge-status")}render(e){e.isFixed?this.$challengeStatus.addClass("is-fixed"):this.$challengeStatus.removeClass("is-fixed")}}const g={init:function(){const e=new c,t=new f,r=(new p(e,t),u.get("blogChallenge"));e.setState(r);const n=new m;new h(n)}};e.exports=g},57005:(e,t,r)=>{"use strict";var n,i=(n=r(83092))&&n.__esModule?n:{default:n};const a=r(65311),o={init:function(){new i.default(a("#topic-entries-tabs"),0)}};e.exports=o},95974:(e,t,r)=>{"use strict";var n=r(36500),i={init:function(){n.listenToParent(),n.send("delete")}};e.exports=i},52163:(e,t,r)=>{"use strict";var n=r(36500),i={init:function(){n.listenToParent()}};e.exports=i},99352:(e,t,r)=>{"use strict";var n=r(36500),i={init:function(){n.listenToParent();var e=document.getElementById("posted").value;n.send("update",{comment:e}),n.send("close")}};e.exports=i},12412:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=r(55992),a=(n=r(20996))&&n.__esModule?n:{default:n},o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294));function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}class l extends o.Component{constructor(e){super(e),this.state={checked:!1,confirmBlogURL:""},this.onClickCheckBox=this.onClickCheckBox.bind(this),this.inputURLBox=this.inputURLBox.bind(this),this.validateButtonDisabled=this.validateButtonDisabled.bind(this)}checkEntryCount(){const e=this.props.blogEntryCount;if(e>=1)return o.createElement("tr",null,o.createElement("th",null,a.default.text("blog_entry_number")),o.createElement("td",null,a.default.textN("unit_entry",e,e)))}checkTotalDays(){const e=this.props.blogTotalDays;if(e)return o.createElement("tr",{"data-test":"total-days"},o.createElement("th",null,a.default.text("blog_total_days.20200528")),o.createElement("td",null,a.default.textN("unit_day",e,e)))}checkSubscribers(){const e=this.props.blogSubscribers;if(e.length>=1)return o.createElement("tr",null,o.createElement("th",null,a.default.text("epic.subscriber")),o.createElement("td",null,o.createElement("div",{className:"info"},o.createElement("span",{className:"subscription-count"},a.default.textN("unit_person",e.length,e.length)),e.map(((e,t)=>o.createElement("a",{href:e.blogURL,key:e.blogURL},o.createElement("img",{src:e.iconURL,width:16,height:16,alt:e.name,title:e.name,"data-testid":`icon-${t}`})))))))}checkProStatus(){if(this.props.proStatusCanRequestCancel)return o.createElement("aside",{className:"error-box delete-pro-notice",id:"plus-message"},o.createElement("h3",null,a.default.text("admin.blog.plus.notice")),o.createElement("p",{"data-pro-quit-link":this.props.proStatusCancelRequestURL},a.default.text("admin.blog.config.confirm.delete_pro_notice_with_url")),o.createElement("p",null,o.createElement("a",{href:this.props.proStatusCancelRequestURL,className:"btn"},a.default.text("admin.leave_plus"))))}onClickCheckBox(e){this.setState({checked:e.currentTarget.checked})}inputURLBox(e){this.setState({confirmBlogURL:e.currentTarget.value})}validateButtonDisabled(){const e=this.props.blogHost;return this.state.confirmBlogURL===e&&this.state.checked}render(){const e=this.validateButtonDisabled();return o.createElement("form",{action:this.props.postURL,method:"post",id:"blog-delete"},o.createElement("table",{className:"table"},o.createElement("tr",null,o.createElement("th",null,o.createElement("label",{htmlFor:"id"},a.default.text("admin.blog.config.id"))),o.createElement("td",null,o.createElement("a",{href:this.props.blogURI,target:"_blank",rel:"noopener noreferrer"},this.props.blogHost))),o.createElement("tr",null,o.createElement("th",null,a.default.text("admin.blog.config.name")),o.createElement("td",null,this.props.blogName)),o.createElement("tr",null,o.createElement("th",null,a.default.text("admin.blog.config.description")),o.createElement("td",null,this.props.blogDescription)),this.checkEntryCount(),this.checkTotalDays(),this.checkSubscribers(),o.createElement("tr",null,o.createElement("th",null,a.default.text("admin.config_delete.why.textarea")),o.createElement("td",null,o.createElement("p",{className:"admin-p"},a.default.text("admin.config_delete.why")),o.createElement("textarea",{name:"blog_delete_reason",rows:5,cols:50}))),o.createElement("tr",null,o.createElement("th",{rowSpan:2},a.default.text("admin.config_delete.confirm_blog"),o.createElement("small",{className:"confirm-required-label"},a.default.text("admin.config_delete.confirm_required"))),o.createElement("td",null,o.createElement("p",null,a.default.text("admin.config_delete.confirm_notice")),o.createElement("label",null,o.createElement("input",{type:"checkbox",checked:this.state.checked,onChange:this.onClickCheckBox,"data-testid":"confirm-delete-agreement"}),a.default.text("admin.config_delete.confirm_agreement")))),o.createElement("tr",null,o.createElement("td",null,o.createElement("p",null,a.default.text("admin.config_delete.confirm_blog_url")),o.createElement("div",null,o.createElement("input",{"data-testid":"confirm-delete-blog-url",placeholder:this.props.blogHost,type:"text",value:this.state.confirmBlogURL,onChange:this.inputURLBox,size:50}))))),this.checkProStatus(),o.createElement("div",{className:"blog-delete-submit"},o.createElement("button",{type:"submit",id:"delete-button",disabled:!e,className:"btn btn-danger"},a.default.text("delete")),o.createElement("a",{className:"btn",href:(0,i.httpsAdminUserBlogUrl)("/config/detail")},a.default.text("cancel")),o.createElement("input",{type:"hidden",name:"rkm",value:this.props.rkm}),o.createElement("input",{type:"hidden",name:"rkc",value:this.props.rkc})))}}var d=l;t.default=d},64007:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;var n=d(r(67294)),i=r(73380),a=d(r(57942)),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=l(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(55992)),s=d(r(12412));function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(l=function(e){return e?r:t})(e)}function d(e){return e&&e.__esModule?e:{default:e}}const u=r(91269);t.init=()=>{const e=o.httpsAdminUserBlogUrl("/config/delete"),t=(0,a.default)("blog-host"),r=(0,a.default)("blog-uri"),l=(0,a.default)("blog-name"),d=u.get("blog.description"),c=u.get("blog.entrycount"),p=u.get("blog.totaldays"),f=u.get("blog.subscribers"),h=u.get("pro_status.can_request_cancel"),m=u.get("pro_status.cancel_request_url"),g=(0,a.default)("rkc"),v=(0,a.default)("rkm");(0,i.safeRender)(n.default.createElement(s.default,{postURL:e,blogHost:t,blogURI:r,blogName:l,blogDescription:d,blogEntryCount:c,blogTotalDays:p,blogSubscribers:f,proStatusCanRequestCancel:h,proStatusCancelRequestURL:m,rkc:g,rkm:v}),document.querySelector("#confirm-deleting-blog-form"))}},42076:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HTML_FORM_NAMES=void 0,t.init=function(){const e=(0,n.default)("#css"),t=(0,n.default)("#form-design"),r=(0,n.default)("#preview"),a=(0,n.default)("#preview-loading"),E=(0,n.default)("#tabs"),C=(0,n.default)("#form-design-fold-button"),x=new b.FormState(t),j=new f.PreviewUpdater({$form:t,$preview:(0,n.default)("#preview-iframe"),$loading:a,formState:x,htmlFormNames:O});(0,u.initListItemSelector)(),function(e,t){if(!e[0])return;const r=document.querySelector("#force-pc-view"),n=(e,n)=>{let i;i="newPanel"in n?n.newPanel.attr("id"):n.panel.attr("id"),"tab-customize-touch"!==i||r?.checked?t.setDeviceAsPC():t.setDeviceAsTouch()};e.on("tabsactivate",n).on("tabscreate",n),r&&r.addEventListener("change",(()=>{r.checked?t.setDeviceAsPC():t.setDeviceAsTouch()}));const i=new y.default(e)}(E,j),function(e,t,r){if(!r[0])return;r.click((()=>{r.hasClass("open")?(r.removeClass("open").addClass("close"),e.hide(),t.addClass("fold-form")):(r.removeClass("close").addClass("open"),e.show(),t.removeClass("fold-form"))}))}(t,r,C),function(e){const t=(0,n.default)(".switch-button");t.click((()=>{"index"===e.getPageType()?(t.addClass("permalink").removeClass("index"),t.text(w.default.text("admin.design.quit_preview_entry_page")),e.setAsPermalinkPreview(),e.preview()):(t.addClass("index").removeClass("permalink"),t.text(w.default.text("admin.design.preview_entry_page")),e.setAsIndexPreview(),e.preview())}))}(j),O.forEach((e=>{const t=`:input[name = "${e}"]`,r=(0,n.default)(t);r.length&&(r.prop("disabled")||M("html",r))})),M("css",e),function(e){let t=(0,n.default)('input[type="file"].background-image');const r=(0,n.default)("#background-image"),a=(0,n.default)("#background-image-thumbnail"),o=(0,n.default)("a.delete-background-image"),l=(0,n.default)('input[name="bg-image-src"]'),d=(0,n.default)('input[name="bg-image-id"]'),u=(0,n.default)('input[name="bg-image-selected"]'),c=(0,i.template)("body{ background-image: url('<%= image %>'); background-repeat: <%= repeat %>; background-color:<%= backgroundColor %>; background-attachment: <%= attachment %>; background-position: <%= position %> top;}"),p=(0,n.default)('select[name="background-position"]'),f=(0,n.default)('select[name="background-repeat"]'),h=(0,n.default)('select[name="background-attachment"]'),m=()=>{r.show()},g=()=>{r.hide()};o.click((()=>(confirm(w.default.text("admin.design.stop_header_image_confirm"))&&(d.val(""),l.val(""),u.val(0),y(),g()),!1))),a.click((()=>{if(y(),!a.hasClass("ui-selected")){(0,n.default)("#backgrounds li").removeClass("ui-selected"),a.addClass("ui-selected"),u.val(1)}})),p.change((()=>{y()})),h.change((()=>{y()})),f.change((()=>{y()}));const b=e=>{d.val(e);const r=e.match(/f:id:([^:]+):(\d+)([jpg]):image/);if(!r)return;const n=r[1],i=r[2],o=r[3],s={j:".jpg",p:".png",g:".gif"},u=[n.substring(0,1),n,i.substring(0,8),i].join("/"),c=`https://cdn-ak.f.st-hatena.com/images/fotolife/${u}${s[o]}`,p=`https://cdn-ak.f.st-hatena.com/images/fotolife/${u}_120.jpg`;l.val(c),a.attr("src",p),m(),t.prop("disabled",!1),a.trigger("click");if("undefined"!=typeof FormData){const e=t.clone(!0);t.replaceWith(e),t=e}},y=()=>{const t=l.val(),r=new v.EditDesign(e.val());let i,a;if(t){const e=(0,n.default)("#background-colors li.ui-selected");let r="transparent";0===e.length?(0,n.default)('#background-colors li[data-css=""]').addClass("ui-selected"):void 0!==e.attr("data-id")&&(r=`#${e.attr("data-id")}`),i="custom";const o=f.find("option:selected").val(),s=p.find("option:selected").val(),l=h.find("option:selected").val();a=c({image:t,backgroundColor:r,repeat:o,position:s,attachment:l})}else i="default",a=(0,n.default)('li[data-id="default"]').attr("data-css");r.setData("background",i,a),e.val(r.getCSS()),e.trigger("change")};"undefined"!=typeof FormData?t.on("change",(e=>{e.currentTarget.files?.length&&(g(),(0,s.uploadImage)(e.currentTarget,t,"Hatena Blog",3e3,b))})):(0,s.setIframeUploader)(t,3e3,b)}(e);const $=new h.TrimmingWindow((0,n.default)(".js-header-modal-window")),T=(0,n.default)(".js-design-header .js-header-image-container");0!==T.length&&function(e,t,r){const i={width:+e.attr("data-max-width"),height:+e.attr("data-max-height")},a=new l.HeaderImage(e,i),o=new d.HeaderImagePreview(e.find(".js-header-image-item"));(0,n.default)(a).on("updated",(()=>{a.getImageSrc()?o.render(a.getImageSrc(),a.getThumbnailSrc(),a.getDisplayArea()):a.getImageSrc()||o.clear(),t.requestPreview()}));(0,s.initFotoUploader)(e.find(".js-header-image-input"),i.width).progress((e=>{a.setImage(e.url,e.fid),r.trim(a.getImageSrc(),a.getTrimmingArea()).always((e=>{a.setDisplayArea(e)}))})),e.on("click",".js-header-image-thumbnail, .jcrop-holder, .js-resizer",(()=>(r.trim(a.getImageSrc(),a.getTrimmingArea()).done((e=>{void 0!==e&&a.setDisplayArea(e)})),!1))).on("click",".js-delete-header-image",(()=>!!confirm(w.default.text("admin.design.stop_header_image_confirm"))&&(a.clear(),!1)))}(T,j,$);(0,g.setupTouchHeaderImageComponent)({$container:(0,n.default)(".js-design-header-touch .js-header-image-container"),previewUpdater:j}),(0,n.default)(".js-variable-toggle").click((e=>((0,n.default)(e.currentTarget).parents(".custom_html_section").find(".js-variable-help").slideToggle(),!1)));const I=new c.ModuleEditor((0,n.default)(".js-module-edit-modal-window")),D=new o.CategoryEditor;(0,n.default)(I).on("edit-new-module change-category-order-type",(()=>{D.updateCategoryPreview()})),["sidebar","top-page-main-column","top-page-header","top-page-sidebar","entry-header","entry-footer-primary","entry-footer-secondary","touch-top-page-header","touch-entry-header","touch-entry-footer-primary","touch-entry-footer-secondary","touch-footer"].forEach((e=>{const r=(0,n.default)(`div[data-modules-type="${e}"].sidebar-box`);if(!r.length)return;const i=new p.Modules(r,I);(0,n.default)(i).on("updated",(()=>t.trigger("change")))})),function(e){const t=(0,n.default)(e);t.next().hide(),t.click((e=>{const t=(0,n.default)(e.currentTarget),r=t.next();r.is(":visible")?(r.hide(),t.removeClass("open")):(r.show(),t.addClass("open"))}))}(".accordion-title");const N=function(){const e=n.default.Deferred();return n.default.ajax({type:"GET",url:"/api/applications_data",dataType:"json"}).done((t=>{const r=k.parse(t);(0,n.default)(".js-module-value-component-profile").each(((e,t)=>{const i=(0,n.default)(t);r.twitter?i.find(".cannot-twitter-button").remove():(i.find(".can-twitter-button").remove(),i.find(".cannot-twitter-button").removeClass("cannot-twitter-button").addClass("cannot-twitter-button-display"))})),e.resolve()})).fail((()=>{e.reject()})),e.promise()}(),L=function(){const e=n.default.Deferred();if(0===(0,n.default)("#module-value-component-circles").length)return e.resolve(),e.promise();return n.default.ajax({type:"GET",url:"/api/circles",data:{blog:(0,_.default)("blogs-uri-base")},dataType:"json"}).done((t=>{const r=P.parse(t),a=(0,i.template)((0,n.default)(".js-module-circles-select-circles-template").html().replace(/^\s+|\s+$/g,""));r.circles.forEach((e=>{(0,n.default)(".js-select-circles-container").each(((t,r)=>{(0,n.default)(r).append((0,n.default)(a({circle:e})))}))})),e.resolve()})).fail((()=>{e.reject()})),e.promise()}();D.updateCategoryPreview(),n.default.when(N,L).always((()=>x.commit())),function(){(0,n.default)(".switch-theme-list-types").on("blog:dropdown:selected","[data-theme-list-type]",(e=>{const t=(0,n.default)(e.currentTarget).attr("data-theme-list-type");(0,n.default)("#themes .themes-container").each(((e,r)=>{(0,n.default)(r).toggle((0,n.default)(r).attr("data-theme-list-type")===t)}))}));const e=(0,n.default)(".dropdown-container"),t=e.find(".dropdown-list").hide();e.on("click",".dropdown-button, .dropdown-selected",(()=>{const e=S.toggle(t);return t.toggleClass("opened",e),!1})).on("click",".dropdown-list-item",(t=>{e.find(".dropdown-selected").text((0,n.default)(t.currentTarget).text()),(0,n.default)(t.currentTarget).trigger("blog:dropdown:selected")})).find(".dropdown-list-item").eq(0).click()}(),(0,m.setupTextareaHider)(),function(){const e=(0,n.default)(".js-show-more-background-images");e.one("click",(()=>{e.remove(),(0,n.default)("#backgrounds li:hidden").show()}))}(),function(e){const t=e.find(':input[name="touch-accent-color"]'),r=(0,n.default)("#touch-accent-colors"),i=n=>{r.find(".selected").removeClass("selected"),n.addClass("selected");const i=n.attr("data-color");t.val(i),e.trigger("change")};r.on("click","[data-color]",(e=>{i((0,n.default)(e.currentTarget))}));const a=t.val();i(r.find(`[data-color="${a}"]`))}(t),j.requestPreview(),t.on("change",(()=>{j.requestPreview()}))};var n=E(r(65311)),i=r(66419),a=r(78754),o=r(22230),s=r(4291),l=r(72367),d=r(84589),u=r(67875),c=r(87855),p=r(4221),f=r(51634),h=r(95278),m=r(69503),g=r(37448),v=r(37255),b=r(60802),y=E(r(83092)),_=E(r(57942)),w=E(r(20996));function E(e){return e&&e.__esModule?e:{default:e}}const S=r(26410),C=r(46658),P=a.z.object({circles:a.z.array(a.z.object({id:a.z.string(),name:a.z.string(),url:a.z.string()}))}),k=a.z.object({twitter:a.z.boolean()}),O=["header-html","entry-header-html","entry-footer-html","footer-html","header-touch-html","entry-touch-header-html","entry-touch-footer-html","footer-touch-html","touch-under-pager-html"];function M(e,t){if(!t[0])return;const r=document.createElement("div");(0,n.default)(r).css({position:"absolute",top:"auto",left:0,bottom:50,padding:0,margin:0,borderTop:"1px solid #ccc",borderBottom:"1px solid #ccc",width:"640px",height:"75%",zIndex:9999,background:"#fff"}).appendTo(document.body).hide(),t.css({"font-size":"14px","white-space":"nowrap",overflow:"hidden"});const i=ace.edit(r);i.commands.removeCommand("gotoline"),i.commands.removeCommand("indent"),i.commands.removeCommand("outdent"),i.commands.removeCommand("find"),i.renderer.setHScrollBarAlwaysVisible(!1),i.renderer.setPadding(5),i.renderer.setShowPrintMargin(!1),i.setFontSize("10px"),i.setHighlightActiveLine(!1);const a=i.getSession();if(a.setUseWrapMode(!0),a.setUseWorker(!1),"css"!==e){const t=new(0,ace.require(`ace/mode/${e}`).Mode);a.setMode(t)}const o=new C;t.focus((()=>{(0,n.default)(r).show(),i.resize(),i.focus(),o.enable()})),i.on("blur",(()=>{t.val(a.getValue()),t.trigger("change"),(0,n.default)(r).hide(),o.disable()})),(0,n.default)(r).mousedown((()=>!1)),a.setValue(t.val()),t.change((()=>{a.setValue(t.val())})),(0,n.default)("#tabs").on("tabsactivate",(()=>{setTimeout((()=>{i.resize()}),0)})),(0,n.default)(window).resize((()=>{i.resize()}))}t.HTML_FORM_NAMES=O},38703:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;var n,i=(n=r(65311))&&n.__esModule?n:{default:n};const a=r(1780);t.init=()=>{(0,i.default)(".main-tab").find(".user-blog-config-detail").addClass("current-tab");const e=(0,i.default)(".js-blog-config-detail-form");e.on("submit",(()=>{a(e)})),(0,i.default)("#blog-config-custom-domain .check-validity").click((function(e){var t=(0,i.default)(this);return t.attr("disabled","disabled").addClass("disabled"),(0,i.default)("#blog-config-custom-domain .validity-status").text("-"),i.default.ajax({type:"POST",url:"/api/custom_domain.check",data:t.closest("form").serialize(),dataType:"json",success:function(e){(0,i.default)("#blog-config-custom-domain .validity-status").text(e.message),(0,i.default)("#blog-config-custom-domain .validity-status.detail").text(e.detail||"")},complete:function(){t.removeAttr("disabled").removeClass("disabled")}}),!1}));const t=document.querySelector('input[name="custom-domain_https_confirmation-checkbox"]');if(!t)return;const r=document.querySelector("#custom_host");if(!r)throw new Error("[BUG] custom_host input not found");t.addEventListener("change",(e=>{r.disabled=!e.target.checked}))}},24460:(e,t,r)=>{"use strict";const n=r(65311),i={init:function(){this.setupResetButton()},setupResetButton:function(){const e=n("#reset-entry-directory"),t=n("#entry-directory-input");e.on("click",(()=>t.val("entry")))}};e.exports=i},56870:(e,t,r)=>{"use strict";var n=r(55248);const i=r(65311),a={init:function(){new n.BlogPermission(i("#blog-permission-container"))}};e.exports=a},47405:(e,t,r)=>{"use strict";const n=r(65311),i={init:function(){var e=n("#theme-preview-form"),t=n("#theme-install-form"),r=t.find(".notice").text();t.on("submit",(()=>confirm(r))),e.submit()}};e.exports=i},12771:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;var n,i=(n=r(65311))&&n.__esModule?n:{default:n},a=r(67677);const o=r(26028),s=r(49634),l=r(8659),d=r(36500);t.init=()=>{d.listenToParent();const e=document.getElementById("js-posted");if(e instanceof HTMLTextAreaElement){const t=e.value;d.send("update",{entry:t})}setTimeout((()=>{(0,i.default)("form").each(((e,t)=>{const r=(0,i.default)(t),n=r.find("input[type=submit]");r.removeClass("unedited"),n.removeAttr("disabled")}))}),1e3),l(),new o((0,i.default)(".js-socialize-modal")),u(),(0,i.default)("a.js-official-share-button").on("click",(e=>{e.preventDefault();const t=(0,i.default)(e.currentTarget).attr("href");new s(t,550,450,screen.width,screen.height)}))};const u=()=>{const e=(0,i.default)(".js-twitter-share-form"),t=String((0,i.default)(".js-socialize-box").data("entry-id")),r=(0,i.default)(".js-share-success-message"),n=document.querySelector(".js-twitter-official-share-button"),o=document.querySelector(".js-twitter-account-select"),s=document.querySelector(".js-twitter-account-selector");n&&o&&s&&new a.TwitterShareForm(e,r,n,o,s,t)}},34174:(e,t,r)=>{"use strict";var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=i(t);if(r&&r.has(e))return r.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=a?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,r&&r.set(e,n);return n}(r(96337));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(i=function(e){return e?r:t})(e)}const a={init:()=>{const e=document.querySelector("#uploader-container");n.init(e)}};e.exports=a},54385:(e,t,r)=>{"use strict";const n=r(65311),i=r(39338),a={init:function(){var e=n("#import-hatena_diary-progress"),t=e.find(".bar");if(e[0]&&t[0]){var r=e.attr("data-progress-api"),a=e.attr("data-diary-page");i.init(t,r,a)}}};e.exports=a},79997:(e,t,r)=>{"use strict";const n=r(65311),i=r(39338),a={init:function(){var e=n("#import-hatena_diary-progress"),t=e.find(".bar");if(e[0]&&t[0]){var r=e.attr("data-progress-api"),a=e.attr("data-diary-page");i.init(t,r,a)}}};e.exports=a},93841:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;var n,i=(n=r(20996))&&n.__esModule?n:{default:n};t.init=()=>{document.querySelector(".js-yahoo-import-password-copy-button").addEventListener("click",(e=>{const t=document.getElementsByClassName("js-yahoo-import-password")[0],r=document.createRange();r.selectNodeContents(t),window.getSelection().removeAllRanges(),window.getSelection().addRange(r),document.execCommand("copy"),window.getSelection().removeAllRanges(),alert(i.default.text("epic.yahoo_import_password_copied"))}))}},45348:(e,t,r)=>{"use strict";const n=r(36500),i=r(67279),a={init:function(){n.listenToParent(),i(),n.send("done")}};e.exports=a},52943:(e,t,r)=>{"use strict";var n,i=(n=r(57942))&&n.__esModule?n:{default:n};const a=r(65311),o=r(92901),s={init:function(){var e=a(".js-hatena-follow-button-box"),t={isSubscribing:e.data("is-subscribing"),isGuest:!((0,i.default)("rkm")&&(0,i.default)("rkc"))},r=(0,i.default)("blog-uri"),n=(0,i.default)("blog-host"),s={subscribersCount:parseInt(e.data("subscribers-count"),10),blogName:(0,i.default)("blog-name"),blogUrl:r,requestUrl:[(0,i.default)("admin-domain"),(0,i.default)("author"),n,"subscribe"].join("/")};new o.Admin(e,t,s)}};e.exports=s},35394:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;var n=o(r(65311)),i=r(91298),a=o(r(83092));function o(e){return e&&e.__esModule?e:{default:e}}t.init=()=>{const e=(0,n.default)("#access-counts").remove(),t={};e.find("tr").each(((e,r)=>{const i=(0,n.default)(r),a=+i.find("td[data-time]").attr("data-time"),o=+i.find("td[data-count]").attr("data-count");t[a]=o})),i.AccessLogViewer.showGraph(t,{parent:(0,n.default)("#access-counts-daily"),timeformat:"%m/%d",minTickSize:[1,"day"],unit:864e5,number:31}),i.AccessLogViewer.showGraph(t,{parent:(0,n.default)("#access-counts-hourly"),timeformat:"%d %H:%M",minTickSize:[1,"hour"],unit:36e5,number:48});new a.default((0,n.default)("#access-counts-tabs")),new a.default((0,n.default)("#summary-detail-tabs"));(0,n.default)(".summary-box .hosts").delegate(".host","click",(e=>{(0,n.default)(".summary-box .hosts .selected").removeClass("selected"),(0,n.default)(e.currentTarget).addClass("selected");const t=(0,n.default)(e.currentTarget).attr("data-site-host");return(0,n.default)(".summary-box .site.selected").removeClass("selected"),(0,n.default)(".summary-box .sites").find(`*[data-site-host="${t}"]`).addClass("selected"),!1}))}},46292:(e,t,r)=>{"use strict";var n=r(52841),i={init:function(){var e=document.querySelector(".js-rules-container");n.init(e)}};e.exports=i},73504:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;var n,i=(n=r(65311))&&n.__esModule?n:{default:n};const a=r(26410);t.init=()=>{(0,i.default)(document).on("click",".js-show-edit-modal-window",(e=>{const t=(0,i.default)(e.target).attr("data-category-name");o(t)})),(0,i.default)(".js-modal-window .js-icon-close").on("click",(()=>{a.hideAll()})),(0,i.default)(".js-modal-window").on("click",(e=>{e.stopPropagation()}))};const o=e=>{const t=(0,i.default)(`.js-edit-modal-window[data-category-name="${e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"]`);t.is(":visible")||a.show(t,{})}},52808:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;var n,i=(n=r(65311))&&n.__esModule?n:{default:n};const a=r(36500),o=r(67279),s=r(1780);t.init=()=>{a.listenToParent(),l(),(0,i.default)(".g-recaptcha").length>0?a.send("resize",{height:490}):o();const e=(0,i.default)("form#comment-form");e.on("submit",(()=>{s(e)}))};const l=()=>{try{(0,i.default)("#body").focus()}catch{setTimeout(l,100)}}},45888:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;var n=r(50968);t.init=()=>{(0,n.initComments)()}},96849:(e,t,r)=>{"use strict";var n,i=r(60802),a=r(57525),o=r(76728),s=r(45241),l=r(48923),d=r(16686),u=r(99303),c=(n=r(20996))&&n.__esModule?n:{default:n},p=r(43652),f=r(41960);const h=r(65311),m=r(36500),g=r(1780),v=r(93687),b={init:function(){(0,p.isIframe)(window)&&(m.listenToParent(),m.send("ready"));const e=h("#title"),t=h("#character-count"),r=h("#edit-form"),n=new i.FormState(r);r.on("backup-restore",(()=>n.commit()));const b=(0,u.createEditor)(r),y=document.querySelector(".js-app-element"),_=document.getElementById("tag-editor-root");_&&(0,d.initTagEditor)(_,y);const w=document.querySelector(".js-scheduled-update-existing-notice");w&&(0,l.initScheduledUpdateExistingNotice)(w,y);const E=!!w;b.on("saveDraft",(()=>{n.commit(),m.send("change",!1)})),b.on("initialize",(()=>{n.commit(),E||b.focus(),b.bind("change",(()=>{const e=b.getCharacterCount();t.text(c.default.textN("edit_form.character_count_unit",e,e)),(0,p.isIframe)(window)&&m.send("change",n.isWatching&&n.hasFormChanged())})),e.on("keydown",(e=>{if("RET"===(0,f.keyString)(e))return b.focus(),!1})),b.$form.on("submit",(()=>{const e=b.$form.find(":submit"),t=()=>{b.$form.removeClass("unedited"),e.removeAttr("disable")};if(b.getByteCount()>655360)return b.$form.addClass("unedited"),e.attr("disable","disable"),b.bind("change",t),window.alert(c.default.text("edit_form.body_length_exceeded_error")),!1;g(h(b.$form)),(0,p.isIframe)(window)&&m.send("change",!1)}));const r=new o.EmbedBox({editor:b,$container:h(".js-editor-embed-box")});b.on("paste-url",(e=>{if(!r.isEnabledOnPasteURL())return void b.insert(e);r.setURL(e);const t=r.show();r.requestPreview(),t.fail((()=>b.insert(e)))}));const i=new s.EmbedBoxFotoCaption({editor:b,$container:h(".js-editor-embed-box-foto-caption")});b.on("paste-foto",(e=>{let{syntax:t,onSuccess:r,thumbnailUrls:n,isUploadError:a}=e;const o=t;i.setFotoExpression(o),i.setThumbnailUrls(n),i.show(a).then((()=>r()))})),v.setup()})),a.YouTubeEmbed.init()}};e.exports=b},87025:(e,t,r)=>{"use strict";var n=o(r(57942)),i=o(r(347)),a=r(70879);function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var l=function(e){return e.RUNNING="running",e.COMPLETED="completed",e.NOT_CREATED="not-created",e.INIT="init",e}(l||{}),d=function(e){return e.COMPLETED="EXPORT_IS_COMPLETED",e.NOT_FINISH_YET="EXPORT_HAS_NOT_FINISH_YET",e.RUNNING="EXPORT_IS_RUNNING",e}(d||{});class u{constructor(e){s(this,"date",null),s(this,"status",l.INIT),this.getExportStatusURL=e.getExportStatusURL,this.reserveURL=e.reserveURL,this.container=e.container,this.panels=e.panels,this.statusToSelector=e.statusToSelector,this.reserveCompletedAt=e.reserveCompletedAt,this.reserveCompletedAtText=e.reserveCompletedAtText,this.successMessage=e.successMessage}fetchStatus(){i.default.get(this.getExportStatusURL).then((e=>{e.data.status===d.COMPLETED?(this.date=e.headers["last-modified"],this.status=l.COMPLETED):e.data.status===d.RUNNING?(this.date=null,this.status=l.RUNNING,setTimeout((()=>{this.fetchStatus()}),1e3)):(this.date=null,this.status=l.NOT_CREATED),this._updated()})).catch((e=>{(0,a.BUG)(e)}))}reserveExport(){this._post(this.reserveURL).then().catch().then((()=>{this.fetchStatus(),this.status=l.RUNNING,this._updated()}))}getStatus(){return this.status}getDate(){const e=this.date;if(!e)return null;const t=Date.parse(e);if(isNaN(t))return null;const r=new Date(t);return[r.getFullYear(),r.getMonth()+1,r.getDate()].join("/")}_post(e){const t=(0,n.default)("rkm"),r=(0,n.default)("rkc");if(!t||!r)return Promise.reject("Failed to retrieve credentials");const a=new FormData;return a.append("rkm",t),a.append("rkc",r),i.default.post(e,a)}_showReserveCompletedAt(){this.reserveCompletedAt.textContent=this.getDate(),""===this.reserveCompletedAt.textContent?this.reserveCompletedAtText.style.display="none":this.reserveCompletedAtText.style.display="inline"}_updated(){const e=this.getStatus();if(this.panels.style.display="none",e===l.INIT)return;const t=this.container.querySelector(this.statusToSelector[e]);if(t instanceof HTMLElement)if(t.style.display="block",this._showReserveCompletedAt(),e===l.COMPLETED){const e=this.container.querySelector(this.statusToSelector.running);if(!(e instanceof HTMLElement))return;e.style.display="none"}else this.successMessage.style.display="none"}}const c={init(){const e=document.querySelector(".js-export-wrapper");if(null===e)return void(0,a.BUG)("container not found");const t=e.querySelector(".js-export-control-panel"),r=e.querySelector(".js-reserve-completed-at"),n=e.querySelector(".js-reserve-completed-at-text"),i=e.querySelector(".js-reserve-export-button"),o=e.querySelector(".js-re-reserve-export-button"),s=document.querySelector(".js-export-success-message"),d=e.getAttribute("data-get-export-status-url");if(null===d||""===d)return void(0,a.BUG)("download URL not found");const c={[l.COMPLETED]:".js-export-completed-wrapper",[l.NOT_CREATED]:".js-reserve-export-wrapper",[l.RUNNING]:".js-exporting-wrapper"},p=new u({container:e,getExportStatusURL:d,panels:t,reserveCompletedAt:r,reserveCompletedAtText:n,reserveURL:e.getAttribute("data-reserve-url"),statusToSelector:c,successMessage:s});i.addEventListener("click",(()=>{p.reserveExport()})),o.addEventListener("click",(()=>{p.reserveExport()})),p.fetchStatus()}};e.exports=c},71771:(e,t,r)=>{"use strict";var n=p(r(65311)),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=c(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(55992)),a=r(70879),o=r(10256),s=p(r(55431)),l=r(21593),d=r(13118),u=r(90847);function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(c=function(e){return e?r:t})(e)}function p(e){return e&&e.__esModule?e:{default:e}}const f=r(99266),h=r(29130),m=r(34525),g=r(69864),v=r(10281),b=r(50825);var y={init:function(){var e=new f,t=new h(e),r=new m,i=(new g(r,e),new v,new u.HatenaIdDataList,new b(e),new o.ShareDraftBox(t),new s.default);const a=document.querySelector(".js-top-placed-entry-container-set.js-role-permits-top-placed-publication");if(a){var c=new d.TopPlacedEntrySwitcher({controller:i,containerSet:a});new l.TopPlacedActivateButtonsHandler({controller:i,switcherPanel:c,entriesView:t})}(0,n.default)(e).on("permissionChanged",(e=>{const t=e.target.permission;this.replaceURLforPermission(t)})),e.reset()},replaceURLforPermission(e){let t;switch(e){case"public":case"all":t=i.httpsAdminUserBlogUrl("/entries");break;case"draft":t=i.httpsAdminUserBlogUrl("/drafts");break;default:return void(0,a.BUG)(new Error(`unexpected permission: ${e}`))}history.replaceState({permission:e},document.title,t)}};e.exports=y},16566:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(347)),i=r(70879),a=r(17187);function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}function s(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class l extends a.EventEmitter{constructor(e,t){super(),s(this,"date",""),s(this,"status","not-created"),this.exportStatusURL=e,this.reserveURL=t}getStatus(){return this.status}getDate(){const e=this.date,t=Date.parse(e);if(isNaN(t))return null;const r=new Date(t);return[r.getFullYear(),r.getMonth()+1,r.getDate()].join("/")}fetchStatus(){n.default.get(this.exportStatusURL,{headers:{"Cache-Control":"no-cache"}}).then((e=>{"EXPORT_IS_COMPLETED"===e.data.status?(this.date=e.headers["last-modified"]||"",this.status="completed"):"EXPORT_IS_RUNNING"===e.data.status?(this.date="",this.status="running",setTimeout((()=>{this.fetchStatus()}),1e3)):(this.date="",this.status="not-created"),this.updated()})).catch((e=>{(0,i.BUG)(e)}))}reserveExport(){n.default.post(this.reserveURL,{},{transformRequest:[n.withEpicRKs,n.formDataRequest]}).then((()=>{this.fetchStatus()}),(()=>{this.fetchStatus()})),this.status="running",this.updated()}updated(){this.emit("updated")}}t.init=()=>{const e=document.querySelector(".js-export-wrapper");if(null===e)return void(0,i.BUG)("container not found");const t=e.querySelectorAll(".js-export-control-panel"),r=e.querySelector(".js-reserve-completed-at"),n=e.querySelector(".js-reserve-export-button"),a=e.querySelector(".js-re-reserve-export-button"),o=document.querySelector(".js-export-success-message"),s=e.getAttribute("data-export-status-url"),d=e.getAttribute("data-reserve-url");if(!s||!d)return void(0,i.BUG)("exportStatusURL or reserveURL not found");const u={"not-created":".js-reserve-export-wrapper",running:".js-exporting-wrapper",completed:".js-export-completed-wrapper"},c=new l(s,d);n.addEventListener("click",(()=>{c.reserveExport()})),a.addEventListener("click",(()=>{c.reserveExport()})),c.on("updated",(()=>{const n=c.getStatus();t.forEach((e=>{e.style.display="none"}));e.querySelectorAll(u[n]).forEach((e=>{e.style.display="block"})),r.textContent=c.getDate(),o.style.display="completed"===n?"block":"none"})),c.fetchStatus()}},34113:(e,t,r)=>{"use strict";var n,i=(n=r(20996))&&n.__esModule?n:{default:n};const a=r(65311),o=r(39338),s={init:function(){this.initRevertButton(),this.initProgressBar(),this.initToggleFotolifeButton()},initRevertButton:()=>{a(".js-revert-import").on("submit",(()=>confirm(i.default.text("admin.import.undo.confirm"))))},initProgressBar:()=>{const e=a(".js-import-progress");if(!e[0])return;const t=e.find(".js-import-bar"),r=e.attr("data-api-url"),n=e.attr("data-on-complete-url");o.init(t,r,n)},initToggleFotolifeButton:()=>{a(".js-toggle-fotolife-import-button").on("click",(e=>{a(e.target).closest(".js-user-blog-import-list-item").toggleClass("is-open")}))}};e.exports=s},7598:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;var n,i=(n=r(65311))&&n.__esModule?n:{default:n},a=r(69152),o=r(68410);t.init=()=>{s(),l()};const s=()=>{(0,i.default)(".js-manage-members-table").on("click",".js-edit-role",(e=>{const t=(0,i.default)(e.currentTarget).parents(".js-member-row");t.find(".js-form-member-update").show(),t.find(".js-member-role").hide()})).on("click",".js-edit-cancel",(e=>{const t=(0,i.default)(e.currentTarget).parents(".js-member-row");t.find(".js-member-role").show(),t.find(".js-form-member-update").hide()}))},l=()=>{const e=document.querySelector(".js-blog-member-user-input");if(!e)return;const t=document.querySelector(".js-blog-member-user-icon");t&&e.addEventListener("input",(e=>{if(!(e.currentTarget instanceof HTMLInputElement))return;const r=e.currentTarget.value;if("string"!=typeof r)return;o.USER_NAME_PATTERN.test(r)?t.setAttribute("src",(0,a.getUserIconUrl)(r)):t.setAttribute("src",a.DEFAULT_USER_ICON_URL)}))}},70954:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;var n,i=(n=r(65311))&&n.__esModule?n:{default:n},a=r(79855),o=r(10256);t.init=()=>{a.EntryListDropdownView.setupCloseHandler(),new a.EntryListDropdownView((0,i.default)(".js-pages-edit-dropdown"));new o.ShareDraftBox((0,i.default)(".js-admin-user-blog-pages")).initEvent()}},73650:(e,t,r)=>{"use strict";var n=r(71900),i=r(73380),a=s(r(67294)),o=s(r(83253));function s(e){return e&&e.__esModule?e:{default:e}}const l={init:()=>{const e=document.querySelector("#profile-cards-container");if(o.default.setAppElement(".admin-wrapper"),e){const t=parseInt(e.getAttribute("data-max-author_urls-count")||"",10);(0,i.safeRender)(a.default.createElement(n.ProfileCardsManager,{maxAuthorURLsCount:t}),e)}}};e.exports=l},65641:(e,t,r)=>{"use strict";var n=r(17565);const i={init:()=>{n.ProxyTest.init(document.querySelector("#proxy-test-container"))}};e.exports=i},79923:(e,t,r)=>{"use strict";var n=r(10256);const i=r(65311);var a={init:function(){new n.ShareDraftBox(i(".admin-user-blog-revisions")).initEvent()}};e.exports=a},99907:(e,t,r)=>{"use strict";const n=r(65311),i=r(36500),a=r(1780),o=r(67279),s={init:function(){n("#subscribe-form").submit((function(){a(n(this))})),i.listenToParent(),o(),n("section input[type=checkbox]").focus()}};e.exports=s},36783:(e,t,r)=>{"use strict";var n,i=(n=r(65311))&&n.__esModule?n:{default:n};const a=r(34418),o={init:()=>{const e=(0,i.default)("#subscribers-table-body");a(e)}};e.exports=o},77573:(e,t,r)=>{"use strict";var n,i=r(60361),a=r(9467),o=(n=r(57942))&&n.__esModule?n:{default:n};const s={init:()=>{(0,o.default)("blog-is-public")&&s.loadBookmarksAndStars()},loadBookmarksAndStars:()=>{const e=document.querySelector("html").getAttribute("data-blog-uuid"),t=document.querySelectorAll(".js-blog-recent-entry"),r=Array.from(t).filter((e=>e.hasAttribute("data-public"))).map((e=>e.getAttribute("data-uuid")));i.bookmarkLoader.loadBlogBookmarksCount(e).then((e=>e.data.count)).then(s.renderBookmarksIntoOverviewTable),a.starLoader.loadBlogStarsCounts(e).then((e=>e.data.total)).then(s.renderStarsIntoOverviewTable),r.length>0&&(i.bookmarkLoader.loadEntriesBookmarksCount(e,r).then((e=>e.data.counts)).then(s.renderBookmarksIntoEntriesTable),a.starLoader.loadEntriesStarsCount(e,r).then((e=>e.data.counts)).then(s.renderStarsIntoEntriesTable))},renderBookmarksIntoOverviewTable:e=>{document.querySelector(".js-blog-bookmarks-count").textContent=e},renderStarsIntoOverviewTable:e=>{document.querySelector(".js-blog-stars-count").textContent=e},renderBookmarksIntoEntriesTable:e=>{const t={};e.forEach((e=>{t[e.entry_id]=e.count}));const r=document.querySelectorAll(".js-entry-bookmarks-count");Array.from(r).forEach((e=>{const r=t[e.getAttribute("data-entry-uuid")];e.textContent=r}))},renderStarsIntoEntriesTable:e=>{const t={};e.forEach((e=>{t[e.entry_id]=e.stars.total}));const r=document.querySelectorAll(".js-entry-stars-count");Array.from(r).forEach((e=>{const r=t[e.getAttribute("data-entry-uuid")];e.textContent=r}))}};e.exports=s},62536:(e,t,r)=>{"use strict";var n=r(36843),i=r(37213),a=s(r(57942)),o=s(r(20996));function s(e){return e&&e.__esModule?e:{default:e}}const l=r(9694),d=r(65311),u=r(56412),c=r(36500),p=r(96371),f={init:function(){o.default.setupTimestampUpdater(),n.GlobalHeaderSubscriber.init(),f.setupBlogList(),f.setupSubscribeBadge(),f.prepareForGlobalHeader(),document.body.classList.contains("page-is-responsive")&&(this.responsiveFooter=new l)},prepareForGlobalHeader:function(){if(window!==window.parent)return null;if(!c.messenger)return null;const e=(0,a.default)("blogs-uri-base"),t=(0,a.default)("blog-name"),r=(0,a.default)("blog-is-public");e&&t&&"index"!==(0,a.default)("page")&&(u.infoLoaded.then((()=>{c.send("showBlogInfo",{blogName:t,blogUri:e,blogIsPublic:r})})),c.addEventListener("blogmenuAdmin",(e=>{const t=d.param({blog:e.blogUri,isEditing:"user-blog-edit"===(0,a.default)("page")?1:0});p.toggle(`/-/menu/blogmenu_admin?${t}`,e,"blogmenu")})))},setupBlogList:function(){const e=d(".js-admin-menu-myblog-list");d(".js-admin-menu-myblog-btn").on("click",(()=>0===e.size()||(e.toggle(),!1))),d(document).on("click",(t=>{d.contains(e,t.target)||e.hide()}))},setupSubscribeBadge:function(){if(window!==window.parent)return null;(0,i.fetchUnreadCount)().then((e=>{if(0===e)return;const t=e>i.UNREAD_COUNT_RESPONSE_MAX?`${i.UNREAD_COUNT_RESPONSE_MAX}+`:`${e}`;d(".js-badge-subscribe").addClass("visible").text(t),d(".js-badge-subscribe-notifier").show()}))}};e.exports=f},19778:(e,t,r)=>{"use strict";a(r(57942)),a(r(20996));var n=r(92687),i=r(17235);function a(e){return e&&e.__esModule?e:{default:e}}var o=r(65311);r(92901);var s={init:function(){(0,i.attachSubscriptionConfig)(document,".js-subscription");(0,n.renderRecommendation)({rootId:"js-recommendation-root",attrName:"recommendation",targetListElementSelector:".js-recommendation-insertion-container"}).catch((()=>{})),o(".entry-unit-older-post").each((function(){var e;(e=o(this)).find("li.posts"),e.find("li.more")})),o(".js-subscription").on("click",".js-read-more",(function(e){var t=o(this);t.siblings(".js-older-entry-unit:hidden").slideToggle("fast"),t.addClass("is-hidden")}))}};e.exports=s},83404:(e,t,r)=>{"use strict";var n,i=(n=r(56882))&&n.__esModule?n:{default:n};var a=r(65311),o={init:function(){a(".membership-category").each(((e,t)=>{var r=a(t),n=r.find(".membership-category-select"),o=n.find("option:selected").val(),s=r.find(".indicator");n.change((e=>{i.default.updateMembershipCategory(n).done((e=>{s.find(".success").show(),s.find(".fail").hide()})).fail((()=>{n.val(o),s.find(".success").hide(),s.find(".fail").show()}))}))}))}};e.exports=o},90594:(e,t,r)=>{"use strict";var n=r(34914),i=r(78899),a=r(65311),o={init:function(){(0,i.updateDynamicPieces)(a("#user-config")),(0,n.initializeFlagVariantsConfigIfApplicable)(document.getElementById("admin-config-flag_variants-root"))}};e.exports=o},1640:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;t.init=()=>{r(),n()};const r=()=>{const e=document.querySelector(".js-blogs-dropdown"),t=document.querySelector(".js-switch-blog");t?.addEventListener("click",(()=>{if(!e?.value)return;const t=new URL(window.location.href);t.searchParams.set("blog",e.value),t.searchParams.delete("page"),window.location.assign(t.toString())}))},n=()=>{const e=Array.from(document.querySelectorAll(".js-confirmation-checkbox")),t=document.querySelector("#js-check-all");t?.addEventListener("click",(()=>{for(const r of e)r.checked=t.checked}))}},23606:(e,t,r)=>{"use strict";const n=r(65311),i=r(36500),a={init:function(){i.listenToParent(),n(".close").on("click",(e=>(i.send("close",{name:window.name}),!1)))}};e.exports=a},11229:(e,t,r)=>{"use strict";var n,i=r(93358),a=r(65939),o=r(70879),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=c(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(55992)),l=(n=r(57942))&&n.__esModule?n:{default:n},d=r(33671),u=r(37213);function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(c=function(e){return e?r:t})(e)}const p=r(65311),f=r(59662),h=r(74350),m=r(56412),g=(r(92901),{init:function(){Messenger.listenToParent(),(0,a.initGlobalHeaderEventTracker)();const e=location.hostname.match(/\.hatena\.[^:]+/)[0];var t=p("#header"),r=p("#header-services"),n=p("#header-notify"),s=p("#header-unread");const c=decodeURIComponent(location.hash.substring(1)),v=`${(0,l.default)("admin-origin")}/go?blog=${encodeURIComponent(c)}`;var b;if(document.cookie.match(/\brk=/)?b=p.ajax({type:"get",dataType:"json",url:`https://www${e}/notify/notices.count.json`,data:{services:1},xhrFields:{withCredentials:!0}}):(b=p.Deferred()).reject(),!f.isIE){const e=document.body.getAttribute("data-color");g.renderDropdown(e)}t.delegate(".header-dropdown",{keypress:e=>{13===e.which&&(p(e.currentTarget).click(),e.preventDefault(),e.stopPropagation())},mouseup:e=>{e.currentTarget.blur()}}),t.find("a.new-entry").on("click",(()=>(Messenger.send("new-entry",{}),(0,a.trackGlobalHeaderClick)("new-entry"),!1))),r.find(".header-dropdown").on("click",(t=>{const r=p(t.currentTarget);return b.done((t=>{Messenger.send("servicesmenu",{BASE:e,right:r.offset().left+r.width(),info:t,location:v})})),(0,a.trackGlobalHeaderClick)("services-dropdown"),!1})),n.find(".header-dropdown").on("click",(t=>{const r=p(t.currentTarget);return Messenger.send("notify",{BASE:e,left:r.offset().left}),n.find(".notify-count").text("").hide(),(0,a.trackGlobalHeaderClick)("notify-dropdown"),!1})),b.done((e=>{e.count>0?n.find(".notify-count").text(e.count).show():n.find(".notify-count").text("").hide()})),b.done(h),(0,l.default)("rkm")&&(0,l.default)("rkc")&&(0,u.fetchUnreadCount)().then((e=>{0!==e&&s.find(".unread-count").show()})),m.loadInfo().done((r=>{g.initQuoteStock(r);var n=p("#header-my");n.on("click",(()=>(Messenger.send("mymenu",{BASE:e,right:n.offset().left+n.width()}),!1))),"blogs"===t.attr("data-page-category")&&(r.is_public||p(".js-blog-private-badge").show(),r.blog_name&&(p("#current-blog .current-blog-title").append(document.createTextNode(r.blog_name)),p("#current-blog .current-blog-title").attr("href",r.blog_url)),g.initBlogDropdown(e)),"admin"===t.attr("data-page-category")&&g.initAdminDropdown()})),Messenger.addEventListener("visitorAttribute",i.respondOnVisitorAttributeEvent),Messenger.addEventListener("inheritVia",(e=>{(0,o.LOG)(["inheritVia",e]),(0,d.inheritVia)(e)})),Messenger.addEventListener("newEntryGeometry",(()=>{const e=p("a.new-entry"),t=e.offset();Messenger.send("newEntryGeometry",{top:t.top,left:t.left,height:e.height(),width:e.width()})}))},coloringSvgHeader:function(e,t){e.onload=null;try{var r=document.body.getAttribute("data-color");p(e).find("path").attr("fill",r)}catch(e){(0,o.BUG)(e,"render logo")}t(p(e))},renderDropdown:function(e){var t=new Image;t.crossOrigin="Anonymous",t.src=s.staticUrl("/images/header/dropdown@2x.png"),t.onload=()=>{try{t.onload=null;var r=document.createElement("canvas");if(r.setAttribute("width",24),r.setAttribute("height",24),!r.getContext)return;var n=r.getContext("2d");if(n.drawImage(t,0,0),n.globalCompositeOperation="source-in",n.fillStyle=e,n.fillRect(0,0,24,24),!r.toDataURL)return;var i=r.toDataURL(),a=document.createElement("style");a.setAttribute("type","text/css"),a.appendChild(document.createTextNode(`\n          #header span.header-dropdown,\n          #header span.header-dropdown-custom {\n              background: url(${i}) center right no-repeat; background-size: 12px 12px;\n          }\n        `)),document.body.appendChild(a)}catch(e){(0,o.BUG)(e,"render logo dropdown"),t.src=s.staticUrl("/images/header/dropdown.gif")}}},initAdminDropdown:function(){const e=p("#current-blog"),t=e.find(".current-blog-title");Messenger.addEventListener("showBlogInfo",(r=>{e.show(),t.text(r.blogName),r.blogIsPublic||p(".js-blog-private-badge").show(),p(".service-menu .edit").hide(),p(".service-menu .admin-blog").show(),p("#current-blog .current-blog-title").attr("href",r.blogUri),p("#current-blog, #my-blogs").on("click",(e=>{const t=p(e.currentTarget);return Messenger.send("blogmenuAdmin",{left:t.offset().left,blogUri:r.blogUri}),(0,a.trackGlobalHeaderClick)("current-blog-title-in-admin"),!1}))}))},initBlogDropdown:function(e){p("#current-blog").show(),p("#current-blog, #my-blogs").on("click",(t=>{const r=p(t.currentTarget);return Messenger.send("blogmenu",{BASE:e,left:r.offset().left}),(0,a.trackGlobalHeaderClick)("current-blog-title-in-blogs"),!1}))},initQuoteStock:function(){Messenger.addEventListener("stockQuote",(e=>{e.uri&&e.selected_text||Messenger.send("failStockQuote",{}),p.ajax({url:"/api/quotes",data:{uri:e.uri,body:e.selected_text,rkm:(0,l.default)("rkm"),rkc:(0,l.default)("rkc")},cache:!1,type:"post",dataType:"json"}).done((e=>{Messenger.send("successStockQuote",{res:e})})).fail((e=>{Messenger.send("failStockQuote",{res:e})}))})),Messenger.addEventListener("quote-edit-entry",(()=>{Messenger.send("new-entry-with-quote")})),Messenger.addEventListener("requote-edit-entry",(e=>{try{localStorage.setItem("ReQuote",JSON.stringify(e.quote))}catch(e){}Messenger.send("new-entry-with-requote")}))}});e.exports=g},91602:(e,t,r)=>{"use strict";a(r(20996));var n=r(17235),i=a(r(45288));function a(e){return e&&e.__esModule?e:{default:e}}r(65311);const o=r(67294),s=r(73935),l=r(91269),d=r(11596);var u={init:function(){(0,n.attachSubscriptionConfig)(document,".js-subscription");const e=l.get("admin.myblogs"),t=l.get("admin.should_link_to_blogmedia_registration_form");s.render(o.createElement(d,{blogs:e,shouldLinkToBlogmediaRegistrationForm:t}),document.querySelector("#myblogs")),s.render(o.createElement(i.default,{limit:5}),document.querySelector("#subscribing-blogs"))}};e.exports=u},90487:(e,t,r)=>{"use strict";var n,i=(n=r(20996))&&n.__esModule?n:{default:n};var a=r(65311),o=r(36500),s=r(67279),l={init:function(){o.listenToParent(),a("#locale-window a").on("click",(function(){var e=a(this).attr("data-lang");return i.default.setAcceptLang(e),o.send("reload"),!1})),s()}};e.exports=l},50068:(e,t,r)=>{"use strict";const n=r(36500),i=r(67279);var a={init:function(){n.listenToParent(),i(),n.send("init")}};e.exports=a},43e3:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;var n,i=r(75809),a=r(73380),o=(n=r(67294))&&n.__esModule?n:{default:n};t.init=()=>{const e=document.getElementById("js-notifications-root");e&&(0,a.safeRender)(o.default.createElement(i.NotificationsContainer,null),e)}},37320:(e,t,r)=>{"use strict";var n=r(43614),i={init:function(){n.init()}};e.exports=i},68156:(e,t,r)=>{"use strict";var n,i=(n=r(57942))&&n.__esModule?n:{default:n};const a=r(65311);var o={init:function(){if((0,i.default)("name")){var e,t;e=(0,i.default)("name").toLowerCase().replace(/_/,"-"),""===(t=a("input[name=id]")).val()&&t.val(e)}}};e.exports=o},19557:(e,t,r)=>{"use strict";var n,i=(n=r(57942))&&n.__esModule?n:{default:n};const a=r(65311),o=r(66419),s={init:function(){if((0,i.default)("name")){var e=s;e.submitButton=a("input[type=submit]");var t=a(':input[name="domain"]'),r=a('input[name="id"]');e.STATES={progress:{className:"progress",message:a(".domain-check-message.progress")},available:{className:"check",message:a(".domain-check-message.check")},unavailable:{className:"error",message:a(".domain-check-message.error")},invalid:{className:"invalid",message:a(".domain-check-message.invalid")},invalidLength:{className:"invalid-length",message:a(".domain-check-message.invalid-length")}},e.inputValidStates={id:!0,import:!0};var n=function(){var n=r.val(),i=t.val();if(n)if(n.length<2||n.length>32)s.changeAvailabilityState({nextState:"invalidLength"});else if(s.isValidBlogID(n)){var o=a("[data-brand-name]").attr("data-brand-name");a.ajax({url:"/api/blog/domain_registry",dataType:"json",data:{blog_ids:JSON.stringify([n]),brand_name:o}}).done((t=>{var r=t[n];void 0!==r&&e.checkBlogIdAvailability({blogID:n,topdomain:i,statuses:r})}))}else s.changeAvailabilityState({nextState:"invalid"})};n(),t.change(n),r.keyup(o.debounce(n,1e3)).keyup((()=>{e.changeAvailabilityState({nextState:"progress"})}));var l,d;l=(0,i.default)("name").toLowerCase().replace(/_/,"-"),d=a("[data-brand-name]").attr("data-brand-name"),a.ajax({url:"/api/blog/domain_registry",dataType:"json",data:{blog_ids:JSON.stringify([l]),brand_name:d}}).done((e=>{var t=e[l];void 0!==t&&null!==typeof t||(t={});var r=s.availableDomains(t);if(o.any(r)){var n=a(':input[name="domain"]'),i=n.val();o.include(r,i)||n.val(r[0]);var d=a("input[name=id]");""===d.val()&&(d.val(l),s.changeAvailabilityState({nextState:"available"}))}})),a("input[name=import]").length&&(a("input[name=permission],input[name=import]").change((()=>{e.changeImportAvailabilityState()})),a(".import-error").hide(),e.changeImportAvailabilityState())}},changeAvailabilityState:function(e){var t=s,r=e.nextState;t.inputValidStates.id="unavailable"!==r&&"invalid"!==r&&"invalidLength"!==r,t.changeSubmitButtonState(),o.each(s.STATES,((e,t)=>{t===r?e.message.show():e.message.hide()}))},checkBlogIdAvailability:function(e){var t=e.topdomain,r=e.blogID,n=e.statuses,i=n[t],a=s.availableDomains(n);"unavailable"===i&&(o.any(a)?s.suggestAlternativeDomainNames({blogID:r,availableDomains:a}):s.unsuggestAlternativeDomainNames()),s.changeAvailabilityState({nextState:i})},suggestAlternativeDomainNames:function(e){var t=e.blogID,r=e.availableDomains,n=a(".domain-recommend"),i=a(':input[name="domain"]');a(".requested-blog-id").text(t),n.find("ul").detach();var s=a("<ul/>");o.each(r,(e=>{a("<li/>").text(`${t}.${e}`).click((()=>{i.val(e).change()})).appendTo(s)})),n.append(s).show()},unsuggestAlternativeDomainNames:function(e){var t=a(".domain-recommend");t.find("ul").detach(),t.hide()},availableDomains:function(e){var t=o.keys(e);return o.select(t,(t=>"available"===e[t]))},changeImportAvailabilityState:function(e){var t=s,r=a("input[name=permission]:checked"),n=a("input[name=import]:checked"),i=r.val(),o=n.attr("data-permission"),l=a(".import-error");"private"===o&&"public"===i?(l.show(),t.inputValidStates.import=!1,t.changeSubmitButtonState()):(l.hide(),t.inputValidStates.import=!0,t.changeSubmitButtonState())},changeSubmitButtonState:function(e){var t=s,r=t.submitButton;o.every(t.inputValidStates,(e=>e))?(r.attr("disabled",!1),r.removeClass("disabled"),r.addClass("btn-blue")):(r.attr("disabled",!0),r.removeClass("btn-blue"),r.addClass("disabled"))},isValidBlogID:function(e){return/^[a-z0-9][a-z0-9-]{0,30}[a-z0-9]$/.test(e)&&!/--/.test(e)&&e.length>=2}};e.exports=s},52966:(e,t,r)=>{"use strict";const n=r(65311);var i={init:function(){var e=n(".available-licenses"),t=n(".show-more").find("a");e.hide(),t.on("click",(r=>{"1"===e.attr("data-collapsed")?(e.show(),e.attr("data-collapsed",0),t.text(t.attr("data-collapse-message"))):(e.hide(),e.attr("data-collapsed",1),t.text(t.attr("data-expand-message"))),r.preventDefault()})),n(".deed").hide(),n(".show-deed").on("click",(function(e){return n(n(this).attr("data-target-selector")).toggle(),!1})),!1===n("input[name=license]:checked").is(":visible")&&t.click()}};e.exports=i},29106:(e,t,r)=>{"use strict";var n,i=(n=r(83092))&&n.__esModule?n:{default:n};const a=r(65311);var o={init:function(){var e=o;e.$themeContainer=a("#store-container"),e.$installDialog=a(".blog-title-dropdown-window"),e.$installButton=a("#sidebar").find(".install-theme-btn"),e.$installDialog.hide(),e.$installButton.click((()=>{e.$installDialog.slideToggle()})),new i.default(a("#theme-detail-tabs"))}};e.exports=o},86260:(e,t,r)=>{"use strict";var n,i=(n=r(83092))&&n.__esModule?n:{default:n};const a=r(65311),o={init:function(){var e=a(".description"),t=a("#topic-entries-tabs");e.find(".read-more").on("click",(t=>{t.preventDefault();var r=e.find(".read-more-text");e.html(r.html())})),new i.default(t)}};e.exports=o},210:(e,t,r)=>{"use strict";const n=r(36500),i={init:function(){n.listenToParent();var e=document.getElementById("posted").value;n.send("update",{comment:e}),n.send("close")}};e.exports=i},23786:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=function(){(0,n.setupTextareaHider)(),(0,i.setupTouchHeaderImageComponent)({$container:a(".js-header-image-container"),previewUpdater:null})};var n=r(69503),i=r(37448);const a=r(65311)},1008:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;var n,i=(n=r(65311))&&n.__esModule?n:{default:n};var a=r(1780);t.init=()=>{const e=document.querySelector('input[name="custom-domain_https_confirmation-checkbox"]'),t=(0,i.default)(".js-blog-config-detail-form");if(t.on("submit",(()=>{a(t)})),!e)return;const r=document.querySelector("#custom_host");if(!r)throw new Error("[BUG] custom_host input not found");e.addEventListener("change",(e=>{r.disabled=!e.target.checked}))}},38642:(e,t,r)=>{"use strict";var n,i=(n=r(65311))&&n.__esModule?n:{default:n},a=r(55248);const o={init:function(){new a.BlogPermission((0,i.default)("#blog-permission-container"))}};e.exports=o},71950:(e,t,r)=>{"use strict";var n,i=r(91298),a=(n=r(83092))&&n.__esModule?n:{default:n};const o=r(65311),s={init:function(){var e=o("#access-counts").remove(),t={};e.find("tr").each((function(){var e=o(this),r=+e.find("td[data-time]").attr("data-time"),n=+e.find("td[data-count]").attr("data-count");t[r]=n})),i.AccessLogViewer.showGraph(t,{parent:o("#access-counts-daily"),timeformat:"%m/%d",minTickSize:[1,"day"],unit:864e5,number:14,graphAreaMarginRight:20,barWidth:15}),i.AccessLogViewer.showGraph(t,{parent:o("#access-counts-hourly"),timeformat:"%d %H:%M",minTickSize:[1,"hour"],unit:36e5,number:24,graphAreaMarginRight:20,barWidth:10});new a.default(o("#access-counts-tabs"));o(".summary-box .hosts").delegate(".host","click",(function(){o(".summary-box .hosts .selected").removeClass("selected"),o(this).addClass("selected");var e=o(this).attr("data-site-host");return o(".summary-box .site.selected").removeClass("selected"),o(".summary-box .sites").find(`*[data-site-host="${e}"]`).addClass("selected"),!1}))}};e.exports=s},37764:(e,t,r)=>{"use strict";const n=r(65311),i=r(36500);var a={init:function(){i.listenToParent(),i.send("resize",{height:n(document.body).height()})}};e.exports=a},53457:(e,t,r)=>{"use strict";const n=r(65311),i=r(36500),a=r(67279),o=r(1780);var s={init:function(){i.listenToParent(),n(".g-recaptcha").length>0?window.outerWidth<340?i.send("resize",{width:"100%",left:"0",height:600}):i.send("resize",{height:600}):a();var e=n("form#comment-form");e.on("submit",(()=>{o(e)}))}};e.exports=s},50455:(e,t,r)=>{"use strict";var n=r(50968),i={init:function(){(0,n.initComments)()}};e.exports=i},45319:(e,t,r)=>{"use strict";var n=m(r(27484)),i=r(50287),a=r(33918),o=r(36524),s=r(1889),l=r(96140),d=r(10714),u=m(r(57942)),c=r(71412),p=m(r(83902)),f=r(48923),h=m(r(347));function m(e){return e&&e.__esModule?e:{default:e}}const g=r(65311),v=r(66419),b=r(56663),y=r(83391),_=r(30546),{extractFotolifeSyntax:w}=r(97050),E=()=>{const e=g("input[name=datetime]"),t=g(".js-datetime-input-date"),r=g(".js-datetime-input-time"),n=e.val();if(!n)return;const i=n.match(/^(\d{4}-\d{2}-\d{2})T(\d{2}:\d{2}(:\d{2})?)$/);if(i){const e=i[1],n=i[2];t.val(e),r.val(n)}e.trigger("change")},S={init:function(){this.$editEntry=g("#edit-entry");const e=g("#edit-form");this.editor=(0,s.createEditor)(this.getSyntax());const t=document.querySelector(".js-toolbar");t&&(this.toolbar=new o.Toolbar(t,this.editor)),(0,l.registerHTMLEditorTabButtons)({editor:this.editor,editorContainer:document.querySelector(".js-editor-container"),wysiwygEditorButton:document.querySelector(".js-wysiwyg-editor-button"),sourceEditorButton:document.querySelector(".js-source-editor-button")}),b.init(S.uploadDone),S.setupMyCuration(),S.setupCurationButton(),S.setUpPromotionCheck(),S.setupPromotionAnkerStop(),S.setupAccordionToggles(),S.setupCustomUrlUniqueCheck(e),S.setupScheduledEntry(),S.dateTimeEditorEnabled()&&y(),e.on("backup-restore-params",E),new _(g(".js-touch-edit-socialize-box-li.twitter")),new p.default,this.preview=new a.Preview(e[0]),(0,i.createBackupMessage)(e);const r=document.querySelector(".js-scheduled-update-existing-notice");if(r){const e=document.querySelector(".js-app-element");(0,f.initScheduledUpdateExistingNotice)(r,e)}e.find(".custom-url-input input").on("keydown",(e=>{if("RET"===keyString(e))return!1})),e.find(".edit-title input").on("keydown",(e=>{if("RET"===keyString(e))return!1})),S.setupAnnouncement()},setupAccordionToggles:function(){const e=document.querySelectorAll(".js-post-accordion-item");Array.from(e).forEach((e=>{const t=e.querySelector(".js-post-accordion-toggle"),r=e.querySelector(".js-post-accordion-content");t.addEventListener("click",(n=>{n.preventDefault(),n.stopPropagation(),e.classList.toggle("is-open"),r.classList.toggle("is-open"),window.scroll(0,window.scrollY+t.getBoundingClientRect().top)}))}))},setupCustomUrlUniqueCheck:function(e){const t=e.find(".custom-url-input input"),r=e.find(".js-custom-url-duplicate-warning");t.on("blur",(t=>{if(!t.target.value)return;const n=e.find("input[name=entry]").val();h.default.get("/api/1/json/custom_url",{params:{custom_url:t.target.value,entry_id:n,blog_id:(0,u.default)("blog-uuid"),rkm:(0,u.default)("rkm"),rkc:(0,u.default)("rkc")}}).then((e=>{e.data.isExisting?r.show():r.hide()})).catch((()=>{}))}))},uploadDone:function(e){"html"===S.getSyntax()?w(e).done((e=>{S.editor.insert(e.html)})):S.editor.insert(`[${e.replace(/:image/,":plain")}]`)},setupMyCuration:function(){g("[data-curation-action]").click((function(){const e=(0,u.default)("blog-uuid");console.log(e);const t=g(this).attr("data-curation-action");d.EditorConnector.loadServiceOnChildWindow(`/-/curation/${t}?blog_id=${e}`)}))},setupCurationButton:function(){const e=document.querySelector(".js-curation-toolbar-toggle-button");e?.addEventListener("click",S.toggleCurationToolbar)},toggleCurationToolbar:function(){const e=document.querySelector(".js-curation-toolbar"),t=document.querySelector(".js-curation-toolbar-toggle-button");e.classList.toggle("is-visible"),t.classList.toggle("is-active")},setUpPromotionCheck:function(){g("#promotion-check").click((function(){const e=g(this).attr("data-promotion-id");d.EditorConnector.loadServiceOnChildWindow(`/-/curation/promotion?ref=${e}`)}))},setupPromotionAnkerStop:function(){g(".promotion-button a").click((e=>{e.preventDefault()}))},dateTimeEditorEnabled:function(){const e=v.map(["date","time"],(e=>{const t=document.createElement("input");return t.setAttribute("type",e),t.setAttribute("value","not-a-date"),"text"!==t.type&&"not-a-date"!==t.value}));return v.all(e)},setupScheduledEntry:()=>{const e=g("input[name=datetime]"),t=g("input[name=is_scheduled_entry]"),r=g(".js-schedule-post-button"),i=g(".js-show-on-normal-post"),a=g(".js-show-on-scheduled-post"),o=document.querySelector(".js-touch-scheduled-socialize-box"),s=e=>!!e&&(0,n.default)(e).isAfter((0,n.default)()),l=()=>{s(e.val())&&r.prop("checked")?(i.hide(),a.show(),o.classList.add("is-open")):(i.show(),a.hide(),o.classList.remove("is-open"))},d=()=>{s(e.val())?(r.prop("disabled",!1),t.val(["1"])):(r.prop("disabled",!0),t.val(["0"])),l()};t.on("change",l),e.on("change",d),d()},getSyntax:()=>document.querySelector('input[name="syntax"]').value,setupAnnouncement:()=>{const e=document.querySelector("#js-editor-announcement-container");e&&(0,c.renderAnnouncement)(e,!0)}};e.exports=S},48083:(e,t,r)=>{"use strict";const n=r(65311);var i={init:function(){n("ul#entries li").click((function(e){0===n(e.target).parents("a").length&&(location.href=n(this).find("a:first").attr("href"))}))}};e.exports=i},46284:(e,t,r)=>{"use strict";var n,i=(n=r(65311))&&n.__esModule?n:{default:n};const a=r(34418),o={init:()=>{const e=(0,i.default)("#subscribers-table-body");a(e)}};e.exports=o},48056:(e,t,r)=>{"use strict";var n=r(36843),i=o(r(65311)),a=o(r(20996));function o(e){return e&&e.__esModule?e:{default:e}}const s=r(1493),l={init:function(){a.default.setupTimestampUpdater(),(0,i.default)("label").on("click",(()=>{})),s.init(),Messenger.messenger&&(0,n.initForGlobalHeaderNextGeneration)()}};e.exports=l},80004:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;var n=r(92687);t.init=()=>{(0,n.renderRecommendation)({rootId:"js-recommendation-root",attrName:"recommendation",targetListElementSelector:".js-recommendation-insertion-container"}).catch((()=>{}))}},61531:(e,t,r)=>{"use strict";var n,i=r(34914),a=(n=r(65311))&&n.__esModule?n:{default:n},o=r(78899);const s={init:function(){(0,o.updateDynamicPieces)((0,a.default)("#user-config")),(0,i.initializeFlagVariantsConfigIfApplicable)(document.getElementById("admin-config-flag_variants-root"))}};e.exports=s},40074:(e,t,r)=>{"use strict";var n,i=(n=r(57942))&&n.__esModule?n:{default:n},a=r(93358),o=r(65939);const s=r(65311),l=r(36500),d=r(56412),u={init:function(){l.listenToParent(),(0,o.initGlobalHeaderEventTracker)(),d.loadInfo().done(((e,t)=>{u.initSubscribe(e),u.initQuoteStock(e)})),l.addEventListener("visitorAttribute",a.respondOnVisitorAttributeEvent)},initSubscribe:function(e){if(e.blog&&!e.can_open_editor&&!e.subscribe&&!e.force_pc_view){var t=s(".js-subscribe-container"),r=t.find(".js-subscribe-link");if(e.subscribe_url){const t=new URL(e.subscribe_url);t.searchParams.set("from_url",e.blog),t.searchParams.set("utm_source","globalheader_touch"),t.searchParams.set("utm_medium","button"),t.searchParams.set("utm_campaign","subscribe_blog"),r.attr("href",t.href)}t.show()}},initQuoteStock:function(e){l.addEventListener("stockQuote",(e=>{e.uri&&e.selected_text||l.send("failStockQuote",{}),s.ajax({url:"/api/quotes",data:{uri:e.uri,body:e.selected_text,rkm:(0,i.default)("rkm"),rkc:(0,i.default)("rkc")},cache:!1,type:"post",dataType:"json"}).done((e=>{l.send("successStockQuote",{res:e})})).fail((e=>{l.send("failStockQuote",{res:e})}))})),l.addEventListener("quote-edit-entry",(e=>{void 0!==e.quote&&localStorage.setItem("reQuote",JSON.stringify(e.quote)),l.send("new-entry-with-quote",{})}))}};e.exports=u},82848:(e,t,r)=>{"use strict";var n;(n=r(20996))&&n.__esModule;const i=r(65311),a=r(74350),o={init:function(){var e=i("#admin-top-tab"),t=i("#admin-top-tab .js-nav-tab"),r=i("#config-container > .js-section"),n=!1;i(window).load((()=>{n=!0})),t.click((function(){var a=i(this);t.removeClass("selected"),t.find("a img").each((function(){/-selected/.test(this.src)&&(this.src=this.src.replace(/-selected/,""))})),r.hide();var o=a.find("a");a.addClass("selected"),o.find("img").each((function(){this.src=this.src.replace(/\.([^./]+)$/,"-selected.$1")}));var s=r.filter(o.attr("href"));if(s.show(),e.trigger("tabsactivate",{panel:{id:s.attr("id")}}),"replaceState"in history&&n){var l=o.attr("href").match(/(#.+)/)[0];l&&history.replaceState(null,document.title,l)}return!1}));var s=location.hostname.match(/\.hatena\.[^:]+/)[0],l=i(".js-notify-count").hide();i.ajax({type:"get",dataType:"json",url:`https://www${s}/notify/notices.count.json`,xhrFields:{withCredentials:!0},success:e=>{e.count&&l.text(e.count).show(),a(e)}}),e.on("tabsactivate",((e,t)=>{if("notify"===t.panel.id){l.hide();var r=i("#notify").empty(),n=`https://www${s}/notify/notices.iframe?${(new Date).getTime()}`;i('<iframe style="width: 100%; height: 340px; margin: 0; padding: 0" frameborder="0"/>').attr("src",n).appendTo(r)}}));var d=t.filter((function(){return 0!==i(this).find("a").filter((function(){return i(this).attr("href")===location.hash})).length}));(d.length?d:t.eq(0)).click(),o.getDashboardData()},getDashboardData:function(){i.ajax({type:"GET",url:"/-/dashboard_data",data:{device:"touch"}}).done((e=>{i("#subscribe").append(e.subscribing_blogs)}))}};e.exports=o},91242:(e,t,r)=>{"use strict";var n,i=(n=r(20996))&&n.__esModule?n:{default:n};const a=r(65311),o=r(37914),s={init:function(){a("a.js-set-language").on("click",(function(){var e=a(this).attr("data-lang");return i.default.setAcceptLang(e),location.href=o.param("location")||"/",!1}))}};e.exports=s},64881:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=function(){const e=new URL(window.location.href).searchParams.get("ref");n("#promotion-entry").click((t=>{const r=t.target.getAttribute("data-keyword"),n=t.target.getAttribute("data-fillin-id");n?window.location.href=`${e}edit?fill_in=${encodeURIComponent(n)}`:r&&(window.location.href=`${e}edit?body=${encodeURIComponent(r)}`)}))};const n=r(65311)},57404:(e,t,r)=>{"use strict";var n=r(43614),i={init:function(){n.init()}};e.exports=i},9126:(e,t,r)=>{"use strict";var n=r(36843),i=r(57525),a=r(6636),o=(m(r(59662)),function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=h(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(55992))),s=m(r(57942)),l=m(r(38600)),d=m(r(20996)),u=r(46955),c=r(56866),p=r(58430),f=r(78899);function h(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(h=function(e){return e?r:t})(e)}function m(e){return e&&e.__esModule?e:{default:e}}const g=r(65311),v=r(66419),b=r(36500),y=r(35652),_=r(32920),w=r(37914),E=r(56412),S=r(8659),C=r(10912),P=r(40793),k=r(75781),O=r(30618),M=r(23249),x=r(90757);var j={hasInfoLoaded:!1,init:function(){window.parent===window&&a.AccessLogger.ping(),E.infoLoaded.then((e=>{j.infoLoaded(e),e.quote&&y.quoteInfoLoaded(e.quote)})),(0,f.updateDynamicPieces)(g(document)),g(document).on("click","img.hatena-fotolife, img.magnifiable, img.http-image",(e=>{const t=e.currentTarget,r=g(t);if(r.data("colorbox"))return;const n=r.closest("a").get(0);return n&&n.href!==t.src?void 0:(r.colorbox({maxWidth:"95%",maxHeight:"95%",transition:"none",photo:!0,href:r.attr("src"),title:" ",open:!0,opacity:.85}),g("#cboxContent").on("click",(()=>{g.colorbox.close()})),!1)})),k.init(),n.GlobalHeaderSubscriber.init(),j.setupOndemandCommentDeleteButton(),j.highlightKeyword(),x.init(),i.YouTubeEmbed.init(),(0,c.setupBlogcardTrackingMessageReceiver)(),(0,p.insertSleepingAdInEntry)(),(0,p.insertAdInEntry)()},highlightKeyword:function(){const e=w.params();if(!e||!e.q)return;const t=g(".search-result").data("searchQueries");t&&(g(".entry-title").highlight(t,{caseSensitive:!1}),g(".entry-description").highlight(t,{caseSensitive:!1}))},infoLoaded:function(e){if(j.hasInfoLoaded)return;j.hasInfoLoaded=!0;const t=w.param("via");if(t&&b.send("inheritVia",t),e.message&&_(e.message),l.default.resolve(!e.cookie_received),g("article.entry:not(.no-entry)").each(((e,t)=>{C.initEntry(g(t))})),e.editable){let e,t;const r=g("<div>").addClass("entry-header-menu");const n='article.entry[data-publication-type="entry"]';g(document).on("mouseenter",n,(n=>{var i=g(n.currentTarget);i.is(e)?clearTimeout(t):(e=i,e.attr("data-uuid")&&r.empty().append((e=>{const t=e.attr("data-uuid"),r=(0,s.default)("author"),n=(0,s.default)("blog"),i=o.protocolRelativeAdminUrl(`/${r}/${n}/edit?entry=${t}`);return g(`<a href="${i}">${d.default.text("edit")}</a>`)})(e)).appendTo(e.find(".entry-header")).show())})),g(document).on("mouseleave",n,(()=>{clearTimeout(t),t=setTimeout((()=>{e=null,r.fadeOut("fast")}),2e3)})),"index"===(0,s.default)("page")&&!w.param("preview")&&g("#globalheader").is(":visible")&&j.setupFirstEntry(),S();const i=g(".sleeping-ads-notice");i.length>0&&i.show(),g(".js-no-entry").length&&(g(".js-no-entry-message").hide(),g(".js-welcome-message").show())}if(e.should_show_invitation_pc_link){const e=g(".js-guide-register");e.attr("style","display: block !important;"),e.find(".js-inherit-ga").each(((e,t)=>{const r=g(t),n=r.attr("href"),i=(0,u.inheritGA)(location.href,n);r.attr("href",i)}))}j.setupHatenaBookmarkComment(g("#container")),j.setupEntryModuleCarousel(),M.init(e.subscribe,e.subscribes),e.is_public&&new O},setupFirstEntry:function(){g(".entry-content").show();const e=g(".welcome-tooltip-newentry");e.on("click",(()=>C.newEntry({openedFrom:"welcome-tooltip"}))),b.send("newEntryGeometry"),b.addEventListener("newEntryGeometry",(t=>{e.offset({left:t.left+t.width/2-e.outerWidth()/2}),e.show()}))},elementDidAppear:function(e){const t=g.Deferred(),r=g(window);return r.scrollTop()>g(e).offset().top-r.height()?t.resolve():r.on("scroll",v.throttle((()=>{r.scrollTop()>g(e).offset().top-r.height()&&t.resolve()}),200)),t.promise()},setupHatenaBookmarkComment:function(e){var t=e.find(".hatena-bookmark-comment-iframe");0!==t.size()&&v.each(t,(e=>{const t=g(e);b.createForFrame(e,t.attr("data-src")).addEventListener("resize",(e=>{t.css("height",e)}))}))},setupOndemandCommentDeleteButton:function(){g(document).on("mouseenter",".entry-comment",(e=>{const t=g(e.currentTarget);if(t.find(".comment-delete-button img").size()>0)return;const r=(0,s.default)("admin-domain"),n=g.param({comment:t.attr("data-comment-uuid"),blog:t.attr("data-blog-uuid")}),i=g(`<img src="${`${r}/api/comment.delete.image?${n}`}" />`);i.on("load error",(()=>i.attr("alt","delete"))),t.find(".comment-delete-button").append(i)}))},setupEntryModuleCarousel:function(){var e=g(document).find('script[type="text/x-hatenablog-carousel"]');v.each(e,(e=>{const t=g(e),r=t.attr("data-carousel-display-entry-size-at-once"),n={isAutoScroll:!!t.attr("data-carousel-autoscroll"),displayEntrySizeAtOnce:+r||void 0};if(n.isAutoScroll){const e=t.attr("data-carousel-autoscroll-interval");n.autoScrollInterval=+e||void 0}new P(g(document).find(t.html()),n)}))}};e.exports=j},74592:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n},a=r(73380),o=r(43348);t.init=()=>{const e=document.querySelector(".js-about-subscriber");e&&(0,a.safeRender)(i.default.createElement(o.AboutSubscribers,null),e)}},59328:(e,t,r)=>{"use strict";const n=r(65311),i=r(56412),a={init:function(){i.infoLoaded.then((e=>{var t=e.editable?".js-message-author":".js-message-guest";n("#container").append(n(t).html())}))}};e.exports=a},99127:(e,t,r)=>{"use strict";const n=r(65311),i=r(36500),a={init:function(){var e=i.createForParent(),t=0,r=function(){var r=n("body").height()+30;r!==t&&(e.send("resize",r),t=r)};n(document).on("click",".hatena-bookmark-span-button",(()=>{r()})),setInterval((()=>{r()}),1e3)}};e.exports=a},30780:(e,t,r)=>{"use strict";var n=r(70879);const i=r(37914),a=r(56412),o=r(10912),s={init:function(){i.setup();const e=()=>{"#edit"===location.hash&&a.infoLoaded.then((e=>{e.editable&&o.newEntry({openedFrom:"hashchange"})})).catch((e=>(0,n.BUG)(e)))};window.addEventListener("hashchange",(()=>e())),e()}};e.exports=s},9007:(e,t,r)=>{"use strict";const n=r(65311),i={init:function(){n((()=>{var e=n(".js-preview-draft-modal");e.find(".js-preview-draft-modal-btn").focus().on("click",(()=>{e.addClass("is-hidden")}))}))}};e.exports=i},68348:(e,t,r)=>{"use strict";const n=r(65311),i={init:function(){try{if(!window.sessionStorage)return;var e=n("#content").attr("data-editor-id");if(!e)return;var t=n(document),r=sessionStorage.previewed_scroll_position?JSON.parse(sessionStorage.previewed_scroll_position):null;r&&r.editor_id===e&&(t.scrollTop(r.top),t.scrollLeft(r.left)),t.scroll(_.throttle((()=>{sessionStorage.previewed_scroll_position=JSON.stringify({editor_id:e,top:t.scrollTop(),left:t.scrollLeft()})}),100))}catch(e){}}};e.exports=i},74387:(e,t,r)=>{"use strict";const n=r(65311),i=r(36500),a={init:function(){var e=i.createForParent(),t=null,r=function(){var r=n("html").height();r!==t&&(e.send("resize",r),t=r)};!!n(".js-embed-preview")[0]?(r(),setInterval((()=>{r()}),1e3)):e.send("close")}};e.exports=a},19394:(e,t,r)=>{"use strict";const n=r(65311),i=r(66419),a={init:function(){try{if(!window.sessionStorage)return;var e=n("#realtime-preview-content").attr("data-editor-id");if(!e)return;var t=n("#realtime-preview-wrapper"),r=sessionStorage.realtime_previewed_scroll_position?JSON.parse(sessionStorage.realtime_previewed_scroll_position):null;n(window).on("load",(()=>{r&&r.editor_id===e&&(t.scrollTop(r.top),t.scrollLeft(r.left))})),t.scroll(i.throttle((()=>{sessionStorage.realtime_previewed_scroll_position=JSON.stringify({editor_id:e,top:t.scrollTop(),left:t.scrollLeft()})}),100))}catch(e){}}};e.exports=a},12779:(e,t,r)=>{"use strict";var n=r(6636),i=c(r(20996)),a=c(r(57942)),o=r(78899),s=r(56866),l=c(r(38600)),d=r(36843),u=r(58430);function c(e){return e&&e.__esModule?e:{default:e}}const p=r(65311),f=r(36500),h=r(37914),m=r(56412),g=r(75781),v=r(23249),b=r(83401),y={init:function(){window.parent===window&&n.AccessLogger.ping(),f.messenger&&(0,d.initForGlobalHeaderNextGeneration)(),m.infoLoaded.then((e=>{y.loadInfo(e),"entry"===(0,a.default)("page")&&e.quote&&b.init(e.quote)})),(0,o.updateDynamicPieces)(p(document)),i.default.setupTimestampUpdater(),y.initFooterAction(),y.setupOndemandCommentDeleteButton(),g.init(),(0,s.setupBlogcardTrackingMessageReceiver)(),(0,u.insertSleepingAdInEntry)(),(0,u.insertAdInEntry)()},loadInfo:function(e){l.default.resolve(!e.cookie_received);const t=h.param("via");t&&f.send("inheritVia",t),v.init(e.subscribe,e.subscribes),e.editable&&p(".js-no-entry").length&&(p(".js-no-entry-message").hide(),p(".js-welcome-message").show())},setupOndemandCommentDeleteButton:function(){p(document).on("mouseenter",".js-entry-comment",(e=>{const t=p(e.currentTarget);if(t.find(".js-comment-delete-button .js-comment-delete-image").size()>0)return;const r=`${(0,a.default)("admin-domain")}/api/comment.delete.image?${p.param({comment:t.attr("data-comment-uuid"),blog:t.attr("data-blog-uuid")})}`,n=p("<img>");n.addClass("js-comment-delete-image"),n.attr("src",r);const i=()=>n.attr("alt","delete");n.load(i),n.error(i),t.find(".js-comment-delete-button").append(n)}))},initFooterAction:function(){const e=p("iframe.js-footer-action");if(e.length)try{f.createForFrame(e.get(0),e.attr("data-src")).addEventListener("resize",(t=>{t&&e.css(t)}))}catch(e){}}};e.exports=y},55557:(e,t,r)=>{"use strict";const n=r(65311),i=r(99109),a={init(){n(".js-entry-article").toArray().forEach((e=>new i(n(e))))}};e.exports=a},89401:(e,t,r)=>{"use strict";const n=r(42999),i={init:function(){n.init()}};e.exports=i},59268:(e,t,r)=>{"use strict";var n,i=r(36843),a=(n=r(38600))&&n.__esModule?n:{default:n},o=r(99057),s=r(78899);const l=r(9694),d=r(56412),u=r(36500),c=r(65311);var p={init:function(){i.GlobalHeaderSubscriber.init(),(0,s.updateDynamicPieces)(c(document)),document.body.classList.contains("page-is-responsive")&&(this.responsiveFooter=new l),u.addEventListener("visitorAttribute",(e=>{const t=e.visitorAttribute,r=e.daysSinceRegister;(0,o.pushToDataLayer)({visitorAttribute:t,daysSinceRegister:r}),(0,o.pushToDataLayer)({event:"gotVisitorAttribute"})})),d.infoLoaded.then((e=>{a.default.resolve(!e.cookie_received),u.send("visitorAttribute")}))}};e.exports=p},15233:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=function(){(function(){try{const e=new URL(window.location.href);if(!e.searchParams.has("created"))return;e.searchParams.delete("created"),history.replaceState(null,"",e.href)}catch(e){(0,a.BUG)(e)}})(),o.infoLoaded.then((e=>{e.is_admin?(0,i.default)(".admin-control").addClass("admin-control-available"):(0,i.default)(".admin-control").addClass("admin-control-unavailable"),e.is_member?(0,i.default)(".circle-member-control").addClass("circle-member-control-available"):(0,i.default)(".circle-member-control").addClass("circle-member-control-unavailable"),e.has_blogs?(0,i.default)(".blog-user-control").addClass("blog-user-control-available"):(0,i.default)(".blog-user-control").addClass("blog-user-control-unavailable"),!1===e.cookie_received&&(0,i.default)("[data-user-unknown-overrides]").removeClass("admin-control-unavailable circle-member-control-unavailable blog-user-control-unavailable").addClass("admin-control-available circle-member-control-available blog-user-control-available")})),s.init()};var n,i=(n=r(65311))&&n.__esModule?n:{default:n},a=r(70879);const o=r(56412),s=r(42999)},51169:(e,t,r)=>{"use strict";const n=r(65311);var i={init:function(){n(document).on("click",".js-read-old-entries",(function(){var e=n(this);e.closest(".js-category-container").find(".js-old-entry").show(),e.remove()}))}};e.exports=i},96065:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;var n=r(33671),i=r(48379);const a=r(37914);t.init=()=>{const e=a.param("via");e&&(0,n.inheritVia)(e);const t=window.location.search;!!new URLSearchParams(t).get("showBookmarkCounts")&&(0,i.showBookmarkCounts)()}},90989:(e,t,r)=>{"use strict";const n=r(65311),i=r(72005),a={init:function(){i(n(".js-followed-ad-container"),!0)}};e.exports=a},46267:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;t.init=()=>{(()=>{const e=document.documentElement;e.style.scrollBehavior="smooth",e.style.scrollPaddingTop="60px"})(),(()=>{if(!("IntersectionObserver"in window))return;const e=document.querySelector("#js-company-navigation");if(!e)return;const t=document.querySelectorAll(".js-cannot-coexist-with-navigation"),r=new IntersectionObserver((t=>{const r=t.some((e=>e.isIntersecting));e.classList.toggle("off-screen",r)}));t.forEach((e=>{r.observe(e)}))})()}},33556:(e,t,r)=>{"use strict";const n=r(65311),i=r(36500),a={init:function(){i.listenToParent(),n(".close-window").on("click",(e=>(i.send("close",{name:window.name}),!1)))}};e.exports=a},20343:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;var n=r(48379);t.init=()=>{const e=window.location.search;!!new URLSearchParams(e).get("showBookmarkCounts")&&(0,n.showBookmarkCounts)()}},49205:(e,t,r)=>{"use strict";const n=r(65311),i=r(72005),a={init:function(){i(n(".js-followed-ad-container"),!0)}};e.exports=a},26065:(e,t,r)=>{"use strict";const n={__domain__:r(62536),globalheader:r(11229),circle:r(83404),"circle-create":r(56764),"circle-membership":r(13796),"circle-membership-done":r(8078),"odai-new":r(10175),"odai-odai_id-edit":r(10175),"plus-quit":r(63931),"topic-show":r(57005),antenna:r(19778),config:r(90594),index:r(91602),locale:r(90487),refusal:r(37320),"feedback-iframe":r(23606),register:r(19557),"register-iframe":r(68156),"store-theme-new":r(52966),"store-theme-theme_id":r(29106),"menu-mymenu":r(35358),"menu-myblogmenu":r(39212),"menu-blogmenu":r(5927),"menu-services":r(966),"menu-blogmenu_admin":r(50068),"curation-amazon":r(33576),"curation-flickr":r(68850),"curation-gourmet":r(88956),"curation-instagram":r(37013),"curation-itunes":r(62492),"curation-promotion":r(41516),"curation-hatena-group":r(10555),"user-blog":r(77573),"user-blog-breadcrumb":r(46292),"user-blog-files-upload":r(34174),"user-blog-entries":r(71771),"user-blog-entries-summary":r(87025),"user-blog-drafts":r(71771),"user-blog-pages":r(70954),"user-blog-revisions":r(79923),"user-blog-comment":r(52808),"user-blog-comments":r(45888),"user-blog-comment-done":r(99352),"user-blog-comment-delete":r(52163),"user-blog-comment-delete-deleted":r(95974),"user-blog-profile_cards":r(73650),"user-blog-config-theme-theme_id-preview":r(47405),"user-blog-config-detail":r(38703),"user-blog-config-permission":r(56870),"user-blog-config-design-detail":r(42076),"user-blog-config-entry_directory":r(24460),"user-blog-config-delete":r(64007),"special-challenge-series-series_name":r(86968),"user-blog-accesslog":r(35394),"user-blog-categories":r(73504),"user-blog-export-movable_type":r(16566),"user-blog-members":r(7598),"user-blog-subscribe":r(99907),"user-blog-subscribe-done":r(45348),"user-blog-subscribe-iframe":r(52943),"user-blog-subscribers":r(36783),"user-blog-import":r(34113),"user-blog-import-yahoo-start":r(93841),"user-blog-import-hatena_diary":r(79997),"user-blog-import-hatena_diary-diary-diary_name":r(54385),"user-blog-edit":r(96849),"user-blog-edit-done":r(12771),"user-blog-proxy_test":r(65641),"pro-will-start":r(97812),"pro-will-resume":r(98924),"pro-will-migrate":r(84032),"pro-welcome":r(47814),"pro-cancel-survey":r(3136),"pro-will-migrate-to-business":r(60680),notifications:r(43e3),"confirm-google-photos":r(1640)},i={__domain__:r(9126),index:r(30780),realtime_preview:r(19394),preview:r(68348),"preview-static_page":r(68348),"preview-draft":r(9007),"preview-static_page-draft":r(9007),preview_url_embed:r(74387),"hatena-bookmark-comment":r(99127),"blog-count-limit-exceeded":r(59328),about:r(74592)},a={__domain__:r(59268),"global-top":r(96065),"mixed-topic":r(20343),"famous-blogs-top":r(51169),circle:r(15233),"circle-blogs":r(89401),"group-category":r(90989),"recent-groups":r(49205),"guide-pro-modal-ad":r(33556),"guide-corporation":r(46267)},o={__domain__:r(48056),config:r(61531),globalheader:r(40074),index:r(82848),locale:r(91242),refusal:r(57404),antenna:r(80004),"topic-show":r(86260),"promotion-promotion_id":r(64881),"user-blog-accesslog":r(71950),"user-blog-action":r(37764),"user-blog-comment":r(53457),"user-blog-comment-done":r(210),"user-blog-comments":r(50455),"user-blog-entries":r(48083),"user-blog-subscribers":r(46284),"user-blog-config-detail":r(1008),"user-blog-config-permission":r(38642),"user-blog-config-design-detail":r(23786),"user-blog-edit":r(45319),"user-blog-edit-done":r(12771),"user-blog-import-yahoo-start":r(93841),"pro-will-start":r(97812),"pro-will-resume":r(98924),"pro-will-migrate":r(84032),"pro-welcome":r(47814),"pro-cancel-survey":r(3136),notifications:r(43e3)},s={__domain__:r(12779),entry:r(55557),about:r(74592)};e.exports={Admin:n,Blogs:i,Global:a,AdminTouch:o,BlogsTouch:s}},55878:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HTMLActions=void 0;var n=a(r(65311)),i=a(r(20996));function a(e){return e&&e.__esModule?e:{default:e}}const o=r(59662),s={defaultParagraph(){this.formatBlock("p")},largeHeading(){this.formatBlock("h3")},middleHeading(){this.formatBlock("h4")},smallHeading(){this.formatBlock("h5")},bold(){this.execCommand("Bold")},italic(){this.execCommand("Italic")},strike(){this.execCommand("StrikeThrough")},underline(){this.execCommand("Underline")},removeFormat(){this.execCommand("removeFormat"),this.execCommand("unlink")},veryLargeFontSize(){this.execCommand("FontSize","200%")},largeFontSize(){this.execCommand("FontSize","150%")},defaultFontSize(){this.execCommand("RemoveFormat","FontSize")},smallFontSize(){this.execCommand("FontSize","80%")},unorderedList(){this.execCommand("InsertUnorderedList")},orderedList(){this.execCommand("InsertOrderedList")},color(){},pickColor(e){const t=this.tinymce.selection.getRng();let r;if(o.isIE&&(this.tinymce.focus(),r=this.tinymce.selection.getBookmark(1),this.tinymce.selection.setRng(t)),e)this.execCommand("ForeColor",e);else try{this.execCommand("RemoveFormat")}catch(e){}r&&this.tinymce.selection.moveToBookmark(r)},link(){(0,n.default)(document).trigger("show-embed-box")},insertSeeMore(){this.insertLines(["\x3c!-- more --\x3e",""])},insertTOC(){this.insertLines(["[:contents]",""])},blockquote(){o.isIE&&this.tinymce.focus();const e=this.tinymce.selection.getNode(),t=(0,n.default)(e),r=0!==t.closest("blockquote").length,i=0===t.next().length,a=0===t.text().length;if(o.isIE&&"body"===e.tagName.toLowerCase())this.tinymce.selection.isCollapsed()?this.insertBlockQuoteWithNewLine():this.formatBlockQuote();else if(i&&!r)if(!this.tinymce.selection.isCollapsed()||a)this.insertBlockQuoteWithNewLine();else{this.moveCaretToNodeEnd(e),this.insert("<p>&nbsp;</p>");const t=(0,n.default)(this.tinymce.selection.getNode()).prev()[0];this.tinymce.selection.select(t),this.formatBlockQuote()}else this.formatBlockQuote()},footnote(){const e=this.tinymce.selection.getContent();if(e.length)this.replace(`((${e}))`);else{const e=i.default.text("edit_form.footnote_message");this.insertAndSelectText(`((${e}))`,2,2+e.length)}this.tinymce.focus()},left(){this.execCommand("JustifyLeft")},center(){this.execCommand("JustifyCenter")},right(){this.execCommand("JustifyRight")}};t.HTMLActions=s},93979:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HatenaActions=void 0;var n=o(r(65311)),i=r(70879),a=o(r(20996));function o(e){return e&&e.__esModule?e:{default:e}}const s="not implemented",l={defaultParagraph(){this.headingAction("")},largeHeading(){this.headingAction("* ")},middleHeading(){this.headingAction("** ")},smallHeading(){this.headingAction("*** ")},italic(){this.wrapString("<em>","</em>","<i>","</i>")},bold(){this.wrapString("<strong>","</strong>","<b>","</b>")},underline(){this.wrapString("<u>","</u>")},strike(){this.wrapString("<s>","</s>")},veryLargeFontSize(){this.toggleFontSize(200)},largeFontSize(){this.toggleFontSize(150)},defaultFontSize(){this.removeFontSize()},smallFontSize(){this.toggleFontSize(80)},unorderedList(){const e=this.getSelectionBlock();e.togglePrefix("-",/^-\s?/,/^\+\s?/,!1),this.setSelectionBlock(e)},orderedList(){const e=this.getSelectionBlock();e.togglePrefix("+",/^\+\s?/,/^-\s?/,!1),this.setSelectionBlock(e)},color(){},pickColor(e){let t=this.getSelectionRange(),r=this.getSelectionText(t);/(<span style="color: [^;]+?">)/.test(r)?(r=e?r.replace(RegExp.$1,`<span style="color: ${e}">`):r.replace(RegExp.$1,"").replace(/<\/span>/,""),t=this.replace(r,t)):e&&(t=this.replace(`<span style="color: ${e}">${r}</span>`,t)),this.setSelectionRange(t)},link(){(0,n.default)(document).trigger("show-embed-box")},insertSeeMore(){this.insertLines(["====",""])},insertTOC(){this.insertLines(["[:contents]",""])},blockquote(){this.wrapStringAround(">>\n","\n<<")},footnote(){this.wrapStringAroundLabel("((",a.default.text("edit_form.footnote_message"),"))")},removeFormat(){},left(){(0,i.BUG)(s)},center(){(0,i.BUG)(s)},right(){(0,i.BUG)(s)}};t.HatenaActions=l},18974:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MarkdownActions=void 0;const n={...r(93979).HatenaActions,largeHeading(){this.headingAction("### ")},middleHeading(){this.headingAction("#### ")},smallHeading(){this.headingAction("##### ")},italic(){this.wrapString("*","*","<i>","</i>")},bold(){this.wrapString("**","**","<b>","</b>")},unorderedList(){const e=this.getSelectionBlock();e.togglePrefix("*",/^[*\-+]\s/,/^[0-9]+\.\s/,!0),this.setSelectionBlock(e)},orderedList(){const e=this.getSelectionBlock();e.togglePrefixNumber(/^[0-9]+\.\s/,/^[*\-+]\s/,!0),this.setSelectionBlock(e)},insertSeeMore(){this.insertLines(["\x3c!-- more --\x3e",""])},blockquote(){const e=this.getSelectionText();if(0===e.length)return void this.insert("\n> ");let t;if(/^(> .*\r?\n)+(> .*)?$/.test(e)){const r=e.replace(/^> (.*)/gm,"$1");t=this.replace(r)}else{const r=e.replace(/\r?\n$/g,"").replace(/^(.*)/gm,"> $1");t=this.replace(r)}this.setSelectionRange(t)}};t.MarkdownActions=n},42225:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.actionsMap=void 0;var n=r(55878),i=r(93979),a=r(18974);const o={hatena:i.HatenaActions,html:n.HTMLActions,markdown:a.MarkdownActions,raw:{}};t.actionsMap=o},71952:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColorPicker=void 0;var n,i=(n=r(65311))&&n.__esModule?n:{default:n};const a=r(17187).EventEmitter;t.ColorPicker=class extends a{constructor(e){super(),this.$container=e,this.$container.on("click",".js-color-chip",(e=>{const t=(0,i.default)(e.currentTarget).attr("data-color");this.emit("colorpick",t)})),this.$container.on("click",".js-color-picker-cancel",(()=>{this.emit("colorpick")})),this.$container.appendTo(document.body)}setPosition(e){this.$container.css(e)}}},55540:(e,t,r)=>{"use strict";var n=u(r(65311)),i=u(r(66419)),a=r(41960),o=u(r(37119)),s=r(92477),l=r(10714),d=r(70879);function u(e){return e&&e.__esModule?e:{default:e}}e.exports=class{constructor(e){var t=this;this.type="editor-amazon-search",t.$container=e.container,t.$container.get(0)&&(t.$categorySelect=t.$container.find(".amazon-search-category"),t.$keywordInput=t.$container.find(".amazon-search-keyword"),t.$keywordSubmit=t.$container.find(".amazon-search-keyword-submit"),t.$itemsContainer=t.$container.find(".amazon-search-items"),t.itemTemplate=i.default.template((0,n.default)(".amazon-search-item-template").html()),t.$indicator=t.$container.find(".indicator"),t.$pasteButton=t.$container.find(".amazon-search-paste-button"),t.$layoutType=t.$container.find(".amazon-search-layout-type"),t.$layoutTypeContainer=t.$container.find(".amazon-search-layout-type-container"),t.$resultIsEmpty=t.$container.find(".amazon-search-result-is-empty"),t.$formats=t.$container.find('.amazon-search-formats input[name="amazon-search-format"]'),t.$formatsContainer=t.$container.find(".amazon-search-formats"),t.$welcomeMessage=t.$container.find(".amazon-search-welcome"),t.$header=t.$container.find(".amazon-search-header"),t.$footer=t.$container.find(".amazon-search-footer"),this.sidebar=e.sidebar,t.bindEvents(),t.resize(),t.$keywordInput.val()&&t.$keywordSubmit.click())}bindEvents(){var e=this;e.$keywordSubmit.click((t=>(e.searchByInput(),!1))),e.$categorySelect.change((t=>(e.searchByInput(),!1))),e.$keywordInput.keydown((t=>{if("RET"===(0,a.keyString)(t))return e.searchByInput(),!1})),e.$keywordInput.focus((()=>{setTimeout((()=>{e.resize()}),0)})),e.$itemsContainer.delegate(".amazon-search-item","click",(function(t){(0,n.default)(t.target).is("a")||((0,n.default)(this).toggleClass("selected"),e.selectedItemsChanged())})),e.$container.delegate(".amazon-search-item","dblclick",(function(t){if(!(0,n.default)(t.target).is("a"))return e.insertAsins([(0,n.default)(this).attr("data-asin")]),(0,n.default)(this).removeClass("selected"),e.selectedItemsChanged(),!1})),e.$pasteButton.click((t=>{var r=[];e.$itemsContainer.find(".selected").each((function(){r.push((0,n.default)(this).attr("data-asin")),(0,n.default)(this).removeClass("selected")})),e.insertAsins(r),e.selectedItemsChanged()})),(0,o.default)({$container:e.$formatsContainer,key:"amazon-formats",onchange:function(t){e.$formatsContainer.find("label.selected").removeClass("selected"),t.closest("label").addClass("selected")}}),(0,o.default)({$container:e.$layoutTypeContainer,key:"amazon-layout",onchange:function(t){e.$itemsContainer.removeClass("layout-thumbnail"),e.$itemsContainer.removeClass("layout-list");var r=t.val();e.$itemsContainer.addClass(`layout-${r}`),e.$layoutTypeContainer.find("label.selected").removeClass("selected"),t.closest("label").addClass("selected"),e.setTipsyEnabled("thumbnail"===r)}});const t=e=>{e===this.type&&this.resize()};this.sidebar.on("resize",t),this.sidebar.on("tabChange",t)}setTipsyEnabled(e){var t=this.$itemsContainer.find(".amazon-search-item"),r="tipsy-southeast";e?t.addClass(r):t.removeClass(r)}resize(){var e=(0,n.default)(window).height(),t=0;t+=parseInt(this.$itemsContainer.css("padding-top"),10)||0,t+=parseInt(this.$itemsContainer.css("padding-bottom"),10)||0,this.$itemsContainer.height(e-this.$container.offset().top-this.$header.outerHeight(!0)-this.$footer.outerHeight(!0)-t)}selectedItemsChanged(){var e=this;e.$itemsContainer.find(".selected").length>0?e.$pasteButton.removeClass("disabled").addClass("enabled").prop("disabled",!1):e.$pasteButton.removeClass("enabled").addClass("disabled").prop("disabled",!0)}searchByInput(){var e=this;e.search(e.$keywordInput.val(),e.$categorySelect.find("option:selected").val())}search(e,t){var r,i=this;if("string"!=typeof e)return!1;if(0===(e=(e=e.replace(/^\s*/,"")).replace(/\s*$/,"")).length)return!1;if(i._searchingKeyword===e&&i._searchingCategory===t)return!1;i.$welcomeMessage.addClass("disable"),i._searchDeferred&&i._searchDeferred.reject(),i.ajaxStarted(),i._searchingKeyword=e,i._searchingCategory=t;var a=n.default.Deferred().done((()=>{})).fail((()=>{r&&r.abort()})).always((()=>{i.ajaxFinished()}));i.$itemsContainer.find(".amazon-search-item").remove();var o=function(s){i.ajaxStarted(),r=n.default.ajax({url:"/api/amazon",data:{keyword:e,category:t,page:s}}).done((e=>{i.showItems(e.items),1===e.page&&0===e.items.length?i.$resultIsEmpty.show():i.$resultIsEmpty.hide(),e.has_next?e.page>=5?a.resolve():o(e.page+1):a.resolve()})).fail((e=>{a.reject(e)}))};o(1),i._searchDeferred=a}showItems(e){var t=this,r="";i.default.each(e,(e=>{r+=t.itemTemplate({item:e})})),t.$indicator.before(r),t.setTipsyEnabled(t.$itemsContainer.hasClass("layout-thumbnail"))}insertAsins(e){var t=this.$container.find('[name="amazon-search-format"]:checked').val(),r=i.default.map(e,(e=>`[asin:${e}${t.length>0?`:${t}`:""}]`)),n={html:r,hatena:r,markdown:r};(0,s.extractSyntax)(r).done((e=>{n.html="detail"===t?["",`<div class="freezed">${e.html}</div>`,""]:[e.html],l.EditorConnector.insertLines(n)})).fail((e=>{(0,d.BUG)(e),l.EditorConnector.insertLines(n)}))}ajaxStarted(){var e=this;e.isAjaxing=!0,e.$keywordSubmit.prop("disabled",!0),e.$indicator.show(),e.$resultIsEmpty.hide()}ajaxFinished(){var e=this;e.isAjaxing=!1,e.$keywordSubmit.prop("disabled",!1),e.$indicator.hide()}}},2231:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IconHint=void 0;var n=a(r(59391)),i=a(r(67294));function a(e){return e&&e.__esModule?e:{default:e}}t.IconHint=()=>i.default.createElement(n.default,null)},71412:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderAnnouncement=t.annoucementHasBeenRead=void 0;var n=r(73380),i=d(r(86010)),a=d(r(20996)),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=l(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),s=r(2231);function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(l=function(e){return e?r:t})(e)}function d(e){return e&&e.__esModule?e:{default:e}}const u=r(19165),c="20230503",p="last-shown-announcement-id",f=o.default.createElement("div",{className:"editor-announcement-section-wrapper track-inview-on-editor-by-gtm","data-gtm-track-json":JSON.stringify({area:"announcement",payload:{"announcement-id":c}})},o.default.createElement("div",{className:"announcement-section"},o.default.createElement("h3",null,""),o.default.createElement("ul",{className:"announcement-archive"},o.default.createElement("li",null,o.default.createElement("a",{href:"https://blog.hatenablog.com/entry/umeyu_koukoku2023",target:"_blank",rel:"noopener noreferrer"},"12"," ",o.default.createElement("i",{className:"blogicon-external"}))),o.default.createElement("li",null,o.default.createElement("a",{href:"https://blog.hatenablog.com/entry/noindex_nofollow",target:"_blank",rel:"noopener noreferrer"}," 5  ",o.default.createElement("i",{className:"blogicon-external"}))),o.default.createElement("li",null,o.default.createElement("a",{href:"https://blog.hatenablog.com/entry/yapc2023",target:"_blank",rel:"noopener noreferrer"},"3 YAPC::Kyoto 2023  ",o.default.createElement("i",{className:"blogicon-external"})))))),h=()=>{const e=u.load(p);return{hasBeenRead:"string"==typeof e&&e===c,markAsRead:()=>{u.save(p,c)}}};t.annoucementHasBeenRead=h;const m=e=>{let{isTouch:t}=e;const{hasBeenRead:r,markAsRead:n}=(0,o.useMemo)((()=>h()),[]);return t?o.default.createElement("details",{className:(0,i.default)("editform-announcement",{"has-badge":r}),onToggle:e=>n()},o.default.createElement("summary",null,o.default.createElement("span",{className:"blogicon_hint"},o.default.createElement(s.IconHint,null)),a.default.text("epic.announcement")),f):o.default.createElement("div",{className:"editor-announcement-content"},o.default.createElement("div",{className:"editor-announcement-header"},o.default.createElement("h2",null,""),o.default.createElement("p",null,"")),o.default.createElement("div",{className:"editor-announcement-main"},f))};t.renderAnnouncement=(e,t)=>{(0,n.safeRender)(o.default.createElement(m,{isTouch:t}),e)}},32226:e=>{"use strict";e.exports={actions:{RESET_ENTRIES:"ARCHIVES:RESET_ENTRIES",LOAD:"ARCHIVES:LOAD",TOGGLE_SELECTION:"ARCHIVES:TOGGLE_SELECTION",CLEAR_SELECTION:"ARCHIVES:CLEAR_SELECTION",UPDATE_TERM:"ARCHIVES:UPDATE_TERM",START_LOADING:"ARCHIVES:START_LOADING",FINISH_LOADING:"ARCHIVES:FINISH_LOADING"}}},81841:(e,t,r)=>{"use strict";var n=r(92477),i=r(10714),a=r(70879);const o=r(32226).actions,s=r(73287),l=r(55063),d=r(27816);class u extends s.Actions{setTerm(e){this.emit(o.RESET_ENTRIES),this.emit(o.UPDATE_TERM,e)}load(e,t){this.emit(o.START_LOADING),l(e,t).then((e=>{this.emit(o.LOAD,e.entries.map(d)),this.emit(o.FINISH_LOADING,e.has_more)})).catch((()=>{this.emit(o.LOAD,[]),this.emit(o.FINISH_LOADING,!1)}))}toggleSelection(e){this.emit(o.TOGGLE_SELECTION,e)}insertEntries(e){this.emit(o.CLEAR_SELECTION);const t={hatena:[],markdown:[]};return e.sort(((e,t)=>e.datetime-t.datetime)).forEach((e=>{t.hatena.push(`[${e.url}:embed:cite]`),t.markdown.push(`[${e.url}:embed:cite]`)})),(0,n.extractSyntax)(t.hatena).done((e=>{t.html=["",e.html,""]})).fail((e=>{t.html=t.hatena,(0,a.BUG)(e)})).always((()=>{(i.EditorConnector.isiOS()||i.EditorConnector.isAndroid())&&(t.html=t.hatena),i.EditorConnector.insertLines(t)}))}}e.exports=new u},25750:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(r(67294)),i=s(r(20996)),a=r(64292),o=r(80418);function s(e){return e&&e.__esModule?e:{default:e}}const l=r(81841);class d extends n.default.Component{render(){const e=this.props.entry,t=+e.datetime,r=i.default.deltaDatetime(e.datetime);return n.default.createElement("div",{className:"item "+(e.isSelected?"selected":""),"data-testid":"archve-entry","data-permalink":e.url,onClick:()=>this.onClick(),onDoubleClick:()=>this.onDoubleClick()},n.default.createElement("div",{className:"item-inner"},n.default.createElement("table",null,n.default.createElement("tbody",null,n.default.createElement("tr",null,n.default.createElement("td",{className:"text"},n.default.createElement("span",{className:"entry-title"},e.title),n.default.createElement(o.Thumbnail,{thumbnails:e.thumbnails}),n.default.createElement("span",{className:"entry-body"},(0,a.trimString)(e.summary,34)),n.default.createElement("time",{className:"meta","data-epoch":t},r)),n.default.createElement("td",{className:"detail"},n.default.createElement("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",onClick:e=>this.onLinkClick(e)},n.default.createElement("i",{className:"blogicon-external"}))))))))}onClick(){l.toggleSelection(this.props.entry.id)}onLinkClick(e){e.stopPropagation()}onDoubleClick(){l.insertEntries([this.props.entry])}}var u=d;t.default=u},59855:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EntryList=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=l(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),i=s(r(25750)),a=r(90381),o=s(r(20996));function s(e){return e&&e.__esModule?e:{default:e}}function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(l=function(e){return e?r:t})(e)}const d=r(97670);class u extends n.Component{render(){const e=this.props.entries.map((e=>n.createElement(i.default,{key:e.id,entry:e}))),t=this.props.isLoading,r=0===e.length&&!t;return n.createElement("div",{className:"items vertical-items"},e,t?n.createElement(a.LoadingIndicator,{text:o.default.text("edit_form.archive.searching")}):null,r?n.createElement(d,null):null)}}t.EntryList=u},97670:(e,t,r)=>{"use strict";var n,i=(n=r(20996))&&n.__esModule?n:{default:n};const a=r(67294);class o extends a.Component{render(){return a.createElement("div",{className:"error-message active","data-testid":"error-message"},i.default.text("edit_form.archive.not_found"))}}e.exports=o},75568:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Footer=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),a=(n=r(9825))&&n.__esModule?n:{default:n};function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}const s=r(81841);class l extends i.Component{onClick(){s.insertEntries(this.props.selectedEntries)}render(){const e=0===this.props.selectedEntries.length;return i.createElement("div",{className:"insert-button-wrapper"},i.createElement(a.default,{disabled:e,trackingId:"curation-archive-paste-button",onClick:()=>this.onClick()}))}}t.Footer=l},50932:(e,t,r)=>{"use strict";var n,i=(n=r(20996))&&n.__esModule?n:{default:n},a=r(3174),o=r(59855),s=r(75568),l=r(46171);const d=r(67294),u=r(20762),c=r(98595),p=r(81841);class f extends d.Component{constructor(){super(),this.state={entries:u.getState(),archive:c.getState()},this.updateState=this._updateState.bind(this)}componentDidMount(){u.on("change",this.updateState),c.on("change",this.updateState)}_updateState(){this.setState({entries:u.getState(),archive:c.getState()})}render(){const e=this.state.entries.entries,t=this.state.archive.isLoading,r=this.state.archive;return d.createElement("div",{className:"editor-archive-content"},d.createElement("div",{className:"editor-archive-header"},d.createElement("div",{className:"header curation-header curation-tab-content-inner"},d.createElement("h2",null,i.default.text("edit_form.archive")),d.createElement(a.SearchForm,r))),d.createElement("div",{className:"editor-archive-main"},d.createElement(l.InfiniteScroll,{onScroll:()=>this.onScroll()},d.createElement("div",{className:"result"},d.createElement(o.EntryList,{entries:e,isLoading:t})))),d.createElement(s.Footer,{selectedEntries:e.filter((e=>e.isSelected))}))}onScroll(){const{isLoading:e,hasMore:t,term:r}=this.state.archive;if(e||!t)return;const{entries:n}=this.state.entries,i=Date.parse(n[n.length-1].created)/1e3;p.load(r,i)}}e.exports=f},3174:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SearchForm=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),i=o(r(20996)),a=o(r(70881));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}const l=r(81841);class d extends n.Component{render(){return n.createElement(a.default,{placeholder:i.default.text("edit_form.archive.placeholder"),onSubmit:e=>this.search(e)})}search(e){const t=e.trim();this.props.isLoading||(l.setTerm(t),l.load(t))}}t.SearchForm=d},80418:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Thumbnail=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=i(t);if(r&&r.has(e))return r.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=a?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,r&&r.set(e,n);return n}(r(67294));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(i=function(e){return e?r:t})(e)}t.Thumbnail=e=>{if(e.thumbnails&&e.thumbnails[60]){const t={backgroundImage:`url(${e.thumbnails[60]})`};return n.createElement("div",{className:"thumb",style:t})}return null}},27816:e=>{"use strict";e.exports=function(e){return{id:e.uuid,title:e.title,summary:e.summary,datetime:new Date(e.datetime),created:new Date(e.created),url:e.url,thumbnails:e.thumbnails,isSelected:!1}}},55063:(e,t,r)=>{"use strict";const n=r(65311).get;e.exports=function(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const t={permission:"public",q:arguments.length>0&&void 0!==arguments[0]?arguments[0]:""};return e&&(t.until=e),new Promise(((e,r)=>{n("entries.json",t).then((t=>{t.entries.length>0?e(t):r()})).fail((()=>{r()}))}))}},20489:(e,t,r)=>{"use strict";const n=r(67294),i=r(73935),a=r(50932),o=r(81841);var s=r(20762),l=r(98595);e.exports={init:function(e){s.init(),l.init(),i.render(n.createElement(a,null),e),o.load()}}},98595:(e,t,r)=>{"use strict";const n=r(73287),i=r(32226).actions;class a extends n.Store{init(){this.state={term:"",hasMore:!1,isLoading:!1},n.on(i.UPDATE_TERM,(e=>{this.updateTerm(e),this.emit("change")})),n.on(i.START_LOADING,(()=>{this.startLoading(),this.emit("change")})),n.on(i.FINISH_LOADING,(e=>{this.finishLoading(e),this.emit("change")}))}updateTerm(e){this.state.term=e,this.state.hasMore=!1}startLoading(){this.state.isLoading=!0}finishLoading(e){this.state.hasMore=e,this.state.isLoading=!1}}e.exports=new a},20762:(e,t,r)=>{"use strict";const n=r(73287),i=r(32226).actions;class a extends n.Store{init(){this.state={entries:[]},n.on(i.RESET_ENTRIES,(()=>{this.resetEntries(),this.emit("change")})),n.on(i.LOAD,(e=>{this.load(e),this.emit("change")})),n.on(i.TOGGLE_SELECTION,(e=>{this.toggleSelection(e),this.emit("change")})),n.on(i.CLEAR_SELECTION,(()=>{this.clearSelection(),this.emit("change")}))}resetEntries(){this.state={entries:[]}}load(e){this.state={entries:this.state.entries.concat(e).sort(((e,t)=>t.created-e.created))}}toggleSelection(e){const t=this.state.entries.find((t=>t.id===e));t.isSelected=!t.isSelected}clearSelection(){this.state.entries.forEach((e=>{e.isSelected=!1}))}}e.exports=new a},41205:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutoCompleteInput=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=a(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,r&&r.set(e,n);return n}(r(67294)),i=r(41960);function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(a=function(e){return e?r:t})(e)}function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o.apply(this,arguments)}function s(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class l extends n.Component{constructor(e){super(e),s(this,"input",null),s(this,"ul",null),s(this,"onFocus",(()=>{const e=this.getSuggestions(this.state.value,this.props);this.setState({suggestions:e,isFocused:!0}),this.updateRect()}));const t=e.inputProps.value||"",r=this.getSuggestions(t,e);this.state={value:t,cursor:-1,scroll:0,isFocused:!1,suggestions:r,x:null,y:null,width:null},this.lineHeight=20}static getDerivedStateFromProps(e){return void 0===e.inputProps.value?null:{value:e.inputProps.value}}componentDidUpdate(){this.ul&&0!==this.state.suggestions.length&&(this.lineHeight=this.ul.scrollHeight/this.state.suggestions.length,this.ul.scrollTop=this.state.scroll*this.lineHeight)}upCursor(){return this.state.cursor<1?this.state.suggestions.length-1:this.state.cursor-1}downCursor(){return this.state.cursor===this.state.suggestions.length-1?Math.min(0,this.state.suggestions.length-1):this.state.cursor+1}onKeyDown(e){let{cursor:t,value:r,suggestions:n,scroll:a}=this.state;38===e.keyCode&&0!==n.length&&(t=this.upCursor(),r=n[t],this.setState({value:r}),e.preventDefault()),40===e.keyCode&&0!==n.length&&(t=this.downCursor(),r=n[t],this.setState({value:r}),e.preventDefault()),"BS"===(0,i.keyString)(e)&&""===r&&this.props.onCancel(),"RET"===(0,i.keyString)(e)&&(r.match(/\S+/)&&this.props.onSubmit(r),n=[],t=-1,e.preventDefault(),e.stopPropagation());const o=a+this.props.max;if(t>-1&&n.length>this.props.max)if(t>=o-1){const e=t-(o-2);a=Math.min(a+e,n.length-this.props.max)}else t<a+1&&(a=Math.max(t-1,0));this.setState({suggestions:n,cursor:t,scroll:a})}getSuggestions(e,t){const{suggestions:r,showDefault:n,filter:i}=t;return i?e.match(/\S+/)?r.filter((t=>-1!==t.indexOf(e))):n?r:[]:r}onChange(e){const t=e.target.value,r=this.getSuggestions(t,this.props);this.setState({value:t,suggestions:r}),this.props.onChangeValue&&this.props.onChangeValue(t)}onMouseDownSuggestion(e){this.setState({cursor:-1}),this.props.onSubmit(e)}reset(){const e=this.getSuggestions("",this.props);this.setState({value:"",suggestions:e})}updateSuggestionList(){this.setState(((e,t)=>({suggestions:this.getSuggestions(e.value,t)})))}updateRect(){const e=this.getRectForSuggestionList();e&&this.setState({x:e.left,y:e.bottom,width:e.right-e.left})}getRectForSuggestionList(){if(this.props.getSuggestionsListBaseRect){const e=this.props.getSuggestionsListBaseRect();if(e)return e}if(this.input)return this.input.getBoundingClientRect()}renderSuggestion(e,t){const r=this.state.cursor===t;return n.createElement("li",{key:t,className:"AutoComplete__Suggestion "+(r?"isOnCursor":""),onMouseDown:()=>this.onMouseDownSuggestion(e),"data-testid":"suggestion"},e)}renderSuggestionList(){if(!this.state.isFocused||0===this.state.suggestions.length)return null;const e=Math.min(this.props.max,this.state.suggestions.length),t={x:this.state.x||void 0,y:this.state.y||void 0,width:this.state.width||void 0,height:this.lineHeight?e*this.lineHeight:void 0};return n.createElement("ul",{className:"AutoComplete__SuggestionList",style:t,ref:e=>{this.ul=e}},this.state.suggestions.map(((e,t)=>this.renderSuggestion(e,t))))}render(){return n.createElement("span",{className:"AutoComplete"},this.props.inputPrefix,n.createElement("input",o({type:"text"},this.props.inputProps,{ref:e=>{this.input=e},"data-testid":"autocomplete-input",value:this.state.value,onChange:e=>this.onChange(e),onKeyDown:e=>this.onKeyDown(e),onFocus:this.onFocus,onBlur:()=>this.setState({isFocused:!1})})),this.props.inputSuffix,this.renderSuggestionList())}}t.AutoCompleteInput=l,s(l,"defaultProps",{suggestions:[],onSubmit:()=>{},onCancel:()=>{},onChangeValue:()=>{},inputProps:{},max:7,showDefault:!1,filter:!0,inputPrefix:null,inputSuffix:null})},11363:(e,t,r)=>{"use strict";var n,i=r(90242),a=r(45298),o=r(23983),s=r(24367),l=r(94027),d=(n=r(26307))&&n.__esModule?n:{default:n};const u=r(67294);class c extends u.Component{constructor(e){super(),this.state={categories:e.categories,selectedCategories:e.selectedCategories}}toggleCategory(e){const{selectedCategories:t}=this.state,r=t.indexOf(e);-1!==r?this.setState({selectedCategories:t.filter(((e,t)=>t!==r))}):this.setState({selectedCategories:[...t,e]})}removeLastCategory(){const{selectedCategories:e}=this.state;this.setState({selectedCategories:[...e.slice(0,-1)]})}addCategory(e){const{categories:t}=this.state,r=(0,s.formatCategoryName)(e);r&&(t.includes(r)||this.setState({categories:[...t,r]}),this.toggleCategory(r))}onSortStart(){d.default.on()}onSortEnd(e){let{oldIndex:t,newIndex:r}=e;const{selectedCategories:n}=this.state,i=(0,l.arrayMove)(n,t,r);this.setState({selectedCategories:i}),d.default.off()}render(){const{categories:e,selectedCategories:t}=this.state;return u.createElement("div",{className:"editor-sidebar-category_CategoryEditor"},u.createElement(i.CategoryHeader,{categories:e,selectedCategories:t,onSubmit:e=>this.addCategory(e),onCancel:()=>this.removeLastCategory(),onClickRemoveBtn:e=>this.toggleCategory(e),onSortStart:()=>this.onSortStart(),onSortEnd:e=>this.onSortEnd(e)}),u.createElement(o.NewCategoryButton,{onSubmit:e=>this.addCategory(e)}),u.createElement(a.CategoryList,{categories:e,selectedCategories:t,onClickCategory:e=>this.toggleCategory(e)}))}}e.exports=c},59631:(e,t,r)=>{"use strict";const n=r(67294),i=r(73935),a=r(91269),o=r(11363),s=r(67516),l=e=>e.canSet?n.createElement(o,e):n.createElement(s,null);e.exports=class{constructor(){this.type="editor-category";const e=a.get("editor.categories.canSet"),t=document.querySelector("#editor-category"),r=a.get("editor.categories")||[],o=a.get("editor.selectedCategories")||[];i.render(n.createElement(l,{categories:r,selectedCategories:o,canSet:e}),t)}}},90242:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CategoryHeader=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=d(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),a=(n=r(20996))&&n.__esModule?n:{default:n},o=r(41205),s=r(43609),l=r(55992);function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(d=function(e){return e?r:t})(e)}function u(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class c extends i.Component{constructor(e){super(e),u(this,"input",null),u(this,"onSubmit",(e=>{this.props.onSubmit(e),this.input.reset()}))}focusEditor(){this.input.input.focus()}render(){const{selectedCategories:e}=this.props,t=this.props.categories.filter((e=>!this.props.selectedCategories.includes(e)));return i.createElement("div",{className:"editor-sidebar-category_CategoryHeader"},i.createElement("label",{htmlFor:"editor-sidebar-category_Input"},i.createElement("h2",{className:"CategoryHeaderHeading"},a.default.text("blog.category"))),i.createElement("p",null,a.default.text("edit_form.category_description2"),i.createElement("a",{href:(0,l.helpUrl)("/entry/editor/category"),target:"_blank",rel:"noopener noreferrer"},a.default.text("epic.show_detail"))),i.createElement("div",{className:"CategoryInput",onClick:()=>this.focusEditor()},i.createElement(s.SortableSelectedCategories,{selectedCategories:e,onClickRemoveBtn:e=>this.props.onClickRemoveBtn(e),onSortStart:()=>{this.props.onSortStart()},onSortEnd:e=>{this.props.onSortEnd(e)},helperClass:"sortableHelper",axis:"xy",distance:5}),i.createElement(o.AutoCompleteInput,{ref:e=>{this.input=e},inputProps:{id:"editor-sidebar-category_Input",className:"Input",autoComplete:"off"},suggestions:t,onSubmit:this.onSubmit,onCancel:this.props.onCancel})),i.createElement("p",{className:"categoryAsideNotice"},a.default.text("edit_form.category_aside_notice")))}}t.CategoryHeader=c},45298:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CategoryList=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=i(t);if(r&&r.has(e))return r.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=a?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,r&&r.set(e,n);return n}(r(67294));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(i=function(e){return e?r:t})(e)}class a extends n.Component{isSelected(e){return this.props.selectedCategories.includes(e)}formatKey(e){return encodeURIComponent(e)}renderCategoryListItem(e){return this.isSelected(e)?n.createElement("li",{key:this.formatKey(e),className:"selected",onClick:()=>this.props.onClickCategory(e),"data-testid":"selected-category-list"},n.createElement("span",{className:"category"},e)):n.createElement("li",{key:this.formatKey(e),onClick:()=>this.props.onClickCategory(e),"data-testid":"category-list"},e)}render(){return n.createElement("ul",{id:"existing-categories",className:"editor-sidebar-category_CategoryList"},this.props.categories.map((e=>this.renderCategoryListItem(e))))}}t.CategoryList=a},23983:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NewCategoryButton=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),a=(n=r(20996))&&n.__esModule?n:{default:n};function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}class s extends i.Component{onClick(){const e=window.prompt(a.default.text("category.new.prompt"));e&&this.props.onSubmit(e)}render(){return i.createElement("div",{className:"editor-sidebar-category_NewCategoryButton"},i.createElement("div",{className:"NewCategoryButtonText",onClick:()=>this.onClick()},i.createElement("i",{className:"blogicon-plus"})," ",a.default.text("category.new")))}}t.NewCategoryButton=s},43609:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SortableSelectedCategories=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),i=r(94027),a=r(15604);function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}const s=(0,i.SortableContainer)((e=>{let{selectedCategories:t,onClickRemoveBtn:r}=e;return n.createElement("span",{className:"editor-sidebar-category_Categories"},t.map(((e,t)=>n.createElement(a.SortableSelectedCategory,{key:encodeURIComponent(e),index:t,selectedCategory:e,onClickRemoveBtn:r}))))}));t.SortableSelectedCategories=s},15604:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SortableSelectedCategory=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=i(t);if(r&&r.has(e))return r.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=a?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,r&&r.set(e,n);return n}(r(67294));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(i=function(e){return e?r:t})(e)}const a=(0,r(94027).SortableElement)((e=>{let{selectedCategory:t,onClickRemoveBtn:r}=e;return n.createElement("div",{className:"editor-sidebar-category_Category","data-category-name":t},n.createElement("span",{className:"name"},t),n.createElement("button",{type:"submit",className:"RemoveBtn",onClick:e=>{e.preventDefault(),e.stopPropagation(),r(t)}},n.createElement("i",{className:"blogicon-close"})),n.createElement("input",{type:"hidden",name:"category",value:t,"data-with-backup":!0}))}));t.SortableSelectedCategory=a},67516:(e,t,r)=>{"use strict";var n,i=(n=r(20996))&&n.__esModule?n:{default:n};const a=r(67294);class o extends a.Component{render(){return a.createElement("div",{className:"CategoryEditor"},a.createElement("div",{className:"CategoryHeader"},a.createElement("h2",null,i.default.text("blog.category")),a.createElement("p",null,i.default.text("blog.category.unavailable"))))}}e.exports=o},83902:(e,t,r)=>{"use strict";e.exports=r(59631)},88346:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DAZN_CHANNELS=t.API_ENDPOINT=void 0;t.API_ENDPOINT="/api/dazn";t.DAZN_CHANNELS=[{name:"",channels:[{id:"",name:""}]},{name:"",channels:[{id:"F4433F395A264E1A96539FA4AEA62EF",name:""},{id:"96A71ECA0B8F4FAFA267C4637628E83B",name:""},{id:"9EBA1139EF334ECBA03DFBAAEAFC1BB7",name:""},{id:"ACC896A0FE484AB38518A0D0B7EB7795",name:""},{id:"C0CBEE8AB6D741D6827DB8ACBECF9571",name:"A"},{id:"2A0C93A0A0AB4655B7BB331400A5043",name:""},{id:"1kplj22px43b11wk1kadu2nr39",name:"UEFA "},{id:"6gyrzeim2dwl1d0excvgxca1u",name:"J1 League  JP"},{id:"1g6fhxbcglxt5128bqeqwiwa5k",name:"J2 League  JP"},{id:"ffvjpbv2a63p1jko34cukjxut",name:"J3 League  JP"},{id:"E9D256F54119471BB65B2D548111573E",name:""},{id:"488AAE72FF434C45A6ABB519F15A565",name:"5"},{id:"hw3xsyj2ij381unosidf7d2li",name:": "},{id:"1m2gjj02oo2gl1h4kj452lrb0t",name:""},{id:"unlw2iar4lduzvjlu1aggnwy",name:"UCL Archive"},{id:"69CF724DFD24498CBAFC5637DBD16C39",name:":"},{id:"C12C3C0B4FE444F4A75EA9A8CC6B8481",name:"MLS&(JP)"},{id:"1synmnu9m5oyh1bi9kmigoggvp",name:""}]},{name:"",channels:[{id:"tq4x6po6e55v1f6bnv4jxye32",name:""},{id:"1jt67pfg4hxxe16vsy0v10atex",name:""},{id:"x0tjhfhgjv6z1tfokt8e456sd",name:""}]},{name:"",channels:[{id:"CCA50690AB7E2912E0440021281A8A86",name:"Autosport TV (JP)"},{id:"gjr8ps1pnr4w123wk3qnht8rh",name:"Autosport TV:F"}]},{name:"",channels:[{id:"qtrofp6czyzb1xyu3tr3jb7o4",name:"V (V-League)"}]},{name:"",channels:[{id:"wk9s8s24nhdv1oh7ni1rcx3n1",name:": WTA()"},{id:"caelhxv70zfg1lq0eds2jrdp4",name:": ATP()"}]},{name:"",channels:[{id:"1hdbd5ra64enh1ef79ld10a08u",name:"NPB:Central league"},{id:"439FF2318532453A9F6F82E9D420035",name:"NPB:Paciffic league"},{id:"18v8wmvtevku513zn6dlzrekns",name:"NPB:Pre season matches"},{id:"1weibsujwjtr919wpccu8gaatf",name:"MLB"}]},{name:"",channels:[{id:"36876F5ACF14456FAEFC142E7FB94D99",name:"Fighting Sport"}]},{name:"",channels:[{id:"12kz7qhv0tbcj11iolbtngiwvn",name:"Cycling  JP"}]},{name:"",channels:[{id:"n1ogbm1buyaz1v6mdhim90k0g",name:"FIBA(JP)"},{id:"e7127ff5-b828-43ee-bab8-3548c15d96cb",name:"LiveBasketball.TV - FIBA"},{id:"44qngj5fdvvg1fawfldx46t81",name:":B"},{id:"B77272C671834ADDB42520B8C871B975",name:"NBA TV (jp)"}]},{name:"",channels:[{id:"anin0x73jf59100tzafi4znpp",name:"NFL(Japan)"}]},{name:"",channels:[{id:"1fybbl64d2qbl1brg302ycusmx",name:""}]}]},98296:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DaznViewModel=void 0;var n=r(17187),i=r(10714),a=r(90872);class o extends n.EventEmitter{constructor(){super(),this.state={items:[],selectedItemIds:[],page:1,keyword:"",channelId:"",hasNext:!1,error:null,isLoading:!1,isFirst:!0}}setState(e){this.state={...this.state,...e},this.emit("change")}getState(){return{...this.state}}searchItems(){let e=this.state.keyword;return/^\s*$/.test(e)&&(e=""),this.setState({keyword:e,isLoading:!0,isFirst:!1}),(0,a.fetchAPI)({keyword:e,channel_id:this.state.channelId,page:1}).then((e=>{this.setState({items:e.items,hasNext:e.hasNext,error:null,selectedItemIds:[]})})).catch((e=>{this.setState({error:e})})).then((()=>{this.setState({isLoading:!1})}))}loadNextItems(){if(!this.state.hasNext||this.state.error)return Promise.resolve();this.setState({isLoading:!0});const e=this.state.keyword,t=this.state.channelId,r=this.state.page+1;return(0,a.fetchAPI)({keyword:e,channel_id:t,page:r}).then((e=>{this.setState({items:this.state.items.concat(e.items),hasNext:e.hasNext,page:r})})).catch((e=>{this.setState({error:e})})).then((()=>{this.setState({isLoading:!1})}))}toggleItemSelection(e){const t=this.state.selectedItemIds.includes(e.itemId)?this.state.selectedItemIds.filter((t=>t!==e.itemId)):[...this.state.selectedItemIds,e.itemId];this.setState({selectedItemIds:t})}insertSelectedItems(){const e={};for(const t of this.state.items)e[t.itemId]=t;const t=this.state.selectedItemIds.map((t=>`[dazn:${e[t].itemId}]`));i.EditorConnector.insertLines({html:t,hatena:t,markdown:t}),this.setState({selectedItemIds:[]})}insertItem(e){const t=[`[dazn:${e.itemId}]`];i.EditorConnector.insertLines({html:t,hatena:t,markdown:t}),this.isItemSelected(e)&&this.toggleItemSelection(e)}isItemSelected(e){return this.state.selectedItemIds.includes(e.itemId)}hasSelectedItems(){return this.state.selectedItemIds.length>0}onInputChange(e){this.setState({keyword:e})}onSelectChange(e){this.setState({channelId:e,items:[],selectedItemIds:[]}),this.searchItems()}}t.DaznViewModel=o},49063:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DaznSearchForm=void 0;var n=s(r(67294)),i=r(88346),a=s(r(20996)),o=r(41960);function s(e){return e&&e.__esModule?e:{default:e}}t.DaznSearchForm=e=>n.default.createElement("div",{className:"editor-sidebar-dazn_search","data-testid":"dazn-search-form"},n.default.createElement("div",{className:"sidebar-search-form"},n.default.createElement("input",{type:"text",placeholder:e.placeholder,className:"sidebar-search-form__input","data-testid":"dazn-search-input",onKeyPress:t=>{((e,t)=>{"RET"===(0,o.keyString)(e)&&(e.preventDefault(),t())})(t,e.onSubmit)},onChange:t=>{e.onInputChange(t.target.value)}}),n.default.createElement("button",{type:"button",className:"sidebar-search-form__submit",onClick:e.onSubmit,"aria-label":a.default.text("search")},n.default.createElement("i",{className:"blogicon-search"}))),n.default.createElement("div",{className:"formats-title search-channel-wrapper"},n.default.createElement("select",{name:"dazn-search-channel",className:"search-channel",defaultValue:"",onChange:t=>e.onSelectChange(t.target.value),"data-testid":"dazn-search-select"},i.DAZN_CHANNELS.map((e=>n.default.createElement("optgroup",{label:e.name,key:e.name},e.channels.map((e=>n.default.createElement("option",{value:e.id,key:e.id},e.name)))))))))},38974:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DaznSidebar=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=c(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),a=(n=r(20996))&&n.__esModule?n:{default:n},o=r(46171),s=r(49063),l=r(90381),d=r(34007),u=r(1199);function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(c=function(e){return e?r:t})(e)}class p extends i.Component{constructor(e){super(e),this.state=e.vm.getState(),this.update=()=>this.setState(e.vm.getState())}componentDidMount(){this.props.vm.on("change",this.update)}componentWillUnmount(){this.props.vm.off("change",this.update)}render(){const e=this.props.vm,{items:t,keyword:r,channelId:n,isFirst:c,isLoading:p}=this.state,f=!c&&!p&&0===t.length;return i.createElement("div",{className:"editor-dazn-content"},i.createElement("div",{className:"editor-dazn-header"},i.createElement("h2",null,a.default.text("edit_form.dazn")),i.createElement(s.DaznSearchForm,{keyword:r,channelId:n,placeholder:a.default.text("edit_form.dazn.placeholder"),onInputChange:t=>e.onInputChange(t),onSelectChange:t=>e.onSelectChange(t),onSubmit:()=>e.searchItems()})),i.createElement("div",{className:"editor-dazn-main"},i.createElement(o.InfiniteScroll,{onScroll:()=>e.loadNextItems(),interval:1e3},i.createElement("div",{className:"editor-dazn-items"},t.map(((t,r)=>i.createElement(u.Item,{item:t,key:r,isSelected:e.isItemSelected(t),onSelect:()=>e.toggleItemSelection(t),onDoubleClick:()=>e.insertItem(t)}))),c&&i.createElement("div",{className:"editor-dazn-items-message"},a.default.text("edit_form.dazn.description")),f&&i.createElement("div",{className:"editor-dazn-items-message"},a.default.text("edit_form.dazn.empty")),p&&i.createElement(l.LoadingIndicator,null)))),i.createElement(d.Footer,{hasSelectedItems:e.hasSelectedItems(),onSubmit:()=>e.insertSelectedItems()}))}}t.DaznSidebar=p},34007:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Footer=void 0;var n=a(r(67294)),i=a(r(9825));function a(e){return e&&e.__esModule?e:{default:e}}t.Footer=e=>n.default.createElement("div",{className:"editor-sidebar-dazn_footer","data-testid":"dazn-footer"},n.default.createElement(i.default,{disabled:!e.hasSelectedItems,onClick:e.onSubmit}))},1199:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Item=void 0;var n=o(r(67294)),i=o(r(20996)),a=r(74868);function o(e){return e&&e.__esModule?e:{default:e}}t.Item=e=>n.default.createElement("div",{className:"editor-sidebar-dazn_item item "+(e.isSelected?"selected":""),"data-testid":"dazn-item",onClick:e.onSelect,onDoubleClick:e.onDoubleClick},n.default.createElement("div",{className:"inner"},null===e.item.thumbnail?n.default.createElement("div",{className:"thumbnail-wrapper"},n.default.createElement("span",{className:"duration"},(0,a.formatDuration)(e.item.duration))):n.default.createElement("div",{className:"thumbnail-wrapper"},n.default.createElement("img",{className:"thumbnail",src:e.item.thumbnail.url,width:e.item.thumbnail.width,height:e.item.thumbnail.height,alt:""}),n.default.createElement("span",{className:"duration"},(0,a.formatDuration)(e.item.duration))),n.default.createElement("div",{className:"info-container"},n.default.createElement("div",{className:"name"},e.item.itemTitle),n.default.createElement("div",{className:"channel"},e.item.channel),n.default.createElement("span",{className:"publishedTime"},i.default.deltaDatetime(new Date(e.item.publishedTime))))))},90872:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetchAPI=void 0;var n,i=(n=r(347))&&n.__esModule?n:{default:n},a=r(70879),o=r(88346);t.fetchAPI=e=>i.default.get(o.API_ENDPOINT,{params:e}).then((e=>{if(e.data.error)throw e.data.error;return e.data}),(e=>{throw(0,a.BUG)(e),-1}))},57833:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Dazn=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n},a=r(73380),o=r(38974),s=r(98296);t.Dazn=class{constructor(e){const t=new s.DaznViewModel;(0,a.safeRender)(i.default.createElement(o.DaznSidebar,{vm:t}),e.container)}}},43265:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EditorSidebar=void 0;var n,i=(n=r(65311))&&n.__esModule?n:{default:n},a=r(17187),o=r(80417);const s=r(19165);class l extends a.EventEmitter{constructor(e){super(),this.editor=e,this.setMaxListeners(100),this.$editor=(0,i.default)("#editor"),this.$container=(0,i.default)("#editor-support-container"),this.$services=this.$container.find(".services"),this.$header=this.$container.find(".header"),this.$footer=this.$container.find(".footer"),this._type="editor-home",this.isOpen=!0,this.sidebarButtons=new o.SidebarButtons(this.$container.find(".curation-bar-itemlist"),this,this.editor.getPublicationType()),this.bindEvents(),this.restoreLastStatus(),setTimeout((()=>this.emit("resize",this._type)),0)}get type(){return this._type}bindEvents(){this.on("toggle",(()=>this.toggle())),this.on("openByType",(e=>this.openByType(e))),this.editor.on("resize",(()=>this.emit("resize",this._type)))}restoreLastStatus(){const e=s.load("sidebar-status");e&&(this._type=e.type,this.isOpen=e.is_open),this.$editor.attr("data-sidebar-type")&&(this._type=this.$editor.attr("data-sidebar-type"),this.isOpen=!0),this.isOpen&&this.openByType(this._type)}isOpening(){return(0,i.default)(document.body).hasClass("support-shown")}toggle(){this.isOpening()?this.close():this.openByType(this._type)}openByType(e){if(!e)return void this.close();const t=this.$container.find(`#${e}`);t.get(0)?(this._type=e,this.$container.find(".curation-tab-content").hide(),(0,i.default)(document.body).addClass("support-shown"),t.show(),t.triggerHandler("show"),this.isOpen=!0,this.save(),this.emit("tabChange",e)):this.openByType("editor-home")}close(){(0,i.default)(document.body).removeClass("support-shown");const e=this.$container.find(".curation-itemlist.active");e.removeClass("active"),e.removeClass(e.attr("data-icon-class-when-active")),e.addClass(e.attr("data-icon-class")),this.isOpen=!1,this.save(),this.emit("tabChange","none")}save(){s.save("sidebar-status",{is_open:this.isOpen,type:this._type})}}t.EditorSidebar=l},76728:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmbedBox=void 0;var n=u(r(65311)),i=u(r(66419)),a=r(41960),o=u(r(57942)),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=d(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(55992)),l=r(23042);function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(d=function(e){return e?r:t})(e)}function u(e){return e&&e.__esModule?e:{default:e}}const c=r(36500),p=r(59662),f=r(26410);t.EmbedBox=class{constructor(e){if(this.editor=e.editor,this.$container=e.$container,this.$urlInput=this.$container.find(".js-embed-url"),this.$previewButton=this.$container.find(".js-preview-button"),this.$embedTypes=this.$container.find(".js-embed-types"),this.$pasteButton=this.$container.find(".js-paste-button"),this.$showEmbedCheckbox=this.$container.find(".js-show-embed-box-on-paste-url"),this.candidates=[],this.session=n.default.Deferred(),this.session.reject(),this.$container.on("click",".js-close",(()=>{this.hide()})),this.$previewButton.on("click",(()=>{this.requestPreview()})),this.$urlInput.on("keydown",(e=>{"RET"===(0,a.keyString)(e)&&(this.requestPreview(),e.preventDefault(),e.stopPropagation())})),this.$pasteButton.on("click",(()=>{this.requestPaste()})),this.$container.on("keydown",":input",(e=>{"ESC"===(0,a.keyString)(e)&&(this.hide(),e.preventDefault(),e.stopPropagation())})),p.isIE){const e=this.editor;setInterval((()=>{try{this.selectionRangeInTimer=e.getSelectionRange(),this.selectionContentInTimer=e.isCollapsed()?null:e.getSelectionText()}catch(e){}}),1e3)}const t="EmbedBox.show-embed-box-on-paste-url";let r=!0;try{r="false"!==localStorage.getItem(t)}catch(e){}r&&this.$showEmbedCheckbox.prop("checked",!0),this.$showEmbedCheckbox.on("change",(()=>{const e=this.isEnabledOnPasteURL();localStorage.setItem(t,String(e))})),(0,n.default)(document).on("show-embed-box",(()=>{this.show()})),this.$embedTypes.on("change",":input",(e=>{const t=(0,n.default)(e.currentTarget);this.$embedTypes.find(".js-embed-type.selected").removeClass("selected"),t.parents(".js-embed-type").toggleClass("selected")})),this.$embedTypes.on("dblclick",".js-embed-type",(()=>{this.requestPaste()}))}isEnabledOnPasteURL(){return this.$showEmbedCheckbox.prop("checked")}show(){if(!this.isShown())return this.$container.css("left",((0,n.default)(window).width()-this.$container.width())/2),this.$embedTypes.find(".js-embed-type.selected").removeClass("selected"),f.show(this.$container,{showBackground:!0,destroy:()=>{this.onHide()}}),i.default.defer((()=>{this.$urlInput.focus().first().select()})),this.checkSelection(),this.session=n.default.Deferred(),this.session.promise()}setURL(e){this.$urlInput.val(e)}isShown(){return this.$container.is(":visible")}hide(){f.hide(this.$container)}onHide(){this.session.reject(),this.reset()}checkSelection(){if(p.isIE)this.selectionRange=this.selectionRangeInTimer,this.selectionContent=this.selectionContentInTimer;else{const e=this.editor;this.selectionRange=e.getSelectionRange(),this.selectionContent=e.isCollapsed()?null:e.getSelectionText()}}requestPreview(){let e=this.$urlInput.val();e&&(e.match(/^https?:\/\//)||(e=`http://${e}`),this.reset(),i.default.defer((()=>{this.$pasteButton.prop("disabled",!1).removeClass("disabled").focus()})),this.selectionRange&&this.selectionContent&&this.candidates.push(this.createQuoteCandidate(e,this.selectionContent)),this.candidates.push(this.createImageCandidate(e)),this.candidates.push(this.createEmbedCandidate(e)),this.candidates.push(this.createTitleCandidate(e)),this.candidates.push(this.createURLCandidate(e)))}reset(){this.candidates.forEach((e=>{e.kill()})),this.candidates=[],this.$pasteButton.prop("disabled",!0).addClass("disabled")}requestPaste(){if(this.$pasteButton.is(":disabled"))return;const e=this.candidates.find((e=>e.isChecked()))||this.candidates.find((e=>e.isEnabled()));e&&(this.session.resolve(e),e.paste(),this.hide())}createEmbedCandidate(e){const t=(0,n.default)('<iframe width="100%" scrolling="no">'),r=`${s.partsUrl("/preview_url_embed")}?${n.default.param({url:e})}`,a=n.default.Deferred();let o;i.default.defer((()=>{const e=c.createForFrame(t[0],r);e.addEventListener("resize",(e=>{t.css("height",e),a.resolve()})),e.addEventListener("close",(()=>{t.remove(),a.reject()}))}));const d=document.createElement("a");return d.href=e,"itunes.apple.com"===d.host||"twitter.com"===d.host&&d.pathname.match(/\/status\//)||d.host.match(/flickr\.com/)&&d.pathname.match(/\/photos\//)?(o=`[${e}:embed]`,"html"===(0,n.default)("#syntax").val()&&(o+="\n\n ")):o=`[${e}:embed:cite]`,new l.EmbedBoxCandidate({$root_container:this.$container,type:"embed",syntax:o,loader:a.promise(),$preview:t,editor:this.editor})}createImageCandidate(e){const t=n.default.Deferred(),r=(0,n.default)("<img>").on("load",(()=>{t.resolve()})).on("error",(()=>{t.reject()})).attr("src",e);return new l.EmbedBoxCandidate({$root_container:this.$container,type:"image",selectionRange:this.selectionRange,syntax:`[${e}:image=${e}]`,loader:t.promise(),$preview:r,editor:this.editor})}createTitleCandidate(e){const t=(0,n.default)("<div>"),r=n.default.Deferred();return n.default.ajax({type:"POST",dataType:"json",url:"/api/extract_title",data:{url:e,rkm:(0,o.default)("rkm"),rkc:(0,o.default)("rkc")}}).done((e=>{e.title?(t.text(e.title),r.resolve()):r.reject()})).fail((()=>{r.reject()})),new l.EmbedBoxCandidate({$root_container:this.$container,type:"title",selectionRange:this.selectionRange,syntax:`[${e}:title]`,loader:r.promise(),$preview:t,editor:this.editor})}createURLCandidate(e){const t=(0,n.default)("<div>").text(e);return new l.EmbedBoxCandidate({$root_container:this.$container,type:"url",selectionRange:this.selectionRange,syntax:`[${e}]`,loader:n.default.Deferred().resolve().promise(),$preview:t,editor:this.editor})}createQuoteCandidate(e,t){const r=(0,n.default)("<pre>").text(t);return new l.EmbedBoxCandidate({$root_container:this.$container,type:"quote",selectionRange:this.selectionRange,syntax:`[${e}:title=${t}]`,loader:n.default.Deferred().resolve().promise(),$preview:r,paste:()=>{const t=this.editor;t.setSelectionRange(this.selectionRange),t.createLink(e)},editor:this.editor})}}},23042:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmbedBoxCandidate=void 0;var n=r(92477),i=r(10714);t.EmbedBoxCandidate=class{constructor(e){this.type=e.type,this.selectionRange=e.selectionRange,this.editor=e.editor,this.syntax=e.syntax,e.paste&&(this.paste=e.paste),this.$container=e.$root_container.find(`[data-embed-type="${this.type}"]`),this.$container.hide(),this.$radio=this.$container.find(".js-type-select"),this.$radio.prop("checked",!1),this.$previewContainer=this.$container.find(".js-preview-container"),this.$previewContainer.hide(),this.$previewContainer.append(e.$preview),this.loader=e.loader,this.loader.done((()=>{this.enable()})).fail((()=>{this.disable()}))}isEnabled(){return"resolved"===this.loader.state()}enable(){this.$container.show(),this.$previewContainer.show()}disable(){this.$container.hide(),this.$previewContainer.empty()}kill(){this.disable()}isChecked(){return this.$radio.prop("checked")}paste(){this.getSyntaxLines().then((e=>{this.selectionRange&&this.editor.setSelectionRange(this.selectionRange),i.EditorConnector.insertLines(e)}))}getSyntaxLines(){const e=this.syntax.split("\n"),t={html:e,hatena:e,markdown:e};return new Promise((e=>{(0,n.extractSyntax)(this.syntax).done((e=>{t.html=[e.html]})).always((()=>{e(t)}))}))}}},45241:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmbedBoxFotoCaption=void 0;var n=m(r(65311)),i=r(41960),a=m(r(84395)),o=m(r(57394)),s=m(r(75603)),l=m(r(1845)),d=m(r(59198)),u=r(75560),c=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=h(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),p=r(73380),f=r(27499);function h(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(h=function(e){return e?r:t})(e)}function m(e){return e&&e.__esModule?e:{default:e}}function g(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const v=r(26410);t.EmbedBoxFotoCaption=class{constructor(e){if(g(this,"altFormRef",null),this.expr="",void 0===e.editor||void 0===e.$container)throw new TypeError("Both editor and $container must be specified");({editor:this.editor,$container:this.$container}=e),this.$altAttrLabelAndInputPanel=this.$container.find(".js-embed-foto-detail"),this.$altCheckbox=this.$container.find(".js-checkbox-whether-alt-form"),this.$captionInput=this.$container.find(".js-embed-foto-caption"),this.$pasteForm=this.$container.find(".embed-box-form"),this.$uploadErrorBox=this.$container.find(".error-box"),this.thumbnailUrls=[],this.thumbnailsPanel=this.$container[0].querySelector(".js-thumbnails-panel"),this.altFormPanel=this.$container[0].querySelector(".js-alt-input-panel"),this.submitContainerPanel=this.$container[0].querySelector(".js-embed-submit-container"),this.registerEvents()}registerEvents(){this.$container.on("click",".js-close",(()=>{this.hide()})),this.$pasteForm.on("submit",(e=>{e.stopPropagation(),e.preventDefault(),this.doPaste()})),this.$container.on("keydown",":input",(e=>{"ESC"===(0,i.keyString)(e)&&this.hide()})),this.$altCheckbox.on("click",(e=>{this.$altAttrLabelAndInputPanel.toggleClass("is-hidden")}))}setThumbnailUrls(e){this.thumbnailUrls=e}show(e){this.isShown()||(this.$container.css("left",((0,n.default)(window).width()-this.$container.width())/2),e?this.$uploadErrorBox.removeClass("is-hidden"):this.$uploadErrorBox.addClass("is-hidden"),(0,p.safeRender)(c.createElement(l.default,{thumbnailUrls:this.thumbnailUrls}),this.thumbnailsPanel),(0,p.safeRender)(c.createElement(d.default,{thumbnailUrls:this.thumbnailUrls,ref:e=>{this.altFormRef=e}}),this.altFormPanel),(0,p.safeRender)(c.createElement(u.EmbedBoxFotoCaptionSubmitContainer,{willModifyCaption:!1,onClickClose:()=>{this.hide()}}),this.submitContainerPanel),v.show(this.$container,{showBackground:!0,then:()=>{this.$captionInput.focus()[0].select()},destroy:()=>{this.onHide()}}));return new Promise((e=>{this.resolve=e}))}setFotoExpression(e){this.expr=e}isShown(){return this.$container.is(":visible")}hide(){v.hide(this.$container)}onHide(){this.$captionInput.val("")}doPaste(){this.resolve();const e=this.altFormRef.getAltStrings(),t={coreExpr:this.expr,captionStr:this.$captionInput.val(),altStrings:e};let r;switch(this.editor.mode){case"html":r=new s.default(t);break;case"raw":r=new a.default(t);break;case"hatena":r=new f.EmbedBoxFotoCaptionExprBuilderHatena(t);break;default:r=new o.default(t)}!this.$altAttrLabelAndInputPanel.hasClass("is-hidden")&&r.injectAlt();const n=r.build();this.editor.insert(n),this.hide()}}},59198:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),i=o(r(20996)),a=o(r(40702));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}class l extends n.Component{constructor(e){super(e);const t=[];for(let r=0;r<e.thumbnailUrls.length;r+=1)t[r]="";this.state={altStrings:t}}componentDidUpdate(e){if(JSON.stringify(this.props.thumbnailUrls)===JSON.stringify(e.thumbnailUrls))return;const t=[];for(let e=0;e<this.props.thumbnailUrls.length;e+=1)t[e]="";this.setState({altStrings:t})}getAltStrings(){return this.state.altStrings}render(){const{thumbnailUrls:e}=this.props,{altStrings:t}=this.state;if(e.length>1){const r=e.map(((e,r)=>n.createElement("tr",{key:e},n.createElement("th",null,n.createElement(a.default,{url:e,order:r+1})),n.createElement("td",null,n.createElement("input",{type:"text",name:"image_alt",className:"js-embed-foto-alt full-width",placeholder:i.default.text("epic.image_alt"),value:t[r],onChange:e=>this.onFormChange(e,r)})))));return n.createElement("table",{className:"table-foto-alt table js-alt-def-table"},n.createElement("tbody",null,r))}return n.createElement("input",{type:"text",name:"image_alt",className:"js-embed-foto-alt full-width",placeholder:i.default.text("epic.image_alt"),value:t[0],onChange:e=>this.onFormChange(e,0)})}onFormChange(e,t){const r=[...this.state.altStrings];r[t]=e.currentTarget.value,this.setState({altStrings:r})}}var d=l;t.default=d},57394:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(66419))&&n.__esModule?n:{default:n};function a(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var o=class{constructor(e){if(a(this,"extraClasses",[]),a(this,"escapedCaptionStr",""),a(this,"coreExpr",""),a(this,"altStrings",[]),this.coreExpr=e.coreExpr,this.altStrings=e.altStrings,void 0===e.captionStr)throw new TypeError("caption must be defined");if(this.escapedCaptionStr=i.default.escape(e.captionStr),void 0===this.escapedCaptionStr)throw new Error("escaping caption failed")}build(){return 0===this.escapedCaptionStr.length?this.coreExpr:this._wrapWithCaption(this.coreExpr)}_wrapWithCaption(e){return[`<figure class="figure-image figure-image-fotolife${t=this.extraClasses,0===t.length?"":` ${t.join(" ")}`}" title="${this.escapedCaptionStr}">`,e,this.buildCaption(this.escapedCaptionStr),"</figure>"].join("");var t}buildCaption(e){return`<figcaption>${e}</figcaption>`}injectAlt(){this.coreExpr=this._injectAltNew(this.coreExpr,this.altStrings)}_injectAltNew(e,t){return t.forEach((t=>{e=e.replace(/:plain]/,`:plain:alt=${i.default.escape(t)}]`)})),e}};t.default=o},75603:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(57394))&&n.__esModule?n:{default:n};const a=r(66419);class o extends i.default{constructor(e){super(e),this.extraClasses=["mceNonEditable"]}build(){return`${super.build()}<br/>`}buildCaption(e){return`<figcaption class="mceEditable">${e}</figcaption>`}_injectAltNew(e,t){e=e.replace(/title="[^"]+" +/g,"");let r=0;return e=e.replace(/\bsrc=".*?" /g,(e=>`${e}alt="${a.escape(t[r++])}" `))}}var s=o;t.default=s},27499:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmbedBoxFotoCaptionExprBuilderHatena=void 0;var n,i=(n=r(57394))&&n.__esModule?n:{default:n};class a extends i.default{_wrapWithCaption(e){return`>${super._wrapWithCaption(e)}<`}}t.EmbedBoxFotoCaptionExprBuilderHatena=a},84395:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(57394)),i=a(r(66419));function a(e){return e&&e.__esModule?e:{default:e}}class o extends n.default{buildCaption(e){return`<figcaption class="mceEditable">${e}</figcaption>`}_injectAltNew(e,t){e=e.replace(/title="[^"]+" +/g,"");let r=0;return e=e.replace(/\bsrc=".*?" /g,(e=>`${e}alt="${i.default.escape(t[r++])}" `))}}var s=o;t.default=s},75560:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmbedBoxFotoCaptionSubmitContainer=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),a=(n=r(20996))&&n.__esModule?n:{default:n};function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}t.EmbedBoxFotoCaptionSubmitContainer=e=>i.createElement(i.Fragment,null,i.createElement("button",{className:"btn btn-primary js-paste-button",type:"submit"},a.default.text("epic.embed_photo.submit")),i.createElement("button",{type:"button",className:"btn js-close",onClick:e.onClickClose},a.default.text("cancel")))},40702:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=i(t);if(r&&r.has(e))return r.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=a?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,r&&r.set(e,n);return n}(r(67294));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(i=function(e){return e?r:t})(e)}class a extends n.PureComponent{render(){const e={backgroundImage:`url(${this.props.url})`};return n.createElement("div",{className:"embed-foto-thumb",style:e},n.createElement("div",{className:"item-order-label"},this.props.order.toString()))}}var o=a;t.default=o},1845:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),a=(n=r(40702))&&n.__esModule?n:{default:n};function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}class s extends i.PureComponent{render(){const e=this.props.thumbnailUrls.map(((e,t)=>i.createElement(a.default,{key:t,url:e,order:t+1})));return i.createElement("div",{className:"embed-foto-thumbs js-thumbnails"},e)}}var l=s;t.default=l},56173:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.entryOptionAdditionalItemComponentRegistry=t.EntryOption=void 0;var n=r(17187),i=r(73380),a=s(r(67294)),o=s(r(77405));function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const d=r(91269);const u=new class{constructor(){l(this,"event",new n.EventEmitter)}get Component(){return this._Component}set Component(e){this._Component=e,this.event.emit("changeComponent")}};t.entryOptionAdditionalItemComponentRegistry=u;t.EntryOption=class{constructor(e,t,r){l(this,"type","editor-option"),l(this,"params",void 0),this.type="editor-option",this.editor=t,this.sidebar=r,this.option=d.get("editor.entryOption"),this.container=e.find("#editor-option-react")[0],this.render(),r.on("tabChange",(()=>{this.render()})),u.event.on("changeComponent",(()=>{this.render()}))}render(){(0,i.safeRender)(a.default.createElement(o.default,{option:this.option,editor:this.editor,isOpen:this.sidebar.type===this.type,additionalItem:u.Component&&a.default.createElement(u.Component,null)}),this.container)}}},32325:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AdvancedSettingsEditor=void 0;var n=a(r(67294)),i=a(r(20996));function a(e){return e&&e.__esModule?e:{default:e}}t.AdvancedSettingsEditor=e=>n.default.createElement("div",{id:"advanced-settings",className:"editor-option-section editor-option-advanced-settings "+(e.useAdvancedSettings?"is-open":"")},n.default.createElement("span",{id:"toggle-advanced-settings",className:"editor-option-accordion",onClick:()=>e.toggleAdvancedSettings()},i.default.text("edit_form.advanced.settings"),n.default.createElement("i",{className:"blogicon-chevron-down"})),n.default.createElement("div",{className:"advanced-title-content js-advanced-title-content"},n.default.createElement("p",null,i.default.text("edit_form.advanced.settings.description")),n.default.createElement("h4",{className:"editor-option-item-heading"},i.default.text("edit_form.advanced_title.page_title")),n.default.createElement("textarea",{id:"advanced-page-title",name:"page_title",placeholder:i.default.text("edit_form.advanced_title.page_title"),value:e.pageTitle,onChange:t=>e.setPageTitle(t.target.value),rows:3}),n.default.createElement("h4",{className:"editor-option-item-heading"},i.default.text("edit_form.advanced_title.og_title")),n.default.createElement("textarea",{id:"advanced-og-title",name:"og_title",placeholder:i.default.text("edit_form.advanced_title.og_title"),value:e.ogTitle,onChange:t=>e.setOgTitle(t.target.value),rows:3}),e.canSetNoindexNofollow&&n.default.createElement("p",{className:"advanced-robot-checkbox"},n.default.createElement("input",{type:"checkbox",id:"advanced-robot",name:"noindex_nofollow",checked:e.noindexNofollow,onChange:t=>e.setNoindexNofollow(t.target.checked)}),n.default.createElement("label",{htmlFor:"advanced-robot"},i.default.text("edit_form.advanced_robot.robot_title")))))},73634:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetchCanvaButtonApi=void 0;var n=r(70879);const i=r(91269);let a=null;t.fetchCanvaButtonApi=()=>a||(a=new Promise(((e,t)=>{const r=document.createElement("script");r.src="https://sdk.canva.com/designbutton/v2/api.js",document.head.appendChild(r);const a=i.get("canva.apiKey");r.onload=async()=>{try{const t=await window.Canva.DesignButton.initialize({apiKey:a});e(t)}catch(e){t(e)}},r.onerror=()=>{const e=new Error(`Failed to load ${r.src}`);(0,n.BUG)(e,"fetchCanvaButtonApi"),t(e)}})),a)},57706:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CanvaButtonContainer=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=u(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),i=d(r(20996)),a=d(r(57942)),o=d(r(347)),s=r(73634),l=r(97050);function d(e){return e&&e.__esModule?e:{default:e}}function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(u=function(e){return e?r:t})(e)}const c=async(e,t,r,n)=>{const{setOgImage:i,editor:s,reloadImages:d,setIsLoadingOgImage:u,setOgImageFailed:c}=r,p=await o.default.get(e,{responseType:"blob"}),f=new URL(e).pathname.split("/").pop()||"",h=new File([p.data],f,{type:p.data.type}),m=new FormData;m.append("rkm",(0,a.default)("rkm")),m.append("append","1"),m.append("fototitle",""),m.append("folder","Hatena Blog"),m.append("image",h),m.append("fotosize","1200"),m.append("delete-gps","1"),u(!0),o.default.post(`/f/${(0,a.default)("name")}/upbysmart?with_image_url=1`,m).then((async e=>{const{hatena_syntax:r,image_url:a}=e.data;if(i(a),s.setSelectionRange({start:0,end:0}),"html"===s.syntaxForInsertLines){const e=await(0,l.extractFotolifeSyntax)(`[${r}]`);s.insert(e.html)}else s.insert(`[${(0,l.replaceImageToPlain)(r)}]\n`);d(),n(t)})).catch((()=>{u(!1),c(!0)}))};t.CanvaButtonContainer=e=>{const[t,r]=(0,n.useState)(null);return n.default.createElement("div",{className:"editor-option-section editor-option-canva"},n.default.createElement("button",{onClick:()=>(async(e,t,r)=>{const n=await(0,s.fetchCanvaButtonApi)();t?n.editDesign({design:{id:t},editor:{publishLabel:i.default.text("done")},onDesignPublish:t=>{let{exportUrl:n,designId:i}=t;c(n,i,e,r)}}):n.createDesign({design:{type:"HatenaEyeCatch"},editor:{publishLabel:i.default.text("done")},onDesignPublish:t=>{let{exportUrl:n,designId:i}=t;c(n,i,e,r)}})})(e,t,r),type:"button",className:"canva-design-button"},n.default.createElement("span",{className:"canva-button-i"}),n.default.createElement("span",{className:"canva-button-label"},i.default.text("edit_form.og_image.create"))),n.default.createElement("p",null,i.default.text("edit_form.og_image.create.canva_account_required"),n.default.createElement("br",null),n.default.createElement("a",{href:"https://www.canva.com/ja_jp/learn/hatena_eyecatch/",target:"_blank",rel:"noopener"},i.default.text("edit_form.og_image.create.help"))))}},68566:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o(r(67294)),i=r(41960),a=o(r(20996));function o(e){return e&&e.__esModule?e:{default:e}}var s=e=>{let{directoryPath:t,directoryUrl:r,isUrlDuplicate:o,customUrl:s,setCustomUrl:l,onBlur:d}=e;return n.default.createElement("div",{id:"custom-url",className:"editor-option-section editor-option-custom-url"},n.default.createElement("label",{htmlFor:"customurl-input"},n.default.createElement("h3",null,a.default.text("blog.custom_url"))),n.default.createElement("p",null,a.default.text("edit_form.url_description",r)),n.default.createElement("div",null,t,n.default.createElement("input",{type:"text",id:"customurl-input",name:"customurl",placeholder:a.default.text("blog.custom_url"),value:s,onChange:e=>l(e.target.value),onKeyDown:e=>(e=>{"RET"===(0,i.keyString)(e)&&(e.preventDefault(),e.stopPropagation())})(e),style:{width:"160px"},onBlur:e=>d(e.target.value)}),o&&n.default.createElement("div",{className:"error-msg"},a.default.text("blog.custom_url.error.duplicate"))))};t.default=s},98601:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o(r(27484)),i=o(r(67294)),a=o(r(20996));function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const l=r(84319),d=r(43459),u=e=>(0,n.default)(e).format("YYYY-MM-DD"),c=u(new Date);class p extends i.default.Component{constructor(){super(...arguments),s(this,"dateInput",null)}componentDidMount(){const e=this.props.date.match(/^\d{4}-\d{2}-\d{2}$/)?new Date(this.props.date):null;d("/css/external/pikaday.css"),this.datepicker=new l({field:this.dateInput,i18n:{previousMonth:a.default.text("edit_form.pikaday.previous_month"),nextMonth:a.default.text("edit_form.pikaday.next_month"),months:a.default.text("edit_form.pikaday.months").split(","),weekdays:a.default.text("edit_form.pikaday.weekdays").split(","),weekdaysShort:a.default.text("edit_form.pikaday.weekdays_short").split(",")},yearSuffix:a.default.text("edit_form.pikaday.year_suffix"),showMonthAfterYear:"true",defaultDate:e,setDefaultDate:!!e,onSelect:e=>this.props.onSelect(u(e))})}componentDidUpdate(e,t){e.date!==this.props.date&&(this.datepicker.setDate(this.props.date,!0),this.dateInput&&this.dateInput.setCustomValidity(this.props.validity))}cancelEnter(e){13===e.keyCode&&(e.preventDefault(),e.stopPropagation())}render(){return i.default.createElement("input",{type:"text",className:"datetime-input-date","data-testid":"date-input",ref:e=>{this.dateInput=e},autoComplete:"off",placeholder:c,pattern:"\\d{4}-\\d{2}-\\d{2}",value:this.props.date,onKeyDown:e=>this.cancelEnter(e),onChange:e=>this.props.onChange(e)})}}var f=p;t.default=f},37067:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=l(r(27484)),i=l(r(67294)),a=l(r(20996)),o=l(r(98601)),s=l(r(64246));function l(e){return e&&e.__esModule?e:{default:e}}const d=(u=new Date,(0,n.default)(u).format("YYYY-MM-DD"));var u;function c(e){const t=e.match(/^(\d{4}-\d{2}-\d{2})T(\d{2}:\d{2}:\d{2})(?:\+(\d{2}:\d{2}))?$/),[,r,n,i]=t||[void 0,"","",""];return{date:r,time:n.replace(/(\d{2}:\d{2}):00/,"$1"),tz:i}}class p extends i.default.Component{constructor(e){super(e),this.state=c(e.datetime)}componentDidUpdate(e){this.props.datetime!==e.datetime&&this.setState(c(this.props.datetime))}mergeDateTime(e,t,r){const i=r?`+${r}`:"";return`${(0,n.default)(`${e}T${t}`).format("YYYY-MM-DDTHH:mm:ss")}${i}`}isValidDate(e){return!!e.match(/^\d{4}-\d{2}-\d{2}$/)}isValidTime(e){const t=e.match(/^(\d{2}):(\d{2})(?::(\d{2}))?$/);if(!t)return!1;const r=parseInt(t[1],10),n=parseInt(t[2],10),i=parseInt(t[3]||"0",10);return 0<=r&&r<24&&0<=n&&n<60&&0<=i&&i<60}setDateTime(e,t,r){const n=this.mergeDateTime(e,t,r);this.props.setDateTime(n)}resetDateTime(){this.props.setDateTime("")}setDate(e){if(this.setState({date:e}),this.isValidDate(e)){const t=this.isValidTime(this.state.time)?this.state.time:"00:00";this.setDateTime(e,t,this.state.tz)}else""===e&&""===this.state.time&&this.resetDateTime()}setTime(e){if(this.setState({time:e}),this.isValidTime(e)){const t=this.isValidDate(this.state.date)?this.state.date:d;this.setDateTime(t,e,this.state.tz)}else""===e&&""===this.state.date&&this.resetDateTime()}isPast(){return(0,n.default)(this.props.datetime).isBefore((0,n.default)())}renderScheduleCheckBox(){if(!this.props.isNewOrDraft||!this.props.canPostScheduledEntry)return null;const e=this.props.isScheduledEntry?void 0:"checked",t=[],r=this.props.willPublish;return this.props.isScheduledEntry&&t.push("checked"),this.isPast()&&t.push("disabled"),i.default.createElement("div",null,i.default.createElement("p",{className:"editor-option-scheduled-section"},i.default.createElement("label",{className:e},i.default.createElement("input",{type:"radio",name:"is_scheduled_entry",value:"0",className:"js-scheduled-entry-checkbox","data-testid":"schedule-checkbox-0",checked:!this.props.isScheduledEntry,disabled:!this.props.datetime,onChange:()=>this.props.onScheduledEntryChanged(!1)}),r?a.default.text("edit_form.publish_soon"):a.default.text("edit_form.set_draft_datetime"))),i.default.createElement("p",{className:"editor-option-scheduled-section"},i.default.createElement("label",{className:t.join(" ")},i.default.createElement("input",{type:"radio",name:"is_scheduled_entry",value:"1",className:"js-scheduled-entry-checkbox","data-testid":"schedule-checkbox-1",checked:this.props.isScheduledEntry,disabled:!this.props.datetime||this.isPast(),onChange:()=>this.props.onScheduledEntryChanged(!0)}),a.default.text("edit_form.schedule_this_entry"))))}render(){return this.props.canSetDatetime?i.default.createElement("div",{id:"datetime",className:"editor-option-section"},i.default.createElement("h3",null,a.default.text("blog.datetime")),i.default.createElement("p",null,this.props.isNewOrDraft&&this.props.canPostScheduledEntry?a.default.text("edit_form.datetime_description"):a.default.text("edit_form.published_datetime_description")),i.default.createElement("input",{type:"hidden",size:10,id:"datetime-input",name:"datetime","data-with-backup":!0,value:this.props.datetime}),i.default.createElement("div",{className:"datetime-input"},i.default.createElement(o.default,{validity:this.props.isScheduledPast?a.default.text("edit_form.schedule_coming_entry"):"",date:this.state.date,onChange:e=>this.setDate(e.target.value),onSelect:e=>this.setDate(e)}),i.default.createElement(s.default,{time:this.state.time,onChange:e=>this.setTime(e.target.value),onSubmit:e=>this.setTime(e)})),this.renderScheduleCheckBox()):null}}var f=p;t.default=f},77405:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=b(r(30381)),i=b(r(67294)),a=b(r(57942)),o=r(13964),s=r(43652),l=b(r(347)),d=r(32325),u=r(57706),c=b(r(68566)),p=b(r(37067)),f=b(r(7783)),h=b(r(62225)),m=b(r(93959)),g=r(47377),v=b(r(61053));function b(e){return e&&e.__esModule?e:{default:e}}function y(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const _=r(80129);r(66419);function w(e,t){e&&null!=e[0]&&t(e[0])}class E extends i.default.Component{constructor(e){super(e),y(this,"setCustomUrl",(e=>this.setState({customUrl:e}))),y(this,"setLayout",(e=>this.setState({layout:e}))),y(this,"removeOgImage",(()=>this.setState({ogImage:void 0}))),y(this,"setOgImage",(e=>this.setState({ogImage:e}))),y(this,"setOgDescription",(e=>this.setState({ogDescription:e}))),y(this,"toggleAdvancedSettings",(()=>this.setState({useAdvancedSettings:!this.state.useAdvancedSettings}))),y(this,"setPageTitle",(e=>this.setState({pageTitle:e}))),y(this,"setOgTitle",(e=>this.setState({ogTitle:e}))),y(this,"setNoindexNofollow",(e=>this.setState({noindexNofollow:e}))),y(this,"shouldShowSocializeBox",(()=>!!this.state.isScheduledEntry&&!this.isScheduledPast())),this.state={...e.option,ogImageCandidates:[e.option.defaultOgImage],isLoadingOgImage:!1,ogImageFailed:!1,isOpen:e.isOpen,isUrlDuplicate:!1,willPublish:e.option.isNew},this.state.socializeServiceIds.forEach((e=>{this.state.socializeServices[e].valid=!0})),this.props.editor.$form.on("backup-restore-params",((e,t)=>{w(t.datetime,(e=>this.setDateTime(e))),w(t.customurl,(e=>this.setCustomUrl(e))),w(t.layout,(e=>this.setLayout(e))),w(t.og_description,(e=>this.setOgDescription(e))),w(t.og_image,(e=>this.setOgImage(e))),w(t.og_title,(e=>this.setOgTitle(e))),w(t.page_title,(e=>this.setPageTitle(e)))}))}componentDidMount(){this.props.editor.bind("updateWillPublish",((e,t)=>{this.setState({willPublish:t})}))}isScheduledPast(){return this.state.isScheduledEntry&&this.isPastMoment((0,n.default)(this.state.datetime))}setDateTime(e){const t=""!==e,r={datetime:e};this.state.isNew&&(r.isScheduledEntry=t&&!this.isPastMoment((0,n.default)(e))),this.setState(r)}onScheduledEntryChanged(e){this.props.editor.emit("toggleScheduledEntry",e),this.setState({isScheduledEntry:e})}isPastMoment(e){return e.isBefore((0,n.default)())}checkSocialize(e,t){const{socializeServices:r}=this.state;r[e].checked=t,this.setState({socializeServices:r})}updateServiceMessage(e,t){const{socializeServices:r}=this.state;r[e].message=t,"twitter"===e&&(r[e].valid=(0,o.validateTweetLength)(t)),this.setState({socializeServices:r})}onBlur(e){if(!e)return;const t=this.props.editor.getEntryId(),r=(0,a.default)("blog-uuid");l.default.get("/api/1/json/custom_url",{params:{custom_url:e,entry_id:t,blog_id:r,rkm:(0,a.default)("rkm"),rkc:(0,a.default)("rkc")}}).then((e=>{this.setState({isUrlDuplicate:e.data.isExisting})})).catch((()=>{}))}reloadImages(){if(this.state.isLoading)return;const e=this.props.editor,t=e.getBody();t?(this.setState({isLoadingOgImage:!0}),l.default.post("/api/entry/images",_.stringify({body:t,syntax:e.getSyntax(),rkm:(0,a.default)("rkm"),rkc:(0,a.default)("rkc")})).then((e=>{this.setState({ogImageCandidates:[this.state.defaultOgImage,...e.data]})})).catch((()=>{this.setState({ogImageFailed:!0})})).then((()=>{this.setState({isLoadingOgImage:!1})}))):this.setState({ogImageCandidates:[this.state.defaultOgImage]})}componentDidUpdate(e,t,r){e.isOpen!==this.props.isOpen&&this.props.isOpen&&this.reloadImages()}render(){return this.props.editor.emit("toggleScheduledEntry",this.state.isScheduledEntry),i.default.createElement("div",null,i.default.createElement(f.default,{canChangeLayout:!!this.state.canChangeLayout,availableLayouts:this.state.availableLayouts,layout:this.state.layout,setLayout:e=>this.setLayout(e)}),this.props.additionalItem,!this.state.isEditingScheduledUpdate&&i.default.createElement(m.default,{ogImage:this.state.ogImage||"",defaultOgImage:this.state.defaultOgImage||"",ogImageCandidates:this.state.ogImageCandidates,isLoadingOgImage:this.state.isLoadingOgImage,ogImageFailed:this.state.ogImageFailed,setOgImage:e=>this.setOgImage(e),removeOgImage:()=>this.removeOgImage(),reloadImages:()=>this.reloadImages()}),!this.state.isEditingScheduledUpdate&&i.default.createElement(u.CanvaButtonContainer,{setOgImage:e=>this.setOgImage(e),editor:this.props.editor,reloadImages:()=>this.reloadImages(),setIsLoadingOgImage:e=>this.setState({isLoadingOgImage:e}),setOgImageFailed:e=>this.setState({ogImageFailed:e})}),!this.state.isEditingScheduledUpdate&&i.default.createElement(c.default,{directoryPath:this.state.directoryPath,directoryUrl:this.state.directoryUrl,isUrlDuplicate:this.state.isUrlDuplicate,customUrl:this.state.customUrl,setCustomUrl:e=>this.setCustomUrl(e),onBlur:e=>this.onBlur(e)}),!this.state.isEditingScheduledUpdate&&i.default.createElement(p.default,{canSetDatetime:!!this.state.canSetDatetime,canPostScheduledEntry:!!this.state.canPostScheduledEntry,datetime:this.state.datetime||"",isNewOrDraft:!!this.state.isNewOrDraft,isScheduledEntry:!!this.state.isScheduledEntry,isScheduledPast:this.isScheduledPast(),onScheduledEntryChanged:e=>this.onScheduledEntryChanged(e),setDateTime:e=>this.setDateTime(e),willPublish:!!this.state.willPublish}),this.state.isEditingScheduledUpdate&&i.default.createElement(g.ScheduledUpdateOptionSection,{currentDateTime:""!==this.state.scheduledUpdateAt?new Date(this.state.scheduledUpdateAt):new Date}),i.default.createElement(v.default,{services:this.state.socializeServices,serviceIds:this.state.socializeServiceIds,isIframe:(0,s.isIframe)(window),isNewOrDraft:!!this.state.isNewOrDraft,shouldShow:this.shouldShowSocializeBox(),showExternalAuthLink:!!this.state.showExternalAuthLink,checkSocialize:(e,t)=>this.checkSocialize(e,t),updateServiceMessage:(e,t)=>this.updateServiceMessage(e,t)}),!this.state.isEditingScheduledUpdate&&i.default.createElement(h.default,{ogDescription:this.state.ogDescription,setOgDescription:e=>this.setOgDescription(e)}),!this.state.isEditingScheduledUpdate&&i.default.createElement(d.AdvancedSettingsEditor,{ogTitle:this.state.ogTitle,pageTitle:this.state.pageTitle,noindexNofollow:this.state.noindexNofollow,useAdvancedSettings:!!this.state.useAdvancedSettings,canSetNoindexNofollow:this.state.canSetNoindexNofollow,toggleAdvancedSettings:()=>this.toggleAdvancedSettings(),setOgTitle:e=>this.setOgTitle(e),setPageTitle:e=>this.setPageTitle(e),setNoindexNofollow:e=>this.setNoindexNofollow(e)}))}}var S=E;t.default=S},7783:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(r(67294)),i=s(r(20996)),a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(55992));function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}function s(e){return e&&e.__esModule?e:{default:e}}var l=e=>e.canChangeLayout?n.default.createElement("div",{id:"layout",className:"editor-option-section"},n.default.createElement("label",{htmlFor:"layout-input"},n.default.createElement("h3",null,n.default.createElement("span",{className:"badge"},i.default.text("publication_type.page"))," ",i.default.text("publication.layout"))),n.default.createElement("p",null,i.default.text("publication.layout.description")),n.default.createElement("div",{className:"editor-option-layout-wrapper"},n.default.createElement("ul",{className:"editor-option-layout"},e.availableLayouts.map((t=>n.default.createElement("li",{className:"editor-option-layout-item",key:`editor-option-layout-${t}`},n.default.createElement("div",{className:"editor-option-layout-image"},n.default.createElement("label",{htmlFor:`input-layout-${t}`},n.default.createElement("img",{src:a.staticUrl(`/images/admin/edit/pages-layout-${t}.svg`)}))),n.default.createElement("div",{className:"editor-option-layout-content"},n.default.createElement("label",{className:"editor-option-layout-label is-selected"},n.default.createElement("input",{id:`input-layout-${t}`,type:"radio",name:"layout",value:t,onChange:t=>e.setLayout(t.target.value),checked:t===e.layout}),n.default.createElement("span",{className:"editor-option-layout-heading"},i.default.text(`publication.layout.${t}`))),n.default.createElement("p",null,i.default.text(`publication.layout.${t}.description`))))))))):null;t.default=l},62225:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(67294)),i=a(r(20996));function a(e){return e&&e.__esModule?e:{default:e}}var o=e=>n.default.createElement("div",{id:"og-description",className:"editor-option-section"},n.default.createElement("label",{htmlFor:"og-description-input"},n.default.createElement("h3",null,i.default.text("edit_form.og_description.label"))),n.default.createElement("p",null,i.default.text("edit_form.og_description.description")),n.default.createElement("div",null,n.default.createElement("textarea",{id:"og-description-input",name:"og_description",placeholder:i.default.text("edit_form.og_description.placeholder"),rows:8,value:e.ogDescription,onChange:t=>e.setOgDescription(t.target.value)})));t.default=o},93959:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=d(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),a=r(55992),o=(n=r(20996))&&n.__esModule?n:{default:n},s=r(41960),l=r(90381);function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(d=function(e){return e?r:t})(e)}class u extends i.Component{constructor(e){super(e),this.state={inputValue:e.ogImage||""}}componentDidMount(){this.props.reloadImages()}componentDidUpdate(e){this.props.ogImage!==e.ogImage&&this.setState({inputValue:this.props.ogImage})}onChange(e){this.setState({inputValue:e.target.value})}onKeyDown(e){"RET"===(0,s.keyString)(e)&&(this.props.setOgImage(this.state.inputValue),e.preventDefault(),e.stopPropagation())}onBlur(e){this.props.setOgImage(this.state.inputValue)}renderImageList(){return this.props.isLoadingOgImage?i.default.createElement(l.LoadingIndicator,null):this.props.ogImageFailed?i.default.createElement("div",{className:"error"},o.default.text("edit_form.og_image_upload_failure")):this.props.ogImageCandidates.map(((e,t)=>this.renderItem(e,t)))}renderItem(e,t){const r=this.props.ogImage===e,n="image-item "+(r?"selected":"");return i.default.createElement("li",{className:n,key:t,onClick:()=>r?this.props.removeOgImage():this.props.setOgImage(e)},i.default.createElement("span",{className:"image-container"},i.default.createElement("img",{src:e})))}render(){return i.default.createElement("div",{id:"og-image",className:"editor-option-section","data-default-ogimage-url":this.props.defaultOgImage},i.default.createElement("label",{htmlFor:"ogimage-input"},i.default.createElement("h3",null,o.default.text("blog.og_image"))),i.default.createElement("button",{className:"reload",type:"button",tabIndex:-1,onClick:()=>this.props.reloadImages()},i.default.createElement("i",{className:"blogicon-repeat"})),i.default.createElement("p",null,o.default.text("edit_form.og_image_description"),i.default.createElement("a",{href:(0,a.helpUrl)("/entry/post_thumbnail"),target:"_blank",rel:"noopener noreferrer"},o.default.text("epic.show_detail"))),i.default.createElement("div",{className:"og-image-selector"},i.default.createElement("div",{className:"image-items"},i.default.createElement("ul",null,this.renderImageList())),i.default.createElement("div",{className:"selector-input",id:"og-image-input-container"},i.default.createElement("input",{type:"url",size:50,title:o.default.text("edit_form.input_url.specify"),id:"ogimage-input",name:"ogimage",placeholder:o.default.text("edit_form.input_url.specify"),value:this.state.inputValue,onChange:e=>this.onChange(e),onKeyDown:e=>this.onKeyDown(e),onBlur:e=>this.onBlur(e)}),i.default.createElement("span",{className:"remove-og-image",onClick:()=>this.props.removeOgImage()},i.default.createElement("i",{className:"blogicon-close"})))))}}var c=u;t.default=c},47377:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScheduledUpdateOptionSection=void 0;var n=d(r(20996)),i=d(r(98601)),a=d(r(64246)),o=r(67831),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=l(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294));function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(l=function(e){return e?r:t})(e)}function d(e){return e&&e.__esModule?e:{default:e}}t.ScheduledUpdateOptionSection=e=>{let{currentDateTime:t}=e;const{inputValue:r,dateValue:l,datetime:d,setDate:u,setTime:c,timeValue:p,submitTime:f,selectDate:h}=(0,o.useDateAndTimeInput)({currentDateTime:t}),[m]=(0,s.useState)((()=>new Date));return s.default.createElement("div",{id:"datetime",className:"editor-option-section"},s.default.createElement("h3",null,""),s.default.createElement("p",null,""),s.default.createElement("input",{type:"hidden",name:"schedule_update_at",value:r}),s.default.createElement("div",{className:"datetime-input"},s.default.createElement(i.default,{validity:d.isBefore(m)?n.default.text("edit_form.schedule_coming_entry"):"",date:l,onChange:u,onSelect:h}),s.default.createElement(a.default,{time:p,onChange:c,onSubmit:f})))}},67831:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useDateAndTimeInput=void 0;var n,i=(n=r(27484))&&n.__esModule?n:{default:n},a=r(67294);t.useDateAndTimeInput=e=>{let{currentDateTime:t}=e;const[r,n]=(0,a.useState)((()=>(0,i.default)(t))),[o,s]=(0,a.useState)((()=>r.format("YYYY-MM-DD"))),[l,d]=(0,a.useState)((()=>r.format("HH:mm:ss").replace(/:00$/,""))),u=(0,a.useMemo)((()=>r.format("YYYY-MM-DDTHH:mm:ss")),[r]),c=(0,a.useCallback)(((e,t)=>{s(e),d(t),n((r=>{const n=(0,i.default)(`${e}T${t}`,"YYYY-MM-DDTHH:mm:ss");return n.isValid()?n:r}))}),[]),p=(0,a.useCallback)((e=>{c(e,r.format("HH:mm:ss").replace(/:00$/,""))}),[r,c]),f=(0,a.useCallback)((e=>{c(r.format("YYYY-MM-DD"),e)}),[r,c]),h=(0,a.useCallback)((e=>{p(e.target.value)}),[p]),m=(0,a.useCallback)((e=>{f(e.target.value)}),[f]);return{datetime:r,inputValue:u,dateValue:o,timeValue:l,setDate:h,setTime:m,submitTime:f,selectDate:p}}},61053:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o(r(67294)),i=o(r(20996)),a=o(r(57942));function o(e){return e&&e.__esModule?e:{default:e}}class s extends n.default.Component{renderCheckBox(e){const t=!(e.enabled&&e.valid);return n.default.createElement("div",null,n.default.createElement("input",{type:"checkbox",name:e.input_name,id:e.service,className:"editor-socialize-box-checkbox",checked:e.checked,disabled:t,onChange:()=>this.props.checkSocialize(e.service,!e.checked)}),n.default.createElement("label",{htmlFor:e.service},i.default.text(e.msgid)))}renderTextArea(e){if(!e.textarea_name||!e.enabled)return null;if("twitter"===e.service){const t=null!==e.fillin_msgid?i.default.text(e.fillin_msgid):"",r=null!==e.message?e.message:t;return n.default.createElement("div",null,n.default.createElement("textarea",{name:e.textarea_name,value:r,onChange:t=>this.props.updateServiceMessage(e.service,t.target.value)}),n.default.createElement("p",{className:"error-box js-twitter-length-error",style:{display:e.valid?"none":"block"}},i.default.text("blog.twitter.length.over.error")))}return null}renderExternalAuthLink(){return this.props.showExternalAuthLink?n.default.createElement("div",null,n.default.createElement("a",{href:(e="/-/config/external?with_parent_window=1",`${(0,a.default)("admin-domain")}${e}`),target:this.props.isIframe?"_parent":"",tabIndex:3,"data-track-name":"edit-done-external-auth-link","data-track-once":"1","data-open-external-auth-link":"1"}," ",i.default.text("go_to_settings"))):null;var e}render(){if(!this.props.isNewOrDraft)return null;if(!this.props.shouldShow)return null;const e=this.props.serviceIds.map((e=>this.props.services[e]));return n.default.createElement("div",{className:"editor-socialize-box editor-option-section"},n.default.createElement("h3",null,i.default.text("blog.editform.label.socialize_on_post")),n.default.createElement("ul",{className:"editor-socialize-box-ul"},e.map((e=>n.default.createElement("li",{key:e.msgid,className:`editor-socialize-box-li ${e.class_name} ${e.enabled?"":"disable"}`},this.renderCheckBox(e),this.renderTextArea(e))))),this.renderExternalAuthLink())}}var l=s;t.default=l},64246:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n},a=r(41205);const o=[];for(let e=0;e<24;e+=1){const t=`0${e}`.slice(-2);o.push(`${t}:00`,`${t}:30`)}class s extends i.default.Component{cancelEnter(e){13===e.keyCode&&(e.preventDefault(),e.stopPropagation())}render(){const e={type:"text",className:"datetime-input-time",autoComplete:"off",placeholder:"00:00",pattern:"\\d{2}:\\d{2}(:\\d{2})?",value:this.props.time,onKeyDown:this.cancelEnter,onInput:this.props.onChange};return i.default.createElement("div",{className:"datetime-input-time-wrapper",style:{display:"inline-block"}},i.default.createElement(a.AutoCompleteInput,{inputProps:e,max:7,showDefault:!0,filter:!1,suggestions:o,onSubmit:this.props.onSubmit,onCancel:()=>{}}))}}var l=s;t.default=l},31427:(e,t,r)=>{"use strict";var n=s(r(20996)),i=r(41960),a=s(r(57942)),o=r(57753);function s(e){return e&&e.__esModule?e:{default:e}}const l=r(65311),d=r(66419),u=r(28507);class c extends o.MyCuration{get type(){return"editor-evernote"}get serviceName(){return"Evernote"}constructor(e){super(e),this.editor=e.editor,this.sidebar=e.sidebar,this.$keywordInput=e.container.find(".evernote-search-keyword"),this.$keywordSubmit=e.container.find(".evernote-search-keyword-submit"),this._searchDeferred=null,this.bindEvents()}bindEvents(){super.bindEvents(),this.$keywordSubmit.on("click",(()=>(this.search(),!1))),this.$keywordInput.on("keydown",(e=>{if("RET"===(0,i.keyString)(e))return this.search(),!1})),this.$container.on("insert_items",((e,t)=>{const r=t.$items,n=d.chain(r).map((e=>e.find(".evernote-item-resource").get())).flatten().value();this.requestInsertResources(n);const i=d.chain(r).map((e=>e.find(".evernote-search-item-title").text())).find((e=>e)).value(),a=this.editor.getTitle();i&&!a&&this.editor.setTitle(i)}))}loadNoteContents(e){e.forEach((e=>{const t=this.$itemsContainer.find(`.item[data-item-guid=${e.guid}]`);l.ajax({url:"/api/evernote/note",type:"GET",dataType:"json",data:{content:1,guid:t.attr("data-item-guid")}}).done((e=>{if(!e||!e.content)return;const r="html"===this.editor.getSyntax()?"html":"plain",n=d.unescape(e.content.extended[r]),i=d.unescape(e.content.extended.excerpt);t.find(".evernote-search-item-body").text(n),t.find(".evernote-search-item-body-preview").text(i),t.attr("data-loaded-body",!0),e.extended.has_resource&&(this.appendResources({item:t,resources:e.resources}),this.previewResources({item:t,resources:e.resources}))}))}))}loadItems(){return l.ajax({url:"/api/evernote/notes_metadata",type:"GET",dataType:"json",data:{filter_order:"created"}}).pipe((e=>{if(!e)return e;if(e.is_error){if(e.is_error&&"auth_expired"===e.error_details.type)return this.$container.html(this.$container.find(".auth-expired-template").html()).removeClass("enabled").addClass("disabled"),e}else e.entries=e.notes;return this.itemsReachedEnd=!e.extended.has_next,e})).fail((e=>{if(!e)return e;let t=null;try{t=l.parseJSON(e.responseText)}catch(e){}return t&&t.is_rate_limit_reached?(this.$container.html(this.$container.find(".rate-limit-reached-template").html()).removeClass("enabled").addClass("disabled"),e):void 0}))}previewResources(e){const t=e.item,r=e.resources;if(r.length<=0)return;const n=r[0],i=l("<img/>");i.attr("src",`/api/evernote/thumbnail?guid=${n.guid}`),i.addClass("resource-image"),u((()=>t.attr("data-loaded-body")),(()=>t.find(".evernote-image-preview").append(i)))}appendResources(e){const t=e.item,r=e.resources;t.attr("data-has-resource",!0),t.addClass("has-resource");const n=r.map((e=>{const t=l("<li/>"),r={"data-guid":e.guid};return t.attr(r),t.addClass("evernote-item-resource"),t}));t.find(".evernote-item-resources").append(n)}requestInsertResources(e){const t=e.shift();if(!t)return;const r=l(t);if(r.attr("data-uploaded"))this.insertFotolifeImage({annotation:r.attr("data-fotolife-annotation"),html:r.attr("data-fotolife-html"),hex_body_hash:r.attr("data-hex-body-hash")}),this.requestInsertResources(e);else{this.requestUploadResource(r).done((()=>{this.requestInsertResources(e)}))}}requestUploadResource(e){return l.ajax({url:"/api/upload/evernote/resource",type:"POST",dataType:"json",data:{rkm:(0,a.default)("rkm"),rkc:(0,a.default)("rkc"),guid:e.attr("data-guid")}}).done((t=>{this.onCompleteUploadingResource(e,t)}))}onCompleteUploadingResource(e,t){e.attr({"data-uploaded":1,"data-fotolife-annotation":t.annotation,"data-fotolife-html":t.html,"data-hex-body-hash":t.hex_body_hash}),this.insertFotolifeImageByResource(e)}insertFotolifeImageByResource(e){e.attr("data-uploaded")&&this.insertFotolifeImage({annotation:e.attr("data-fotolife-annotation"),html:e.attr("data-fotolife-html"),hexBodyHash:e.attr("data-hex-body-hash")})}insertFotolifeImage(e){const t=e.annotation,r=e.hexBodyHash,i=e.html,a=n.default.text("uploading"),o=this.editor.getBody(),s=`[evernote:${r} ${a}]`,l="html"===this.editor.getSyntax()?i:`[${t}]`,d=o.replace(s,l);this.editor.setValue(d)}resourcesAreUploaded(e){return e.find(".evernote-resource").get().every((e=>e.getAttribute("data-uploaded")))}insertItems(e){u((()=>this._readyToInsert(e)),(()=>this._insertItems(e)))}_readyToInsert(e){return e.every((e=>{const t=e.attr("data-loaded-body"),r=!e.attr("data-has-resource")||this.resourcesAreUploaded(e);return t&&r}))}_insertItems(e){const t=n.default.text("uploading"),r=e.map((e=>e.find(".evernote-search-item-body").text().replace(/\[evernote:([^\]]*)\]/gm,`[evernote:$1 ${t}]`)));this.editor.insertLines(r),this.$container.trigger("insert_items",{$items:e,lines:r})}showItems(e){super.showItems(e),this.loadNoteContents(e)}search(){const e=this.$keywordInput.val().trim();if(0===e.length)return this.requestReload(),!1;this.$itemsContainer.find(".evernote-search-item").remove(),this._searchDeferred&&this._searchDeferred.reject(),this.ajaxStarted(),this._searchDeferred=this._searchAll(e),this._searchDeferred.always((()=>this.ajaxFinished()))}_searchAll(e){const t=l.Deferred();let r=this._searchWithOffset(e,0);return r.done((n=>{this.showItems(n.notes),n.extended.has_next&&n.extended.next_offset?r=this._searchWithOffset(e,n.extended.next_offset):t.resolve()})).fail((e=>t.reject(e))),t.fail((()=>{r&&r.abort()})),t}_searchWithOffset(e,t){return l.ajax({url:"/api/evernote/notes_metadata",data:{offset:t,filter_order:"created",filter_words:e}})}ajaxStarted(){this.isAjaxing=!0,this.$keywordSubmit.prop("disabled",!0),this.$indicator.show(),this.$errorMessage.hide()}ajaxFinished(){this.isAjaxing=!1,this.$keywordSubmit.prop("disabled",!1),this.$errorMessage.hide(),this.$indicator.hide()}}e.exports=c},48862:e=>{"use strict";e.exports={actions:{SEARCH:{LOAD:"FLICKR:SEARCH:LOAD",START_LOADING:"FLICKR:SEARCH:START_LOADING",FINISH_LOADING:"FLICKR:SEARCH:FINISH_LOADING",INIT_WITH_WORD:"FLICKR:SEARCH:INIT_WITH_WORD",TOGGLE_SELECTION:"FLICKR:SEARCH:TOGGLE_SELECTION",INSERT_SELECTED:"FLICKR:SEARCH:INSERT_SELECTED",INSERT_DOUBLE_CLICKED:"FLICKR:SEARCH:INSERT_DOUBLE_CLICKED"},PHOTOSTREAM:{LOAD:"FLICKR:PHOTOSTREAM:LOAD",REGISTER_USER:"FLICKR:PHOTOSTREAM:REGISTER_USER",UNREGISTER_USER:"FLICKR:PHOTOSTREAM:UNREGISTER_USER",HIDE_WELCOME_MESSAGE:"FLICKR:PHOTOSTREAM:HIDE_WELCOME_MESSAGE",START_LOADING:"FLICKR:PHOTOSTREAM:START_LOADING",FINISH_LOADING:"FLICKR:PHOTOSTREAM:FINISH_LOADING",TOGGLE_SELECTION:"FLICKR:PHOTOSTREAM:TOGGLE_SELECTION",INSERT_SELECTED:"FLICKR:PHOTOSTREAM:INSERT_SELECTED",INSERT_DOUBLE_CLICKED:"FLICKR:PHOTOSTREAM:INSERT_DOUBLE_CLICKED"}}}},73599:(e,t,r)=>{"use strict";var n=r(45441),i=r(46007);const a=r(48862).actions,o=r(73287);class s extends o.Actions{registerUser(e){/^\s*$/.test(e)||(0,n.fetchUserInfo)(e).then((e=>{this.emit(a.PHOTOSTREAM.REGISTER_USER,e),this._load(e.data.nsid,1)})).catch((()=>{this.emit(a.PHOTOSTREAM.HIDE_WELCOME_MESSAGE)}))}unregisterUser(){this.emit(a.PHOTOSTREAM.UNREGISTER_USER)}loadMore(e){if(e.isLoading||!e.hasMore)return;const t=e.user.id,r=e.page;this._load(t,r)}toggleSelection(e){this.emit(a.PHOTOSTREAM.TOGGLE_SELECTION,e)}insertSelected(){this.emit(a.PHOTOSTREAM.INSERT_SELECTED)}insertDoubleClicked(e){this.emit(a.PHOTOSTREAM.INSERT_DOUBLE_CLICKED,e)}load(e,t){this._load(e,t)}_load(e,t){this.emit(a.PHOTOSTREAM.START_LOADING),(0,i.fetchUserPhotostream)(e,t).then((e=>{this.emit(a.PHOTOSTREAM.LOAD,e.data),this.emit(a.PHOTOSTREAM.FINISH_LOADING,e)}))}}e.exports=new s},51192:(e,t,r)=>{"use strict";const n=r(48862).actions,i=r(73287),a=r(29806);class o extends i.Actions{load(e,t){e.isLoading||/^\s*$/.test(t)||(this.emit(n.SEARCH.INIT_WITH_WORD,t),this.emit(n.SEARCH.START_LOADING),a(t).then((e=>{this.emit(n.SEARCH.LOAD,e.data),this.emit(n.SEARCH.FINISH_LOADING,e)})))}loadMore(e){!e.isLoading&&e.hasMore&&(this.emit(n.SEARCH.START_LOADING),a(e.word,e.page).then((e=>{this.emit(n.SEARCH.LOAD,e.data),this.emit(n.SEARCH.FINISH_LOADING,e)})))}toggleSelection(e){this.emit(n.SEARCH.TOGGLE_SELECTION,e)}insertSelected(){this.emit(n.SEARCH.INSERT_SELECTED)}insertDoubleClicked(e){this.emit(n.SEARCH.INSERT_DOUBLE_CLICKED,e)}}e.exports=new o},81915:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Footer=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),a=(n=r(9825))&&n.__esModule?n:{default:n};function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}class s extends i.Component{render(){const e=!this.props.hasSelectedItems;return i.createElement("div",{className:"editor-sidebar-flickr_footer"},i.createElement(a.default,{disabled:e,trackingId:this.props.trackingId,onClick:()=>this.props.onClickInsertButton()}))}}t.Footer=s},38778:(e,t,r)=>{"use strict";var n,i=(n=r(20996))&&n.__esModule?n:{default:n},a=r(49383);const o=r(67294),s=r(37357),l=r(66972);class d extends o.Component{render(){const e=[{key:"photostream",name:i.default.text("edit_form.flickr.photostream"),component:s},{key:"search",name:i.default.text("edit_form.flickr.search"),component:l}];return o.createElement("div",{className:"editor-sidebar-main-panel-container"},o.createElement("div",{className:"editor-sidebar-main-panel"},o.createElement("div",{className:"editor-sidebar-header"},o.createElement("h2",null,i.default.text("edit_form.flickr"))),o.createElement("div",{className:"editor-sidebar-body"},o.createElement("div",{className:"editor-sidebar-tabs-container"},o.createElement(a.Tabs,{tabs:e,className:"editor-sidebar-tabs",localStoragePrefix:"sidebar-flickr-tab"})))))}}e.exports=d},79218:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n};var a=e=>{let{photo:t,onClickPhoto:r,onDoubleClickPhoto:n}=e;const a={backgroundImage:`url(${t.src_thumbnail})`};return i.default.createElement("div",{className:"photo-list-item"+(t.isSelected?" selected":""),"data-testid":"photo-list-item",style:a,onClick:()=>r(t.key),onDoubleClick:()=>n(t.key)})};t.default=a},61393:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PhotoList=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=d(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),i=l(r(20996)),a=l(r(79218)),o=l(r(71394)),s=r(90381);function l(e){return e&&e.__esModule?e:{default:e}}function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(d=function(e){return e?r:t})(e)}class u extends n.Component{render(){if(this.props.showWelcomeMessage)return n.createElement("div",{className:"editor-sidebar-flickr_photo-list"},n.createElement(o.default,{text:this.props.welcomeMessage}));const e=this.props.isLoading,t=0===this.props.photos.length&&!e;return n.createElement("div",{className:"editor-sidebar-flickr_photo-list"},this.renderPhotos(),e?n.createElement(s.LoadingIndicator,null):null,t?n.createElement(o.default,{text:i.default.text("edit_form.empty_items")}):null)}renderPhotos(){return this.props.photos.map((e=>n.createElement(a.default,{key:e.key,photo:e,onClickPhoto:e=>this.props.onClickPhoto(e),onDoubleClickPhoto:e=>this.props.onDoubleClickPhoto(e)})))}}t.PhotoList=u},71394:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n};var a=e=>{let{text:t}=e;return i.default.createElement("div",{className:"editor-sidebar-flickr_photo-list-message"},t)};t.default=a},37357:(e,t,r)=>{"use strict";var n,i=(n=r(20996))&&n.__esModule?n:{default:n},a=r(46171),o=r(6529),s=r(61393),l=r(81915);const d=r(67294),u=r(73599),c=r(74937);class p extends d.Component{constructor(){super(),this.state=c.getState(),this.updateState=this._updateState.bind(this)}componentDidMount(){c.on("change",this.updateState)}componentWillUnmount(){c.removeListener("change",this.updateState)}_updateState(){this.setState(c.getState())}render(){return d.createElement("div",{className:"editor-sidebar-flickr_photostream"},d.createElement(o.UserAssociation,{user:this.state.user}),d.createElement("div",{className:"result"},d.createElement(a.InfiniteScroll,{onScroll:()=>this.loadMore()},d.createElement(s.PhotoList,{photos:this.state.photos,showWelcomeMessage:this.state.showWelcomeMessage,isLoading:this.state.isLoading,welcomeMessage:i.default.text("edit_form.flickr.photostream.description"),onClickPhoto:e=>this.toggleSelection(e),onDoubleClickPhoto:e=>this.insertDoubleClicked(e)}))),d.createElement(l.Footer,{onClickInsertButton:()=>this.insertSelected(),hasSelectedItems:this.state.hasSelectedItems,trackingId:"curation-flickr-photostream-paste-button"}))}loadMore(){u.loadMore(this.state)}toggleSelection(e){u.toggleSelection(e)}insertDoubleClicked(e){u.insertDoubleClicked(e)}insertSelected(){u.insertSelected()}}e.exports=p},66972:(e,t,r)=>{"use strict";var n,i=(n=r(20996))&&n.__esModule?n:{default:n},a=r(46171),o=r(77898),s=r(61393),l=r(81915);const d=r(67294),u=r(51192),c=r(91395);class p extends d.Component{constructor(){super(),this.state=c.getState(),this.updateState=this._updateState.bind(this)}componentDidMount(){c.on("change",this.updateState)}componentWillUnmount(){c.removeListener("change",this.updateState)}_updateState(){this.setState(c.getState())}render(){return d.createElement("div",{className:"editor-sidebar-flickr_search"},d.createElement(o.SearchForm,{onSubmit:e=>this.load(e)}),d.createElement("div",{className:"result"},d.createElement(a.InfiniteScroll,{onScroll:()=>this.loadMore()},d.createElement(s.PhotoList,{photos:this.state.photos,showWelcomeMessage:this.state.showWelcomeMessage,isLoading:this.state.isLoading,welcomeMessage:i.default.text("edit_form.flickr.search.description"),onClickPhoto:e=>this.toggleSelection(e),onDoubleClickPhoto:e=>this.insertDoubleClicked(e)}))),d.createElement(l.Footer,{onClickInsertButton:()=>this.insertSelected(),hasSelectedItems:this.state.hasSelectedItems,trackingId:"curation-flickr-search-paste-button"}))}load(e){u.load(this.state,e)}loadMore(){u.loadMore(this.state)}toggleSelection(e){u.toggleSelection(e)}insertDoubleClicked(e){u.insertDoubleClicked(e)}insertSelected(){u.insertSelected()}}e.exports=p},77898:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SearchForm=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),i=o(r(20996)),a=o(r(70881));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}class l extends n.Component{render(){return n.createElement("div",{className:"editor-sidebar-flickr_search-form"},n.createElement(a.default,{placeholder:i.default.text("edit_form.flickr.placeholder"),onSubmit:e=>this.props.onSubmit(e)}))}}t.SearchForm=l},6529:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserAssociation=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),i=o(r(20996)),a=o(r(6686));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}const l=r(73599);class d extends n.Component{render(){return n.createElement(a.default,{user:this.props.user,onRegister:e=>this.register(e),onUnregister:()=>this.unregister(),placeholder:i.default.text("edit_form.flickr.screen_name")})}register(e){l.registerUser(e)}unregister(){l.unregisterUser()}}t.UserAssociation=d},45441:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetchUserInfo=void 0;var n,i=(n=r(347))&&n.__esModule?n:{default:n};t.fetchUserInfo=e=>new Promise(((t,r)=>{i.default.get("/api/flickr/user",{params:{user_id:e}}).then((e=>{e.data.data?t(e.data):r()}),(()=>{r()}))}))},46007:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetchUserPhotostream=void 0;var n,i=(n=r(347))&&n.__esModule?n:{default:n};t.fetchUserPhotostream=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return new Promise((r=>{i.default.get("/api/flickr/user_photostream",{params:{user_id:e,page:t}}).then((e=>{e.data.data?r(e.data):r({data:[]})}),(()=>{r({data:[]})}))}))}},29806:(e,t,r)=>{"use strict";const n=r(65311).get;e.exports=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return new Promise((r=>{n("/api/flickr/search",{word:e,page:t}).then((e=>{e.data||(e={data:[]}),r(e)})).fail((()=>{r({data:[]})}))}))}},52570:(e,t,r)=>{"use strict";const n=r(67294),i=r(73935),a=r(38778),o=r(91395),s=r(74937),l=r(73599);e.exports={init:function(e){let{container:t,sidebar:r}=e;o.init(),s.init(),i.render(n.createElement(a,null),t);let d=!1;const u=()=>{const e=s.getState().user;e&&e.id&&l.load(e.id,1),d=!0},c="editor-flickr";r.type===c&&u(),r.on("tabChange",(e=>{!1===d&&e===c&&u()}))}}},6802:(e,t,r)=>{"use strict";var n=r(45441);e.exports=class{constructor(e){this.key=`${e.farm}-${e.server}-${e.id}`,this.id=e.id,this.farm=e.farm,this.server=e.server,this.permalink=e.permalink,this.title=e.title,this.user_id=e.user_id,this.username=null,this.src=e.src,this.src_thumbnail=e.src_thumbnail,this.isSelected=!1}fetchUserInfo(){return this.username?Promise.resolve():new Promise(((e,t)=>{(0,n.fetchUserInfo)(this.user_id).then((t=>{this.username=t.data.username._content,e()})).catch((()=>{t()}))}))}toggleSelection(){this.isSelected=!this.isSelected}}},15400:(e,t,r)=>{"use strict";var n=r(92477),i=r(10714),a=r(70879);const o=r(73287),s=r(6802);class l extends o.Store{initState(){this.state={photos:[],isLoading:!1,hasMore:!1,page:1,hasSelectedItems:!1},this._photoKeys={}}getState(){return this.state.hasSelectedItems=this.state.photos.some((e=>e.isSelected)),this.state}load(e){this._add(e)}toggleSelection(e){this.state.photos.find((t=>t.key===e)).toggleSelection()}insertSelected(){const e=this.state.photos.filter((e=>e.isSelected));this._insert(e),e.forEach((e=>{e.isSelected=!1}))}insertDoubleClicked(e){const t=this.state.photos.find((t=>t.key===e));this._insert([t])}startLoading(){this.state.isLoading=!0}finishLoading(e){e.data.length?(this.state.page++,this.state.hasMore=!0):this.state.hasMore=!1,this.state.isLoading=!1}_add(e){e.forEach((e=>{const t=new s(e);this._photoKeys[t.key]||(this._photoKeys[t.key]=!0,this.state.photos.push(t))}))}_insert(e){const t={hatena:[],markdown:[],html:[]};return e.forEach((e=>{t.hatena.push(`[${e.permalink}:embed]`),t.markdown.push(`[${e.permalink}:embed]`)})),new Promise(((e,r)=>{(0,n.extractSyntax)(t.hatena).done((r=>{t.html=[r.html],e()})).fail((e=>{t.html=t.hatena,(0,a.BUG)(e),r()}))})).then((()=>{(i.EditorConnector.isiOS()||i.EditorConnector.isAndroid())&&(t.html=t.hatena),i.EditorConnector.insertLines(t)}))}}e.exports=l},74937:(e,t,r)=>{"use strict";const n=r(48862).actions,i=r(73287),a=r(19165),o="sidebar-flickr-user",s=r(15400);e.exports=new class extends s{init(){this.initState(),this.restoreUser(),i.on(n.PHOTOSTREAM.LOAD,(e=>{this.load(e),this.emit("change")})),i.on(n.PHOTOSTREAM.REGISTER_USER,(e=>{this.registerUser(e),this.emit("change")})),i.on(n.PHOTOSTREAM.UNREGISTER_USER,(()=>{this.unregisterUser(),this.emit("change")})),i.on(n.PHOTOSTREAM.HIDE_WELCOME_MESSAGE,(()=>{this.state.showWelcomeMessage=!1,this.emit("change")})),i.on(n.PHOTOSTREAM.START_LOADING,(()=>{this.startLoading(),this.emit("change")})),i.on(n.PHOTOSTREAM.FINISH_LOADING,(e=>{this.finishLoading(e),this.emit("change")})),i.on(n.PHOTOSTREAM.TOGGLE_SELECTION,(e=>{this.toggleSelection(e),this.emit("change")})),i.on(n.PHOTOSTREAM.INSERT_SELECTED,(()=>{this.insertSelected(),this.emit("change")})),i.on(n.PHOTOSTREAM.INSERT_DOUBLE_CLICKED,(e=>{this.insertDoubleClicked(e),this.emit("change")}))}registerUser(e){const t=e.data;this.state.user={id:t.nsid,name:t.username._content,uri:t.photosurl._content,icon:this._iconUrl(t)},this.state.showWelcomeMessage=!1,a.save(o,this.state.user)}unregisterUser(){this.initState(),a.save(o,null)}initState(){super.initState(),this.state.user=null,this.state.showWelcomeMessage=!0}restoreUser(){const e=a.load(o);e&&e.id&&(this.state.showWelcomeMessage=!1,this.state.user=a.load(o))}_iconUrl(e){let{iconfarm:t,iconserver:r,nsid:n}=e;return r>0?`https://farm${t}.staticflickr.com/${r}/buddyicons/${n}.jpg`:"https://www.flickr.com/images/buddyicon.gif"}}},91395:(e,t,r)=>{"use strict";const n=r(48862).actions,i=r(73287),a=r(15400);e.exports=new class extends a{init(){this.initState(),this.state.showWelcomeMessage=!0,i.on(n.SEARCH.INIT_WITH_WORD,(e=>{this.initState(e),this.emit("change")})),i.on(n.SEARCH.LOAD,(e=>{this.load(e),this.emit("change")})),i.on(n.SEARCH.START_LOADING,(()=>{this.startLoading(),this.emit("change")})),i.on(n.SEARCH.FINISH_LOADING,(e=>{this.finishLoading(e),this.emit("change")})),i.on(n.SEARCH.TOGGLE_SELECTION,(e=>{this.toggleSelection(e),this.emit("change")})),i.on(n.SEARCH.INSERT_SELECTED,(()=>{this.insertSelected(),this.emit("change")})),i.on(n.SEARCH.INSERT_DOUBLE_CLICKED,(e=>{this.insertDoubleClicked(e),this.emit("change")}))}initState(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";super.initState(),this.state.word=e,this.state.showWelcomeMessage=!1}}},19864:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Footer=void 0;var n=s(r(65311)),i=s(r(66419)),a=r(77102),o=s(r(20996));function s(e){return e&&e.__esModule?e:{default:e}}class l extends a.Dropdown{setPosition(){const e=this.$element[0].getBoundingClientRect(),t=this.$window.height();this.$window.css({top:e.top-t,left:e.right-this.$window.width()})}}t.Footer=class{constructor(e){this.editor=e,this.$element=(0,n.default)(".l-editor-footer"),this.$selector=this.$element.find(".editor-save-buttons-selector a"),this.$dropdown=this.$element.find(".editor-save-buttons-dropdown"),this.$dropdownButtons=this.$dropdown.find("a"),this.$saveButtons=this.$element.find(".editor-save-buttons"),this.$saveDraftButton=this.$element.find(".js-editor-save-button-draft-and-continue"),this.$scheduledButton=this.$element.find(".editor-save-buttons-scheduled"),this.$otherActionsButton=this.$element.find(".other-actions-button"),this.$otherActionsDropdownWindow=this.$element.find(".other-actions-dropdown-window"),this.saveMode=this.$element.data("saveMode"),this.isScheduled=!1,this.isOpen=!1,this.saveDraftState="pending",this.dropdown=new l(this.$selector,this.$dropdown),this.otherActionsDropdown=new l(this.$otherActionsButton,this.$otherActionsDropdownWindow),this.$dropdown.on("click","a",(e=>{const t=(0,n.default)(e.currentTarget).data("saveMode");this.changeSaveMode(t)})),this.$selector.on("click",(()=>{this.isOpen=!this.isOpen,this.render(),this.focusOnSelector()})),this.editor.on("toggleScheduledEntry",(e=>{this.isScheduled=e,this.isOpen=!1,this.render()})),this.$saveDraftButton.on("click",(e=>{e.preventDefault(),this.editor.saveDraft(!0)})),this.editor.on("savingDraft",(()=>{this.saveDraftState="saving","draft"!==this.saveMode&&this.changeSaveMode("draft"),this.render()})),this.editor.on("saveDraft",(()=>{this.saveDraftState="saved",this.editor.bindOnce("change",(()=>{"saving"!==this.saveDraftState&&this.editor.emit("prepareSavingDraft")})),this.render()})),this.editor.on("prepareSavingDraft",(()=>{this.saveDraftState="pending",this.render()})),"publish"===this.saveMode&&this.editor.getEntryId()||this.editor.on("saveShortcutKeydown",i.default.throttle((()=>{"saved"!==this.saveDraftState&&this.editor.saveDraft(!0)}),1e3)),this.render()}render(){if(this.$saveButtons.find("input, button").addClass("is-hidden"),this.$saveButtons.find(`.editor-save-button-${this.saveMode}`).removeClass("is-hidden"),this.$selector.toggle(!this.isScheduled),this.$saveButtons.toggle(!this.isScheduled),this.$scheduledButton.toggle(this.isScheduled),"saving"===this.saveDraftState)this.$saveDraftButton.addClass("editor-save-label-saving-draft").removeClass("editor-save-label-saved-draft").text(o.default.text("edit_form.draft.saving")).prop("disabled",!0);else if("saved"===this.saveDraftState)this.$saveDraftButton.removeClass("editor-save-label-saving-draft").addClass("editor-save-label-saved-draft").html(`<i class="blogicon-check"></i> ${i.default.escape(o.default.text("edit_form.draft.saved"))}`).prop("disabled",!1);else{if("pending"!==this.saveDraftState)throw new Error(`unexpected state: ${this.saveDraftState}`);{const e=this.editor.getEntryId()?o.default.text("edit_form.update_draft_button"):o.default.text("edit_form.draft_button");this.$saveDraftButton.removeClass("editor-save-label-saving-draft").removeClass("editor-save-label-saved-draft").text(e).prop("disabled",!1)}}}focusOnSelector(){const e=this.$dropdownButtons.filter(`[data-save-mode=${this.saveMode}]`);this.$dropdownButtons.removeClass("is-selected"),e.addClass("is-selected"),this.isOpen?e.focus():this.$selector.focus()}changeSaveMode(e){this.saveMode=e,this.isOpen=!1,this.render(),this.focusOnSelector(),this.editor.trigger("updateWillPublish","publish"===this.saveMode)}}},70335:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DiskSize=void 0;class r{constructor(e,t){this.$container=e.find(".js-disksize-container"),this.resize=t,r.allInstances.push(this)}static renderDiskSizeGraph(e,t){for(const n of r.allInstances)n.renderDiskSizeGraph(e,t)}renderDiskSizeGraph(e,t){const r=this.$container.find(".js-box"),n=this.$container.find(".js-bar"),i=this.$container.find(".js-rate"),a=e/t,o=`${Math.floor(100*a)}%`;i.text(o),n.css("width",o);const s=r.attr("data-label")+o;r.attr("original-title",s),this.$container.show(),this.resize()}showDiskFullAlert(){this.$container.find(".js-disk-full-alert").show(),this.resize()}showUploadErrorAlert(e){e instanceof TypeError?this.$container.find(".js-upload-type-alert").show():(this.$container.find(".js-upload-fail-alert").show(),void 0!==e.errmsg&&this.$container.find(".js-upload-fail-alert").text(e.errmsg)),this.resize()}}var n,i,a;t.DiskSize=r,n=r,a=[],(i=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(i="allInstances"))in n?Object.defineProperty(n,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[i]=a},15160:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FotolifeUploadForm=void 0;var n=r(70879),i=r(21650),a=r(70782),o=r(70335),s=c(r(65311)),l=r(97050),d=c(r(57942)),u=c(r(20996));function c(e){return e&&e.__esModule?e:{default:e}}const p=r(36500),f=r(59662);t.FotolifeUploadForm=class{constructor(e,t){this.$element=e,this.parent=t,this.messenger=p.createForCurrentWindow(),this.diskSize=new o.DiskSize(this.$element,(()=>{this.parent.emit("resize")})),f.isIE||!(0,s.default)('<input type="file" />')[0].files||"undefined"==typeof FormData?this.initIframeUploader():this.initUploader(),this.initEvents()}initEvents(){this.parent.on("success",(()=>this.loadInfo())),this.parent.on("error",(e=>this.diskSize.showUploadErrorAlert(e))),this.parent.on("disk_full",(()=>this.diskSize.showDiskFullAlert()))}initUploader(){this.$element.find(".fotolife-upload-form").show();const e=this.$element.find("input.file"),t=e.get()[0];e.on("change",(()=>{this.parent.uploadAndPasteFiles(t.files?Array.from(t.files):[])})),this.loadInfo()}initIframeUploader(){const e=(0,s.default)('<iframe frameborder="0" style="border: none;"/>').prependTo(this.$element),t=`/api/upload/fotolife/${this.messenger.key}`;let r;e.attr("src",t),e.css({width:250,height:90}),e.on("load",(()=>{const r=e[0],n=r.contentDocument||r.contentWindow?.document;if(!n)return;this.document=n;const i=n.body.innerHTML.match(/^\s*(f:id:\S+)/),a=n.body.innerHTML.match(/disk full/);i?(this.emitIframe("success",RegExp.$1),r.contentWindow&&r.contentWindow.location.replace(t)):a?(this.emitIframe("disk_full",null),this.emitIframe("error",null),r.contentWindow&&r.contentWindow.location.replace(t)):this.loadInfo()})),this.onIframe("progress",(()=>{r||(r=new i.Uploader,this.parent.emit("upload",r)),r.emit("progress",{percent:100})})),this.onIframe("success",(e=>{(0,l.extractFotolifeSyntax)(e).done((e=>{r&&e&&r.emit("success",e)})).fail((e=>{(0,n.BUG)(e)})).always((()=>{r=null}))})),this.onIframe("disk_full",(e=>{r&&r.emit("disk_full",e)})),this.onIframe("error",(e=>{r&&r.emit("error",e)}))}onIframe(e,t){this.messenger.addEventListener("EditorUploadIframe",(r=>{r.eventName===e&&((0,n.LOG)(["onUploadIframe",r.eventName,r.result]),t(r.result))}))}emitIframe(e,t){const r={eventName:e,result:t};this.messenger.send("EditorUploadIframe",r)}uploadFile(e){const t=(0,s.default)(".js-folder-selector",this.document).val(),r=new i.Uploader;return this.parent.emit("upload",r),r.upload(e,t)}uploadFiles(e){const t=s.default.Deferred(),r=[];return e.reduce(((e,t)=>e.then((()=>this.uploadFile(t).done((e=>{e&&r.push(e)})).fail((e=>e))),(e=>s.default.Deferred().reject(e)))),s.default.Deferred().resolve().promise()).done((()=>t.resolve(r))).fail((e=>{(0,n.LOG)(e),t.reject(r)})),t.promise()}loadInfo(){(0,a.fetchFotolifeInfo)((0,d.default)("name")).then((e=>{this.info=e,this.updateFolderList(e.folder_list,e.is_private),this.setFotoSizeForIframeUploader(),o.DiskSize.renderDiskSizeGraph(e.disksize,e.maxdisksize),this.parent.emit("resize")}))}setFotoSizeForIframeUploader(){if(!this.document)return;if(!this.info)return;(0,s.default)(".js-fotosize",this.document).val(this.fotoSize())}fotoSize(){const e=i.Uploader.DEFAULT_SIZE;return this.info&&this.info.fotosize>e?this.info.fotosize:e}updateFolderList(e,t){const r=this.parent.defaultFolder;e.push({status:"private",folder:r}),e.push({status:t?"private":"public",folder:""});const n={},i=[];for(let t,r=0;t=e[r];r++)n[t.folder]=t,i.push(t.folder);i.sort();let a=(0,s.default)(".js-folder-selector",this.document).val();n[a]||(a=r);const o=(0,s.default)(".js-folder-selector",this.document).empty();for(let e=0;e<i.length;e++){if(i[e]===i[e-1])continue;const r=n[i[e]];let l=r.folder||u.default.text("fotolife.folder.top");(t||"private"===r.status)&&(l+="(private)");const d=(0,s.default)("<option/>").attr("value",r.folder).text(l).appendTo(o);r.folder===a&&d.prop("selected",!0)}o.off("change"),o.on("change",(()=>{this.parent.emit("changeFolder",(0,s.default)(o).val())})),o.parents(".js-fotolife-folder-wrapper").show()}}},64722:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=r(70879),a=r(60717),o=r(62433),s=r(15160),l=r(17187),d=(n=r(65311))&&n.__esModule?n:{default:n};const u=async e=>new Promise((t=>{t(e.map((e=>({html:e.dataset.html||"",image:e.dataset.image||"",syntax:e.dataset.syntax||""}))))})),c=e=>new Map([["html",e.html],["image",e.image],["syntax",e.syntax.replace(/:image/,":plain")]]);var p=class{constructor(e){this.$element=e.container,this.eventEmitter=new l.EventEmitter,this.editor=e.editor,this.syntax=this.editor.syntaxForInsertLines,this.sidebar=e.sidebar,this.imagePicker=new a.ImagePicker({container:this.$element,editor:this.editor,selectors:this.selectors,storageKey:"fotolife-grid-column",showDetailSettingsCheckboxKey:"Fotolife.show-detail-settings-on-image-insertion",showLoadingWhilePasting:!1,convertItemsToFotolifeSyntaxes:u}),this.$items=this.$element.find(this.selectors.items),this.$uploadForm=this.$element.find(this.selectors.uploadForm),this.$uploadFormWrapper=this.$element.find(this.selectors.uploadFormWrapper),this.uploadForm=this.createUploadForm(),this._setupEvents(),this.resize(),this.load(this.defaultFolder,1),"editor-fotolife"===this.type&&((0,d.default)(document).on("uploadDroppedFiles",((e,t)=>this.uploadAndPasteFiles(t))),this.$items.on("drop",(e=>{const t=e.originalEvent.dataTransfer;if(null===t)return!1;const r=Array.from(t.files);return this.uploadAndPasteFiles(r),!1})).on("dragenter dragover",(()=>!1)))}get selectors(){return{items:"#items",pasteButton:".paste-button",footerButtons:"#footer-buttons",uploadForm:"#uploader",uploadFormWrapper:"#uploader-wrapper",gridDropdown:".js-fotolife-grid-dropdown",gridDropdownToggle:".js-fotolife-grid-dropdown-toggle",showDetailSettingsCheckbox:".embed-config-fotolife"}}get type(){return"editor-fotolife"}get defaultFolder(){return"Hatena Blog"}createUploadForm(){return new s.FotolifeUploadForm(this.$uploadForm,this)}_setupEvents(){this.on("upload",this.addUploadingItem.bind(this)),this.on("changeFolder",(e=>{this.load(e,1)}));const e=e=>{e===this.type&&this.resize()};this.sidebar.on("resize",e),this.sidebar.on("tabChange",e),this.on("resize",(()=>this.resize()))}uploadAndPasteFiles(e){this.uploadForm.uploadFiles(e).then((e=>this.imagePicker.pasteItems({items:e||[],isUploadError:!1}).catch((e=>(0,i.BUG)(e)))),(e=>this.imagePicker.pasteItems({items:e||[],isUploadError:!0}).catch((e=>(0,i.BUG)(e)))))}addUploadingItem(e){const t=new o.Item({},!1);t.listenTo(e,this.eventEmitter,c),e.setParams({fotosize:this.uploadForm.fotoSize(),"delete-gps":1}),this.imagePicker.addItem(t)}load(e,t){const r=this.imagePicker.useHires;(0,i.LOG)(["load",e,t]),d.default.ajax({url:"/api/support/fotolife",type:"get",cache:!1,dataType:"json",data:{folder:e,page:t}}).done((n=>{if((0,i.LOG)(n),n.error)return;const a=n.items.map((e=>new o.Item({image:e.image,hires_thumbnail:e.hires_thumbnail,attributes:c(e)},r))),s=n.last?void 0:()=>{this.load(e,t+1)};this.imagePicker.renderItems(a,1===t,s)}))}resize(){const e=(0,d.default)("#editor-main").offset();if(void 0===e)return;const t=(0,d.default)(window).height()-e.top;this.imagePicker.resize(t,this.$uploadFormWrapper.outerHeight(!0))}on(){this.eventEmitter.on(...arguments)}emit(){this.eventEmitter.emit(...arguments)}};t.default=p},54274:e=>{"use strict";e.exports={API_LIMIT:"API_LIMIT",GIST_NOT_FOUND:"GIST_NOT_FOUND",USER_NOT_FOUND:"USER_NOT_FOUND"}},31046:(e,t,r)=>{"use strict";var n,i=(n=r(65311))&&n.__esModule?n:{default:n};const a=r(54274);e.exports=class{constructor(e,t){this.$container=e,this.$gistNotFound=this.$container.find(".gist-not-found-error"),this.$userNotFound=this.$container.find(".user-not-found-error"),this.$apiLimit=this.$container.find(".api-limit-error"),this.$ajaxError=this.$container.find(".ajax-error"),this.emitter=t,this.emitter.on("showError",(e=>this.showError(e))),this.emitter.on("hideError",(()=>this.hideError()))}hideError(){this.$gistNotFound.hide(),this.$userNotFound.hide(),this.$apiLimit.hide(),this.$ajaxError.hide()}showError(e){this.hideError(),e===a.API_LIMIT?this.$apiLimit.show():e===a.GIST_NOT_FOUND?this.$gistNotFound.show():e===a.USER_NOT_FOUND?this.$userNotFound.show():this.$ajaxError.show(),(0,i.default)(window).resize()}}},86741:(e,t,r)=>{"use strict";var n,i=(n=r(20996))&&n.__esModule?n:{default:n},a=r(64292),o=r(57753);const s=r(65311),l=r(66419),d=r(17187).EventEmitter,u=r(82607),c=r(31046);class p extends o.MyCuration{get type(){return"editor-gist"}get serviceName(){return"Gist"}get enableAutoPager(){return!0}get pasteReverseOrder(){return!0}constructor(e){super(e),this.emitter=new d,this.errorMessage=new c(this.$container,this.emitter),this.userManager=new u(this.$container,this.emitter),this.emitter.on("userRegistered",(()=>{this.resetUser(),this.requestLoadItems(),this.resize()})),this.emitter.on("userUnregistered",(()=>{this.resetUser(),this.resize()})),this.bindEvents()}loadItems(e){const t=s.Deferred();if(!this.userManager||!this.userManager.getUser())return t.reject(),t;const r=this.userManager.getUser();return e&&r.forward(),r.loadGists().then((e=>{0===e.length&&(this.itemsReachedEnd=!0),t.resolve({entries:e})})).catch((e=>{this.emitter.emit("showError",e),this.itemsReachedEnd=!0,t.reject(e)})),t}showItems(e){const t=e.map((e=>{const t=e.description?(0,a.trimString)(e.description,50):`gist${e.id}`,r=l.values(e.files)[0].language||"Unknown";return this.template({item:e,description:t,language:r})}));this.$indicator.before(t.join("")),i.default.updateTimestamps(this.$container[0])}insertItems(e){const t=[],r=this.editor.mode;e.forEach((e=>{const n=e.data("html-url"),i=e.data("description"),a=this.escapeDescription(r,i);t.push(`[${n}:embed#${a}]`),"html"===r?t.push(`<a href="${n}">${a}</a>`):"hatena"===r?t.push(`[${n}:title=${a}]`):t.push(`[${a}](${n})`)})),this.editor.insertLines(t)}escapeDescription(e,t){let r=t;"markdown"===e&&(r=t.replace(/[\\_*`]/g,"\\$&"));return l.escape(r.replace(/[\n[\]]/g,""))}resetUser(){this.itemsReachedEnd=!1,this.removeItems(),this.emitter.emit("hideError"),this.userManager&&this.userManager.getUser()&&this.userManager.getUser().rewind()}}e.exports=p},42703:(e,t,r)=>{"use strict";var n,i=(n=r(347))&&n.__esModule?n:{default:n};const a=r(54274);e.exports=class{constructor(e){this.name=e,this.page=1,this._exists=!1}getName(){return this.name}getImage(){return this.info.avatar_url}loadUser(){return i.default.get(`https://api.github.com/users/${this.name}`).then((e=>{this.info=e.data,this._exists=!0})).catch((()=>Promise.reject(a.USER_NOT_FOUND)))}loadGists(){return i.default.get(`https://api.github.com/users/${this.name}/gists`,{params:{page:this.page,per_page:20}}).then((e=>{const t=e.data;return 0===t.length&&1===this.page?Promise.reject(a.GIST_NOT_FOUND):Promise.resolve(t)}),(e=>{try{const t=e.data.message;if(t.match("API rate limit exceeded"))return Promise.reject(a.API_LIMIT);if(t.match("Not Found"))return Promise.reject(a.USER_NOT_FOUND)}catch(e){}return Promise.reject()}))}forward(){this.page++}rewind(){this.page=1}exists(){return this._exists}}},49747:(e,t,r)=>{"use strict";const n=r(42703);e.exports=class{constructor(){this.users={}}loadUser(e){return this.users[e]||(this.users[e]=new n(e)),this.users[e].loadUser().then((()=>this.users[e]))}}},82607:(e,t,r)=>{"use strict";var n=r(41960);r(65311);const i=r(19165),a=r(49747);e.exports=class{constructor(e,t){this.$container=e,this.$input=this.$container.find(".gist-user-name"),this.$registerButton=this.$container.find(".register-button"),this.$unregisterButton=this.$container.find(".unregister-button"),this.$userImage=this.$container.find(".user-image"),this.$name=this.$container.find(".user-name"),this.$nameLink=this.$container.find(".user-name-link"),this.userLoader=new a,this.emitter=t,this.bindEvents(),this.$input.val(this.loadUserName()),this.tryRegisterFromInput()}bindEvents(){this.$registerButton.on("click",(()=>(this.tryRegisterFromInput(),!1))),this.$input.on("keydown",(e=>{if("RET"===(0,n.keyString)(e))return this.tryRegisterFromInput(),!1})),this.$unregisterButton.on("click",(()=>(this.unregister(),!1)))}tryRegisterFromInput(){const e=this.$input.val();e&&this.tryRegister(e)}getUser(){return this.currentUser}tryRegister(e){this.userLoader.loadUser(e).then((e=>{this.register(e)})).catch((e=>{this.emitter.emit("showError",e)}))}register(e){this.currentUser=e;const t=e.getName();this.setUserImage(e.getImage()),this.$name.text(t),this.$nameLink.attr("href",`http://gist.github.com/${t}`),this.saveUserName(t),this.$container.addClass("registered"),this.emitter.emit("userRegistered"),this.emitter.emit("hideError")}unregister(){this.currentUser=null,this.setUserImage(this.DEFAULT_UESR_IMAGE),this.saveUserName(""),this.$container.removeClass("registered"),this.$input.focus(),this.emitter.emit("userUnregistered"),this.emitter.emit("hideError")}setUserImage(e){this.$userImage.attr("src",e)}saveUserName(e){i.save("gist-user-name",e)}loadUserName(){return i.load("gist-user-name")||""}}},72069:(e,t,r)=>{"use strict";e.exports=r(86741)},37048:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AlbumSelector=void 0;var n,i=r(17187),a=(n=r(20996))&&n.__esModule?n:{default:n},o=r(4707);function s(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const l={id:"all-images",title:a.default.text("edit_form.google-photos.all_images"),productUrl:"https://photos.google.com/"};t.AlbumSelector=class{constructor(e){s(this,"hasInitialized",!1),this.eventEmitter=new i.EventEmitter,this.albumIdToAlbum=new Map,this.currentAlbum=null,this.selectorElement=e.querySelector(".js-album-selector"),this.albumLink=e.querySelector(".js-album-link"),this.selectorElement.addEventListener("change",(e=>{e.target instanceof HTMLSelectElement&&this.handleAlbumSelect(e.target.value)}))}async init(){if(this.hasInitialized)return;this.hasInitialized=!0;const e=await(0,o.fetchAlbums)();this.albumIdToAlbum=new Map(e.map((e=>[e.id,e]))),this.currentAlbum=l,this.selectorElement.innerHTML="";for(const t of[l,...e]){const e=document.createElement("option");e.value=t.id,e.textContent=t.title,t.id===l.id&&(e.selected=!0),this.selectorElement.appendChild(e)}}handleAlbumSelect(e){this.currentAlbum&&this.currentAlbum.id===e||(this.currentAlbum=this.albumIdToAlbum.get(e)||l,this.albumLink.href=this.currentAlbum.productUrl,this.eventEmitter.emit("changeAlbum",this.currentAlbum.id===l.id?null:this.currentAlbum))}on(){this.eventEmitter.on(...arguments)}}},30189:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GooglePickerImportNotice=void 0;const n=r(19165);t.GooglePickerImportNotice=class{constructor(e,t,r){this.editor=e,this.noticeContainer=t,this.isDismissedKey=`${r}.is-dismissed`;this.isDismissed()?this.hide():this.setupEventListener()}isDismissed(){return n.load(this.isDismissedKey)}dismiss(){n.save(this.isDismissedKey,!0)}setupEventListener(){const e=this.noticeContainer.querySelector(".js-close-google-picker-import-notice");e&&e.addEventListener("click",(()=>{this.dismiss(),this.hide(),this.editor.emit("resize")}))}hide(){this.noticeContainer.classList.add("dismissed")}}},4707:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uploadToFotolife=t.fetchMediaItems=t.fetchAlbums=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(347)),a=r(70879),o=(n=r(57942))&&n.__esModule?n:{default:n};function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}t.fetchAlbums=()=>i.default.get("/api/google_photos/albums").then((e=>{if(e.data.error)throw e.data.error;return e.data.albums.map((e=>({id:e.id,title:e.title,productUrl:e.product_url})))}),(e=>{throw(0,a.BUG)(e),e}));t.fetchMediaItems=(e,t,r)=>{const n={page_size:t};return null!==e&&(n.album=e.id),void 0!==r&&(n.page_token=r),i.default.get("/api/google_photos/media_items",{params:n}).then((e=>{if(e.data.error)throw e.data.error;const t=e.data;return{mediaItems:t.media_items.map((e=>({id:e.id,isImage:e.is_image,baseUrl:e.base_url}))),nextPageToken:t.next_page_token||void 0}}),(e=>{throw(0,a.BUG)(e),e}))};t.uploadToFotolife=e=>i.default.request({method:"post",url:"/api/google_photos/upload_to_fotolife",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:{media_item_id:e.map((e=>e.id)),rkc:(0,o.default)("rkc"),rkm:(0,o.default)("rkm")},transformRequest:i.traditionalDataRequest}).then((e=>{if(e.data.error)throw e.data.error;return e.data.items}))},73861:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GooglePhotos=void 0;var n=f(r(57942)),i=r(70782),a=r(70335),o=r(60717),s=r(62433),l=r(37048),d=r(4707),u=r(50121),c=r(17187),p=f(r(65311));function f(e){return e&&e.__esModule?e:{default:e}}function h(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}t.GooglePhotos=class{constructor(e){h(this,"hasInitialized",!1),this.$element=e.container,this.eventEmitter=new c.EventEmitter,this.editor=e.editor,this.syntax=this.editor.syntaxForInsertLines,this.sidebar=e.sidebar,this.albumSelector=new l.AlbumSelector(this.$element.get()[0]),this.imagePicker=new o.ImagePicker({container:this.$element,editor:this.editor,selectors:this.selectors,showLoadingWhilePasting:!0,convertItemsToFotolifeSyntaxes:e=>this.convertItemsToFotolifeSyntaxes(e),onPasteSuccess:this.onPasteSuccess}),this.fotolifeDiskSize=new a.DiskSize(this.$element,(()=>this.resize())),this.$items=this.$element.find(this.selectors.items),this.$header=this.$element.find(this.selectors.header),this.setupEvents(),this.resize(),this.sidebar.type===this.type&&this.init()}get selectors(){return{items:".js-items",pasteButton:".js-paste-button",footerButtons:".js-footer-buttons",header:".js-header"}}get type(){return"editor-google-picker"}setupEvents(){this.albumSelector.on("changeAlbum",(e=>{this.load(e)}));const e=e=>{e===this.type&&this.resize()};this.sidebar.on("resize",e),this.sidebar.on("tabChange",e),this.on("resize",(()=>this.resize())),this.sidebar.on("openByType",(e=>{e===this.type&&this.init()}))}init(){this.albumSelector.init(),this.hasInitialized||(this.hasInitialized=!0,this.load(null))}async load(e,t){const r=void 0===t;r&&this.imagePicker.showLoading();try{const{mediaItems:n,nextPageToken:i}=await(0,d.fetchMediaItems)(e,50,t),a=n.map((e=>{return new s.Item({image:(t=e.baseUrl,`${t}=w500-h500`),attributes:this.convertMediaItemToItemAttributes(e),isDisabled:!e.isImage},!1);var t})),o=void 0===i?void 0:()=>{this.load(e,i)};this.imagePicker.renderItems(a,r,o)}catch(e){this.imagePicker.showLoadingError()}}resize(){const e=(0,p.default)("#editor-main").offset();if(void 0===e)return;const t=(0,p.default)(window).height()-e.top,r=this.$header.outerHeight(!0);this.imagePicker.resize(t,r)}convertMediaItemToItemAttributes(e){return new Map([["id",e.id],["baseUrl",e.baseUrl],["isImage",e.isImage?"true":"false"]])}async convertItemsToFotolifeSyntaxes(e){const t=e.filter((e=>void 0!==e.dataset.id)).map((e=>({id:e.dataset.id,baseUrl:e.dataset.baseUrl||"",isImage:"true"===e.dataset.isImage})));try{return await(0,u.uploadMediaItems)(t)}catch(e){return this.fotolifeDiskSize.showUploadErrorAlert(e),[]}}onPasteSuccess(){(0,i.fetchFotolifeInfo)((0,n.default)("name")).then((e=>{a.DiskSize.renderDiskSizeGraph(e.disksize,e.maxdisksize)}))}on(){this.eventEmitter.on(...arguments)}emit(){this.eventEmitter.emit(...arguments)}}},50121:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uploadMediaItems=void 0;var n=r(4707),i=r(97050);t.uploadMediaItems=async e=>{const t=e.filter((e=>e.isImage));let r=[];for(let e=0;e<t.length;e+=5){const i=t.slice(e,e+5);r=r.concat(await(0,n.uploadToFotolife)(i))}return r.reduce(((e,t)=>e.then((e=>new Promise((r=>{(0,i.extractFotolifeSyntax)(t).done((t=>{r(void 0===t?e:[...e,t])})).fail((()=>{r(e)}))}))))),Promise.resolve([]))}},90036:(e,t,r)=>{"use strict";var n=r(41960),i=r(10714),a=r(57753);const o=r(65311),s=r(81378);class l extends a.MyCuration{get type(){return"editor-gourmet"}get serviceName(){return"Gourmet"}get enableAutoPager(){return!0}get prefLocalStorageKey(){return"MyCuration.Gourmet.Pref"}constructor(e){super(e),this.$container=e.container,this.$searchPref=this.$container.find(".gourmet-pref"),this.$searchInput=this.$container.find(".gourmet-keyword-input"),this.$searchSubmit=this.$container.find(".gourmet-keyword-submit"),this.$description=this.$container.find(".gourmet-description"),this.$noResult=this.$container.find(".no-result"),this.$formatsContainer=this.$container.find(".gourmet-formats"),this.gourmetSearcher=new s({$searchInput:this.$searchInput,$searchPref:this.$searchPref}),this.restoreSelectedPref(),this.bindEvents()}restoreSelectedPref(){try{const e=localStorage[this.prefLocalStorageKey];e&&this.$searchPref.find(`option[value=${e}]`).first().prop("selected",!0)}catch(e){}}bindEvents(){super.bindEvents(),this.$searchPref.on("change",(()=>{try{localStorage[this.prefLocalStorageKey]=this.$searchPref.val()}catch(e){}})),this.$searchSubmit.on("click",(()=>{this.requestReload()})),this.$searchInput.on("keydown",(e=>"RET"!==(0,n.keyString)(e)||(this.requestReload(),!1))),this.$searchInput.on("focus",(()=>{this.$description.hide()})),this.$formatsContainer.on("change",(e=>{const t=o(e.target);this.$formatsContainer.find("label.selected").removeClass("selected"),t.closest("label").addClass("selected")}))}loadItems(e){const t=o.Deferred();return e?this.gourmetSearcher.forward():(this.gourmetSearcher.reset(),this.itemsReachedEnd=!1),this.gourmetSearcher.load().done((e=>{t.resolve(e)})).fail((()=>{t.reject()})).always((()=>{this.itemsReachedEnd=!this.gourmetSearcher.hasNext})),t}loadItemsFinishedHandler(){this.gourmetSearcher.$searchInput.val()&&0===this.getItemsOnPage().length&&this.$noResult.show()}requestReload(){this.$noResult.hide(),super.requestReload()}insertItems(e){const t=this.$formatsContainer.find("input:checked").val(),r=e.map((e=>`[${e.attr("data-url")}:${t}]`));i.EditorConnector.insertLines({hatena:r,markdown:r,html:r})}}e.exports=l},81378:(e,t,r)=>{"use strict";var n=r(65311);e.exports=class{constructor(e){if(this.$searchInput=e.$searchInput,this.$searchPref=e.$searchPref,!this.$searchInput||0===this.$searchInput.length)throw new TypeError("$searchInput required");if(!this.$searchPref||0===this.$searchPref.length)throw new TypeError("$searchPref required");this.searchKeyword="",this.searchPref="",this.page=1,this.hasNext=!0}load(){const e=n.Deferred();return this.searchKeyword?(n.ajax({url:"/api/gourmet/search",type:"GET",data:{word:this.searchKeyword,pref:this.searchPref,page:this.page},dataType:"json"}).done((t=>{0===t.entries.length&&(this.hasNext=!1),e.resolve(t)})).fail((()=>{this.hasNext=!1,e.reject()})),e):(e.reject(),e)}forward(){this.page++}reset(){this.searchKeyword=this.$searchInput.val(),this.searchPref=this.$searchPref.val(),this.page=1,this.hasNext=!0}}},33537:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmptyState=void 0;var n=r(55992),i=o(r(20996)),a=o(r(67294));function o(e){return e&&e.__esModule?e:{default:e}}t.EmptyState=()=>a.default.createElement("div",{className:"editor-group-banner-emptyState"},a.default.createElement("img",{src:(0,n.staticUrl)("/images/circle/group-ranking-fig.svg"),alt:"",className:"emptyState-fig"}),a.default.createElement("h3",null,i.default.text("epic.editor_group.empty.heading")),a.default.createElement("a",{href:(0,n.httpsAdminUrl)("/-/group/"),target:"_blank",rel:"noopener",className:"btn"},i.default.text("epic.editor_group.empty.action")))},60810:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GroupBannerItem=void 0;var n=a(r(86010)),i=a(r(67294));function a(e){return e&&e.__esModule?e:{default:e}}t.GroupBannerItem=e=>{let{isSelected:t,groupId:r,groupTitle:a,imageUrl:o,onClick:s}=e;return i.default.createElement("div",{className:(0,n.default)("editor-sidebar-group-banner_item item",{selected:t}),onClick:s,"data-testid":`group-banner-item-${r}`},i.default.createElement("div",{className:"inner"},i.default.createElement("img",{className:"thumbnail",src:o.toString(),alt:""}),i.default.createElement("div",{className:"info-container"},i.default.createElement("div",{className:"name"},a))))}},40304:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GroupBannerSelector=void 0;var n=r(55992),i=u(r(20996)),a=u(r(9825)),o=r(33537),s=r(60810),l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=d(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294));function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(d=function(e){return e?r:t})(e)}function u(e){return e&&e.__esModule?e:{default:e}}function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},c.apply(this,arguments)}t.GroupBannerSelector=e=>{let{banners:t,onSubmitGroup:r}=e;const[d,u]=(0,l.useState)(null),p=null!==d,f=(0,l.useCallback)((()=>{if(!p)return;const e=t[d]?.groupId;e&&(r(e),u(null))}),[p,t,d,r]);return l.default.createElement("div",{className:"editor-group-banner-content"},l.default.createElement("div",{className:"editor-group-banner-header"},l.default.createElement("h2",null,i.default.text("epic.editor_group")),l.default.createElement("div",{className:"editor-group-banner-announcement"},l.default.createElement("a",{href:(0,n.helpUrl)("/entry/group_ranking#%E3%82%B0%E3%83%AB%E3%83%BC%E3%83%97%E3%81%AE%E3%83%A9%E3%83%B3%E3%82%AD%E3%83%B3%E3%82%B0%E3%81%AB%E5%8F%82%E5%8A%A0%E3%81%99%E3%82%8B"),target:"_blank",rel:"noopener"},l.default.createElement("div",{className:"announcement-content"},l.default.createElement("p",{className:"announcement-p"},i.default.text("epic.editor_group.description")),l.default.createElement("div",{className:"announcement-cta"},i.default.text("epic.editor_group.description.help")))))),l.default.createElement("div",{className:"editor-group-banner-main"},t.length<=0?l.default.createElement(o.EmptyState,null):l.default.createElement("div",{className:"editor-group-banner-items"},t.map(((e,t)=>l.default.createElement(s.GroupBannerItem,c({},e,{isSelected:t===d,key:e.groupId,onClick:()=>{u(t)}})))))),l.default.createElement("div",{className:"editor-sidebar-group-banner_footer"},l.default.createElement(a.default,{disabled:!p,onClick:f,trackingId:"curation-group-banner-paste-button"})))}},48357:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GroupBanner=void 0;var n,i=r(10714),a=r(40304),o=r(73380),s=(n=r(67294))&&n.__esModule?n:{default:n};t.GroupBanner=class{constructor(e,t){(0,o.safeRender)(s.default.createElement(a.GroupBannerSelector,{banners:t,onSubmitGroup:e=>{const t=`[blog:g:${e}:banner]`;i.EditorConnector.insertLines({html:[t],markdown:[t],hatena:[t]})}}),e)}}},86795:(e,t,r)=>{"use strict";var n,i=(n=r(20996))&&n.__esModule?n:{default:n},a=r(10714),o=r(92477);var s=r(65311),l=r(66419),d=function(){this.init.apply(this,arguments)};d.prototype={init:function(e){this.type="editor-hatena-bookmark",this.$container=e.container,this.$container.get(0)&&(this.$header=this.$container.find(".header"),this.$itemsContainer=this.$container.find(".items"),this.$indicator=this.$container.find(".indicator"),this.template=l.template(this.$container.find(".template").html()),this.$errorMessage=this.$container.find(".error-message"),this.$disabledMessage=this.$container.find(".disabled-message"),this.$footer=this.$container.find(".footer"),this.$pasteButton=this.$container.find(".paste-button"),this.sidebar=e.sidebar,this.loadedPage=0,this.bindEvents(),this.resize(),this.loadItems(1))},bindEvents:function(){var e=this;const t=e=>{e===this.type&&(this.resize(),this.loadItems(1))};this.sidebar.on("resize",t),this.sidebar.on("tabChange",t),e.$itemsContainer.on("click",".item",(function(t){if(!(s(t.target).is("a")||s(t.target).parents("a").length>0))return s(this).toggleClass("selected"),e.selectedItemsChanged(),!1})),e.$container.on("dblclick",".item",(function(t){s(t.target).is("a")||s(t.target).parents("a").length>0||(e.insertItems([s(this)]),s(this).removeClass("selected"),e.selectedItemsChanged())})),e.$pasteButton.click((t=>{var r=[];e.selectedItems().each((function(){r.push(s(this)),s(this).removeClass("selected")})),e.insertItems(r.reverse()),e.selectedItemsChanged()})),e.$itemsContainer.scroll(l.throttle((()=>{(e.$itemsContainer.scrollTop()+e.$itemsContainer.height())/e.$itemsContainer[0].scrollHeight>.7&&e.loadItems(e.loadedPage+1)}),100))},resize:function(){var e=this,t=s(window).height()-s("#editor-main").offset().top;e.$itemsContainer.height(t-e.$header.outerHeight(!0)-e.$footer.outerHeight(!0))},selectedItemsChanged:function(){var e=this;e.selectedItems().length>0?e.$pasteButton.removeClass("disabled").addClass("enabled").prop("disabled",!1):e.$pasteButton.removeClass("enabled").addClass("disabled").prop("disabled",!0)},selectedItems:function(){return this.$itemsContainer.find(".selected")},loadItems:function(e){var t=this;t.isLoading||t.$container.is(":visible")&&(e>10||t.failed||t.loadedPage>e||(t.isLoading=!0,t.$indicator.show(),t.$errorMessage.hide(),s.ajax({url:`/api/hatena_bookmark/bookmarks?page=${e}`,type:"GET",dataType:"json"}).done((r=>{t.$errorMessage.hide(),1!==e||0!==r.length?t.showItems(r):t.showDisabledMessage()})).fail((e=>{t.$errorMessage.show(),t.failed=!0})).always((()=>{t.$indicator.hide(),t.isLoading=!1})),t.loadedPage=e))},showDisabledMessage:function(){var e=this;e.$disabledMessage.show(),e.$itemsContainer.hide(),e.$footer.hide(),e.failed=!0},showItems:function(e){var t=this,r="";l.each(e,(e=>{r+=t.template({item:e})})),t.$indicator.before(r),i.default.updateTimestamps(t.$container[0])},insertItems:function(e){var t=[];l.each(e,(e=>{var r=e.attr("data-comment-url"),n=e.attr("data-permalink"),i=e.attr("data-description");i&&i.length>0?t.push(`[${r}:embed]`):t.push(`[${n}:embed:cite]`)}));var r={html:t,hatena:t,markdown:t};"html"===s("#syntax").val()?(0,o.extractSyntax)(t.join("\n")).done((e=>{r.html=["",e.html,""]})).always((()=>{a.EditorConnector.insertLines(r)})):a.EditorConnector.insertLines(r)}},e.exports=d},22117:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Home=void 0;var n=l(r(65311)),i=l(r(57942)),a=r(55992),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(347));function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}function l(e){return e&&e.__esModule?e:{default:e}}t.Home=class{constructor(e){this.type="editor-home",this.$element=e.container,this.sidebar=e.sidebar,this.$header=this.$element.find(".header"),this.$services=this.$element.find(".services"),this.setupButtons(),this.setupButtonActive(),this.bindEvents()}bindEvents(){this.$element.on("click",".select-service",(e=>{const t=(0,n.default)(e.currentTarget);this.sidebar.emit("openByType",t.attr("data-support-type")),e.preventDefault()}));const e=e=>{e===this.type&&this.resize()};this.sidebar.on("resize",e),this.sidebar.on("tabChange",e)}resize(){this.$services.height(this.$element.height()-this.$header.outerHeight(!0))}setupButtons(){this.$element.on("change","input",(e=>{const t=(0,n.default)(e.currentTarget),r=t.closest(".service").attr("data-service-id"),s=t.prop("checked")?1:0,l=(0,a.protocolRelativeAdminUserBlogUrl)("/edit_sidebar_button");o.default.post(l,{service_id:r,show:s,rkm:(0,i.default)("rkm"),rkc:(0,i.default)("rkc")},{transformRequest:o.formDataRequest}).then((()=>{this.sidebar.emit("reloadSidebarButtons")}))}))}setupButtonActive(){this.$element.on("mouseenter",".about",(e=>{(0,n.default)(e.currentTarget).find(".curation-itemlist").addClass("is-active")})).on("mouseleave",".about",(e=>{(0,n.default)(e.currentTarget).find(".curation-itemlist").removeClass("is-active")}))}}},60717:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ImagePicker=void 0;var n=r(55992),i=l(r(20996)),a=r(29696),o=l(r(65311)),s=l(r(66419));function l(e){return e&&e.__esModule?e:{default:e}}const d=r(19165),u=[1,2,3],c=e=>e.sort(((e,t)=>parseInt((0,o.default)(e).attr("item-order"),10)-parseInt((0,o.default)(t).attr("item-order"),10)));t.ImagePicker=class{constructor(e){this.$element=e.container,this.editor=e.editor,this.syntax=this.editor.syntaxForInsertLines,this.storageKey=e.storageKey,this.showDetailSettingsCheckboxKey=e.showDetailSettingsCheckboxKey,this.showLoadingWhilePasting=e.showLoadingWhilePasting,this.convertItemsToFotolifeSyntaxes=e.convertItemsToFotolifeSyntaxes,this.onPasteSuccess=e.onPasteSuccess;const{items:t,pasteButton:r,footerButtons:n,gridDropdown:i,gridDropdownToggle:a,showDetailSettingsCheckbox:o}=e.selectors;if(this.$items=this.$element.find(t),this.$pasteButton=this.$element.find(r),this.$footerButtons=this.$element.find(n),this.$gridDropdown=i?this.$element.find(i):void 0,this.$gridDropdownToggle=a?this.$element.find(a):void 0,this.$showDetailSettingsCheckbox=o?this.$element.find(o):void 0,this.showDetailSettingsCheckboxSelector=o,this._setupEvents(),this.imageLayout="column",this.clickOrder=0,this.$showDetailSettingsCheckbox&&this.showDetailSettingsCheckboxKey){const e=!1!==d.load(this.showDetailSettingsCheckboxKey);this.$showDetailSettingsCheckbox.prop("checked",e)}}get useHires(){if(void 0===this.storageKey)return!1;const e=d.load(this.storageKey);return 1===e||2===e}_setupEvents(){this.$items.on("click",".item",(e=>{const t=(0,o.default)(e.currentTarget);t.hasClass("disabled")||(t.toggleClass("selected"),t.is(".selected")?t.attr("item-order",""+this.clickOrder++):t.find(".item-order-label").remove(),this.$items.find(".selected").length?this.$pasteButton.removeClass("disabled").addClass("enable"):this.$pasteButton.removeClass("enable").addClass("disabled"),this._updateOrderLabel())})),this.$items.on("dblclick",".item",(e=>{const t=(0,o.default)(e.currentTarget);if(t.hasClass("disabled"))return;t.removeClass("selected"),t.find(".item-order-label").remove();const r=e.currentTarget,n=this.convertItemsToFotolifeSyntaxes([r]);this.showLoadingWhilePasting&&(0,a.waitForPromise)(r,n),n.then((e=>{const t=e[0];this.editor.insert(t["html"===this.syntax?"html":"syntax"]),this._onPasteSuccess()})),this._updateOrderLabel()})),this.$pasteButton.addClass("disabled").on("click",(()=>{const e=this.$items.find(".item.selected").get(),t=this.convertItemsToFotolifeSyntaxes(c(e));if(this.showLoadingWhilePasting)for(const r of e)(0,a.waitForPromise)(r,t);return t.then((e=>{this.pasteItems({items:e}).then(this._onPasteSuccess.bind(this),(()=>{}))})),!1})),this.$footerButtons.on("change",".fotolife-layout",(e=>{(0,o.default)(e.currentTarget).find("label.selected").removeClass("selected");const t=(0,o.default)(e.currentTarget).find("input:checked");t.closest("label").addClass("selected"),this.imageLayout=t.val()})),this.$showDetailSettingsCheckbox&&this.showDetailSettingsCheckboxKey&&this.$footerButtons.on("change",this.showDetailSettingsCheckboxSelector,(e=>{const t=(0,o.default)(e.currentTarget).prop("checked");d.save(this.showDetailSettingsCheckboxKey,t)})),this.$gridDropdown&&this._setupGridDropdownEvents()}pasteItems(e){const{items:t,isUploadError:r}=e;if(!t.length)return r?Promise.resolve():Promise.reject("No images to paste");let n="";const i=t.map((e=>e.image)),a="row"===this.imageLayout&&t.length>1;return n=a?this._generateRowLayoutSyntax(t):t.map((e=>"html"===this.syntax?e.html:e.syntax)).join(""),new Promise((e=>{if(this.$element.find(".curation-embed-config input").prop("checked"))this.editor.emit("paste-foto",{syntax:n,onSuccess:e,thumbnailUrls:i,isUploadError:!!r});else{const t="html"===this.editor.mode;this.editor.insert(`${n}${t?"<br>":""}`),e()}}))}_onPasteSuccess(){this.$items.find(".item.selected").removeClass("selected").find(".item-order-label").remove(),this.clickOrder=0,this.$pasteButton.removeClass("enable").addClass("disabled"),this.onPasteSuccess&&this.onPasteSuccess()}_generateRowLayoutSyntax(e){return`<div class="images-row mceNonEditable">${e.map((e=>{if("html"===this.syntax){const t=(0,o.default)(e.html).find("img"),r=(0,o.default)(o.default.parseHTML('<div><div class="images-row-item"></div></div>'));return r.find(".images-row-item").append(t),r.get(0).innerHTML}return e.syntax})).join("")}</div>`}_updateOrderLabel(){s.default.debounce(this._putOrDeleteOrderLabel,250).call(this)}_putOrDeleteOrderLabel(){const e=this.$items.find(".item.selected");(0,o.default)(c(e.get())).each(e.length>1?(e,t)=>{const r=(0,o.default)(t).find(".item-order-label");r[0]?r.text(`${e+1}`):(0,o.default)(t).append((0,o.default)(o.default.parseHTML(`<div class="item-order-label">${e+1}</div>`)))}:(e,t)=>{(0,o.default)(t).find(".item-order-label").remove()})}_setFotoColumn(e){if(u.forEach((e=>this.$items.removeClass(`image-picker-grid-col-${e}`))),this.$items.addClass(`image-picker-grid-col-${e}`),this.$gridDropdownToggle){const t=["blogicon-grid-vertical","blogicon-grid","blogicon-grid-3x3"];this.$gridDropdownToggle.children("i").attr("class",t[e-1])}this.$gridDropdown&&this.$gridDropdown.removeClass("is-open")}_changeFotoResolution(e){const t=1===e||2===e;this.$items.children(".item").each(((e,r)=>{const n=(0,o.default)(r);if(n.hasClass("pager-next"))return;const i=t?n.data("hires-image"):n.data("image");(0,a.loadImage)(i,r)}))}_setupGridDropdownEvents(){this.$gridDropdownToggle&&this.$gridDropdown&&(this.$gridDropdownToggle.on("click",(()=>{this.$gridDropdown&&this.$gridDropdown.toggleClass("is-open")})),this.$gridDropdown.on("click",(e=>{const t=(0,o.default)(e.target).closest("li").attr("class").match(/^js-fotolife-grid-(1|2|3)$/);if(null===t)return;const r=Number(t[1]);this._setFotoColumn(r),this._changeFotoResolution(r),void 0!==this.storageKey&&d.save(this.storageKey,r)})),void 0!==this.storageKey&&this._setFotoColumn(d.load(this.storageKey)))}showLoading(){this.$items.empty();const e=document.createElement("div");e.classList.add("editor-sidebar_loading-indicator");const t=document.createElement("img");t.classList.add("loading-spinner"),t.src=(0,n.staticUrl)("/images/loading.gif"),t.alt="",e.appendChild(t),e.appendChild(document.createTextNode(i.default.text("loading"))),this.$items.append(e)}showLoadingError(e){this.$items.empty();const t=document.createElement("p");t.textContent=e||i.default.text("edit_form.get_data_failed"),this.$items.append(t)}addItem(e){this.$items.prepend((0,o.default)(e.element))}renderItems(e,t,r){t&&this.$items.empty(),this.$items.append(e.map((e=>e.element))),r&&(0,o.default)('<div class="item pager-next"/>').on("click",(e=>((0,o.default)(e.currentTarget).remove(),r(),!1))).appendTo(this.$items)}resize(e,t){this.$items.height(e-t-this.$footerButtons.outerHeight(!0)-2*(this.$items.outerHeight(!0)-this.$items.height()))}}},62433:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Item=void 0;var n,i=r(29696),a=(n=r(20996))&&n.__esModule?n:{default:n};t.Item=class{constructor(e,t){this.image=e.image,this.hiresImage=e.hires_thumbnail,this.attributes=e.attributes||new Map,this.isUploading=!1,this.percent=a.default.text("uploading"),this.barWidth="0",this.element=this.createElement(e.isDisabled),this.render(t)}createElement(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=document.createElement("div");return t.classList.add("item"),e&&t.classList.add("disabled"),t}getUploadingHTMLString(e){const{percent:t,width:r}=e;return`<div class="progress"><div class="percent">${t}</div><div class="bar" style="width: ${r}"></div></div>`}render(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];for(const[e,t]of Array.from(this.attributes.entries()))this.element.dataset[e]=t;if(this.hiresImage&&(this.element.dataset.hiresImage=this.hiresImage),Array.from(this.element.childNodes).forEach((e=>this.element.removeChild(e))),(0,i.loadImage)(e&&this.hiresImage?this.hiresImage:this.image,this.element,!0),this.isUploading){const e=this.getUploadingHTMLString({percent:this.percent,width:this.barWidth});this.element.insertAdjacentHTML("beforeend",e),this.element.classList.add("is-uploading")}else this.element.classList.remove("is-uploading")}listenTo(e,t,r){this.isUploading=!0;let n=0,i=0;const o=e=>{this.barWidth=`${Math.min(e,100)}%`,this.percent=a.default.text("uploading"),this.render()};e.on("error",(e=>{clearInterval(n),this.element.parentNode&&this.element.parentNode.removeChild(this.element),t.emit("error",e)})),e.on("disk_full",(e=>{clearInterval(n),this.element.parentNode&&this.element.parentNode.removeChild(this.element),t.emit("disk_full",e)})),e.on("progress",(e=>{const t=.9*e.percent;100===e.percent?(clearInterval(n),n=window.setInterval((()=>{i+=.1,o(t+i)}),100)):o(t)})),e.on("success",(e=>{clearInterval(n),this.isUploading=!1,this.image=e.image,this.attributes=r(e),this.render(),t.emit("success",e)}))}}},29696:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.waitForPromise=t.loadImage=void 0;var n=r(55992);t.loadImage=function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&t.classList.add("is-loading");const r=document.createElement("div");r.classList.add("image");const i=document.createElement("img");if(i.classList.add("loading-spinner"),t.appendChild(r),t.appendChild(i),e){const n=new Image;n.onload=()=>{t.classList.remove("is-loading")},n.src=e,r.style.backgroundImage=`url('${n.src}')`}i.src=(0,n.staticUrl)("/images/loading.gif")};t.waitForPromise=(e,t)=>{e.classList.add("is-loading"),t.then((()=>{e.classList.remove("is-loading")}))}},46171:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InfiniteScroll=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=i(t);if(r&&r.has(e))return r.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=a?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,r&&r.set(e,n);return n}(r(67294));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(i=function(e){return e?r:t})(e)}function a(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const o=r(66419),s={position:"absolute",top:0,left:0,width:"100%",height:"100%",margin:0,padding:0,overflowY:"auto"},l={width:"100%"};class d extends n.Component{constructor(){super(...arguments),a(this,"_interval",300),a(this,"_padding",100),a(this,"_pos",0),a(this,"_outer",null)}componentDidMount(){this._interval=Number.isFinite(this.props.interval)?+this.props.interval:300,this._padding=Number.isFinite(this.props.padding)?+this.props.padding:100,this._pos=0,this._onScroll=o.throttle((e=>this.onScroll(e)),this._interval),this._onScroll&&this._outer.addEventListener("scroll",this._onScroll)}componentWillUnmount(){this._outer.removeEventListener("scroll",this._onScroll),this._onScroll=void 0,this._pos=0}onScroll(e){if(this.props.disabled)return;const t=e.target,r=this._pos;if(this._pos=t.scrollTop,this._pos-r<=0)return;const n=t.scrollHeight-(t.clientHeight+t.scrollTop);this._padding<=n||this.props.onScroll()}render(){return n.createElement("div",{className:"InfiniteScroll","data-testid":"infinite-scroll",ref:e=>{this._outer=e},style:s,onScroll:this._onScroll},n.createElement("div",{className:"InfiniteScroll__Inner",style:l},this.props.children))}}t.InfiniteScroll=d,a(d,"defaultProps",{padding:100,interval:300,disabled:!1})},30871:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Instagram=void 0;var n,i=r(10714),a=r(70879),o=r(92477),s=r(57753),l=(n=r(65311))&&n.__esModule?n:{default:n};class d extends s.MyCuration{get type(){return"editor-instagram"}get serviceName(){return"Instagram"}get enableAutoPager(){return!0}get pasteReverseOrder(){return!0}constructor(e){super(e),(0,l.default)(this).on("items-appended",(()=>{this.setPaddingLeft()})),this.resize(),this.bindEvents()}loadItems(e){const t=e?this.$itemsContainer.attr("data-after-cursor"):void 0,r={after:void 0!==t&&""!==t?t:void 0};return l.default.ajax({url:"/api/instagram/recent",data:r,type:"GET",dataType:"json"}).then((e=>{if(e.error)return l.default.Deferred().reject().promise();const t=e.data||[];return e.paging&&e.paging.cursors.after?this.$itemsContainer.attr("data-after-cursor",e.paging.cursors.after):this.itemsReachedEnd=!0,{entries:t}})).fail((()=>{this.pleaseReAuthorize()}))}pleaseReAuthorize(){this.$container.find(".disabled-box").show()}insertItems(e){const t={hatena:[],markdown:[],html:[]};for(const r of e){const e=r.attr("data-permalink");t.hatena.push(`[${e}:embed]`),t.markdown.push(`[${e}:embed]`)}(0,o.extractSyntax)(t.hatena).done((e=>{t.html=[e.html]})).fail((e=>{t.html=t.hatena,(0,a.BUG)(e)})).always((()=>{i.EditorConnector.insertLines(t)}))}setPaddingLeft(){const e=this.$container.find(".items"),t=e.find(".item");if(0===t.length)return;const r=t.eq(0),n=r.position().top,i=r.position().left;let a=i+r.outerWidth();t.each(((e,t)=>{const r=(0,l.default)(t);if(r.position().top!==n)return!1;a=r.position().left+r.outerWidth()}));const o=a-i,s=(e.width()-o)/2;e.css({"padding-left":s})}}t.Instagram=d},35227:(e,t,r)=>{"use strict";var n=r(41960),i=r(70879),a=r(92477),o=r(10714),s=r(57753);const l=r(65311),d=r(66419);class u extends s.MyCuration{get type(){return"editor-itunes"}get serviceName(){return"Itunes"}get enableAutoPager(){return!1}get pasteReverseOrder(){return!1}constructor(e){super(e),this._templatesByType={default:d.template(this.$container.find(".template").html()),artist:d.template(this.$container.find(".template-artist").html()),collection:d.template(this.$container.find(".template-collection").html()),audiobook:d.template(this.$container.find(".template-collection").html())},this.bindEvents()}bindEvents(){super.bindEvents(),this.$submit=this.$container.find(".itunes-keyword-submit"),this.$media=this.$container.find(".itunes-media"),this.$keyword=this.$container.find(".itunes-keyword"),this.$welcomeMessage=this.$container.find(".items-welcome"),this.$submit.on("click",(()=>(this.requestReload(),!1))),this.$media.on("change",(()=>(this.requestReload(),!1))),this.$keyword.on("keydown",(e=>{if("RET"===(0,n.keyString)(e))return this.requestReload(),!1}))}willRequestLoadItems(){return""!==this.$keyword.val()}loadItems(){this.$welcomeMessage.addClass("disable");const e=this.$keyword.val(),t=this.$media.val().split(":"),r={term:e,media:t[0],entity:t[1]};return l.ajax({url:"/api/itunes/search",data:r,type:"GET",dataType:"json"})}renderItem(e){const t=e.wrapperType||"default";return this._templateByType(t)({item:{...e,_formattedPrice:this._renderPrice(e),_genre:this._renderGenre(e)}})}_renderPrice(e){if(void 0!==e.formattedPrice)return e.formattedPrice;if(void 0!==e.trackPrice||void 0!==e.collectionPrice){const t=e.trackPrice||e.collectionPrice,r=e.currency;return t<0?"":"JPY"===r?`${t}`:`${r} ${t}`}return""}_renderGenre(e){return void 0!==e.genres&&Array.isArray(e.genres)&&e.genres.length>0?e.genres[0]:void 0!==e.primaryGenreName?e.primaryGenreName:""}_templateByType(e){return this._templatesByType[e]||this._templatesByType.default}insertItems(e){const t={hatena:[],markdown:[]};e.forEach((e=>{const r=`[${e.attr("data-permalink")}:embed]`;t.hatena.push(r),t.markdown.push(r)})),(0,a.extractSyntax)(t.hatena).done((e=>{t.html=["",e.html,""]})).fail((e=>{t.html=t.hatena,(0,i.BUG)(e)})).always((()=>{(o.EditorConnector.isiOS()||o.EditorConnector.isAndroid())&&(t.html=t.hatena),o.EditorConnector.insertLines(t)}))}}e.exports=u},90381:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoadingIndicator=void 0;var n,i=l(r(67294)),a=l(r(55992)),o=(n=r(20996))&&n.__esModule?n:{default:n};function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}function l(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}return n.default=e,r&&r.set(e,n),n}t.LoadingIndicator=e=>{let{text:t}=e;return i.createElement("div",{className:"editor-sidebar_loading-indicator","data-testid":"editor-sidebar_loading-indicator"},i.createElement("img",{src:a.staticUrl("/images/loading.gif"),alt:"",className:"loading-spinner"}),t??o.default.text("loading"))}},25916:(e,t,r)=>{"use strict";var n=r(57753);const i=r(65311),a=r(66419),o=r(17187).EventEmitter,s=r(62439);class l extends n.MyCuration{get type(){return"editor-miil"}get serviceName(){return"Miil"}get enableAutoPager(){return!0}get pasteReverseOrder(){return!0}constructor(e){super(e),this.editor=e.editor,this.emitter=new o,this.userManager=new s({container:this.$container,emitter:this.emitter}),this.emitter.on("userRegistered",(()=>{this.resetUser(),this.requestLoadItems(),this.resize()})),this.emitter.on("userUnregistered",(()=>{this.resetUser(),this.resize()}));const t=this.$container.find(".editor-template");this.editorTemplate=a.template(t.html()),this.bindEvents()}loadItems(e){const t=i.Deferred();if(!this.userManager||!this.userManager.getUser())return t.reject(),t;const r=this.userManager.getUser();return e&&r.forward(),r.load().done((e=>{const r=e.photos;r.forEach((e=>{e.thumbnail_url=`${e.url}=s72`})),t.resolve({entries:r})})).fail((()=>{t.reject(),this.itemsReachedEnd=!0})),t}insertItems(e){const t=[];a.each(e,(e=>{const r=e.attr("data-permalink"),n=e.attr("data-image-url"),i=e.attr("data-title");"html"===this.editor.getSyntax()?t.push(this.editorTemplate({item:{permalink_url:r,image_url:n,title:i}})):(t.push(`[${r}:image=${n}]`),i&&t.push(i))})),this.editor.insertLines(t)}resetUser(){this.itemsReachedEnd=!1,this.removeItems(),this.userManager&&this.userManager.getUser()&&this.userManager.getUser().rewind()}}e.exports=l},6702:(e,t,r)=>{"use strict";const n=r(65311),i=r(22592);e.exports=class{constructor(e){this.name=e,this.photosLoaderRoot=new i((e=>this._photosLoaderBody(e))),this.photosLoader=this.photosLoaderRoot}getName(){return this.name}getImage(){return this.basicData.photos[0].user.user_icon_url}load(){return this.photosLoader.promise()}forward(){this.photosLoader=this.photosLoader.next()}rewind(){this.photosLoader=this.photosLoaderRoot}exists(){return"resolved"===this.photosLoaderRoot.promise().state()}_photosURL(e){return`http://api.miil.me/api/users/${this.name}/photos/public.json?${n.param(e)}`}_getNextPageFromReceivedData(e){if(!e)return;if(!e.next_url)return;const t=e.next_url.match(/page=(\d+)/);return t?t[1]:void 0}_photosLoaderBody(e){const t=n.Deferred(),r=n.Deferred();return e?e.promise().done((e=>{const t=this._getNextPageFromReceivedData(e);t||r.reject(),r.resolve(t)})).fail((()=>{r.reject()})):r.resolve(),r.done((e=>{var r={};e&&(r.page=e),n.ajax({url:"/api/external/json",type:"GET",dataType:"json",data:{url:this._photosURL(r)}}).done((e=>{e&&e.photos&&e.photos.length>0?(this.basicData||(this.basicData=e),t.resolve(e)):t.reject()})).fail((()=>{t.reject()}))})).fail((()=>{t.reject()})),t}}},53750:(e,t,r)=>{"use strict";const n=r(65311),i=r(6702);e.exports=class{constructor(){this.users={}}loadUser(e){const t=n.Deferred();return this.users[e]||(this.users[e]=new i(e)),this.users[e].load().always((()=>{t.resolve(this.users[e])})),t}}},62439:(e,t,r)=>{"use strict";var n=r(41960);const i=r(19165),a=r(53750);e.exports=class{get DEFAULT_UESR_IMAGE(){return"http://assets.miil.me/images/pc/user.jpg"}constructor(e){this.$container=e.container,this.$input=this.$container.find(".miil-user-name"),this.$registerButton=this.$container.find(".register-button"),this.$unregisterButton=this.$container.find(".unregister-button"),this.$userImage=this.$container.find(".user-image"),this.$name=this.$container.find(".user-name"),this.$nameLink=this.$container.find(".user-name-link"),this.$userNotFound=this.$container.find(".user-not-found-error"),this.emitter=e.emitter,this.userLoader=new a,this.bindEvents(),this.$input.val(this.loadUserName()),this.tryRegisterFromInput()}bindEvents(){this.$registerButton.on("click",(()=>(this.tryRegisterFromInput(),!1))),this.$input.on("keydown",(e=>{if("RET"===(0,n.keyString)(e))return this.tryRegisterFromInput(),!1})),this.$unregisterButton.on("click",(()=>(this.unregister(),!1)))}tryRegisterFromInput(){const e=this.$input.val();e&&this.tryRegister(e)}getUser(){return this.currentUser}tryRegister(e){this.userLoader.loadUser(e).done((e=>{e.exists()?this.onUserFound(e):(this.unregister(),this.$userNotFound.show())}))}onUserFound(e){this.currentUser=e,this.setUserImage(e.getImage()||this.DEFAULT_UESR_IMAGE),this.$name.text(e.getName()),this.$nameLink.attr("href",`http://miil.me/u/${e.getName()}`),this.saveUserName(e.getName()),this.$userNotFound.hide(),this.$container.addClass("registered"),this.emitter.emit("userRegistered")}unregister(){this.currentUser=null,this.$input.focus(),this.setUserImage(this.DEFAULT_UESR_IMAGE),this.saveUserName(""),this.$userNotFound.hide(),this.$container.removeClass("registered"),this.emitter.emit("userUnregistered")}setUserImage(e){this.$userImage.attr("src",e)}saveUserName(e){i.save("miil-user-name",e)}loadUserName(){return i.load("miil-user-name")||""}}},16907:(e,t,r)=>{"use strict";e.exports=r(25916)},57753:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MyCuration=void 0;var n=s(r(65311)),i=s(r(66419)),a=s(r(20996)),o=r(34327);function s(e){return e&&e.__esModule?e:{default:e}}t.MyCuration=class{get type(){return null}get enableAutoPager(){return!1}get pasteReverseOrder(){return!1}constructor(e){this.editor=e.editor,this.sidebar=e.sidebar,this.$container=e.container,this.$header=this.$container.find(".header"),this.$itemsContainer=this.$container.find(".items"),this.$tabsContainer=this.$container.find(".tab-container"),this.$indicator=this.$container.find(".indicator"),this.$errorMessage=this.$container.find(".error-message"),this.$disabledMessage=this.$container.find(".disabled-message"),this.$footer=this.$container.find(".footer"),this.$pasteButton=this.$container.find(".paste-button");const t=this.$container.find(".template");if(this.template=i.default.template(t.html()),this.loadedPage=0,this.itemsReachedEnd=!1,this.itemLoaded=!1,this.$container.get(0)&&!t.get(0))throw new Error("No template found for MyCuration subclass")}bindEvents(){const e=e=>{e===this.type&&(this.resize(),this.requestLoadItems())};this.sidebar.on("resize",e),this.sidebar.on("tabChange",e),this.$itemsContainer.on("click",".item",(e=>{if(!((0,n.default)(e.target).is("a")||(0,n.default)(e.target).parents("a").length>0))return(0,n.default)(e.currentTarget).toggleClass("selected"),this.selectedItemsChanged(),!1})),this.$container.on("dblclick",".item",(e=>{if((0,n.default)(e.target).is("a"))return;if((0,n.default)(e.target).parents("a").length>0)return;const t=(0,n.default)(e.currentTarget);return this.insertItems([t]),t.removeClass("selected"),this.selectedItemsChanged(),!1})),this.$pasteButton.on("click",(()=>{const e=[];this.selectedItems().each(((t,r)=>{const i=(0,n.default)(r);e.push(i),i.removeClass("selected")})),this.insertItems(this.pasteReverseOrder?e.reverse():e),this.selectedItemsChanged()})),this.tabs=new o.MyCurationTab({container:this.$tabsContainer,backupKey:this.serviceName}),this.tabs.on("tabChange",(()=>{this.removeItems(),this.requestLoadItems()})),this.enableAutoPager&&this.$itemsContainer.on("scroll",i.default.throttle((()=>{(this.$itemsContainer.scrollTop()+this.$itemsContainer.height())/this.$itemsContainer[0].scrollHeight>.7&&!this.itemsReachedEnd&&this.requestLoadItems(!0)}),100))}resize(){const e=(0,n.default)(window).height(),t=(parseInt(this.$itemsContainer.css("padding-top"),10)||0)+(parseInt(this.$itemsContainer.css("padding-bottom"),10)||0);this.$itemsContainer.height(e-this.$container.offset().top-this.$header.outerHeight(!0)-this.$footer.outerHeight(!0)-t)}selectedItemsChanged(){this.selectedItems().length>0?this.$pasteButton.removeClass("disabled").addClass("enabled").prop("disabled",!1):this.$pasteButton.removeClass("enabled").addClass("disabled").prop("disabled",!0)}selectedItems(){return this.$itemsContainer.find(".selected")}requestLoadItems(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isLoading||this.$container.is(":visible")&&(!e&&this.itemLoaded||this._requestLoadItems(e))}willRequestLoadItems(e){return!0}_requestLoadItems(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.willRequestLoadItems(e)&&(this.isLoading=!0,this.$indicator.show(),this.$errorMessage.hide(),this.loadItems(e).done((e=>{this.showItems(e.entries),this.itemLoaded=!0})).fail((e=>{this.$errorMessage.show()})).always((()=>{this.$indicator.hide(),this.isLoading=!1,this.loadItemsFinishedHandler()})))}loadItemsFinishedHandler(){}requestReload(e){this.isLoading||(this.removeItems(),this._requestLoadItems())}getItemsOnPage(){return this.$itemsContainer.find(".item")}removeItems(){this.getItemsOnPage().remove()}showItems(e){const t=e.map((e=>this.renderItem(e))).join("");this.$indicator.before(t),a.default.updateTimestamps(this.$container[0]),(0,n.default)(this).triggerHandler("items-appended")}renderItem(e){return this.template({item:e})}insertItems(e){const t=e.map((e=>`[${e.attr("data-permalink")}:embed]`));this.editor.insertLines(t)}}},34327:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MyCurationTab=void 0;var n=o(r(65311)),i=o(r(66419)),a=r(17187);function o(e){return e&&e.__esModule?e:{default:e}}class s extends a.EventEmitter{constructor(e){super(),this.$container=e.container,this.backupKey=e.backupKey,this.localStorageKey=`MyCuration.Tab.${this.backupKey}`,this.values=this.$container.find("input").toArray().map((e=>(0,n.default)(e).val())),this.$container.on("change","input",(e=>{const t=(0,n.default)(e.currentTarget);this.$container.find("label.selected").removeClass("selected"),t.closest("label").addClass("selected");const r=t.val();this.value=r;try{localStorage[this.localStorageKey]=r}catch(e){}this.emit("tabChange")}));try{localStorage[this.localStorageKey]&&this.set(localStorage[this.localStorageKey])}catch(e){}}get(){return this.value||this.values[0]}set(e){if(!i.default.include(this.values,e))return;this.$container.find(`input[value="${e}"]`).click()}}t.MyCurationTab=s},84540:(e,t,r)=>{"use strict";var n=r(41960),i=r(70879),a=r(92477),o=r(10714),s=r(65311),l=r(66419),d=function(){this.init.apply(this,arguments)};d.prototype={init:function(e){this.type="editor-nicovideo",this.editor=e.editor,this.$container=e.container,this.$itemsContainer=this.$container.find(".items"),this.$input=this.$container.find(".nicovideo-keyword"),this.$inputReset=this.$container.find(".input-text-reset"),this.$pasteButton=this.$container.find(".paste-button"),this.$formatPlayer=this.$container.find(".nicovideo-formats label.player"),this.$formatThumbnail=this.$container.find(".nicovideo-formats label.thumbnail"),this.setupFormatSwitcher(".nicovideo-formats"),this.bindEvents()},bindEvents:function(){var e=this;e.$input.keyup(l.debounce((()=>{0!==e.$input.val().length&&e.updateThumb()}),500)),e.$input.keydown((t=>{if("RET"===(0,n.keyString)(t))return e.findItem().length>0&&e.insertItem(),!1})),e.$pasteButton.click((()=>{e.insertItem()})),e.setupInputReset()},setupInputReset:function(){var e=this;e.$inputReset.click((()=>(e.$input.val(""),e.$input.focus(),e.$inputReset.hide(),!1))),e.$input.keyup((t=>{e.$input.val().length>0?e.$inputReset.show():e.$inputReset.hide()}))},findItem:function(){return this.$container.find(".items > .item")},itemChanged:function(){var e=this,t=e.findItem();if(0!==t.length){e.setPasteButtonStatus(!0);var r=e.$formatPlayer,n=e.$formatThumbnail;"video"===t.data("type")?(r.addClass("format-left"),n.removeClass("format-left"),r.show()):(r.removeClass("format-left"),n.addClass("format-left"),r.is(".selected")&&(r.removeClass("selected"),r.find("input").prop("checked",!1),n.addClass("selected"),n.find("input").prop("checked",!0)),r.hide())}else e.setPasteButtonStatus(!1)},setPasteButtonStatus:function(e){e?this.$pasteButton.removeClass("disabled").addClass("enabled").prop("disabled",!1):this.$pasteButton.addClass("disabled").removeClass("enabled").prop("disabled",!0)},updateThumb:function(){var e=this,t=e.$input.val(),r=e.removeParamsFromURL(t),n=e.detectInfo(r);if(n){var i=e.renderPreviewTemplate(n.type,{id:n.id}),a=s(s.trim(i));a.data("type",n.type),a.data("id",n.id),e.$itemsContainer.html(a),e.itemChanged()}},removeParamsFromURL:function(e){return e.replace(/\?.*$/,"")},detectInfo:function(e){var t=this;return t.isNicovideoID(e)?t.detectInfoFromID(e):t.detectInfoFromURL(e)},detectInfoFromID:function(e){return{id:e,type:this.detectIDType(e)}},detectInfoFromURL:function(e){var t={video:new RegExp("nicovideo.jp/watch/(\\w{0,2}\\d+)$"),community:new RegExp("com.nicovideo.jp/community/(co\\d+)$")},r=!1;return l.find(t,((t,n)=>{var i=t.exec(e);return!!i&&(r={id:i[1],type:n},!0)})),r},isNicovideoID:function(e){return/^(\w{2})?\d+$/.test(e)},detectIDType:function(e){return"co"===e.slice(0,2)?"community":"video"},renderPreviewTemplate:function(e,t){const r=this.$container.find(`.template-nicovideo-preview-${e}`).html();return l.template(r)(t)},renderTemplate:function(e,t,r){const n=this.$container.find(`.template-nicovideo-${e}-${t}`),i=s.trim(n.html());return l.template(i)(r)},insertItem:function(){var e=this,t=[],r=e.$container.find('[name="nicovideo-format"]:checked').val(),n=e.findItem(),s=e.renderTemplate(n.data("type"),r,{id:n.data("id")});t.push(s);var l={html:t,hatena:t,markdown:t};"html"===e.editor.mode&&"link"===r?(0,a.extractSyntax)(t).done((e=>{l.html=[e.html],o.EditorConnector.insertLines(l)})).fail((e=>{(0,i.BUG)(e),o.EditorConnector.insertLines(l)})):o.EditorConnector.insertLines(l)},setupFormatSwitcher:function(e){var t=this.$container.find(e);t.on("change",(e=>{var r=s(e.target);t.find("label.selected").removeClass("selected"),r.closest("label").addClass("selected")}))}},e.exports=d},76530:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Paint=void 0;var n,i=(n=r(64722))&&n.__esModule?n:{default:n},a=r(97927);class o extends i.default{constructor(){super(...arguments),"editor-paint"===this.type&&this.on("success",(e=>{this.editor.insert("html"===this.syntax?e.html:e.syntax)}))}get selectors(){return{items:"#paint-items",pasteButton:"#paint-button-paste",footerButtons:"#paint-footer-buttons",uploadForm:"#paint-uploader",uploadFormWrapper:"#paint-uploader-wrapper"}}get type(){return"editor-paint"}get defaultFolder(){return"Hatena Blog Illust"}createUploadForm(){return new a.PaintUploadForm(this)}}t.Paint=o},97927:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaintUploadForm=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n},a=r(73380),o=r(86340),s=r(21650);function l(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}t.PaintUploadForm=class{constructor(e){l(this,"_fotoSize",s.Uploader.DEFAULT_SIZE),this.parent=e,this.initEvents()}async upload(e){const t=new s.Uploader;this.parent.emit("upload",t),await t.uploadPaint(e.base64String,e.ext)}fotoSize(){return this._fotoSize}initEvents(){const e=document.getElementById("js-canvas-open-button");e&&(0,a.safeRender)(i.default.createElement(o.PaintApp,{uploader:async e=>{await this.upload(e)}}),e)}}},41268:(e,t,r)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.uploaded=t.upload=t.undo=t.togglePaintWindow=t.toggleColorPicker=t.setPenSize=t.setMode=t.setColor=t.setCanvasSize=t.requestChangeCanvasSize=t.redo=t.hide=t.exportData=t.clearHistory=t.clear=void 0;const i=(0,((n=r(99308))&&n.__esModule?n:{default:n}).default)(),a=i("UNDO");t.undo=a;const o=i("REDO");t.redo=o;const s=i("CLEAR");t.clear=s;const l=i("CLEAR_HISTORY");t.clearHistory=l;const d=i("HIDE");t.hide=d;const u=i("EXPORT_DATA");t.exportData=u;const c=i("UPLOAD");t.upload=c;const p=i("UPLOADED");t.uploaded=p;const f=i("TOGGLE_COLOR_PICKER");t.toggleColorPicker=f;const h=i("TOGGLE_PAINT_WINDOW");t.togglePaintWindow=h;const m=i("SET_MODE");t.setMode=m;const g=i("SET_PEN_SIZE");t.setPenSize=g;const v=i("SET_COLOR");t.setColor=v;const b=i("REQUEST_CHANGE_CANVAS_SIZE");t.requestChangeCanvasSize=b;const y=i("SET_CANVAS_SIZE");t.setCanvasSize=y},78575:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaintCanvasComponent=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n};t.PaintCanvasComponent=e=>{let{divRef:t}=e;return i.default.createElement("div",null,i.default.createElement("div",{ref:t,style:{margin:"0 20px 15px"}}))}},69093:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaintMenuComponent=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n};t.PaintMenuComponent=e=>{let{CanvasControl:t,ModesSelector:r,ColorPicker:n,PenSizeSelector:a}=e;return i.default.createElement("div",{id:"paint-menu",className:"_wPaint_menu _wPaint_menu_horizontal"},i.default.createElement("div",{className:"_wPaint_options"},i.default.createElement("div",{className:"paint-menu-line"},i.default.createElement(t,null),i.default.createElement(r,null)),i.default.createElement("div",{className:"paint-menu-line"},i.default.createElement(a,null),i.default.createElement(n,null))))}},84121:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaintWindowModalComponent=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n},a=r(61090);t.PaintWindowModalComponent=e=>{let{children:t}=e;return i.default.createElement(a.Rnd,{cancel:"canvas, .js-color-picker",enableResizing:{},style:{cursor:"auto"}},i.default.createElement("div",{id:"paint-window-dev",style:{display:"block"}},t))}},19031:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasControlComponent=void 0;var n=o(r(67294)),i=r(21483),a=o(r(20996));function o(e){return e&&e.__esModule?e:{default:e}}const s=["_wPaint_icon"];t.CanvasControlComponent=e=>{let{undo:t,redo:r,clear:o}=e;return n.default.createElement(n.default.Fragment,null,n.default.createElement(i.PaintMenuIconComponent,{title:a.default.text("admin.paint.undo"),active:!1,onClick:t,classValues:[s,"_wPaint_undo"]}),n.default.createElement(i.PaintMenuIconComponent,{title:a.default.text("admin.paint.redo"),active:!1,onClick:r,classValues:[s,"_wPaint_redo"]}),n.default.createElement(i.PaintMenuIconComponent,{title:a.default.text("admin.paint.clear"),active:!1,onClick:o,classValues:[s,"_wPaint_clear"]}))}},23915:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaintCloseButtonComponent=void 0;var n=o(r(67294)),i=o(r(20996)),a=r(55992);function o(e){return e&&e.__esModule?e:{default:e}}t.PaintCloseButtonComponent=e=>{let{onClick:t}=e;return n.default.createElement("button",{type:"button",className:"close-paint",id:"close",title:i.default.text("close"),onClick:t,tabIndex:0,role:"button"},n.default.createElement("img",{src:(0,a.staticUrl)("/images/admin/close.svg"),alt:i.default.text("close")}))}},21483:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaintMenuIconComponent=void 0;var n=a(r(67294)),i=a(r(86010));function a(e){return e&&e.__esModule?e:{default:e}}const o=["tipsy-top"];t.PaintMenuIconComponent=e=>{let{title:t,active:r,classValues:a,onClick:s,style:l}=e;return n.default.createElement("div",{style:l,className:(0,i.default)([o,{active:r},a]),title:t,tabIndex:0,role:"button",onClick:s})}},65960:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaintUploadButtonComponent=void 0;var n=o(r(67294)),i=o(r(20996)),a=o(r(86010));function o(e){return e&&e.__esModule?e:{default:e}}t.PaintUploadButtonComponent=e=>{let{onClick:t,isUploading:r}=e;return n.default.createElement("button",{className:(0,a.default)(["canvas-upload-button","btn","btn-primary"]),onClick:t,type:"button",disabled:r},i.default.text("admin.upload_header_image"))}},24026:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaintCanvasSizeSelectorComponent=void 0;var n=s(r(67294)),i=r(55854),a=r(21483),o=s(r(20996));function s(e){return e&&e.__esModule?e:{default:e}}const l=["selector"];t.PaintCanvasSizeSelectorComponent=e=>{let{size:t,onChange:r}=e;return n.default.createElement("div",{className:"canvas-size-selector"},n.default.createElement(a.PaintMenuIconComponent,{style:{margin:"2px"},title:o.default.text("admin.paint.canvas-small"),active:t===i.CanvasSizeEnum.Small,onClick:()=>r(i.CanvasSizeEnum.Small),classValues:[l,"small"]}),n.default.createElement(a.PaintMenuIconComponent,{style:{margin:"2px"},title:o.default.text("admin.paint.canvas-middle"),active:t===i.CanvasSizeEnum.Medium,onClick:()=>r(i.CanvasSizeEnum.Medium),classValues:[l,"medium"]}),n.default.createElement(a.PaintMenuIconComponent,{style:{margin:"2px"},title:o.default.text("admin.paint.canvas-large"),active:t===i.CanvasSizeEnum.Large,onClick:()=>r(i.CanvasSizeEnum.Large),classValues:[l,"large"]}))}},53112:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaintMenuModesSelectorComponent=void 0;var n=s(r(67294)),i=r(55854),a=r(21483),o=s(r(20996));function s(e){return e&&e.__esModule?e:{default:e}}const l=["_wPaint_icon","paint-menu-tool"];t.PaintMenuModesSelectorComponent=e=>{let{mode:t,onClick:r}=e;return n.default.createElement(n.default.Fragment,null,n.default.createElement(a.PaintMenuIconComponent,{title:o.default.text("admin.paint.pencil"),active:t===i.PaintingMode.Pen,onClick:()=>r(i.PaintingMode.Pen),classValues:[l,"_wPaint_pencil"]}),n.default.createElement(a.PaintMenuIconComponent,{title:o.default.text("admin.paint.water"),active:t===i.PaintingMode.TransparentPen,onClick:()=>r(i.PaintingMode.TransparentPen),classValues:[l,"_wPaint_water"]}),n.default.createElement(a.PaintMenuIconComponent,{title:o.default.text("admin.paint.eraser"),active:t===i.PaintingMode.Eraser,onClick:()=>r(i.PaintingMode.Eraser),classValues:[l,"_wPaint_eraser"]}),n.default.createElement(a.PaintMenuIconComponent,{title:o.default.text("admin.paint.bucket"),active:t===i.PaintingMode.Filler,onClick:()=>r(i.PaintingMode.Filler),classValues:[l,"_wPaint_bucket"]}),n.default.createElement(a.PaintMenuIconComponent,{title:o.default.text("admin.paint.dropper"),active:t===i.PaintingMode.Eyedropper,onClick:()=>r(i.PaintingMode.Eyedropper),classValues:[l,"_wPaint_dropper"]}))}},62284:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaintPenSizesSelectorComponent=void 0;var n=o(r(67294)),i=r(21483),a=o(r(20996));function o(e){return e&&e.__esModule?e:{default:e}}const s=[2,3,5,10,15],l=["line"];t.PaintPenSizesSelectorComponent=e=>{let{size:t,onClick:r}=e;return n.default.createElement("div",{className:"_wPaint_lineWidth _wPaint_dropDown"},s.map((e=>n.default.createElement(i.PaintMenuIconComponent,{key:e,title:`${a.default.text("admin.paint.stroke_width")}(${e}px)`,active:t===e,onClick:()=>r(e),classValues:[l,`width${e}`]}))))}},4995:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.noopController=t.defaultPenSize=t.defaultMode=t.defaultColor=t.defaultCanvasSize=t.backgroundColor=t.INITIAL_STATE=t.CanvasSizes=void 0;var n=r(55854);const i={[n.CanvasSizeEnum.Small]:{width:360,height:240},[n.CanvasSizeEnum.Medium]:{width:540,height:360},[n.CanvasSizeEnum.Large]:{width:720,height:480}};t.CanvasSizes=i;const a=n.PaintingMode.Pen;t.defaultMode=a;const o=n.CanvasSizeEnum.Small;t.defaultCanvasSize=o;t.defaultPenSize=2;const s="#000";t.defaultColor=s;t.backgroundColor="#fff";const l={paintingMode:a,penSize:2,canvasSize:o,penColor:s,isColorPickerHide:!0,isWindowHide:!0,isUploading:!1};t.INITIAL_STATE=l;const d=()=>{},u={redo:d,undo:d,clear:d,clearHistory:d,exportData:d};t.noopController=u},97020:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasControl=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n},a=r(19031),o=r(20672),s=r(41268);t.CanvasControl=()=>{const e=(0,o.useDispatch)();return i.default.createElement(a.CanvasControlComponent,{undo:()=>{e((0,s.undo)())},redo:()=>{e((0,s.redo)())},clear:()=>{e((0,s.clear)())}})}},21022:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasOpenButton=void 0;var n=s(r(67294)),i=r(20672),a=s(r(20996)),o=r(41268);function s(e){return e&&e.__esModule?e:{default:e}}t.CanvasOpenButton=e=>{let{clickHandler:t}=e;const r=(0,i.useDispatch)();return n.default.createElement("button",{className:"canvas-open-button submit",onClick:()=>{t(),r((0,o.togglePaintWindow)())},style:{border:"none",appearance:"none",width:"100%"},type:"button"},n.default.createElement("i",{className:"blogicon-plus"}),a.default.text("admin.paint"))}},89739:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LazyPaintModalLoader=void 0;var n,i=d(r(67294)),a=r(90381),o=(n=r(20996))&&n.__esModule?n:{default:n},s=r(54040);function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(l=function(e){return e?r:t})(e)}function d(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=l(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}return n.default=e,r&&r.set(e,n),n}const u=(0,i.lazy)((()=>Promise.resolve().then((()=>d(r(57905)))).then((e=>({default:e.PaintAppContainer})))));t.LazyPaintModalLoader=()=>i.default.createElement(i.Suspense,{fallback:i.default.createElement(a.LoadingIndicator,{text:o.default.text("loading")})},i.default.createElement(s.PaintWindowPortal,{targetID:"paint-window-container"},i.default.createElement(u,null)))},18774:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ModesSelector=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n},a=r(20672),o=r(53112),s=r(41268);t.ModesSelector=()=>{const e=(0,a.useDispatch)(),t=(0,a.useSelector)((e=>e.paintingMode));return i.default.createElement(o.PaintMenuModesSelectorComponent,{mode:t,onClick:t=>{e((0,s.setMode)({mode:t}))}})}},86340:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaintApp=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),i=r(58322),a=r(21022),o=r(89739);function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}t.PaintApp=e=>{let{uploader:t}=e;const[r,s]=(0,n.useState)(!1);return n.default.createElement(i.PaintAppContextProvider,{uploader:t},n.default.createElement(a.CanvasOpenButton,{clickHandler:()=>{s(!0)}}),r&&n.default.createElement(o.LazyPaintModalLoader,null))}},57905:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaintAppContainer=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n},a=r(5916),o=r(97020),s=r(18774),l=r(39055),d=r(69093),u=r(8131),c=r(74677),p=r(10254),f=r(72016),h=r(84121);t.PaintAppContainer=()=>i.default.createElement(h.PaintWindowModalComponent,null,i.default.createElement(d.PaintMenuComponent,{CanvasControl:o.CanvasControl,ModesSelector:s.ModesSelector,PenSizeSelector:l.PaintSizeSelector,ColorPicker:f.PaintColorPicker}),i.default.createElement(p.PaintCanvas,null),i.default.createElement(a.PaintUploadButton,null),i.default.createElement(u.PaintCanvasSizeSelector,null),i.default.createElement(c.PaintCloseButton,null))},10254:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaintCanvas=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),i=r(78575),a=r(97279),o=r(6731);function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}t.PaintCanvas=()=>{const{divRef:e,controllers:t}=(0,a.usePaintCanvas)(),r=(0,n.useContext)(o.CanvasControllerContext);return(0,n.useEffect)((()=>{r.setController(t)}),[r,t]),n.default.createElement(i.PaintCanvasComponent,{divRef:e})}},8131:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaintCanvasSizeSelector=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n},a=r(20672),o=r(24026),s=r(41268);t.PaintCanvasSizeSelector=()=>{const e=(0,a.useDispatch)(),t=(0,a.useSelector)((e=>e.canvasSize));return i.default.createElement(o.PaintCanvasSizeSelectorComponent,{size:t,onChange:t=>{e((0,s.requestChangeCanvasSize)({size:t}))}})}},74677:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaintCloseButton=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n},a=r(20672),o=r(23915),s=r(41268);t.PaintCloseButton=()=>{const e=(0,a.useDispatch)();return i.default.createElement(o.PaintCloseButtonComponent,{onClick:()=>{e((0,s.togglePaintWindow)())}})}},72016:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaintColorPicker=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n},a=r(59587),o=r(52429),s=r(20672),l=r(41268);t.PaintColorPicker=()=>{const{toggle:e,isToggled:t}=(0,o.useToggleState)(!1),r=(0,s.useSelector)((e=>e.penColor)),n=(0,s.useDispatch)();return i.default.createElement(a.ColorPicker,{color:r,isShown:t,toggle:e,onChange:e=>{n((0,l.setColor)({color:e}))},buttonClassName:"_wColorPicker_buttonColor"})}},5916:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaintUploadButton=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n},a=r(20672),o=r(65960),s=r(41268);t.PaintUploadButton=()=>{const e=(0,a.useDispatch)(),t=(0,a.useSelector)((e=>e.isUploading));return i.default.createElement(o.PaintUploadButtonComponent,{isUploading:t,onClick:()=>{e((0,s.exportData)())}})}},54040:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaintWindowPortal=void 0;var n,i=r(73935),a=(n=r(67294))&&n.__esModule?n:{default:n},o=r(20672);t.PaintWindowPortal=e=>{let{children:t,targetID:r}=e;const n=document.getElementById(r),s=(0,o.useSelector)((e=>e.isWindowHide));return a.default.createElement("div",null,n&&(0,i.createPortal)(a.default.createElement("div",{style:{display:s?"none":"block"}},t),n))}},39055:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaintSizeSelector=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n},a=r(20672),o=r(62284),s=r(41268);t.PaintSizeSelector=()=>{const e=(0,a.useDispatch)(),t=(0,a.useSelector)((e=>e.penSize));return i.default.createElement(o.PaintPenSizesSelectorComponent,{size:t,onClick:t=>{e((0,s.setPenSize)({size:t}))}})}},6731:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasControllerContext=void 0;var n=r(67294),i=r(4995);const a=(0,n.createContext)({setController:()=>{},getController:()=>i.noopController});t.CanvasControllerContext=a},20672:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useSelector=t.useDispatch=t.paintAppStore=t.PaintReduxContext=void 0;var n=r(14890),i=r(92951),a=r(67294),o=r(96841),s=r(4995);const l=(0,n.createStore)(i.reducer);t.paintAppStore=l;const d=(0,a.createContext)({store:l,storeState:s.INITIAL_STATE});t.PaintReduxContext=d;const u=(0,o.createDispatchHook)(d);t.useDispatch=u;const c=(0,o.createSelectorHook)(d);t.useSelector=c},58322:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaintAppContextProvider=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n},a=r(6731),o=r(20672),s=r(61081);t.PaintAppContextProvider=e=>{let{children:t,uploader:r}=e;const{paintReduxContextValue:n,canvasControllersContextValue:l}=(0,s.usePaintAppContext)(r);return i.default.createElement(o.PaintReduxContext.Provider,{value:n},i.default.createElement(a.CanvasControllerContext.Provider,{value:l},t))}},91445:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DrawingCanvas=void 0;var n=u(r(20185)),i=r(55854),a=r(4995),o=r(44785),s=u(r(6767)),l=r(68481),d=r(32890);function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const p={canvasSize:a.CanvasSizes.medium,penSize:2,mode:i.PaintingMode.Pen,hexColor:a.defaultColor,onColorPick:()=>{}};t.DrawingCanvas=class{get hexColor(){return this.color.hex()}set hexColor(e){this.color=new s.default(e,"rgb")}get canvasSize(){return this._canvasSize}set canvasSize(e){const t=this.currentImageData;this._canvasSize=e,this.stage.width(e.width),this.stage.height(e.height),this.clear(),this.addImageData(t),this.clearHistory()}constructor(e,t){c(this,"filling",!1),c(this,"mode",i.PaintingMode.Pen),this.divElement=e;const r={...p,...t};this._canvasSize=r.canvasSize,this.penSize=r.penSize,this.mode=r.mode,this.onColorPick=r.onColorPick,this.color=new s.default(r.hexColor,"rgb"),this.canvasHistory=new d.HistoryStack,this.stage=new n.default.Stage({container:this.divElement,...this._canvasSize}),this.layer=new n.default.Layer,this.stage.add(this.layer),this.clear(),this.tools=(0,o.initializeTools)(this),this.currentTool=new l.NoopTool(this),this.setMode(this.mode)}setMode(e){this.cleanupStageEvent(),this.currentTool=this.tools.get(e)||new l.NoopTool(this),this.startStageEvent()}startStageEvent(){this.stage.on("mousedown touchstart",(()=>{this.currentTool.start()})),this.stage.on("mousemove touchmove",(()=>{this.currentTool.move()})),this.stage.on("mouseup touchend",(()=>{this.currentTool.end()}))}cleanupStageEvent(){this.stage.off("mousedown touchstart"),this.stage.off("mouseup touchend"),this.stage.off("mousemove touchmove")}getPixelCalibratedPointerPosition(){const e=this.stage.getPointerPosition();return e?{x:Math.floor(e.x*this.layer.getCanvas().getPixelRatio()),y:Math.floor(e.y*this.layer.getCanvas().getPixelRatio())}:null}clear(){this.layer.destroyChildren();const e=new n.default.Rect({x:0,y:0,listening:!0,fill:a.backgroundColor,...this._canvasSize});this.layer.add(e),this.layer.draw(),this.save()}clearHistory(){this.canvasHistory.clear(),this.save()}save(){this.canvasHistory.save(this.currentImageData)}undo(){const e=this.canvasHistory.undo();e&&this.setImageData(e)}redo(){const e=this.canvasHistory.redo();e&&this.setImageData(e)}get currentImageData(){const{width:e,height:t}=this.layer.canvas;return this.layer.getContext().getImageData(0,0,e,t)}addImageData(e){const{layer:t}=this,r=document.createElement("canvas");r.width=t.canvas.width,r.height=t.canvas.height;const i=r.getContext("2d");i&&(i.putImageData(e,0,0),t.add(new n.default.Image({image:r,width:t.width(),height:t.height()})),t.draw())}setImageData(e){this.layer.destroyChildren(),this.addImageData(e)}exportData(){const e=this.layer.getCanvas().toDataURL("image/png",1),t=e.split(",")[1]||"";return{ext:"png",dataURI:e,base64String:t}}}},23419:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Eraser=void 0;var n,i=(n=r(20185))&&n.__esModule?n:{default:n},a=r(25712);class o extends a.Pen{makeLine(e){const{penSize:t}=this.parent;return new i.default.Line({stroke:"#fff",strokeWidth:t,globalCompositeOperation:"source-over",points:[e.x,e.y]})}}t.Eraser=o},44518:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EyeDropper=void 0;var n,i=(n=r(6767))&&n.__esModule?n:{default:n},a=r(37573);class o extends a.Tool{start(){const{layer:e}=this.parent,t=this.parent.getPixelCalibratedPointerPosition();if(t){const[r,n,a]=e.getContext().getImageData(t.x,t.y,1,1).data,o=i.default.rgb([r,n,a]).hex();this.parent.onColorPick(o)}}move(){}end(){}}t.EyeDropper=o},14073:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Filler=void 0;var n=r(67229),i=r(37573);class a extends i.Tool{start(){const{color:e,filling:t,currentImageData:r}=this.parent,i=this.parent.getPixelCalibratedPointerPosition();if(t||!i)return;const[a,o,s,l]=e.array(),d=new n.ScanLineFill([a,o,s,l],i,r);this.parent.filling=!0,d.fill().then((e=>{this.parent.filling=!1,this.parent.setImageData(e),this.parent.save()}))}move(){}end(){}}t.Filler=a},68481:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NoopTool=void 0;var n=r(37573);class i extends n.Tool{start(){}move(){}end(){}}t.NoopTool=i},25712:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pen=void 0;var n,i=(n=r(20185))&&n.__esModule?n:{default:n},a=r(37573);function o(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class s extends a.Tool{constructor(){super(...arguments),o(this,"lastLine",null),o(this,"isPaint",!1)}makeLine(e){const{hexColor:t,penSize:r}=this.parent;return new i.default.Line({stroke:t,strokeWidth:r,lineJoin:"round",lineCap:"round",globalCompositeOperation:"source-over",points:[e.x,e.y]})}start(){this.isPaint=!0;const{stage:e,layer:t}=this.parent,r=e.getPointerPosition();r&&(this.lastLine=this.makeLine(r),t.add(this.lastLine))}move(){if(!this.isPaint)return;const{stage:e,layer:t}=this.parent,r=e.getPointerPosition();if(r&&this.lastLine){const e=this.lastLine.points().concat([r.x,r.y]);this.lastLine.points(e),t.batchDraw()}}end(){this.isPaint=!1,this.parent.save()}}t.Pen=s},37573:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Tool=void 0;t.Tool=class{constructor(e){this.parent=e}}},99928:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TransparentPen=void 0;var n,i=(n=r(20185))&&n.__esModule?n:{default:n},a=r(25712);class o extends a.Pen{makeLine(e){const{hexColor:t,penSize:r}=this.parent;return new i.default.Line({stroke:t,strokeWidth:r,lineJoin:"round",lineCap:"round",opacity:.5,globalCompositeOperation:"source-over",points:[e.x,e.y]})}}t.TransparentPen=o},44785:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initializeTools=void 0;var n=r(55854),i=r(25712),a=r(23419),o=r(44518),s=r(14073),l=r(99928);t.initializeTools=e=>new Map([[n.PaintingMode.Pen,new i.Pen(e)],[n.PaintingMode.TransparentPen,new l.TransparentPen(e)],[n.PaintingMode.Eraser,new a.Eraser(e)],[n.PaintingMode.Eyedropper,new o.EyeDropper(e)],[n.PaintingMode.Filler,new s.Filler(e)]])},67229:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScanLineFill=void 0;class r{constructor(e,t,r){this.img=r,this.targetRGBA=e,this.startRGBA=this.colorAt(t),this.stack=[t],this.maxX=this.img.width-1,this.maxY=this.img.height-1}async fill(){if(r.equalColor(this.targetRGBA,this.startRGBA))return this.img;for(;this.stack.length>0&&this.stack.length<1e4;){const e=this.stack.pop();if(!e)break;if(this.colorEquals(e,this.targetRGBA))continue;const t=this.scanLine(e);this.drawScanLine(t);const r=this.seekSeed(t);this.stack.push(...r)}return this.img}scanLine(e){let t=e.x,r=e.x;const{y:n}=e;for(;t>0&&this.colorEquals({x:t-1,y:n},this.startRGBA);t--);for(;r<this.maxX&&this.colorEquals({x:r+1,y:n},this.startRGBA);r++);return{west:{x:t,y:n},east:{x:r,y:n}}}seekSeed(e){const t=[],r=e.west.x,n=e.east.x,i=e.west.y;let a=!1,o=!1;for(let e=r;e<=n;e++)i>0&&this.colorEquals({x:e,y:i-1},this.startRGBA)?a||(a=!0,t.push({x:e,y:i-1})):a=!1,i<this.maxY&&this.colorEquals({x:e,y:i+1},this.startRGBA)?o||(o=!0,t.push({x:e,y:i+1})):o=!1;return t}drawScanLine(e){const{y:t}=e.west;for(let r=e.west.x;r<=e.east.x;r++)this.drawAt({x:r,y:t})}colorEquals(e,t){const n=this.colorAt(e);return r.equalColor(n,t)}colorAt(e){const t=this.vectorToIndex(e);return[this.img.data[t],this.img.data[t+1],this.img.data[t+2],this.img.data[t+3]]}drawAt(e){const t=this.vectorToIndex(e);this.img.data[t]=this.targetRGBA[0],this.img.data[t+1]=this.targetRGBA[1],this.img.data[t+2]=this.targetRGBA[2],this.img.data[t+3]=255}vectorToIndex(e){let{x:t,y:r}=e;return 4*(r*this.img.width+t)}static equalColor(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}}t.ScanLineFill=r},33477:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useControllersContextValue=void 0;var n=r(67294),i=r(4995);t.useControllersContextValue=()=>{const e=(0,n.useRef)(i.noopController);return{setController:(0,n.useCallback)((t=>{e.current=t}),[]),getController:(0,n.useCallback)((()=>e.current),[])}}},57940:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useDrawingCanvas=void 0;var n=r(67294),i=r(91445),a=r(4995);t.useDrawingCanvas=e=>{let{ref:t,hexColor:r,onColorPick:o,penSize:s,mode:l,onExportData:d,canvasSize:u}=e;const c=(0,n.useRef)(null);(0,n.useEffect)((()=>(null===c.current&&t.current&&(c.current=new i.DrawingCanvas(t.current)),()=>{null!==c.current&&c.current.cleanupStageEvent()})),[t]),(0,n.useEffect)((()=>{null!==c.current&&(c.current.hexColor=r)}),[r]),(0,n.useEffect)((()=>{null!==c.current&&(c.current.penSize=s)}),[s]),(0,n.useEffect)((()=>{null!==c.current&&c.current.setMode(l)}),[l]),(0,n.useEffect)((()=>{null!==c.current&&(c.current.onColorPick=o)}),[o]),(0,n.useEffect)((()=>{null!==c.current&&(c.current.canvasSize=a.CanvasSizes[u])}),[u]);const p=(0,n.useCallback)((()=>{null!==c.current&&c.current.redo()}),[]),f=(0,n.useCallback)((()=>{null!==c.current&&c.current.undo()}),[]),h=(0,n.useCallback)((()=>{null!==c.current&&c.current.clear()}),[]),m=(0,n.useCallback)((()=>{null!==c.current&&c.current.clearHistory()}),[]);return{redo:p,undo:f,clear:h,exportData:(0,n.useCallback)((()=>{null!==c.current&&d(c.current.exportData())}),[d]),clearHistory:m}}},61081:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.usePaintAppContext=void 0;var n=r(14890),i=r(67294),a=r(92951),o=r(4995),s=r(43452),l=r(33477),d=r(65400);t.usePaintAppContext=e=>{const t=(0,l.useControllersContextValue)(),[r]=(0,i.useState)((()=>({store:(0,n.createStore)(a.reducer,(0,d.composeEnhancers)((0,n.applyMiddleware)((0,s.paintAppMiddleware)(t.getController,e)))),storeState:o.INITIAL_STATE})));return{paintReduxContextValue:r,canvasControllersContextValue:t}}},97279:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.usePaintCanvas=void 0;var n=r(67294),i=r(20672),a=r(57940),o=r(41268);t.usePaintCanvas=()=>{const e=(0,i.useSelector)((e=>e.penColor)),t=(0,i.useSelector)((e=>e.paintingMode)),r=(0,i.useSelector)((e=>e.penSize)),s=(0,i.useSelector)((e=>e.canvasSize)),l=(0,n.useRef)(null),d=(0,i.useDispatch)();return{divRef:l,controllers:(0,a.useDrawingCanvas)({ref:l,hexColor:e,penSize:r,mode:t,canvasSize:s,onColorPick:e=>{d((0,o.setColor)({color:e}))},onExportData(e){d((0,o.upload)(e))}})}}},89172:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Paint",{enumerable:!0,get:function(){return n.Paint}});var n=r(76530)},43452:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.paintAppMiddleware=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=l(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(41268)),a=r(54433),o=(n=r(20996))&&n.__esModule?n:{default:n},s=r(4995);function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(l=function(e){return e?r:t})(e)}t.paintAppMiddleware=(e,t)=>(0,a.middleware)().case(i.redo,((t,r,n)=>{e().redo(),r(n)})).case(i.undo,((t,r,n)=>{e().undo(),r(n)})).case(i.clear,((t,r,n)=>{e().clear(),r(n)})).case(i.clearHistory,((t,r,n)=>{e().clearHistory(),r(n)})).case(i.exportData,((t,r,n)=>{e().exportData(),r(n)})).case(i.upload,((e,r,n)=>{e.getState().isUploading||(t(n.payload).then((()=>{e.dispatch(i.clear()),e.dispatch(i.clearHistory()),e.dispatch(i.hide()),e.dispatch(i.uploaded())})),r(n))})).case(i.requestChangeCanvasSize,((e,t,r)=>{s.CanvasSizes[e.getState().canvasSize].width<s.CanvasSizes[r.payload.size].width||confirm(o.default.text("admin.paint.resize_canvas.confirm"))?t(i.setCanvasSize(r.payload)):t(r)}))},92951:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reducer=void 0;var n=r(76983),i=r(4995),a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(41268));function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}const s=(0,n.reducerWithInitialState)(i.INITIAL_STATE).case(a.toggleColorPicker,(e=>({...e,isColorPickerHide:!e.isColorPickerHide}))).case(a.togglePaintWindow,(e=>({...e,isWindowHide:!e.isWindowHide}))).case(a.hide,(e=>({...e,isWindowHide:!0}))).case(a.setMode,((e,t)=>({...e,paintingMode:t.mode}))).case(a.setPenSize,((e,t)=>({...e,penSize:t.size}))).case(a.setColor,((e,t)=>({...e,penColor:t.color}))).case(a.setCanvasSize,((e,t)=>({...e,canvasSize:t.size}))).case(a.upload,(e=>({...e,isUploading:!0}))).case(a.uploaded,(e=>({...e,isUploading:!1}))).build();t.reducer=s},55854:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaintingMode=t.CanvasSizeEnum=void 0;let r=function(e){return e.Pen="PEN",e.TransparentPen="TRANSPARENT_PEN",e.Eraser="ERASER",e.Filler="FILLER",e.Eyedropper="EYEDROPPER",e}({});t.PaintingMode=r;let n=function(e){return e.Small="small",e.Medium="medium",e.Large="large",e}({});t.CanvasSizeEnum=n},7902:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pixiv=void 0;var n,i=r(10714),a=r(70879),o=r(57753),s=(n=r(65311))&&n.__esModule?n:{default:n},l=r(92477),d=r(96486);class u extends o.MyCuration{get type(){return"editor-pixiv"}get serviceName(){return"Pixiv"}get enableAutoPager(){return!0}constructor(e){super(e),this.page=1,this.$container=e.container;const t=this.$container.find(".editor-template");this.editorTemplate=(0,d.template)(t.html()),this.bindEvents()}loadItems(){return s.default.ajax({url:"/api/pixiv/my_works",data:{page:this.page}}).done((e=>{this.itemsReachedEnd=!(e.entries&&e.entries.length>0),this.page++})).fail((()=>{this.pleaseReAuthorize(),this.itemsReachedEnd=!0}))}pleaseReAuthorize(){this.$container.find(".disabled-box").show()}insertItems(e){const t=[];e.forEach((e=>{const r=e.attr("data-permalink");t.push(this.editorTemplate({item:{id:e.attr("data-id"),image_url:e.attr("data-image-url")}})),t.push(`[${r}:title]`)}));let r=t;(0,l.extractSyntax)(t).done((e=>{e&&(r=[e.html])})).fail((e=>{(0,a.BUG)(e)})).always((()=>{i.EditorConnector.insertLines({hatena:t,markdown:t,html:r})}))}}t.Pixiv=u},71142:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unselectProfileCardAt=t.setSelectedProfileCards=t.setFilterQuery=t.selectProfileCard=t.requestProfileCards=t.receiveProfileCards=void 0;t.requestProfileCards=()=>({type:"REQUEST_PROFILE_CARDS"});t.receiveProfileCards=e=>({type:"RECEIVE_PROFILE_CARDS",profileCards:e});t.setSelectedProfileCards=e=>({type:"SET_SELECTED_PROFILE_CARDS",uuids:e});t.selectProfileCard=e=>({type:"SELECT_PROFILE_CARD",uuid:e});t.unselectProfileCardAt=e=>({type:"UNSELECT_PROFILE_CARD_AT",index:e});t.setFilterQuery=e=>({type:"SET_FILTER_QUERY",query:e})},89011:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AllProfileCardsList=void 0;var n=l(r(67294)),i=l(r(20996)),a=r(98274),o=r(41514),s=r(81832);function l(e){return e&&e.__esModule?e:{default:e}}t.AllProfileCardsList=e=>{let{profileCards:t,onItemClick:r,onFilterQueryChange:l}=e;return n.default.createElement("div",{className:"all-profile-cards-container"},n.default.createElement("h3",null,i.default.text("edit_form.profile_card.all_profile_cards")),n.default.createElement(a.FilterQueryForm,{onFilterQueryChange:l}),n.default.createElement("div",{className:"all-profile-cards"},t instanceof Array?n.default.createElement("ul",{className:"all-profile-cards-list"},t.map(((e,t)=>n.default.createElement(o.ProfileCardCell,{key:`cell-${t}-${e.uuid}`,profileCard:e,onItemClick:()=>r(e.uuid)})))):n.default.createElement(s.ProfileCardsEmptyReasonExplanation,{reason:t})))}},64793:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Body=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n},a=r(96938),o=r(82748);t.Body=()=>i.default.createElement("div",{className:"editor-sidebar-profile_card__body"},i.default.createElement(o.SelectedProfileCardsListContainer,null),i.default.createElement(a.AllProfileCardsListContainer,null))},98274:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FilterQueryForm=void 0;var n=o(r(67294)),i=o(r(20996)),a=o(r(70881));function o(e){return e&&e.__esModule?e:{default:e}}t.FilterQueryForm=e=>{let{onFilterQueryChange:t}=e;return n.default.createElement(a.default,{placeholder:i.default.text("edit_form.profile_card.filter_placeholder"),onSubmit:e=>t(e)})}},94766:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Header=void 0;var n=a(r(67294)),i=a(r(20996));function a(e){return e&&e.__esModule?e:{default:e}}const o=r(91269);t.Header=()=>{const e=o.get("editor.canManageProfileCards");return n.default.createElement("div",{className:"editor-sidebar-profile_card__header"},n.default.createElement("h2",null,i.default.text("edit_form.profile_card")),n.default.createElement("p",null,i.default.text("edit_form.profile_card.description")),e?n.default.createElement("div",{className:"profile-cards-edit-link test-profile-cards-edit-link"},n.default.createElement("a",{href:"./profile_cards",target:"_blank",rel:"noopener"},i.default.text("edit_form.profile_card.config_link"))):n.default.createElement("p",{className:"profile-cards-edit-permission-required test-profile-cards-edit-permission-required"},i.default.text("edit_form.profile_card.edit_permission_required")))}},41514:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProfileCardCell=void 0;var n=a(r(67294)),i=a(r(20996));function a(e){return e&&e.__esModule?e:{default:e}}t.ProfileCardCell=e=>{let{profileCard:t,onItemClick:r}=e;return n.default.createElement("li",{className:"profile-card-list-item",onClick:r,"data-testid":"profile-card-list-item"},n.default.createElement("h4",null,t.title),n.default.createElement("p",null,t.body_preview),t.author&&n.default.createElement("p",null,i.default.text("admin.profile_cards.author")," ",t.author))}},81832:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProfileCardsEmptyReasonExplanation=void 0;var n=a(r(67294)),i=a(r(20996));function a(e){return e&&e.__esModule?e:{default:e}}t.ProfileCardsEmptyReasonExplanation=e=>{let{reason:t}=e;return"initial_fetch_not_finished"===t.emptyReason?n.default.createElement("p",{className:"all-profile-cards-list-no-profileCards"},i.default.text("loading")):"no_matched_profile_cards"===t.emptyReason?n.default.createElement("p",{className:"all-profile-cards-list-no-profileCards"},i.default.text("edit_form.profile_card.no_matched_profile_cards")):n.default.createElement("p",{className:"all-profile-cards-list-no-profileCards"},i.default.text("edit_form.profile_card.no_profile_cards"),n.default.createElement("a",{href:"./profile_cards",target:"_blank",rel:"noopener noreferrer"},i.default.text("edit_form.profile_card.config_link")))}},12934:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SelectedProfileCardCell=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n};t.SelectedProfileCardCell=e=>{let{profileCard:t,onItemUnselect:r}=e;return i.default.createElement("li",{className:"selected-profile-cards-items","data-testid":"selected-profile-cards-items"},i.default.createElement("h4",{className:"selected-profile-cards-items-title"},t.title),i.default.createElement("input",{type:"hidden",name:"profile_card",value:t.uuid}),i.default.createElement("button",{type:"button",onClick:r,className:"selected-profile-cards-items-button","data-testid":"selected-profile-cards-items-button"},i.default.createElement("i",{className:"blogicon-close"})))}},85013:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SelectedProfileCardsList=void 0;var n=o(r(67294)),i=o(r(20996)),a=r(12934);function o(e){return e&&e.__esModule?e:{default:e}}t.SelectedProfileCardsList=e=>{let{selectedProfileCards:t,onItemUnselect:r}=e;return n.default.createElement("div",{className:"selected-profile-cards-container"},n.default.createElement("h3",null,i.default.text("edit_form.profile_card.selected")," (",t.length,")"),n.default.createElement("div",{className:"selected-profile-cards"},n.default.createElement("input",{type:"hidden",name:"should_update_profile_cards",value:"1","data-testid":"selected-profile-cards-input"}),t.length>0?n.default.createElement("ul",{className:"selected-profile-cards-list"},t.map(((e,t)=>n.default.createElement(a.SelectedProfileCardCell,{key:`selected-list-${t}-${e.uuid}`,profileCard:e,onItemUnselect:()=>r(t)})))):n.default.createElement("div",null,n.default.createElement("div",{className:"selected-profile-cards-selectarea"},i.default.text("edit_form.profile_card.no_selected_cards")))))}},96938:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AllProfileCardsListContainer=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n},a=r(96841),o=r(89011),s=r(71142);const l=e=>{if(!e.isInitialFetchFinished)return{profileCards:{emptyReason:"initial_fetch_not_finished"}};const t=Object.keys(e.profileCards).map((t=>e.profileCards[t]));if(0===t.length)return{profileCards:{emptyReason:"no_profile_cards"}};if(""===e.filterQuery)return{profileCards:t};const r=t.filter((t=>((e,t)=>t.title.includes(e)||t.body.includes(e))(e.filterQuery,t)));return 0===r.length?{profileCards:{emptyReason:"no_matched_profile_cards"}}:{profileCards:r}};t.AllProfileCardsListContainer=()=>{const e=(0,a.useDispatch)(),{profileCards:t}=(0,a.useSelector)(l);return i.default.createElement(o.AllProfileCardsList,{profileCards:t,onFilterQueryChange:t=>{e((0,s.setFilterQuery)(t))},onItemClick:t=>{e((0,s.selectProfileCard)(t))}})}},67436:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n},a=r(64793),o=r(94766),s=r(67756);var l=()=>((0,s.useApp)(),i.default.createElement("div",{className:"editor-sidebar-profile_card"},i.default.createElement(o.Header,null),i.default.createElement(a.Body,null)));t.default=l},82748:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SelectedProfileCardsListContainer=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n},a=r(96841),o=r(85013),s=r(71142);t.SelectedProfileCardsListContainer=()=>{const{selectedProfileCards:e}=(0,a.useSelector)((e=>({selectedProfileCards:e.isInitialFetchFinished?e.selectedProfileCardUuids.map((t=>e.profileCards[t])):[]}))),t=(0,a.useDispatch)();return i.default.createElement(o.SelectedProfileCardsList,{selectedProfileCards:e,onItemUnselect:e=>{t((0,s.unselectProfileCardAt)(e))}})}},67756:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useApp=void 0;var n=r(15849),i=r(34498);const a=r(91269);t.useApp=()=>{const[{loading:e,error:t,data:r}]=(0,n.useFetchProfileCard)();(0,i.useAppEffects)({loading:e,error:t,data:r,attachedProfileCardUUIDs:a.get("editor.attachedProfileCards")||[]})}},34498:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useAppEffects=void 0;var n=r(96841),i=r(67294),a=r(71142);t.useAppEffects=e=>{let{loading:t,error:r,data:o,attachedProfileCardUUIDs:s}=e;const l=(0,n.useDispatch)();(0,i.useEffect)((()=>{l((0,a.requestProfileCards)())}),[l]),(0,i.useEffect)((()=>{l((0,a.setSelectedProfileCards)(s))}),[l,s]),(0,i.useEffect)((()=>{if(!t&&!r){if(!o)throw new TypeError("'data' doesn't exist");l((0,a.receiveProfileCards)(o.entries))}}),[t,r,o,l])}},15849:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useFetchProfileCard=void 0;var n=r(91289),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=a(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,r&&r.set(e,n);return n}(r(55992));function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(a=function(e){return e?r:t})(e)}t.useFetchProfileCard=()=>(0,n.useXHR)({url:i.protocolRelativeAdminUserBlogUrl("/profile_cards.json"),responseType:"json"})},42585:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=u(r(67294)),i=r(73380),a=r(96841),o=r(14890),s=u(r(67436)),l=u(r(60143)),d=r(65400);function u(e){return e&&e.__esModule?e:{default:e}}var c={init:e=>{const t=(0,o.createStore)(l.default,(0,d.composeEnhancers)());(0,i.safeRender)(n.default.createElement(a.Provider,{store:t},n.default.createElement(s.default,null)),e)}};t.default=c},83255:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return"SET_FILTER_QUERY"===t.type?t.query:e}},60143:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(14890),i=d(r(83255)),a=d(r(71623)),o=d(r(41817)),s=d(r(55162)),l=d(r(92061));function d(e){return e&&e.__esModule?e:{default:e}}var u=(0,n.combineReducers)({filterQuery:i.default,isFetching:a.default,isInitialFetchFinished:o.default,profileCards:s.default,selectedProfileCardUuids:l.default});t.default=u},71623:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];switch((arguments.length>1?arguments[1]:void 0).type){case"REQUEST_PROFILE_CARDS":return!0;case"RECEIVE_PROFILE_CARDS":return!1;default:return e}}},41817:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return"RECEIVE_PROFILE_CARDS"===(arguments.length>1?arguments[1]:void 0).type||e}},55162:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return"RECEIVE_PROFILE_CARDS"===t.type?t.profileCards.reduce(((e,t)=>(e[t.uuid]=t,e)),{}):e}},92061:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_SELECTED_PROFILE_CARDS":return t.uuids;case"SELECT_PROFILE_CARD":return[...e,t.uuid];case"UNSELECT_PROFILE_CARD_AT":const r=[...e];return r.splice(t.index,1),r;default:return e}}},77667:e=>{"use strict";e.exports={actions:{SET_EDITOR:"PROMOTION:SET_EDITOR",LOAD_ENTRIES:"ENTRIES:LOAD_ENTRIES_ENTRY",SHUFFLE_ENTRIES:"ENTRIES:SHUFFLE_ENTRIES",SHOW_ENTRY:"ENTRIES:SHOW_ENTRY",CLOSE_ENTRY:"ENTRIES:CLOSE_ENTRY",FILL_KEYWORD:"ENTRIES:FILL_KEYWORD",FILLIN:"ENTRIES:FILLIN",LOAD_ODAIS:"ODAI:LOAD_ODAIS",SELECT_ODAI:"ODAI:SELECT_ODAI",TURN_SLOT:"ODAI:TURN_SLOT",TOGGLE_KILLED:"ODAI:TOGGLE_KILLED",TOGGLE_ACTIVE:"ODAI:TOGGLE_ACTIVE",SHOW_WINDOW:"PROMOTION:SHOW_WINDOW",HIDE_WINDOW:"PROMOTION:HIDE_WINDOW",SET_PAGE:"PROMOTION:SET_PAGE"},pageIds:{ENTRIES_PAGE:"ENTRIES_PAGE",ODAI_SLOT_PAGE:"ODAI_SLOT_PAGE"}}},14674:(e,t,r)=>{"use strict";var n=r(10714);const i=r(65311),a=r(77667).actions,o=r(73287),s=r(91269),l=r(79065);class d extends o.Actions{init(){const e=s.get("editor.promotion.entries").map((e=>l(e)));this.emit(a.LOAD_ENTRIES,e)}setEditor(e){this.emit(a.SET_EDITOR,e)}shuffleEntries(e){this.emit(a.SHUFFLE_ENTRIES,e)}isShownEntry(e){return!localStorage[`Hatena.Diary.Promotion.Entry.closed.${e}`]}showEntry(e){try{localStorage[`Hatena.Diary.Promotion.Entry.read.${e}`]=!0}catch(e){}this.emit(a.SHOW_ENTRY,e)}closeEntry(e){try{localStorage[`Hatena.Diary.Promotion.Entry.closed.${e}`]=!0}catch(e){}this.emit(a.CLOSE_ENTRY,e),i(".tipsy > *").remove(),setTimeout((()=>n.EditorConnector.emit("resizeRequired")),0)}fillKeyword(e){const t=[e];n.EditorConnector.insertLines({html:t,hatena:t,markdown:t})}fillin(e){i.ajax({url:`/api/fill_ins/${e}`,type:"GET"}).then((e=>{n.EditorConnector.insertLines(e)}))}}e.exports=new d},26567:(e,t,r)=>{"use strict";const n=r(77667).actions,i=r(73287);class a extends i.Actions{setEditor(e){this.emit(n.SET_EDITOR,e)}showWindow(){this.emit(n.SHOW_WINDOW)}hideWindow(){this.emit(n.HIDE_WINDOW)}setPage(e){this.emit(n.SET_PAGE,e)}}e.exports=new a},40746:(e,t,r)=>{"use strict";var n=o(r(20996)),i=o(r(57942)),a=r(10714);function o(e){return e&&e.__esModule?e:{default:e}}const s=r(65311),l=r(77667).actions,d=r(73287);class u extends d.Actions{init(){this.emit(l.TOGGLE_KILLED,(()=>{try{return!!localStorage["Hatena.Diary.Promotion.OdaiSlot.isKilled"]||!1}catch(e){}return!1})()),this.emit(l.TOGGLE_ACTIVE,(()=>{try{if("false"===localStorage["Hatena.Diary.Promotion.OdaiSlot.isActive"])return!1}catch(e){}return!0})())}setEditor(e){this.emit(l.SET_EDITOR,e)}loadOdais(){s.get("/api/odais?type=official").then((e=>{this.emit(l.LOAD_ODAIS,e.odais)})).fail((e=>{throw e}))}selectOdai(e){const t=n.default.text("admin.odai.fillin",e.title),r=[`[http:${(0,i.default)("admin-domain")}/-/odai/${e.uuid}:title=${t}]`];a.EditorConnector.insertLines({html:r,hatena:r,markdown:r})}turnSlot(){this.emit(l.TURN_SLOT)}killOdaiSlot(){s(".tipsy > *").remove();try{localStorage["Hatena.Diary.Promotion.OdaiSlot.isKilled"]=!0}catch(e){}this.emit(l.TOGGLE_KILLED,!0)}setInactive(){try{localStorage["Hatena.Diary.Promotion.OdaiSlot.isActive"]=!1}catch(e){}this.emit(l.TOGGLE_ACTIVE,!1)}}e.exports=new u},45326:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EntriesPage=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=a(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,r&&r.set(e,n);return n}(r(67294)),i=r(24846);function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(a=function(e){return e?r:t})(e)}const o=r(14674);class s extends n.Component{render(){return n.createElement("div",{className:`promotion-entries ${this.props.device}`},n.createElement("div",{className:`promotion-entries-wrapper ${this.props.device}`},this.renderEntries()),n.createElement("div",{className:`promotion-entries-pagers center ${this.props.device}`},n.createElement("div",{className:"btn-group"},this.renderPagers())))}renderEntries(){return this.props.entryIds.map((e=>n.createElement(i.PromotionContent,{entry:this.props.entities[e],key:e,device:this.props.device,isSelected:this.isEntrySelected(e)})))}renderPagers(){const{entities:e,entryIds:t}=this.props;if(!(t.length<2))return t.map(((t,r)=>{const i=e[t];let a="promotion-entries-pager btn";return a+=this.isEntrySelected(t)?" selected":"",n.createElement("span",{className:a,"data-testid":"promotion-entries","data-target-promotion-index":r,tabIndex:0,key:i.id,onClick:()=>this.showEntry(i.id)},r+1)}))}isEntrySelected(e){return!(!this.props.currentEntryId||e!==this.props.currentEntryId)}showEntry(e){o.showEntry(e)}}t.EntriesPage=s},27180:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EntryButton=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),a=(n=r(20996))&&n.__esModule?n:{default:n};function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}const s=r(26567),l=r(14674),d=r(77667).pageIds;class u extends i.Component{showEntry(){l.showEntry(this.props.entry.id),s.setPage(d.ENTRIES_PAGE),s.showWindow()}closeEntry(e){l.closeEntry(this.props.entry.id),e.stopPropagation()}render(){if(this.props.entry.isClosed)return i.createElement("span",null);let e="promotion-button";return this.props.entry.isRead||(e+=" is-active"),i.createElement("span",{tabIndex:-1,className:e,"data-testid":"promotion-button","data-track-name":`editor-toolbar-button-promotion-${this.props.trackingId}`,onClick:()=>this.showEntry()},i.createElement("span",{className:"promotion-label badge badge-new-secondary"},"NEW"),i.createElement("span",{className:"promotion-entry-title"},this.props.entry.title),i.createElement("i",{className:"blogicon-close promotion-cancel-button tipsy-top","data-testid":"promotion-cancel-button",title:a.default.text("close"),onClick:e=>this.closeEntry(e)}))}}t.EntryButton=u},86763:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OdaiSlotButton=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),a=(n=r(20996))&&n.__esModule?n:{default:n};function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}const s=r(26567),l=r(40746),d=r(77667).pageIds;class u extends i.Component{showOdaiSlot(){s.setPage(d.ODAI_SLOT_PAGE),s.showWindow(),l.turnSlot(),l.setInactive()}killOdaiSlot(e){l.killOdaiSlot(),e.stopPropagation()}render(){if(this.props.isKilled)return i.createElement("span",null);let e="odaislot-button";return this.props.isActive&&(e+=" is-active"),i.createElement("span",{tabIndex:-1,className:e,"data-testid":"odaislot-button","data-track-name":"editor-toolbar-button-odaislot",onClick:()=>this.showOdaiSlot()},i.createElement("span",{className:"odaislot-label"},"<NEW>"),i.createElement("span",{className:"odaislot-title"},a.default.text("admin.odai.odai_slot")),i.createElement("i",{className:"blogicon-close odaislot-cancel-button tipsy-top","data-testid":"odaislot-cancel-button",title:a.default.text("close"),onClick:e=>this.killOdaiSlot(e)}))}}t.OdaiSlotButton=u},62142:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OdaiSlotPage=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),a=(n=r(20996))&&n.__esModule?n:{default:n};function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}const s=r(54102),l=r(40746),d=r(26567),u=(()=>{if(!document.body)return"";const e=document.createElement("div");return e.style.top="-9999px",e.style.zIndex="-9999",document.addEventListener("DOMContentLoaded",(()=>{document.body.appendChild(e)})),(t,r,n)=>{e.className=t,e.innerHTML="a";const i=e.offsetHeight*n;e.innerHTML=r;let a=0;for(;e.offsetHeight>i;)a++,e.innerHTML=`${r.slice(0,-a)}`;return 0===a?r:`${r.slice(0,-a)}`}})();class c extends i.Component{constructor(e){super(e)}turnSlot(){l.turnSlot()}selectOdai(){const e=this.props.entities[this.props.randomOdaiId];e&&(l.selectOdai(e),d.hideWindow())}renderOdaiSlot(){const e=this.props.entities[this.props.randomOdaiId];if(!e)return;const t=a.default.text("admin.odai.slot_description_head"),r=a.default.text("admin.odai.slot_description_foot"),n=[a.default.text("admin.odai.slot_description_1"),a.default.text("admin.odai.slot_description_2")],o=this.props.device,l=""===u?"":u(`promotion-odaislot-randomodai-title-inner ${o}`,e.title,2);return i.createElement("div",null,i.createElement("div",{className:"promotion-odaislot-header"},i.createElement("span",null,i.createElement("i",{className:"blogicon-odaislot lg"}),a.default.text("admin.odai.odai_slot"))),i.createElement("div",{className:`promotion-odaislot-tagline ${o}`},i.createElement(s,{body:t})),i.createElement("div",{className:`promotion-odaislot-description ${o}`},i.createElement("ul",null,n.map(((e,t)=>i.createElement("li",{key:t},i.createElement(s,{body:e})))))),i.createElement("div",{className:`promotion-odaislot-randomodai ${o}`},i.createElement("span",{className:`promotion-odaislot-randomodai-title ${o}`},i.createElement("span",{className:`promotion-odaislot-randomodai-title-inner ${o}`},l)),i.createElement("div",{className:`promotion-odaislot-randomodai-slotbutton ${o}`,onClick:()=>this.turnSlot(),"data-testid":"promotion-odaislot-randomodai-slotbutton"},i.createElement("i",{className:"blogicon-repeat tipsy-top",title:a.default.text("admin.odai.turn")}))),i.createElement("div",{className:"promotion-odaislot-insertbutton-wrapper"},i.createElement("button",{type:"button",className:"promotion-odaislot-insertbutton","data-testid":"promotion-odaislot-insertbutton",onClick:()=>this.selectOdai()},a.default.text("admin.odai.insert"))),i.createElement("div",{className:"promotion-odaislot-footer"},i.createElement("p",null,r)))}render(){return i.createElement("div",{className:`promotion-odaislot ${this.props.device}`},this.renderOdaiSlot())}}t.OdaiSlotPage=c},18040:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PageSwitcher=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=l(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),a=(n=r(20996))&&n.__esModule?n:{default:n},o=r(45326),s=r(62142);function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(l=function(e){return e?r:t})(e)}const d=r(26567),u=r(14674),c=r(77667).pageIds;class p extends i.Component{openOdaiSlotPage(e){e.preventDefault(),d.setPage(c.ODAI_SLOT_PAGE)}openEntriesPage(e){e.preventDefault();const t=this.props.entries.entryIds[0];u.showEntry(t),d.setPage(c.ENTRIES_PAGE)}renderPage(){const{entries:e,odai:t,device:r,currentPage:n}=this.props;return n===c.ENTRIES_PAGE?i.createElement(o.EntriesPage,{device:r,entities:e.entities,entryIds:e.entryIds,currentEntryId:e.currentEntryId}):n===c.ODAI_SLOT_PAGE?i.createElement(s.OdaiSlotPage,{device:r,entities:t.entities,randomOdaiId:t.randomOdaiId}):void 0}renderSwitch(){return this.props.currentPage===c.ENTRIES_PAGE?this.renderOdaiSlotSwitch():this.props.currentPage===c.ODAI_SLOT_PAGE?this.renderEntriesSwitch():void 0}renderOdaiSlotSwitch(){return 0===this.props.odai.odaiIds.length?null:i.createElement("div",{className:"promotion-pages-switch"},i.createElement("div",{className:`promotion-pages-switch-link ${this.props.device}`},i.createElement("a",{href:"#",onClick:e=>this.openOdaiSlotPage(e),"data-testid":"promotion-odai-switch-link"},a.default.text("admin.odai.open_slot")," >")))}renderEntriesSwitch(){return 0===this.props.entries.entryIds.length?null:i.createElement("div",{className:"promotion-pages-switch"},i.createElement("div",{className:`promotion-pages-switch-link ${this.props.device}`},i.createElement("a",{href:"#",onClick:e=>this.openEntriesPage(e),"data-testid":"promotion-entry-switch-link"},"< ",a.default.text("admin.odai.leave_slot"))))}render(){return i.createElement("div",{className:`promotion-pages ${this.props.device}`},this.renderPage(),this.renderSwitch())}}t.PageSwitcher=p},48353:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PromotionBar=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=l(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),a=r(27180),o=r(86763),s=(n=r(20996))&&n.__esModule?n:{default:n};function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(l=function(e){return e?r:t})(e)}function d(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const u=r(26567),c=r(14674),p=r(77667).pageIds;class f extends i.Component{constructor(){super(...arguments),d(this,"odaiSlotBar",null)}renderEntryButton(e,t){const r=this.props.entries.entities[e];if(!r)return;const n=0===t?"first":"second";return i.createElement(a.EntryButton,{entry:r,trackingId:n,ref:e=>{this[n]=e},key:r.id})}showMoreEntry(){c.showEntry(this.props.entries.entryIds[0]),u.setPage(p.ENTRIES_PAGE),u.showWindow()}render(){const{odai:e,entries:t}=this.props,r="promotion-bar-view-odai"+(t.activeEntryIds.some((e=>c.isShownEntry(e)))?"":"--hidden");return i.createElement("div",{className:"promotion-bar"},i.createElement("div",{className:"promotion-bar-items"},i.createElement("span",null,t.activeEntryIds.map(((e,t)=>this.renderEntryButton(e,t)))),i.createElement("span",{className:"odaislot-bar--hidden",ref:e=>{this.odaiSlotBar=e},"data-testid":"odaislot-bar"},i.createElement(o.OdaiSlotButton,{isActive:e.isActive,isKilled:e.isKilled}))),i.createElement("div",{className:r},i.createElement("a",{href:"/-/odai/list?utm_source=edit&utm_medium=referral&utm_campaign=myodai_test",target:"_blank",rel:"noopener",className:"promotion-view-odaiButton"},s.default.text("admin.myodai.list_page.title"))))}}t.PromotionBar=f},24846:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PromotionContent=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=i(t);if(r&&r.has(e))return r.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=a?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,r&&r.set(e,n);return n}(r(67294));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(i=function(e){return e?r:t})(e)}const a=r(26567),o=r(14674);class s extends n.Component{render(){let e="promotion-entry";e+=this.props.isSelected?" selected":"",e+=` ${this.props.device}`;return n.createElement("div",{className:e,"data-testid":"promotion-entry",onClick:e=>this.onClick(e)},n.createElement("div",{dangerouslySetInnerHTML:(()=>({__html:this.props.entry.body}))()}))}onClick(e){const t=e.target,r=t.getAttribute("data-keyword"),n=t.getAttribute("data-fillin-id");(r||n)&&(r&&(o.fillKeyword(r),a.hideWindow()),n&&(o.fillin(n),a.hideWindow()),e.preventDefault(),e.stopPropagation())}}t.PromotionContent=s},81761:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PromotionModal=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=u(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),a=r(99240),o=r(18040),s=r(61663),l=(n=r(20996))&&n.__esModule?n:{default:n},d=r(55992);function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(u=function(e){return e?r:t})(e)}const c=r(26567);t.PromotionModal=e=>{let{currentPage:t,entries:r,isWindowVisible:n,odai:o}=e;const s=(0,i.useCallback)((()=>{c.hideWindow()}),[]);return i.default.createElement(a.CSSTransition,{classNames:"fade",timeout:300,appear:!0,in:n,mountOnEnter:!0,unmountOnExit:!0},i.default.createElement(p,null,i.default.createElement(f,{closeHandler:s,currentPage:t,entries:r,odai:o})))};const p=e=>{let{children:t}=e;return i.default.createElement("div",{className:"promotion-wrapper"},i.default.createElement("div",{className:"promotion-background","data-testid":"promotion-background"}),t)},f=e=>{let{closeHandler:t,odai:r,currentPage:n,entries:a}=e;const u=(0,i.useRef)(null);return(0,s.useOnClickOutside)(u,t),i.default.createElement("div",{className:"promotion-window",ref:u,"data-testid":"promotion-window"},i.default.createElement("button",{className:"promotion-window-close","aria-label":l.default.text("close"),onClick:t,type:"button"},i.default.createElement("img",{src:(0,d.staticUrl)("/images/admin/close.svg"),alt:l.default.text("close")})),i.default.createElement(o.PageSwitcher,{entries:a,odai:r,device:"PC",currentPage:n}))}},97814:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PromotionPC=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),i=r(48353),a=r(81761);function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}function s(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class l extends n.Component{constructor(e){super(e),s(this,"updateState",(()=>{this.setState(this.props.store.getState())})),this.state=e.store.getState()}componentDidMount(){this.props.store.on("change",this.updateState)}componentWillUnmount(){this.props.store.removeListener("change",this.updateState)}render(){return n.createElement("div",null,n.createElement(i.PromotionBar,{odai:this.state.odai,entries:this.state.entries}),n.createElement(a.PromotionModal,{odai:this.state.odai,entries:this.state.entries,isWindowVisible:this.state.modal.isWindowVisible,currentPage:this.state.modal.currentPage}))}}t.PromotionPC=l},58972:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PromotionTouch=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=a(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,r&&r.set(e,n);return n}(r(67294)),i=r(18040);function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(a=function(e){return e?r:t})(e)}function o(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class s extends n.Component{constructor(e){super(e),o(this,"updateState",(()=>{this.setState(this.props.store.getState())})),this.state=e.store.getState()}componentDidMount(){this.props.store.on("change",this.updateState)}componentWillUnmount(){this.props.store.removeListener("change",this.updateState)}render(){return n.createElement(i.PageSwitcher,{entries:this.state.entries,odai:this.state.odai,device:"Touch",currentPage:this.state.modal.currentPage})}}t.PromotionTouch=s},79065:e=>{"use strict";const t=e=>{try{return!!localStorage[`Hatena.Diary.Promotion.Entry.read.${e}`]}catch(e){}return!1},r=e=>{try{return!!localStorage[`Hatena.Diary.Promotion.Entry.closed.${e}`]}catch(e){}return!1};e.exports=e=>({...e,isRead:t(e.id),isClosed:r(e.id)})},35961:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n},a=r(73380),o=r(97814);const s=r(91269),l=r(73287).Store,d=r(14674),u=r(40746),c=r(50525),p=e=>{if(!e)return;if(!s.get("editor.promotion.enabled"))return;const t=new l(c);(0,a.safeRender)(i.default.createElement(o.PromotionPC,{store:t}),e),d.init(),u.init(),u.loadOdais()};t.init=p},95932:(e,t,r)=>{"use strict";const n=r(66419),i=r(77289),a=r(35340),o=r(77667).actions,s={entities:{},entryIds:[],activeEntryIds:[],currentEntryId:null};function l(e){const t=e.entryIds.map((t=>e.entities[t])),r=t.filter((e=>!e.isRead&&!e.isClosed)),i=t.filter((e=>e.isRead&&!e.isClosed));return n.first(r.concat(n.shuffle(i)),4).map((e=>e.id))}function d(e){return{...e,activeEntryIds:l(e)}}e.exports=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case o.LOAD_ENTRIES:return function(e,t){return d({...e,entities:i(t,"id"),entryIds:t.map((e=>e.id))})}(e,t.payload);case o.SHUFFLE_ENTRIES:return d(e);case o.SHOW_ENTRY:return function(e,t){if(!e.entities[t])return e;const r=a(e);return r.entities[t].isRead=!0,r.currentEntryId=t,r}(e,t.payload);case o.CLOSE_ENTRY:return function(e,t){if(!e.entities[t])return e;const r=a(e);return r.entities[t].isClosed=!0,r}(e,t.payload);default:return e}}},50525:(e,t,r)=>{"use strict";var n=s(r(76490)),i=s(r(95932)),a=s(r(76128)),o=s(r(76985));function s(e){return e&&e.__esModule?e:{default:e}}e.exports=(0,n.default)({entries:i.default,odai:a.default,modal:o.default})},76985:(e,t,r)=>{"use strict";const n=r(77667).actions,i={isWindowVisible:!1,currentPage:r(77667).pageIds.ENTRIES_PAGE};e.exports=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case n.SHOW_WINDOW:return function(e){return{...e,isWindowVisible:!0}}(e);case n.HIDE_WINDOW:return function(e){return{...e,isWindowVisible:!1}}(e);case n.SET_PAGE:return function(e,t){return{...e,currentPage:t}}(e,t.payload);default:return e}}},76128:(e,t,r)=>{"use strict";const n=r(66419),i=r(77667).actions,a=r(77289),o={entities:{},odaiIds:[],randomOdaiId:null,slotCount:0,isKilled:!0,isActive:!1};function s(e){return e.slotCount===e.odaiIds.length?{...e,odaiIds:n.shuffle(e.odaiIds),slotCount:0}:{...e,randomOdaiId:e.odaiIds[e.slotCount],slotCount:e.slotCount+1}}e.exports=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case i.LOAD_ODAIS:return function(e,t){return s({...e,entities:a(t,"uuid"),odaiIds:n.shuffle(t.map((e=>e.uuid)))})}(e,t.payload);case i.TURN_SLOT:return s(e);case i.TOGGLE_KILLED:return function(e,t){return{...e,isKilled:t}}(e,t.payload);case i.TOGGLE_ACTIVE:return function(e,t){return{...e,isActive:t}}(e,t.payload);default:return e}}},72461:(e,t,r)=>{"use strict";var n,i=r(41960),a=r(70879),o=r(10714),s=r(92477),l=(n=r(57942))&&n.__esModule?n:{default:n},d=r(64292),u=r(57753);const c=r(65311),p=r(66419),f=p.template('<blockquote cite="<%- url %>" data-uuid="<%- uuid %>"><p><%- body %></p><cite><a href="<%- url %>"><%- title %></a></cite></blockquote>');class h extends u.MyCuration{get type(){return"editor-quote"}get serviceName(){return"Quote"}get enableAutoPager(){return!0}get pasteReverseOrder(){return!0}constructor(e){super(e),this.$indicator=e.container.find(".indicator"),this.bindEvents()}bindEvents(){super.bindEvents(),this.$submit=this.$container.find(".quote-keyword-submit"),this.$keyword=this.$container.find(".quote-keyword"),this.$submit.on("click",(()=>(this.initLoadCondition(),this.requestReload(),!1))),this.$keyword.on("keydown",(e=>{if("RET"===(0,i.keyString)(e))return this.initLoadCondition(),this.requestReload(),!1})),this.$itemsContainer.on("click",".js-button-quote-delete",(e=>{const t=c(e.target).attr("data-uuid");c.ajax({url:"/api/quotes/delete",cache:!1,type:"post",dataType:"json",data:{uuid:t,rkm:(0,l.default)("rkm"),rkc:(0,l.default)("rkc")}}).done((()=>{c(`.item[data-uuid="${t}"]`).remove()}))}))}initLoadCondition(){this.itemsReachedEnd=!1,this.untilEpoch=null}willRequestLoadItems(){return!0}loadItems(){return c.ajax({url:"/api/quotes",type:"GET",dataType:"json"}).then((e=>e.entries.length>0?(this.itemsReachedEnd=!0,c.Deferred().resolve(e)):c.Deferred().reject()))}renderItem(e){return e.datetimeEpoch=Date.parse(e.datetime),this.template({entry:e,trim:d.trimString})}insertItems(e){const t={hatena:[],markdown:[]};p.each(e,(e=>{const r=e.attr("data-title")||"";let n=e.attr("data-blog")||"";""!==n&&(n=` - ${n}`);const i=f({uuid:e.attr("data-uuid")||"",url:e.attr("data-url"),body:e.attr("data-body"),title:r+n});t.hatena.push(`>${i}<`),t.markdown.push(i)})),(0,s.extractSyntax)(t.hatena).done((e=>{t.html=["",e.html,""]})).fail((e=>{t.html=t.hatena,(0,a.BUG)(e)})).always((()=>{(o.EditorConnector.isiOS()||o.EditorConnector.isAndroid())&&(t.html=t.hatena),o.EditorConnector.insertLines(t)}))}fillInFirstItem(){if("#auto_fillin"!==location.hash)return;const e=this.$container.find(".item").first();e.length>0&&this.insertItems([e])}fillInReQuote(){try{const e=localStorage.getItem("ReQuote");if(void 0===e)return;const t=JSON.parse(e),r=c("<div>").attr({"data-url":t.url,"data-title":t.title,"data-body":t.body,"data-blog":""});this.insertItems([r]),localStorage.removeItem("ReQuote")}catch(e){}}loadItemsFinishedHandler(){this.fillInReQuote(),this.fillInFirstItem()}}e.exports=h},11500:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KNOWN_ERRORS=t.ERROR_MSGID=void 0;t.KNOWN_ERRORS={400:!0,429:!0};t.ERROR_MSGID={429:"edit_form.rakuten.api_limit_exceeded"}},66316:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RakutenViewModel=void 0;var n=r(17187),i=r(66419),a=r(10714),o=r(12495);class s extends n.EventEmitter{constructor(){super(),this.state={items:[],selectedItemCodes:{},keyword:null,page:1,error:null,isLoading:!1}}setState(e){this.state={...this.state,...e},this.emit("change")}getState(){return{...this.state}}searchItems(e){if(!e.match(/^\s*$/))return this.setState({keyword:e,isLoading:!0}),(0,o.fetchAPI)({keyword:e}).then((e=>this.setState({items:e,page:1,error:null}))).catch((e=>this.setState({error:e}))).then((()=>this.setState({isLoading:!1})))}loadNextItems(){if(this.state.error)return Promise.resolve();this.setState({isLoading:!0});const e=this.state.keyword,t=this.state.page+1;return(0,o.fetchAPI)({keyword:e,page:t}).then((e=>this.setState({items:this.state.items.concat(e),page:t}))).catch((e=>this.setState({error:e}))).then((()=>this.setState({isLoading:!1})))}toggleItemSelection(e){this.setState({selectedItemCodes:{...this.state.selectedItemCodes,[e.itemCode]:!this.state.selectedItemCodes[e.itemCode]}})}insertSelectedItems(){const e={};for(const t of this.state.items)e[t.itemCode]=t;const t=Object.keys(this.state.selectedItemCodes).filter((e=>this.state.selectedItemCodes[e])).map((e=>`[rakuten:${e}:detail]`));a.EditorConnector.insertLines({html:t,hatena:t,markdown:t}),this.setState({selectedItemCodes:{}})}insertItem(e){const t=[`[rakuten:${e.itemCode}:detail]`];a.EditorConnector.insertLines({html:t,hatena:t,markdown:t}),this.isItemSelected(e)&&this.toggleItemSelection(e)}isItemSelected(e){return!!this.state.selectedItemCodes[e.itemCode]}hasSelectedItems(){return 0!==(0,i.values)(this.state.selectedItemCodes).filter((e=>e)).length}}t.RakutenViewModel=s},77018:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorMessage=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),a=(n=r(20996))&&n.__esModule?n:{default:n},o=r(11500);function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}class l extends i.Component{render(){if(!this.props.error)return null;const e=o.ERROR_MSGID[this.props.error];return e?i.createElement("div",{className:"editor-rakuten-error","data-testid":"editor-rakuten-error"},a.default.text(e)):null}}t.ErrorMessage=l},73544:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Footer=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),a=(n=r(9825))&&n.__esModule?n:{default:n};function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}class s extends i.Component{render(){const e=!this.props.hasSelectedItems;return i.createElement("div",{className:"editor-rakuten-footer"},i.createElement(a.default,{disabled:e,onClick:this.props.onSubmit}))}}t.Footer=s},34184:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Item=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),a=r(64292),o=(n=r(20996))&&n.__esModule?n:{default:n};function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}t.Item=e=>{let{item:t,isSelected:r,onSelect:n,onDoubleClick:s}=e;return i.createElement("div",{className:"editor-rakuten-item item "+(r?"selected":""),"data-testid":"editor-rakuten-item",onClick:n,onDoubleClick:s},i.createElement("div",{className:"editor-rakuten-item__inner"},i.createElement(l,{item:t}),i.createElement("div",{className:"editor-rakuten-item__right"},i.createElement("span",{className:"editor-rakuten-item__name"},(0,a.trimString)(t.itemName,60)),i.createElement("span",{className:"editor-rakuten-item__price"},o.default.text("edit_form.rakuten.price",t.itemPrice)),i.createElement("span",{className:"editor-rakuten-item__shop-name"},t.shopName))))};const l=e=>{let{item:t}=e;return t.imageFlag?i.createElement("div",{className:"editor-rakuten-item__thumbnail"},i.createElement("img",{src:t.smallImageUrls[0],"data-testid":"editor-rakuten-item-img"})):null}},21931:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RakutenSidebar=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=p(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),i=c(r(20996)),a=r(46171),o=c(r(70881)),s=r(90381),l=r(73544),d=r(34184),u=r(77018);function c(e){return e&&e.__esModule?e:{default:e}}function p(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(p=function(e){return e?r:t})(e)}const f=e=>n.createElement("div",{className:"editor-rakuten-items-message"},e.children);class h extends n.Component{constructor(e){super(e),this.state=e.vm.getState()}componentDidMount(){this.update=()=>this.setState(this.props.vm.getState()),this.props.vm.on("change",this.update)}componentWillUnmount(){this.props.vm.removeListener("change",this.update),this.update=null}render(){const{items:e,keyword:t}=this.state,r=null===t,c=this.state.isLoading,p=!r&&!c&&0===e.length;return n.createElement("div",{className:"editor-rakuten-content"},n.createElement("div",{className:"editor-rakuten-header"},n.createElement("h2",null,i.default.text("edit_form.rakuten")),n.createElement(o.default,{placeholder:i.default.text("edit_form.rakuten.placeholder"),onSubmit:e=>this.props.vm.searchItems(e)}),n.createElement(u.ErrorMessage,{error:this.state.error})),n.createElement("div",{className:"editor-rakuten-main"},n.createElement(a.InfiniteScroll,{onScroll:()=>this.props.vm.loadNextItems(),interval:1e3},n.createElement("div",{className:"editor-rakuten-items"},e.map(((e,t)=>n.createElement(d.Item,{item:e,key:t,isSelected:this.props.vm.isItemSelected(e),onSelect:()=>this.props.vm.toggleItemSelection(e),onDoubleClick:()=>this.props.vm.insertItem(e)}))),r?n.createElement(f,null,i.default.text("edit_form.rakuten.description")):null,p?n.createElement(f,null,i.default.text("edit_form.rakuten.empty",t)):null,c?n.createElement(s.LoadingIndicator,null):null))),n.createElement(l.Footer,{hasSelectedItems:this.props.vm.hasSelectedItems(),onSubmit:()=>this.props.vm.insertSelectedItems()}))}}t.RakutenSidebar=h},12495:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetchAPI=function(e){return i.default.get("/api/rakuten",{params:e}).then((e=>{if(e.data.error)throw e.data.error;return e.data.Items})).catch((e=>{if(o.KNOWN_ERRORS[e.message])throw e;(0,a.BUG)(e)}))};var n,i=(n=r(347))&&n.__esModule?n:{default:n},a=r(70879),o=r(11500)},40555:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Rakuten=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n},a=r(73380),o=r(21931),s=r(66316);t.Rakuten=class{constructor(e){const t=new s.RakutenViewModel;(0,a.safeRender)(i.default.createElement(o.RakutenSidebar,{vm:t}),e)}}},48923:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initScheduledUpdateExistingNotice=t.ExistingNotice=void 0;var n=r(73380),i=d(r(27484)),a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=l(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),o=d(r(83253)),s=d(r(20996));function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(l=function(e){return e?r:t})(e)}function d(e){return e&&e.__esModule?e:{default:e}}const u=e=>{let{scheduledUpdateAt:t}=e;const[r,n]=(0,a.useState)(!0),l=()=>{n(!1)};return a.default.createElement(o.default,{className:"editor-modal",overlayClassName:"editor-modal-overlay",isOpen:r,onRequestClose:l},a.default.createElement("div",{className:"header"},a.default.createElement("h2",null,s.default.text("edit_form.scheduled_update.existing_notice.title")),a.default.createElement("p",null,s.default.text("edit_form.scheduled_update.existing_notice.body1",(0,i.default)(t).format("YYYY/MM/DD HH:mm"),s.default.text("admin.entries"),s.default.text("admin.entry.edit_scheduled_update")))),a.default.createElement("p",null,a.default.createElement("button",{className:"btn",type:"button",onClick:l},s.default.text("ok"))))};t.ExistingNotice=u;t.initScheduledUpdateExistingNotice=(e,t)=>{o.default.setAppElement(t);const r=Number(e.getAttribute("data-scheduled-update-time")),i=new Date(1e3*r);(0,n.safeRender)(a.default.createElement(u,{scheduledUpdateAt:i}),e)}},80417:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SidebarButtons=void 0;var n=s(r(65311)),i=s(r(66419)),a=s(r(347)),o=r(55992);function s(e){return e&&e.__esModule?e:{default:e}}const l=r(91269);t.SidebarButtons=class{constructor(e,t,r){this.$element=e,this.parent=t,this.publicationType=r,this.$visibleButtonsContainer=this.$element.find(".curation-bar-itemlist-visible"),this.$overflowButtonsContainer=this.$element.find(".curation-bar-itemlist-overflow"),this.$toggleButton=this.$element.find(".curation-bar-toggle"),this.$othersButton=this.$element.find(".editor-others"),this.$addButton=this.$element.find(".curation-add-button"),this.buttonSize=this.$othersButton.height(),this.services=l.get("editor.sidebarServices"),this.activeService="editor-home",this.template=i.default.template(this.$element.find(".template").html()),this.render(),this.initEvents()}initEvents(){this.$toggleButton.on("click",(()=>{this.parent.emit("toggle")})),this.$othersButton.on("click",(()=>{this.toggleOverflow()})),this.$element.on("click","[data-support-type]",(e=>{const t=(0,n.default)(e.currentTarget);this.parent.emit("openByType",t.attr("data-support-type"))})),this.parent.on("tabChange",(e=>this.onTabChange(e))),this.parent.on("resize",(()=>this.render())),this.parent.on("reloadSidebarButtons",(async()=>{await this.reloadSidebarServices(),this.render()}))}onTabChange(e){this.activeService=e,this.activateButton()}async reloadSidebarServices(){const e=(0,o.protocolRelativeAdminUserBlogUrl)("/edit_sidebar_buttons.json"),t=await a.default.get(e,{params:{publication_type:this.publicationType}});this.services=t.data}activateButton(){this.$visibleButtonsContainer.children().each(((e,t)=>{const r=(0,n.default)(t);r.toggleClass("is-active",r.attr("data-support-type")===this.activeService)})),this.$overflowButtonsContainer.children().each(((e,t)=>{const r=(0,n.default)(t);r.toggleClass("is-active",r.attr("data-support-type")===this.activeService)}))}render(){this.$visibleButtonsContainer.empty(),this.$overflowButtonsContainer.empty(),this.$othersButton.show(),this.services.forEach((e=>{e.showShortcut&&this.$visibleButtonsContainer.append(this.renderButton(e))}));const e=this.$addButton[0].getBoundingClientRect().bottom-(0,n.default)(window).height();if(e>0){const t=Math.floor(e/this.buttonSize)+1,r=this.$visibleButtonsContainer.children().slice(-t);this.$overflowButtonsContainer.append(r),this.fixOverflowPosition()}else this.$othersButton.hide();this.activateButton()}renderButton(e){const t=this.template(e);return(0,n.default)(t.trim())}toggleOverflow(){this.$othersButton.toggleClass("is-active tipsy-left"),this.$overflowButtonsContainer.toggleClass("is-active"),this.$overflowButtonsContainer.hasClass("is-active")&&this.fixOverflowPosition(),this.$othersButtonTipsy=this.$othersButtonTipsy||(0,n.default)(".tipsy > *"),this.$othersButtonTipsy.toggle()}fixOverflowPosition(){const e=this.$element.offset().top,t=this.$othersButton.offset().top-e+this.$othersButton.outerHeight()-this.$overflowButtonsContainer.height();this.$overflowButtonsContainer.css({top:t})}}},9825:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(20996))&&n.__esModule?n:{default:n},a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294));function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}class s extends a.Component{render(){const e="paste-button btn "+(this.props.disabled?"disabled":"enabled");return a.createElement("div",{className:"editor-sidebar-insert-button"},a.createElement("button",{className:e,type:"button","data-track-name":this.props.trackingId,"data-testid":"sidebar-insert-button",disabled:this.props.disabled,onClick:this.props.onClick},i.default.text("edit_form.paste")))}}var l=s;t.default=l},70881:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=a(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,r&&r.set(e,n);return n}(r(67294)),i=r(41960);function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(a=function(e){return e?r:t})(e)}class o extends n.Component{constructor(e){super(e),this.state={value:""}}onChange(e){this.setState({value:e.target.value})}onKeyPress(e){"RET"===(0,i.keyString)(e)&&(e.preventDefault(),this.submit())}submit(){this.props.onSubmit(this.state.value)}render(){return n.createElement("div",{className:"sidebar-search-form"},n.createElement("input",{type:"text",placeholder:this.props.placeholder,className:"sidebar-search-form__input","data-testid":"sidebar-search-input",onKeyPress:e=>this.onKeyPress(e),onChange:e=>this.onChange(e)}),n.createElement("button",{type:"button",className:"sidebar-search-form__submit","data-testid":"sidebar-search-button",onClick:()=>this.submit()},n.createElement("i",{className:"blogicon-search"})))}}var s=o;t.default=s},13605:(e,t,r)=>{"use strict";var n,i=(n=r(65311))&&n.__esModule?n:{default:n},a=r(66419),o=r(17187);class s extends o.EventEmitter{constructor(){super(),this.type=document.querySelector(".curation-tab-content").id,(0,i.default)("input").on("blur",(()=>this.emit("resize",this.type))),(0,i.default)(window).on("resize",(0,a.debounce)((()=>this.emit("resize",this.type)),100))}}e.exports=s},6686:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),i=o(r(78101)),a=o(r(61016));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}class l extends n.Component{render(){const e="editor-sidebar-user-association";return this.props.user?n.createElement("div",{className:e},n.createElement(a.default,{user:this.props.user,onUnregister:()=>this.props.onUnregister()})):n.createElement("div",{className:e},n.createElement(i.default,{placeholder:this.props.placeholder,onRegister:e=>this.props.onRegister(e)}))}}var d=l;t.default=d},78101:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o(r(67294)),i=o(r(20996)),a=r(41960);function o(e){return e&&e.__esModule?e:{default:e}}class s extends n.default.Component{constructor(e){super(e),this.state={value:""}}render(){return n.default.createElement("div",{className:"user-form","data-testid":"sidebar-user-form"},n.default.createElement("input",{type:"text",className:"user-form-name","data-testid":"user-form-input",placeholder:this.props.placeholder,onKeyPress:e=>this.onKeyPress(e),onChange:e=>this.onChange(e),value:this.state.value}),n.default.createElement("button",{type:"button",className:"user-form-name-submit",onClick:()=>this.register()},i.default.text("edit_form.flickr.register")))}onChange(e){this.setState({value:e.target.value})}onKeyPress(e){"RET"===(0,a.keyString)(e)&&(e.preventDefault(),this.register())}register(){this.props.onRegister(this.state.value)}}var l=s;t.default=l},61016:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n};var a=e=>{let{user:t,onUnregister:r}=e;return i.default.createElement("div",{className:"user-info","data-testid":"sidebar-user-info"},i.default.createElement("div",{className:"user-info-icon"},i.default.createElement("a",{href:t.uri},i.default.createElement("img",{src:t.icon,alt:"",className:"user-image"}))),i.default.createElement("div",{className:"user-info-name"},i.default.createElement("a",{href:t.uri,target:"_blank",rel:"noopener noreferrer"},t.name)),i.default.createElement("button",{type:"button",className:"user-info-unregister-button","data-testid":"user-info-unregister-button",onClick:()=>r()},i.default.createElement("i",{className:"blogicon-close"})))};t.default=a},56489:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updatedExistingSnippet=t.updateEditingSnippet=t.setTitleLengthLimit=t.setSnippetCountLimit=t.setSelectedSnippet=t.setFilterQuery=t.setEditingSnippet=t.setCanManageSnippets=t.setBodyLengthLimit=t.saveSnippet=t.requestSnippets=t.receiveSnippets=t.openSnippetEditingModal=t.insertSnippet=t.insertSelectedSnippet=t.initializeState=t.extractSelectionToSnippet=t.deleteSnippet=t.createdNewSnippet=void 0;t.initializeState=()=>({type:"INITIALIZE_STATE"});t.setCanManageSnippets=e=>({canManageSnippets:e,type:"SET_CAN_MANAGE_SNIPPETS"});t.setSnippetCountLimit=e=>({snippetCountLimit:e,type:"SET_SNIPPET_COUNT_LIMIT"});t.setTitleLengthLimit=e=>({titleLengthLimit:e,type:"SET_TITLE_LENGTH_LIMIT"});t.setBodyLengthLimit=e=>({bodyLengthLimit:e,type:"SET_BODY_LENGTH_LIMIT"});t.requestSnippets=()=>({type:"REQUEST_SNIPPETS"});t.receiveSnippets=e=>({receivedSnippets:e,type:"RECEIVE_SNIPPETS"});t.setSelectedSnippet=e=>({selectedSnippet:e,type:"SET_SELECTED_SNIPPET"});t.insertSelectedSnippet=e=>({editor:e,type:"INSERT_SELECTED_SNIPPET"});t.insertSnippet=(e,t)=>({editor:e,snippet:t,type:"INSERT_SNIPPET"});t.extractSelectionToSnippet=e=>({editor:e,type:"EXTRACT_SELECTION_TO_SNIPPET"});t.openSnippetEditingModal=(e,t)=>({editor:e,snippet:t,type:"OPEN_SNIPPET_EDITING_MODAL"});t.setEditingSnippet=e=>({editingSnippet:e,type:"SET_EDITING_SNIPPET"});t.updateEditingSnippet=e=>({type:"UPDATE_EDITING_SNIPPET",updatingEditingSnippet:e});t.saveSnippet=()=>({type:"SAVE_SNIPPET"});t.createdNewSnippet=e=>({createdSnippet:e,type:"CREATED_NEW_SNIPPET"});t.updatedExistingSnippet=e=>({type:"UPDATED_EXISTING_SNIPPET",updatedSnippet:e});t.deleteSnippet=e=>({deletingSnippet:e,type:"DELETE_SNIPPET"});t.setFilterQuery=e=>({query:e,type:"SET_FILTER_QUERY"})},78983:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateSnippet=t.getSnippets=t.deleteSnippet=t.createSnippet=void 0;var n=a(r(57942)),i=a(r(347));function a(e){return e&&e.__esModule?e:{default:e}}t.getSnippets=()=>{const e=(0,n.default)("blog-uuid");return e?i.default.get("/api/snippets",{params:{blogId:e},responseType:"json"}).then((e=>e.data.snippets)):Promise.reject("failed to retrieve blog")};t.createSnippet=e=>{const t=(0,n.default)("blog-uuid");if(!t)return Promise.reject("failed to retrieve blog");const r=(0,n.default)("rkm"),a=(0,n.default)("rkc");if(!r||!a)return Promise.reject("Failed to retrieve credentials");const o=new FormData;return o.append("title",e.title),o.append("body",e.body),o.append("blogId",t),o.append("rkm",r),o.append("rkc",a),i.default.post("/api/snippets",o,{responseType:"json"}).then((e=>e.data.snippet))};t.updateSnippet=e=>{if(!(0,n.default)("blog-uuid"))return Promise.reject("failed to retrieve blog");const t=(0,n.default)("rkm"),r=(0,n.default)("rkc");if(!t||!r)return Promise.reject("Failed to retrieve credentials");const a=new FormData;return a.append("title",e.title),a.append("body",e.body),a.append("rkm",t),a.append("rkc",r),i.default.post(`/api/snippets/${e.uuid}`,a)};t.deleteSnippet=e=>{if(!(0,n.default)("blog-uuid"))return Promise.reject("failed to retrieve blog");const t=(0,n.default)("rkm"),r=(0,n.default)("rkc");return i.default.delete(`/api/snippets/${e.uuid}`,{params:{rkc:r,rkm:t}})}},24409:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=f(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),a=(n=r(20996))&&n.__esModule?n:{default:n},o=r(67702),s=r(8881),l=r(23356),d=r(49872),u=r(27942),c=r(45977),p=r(75152);function f(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(f=function(e){return e?r:t})(e)}var h=e=>{let{editor:t}=e;return i.createElement("div",{className:"editor-sidebar-snippet"},i.createElement("div",{className:"editor-sidebar-snippet_header"},i.createElement("h2",null,a.default.text("edit_form.snippet")),i.createElement(s.DescriptionContainer,null),i.createElement(l.ExtractSelectionButtonContainer,{editor:t}),i.createElement(u.SnippetListHeaderContainer,null),i.createElement(p.FilterQueryFormContainer,null),i.createElement(c.SnippetEditorModalContainer,null)),i.createElement(o.BodyContainer,{editor:t}),i.createElement("div",{className:"editor-sidebar-snippet_footer"},i.createElement(d.PasteSnippetButtonContainer,{editor:t})))};t.default=h},97203:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Body=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=a(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,r&&r.set(e,n);return n}(r(67294)),i=r(8958);function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(a=function(e){return e?r:t})(e)}t.Body=e=>{let{editor:t}=e;return n.createElement("div",{className:"editor-sidebar-snippet_body"},n.createElement(i.SnippetsListContainer,{editor:t}))}},52796:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Description=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),a=(n=r(20996))&&n.__esModule?n:{default:n};function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}t.Description=e=>{let{snippetCountLimit:t}=e;return i.createElement("p",null,a.default.textN("edit_form.snippet.description",t,t))}},64592:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),a=(n=r(20996))&&n.__esModule?n:{default:n};function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}function s(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class l extends i.PureComponent{constructor(e){super(e),s(this,"toggleButton",null),this.state={isOpen:!1},this.handleDocumentClick=this.forceCloseDropdownMenu.bind(this)}componentDidMount(){document.addEventListener("click",this.handleDocumentClick,!1)}componentWillUnmount(){document.removeEventListener("click",this.handleDocumentClick,!1)}render(){const e=this.state.isOpen;return i.createElement("div",{className:"editor-sidebar-snippet_dropdown-section"},i.createElement("div",{className:"dropdown-window-wrapper"},i.createElement("button",{type:"button",className:"dropdown-window-btn",onClick:e=>this.toggleDropdownMenu(e),onDoubleClick:e=>e.preventDefault(),ref:e=>{this.toggleButton=e}},i.createElement("i",{className:"blogicon-others"})),i.createElement("div",{className:"dropdown-list-container "+(e?"is-open":"")},i.createElement("ul",{className:"list"},i.createElement("li",{className:"dropdown-snippetsList-update"},i.createElement("button",{type:"button",onClick:e=>this.props.onUpdate(e,this.props.snippet)},i.createElement("i",{className:"blogicon-edit"})," ",a.default.text("edit_form.edit"))),i.createElement("li",{className:"dropdown-snippetsList-delete"},i.createElement("button",{type:"button",onClick:e=>this.props.onDelete(e,this.props.snippet)},i.createElement("i",{className:"blogicon-close"})," ",a.default.text("edit_form.delete")))))))}toggleDropdownMenu(e){e.preventDefault(),this.setState({isOpen:!this.state.isOpen})}forceCloseDropdownMenu(e){this.toggleButton.contains(e.target)||this.setState({isOpen:!1})}}var d=l;t.default=d},54249:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EditingSnippetPreview=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),a=(n=r(20996))&&n.__esModule?n:{default:n};function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}t.EditingSnippetPreview=e=>{let{editingSnippet:t,titleLengthLimit:r,bodyLengthLimit:n,titleValidationResult:o,bodyValidationResult:s,onUpdateEditingSnippetBody:l,onUpdateEditingSnippetTitle:d,savingState:u,onSave:c,onCancel:p}=e;const f=(h=r,"TOO_LONG"===o?a.default.textN("edit_form.snippet.field.too_long",h,a.default.formatNumber(h)):null);var h;const m=((e,t)=>"TOO_LONG"===t?a.default.textN("edit_form.snippet.field.too_long",e,a.default.formatNumber(e)):null)(n,s);return i.createElement("div",{className:"editor-sidebar-snippet_preview-container"},i.createElement("div",{className:"preview-header"},i.createElement("h4",null,a.default.text(t.uuid?"edit_form.snippet.update":"edit_form.snippet.save")),i.createElement("button",{type:"button",className:"preview-close",onClick:p},i.createElement("i",{className:"blogicon-close"}))),i.createElement("div",{className:"preview-body"},i.createElement("input",{type:"text",className:f?"error-input":"",value:t.title,placeholder:a.default.text("edit_form.title"),onChange:e=>d(e.currentTarget.value)}),f&&i.createElement("p",null,f),i.createElement("textarea",{className:`${m&&"error-input"}`,value:t.body,onChange:e=>l(e.currentTarget.value)}),m&&i.createElement("p",null,m)),i.createElement("div",{className:"preview-footer"},i.createElement("button",{type:"submit",onClick:c,className:"preview-btn btn-submit "+("savable"!==u?"disabled":""),disabled:"savable"!==u},a.default.text((e=>"saving"===e?"edit_form.saving":"edit_form.save")(u))),i.createElement("button",{type:"submit",onClick:p,className:"preview-btn"},a.default.text("cancel"))))}},72048:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtractSelectionButton=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),a=(n=r(20996))&&n.__esModule?n:{default:n};function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}t.ExtractSelectionButton=e=>{let{canManageSnippets:t,enabled:r,onClick:n}=e;return t?i.createElement("button",{type:"button",className:"editor-sidebar-snippet_btn "+(r?"":"disabled"),onClick:n,disabled:!r},a.default.text("edit_form.snippet.save")):null}},66219:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FilterQueryForm=void 0;var n=o(r(67294)),i=o(r(20996)),a=o(r(70881));function o(e){return e&&e.__esModule?e:{default:e}}t.FilterQueryForm=e=>{let{onFilterQueryChange:t}=e;return n.default.createElement(a.default,{placeholder:i.default.text("edit_form.snippet.filter_placeholder"),onSubmit:e=>t(e)})}},13859:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PasteSnippetButton=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),a=(n=r(20996))&&n.__esModule?n:{default:n};function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}t.PasteSnippetButton=e=>{let{selectedSnippet:t,onClick:r}=e;return i.createElement("button",{type:"submit",disabled:!t,onClick:e=>r(e),className:"editor-sidebar-snippet_btn "+(t?"enabled":"disabled")},a.default.text("edit_form.snippet.paste"))}},20661:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SnippetEditorModal=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),a=(n=r(83253))&&n.__esModule?n:{default:n},o=r(98703);function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}t.SnippetEditorModal=e=>{let{isOpen:t,onRequestClose:r}=e;return i.createElement(a.default,{isOpen:t,className:"editor-sidebar-snippet_preview",overlayClassName:"editor-sidebar-snippet_preview-overlay",portalClassName:"editor-sidebar-snippet_preview-portal",shouldCloseOnOverlayClick:!0,onRequestClose:r},i.createElement(o.EditingSnippetPreviewContainer,null))}},51159:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SnippetListElement=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),i=o(r(20996)),a=o(r(64592));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}t.SnippetListElement=e=>{let{snippet:t,isSelected:r,onClickSnippet:o,onDoubleClickSnippet:s,onUpdate:l,onDelete:d,canManageSnippets:u}=e;return n.createElement("div",{className:"editor-sidebar-snippet_snippetsList-item "+(r?"is-selected":""),"data-testid":"editor-sidebar-snippet_snippetsList-item",onClick:e=>o(e,t),onDoubleClick:e=>s(e,t)},n.createElement("div",{className:"editor-sidebar-snippet_snippetsList-title"},t.title||i.default.text("edit_form.snippet.no_title")),u&&n.createElement(a.default,{snippet:t,onUpdate:l,onDelete:d}))}},82623:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SnippetListHeader=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),a=(n=r(20996))&&n.__esModule?n:{default:n};function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}t.SnippetListHeader=e=>{let{snippetCount:t}=e;return i.createElement("h3",null,a.default.text("edit_form.snippet.list.header",t))}},59981:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SnippetsList=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),i=r(90381),a=r(51159);function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}t.SnippetsList=e=>n.createElement("div",{className:"editor-sidebar-snippet_snippetsList"},(e=>{let{snippets:t,snippetsLoadingStatus:r,selectedSnippet:o,canManageSnippets:s,onSelectSnippet:l,onDoubleClickSnippet:d,onUpdateSnippet:u,onDeleteSnippet:c}=e;switch(r){case"initial":case"loading":return n.createElement(i.LoadingIndicator,null);case"failed":return"failed to load";default:return t.map((e=>n.createElement(a.SnippetListElement,{key:e.uuid,snippet:e,isSelected:!!o&&o.uuid===e.uuid,onClickSnippet:l,onDoubleClickSnippet:d,onUpdate:u,onDelete:c,canManageSnippets:s})))}})(e))},67702:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BodyContainer=void 0;var n=r(96841),i=r(97203);const a=(0,n.connect)(((e,t)=>({editor:t.editor})))(i.Body);t.BodyContainer=a},8881:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DescriptionContainer=void 0;var n=r(96841),i=r(52796);const a=(0,n.connect)((e=>({snippetCountLimit:e.snippetCountLimit})))(i.Description);t.DescriptionContainer=a},98703:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EditingSnippetPreviewContainer=void 0;var n=r(96841),i=r(56489),a=r(54249),o=r(71717);const s=(0,n.connect)((e=>{return{editingSnippet:e.editingSnippet,titleLengthLimit:e.titleLengthLimit,bodyLengthLimit:e.bodyLengthLimit,titleValidationResult:(0,o.validateTitle)(e.editingSnippet?.title||"",e.titleLengthLimit),bodyValidationResult:(0,o.validateBody)(e.editingSnippet?.body||"",e.bodyLengthLimit),savingState:(t=e.editingSnippet,r=e.titleLengthLimit,n=e.bodyLengthLimit,t?t.isSaving?"saving":(0,o.isSavable)(t,r,n)?"savable":"unsavable":"unsavable")};var t,r,n}),(e=>({onCancel:t=>{t.preventDefault(),e((0,i.setEditingSnippet)(null))},onSave:t=>{t.preventDefault(),e((0,i.saveSnippet)())},onUpdateEditingSnippetBody:t=>{e((0,i.updateEditingSnippet)({body:t}))},onUpdateEditingSnippetTitle:t=>{e((0,i.updateEditingSnippet)({title:t}))}})))(a.EditingSnippetPreview);t.EditingSnippetPreviewContainer=s},23356:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtractSelectionButtonContainer=void 0;var n=r(96841),i=r(56489),a=r(72048);const o=(0,n.connect)((e=>{const t=e.snippets.data.length>=e.snippetCountLimit;return{canManageSnippets:e.canManageSnippets,enabled:!t}}),((e,t)=>({onClick:r=>{r.preventDefault(),e((0,i.extractSelectionToSnippet)(t.editor))}})))(a.ExtractSelectionButton);t.ExtractSelectionButtonContainer=o},75152:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FilterQueryFormContainer=void 0;var n=r(96841),i=r(66219),a=r(56489);const o=(0,n.connect)(null,(e=>({onFilterQueryChange:t=>e((0,a.setFilterQuery)(t))})))(i.FilterQueryForm);t.FilterQueryFormContainer=o},49872:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PasteSnippetButtonContainer=void 0;var n=r(96841),i=r(13859),a=r(56489);const o=(0,n.connect)((e=>({selectedSnippet:e.selectedSnippet})),((e,t)=>({onClick:r=>{r.preventDefault(),e((0,a.insertSelectedSnippet)(t.editor))}})))(i.PasteSnippetButton);t.PasteSnippetButtonContainer=o},45977:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SnippetEditorModalContainer=void 0;var n=r(96841),i=r(56489),a=r(20661);const o=(0,n.connect)((e=>({isOpen:!!e.editingSnippet})),(e=>({onRequestClose:()=>{e((0,i.setEditingSnippet)(null))}})))(a.SnippetEditorModal);t.SnippetEditorModalContainer=o},27942:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SnippetListHeaderContainer=void 0;var n=r(96841),i=r(82623);const a=(0,n.connect)((e=>({snippetCount:e.snippets.data.length})))(i.SnippetListHeader);t.SnippetListHeaderContainer=a},8958:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SnippetsListContainer=void 0;var n,i=r(96841),a=(n=r(20996))&&n.__esModule?n:{default:n},o=r(56489),s=r(59981);const l=(0,i.connect)((e=>{const t=e.snippets.data,r=e.filterQuery;if(""===r)return{canManageSnippets:e.canManageSnippets,selectedSnippet:e.selectedSnippet,snippets:t,snippetsLoadingStatus:e.snippets.loadingStatus};const n=t.filter((e=>((e,t)=>{const r=e.toLowerCase();return t.title.toLowerCase().includes(r)||t.body.toLowerCase().includes(r)})(r,e)));return{canManageSnippets:e.canManageSnippets,selectedSnippet:e.selectedSnippet,snippets:n,snippetsLoadingStatus:e.snippets.loadingStatus}}),((e,t)=>({onDeleteSnippet:(t,r)=>{t.preventDefault(),(e=>{let{title:t}=e;const r=t||a.default.text("edit_form.snippet.no_title");return window.confirm(a.default.text("edit_form.snippet.delete.confirm",r))})(r)&&e((0,o.deleteSnippet)(r))},onDoubleClickSnippet:(r,n)=>{r.defaultPrevented||(r.preventDefault(),e((0,o.insertSnippet)(t.editor,n)))},onSelectSnippet:(t,r)=>{t.defaultPrevented||(t.preventDefault(),e((0,o.setSelectedSnippet)(r)))},onUpdateSnippet:(r,n)=>{r.preventDefault(),e((0,o.openSnippetEditingModal)(t.editor,n))}})))(s.SnippetsList);t.SnippetsListContainer=l},34253:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.insertSnippetToEditor=t.extractSelectionFromEditor=void 0;t.extractSelectionFromEditor=e=>e.getSelectionSource();t.insertSnippetToEditor=(e,t)=>{t.insert(e.body)}},20246:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=p(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),i=r(73380),a=r(96841),o=r(14890),s=c(r(30797)),l=c(r(24409)),d=c(r(56015)),u=c(r(13594));function c(e){return e&&e.__esModule?e:{default:e}}function p(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(p=function(e){return e?r:t})(e)}var f={init:(e,t)=>{const r=(0,s.default)(),c=(0,o.createStore)(d.default,(0,o.applyMiddleware)(r));r.run(u.default),(0,i.safeRender)(n.createElement(a.Provider,{store:c},n.createElement(l.default,{editor:t})),e)}};t.default=f},56015:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(14890);var i=(0,n.combineReducers)({canManageSnippets:function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;return"SET_CAN_MANAGE_SNIPPETS"===t.type?t.canManageSnippets:e},snippetCountLimit:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;return"SET_SNIPPET_COUNT_LIMIT"===t.type?t.snippetCountLimit:e},titleLengthLimit:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;return"SET_TITLE_LENGTH_LIMIT"===t.type?t.titleLengthLimit:e},bodyLengthLimit:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;return"SET_BODY_LENGTH_LIMIT"===t.type?t.bodyLengthLimit:e},editingSnippet:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_EDITING_SNIPPET":return t.editingSnippet;case"UPDATE_EDITING_SNIPPET":return Object.assign({},e,t.updatingEditingSnippet);case"CREATED_NEW_SNIPPET":case"UPDATED_EXISTING_SNIPPET":return null;case"SAVE_SNIPPET":return{...null===e?{title:"",body:""}:e,isSaving:!0};default:return e}},selectedSnippet:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return"SET_SELECTED_SNIPPET"===t.type?e&&null!==t.selectedSnippet&&e.uuid===t.selectedSnippet.uuid?null:t.selectedSnippet:e},filterQuery:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return"SET_FILTER_QUERY"===t.type?t.query:e},snippets:(0,n.combineReducers)({data:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"RECEIVE_SNIPPETS":return t.receivedSnippets;case"CREATED_NEW_SNIPPET":return[t.createdSnippet,...e];case"UPDATED_EXISTING_SNIPPET":return((e,t)=>{const r=t.findIndex((t=>t.uuid===e.uuid));return[...t.slice(0,r),e,...t.slice(r+1)]})(t.updatedSnippet,e);case"DELETE_SNIPPET":return((e,t)=>{const r=t.findIndex((t=>t.uuid===e.uuid)),n=[...t];return n.splice(r,1),n})(t.deletingSnippet,e);default:return e}},loadingStatus:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"initial";switch((arguments.length>1?arguments[1]:void 0).type){case"REQUEST_SNIPPETS":return"loading";case"RECEIVE_SNIPPETS":return"loaded";default:return e}}})});t.default=i},13594:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function*(){yield(0,n.fork)(k),yield(0,n.fork)(g),yield(0,n.fork)(h),yield(0,n.fork)(d),yield(0,n.fork)(w),yield(0,n.fork)(b),yield(0,n.fork)(S),yield(0,n.fork)(P)},t.takeInsertSnippet=b;var n=r(34857),i=r(56489),a=r(78983),o=r(34253);const s=r(91269);function*l(e){yield(0,n.call)(a.deleteSnippet,e.deletingSnippet)}function*d(){yield(0,n.takeEvery)("DELETE_SNIPPET",l)}const u=e=>e.editingSnippet;function*c(){const e=yield(0,n.select)(u),t=yield(0,n.call)(a.createSnippet,e);yield(0,n.put)((0,i.createdNewSnippet)(t))}function*p(){const e=yield(0,n.select)(u);yield(0,n.call)(a.updateSnippet,e),yield(0,n.put)((0,i.updatedExistingSnippet)(e))}function*f(){(yield(0,n.select)(u)).uuid?yield(0,n.fork)(p):yield(0,n.fork)(c)}function*h(){yield(0,n.takeEvery)("SAVE_SNIPPET",f)}function*m(){const e=yield(0,n.call)(a.getSnippets);yield(0,n.put)((0,i.receiveSnippets)(e))}function*g(){yield(0,n.takeEvery)("REQUEST_SNIPPETS",m)}function*v(e){const{editor:t,snippet:r}=e;yield(0,n.call)(o.insertSnippetToEditor,r,t)}function*b(){yield(0,n.takeEvery)("INSERT_SNIPPET",v)}const y=e=>e.selectedSnippet;function*_(e){const t=yield(0,n.select)(y);if(t){const{editor:r}=e;yield(0,n.call)(o.insertSnippetToEditor,t,r),yield(0,n.put)((0,i.setSelectedSnippet)(null))}}function*w(){yield(0,n.takeEvery)("INSERT_SELECTED_SNIPPET",_)}function*E(e){const{editor:t}=e,r=yield(0,n.call)(o.extractSelectionFromEditor,t);yield(0,n.put)((0,i.setEditingSnippet)({body:r,isSaving:!1,title:"",uuid:void 0}))}function*S(){yield(0,n.takeEvery)("EXTRACT_SELECTION_TO_SNIPPET",E)}function*C(e){const{editor:t,snippet:r}=e;yield(0,n.put)((0,i.setEditingSnippet)({body:r.body,isSaving:!1,title:r.title,uuid:r.uuid}))}function*P(){yield(0,n.takeEvery)("OPEN_SNIPPET_EDITING_MODAL",C)}function*k(){yield(0,n.put)((0,i.initializeState)());const e=yield(0,n.call)((()=>s.get("editor.entryOption").canManageSnippets));yield(0,n.put)((0,i.setCanManageSnippets)(e));const t=yield(0,n.call)((()=>s.get("editor.entryOption").snippetCountLimit));yield(0,n.put)((0,i.setSnippetCountLimit)(t));const r=yield(0,n.call)((()=>s.get("editor.entryOption").snippetTitleLengthLimit));yield(0,n.put)((0,i.setTitleLengthLimit)(r));const a=yield(0,n.call)((()=>s.get("editor.entryOption").snippetBodyLengthLimit));yield(0,n.put)((0,i.setBodyLengthLimit)(a)),yield(0,n.put)((0,i.requestSnippets)())}},71717:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateTitle=t.validateBody=t.isSavable=void 0;var n=r(96341);const i=(e,t)=>(0,n.characterLength)(e)<=t?"OK":"TOO_LONG";t.validateTitle=i;const a=(e,t)=>0===(0,n.characterLength)(e)?"EMPTY":(0,n.characterLength)(e)<=t?"OK":"TOO_LONG";t.validateBody=a;t.isSavable=(e,t,r)=>"OK"===i(e.title,t)&&"OK"===a(e.body,r)},89673:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EditTagButton=void 0;var n=a(r(67294)),i=a(r(20996));function a(e){return e&&e.__esModule?e:{default:e}}t.EditTagButton=e=>{let{onButtonClick:t}=e;return n.default.createElement("button",{type:"button",className:"btn editor-tag-editor_editTag",onClick:t},i.default.text("admin.edit.tag.add_tag"))}},64027:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FooterTagsList=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n};t.FooterTagsList=e=>{let{tags:t,onClick:r}=e;return i.default.createElement("ul",{className:"editor-tag-editor_tag-list","data-testid":"editor-tag-editor_tag-list",onClick:r},t.map((e=>i.default.createElement("li",{key:e,"data-testid":"editor-tag"},"#",e))))}},33307:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FormElementsToBeSubmitted=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n};t.FormElementsToBeSubmitted=e=>{let{tagNames:t}=e;return i.default.createElement(i.default.Fragment,null,i.default.createElement("input",{type:"hidden",name:"should_update_kotoba_tags",value:"1"}),t.map((e=>i.default.createElement("input",{type:"hidden",name:"kotoba_tag_name",value:e,key:e}))))}},7070:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OshiraseModalInner=void 0;var n=a(r(67294)),i=a(r(20996));function a(e){return e&&e.__esModule?e:{default:e}}t.OshiraseModalInner=e=>{let{onClickContinue:t}=e;return n.default.createElement(n.default.Fragment,null,n.default.createElement("div",{className:"oshirase-tag-guide"},n.default.createElement("div",{className:"header"},n.default.createElement("span",null,i.default.text("epic.new_feature")),n.default.createElement("h2",null,i.default.text("epic.kotoba_modal.desc.heading")),n.default.createElement("p",null,n.default.createElement("strong",null,i.default.text("epic.kotoba_modal.desc.1")),i.default.text("epic.kotoba_modal.desc.2"),n.default.createElement("br",null),i.default.text("epic.kotoba_modal.desc.3"))),n.default.createElement("button",{type:"button",onClick:t,className:"btn btn-primary","aria-label":i.default.text("epic.try_use")},i.default.text("epic.try_use")),n.default.createElement("a",{href:"https://staff.hatenablog.com/entry/about-tag-guide",className:"about-tag-link",target:"_blank",rel:"noopener"},i.default.text("epic.show_detail"))))}},62728:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OshirasePopOver=void 0;var n=a(r(67294)),i=a(r(20996));function a(e){return e&&e.__esModule?e:{default:e}}t.OshirasePopOver=e=>{let{onDismiss:t}=e;return n.default.createElement("div",{className:"editor-tag-editor_popover popover-bottom-left"},n.default.createElement("p",null,i.default.text("admin.edit.tag.desc")),n.default.createElement("div",{className:"popover-button"},n.default.createElement("button",{type:"button",className:"btn btn-ghost btn-ghost-wh",onClick:t,"aria-label":i.default.text("close")},"OK")))}},85993:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SortableTag=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=i(t);if(r&&r.has(e))return r.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=a?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,r&&r.set(e,n);return n}(r(67294));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(i=function(e){return e?r:t})(e)}const a=(0,r(94027).SortableElement)((e=>{let{tag:t,onClickRemoveBtn:r}=e;return n.createElement("div",{className:"editor-tag-editor_sortableTag","data-category-name":t},n.createElement("span",{className:"name"},"#",t),n.createElement("button",{type:"button",className:"RemoveBtn",onClick:r},n.createElement("i",{className:"blogicon-close"})),n.createElement("input",{type:"hidden",name:"tag",value:t,"data-with-backup":!0}))}));t.SortableTag=a},13483:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SortableTags=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),i=r(94027),a=r(85993);function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}const s=(0,i.SortableContainer)((e=>{let{tags:t,onClickRemoveBtn:r}=e;return n.createElement("div",{className:"editor-tag-editor_sortableTags"},t.map(((e,t)=>n.createElement(a.SortableTag,{key:`${t}-${e}`,index:t,tag:e,onClickRemoveBtn:()=>r(t)}))))}));t.SortableTags=s},99507:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TagEditor=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=m(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),i=r(89673),a=h(r(83253)),o=r(74622),s=r(64027),l=h(r(20996)),d=r(33307),u=r(7070),c=r(62728),p=r(25680),f=r(55992);function h(e){return e&&e.__esModule?e:{default:e}}function m(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(m=function(e){return e?r:t})(e)}t.TagEditor=e=>{let{appElement:t,initialTags:r,maxTagCountPerEntry:h,maxTagNameLength:m}=e;const[g,v]=(0,n.useState)(!1),[b,y]=(0,n.useState)(!1),[_,w]=(0,p.useStateWithConfigStorage)("tag-editor-modal-oshirase-seen",!1),[E,S]=(0,p.useStateWithConfigStorage)("tag-editor-oshirase-popup-dismissed",!1),[C,P]=(0,n.useState)(r),k=()=>v(!1),O=()=>v(!0);return a.default.setAppElement(t),n.default.createElement("div",{className:"editor-tag-editor_wrapper"},n.default.createElement("div",{className:"editor-tag-editor_popover-wrapper"},!E&&n.default.createElement(c.OshirasePopOver,{onDismiss:()=>{S(!0)}}),n.default.createElement(i.EditTagButton,{onButtonClick:()=>{_?O():y(!0)}})),n.default.createElement(s.FooterTagsList,{tags:C,onClick:O}),n.default.createElement(d.FormElementsToBeSubmitted,{tagNames:C}),n.default.createElement(a.default,{isOpen:b,onRequestClose:()=>y(!1),className:"editor-modal oshirase-tag-guide_modal",overlayClassName:"editor-modal-overlay"},n.default.createElement(u.OshiraseModalInner,{onClickContinue:()=>{w(!0),y(!1),v(!0)}})),n.default.createElement(a.default,{isOpen:g,onRequestClose:k,className:"editor-modal",overlayClassName:"editor-modal-overlay"},n.default.createElement("div",{className:"header"},n.default.createElement("h2",null,l.default.text("admin.edit.tag.edit_tag.heading")),n.default.createElement("p",null,l.default.text("admin.edit.tag.edit_tag.description"))),n.default.createElement(o.TagEditorModalInner,{tags:C,setTags:P,maxTagNameLength:m,maxTagCountPerEntry:h}),n.default.createElement("button",{className:"editor-modal_close","aria-label":l.default.text("close"),onClick:k,type:"button"},n.default.createElement("img",{src:(0,f.staticUrl)("/images/admin/close.svg"),alt:l.default.text("close")}))))}},74622:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TagEditorModalInner=void 0;var n=s(r(67294)),i=s(r(20996)),a=r(94054),o=r(55992);function s(e){return e&&e.__esModule?e:{default:e}}t.TagEditorModalInner=e=>{let{tags:t,setTags:r,maxTagNameLength:s,maxTagCountPerEntry:l}=e;return n.default.createElement("div",{className:"editor-tag-editor"},n.default.createElement(a.TagsListInput,{tags:t,setTags:r,maxTagNameLength:s,maxTagCountPerEntry:l}),n.default.createElement("aside",{className:"hints"},n.default.createElement("h3",null,i.default.text("admin.edit.tag.hints")),n.default.createElement("ul",null,n.default.createElement("li",null,i.default.text("admin.edit.tag.hints.tag_content")),n.default.createElement("li",null,i.default.text("admin.edit.tag.hints.number_of_tags")),n.default.createElement("li",null,n.default.createElement("a",{href:(0,o.helpUrl)("/entry/tag-guideline"),target:"_blank",rel:"noopener"},i.default.text("admin.edit.tag.hints.guideline.with_link")),i.default.text("admin.edit.tag.hints.guideline")))))}},94054:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TagsListInput=void 0;var n=p(r(20996)),i=p(r(26307)),a=r(41205),o=r(2403),s=r(13483),l=r(62420),d=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=c(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),u=r(94027);function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(c=function(e){return e?r:t})(e)}function p(e){return e&&e.__esModule?e:{default:e}}t.TagsListInput=e=>{let{tags:t,setTags:r,maxTagNameLength:c,maxTagCountPerEntry:p}=e;const f=d.default.useRef(null),{setInputValue:h,suggestions:m,setSuggestions:g,error:v,canAddMoreTags:b}=(e=>{let{maxTagCountPerEntry:t,maxTagNameLength:r,tags:i}=e;const[a,o]=(0,d.useState)(""),[s,l]=(0,d.useState)([]),u=i.length<t,[c,p]=(0,d.useState)();return(0,d.useEffect)((()=>{u?a.length>r?p(n.default.text("epic.kotoba.max_tag_name_length",r)):p(void 0):p(n.default.text("epic.kotoba.max_tags_per_entry",t))}),[i,a,u,t,r]),{setInputValue:o,suggestions:s,setSuggestions:l,error:c,canAddMoreTags:u}})({maxTagCountPerEntry:p,maxTagNameLength:c,tags:t}),y=d.default.useRef(null),_=(0,d.useCallback)((e=>{const n=new Set(t);new Set(e).forEach((e=>{if(0===e.length)return;n.has(e)?(n.delete(e),n.add(e)):n.add(e)})),r(Array.from(n))}),[t,r]);return d.default.createElement(d.default.Fragment,null,v&&d.default.createElement(l.ValidationError,{error:v}),d.default.createElement("div",{className:"tagsListInput",onClick:()=>f.current?.input?.focus(),ref:y},d.default.createElement(s.SortableTags,{tags:t,onClickRemoveBtn:e=>{const n=[...t];n.splice(e,1),r(n)},onSortStart:()=>{i.default.on()},onSortEnd:e=>{let{oldIndex:n,newIndex:a}=e;r((0,u.arrayMove)(t,n,a)),i.default.off()},helperClass:"sortableHelper",axis:"xy",distance:5}),b&&d.default.createElement(a.AutoCompleteInput,{ref:f,inputProps:{className:"input",autoComplete:"off",placeholder:n.default.text("admin.edit.tag.input.placeholder")},suggestions:m,onSubmit:e=>{if(e.length>c)return;const t=e.split(/\s[#\u{FF03}]/gu);_(t),f.current&&f.current.reset()},onCancel:()=>r(t.slice(0,-1)),onChangeValue:e=>{var t;h(e),t=e,(0,o.getTagSuggestionsForInput)(t).then((e=>{g(e),f.current&&f.current.updateSuggestionList()}))},filter:!1,inputPrefix:"#",getSuggestionsListBaseRect:()=>y.current?.getBoundingClientRect()})))}},62420:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ValidationError=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n};t.ValidationError=e=>{let{error:t}=e;return i.default.createElement("div",{className:"alert-box"},t)}},2403:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTagSuggestionsForInput=void 0;var n,i=r(96341),a=(n=r(347))&&n.__esModule?n:{default:n};const o=r(91269);let s="",l=Promise.resolve([]);t.getTagSuggestionsForInput=e=>{const t=e.match(/^(.*[^A-Za-z\uFF21-\uFF3A\uFF41-\uFF5A])[A-Za-z\uFF21-\uFF3A\uFF41-\uFF5A]{1,3}$/),r=t?t[1]:e;if((0,i.characterLength)(r)<=1)return Promise.resolve([]);if(r===s)return l;const n=o.get("editor.tags.graphqlUrl"),d=o.get("editor.tags.queryApiKey"),u=a.default.post(n,{query:"\n        query TagSuggestionQuery($nameHint: String!) {\n          suggestedTags(nameHint: $nameHint) {\n            nodes {\n              name\n            }\n          }\n        }\n      ",variables:{nameHint:r}},{headers:{Authorization:`Bearer ${d}`}}).then((e=>e.data.data.suggestedTags.nodes.map((e=>e.name))));return s=r,l=u,u}},16686:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initTagEditor=void 0;var n,i=r(73380),a=(n=r(67294))&&n.__esModule?n:{default:n},o=r(99507);const s=r(91269);t.initTagEditor=(e,t)=>{const r=s.get("editor.associatedTags")||[],n=s.get("editor.maxTagNameLength"),l=s.get("editor.maxTagCountPerEntry");(0,i.safeRender)(a.default.createElement(o.TagEditor,{appElement:t,initialTags:r,maxTagNameLength:n,maxTagCountPerEntry:l}),e)}},95594:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Item=void 0;var n=o(r(67294)),i=o(r(20996)),a=r(74868);function o(e){return e&&e.__esModule?e:{default:e}}t.Item=e=>{const t=e.item.thumbnails.medium;return n.default.createElement("div",{className:"editor-youtube_item item "+(e.isSelected?"selected":""),tabIndex:0,onClick:e.onClick,onDoubleClick:e.onDoubleClick,onKeyPress:e.onKeyPress},n.default.createElement("div",{className:"thumbnail-wrapper"},n.default.createElement("img",{className:"thumbnail",src:t.url,width:t.width,height:t.height,alt:""}),n.default.createElement("span",{className:"duration"},(0,a.formatDuration)(e.item.duration))),n.default.createElement("div",{className:"info-container"},n.default.createElement("p",{className:"title"},e.item.title),n.default.createElement("p",{className:"channel-title"},e.item.channelTitle),n.default.createElement("span",{className:"views"},i.default.textN("edit_form.youtube.view_count",e.item.viewCount,i.default.formatNumber(e.item.viewCount))),n.default.createElement("span",{className:"published-at"},i.default.deltaDatetime(e.item.publishedAt))))}},8033:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.YouTubeSidebar=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=f(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),i=p(r(20996)),a=r(41960),o=r(46171),s=p(r(70881)),l=r(90381),d=r(82523),u=p(r(9825)),c=r(95594);function p(e){return e&&e.__esModule?e:{default:e}}function f(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(f=function(e){return e?r:t})(e)}t.YouTubeSidebar=()=>{const{videos:e,selectedVideoIds:t,error:r,isInitial:p,isLoading:f,search:h,loadMore:m,toggleVideoSelection:g,insertVideo:v,insertVideos:b}=(0,d.useYouTubeVideoSearch)(20),y=(0,n.useCallback)(((e,t)=>{"RET"===(0,a.keyString)(e)&&(e.preventDefault(),g(t))}),[g]);return n.default.createElement("div",{className:"editor-youtube-content"},n.default.createElement("div",{className:"editor-youtube-header"},n.default.createElement("h2",null,i.default.text("edit_form.youtube")),n.default.createElement(s.default,{placeholder:i.default.text("edit_form.youtube.placeholder"),onSubmit:h})),n.default.createElement("div",{className:"editor-youtube-main"},n.default.createElement(o.InfiniteScroll,{onScroll:m,interval:1e3},n.default.createElement("div",{className:"editor-youtube-items"},p&&n.default.createElement("div",{className:"editor-youtube-items-message"},i.default.text("edit_form.youtube.description")),e&&e.map((e=>n.default.createElement(c.Item,{key:e.id,item:e,isSelected:t.includes(e.id),onClick:()=>g(e.id),onDoubleClick:()=>v(e),onKeyPress:t=>y(t,e.id)}))),!(p||f||r)&&0===e.length&&n.default.createElement("div",{className:"editor-youtube-items-message"},i.default.text("edit_form.youtube.not_found")),f&&n.default.createElement(l.LoadingIndicator,null),r&&n.default.createElement("div",{className:"editor-youtube-items-message"},i.default.text("edit_form.youtube.failed_to_fetch"),n.default.createElement("br",null),i.default.text("edit_form.youtube.failed_to_fetch_details")," ",n.default.createElement("a",{href:"https://www.youtube.com/",target:"_blank"},i.default.text("edit_form.youtube.go_to_youtube")))))),n.default.createElement("div",{className:"editor-sidebar-youtube_footer"},n.default.createElement(u.default,{disabled:0===t.length,onClick:b})))}},13334:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.searchVideos=void 0;var n,i=(n=r(347))&&n.__esModule?n:{default:n};t.searchVideos=async(e,t,r)=>i.default.get("/api/youtube/search",{params:{query:e,page_size:t,page_token:r},responseType:"json"}).then((e=>({videos:e.data.videos.map((e=>({...e,channelTitle:e.channel_title,publishedAt:new Date(e.published_at),viewCount:e.view_count}))),nextPageToken:e.data.next_page_token})))},82523:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useYouTubeVideoSearch=void 0;var n=r(67294),i=r(13334),a=r(13297);t.useYouTubeVideoSearch=e=>{const[t,r]=(0,n.useState)(""),[o,s]=(0,n.useState)([]),l=(0,n.useRef)(new Set),[d,u]=(0,n.useState)([]),[c,p]=(0,n.useState)(null),[f,h]=(0,n.useState)(!0),[m,g]=(0,n.useState)(!1),v=(0,n.useRef)(null),b=(0,n.useCallback)((t=>{r(t),h(!1),g(!0),s([]),u([]),p(null),(0,i.searchVideos)(t,e).then((e=>{v.current=e.nextPageToken,g(!1),s(e.videos),l.current=new Set(e.videos.map((e=>e.id))),p(null)})).catch((e=>{g(!1),p(e)}))}),[e]),y=(0,n.useCallback)((()=>{v.current&&!m&&(g(!0),(0,i.searchVideos)(t,e,v.current).then((e=>{v.current=e.nextPageToken,g(!1),s((t=>{const r=e.videos.filter((e=>!l.current.has(e.id)));for(const e of r)l.current.add(e.id);return t.concat(r)})),p(null)})).catch((e=>{g(!1),p(e)})))}),[m,t,e]),_=(0,n.useCallback)((e=>{(0,a.insertVideo)(e)}),[]),w=(0,n.useCallback)((()=>{(0,a.insertVideos)(o,d),u([])}),[o,d]);return{videos:o,selectedVideoIds:d,error:c,isInitial:f,isLoading:m,search:b,loadMore:y,toggleVideoSelection:e=>{u((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]))},insertVideo:_,insertVideos:w}}},84525:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.YouTube=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n},a=r(73380),o=r(8033);t.YouTube=class{constructor(e){(0,a.safeRender)(i.default.createElement(o.YouTubeSidebar,null),e)}}},13297:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.insertVideos=t.insertVideo=void 0;var n,i=(n=r(66419))&&n.__esModule?n:{default:n},a=r(57525),o=r(10714);const s=e=>{const t=`https://www.youtube.com/watch?v=${e.id}`,r=`https://www.youtube.com/embed/${e.id}?enablejsapi=1`;return`<iframe src="${i.default.escape(r)}" width="560" height="315" frameborder="0" allowfullscreen></iframe><br><a href="${i.default.escape(t)}">www.youtube.com</a>`};t.insertVideo=e=>{const t=[s(e)];o.EditorConnector.insertLines({html:t,hatena:t,markdown:t}),a.YouTubeEmbed.updatePlayers()};t.insertVideos=(e,t)=>{const r={};for(const t of e)r[t.id]=t;const n=t.map((e=>s(r[e])));o.EditorConnector.insertLines({html:n,hatena:n,markdown:n}),a.YouTubeEmbed.updatePlayers()}},77102:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Dropdown=void 0;var n,i=(n=r(65311))&&n.__esModule?n:{default:n};const a=(0,i.default)("<div>").css({position:"fixed",top:0,left:0,width:"100%",height:"100%"});a.hide().appendTo(document.body),a.on("click",(e=>{a.hide();const t=document.elementFromPoint(e.pageX,e.pageY);null!==t&&(0,i.default)(t).click()}));t.Dropdown=class{constructor(e,t){this.$element=e,this.$window=t,this.bindEvents()}bindEvents(){const e=()=>{this.$window.hide(),a.off("click",e)};this.$element.on("click",(t=>{t.preventDefault(),this.setPosition(),a.show(),this.$window.show(),a.on("click",e)})),this.$window.on("click",(()=>{this.$window.hide(),a.hide()}))}setPosition(){const e=this.$element[0].getBoundingClientRect();this.$window.css({top:e.bottom,left:e.left})}}},79751:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Editor=void 0;var n=r(17187),i=F(r(65311)),a=F(r(80129)),o=F(r(66419)),s=r(78754),l=r(10714),d=r(70879),u=F(r(83092)),c=U(r(55992)),p=F(r(20996)),f=r(41960),h=r(42225),m=r(57833),g=r(43265),v=r(19864),b=F(r(64722)),y=r(73861),_=r(30189),w=r(48357),E=r(22117),S=r(30871),C=r(89172),P=r(7902),k=F(r(42585)),O=U(r(35961)),M=r(40555),x=F(r(20246)),j=r(84525),$=r(77102),T=r(98960),I=r(85387),D=r(48881),N=r(82068),L=r(50287),A=r(56173),R=r(71412);function B(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(B=function(e){return e?r:t})(e)}function U(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=B(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}return n.default=e,r&&r.set(e,n),n}function F(e){return e&&e.__esModule?e:{default:e}}const W=r(59662),H=r(91269),z=r(55540),q=r(20489),G=r(83902),V=r(31427),K=r(52570),Q=r(72069),Y=r(90036),J=r(86795),X=r(35227),Z=r(16907),ee=r(84540),te=r(72461),re=s.z.array(s.z.object({groupId:s.z.string(),groupTitle:s.z.string(),imageUrl:s.z.string().url()}));class ne extends n.EventEmitter{constructor(e){super(),this.URLPattern=/^https?:\/\/\S+$/;const t=Math.random().toString(32).substring(2);this.id=`editor-${t}`,this.$form=(0,i.default)(e),this.$editor=(0,i.default)("#editor"),this.$title=this.$form.find('[name="title"]'),this.$body=this.$form.find('textarea[name="body"]'),this.$tabs=this.$form.find(".tabs"),this.$toolbar=this.$form.find(".toolbar"),this.$subToolbar=this.$form.find(".toolbar-sub"),this.$preview=this.$form.find("#preview"),this.$buttons=this.$form.find(".buttons"),this.$entryId=this.$form.find('input[name="entry"]'),this.$syntax=this.$form.find("#syntax"),this.$publicationType=this.$form.find('input[name="publication_type"]'),this.mode=this.$form.find('[name = "syntax"]').val(),this.actions=h.actionsMap[this.mode],this.isSavingDraft=!1,this.$editarea=(0,i.default)('<div class="editarea"></div>').appendTo(this.$body.parent()),this.$editareaHover=(0,i.default)(`\n      <div class="editarea-hover">\n        <div class="editarea-hover-inner">\n          ${p.default.text("epic.editarea.hover")}\n        </div>\n      </div>\n    `.trim()).appendTo(this.$editarea),this.on("initialize",(()=>{this.backup=(0,L.createBackupMessage)(this.$form,this.$editarea,this),this.$form.on("backup-save",(()=>{this.trigger("change")}))})),this.toolbarEnabled&&N.Toolbar.init(this.$toolbar,this.$subToolbar,this),this.tabs=new u.default(this.$tabs),this.$tabs.on("tabsactivate",((e,t)=>{const r=t.newPanel.attr("id");/preview/.test(r)?this.$title.hide():this.$title.show()})),this.shareDraft=new I.ShareDraft(this),this.preview=new T.Preview(this),this.setupPreviewDropdown(),this.syntaxSwitcher=new D.SyntaxSwitcher(this.$editor.find(".js-syntax-switcher"),this.$editor.find(".js-select-dropdown-window-syntax"),this),this.footer=new v.Footer(this),this.setupSidebar(),O.init(document.querySelector("#promotion")),(0,i.default)(window).on("resize",o.default.throttle((()=>{this.emit("resize"),this.setHeight()}),50)),this.on("resizeRequired",(()=>this.setHeight())),this.setHeight(),W.isIE&&this.setupRestoreFocus(),this.$form.on("keydown",(e=>{this.handleSaveShortcutKeydown(e)})),l.EditorConnector.registerCurrentEditor(this)}handleSaveShortcutKeydown(e){const t=W.isMac?"W-s":"C-s";(0,f.keyString)(e)===t&&(e.preventDefault(),this.emit("saveShortcutKeydown"))}get toolbarEnabled(){return!0}get syntaxForInsertLines(){return this.mode}getTitle(){return this.$title.val()}setTitle(e){return this.$title.val(e)}getBody(){return this.$body.val()}getDateTime(){return this.$form.find('[name="datetime"]').val()}getAuthorName(){return this.$form.data("authorName")}getCategories(){return this.$form.find('input[name="category"]').get().map((e=>e.value))}getCategoriesAsParamsArray(){return this.getCategories().map((e=>({name:"category",value:`${e}`})))}getOgDescription(){return this.$form.find('textarea[name="og_description"]').val()}getSyntax(){return this.$syntax.val()}getPublicationType(){return this.$publicationType.val()}getLayout(){return this.$form.find(':input[name="layout"]:checked').val()}getCustomUrl(){return this.$form.find('input[name="customurl"]').val()}getProfileCardUuids(){return this.$form.find('input[name="profile_card"]').get().map((e=>e.value))}getProfileCardsAsParamsArray(){return this.getProfileCardUuids().map((e=>({name:"profile_card",value:e})))}getKotobaTagNames(){return this.$form.find('input[name="kotoba_tag_name"]').get().map((e=>e.value))}getKotobaTagNamesAsParamsArray(){return this.getProfileCardUuids().map((e=>({name:"kotoba_tag_name",value:e})))}getEntryId(){return this.$entryId.val()}setEntryId(e){if(!this.getEntryId()){const t=document.createElement("a");t.href=location.href;const r=a.default.parse(location.search.substring(1));r.entry=e,t.search=a.default.stringify(r);const n=t.href;history.replaceState(history.state,document.title,n)}this.$entryId.val(e)}setBackupId(e){this.$form.attr("data-backup-id",e)}handleImagePasteEvent(e){const t="clipboardData"in e?e.clipboardData:e.originalEvent?.clipboardData;if(!t)return!1;if(t.getData("text/plain"))return!1;if(t.types&&t.types.length>0&&"image/tiff"===t.types[1])return e.preventDefault(),e.stopPropagation(),!1;const r=t.items,n=[];for(const e in r){const t=r[e];if("file"===t.kind){const e=t.getAsFile(),r=e.type.split(/\//)[1],i=new File([e],`a.${r}`);n.push(i)}}return n.length>0&&(this.sidebar.openByType("editor-fotolife"),(0,i.default)(document).trigger("uploadDroppedFiles",[n]),e.preventDefault(),e.stopPropagation(),!0)}getAllInputData(){const e=[];return this.$form.find("input[name], textarea[name]").each(((t,r)=>{const n=r;if("submit"!==n.type)if("checkbox"===n.type){if(!n.checked)return;e.push({name:n.name,value:n.value})}else if("radio"===n.type){if(!n.checked)return;e.push({name:n.name,value:n.value})}else e.push({name:n.name,value:n.value})})),e}invokeAction(e,t){try{(0,d.LOG)(`invokeAction: ${e}`),this.trigger("actionbefore",{action:e}),this.actions[e].call(this,t),this.trigger("actionafter",{action:e})}catch(e){(0,d.BUG)(e)}}bind(e,t){this.$form.on(`editor.${e}`,t)}unbind(e,t){this.$form.off(`editor.${e}`,t)}bindOnce(e,t){this.$form.one(`editor.${e}`,t)}trigger(e,t){this.$form.trigger(`editor.${e}`,t)}getCharacterCount(){return this.$body.val().length}getByteCount(){const e=this.$body.val();return encodeURIComponent(e).replace(/%../g,"x").length}setupRestoreFocus(){let e=null;setInterval((()=>{this.isFocused()&&(e=this.getSelectionRange())}),100),(0,i.default)("#editor-support-container, .curation-tab-contents, .toolbar").on("click",(t=>{(0,i.default)(t.target).is("textarea, :text")||(this.focus(),e&&this.setSelectionRange(e))}))}setupPreviewDropdown(){const e=this.$tabs.find(".js-preview-dropdown"),t=this.$editor.find(".js-select-dropdown-window-preview");this.previewDropdown=new $.Dropdown(e,t)}setupSidebar(){this.sidebar=new g.EditorSidebar(this);const e=(0,i.default)("#edit-form");(0,i.default)("#editor-beginner").length>0&&this.sidebar.emit("openByType","editor-beginner");const t=document.querySelector("#editor-announcement");if(t){(0,R.renderAnnouncement)(t,!1);const{hasBeenRead:e,markAsRead:r}=(0,R.annoucementHasBeenRead)();e||(this.sidebar.emit("openByType","editor-announcement"),r())}if(new E.Home({container:(0,i.default)("#editor-home"),sidebar:this.sidebar}),new G(e),new A.EntryOption(e,this,this.sidebar),new z({container:(0,i.default)("#editor-amazon-search"),sidebar:this.sidebar}),new J({container:(0,i.default)("#editor-hatena-bookmark"),sidebar:this.sidebar}),new b.default({editor:this,sidebar:this.sidebar,container:(0,i.default)("#editor-fotolife")}),new C.Paint({editor:this,sidebar:this.sidebar,container:(0,i.default)("#editor-paint")}),(0,i.default)("#editor-itunes.enabled").get(0)){new X({container:(0,i.default)("#editor-itunes"),sidebar:this.sidebar}).requestLoadItems()}(0,i.default)("#editor-archive.enabled").get(0)&&q.init(document.querySelector("#editor-archive")),(0,i.default)("#editor-snippet").get(0)&&x.default.init(document.querySelector("#editor-snippet"),this);const r=document.querySelector("#editor-group-banner"),n=H.get("editor.group.group"),a=re.safeParse(n);if(r&&a.success&&new w.GroupBanner(r,a.data.map((e=>({...e,imageUrl:new URL(e.imageUrl)})))),document.querySelector('#editor-home .service[data-service-id="profile-card"]')&&k.default.init(document.querySelector("#editor-profile-card")),(0,i.default)("#editor-instagram.enabled").get(0)){new S.Instagram({editor:this,container:(0,i.default)("#editor-instagram"),sidebar:this.sidebar}).requestLoadItems()}if((0,i.default)("#editor-evernote.enabled").get(0)){new V({editor:this,sidebar:this.sidebar,container:(0,i.default)("#editor-evernote")}).requestLoadItems()}if((0,i.default)("#editor-pixiv.enabled").get(0)){new P.Pixiv({editor:this,container:(0,i.default)("#editor-pixiv"),sidebar:this.sidebar}).requestLoadItems()}const o=document.querySelector("#editor-google-picker.enabled");o&&new y.GooglePhotos({editor:this,sidebar:this.sidebar,container:(0,i.default)(o)});const s=document.querySelector("#editor-google-picker-import-notice");s&&new _.GooglePickerImportNotice(this,s,"google-picker-import-notice");const l=document.querySelector("#editor-google-picker-import-confirmation-notice");l&&new _.GooglePickerImportNotice(this,l,"google-picker-import-confirmation-notice");new Z({editor:this,sidebar:this.sidebar,container:(0,i.default)("#editor-miil")}).requestLoadItems();new Y({container:(0,i.default)("#editor-gourmet"),sidebar:this.sidebar}).requestLoadItems(),new ee({editor:this,container:(0,i.default)("#editor-nicovideo")});new Q({editor:this,sidebar:this.sidebar,container:(0,i.default)("#editor-gist")}).requestLoadItems();new te({container:(0,i.default)("#editor-quote"),sidebar:this.sidebar}).requestLoadItems(),K.init({container:document.querySelector("#editor-flickr"),sidebar:this.sidebar});const u=document.querySelector("#editor-rakuten");u?this.rakuten=new M.Rakuten(u):(0,d.BUG)("Rakuten container has no elements");const c=document.querySelector("#editor-dazn");c?new m.Dazn({container:c}):(0,d.BUG)("Dazn container has no elements");const p=document.querySelector("#editor-youtube");p&&new j.YouTube(p)}saveDraft(e){if(this.isSavingDraft)return i.default.Deferred().reject();this.isSavingDraft=!0;const t=this.getAllInputData();t.push({name:"draft",value:!0}),e&&t.push({name:"without_preview_token",value:1});const r=c.protocolRelativeAdminUserBlogUrl("/draft");return this.emit("savingDraft"),i.default.ajax({url:r,type:"POST",dataType:"json",data:t}).done((e=>{this.setEntryId(e.uuid),this.setBackupId(e.backup_id),this.emit("saveDraft")})).fail((()=>{this.emit("prepareSavingDraft"),window.alert(p.default.text("edit_form.failed_to_save_draft"))})).always((()=>{this.isSavingDraft=!1}))}}t.Editor=ne},35541:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HTMLEditor=void 0;var n=p(r(65311)),i=p(r(66419)),a=r(70879),o=r(55992),s=p(r(20996)),l=r(41960),d=r(79751),u=r(21650),c=r(46613);function p(e){return e&&e.__esModule?e:{default:e}}const f=r(59662);class h extends d.Editor{constructor(e){super(e),this.source=this.$tabs.find("#source"),this.isTinymceInitialized=!1,this.tinymceInitialized=new Promise((e=>{this.resolveTinymceInitialized=e})),this.initWYSIWYG(),this.initAce(),this.currentTab="wysiwyg",this.isIMEComposing=!1,this.$tabs.on("tabsactivate",((e,t)=>{const r=t.newPanel.attr("id");this.currentTab=r,/source/.test(r)?(setTimeout((()=>{this.ace.resize(),this.ace.focus()}),0),this.writeBack(),this.setValue(this.$body.val()),this.syntaxSwitcher.disable()):/preview/.test(r)?(this.writeBack(),this.preview.updatePreview(),this.syntaxSwitcher.disable()):(this.setValue(this.$body.val()),this.tinymce.focus(),this.syntaxSwitcher.enable()),this.setHeight()})),this.bind("actionafter",(()=>{this.writeBack()})),this.$form.bind("backup-restore",(()=>{this.setValue(this.$body.val())}))}initWYSIWYG(){this.$editarea.show(),this.$body.appendTo(this.$editarea);const e=`?v=${tinymce.majorVersion}.${tinymce.minorVersion}${(0,o.versionParameter)()?`&${(0,o.versionParameter)()}`:""}`;document.body.focus(),tinymce.init({...c.TINY_MCE_CONFIGS,selector:`#${this.$body.attr("id")}`,body_class:"preview mce-inner-body",height:"100%",width:"100%",content_css:(0,o.staticUrl)("/css/editor-wysiwyg.css"),cache_suffix:e,paste_preprocess:(e,t)=>{this.onPastePreProcess(t)},setup:e=>{this.onTinymceSetup(e)},init_instance_callback:e=>{this.onTinymceInitialize(e)}})}onPastePreProcess(e){const t=e.content.replace(/^[\s]*/,"").replace(/[\s]*$/,"");if(t.match(this.URLPattern)){const t=e.content;this.emit("paste-url",t),e.content="",e.preventDefault(),e.stopPropagation()}t.match(/^(<[^>]+?>)+\[:contents\](<\/[^<]+?>)+$/)&&(e.content="[:contents]")}onTinymceSetup(e){this.tinymce=e,e.on("submit",(e=>{const t=this.tinymce.getContent();let r=t;(0,n.default)("<iframe><p></p></iframe>").html().match(/&lt;/)&&(r=this.unescapeEntities(r),r||(r=t)),(0,n.default)('<input type="hidden" name="unescaped_body"/>').val(r).appendTo(e.target)})),e.on("keydown",(e=>{this.handleSaveShortcutKeydown(e)})),this.tinymce.on("KeyUp",(e=>{const t=(0,l.keyString)(e);"RET"===t?this.newLine(e):"BS"===t&&this.backspace(e)})),this.tinymce.on("KeyUp",(()=>{this.writeBack(),this.trigger("change")}))}onTinymceInitialize(e){this.isIMEComposing=!1,(0,n.default)(this.tinymce.getBody()).on("compositionstart",(()=>{this.isIMEComposing=!0})).on("compositionend",(()=>{this.isIMEComposing=!1})),this.$editarea.find(".mce-edit-area").css({display:"block",width:"100%","min-height":"100%","border-width":"0px"}),this.editorHTMLElement=(0,n.default)(this.tinymce.getDoc()).find("html").eq(0),this.editorHTMLElement.css({height:"100%"}),this.setHeight();const t=(0,n.default)("<div>"),r=(0,n.default)("<a>");e.parser.addNodeFilter("iframe",(e=>{e.forEach((e=>{const n=e.attr("src");if(!n)return;const i=t.html(n).text(),a=r.attr("href",i)[0].protocol;if("javascript:"===a||"data:"===a){const t=`ignored:${n}`;e.attr("src",t)}}))})),e.parser.addNodeFilter("div",(e=>{e.forEach((e=>{e.attr("class")&&e.attr("class").match(/\bfreezed\b/)&&e.attr("contenteditable","false")}))})),e.serializer.addNodeFilter("div",(e=>{e.forEach((e=>{e.attr("class")&&e.attr("class").match(/\bfreezed\b/)&&e.attr("contenteditable",null)}))})),e.serializer.addNodeFilter("script",(e=>{e.forEach((e=>{const t=e.attr("type"),r=t&&t.match(/\bjson\b/),n=e.firstChild?e.firstChild.value:"";r&&n.length>0&&(e.firstChild.value=(e=>e.replace(/^\/\/ <!\[CDATA\[/,"").replace(/\/\/ \]\]>$/,""))(n))}))})),this.initDropper(),this.addKeyboardShortcuts(e),this.emit("initialize"),this.isTinymceInitialized=!0,this.resolveTinymceInitialized()}addKeyboardShortcuts(e){for(let t=1;t<=6;t++)["meta","ctrl"].forEach((r=>{e.addShortcut(`${r}+${t}`,"",["FormatBlock",!1,`h${t}`])}))}initDropper(){if(f.isIE&&!f.isIE11)return;let e=!1;const t=i.default.debounce((()=>{e||this.$editareaHover.addClass("dragging")}),20),r=()=>{this.$editareaHover.removeClass("dragging")},a=e=>{if(this.$editareaHover.removeClass("dragging"),(e=>e.dataTransfer.files.length>0)(e))this.sidebar.openByType("editor-fotolife"),u.Uploader.uploadDroppedFiles(e);else{const t=e.dataTransfer?.getData("Text").trim()||"";t.match(this.URLPattern)&&this.emit("paste-url",t)}},o=e=>{e.stopPropagation(),e.preventDefault()};let s=null;const l=()=>{null!==s&&(clearTimeout(s),s=null)};let d=!1;const c=(0,n.default)(this.tinymce.getDoc()),p=this.ace.container;c.add(p).on("dragstart",(()=>{e=!0})).on("dragend",(()=>{e=!1})).on("dragenter",(r=>{if(e)return;if(null!==s)return void l();if(d)return;d=!0;const n=r.originalEvent;o(n),t()})).on("dragenter","*",(r=>{if(e)return;if(null!==s)return void l();if(d)return;d=!0;const n=r.originalEvent;o(n),t()})).on("dragover",(t=>{if(e)return;if(null!==s)return void l();const r=t.originalEvent;o(r)})).on("dragleave",(t=>{e||(l(),s=window.setTimeout((()=>{d=!1,r()}),50))})).on("drop",(t=>{if(e)return;d=!1;const r=t.originalEvent;o(r),a(r)})).on("paste",(e=>{this.handleImagePasteEvent(e)}))}execCommand(e,t){this.isTinymceInitialized?(this.tinymce&&this.tinymce.execCommand(e,!1,t),this.writeBack()):this.tinymceInitialized.then((()=>{this.execCommand(e,t)})).catch((e=>{(0,a.BUG)(e)}))}newLine(e){const t=this.tinymce.getDoc(),r=this.tinymce.selection,i=r.getNode(),a=(0,n.default)(i).closest("div.hatena-embed")[0];if(a){let n=a.nextSibling;n&&"p"===n.nodeName.toLowerCase()||(n=t.createElement("p"),n.appendChild(t.createElement("br")),a.parentNode.insertBefore(n,a.nextSibling));const i=r.getRng();i.setStart(n,0),i.setEnd(n,0),r.setRng(i),e.preventDefault()}}backspace(e){const t=this.tinymce.getDoc(),r=this.tinymce.selection,i=r.getNode(),a=(0,n.default)(i).closest("div.hatena-embed")[0];if(a){const n=a.previousSibling||t.body,i=r.getRng();i.selectNodeContents(n),i.collapse(!1),r.setRng(i),e.preventDefault(),a.parentNode.removeChild(a)}}initAce(){const e=document.createElement("div");(0,n.default)(e).css({position:"absolute",height:"100%",width:"100%",padding:"0px",margin:"0px"}),this.source.append(e);const t=ace.edit(e);t.commands.removeCommand("gotoline"),t.commands.removeCommand("indent"),t.commands.removeCommand("outdent"),t.commands.removeCommand("find"),t.renderer.setShowGutter(!1),t.renderer.setHScrollBarAlwaysVisible(!1),t.renderer.setPadding(5),t.renderer.setShowPrintMargin(!1),t.setHighlightActiveLine(!1);const r=new(0,ace.require("ace/mode/html").Mode);r.$modes["js-"].$behaviour.remove("braces"),r.$modes["js-"].$behaviour.remove("parens"),r.$modes["js-"].$behaviour.remove("string_dquotes");const i=t.getSession();i.setMode(r),i.setUseWrapMode(!0),i.setUseWorker(!1),i.setValue(this.$body.val()),i.on("change",(()=>{const e=i.getValue();this.$body.val(e),this.tinymce&&this.tinymce.setContent(e)})),t.$blockScrolling=1/0,this.ace=t}setHeight(){this.currentTab=this.currentTab||"wysiwyg";const e=(0,n.default)(window).height()-this.$buttons.outerHeight(),t=(0,n.default)(`#${this.currentTab}`).offset().top;this.$editarea.height(e-this.$editarea.offset().top),this.$preview.height(e-t-2);(this.source||(0,n.default)("#source")).height(e-t-2)}focus(){this.writeBack(),this.tinymce&&this.tinymce.focus()}getSelectionRange(){return this.tinymce.selection.getRng()}setSelectionRange(e){0===e.start&&0===e.end?this.tinymce.selection.setCursorLocation():this.tinymce.selection.setRng(e)}isFocused(){return(0,n.default)(document.activeElement).is("#body_ifr")}setValue(e){const t=this.unescapeEntities(e);this.$body.val(t),this.execCommand("mceSetContent",t),this.ace.getSession().setValue(t)}unescapeEntities(e){let t=e;return["style","script","xmp","iframe","noembed","noframes","plaintext","noscript"].forEach((e=>{t=t.replace(new RegExp(`<${e}(.*?)>(.*?)<\\/${e}>`,"g"),((t,r,n)=>{const i=n.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&amp;/g,"&");return`<${e}${r}>${i}</${e}>`}))})),t}insert(e){switch(this.currentTab){case"wysiwyg":this.execCommand("mceInsertContent",e);break;case"source":this.ace.insert(e);break;default:window.alert(s.default.text("edit_form.cannot_insert_in_preview_tab"))}}insertLines(e){const t=e.map((e=>/^<(p|div)\b[^>]*?>/.test(e)?e:`<p>${e}</p>`));this.insert(t.join(""))}getCharacterCount(){const e=this.tinymce.getBody();let t=void 0===e.textContent?e.innerText:e.textContent;return t=t.replace(/\s+/g," "),t.length}insertAndSelectText(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length;const n=this.tinymce.selection.getRng(),i=this.tinymce.getDoc().createTextNode(e);n.insertNode(i),n.setStart(i,t),n.setEnd(i,r),this.tinymce.selection.setRng(n)}writeBack(){this.isIMEComposing||this.tinymce&&this.tinymce.save()}isCollapsed(){return this.tinymce.selection.isCollapsed()}getSelectionText(){return this.tinymce.selection.getContent()}getSelectionSource(){return this.tinymce.selection.getContent()}createLink(e){this.tinymce.execCommand("CreateLink",!1,e)}formatBlock(e){const t=this.tinymce.selection.getNode();"body"!==t.tagName.toLowerCase()&&this.tinymce.selection.select(t),"p"!==e&&this.execCommand("FormatBlock","p"),this.execCommand("FormatBlock",e)}replace(e){this.tinymce.selection.setContent(e)}moveCaretToNodeEnd(e){this.tinymce.selection.select(e),this.tinymce.selection.collapse(!1)}insertBlockQuoteWithNewLine(){if(this.tinymce.selection.isCollapsed()){this.insert("<blockquote><p>&nbsp;</p></blockquote><p>&nbsp;</p>");const e=(0,n.default)(this.tinymce.selection.getNode()).prev("blockquote").find("p")[0];this.tinymce.selection.setCursorLocation(e,0)}else{this.insert(`<blockquote><p>${this.tinymce.selection.getContent()}</p></blockquote><p>&nbsp;</p>`);const e=(0,n.default)(this.tinymce.selection.getNode()).prev("blockquote")[0];this.tinymce.selection.select(e)}}formatBlockQuote(){if(f.isIE&&this.tinymce.selection.isCollapsed()){const e=this.tinymce.selection.getNode();this.tinymce.selection.select(e)}this.execCommand("mceBlockQuote")}}t.HTMLEditor=h},31643:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HatenaEditor=void 0;var n=r(70879),i=r(79751),a=r(38712),o=r(13994),s=r(21650),l=u(r(65311)),d=u(r(66419));function u(e){return e&&e.__esModule?e:{default:e}}const c=r(59662),p=r(19165);class f extends i.Editor{constructor(e){super(e),this.$body.attr("style","position: absolute; height: 100%; width: 100%; padding: 0; margin: 0"),this.$body.appendTo(this.$editarea),this.currentTab="textarea",this.$tabs.on("tabsactivate",((e,t)=>{const r=t.newPanel.attr("id");this.currentTab=r,/preview/.test(r)&&!this.preview.isOpeningWindow()?(this.preview.updatePreview(),this.syntaxSwitcher.disable()):(setTimeout((()=>{this.focus()}),0),this.syntaxSwitcher.enable()),this.setHeight()})),this.bind("actionafter",(()=>{this.focus()}));const t=this.$form.find("#realtime-preview"),r=this.$form.find("#realtime-preview-button"),i=this.$form.find("#realtime-preview-placeholder");this.$editarea.append(t).append(r).append(i),this.realtimePreview=new a.RealtimePreview(this,t,i),p.load("does-show-realtime-preview")&&this.showRealtimePreview(),r.click((()=>{t.is(":visible")?this.hideRealtimePreview():this.showRealtimePreview()})),this.setHeight(),this.$body.on("input propertychange",(()=>{this.trigger("change")})),this.$body.on("paste",(e=>{try{if(this.handleImagePasteEvent(e))return e.preventDefault(),void e.stopPropagation()}catch(e){(0,n.BUG)(e,"upload pasted image filed(hatena or markdown)")}const t=e.originalEvent,r=(t.clipboardData?t.clipboardData.getData("text/plain"):window.clipboardData.getData("text")).replace(/^[\s]*/,"").replace(/[\s]*$/,"");if(r.match(this.URLPattern)&&!this.onInsertingLink()){const t=r;return this.emit("paste-url",t),e.preventDefault(),void e.stopPropagation()}})),this.initDropper(),d.default.defer((()=>{this.emit("initialize")}))}setHeight(){this.currentTab=this.currentTab||"textarea";const e=(0,l.default)(window).height()-this.$buttons.outerHeight(),t=(0,l.default)(`#${this.currentTab}`).offset().top;this.$editarea.height(e-this.$editarea.offset().top),this.$preview.height(e-t-2),this.emit("resize")}focus(){this.$body.focus()}isFocused(){return this.$body.is(":focus")}setValue(e){this.$body.val(e)}getTextArea(){return this.$body[0]}getSelectionRange(){const e=this.getTextArea();return{start:e.selectionStart,end:e.selectionEnd}}setSelectionRange(e){this.getTextArea().setSelectionRange(e.start,e.end)}getSelectionText(e){return e=e||this.getSelectionRange(),this.$body.val().substring(e.start,e.end)}getSelectionSource(){return this.getSelectionText()}isCollapsed(){const e=this.getSelectionRange();return e.start===e.end}getCharacterAtCursor(){const e=this.getSelectionRange();return this.$body.val()[e.start-1]}onInsertingLink(){return d.default.include(["[",">",'"'],this.getCharacterAtCursor())}createLink(e){const t=this.getSelectionRange(),r=this.getSelectionText(),n=r.match(/\n/)?`<a href="${d.default.escape(e)}">${r}</a>`:`[${e}:title=${r}]`,i=this.replace(n,t);this.setSelectionRange(i)}replace(e,t){return t=t||this.getSelectionRange(),this.replaceInternally(e,t),this.$body.trigger("input"),{start:t.start,end:t.start+e.length}}getSelectionBlock(){const e=this.getSelectionRange(),t=this.$body.val();return new o.SelectionTextBlock(t,e)}setSelectionBlock(e){const t=e.getRange(),r=e.getBlockText();this.replaceInternally(r,t),this.setSelectionRange(e.getSelectionRange()),this.$body.trigger("input")}insert(e){const t=this.getSelectionRange(),r={start:t.end,end:t.end};return this.replaceInternally(e,r),this.setSelectionRange({start:t.end+e.length,end:t.end+e.length}),this.$body.trigger("input"),{start:t.end,end:t.end+e.length}}replaceInternally(e,t){const r=this.getTextArea(),n=r.scrollTop,i=r.scrollLeft;r.setSelectionRange(t.start,t.end),r.focus();let a=!1;try{a=document.execCommand("insertText",!1,e)}catch(e){}if(!a){const n=r.value;r.value=n.substring(0,t.start)+e+n.substring(t.end)}r.scrollTop=n,r.scrollLeft=i}insertLines(e){const t=this.getSelectionRange(),r=this.$body.val()[t.start-1];let n="";"\n"===r||void 0===r||(n="\n"),this.insert(`${n+e.join("\n")}\n`)}modifyCurrentLine(e){const t=this.getSelectionRange(),r=this.$body.val().split(/\r?\n/);let n=0;const i=r.length;let a=0;for(;i>n&&(a+=r[n].length+1,!(a>t.start));)n++;const o=r[n],s=e(o),l=a-o.length-1,d={start:l,end:l+o.length},u=this.replace(s,d);this.setSelectionRange(u)}wrapString(e,t,r,n){let i,a=this.getSelectionText();return a.startsWith(e)&&a.endsWith(t)?(a=a.substring(e.length,a.length-t.length),i=this.replace(a)):r&&n&&a.startsWith(r)&&a.endsWith(n)?(a=a.substring(r.length,a.length-n.length),i=this.replace(a)):i=this.replace(e+a+t),this.setSelectionRange(i),i}wrapStringAround(e,t){const r=this.getSelectionText();this.wrapString(e,t),0===r.length&&this.moveCaret(e.length)}wrapStringAroundLabel(e,t,r){const n=this.getSelectionText();if(this.wrapStringAround(e,r),0===n.length){const e=this.replace(t);this.setSelectionRange(e)}}headingAction(e){this.modifyCurrentLine((t=>t.replace(/^[*]*(\s+)*/,e)))}moveCaret(e){const t=this.getSelectionRange();t.start+=e,t.end=t.start,this.setSelectionRange(t)}toggleFontSize(e){let t,r=this.getSelectionText();if(/^(<span style="font-size: (\d+)%">)/.test(r)){r=Math.floor(+RegExp.$2)===e?r.replace(RegExp.$1,"").replace(/<\/span>/,""):r.replace(RegExp.$1,`<span style="font-size: ${e}%">`),t=this.replace(r)}else t=this.replace(`<span style="font-size: ${e}%">${r}</span>`);this.setSelectionRange(t)}removeFontSize(){let e,t=this.getSelectionText();/^(<span style="font-size: \d+%">)/.test(t)&&(t=t.replace(RegExp.$1,"").replace(/<\/span>/,""),e=this.replace(t),this.setSelectionRange(e))}showRealtimePreview(){this.$editarea.addClass("realtime-preview"),this.realtimePreview.show(),p.save("does-show-realtime-preview",!0)}hideRealtimePreview(){this.$editarea.removeClass("realtime-preview"),this.realtimePreview.hide(),p.save("does-show-realtime-preview",!1)}initDropper(){if(c.isIE&&!c.isIE11)return;const e=e=>{if((e=>e.dataTransfer.files.length>0)(e))this.sidebar.openByType("editor-fotolife"),s.Uploader.uploadDroppedFiles(e);else{const t=e.dataTransfer.getData("Text").trim();t.match(this.URLPattern)&&this.emit("paste-url",t)}};this.editorTextbox=this.$editarea.find("#body").eq(0);let t=!1,r=!1;const n=e=>{e.stopPropagation(),e.preventDefault()};this.$editarea.on("dragstart",(()=>{r=!0})).on("dragend",(()=>{r=!1})).on("dragenter",(()=>{r||(t=!0,this.$editareaHover.addClass("dragging"))})).on("dragleave",(()=>{r||(t=!1,this.$editareaHover.removeClass("dragging"))})).on("dragover",(e=>{r||(this.$editareaHover.addClass("dragging"),n(e.originalEvent))})).on("drop",(i=>{if(r)return;t=!1,this.$editareaHover.removeClass("dragging");const a=i.originalEvent;n(a),e(a)}))}}t.HatenaEditor=f},34313:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MarkdownEditor=void 0;var n=r(31643),i=r(96486);class a extends n.HatenaEditor{insertLines(e){const t=this.getSelectionRange(),r=this.$body.val().substr(t.start-2,t.start);let n="";"\n\n"===r||""===r||(n=r.match(/\n$/)?"\n":"\n\n"),this.insert(`${n+e.join("\n\n")}\n\n`.replace(/\n+$/,"\n\n"))}headingAction(e){this.modifyCurrentLine((t=>t.replace(/^[#]*(\s+)*/,e)))}createLink(e){const t=this.getSelectionRange(),r=this.getSelectionText();let n;n=r.match(/\n/)?`<a href="${(0,i.escape)(e)}">${r}</a>`:`[${r}](${e})`;const a=this.replace(n,t);this.setSelectionRange(a)}onInsertingLink(){return["(","[",'"'].includes(this.getCharacterAtCursor())}}t.MarkdownEditor=a},98960:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Preview=void 0;var n=s(r(65311)),i=r(19575),a=s(r(57942)),o=s(r(76804));function s(e){return e&&e.__esModule?e:{default:e}}const l=r(36500),d=r(28507);t.Preview=class{constructor(e){this.editor=e,this.previewWindow=null,this.device="pc",this.$wrapper=(0,n.default)("#preview"),this.$closeWindowButton=(0,n.default)("#js-new-window-close-btn"),this.$newWindowDropdown=(0,n.default)(".js-select-dropdown-window-preview"),this.$newWindowButton=(0,n.default)(".js-dropdown-preview-in-new-window"),this.$reloadButton=(0,n.default)(".js-icon-preview-in-new-window-reload"),this.$toggleDevice=(0,n.default)(".editor-preview-device"),this.forcePcView=!!this.$wrapper.data("forcePcView"),this.initEvent()}initEvent(){this.$newWindowButton.on("click",(()=>this.previewInWindow())),this.$reloadButton.on("click",(()=>(this.previewInWindow(),!1))),this.$toggleDevice.on("change",(e=>this.setDevice(e.currentTarget.value)));l.createForParent().addEventListener("close-preview-window",(()=>{this.closePreviewWindow()})),(0,n.default)(window).on("close-preview-window",(()=>{this.closePreviewWindow()}))}isOpeningWindow(){return!!this.previewWindow&&!this.previewWindow.closed}appendPreviewHTML(e){const t=this.editor.getTitle(),r=this.editor.getBody(),o=this.editor.getOgDescription(),s=this.editor.getDateTime(),l=this.editor.getAuthorName(),d=this.editor.getPublicationType(),u=this.editor.getLayout(),c=this.editor.getCustomUrl(),p=(0,i.encode)(r),f={url:"./preview",type:"post",dataType:"json",data:[{name:"title",value:t},{name:"body.base64",value:p},{name:"og_description",value:o},{name:"datetime",value:s},{name:"author_name",value:l},{name:"publication_type",value:d},{name:"layout",value:u},{name:"customurl",value:c},{name:"rkm",value:(0,a.default)("rkm")},{name:"rkc",value:(0,a.default)("rkc")}].concat(this.editor.getCategoriesAsParamsArray()).concat(this.editor.getProfileCardsAsParamsArray()).concat(this.editor.getKotobaTagNamesAsParamsArray())};n.default.ajax(f).done((r=>{const i={title:t,"body.base64":p,og_description:o,datetime:s,author_name:l,publication_type:d,layout:u,customurl:c,device:this.device,syntax:this.editor.getSyntax(),datetime_tz:r.datetime_tz,signature:r.signature,editor_id:this.editor.id,token:r.preview_token,"force-pc-view":this.forcePcView?1:0},a=r.uri+("amp"===this.device?"?amp=1":""),f=(0,n.default)(`<form method='POST' target="${e}" action=${a}/>`);for(const[e,t]of Object.entries(i))(0,n.default)(`<textarea name="${e}"/>`).val(t).appendTo(f);this.editor.getCategories().forEach((e=>{(0,n.default)('<textarea name="category"/>').val(e).appendTo(f)})),this.editor.getProfileCardUuids().forEach((e=>{(0,n.default)('<textarea name="profile_card"/>').val(e).appendTo(f)})),this.editor.getKotobaTagNames().forEach((e=>{(0,n.default)('<textarea name="kotoba_tag_name"/>').val(e).appendTo(f)})),f.appendTo(document.body),f.submit(),f.remove()}))}openPreviewWindow(){const e={width:screen.width/2,height:screen.height,top:0,left:screen.width/2};"touch"!==this.device&&"amp"!==this.device||(e.width=320,e.height=568);const t=`scrollbars=1,${(0,o.default)(e)}`;this.previewWindow=window.open("","hatena-preview-new-window",t),d((()=>this.previewWindow&&this.previewWindow.closed),(()=>this.updateWindowMode())),this.$closeWindowButton.on("click",(()=>{this.previewWindow&&this.previewWindow.close()})),this.updateWindowMode()}previewInWindow(){this.isOpeningWindow()||this.openPreviewWindow(),this.appendPreviewHTML("hatena-preview-new-window"),this.previewWindow&&this.previewWindow.focus()}previewInIframe(){this.$wrapper.toggleClass("is-device-touch","touch"===this.device||"amp"===this.device),this.appendPreviewHTML("hatena-preview-iframe")}closePreviewWindow(){this.isOpeningWindow()&&this.previewWindow&&this.previewWindow.close()}updateWindowMode(){const e=this.isOpeningWindow();this.$wrapper.toggleClass("is-opening-new-window",e),this.$newWindowDropdown.toggleClass("is-opening-new-window",e),this.$reloadButton.toggle(e),e&&this.previewInIframe()}updatePreview(){this.isOpeningWindow()?(this.closePreviewWindow(),this.previewInWindow()):this.previewInIframe()}setDevice(e){this.device=e,this.updatePreview()}}},94114:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RawEditor=void 0;var n=r(31643),i=r(92477),a=r(96486);class o extends n.HatenaEditor{get toolbarEnabled(){return!1}get syntaxForInsertLines(){return"html"}insertLines(e){const t=e.join("\n");this.insert(t)}insert(e){e.match(/^\[/)?(0,i.extractSyntax)(e).done((e=>{super.insert(e.html)})).fail((()=>{super.insert(e)})):super.insert(e)}createLink(e){const t=this.getSelectionRange(),r=this.getSelectionText(),n=`<a href="${(0,a.escape)(e)}">${r}</a>`,i=this.replace(n,t);this.setSelectionRange(i)}onInsertingLink(){return'"'===this.getCharacterAtCursor()}}t.RawEditor=o},38712:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RealtimePreview=void 0;var n=d(r(65311)),i=d(r(57942)),a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=l(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(347)),o=r(55992),s=r(19575);function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(l=function(e){return e?r:t})(e)}function d(e){return e&&e.__esModule?e:{default:e}}t.RealtimePreview=class{constructor(e,t,r){this.$container=t,this.$rpPlaceholder=r,this.$iframes=this.$container.find(".realtime-preview-iframe"),this.isVisible=!1,this.onInput=()=>this._onInput(),this.count=0,this.interval=600,this.timer=window.setTimeout((()=>this.update()),this.interval),this.editor=e,this.$rpPlaceholder.css("z-index","-1")}_onInput(){window.clearTimeout(this.timer),this.timer=window.setTimeout((()=>{this.update()}),this.interval)}show(){this.editor.bind("change",this.onInput),this.isVisible=!0,this.update()}hide(){this.editor.unbind("change",this.onInput),this.isVisible=!1}async update(){if(!this.isVisible)return;const e=(0,n.default)(this.$iframes[this.count%2]);this.count++;const t=(0,n.default)(this.$iframes[this.count%2]),r=this.editor.getBody(),l=(0,n.default)("#syntax").val(),d=(0,s.encode)(r),u=await a.default.post((0,o.protocolRelativeAdminUserBlogUrl)("/preview"),{"body.base64":d,editor_id:this.editor.id,rkm:(0,i.default)("rkm"),rkc:(0,i.default)("rkc")},{transformRequest:a.formDataRequest}),{signature:c,uri_realtime:p,preview_token:f}=u.data,h=(0,n.default)(`<form method="POST" target="realtime-preview-iframe-${this.count%2}"></form>`).attr("action",p);(0,n.default)("<textarea/>").attr("name","body.base64").val(d).appendTo(h),(0,n.default)("<textarea/>").attr("name","syntax").val(l).appendTo(h),(0,n.default)("<textarea/>").attr("name","signature").val(c).appendTo(h),(0,n.default)("<textarea/>").attr("name","editor_id").val(this.editor.id).appendTo(h),(0,n.default)("<textarea/>").attr("name","token").val(f).appendTo(h),this.$iframes.off("load.ajaxsubmit").on("load.ajaxsubmit",(()=>{r.match(/^\s*$/)?this.$rpPlaceholder.css("z-index","1"):this.$rpPlaceholder.css("z-index","-1"),t.css("z-index",1),e.css("z-index",-1)})),h.appendTo(document.body),h.submit(),h.remove()}}},13994:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionTextBlock=void 0;t.SelectionTextBlock=class{constructor(e,t){this.wholeText=e,this.initialRange=t,this.cursorPositionDiff=0,this.selectionRangeDiff={start:0,end:0},[this.linesRange,this.lines]=this.calcLinesRange(e,t)}calcLinesRange(e,t){const r=t.start>0?e.lastIndexOf("\n",t.start-1)+1:0,n=e.indexOf("\n",t.end),i=n>=0?n:e.length;return[{start:r,end:i},e.substring(r,i).split("\n")]}togglePrefix(e,t,r,n){const i=this.lines[0].length,a=this.lines.every((e=>t.test(e)));if(a)this.lines=this.lines.map((e=>e.replace(t,"")));else{this.lines.every((e=>r.test(e)))&&(this.lines=this.lines.map((e=>e.replace(r,"")))),this.lines=this.lines.map((t=>`${e} ${t}`))}this.cursorPositionDiff=this.lines[0].length-i,!a&&n&&this.insertBlankLine()}togglePrefixNumber(e,t,r){const n=this.lines[0].length,i=this.lines.every((t=>e.test(t)));if(i)this.lines=this.lines.map((t=>t.replace(e,"")));else{this.lines.every((e=>t.test(e)))&&(this.lines=this.lines.map((e=>e.replace(t,"")))),this.lines=this.lines.map(((e,t)=>`${t+1}. ${e}`))}this.cursorPositionDiff=this.lines[0].length-n,!i&&r&&this.insertBlankLine()}insertBlankLine(){const[e,t]=this.checkBlankLineBeforeAndAfter();e||(this.lines.unshift(""),this.selectionRangeDiff.start++),t||(this.lines.push(""),this.selectionRangeDiff.end--)}checkBlankLineBeforeAndAfter(){const e=this.wholeText[this.linesRange.start-2],t=this.wholeText[this.linesRange.end+1];return[void 0===e||"\n"===e,void 0===t||"\n"===t]}getRange(){return this.linesRange}getLines(){return this.lines}getBlockText(){return this.lines.join("\n")}getSelectionRange(){if(this.initialRange.start===this.initialRange.end){const e=this.initialRange.start+this.cursorPositionDiff,t=Math.max(e,this.linesRange.start)+this.selectionRangeDiff.start;return{start:t,end:t}}const e=this.getBlockText().length,t=this.linesRange.start;return{start:t+this.selectionRangeDiff.start,end:t+e+this.selectionRangeDiff.end}}}},85387:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShareDraft=void 0;var n,i=(n=r(65311))&&n.__esModule?n:{default:n},a=r(70879),o=r(55992);const s=r(91269);t.ShareDraft=class{constructor(e){this.editor=e,this.$shareButton=(0,i.default)(".js-share-draft-button"),this.$shareBoxWrapper=(0,i.default)(".js-share-draft-box-wrapper"),this.$shareBox=(0,i.default)(".js-share-draft-box"),this.$tokenInput=this.$shareBox.find("input"),this.$closeButton=this.$shareBox.find(".btn-close"),this.$mask=this.$shareBoxWrapper.find(".mask"),this.editorFooterElement=document.querySelector(".js-editor-footer"),this.$shareButton.on("click",(()=>{this.openShareDraftWindow()})),this.$closeButton.on("click",(()=>(this.closeShareDraftWindow(),!1))),this.$mask.on("click",(()=>(this.closeShareDraftWindow(),!1))),this.$draftLabel=(0,i.default)(".js-label-save-draft-and-share-preview"),this.$scheduledLabel=(0,i.default)(".js-label-save-scheduled-and-share-preview"),this.editor.on("toggleScheduledEntry",(e=>{this.toggleIsScheduledLabel(e)}));const t=s.get("editor.entryOption");this.toggleIsScheduledLabel(t.isScheduledEntry)}setWindowPosition(e){this.$shareBox.css(e)}getDraftWindowPositionBottom(){const e=window.getComputedStyle(this.editorFooterElement,null);return`calc(${e.height} + ${e.paddingTop})`}openShareDraftWindow(){this.setWindowPosition({bottom:this.getDraftWindowPositionBottom()}),this.editor.saveDraft().done((e=>{this.$shareBoxWrapper.addClass("visible");const t=e.publication_type,r=e.token,n=(0,o.userBlogUrl)(`/draft/${t}/${r}`);this.$tokenInput.val(n).focus().select()})).fail(((e,t,r)=>{(0,a.BUG)(r,"ShareDraft")}))}closeShareDraftWindow(){this.$shareBoxWrapper.removeClass("visible")}toggleIsScheduledLabel(e){this.$draftLabel.toggle(!e),this.$scheduledLabel.toggle(e)}}},48881:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyntaxSwitcher=void 0;var n=l(r(65311)),i=l(r(66419)),a=r(77102),o=l(r(20996)),s=l(r(1606));function l(e){return e&&e.__esModule?e:{default:e}}const d=r(1514);t.SyntaxSwitcher=class{constructor(e,t,r){this.$syntaxSwitcher=e,this.$dropdownWindow=t,this.editor=r,this.params=(0,s.default)(location.search.slice(1)),this.editor.on("savingDraft",(()=>{this.$syntaxSwitcher.addClass("syntax-switcher-disabled")})),this.params.entry?this.$syntaxSwitcher.addClass("syntax-switcher-disabled"):(this.syntaxSwitcher=new a.Dropdown(this.$syntaxSwitcher,this.$dropdownWindow),this.$dropdownWindow.on("click",".js-dropdown-syntax",(e=>{""===this.editor.getBody()||window.confirm(o.default.text("epic.syntax_switch"))?this.switchSyntax((0,n.default)(e.currentTarget).data("syntax")):this.$dropdownWindow.toggle()})))}switchSyntax(e){(0,n.default)(document).trigger("clearBackup");const t=i.default.extend(this.params,{syntax:e,title:this.editor.getTitle()});this.editor.trigger("initialize"),location.href=d(t)}disable(){this.$dropdownWindow.hide(),this.$syntaxSwitcher.addClass("syntax-switcher-hidden")}enable(){this.$syntaxSwitcher.removeClass("syntax-switcher-hidden")}}},82068:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Toolbar=void 0;var n,i=(n=r(65311))&&n.__esModule?n:{default:n},a=r(71952),o=r(77102);const s={init:function(e,t,r){this.$toolbar=e,this.$subToolbar=t,this.$moreButton=(0,i.default)(".button-toolbar-more"),this.editor=r,this.$toolbar.on("click","button",(e=>{const t=(0,i.default)(e.currentTarget).attr("data-action");return t&&this.editor.invokeAction(t),!1})),this.$toolbar.find("button[data-action]").each(((e,t)=>{const r=(0,i.default)(t),n=r.attr("data-action");this.editor.actions[n]||(r.attr("disabled","disabled"),r.addClass("disabled"))})),this.$toolbar.find(".toolbar-select-button").each(((e,t)=>{const r=(0,i.default)(t).attr("data-dropdown-window-selector"),n=(0,i.default)("#editor").find(r);new o.Dropdown((0,i.default)(t),n)})),(0,i.default)(".toolbar-select-dropdown-window").on("mousedown","[data-action]",(e=>{const t=(0,i.default)(e.currentTarget).attr("data-action");this.editor.invokeAction(t)})),this.setupColorPicker(),this.setupToolbarMore()},setupToolbarMore:function(){const e="Hatena.Diary.Editor.showSubToolbar";try{localStorage[e]=localStorage[e]||"true"}catch(e){}let t;this.$moreButton.on("click",(t=>{t.preventDefault(),this.toggleSubToolbar();try{const t=!JSON.parse(localStorage[e]);localStorage[e]=t.toString()}catch(e){}}));try{t="true"===localStorage[e]}catch(e){t=!0}t&&this.toggleSubToolbar()},toggleSubToolbar:function(){this.$subToolbar.toggle(),this.$moreButton.toggleClass("is-hidden"),this.editor.emit("resizeRequired")},setupColorPicker:function(){const e=(0,i.default)(".js-hatena-diary-color-picker"),t=(0,i.default)('[data-action="color"]');this.colorPicker=new a.ColorPicker(e),this.colorPicker.on("colorpick",(e=>{this.editor.invokeAction("pickColor",e)})),this.colorPickerDropdown=new o.Dropdown(t,e)}};t.Toolbar=s},21650:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Uploader=void 0;var n=s(r(65311)),i=r(70879),a=s(r(57942)),o=r(97050);function s(e){return e&&e.__esModule?e:{default:e}}const l="Hatena Blog",d="Hatena Blog Illust";t.Uploader=class{constructor(){this.handlers={},this.params={}}on(e,t){this.handlers[e]||(this.handlers[e]=[]),this.handlers[e].push(t)}emit(e,t){const r=this.handlers[e]||[];for(let n=0,a=r.length;n<a;n++)try{r[n](t)}catch(t){(0,i.BUG)(`Error on emit[${e}] ${t}`)}}setParams(e){this.params=e}upload(e,t){const r=n.default.Deferred();if(!(s=e.name).match(/\.(jpg|jpeg|gif|png|bmp)$/i)&&!s.match(/\.(mov|mpg|wmv|avi|flv|3gp|3g2)$/i)){const e=new TypeError("File not supported");return this.emit("error",e),r.reject(e)}var s;null==t&&((0,i.BUG)(new Error("Uploader: invalid folder name")),t=l);const d=new FormData;d.append("rkm",(0,a.default)("rkm")),d.append("append","1"),d.append("fototitle",""),d.append("folder",t),d.append("image",e);const u=Object.entries(this.params);for(const[e,t]of u)d.append(e,t);const c=new XMLHttpRequest;return c.upload.addEventListener("progress",(e=>{const t=e.lengthComputable?e.loaded/e.total*100:NaN;this.emit("progress",{percent:t}),r.notify(t)}),!1),c.addEventListener("load",(e=>{if(this.emit("progress",{percent:100}),r.notify(100),200!==c.status)return 402===c.status&&this.emit("disk_full",e),this.emit("error",e),r.reject(e);let t;try{t=JSON.parse(c.responseText)}catch(e){}return null==t?(this.emit("error",e),r.reject(e)):void 0===t.hatena_syntax||void 0!==t.errmsg?(this.emit("error",t),r.reject(t)):void(0,o.extractFotolifeSyntax)(t.hatena_syntax).done((e=>{e&&(r.resolve(e),this.emit("success",e))})).fail((e=>{r.reject(e)}))}),!1),c.addEventListener("error",(e=>{this.emit("error",e),r.reject(e)}),!1),c.addEventListener("abort",(e=>{this.emit("error",e),r.reject(e)}),!1),c.open("POST",`/f/${(0,a.default)("name")}/upbysmart?with_image_url=1`),c.setRequestHeader("X-Requested-With","XMLHttpRequest"),c.send(d),r.promise()}uploadPaint(e,t){const r=n.default.Deferred();return n.default.post(`/f/${(0,a.default)("name")}/haiku`,{rkm:(0,a.default)("rkm"),append:1,fototitle:"",folder:d,image:e,ext:t,model:"hatenablog"}).done((e=>{this.emit("progress",{percent:100}),(0,o.extractFotolifeSyntax)(e).done((e=>{e&&(r.resolve(e),this.emit("success",e))})).fail((e=>{r.reject(e)}))})).fail((e=>{this.emit("error",e),r.reject(e)})),r}static get DEFAULT_SIZE(){return 1200}static uploadDroppedFiles(e){const t=e.dataTransfer;if(null===t)return;const r=Array.from(t.files);(0,n.default)(document).trigger("uploadDroppedFiles",[r])}}},19165:(e,t,r)=>{"use strict";var n=r(70879);const i="hatenablog-editor-config-",a={save:function(e,t){try{localStorage.setItem(i+e,JSON.stringify([t]))}catch(e){(0,n.BUG)(e)}},load:function(e){let t;try{t=JSON.parse(localStorage.getItem(i+e)||"[]")[0]}catch(e){(0,n.BUG)(e)}return t}};e.exports=a},46613:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TINY_MCE_CONFIGS=void 0;const r={keep_styles:!1,custom_shortcuts:!1,branding:!1,theme:"silver",skin:"oxide",toolbar:!1,menubar:!1,statusbar:!1,convert_urls:!1,placeholder:"",entity_encoding:"raw",extended_valid_elements:["*[*]","#ins[*]","#a[*]","#audio[*]","img[*]","iframe[*]"].join(","),valid_children:["+body[style]","+dl[div]","+div[dt|dd]","+a[address|blockquote|div|dl|fieldset|figure|form|h1|h2|h3|h4|h5|h6|hr|menu|ol|p|pre|table|ul|article|section|nav|aside|hgroup|footer]"].join(","),plugins:["pagebreak","paste","noneditable","lists"],paste_data_images:!1,pagebreak_separator:"\x3c!-- more --\x3e",paste_webkit_styles:"all",allow_unsafe_link_target:!0};t.TINY_MCE_CONFIGS=r},99303:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEditor=function(e){const t=e.find('[name="syntax"]').val();return(0,n.LOG)(`init editor with mode: ${t}`),new l[t](e)};var n=r(70879),i=r(35541),a=r(31643),o=r(34313),s=r(94114);const l={html:i.HTMLEditor,hatena:a.HatenaEditor,markdown:o.MarkdownEditor,raw:s.RawEditor}},70782:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetchFotolifeInfo=void 0;var n,i=(n=r(65311))&&n.__esModule?n:{default:n};t.fetchFotolifeInfo=async e=>new Promise(((t,r)=>{i.default.ajax({url:`/f/${e}/api/info?mode=detail`,type:"get",cache:!1,dataType:"json"}).done((e=>{e.error&&r(e.error),t(e)})).fail((()=>r()))}))},42999:(e,t,r)=>{"use strict";var n=a(r(76804)),i=a(r(38600));function a(e){return e&&e.__esModule?e:{default:e}}const o=r(65311),s=r(36500),l=r(26410),d={init(){o(".manage-membership-button").click((function(e){const t=e.currentTarget,{circleManagePopupSelector:r}=t.dataset;if(!r)return;const a=o(document.querySelector(r));var d,u,c;return d=`${o("html").attr("data-admin-domain")}/-/group/${o("html").attr("data-circle-id")}/membership`,u="manage-membership",c=a,i.default.pipe((e=>{var t;if(e){var r={width:300,height:400};r.left=Math.floor((screen.width-r.width)/2),r.top=Math.floor((screen.height-r.height)/2);var i=window.open("",u,(0,n.default)(r));(t=s.createForWindow(i,d)).addEventListener("close",(()=>{t.destroy(),i.close()}))}else{var a=o("<iframe frameborder=0>").appendTo(c);(t=s.createForFrame(a[0],d)).addEventListener("close",(()=>{l.hide(c)})),t.addEventListener("resize",(e=>{e&&a.css(e)})),l.show(c,{destroy:function(){a.remove(),t.destroy()}})}return t})),!1}))}};e.exports=d},9694:e=>{"use strict";e.exports=class{constructor(){this.footerToggles=document.querySelectorAll(".js-footer-box-heading"),Array.from(this.footerToggles).forEach((e=>{e.addEventListener("click",(()=>{e.parentNode.classList.toggle("is-open")}))}))}}},20996:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=i(t);if(r&&r.has(e))return r.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=a?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,r&&r.set(e,n);return n}(r(39305));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(i=function(e){return e?r:t})(e)}document.createElement("time");const a={__text_data__:n,getAvailLangs:function(){if(this._availLangs)return this._availLangs;const e=document.documentElement;let t=e?e.getAttribute("data-avail-langs"):"";return t=t?t.split(/\s+/):[],this._availLangs=t,t},setAcceptLang:function(e){const t=new o;t.set("Accept-Language",e,{domain:this.cookieDomain,expires:"+1y",path:"/"}),t.set("_hatena_set_lang",1,{domain:this.cookieDomain,expires:"+1d",path:"/"})},getTextLang:function(){const e=document.documentElement;if(!e)return"ja";return e.getAttribute("lang")||"ja"},text:function(e){const t=arguments,r=this.getTextLang();this.project;let n;try{n=this.__text_data__[r][e]}catch(e){}if(n){const e=n.value,r=n.args;if(r){let n=0;return e.replace(/%s/g,(()=>t[parseInt(r[n++],10)]))}return e}return e},textN:function(e,t){const r=arguments,n=this.getTextLang();t=t||0;this.project;let i;try{i=this.__text_data__[n][e]}catch(e){}if(i){const e=i.quanttype||"o";let n=i.value,a=i.args;if("1_o"===e?1===t&&(n=i.value_1,a=i.args_1):"01_o"===e&&(0!==t&&1!==t||(n=i.value_1,a=i.args_1)),a){let e=0;return n.replace(/%s/,(()=>r[1+parseInt(a[e++],10)]))}return n}return e},_period00:new RegExp(`\\${Number(0).toLocaleString().replace(/0/g,"")}0+$`),number:function(e){return(e+0).toLocaleString().replace(this._period00,"")},numberFormatter:new Intl.NumberFormat(void 0,{style:"decimal",useGrouping:!0}),formatNumber(e){return this.numberFormatter.format(e)},deltaDatetime:function(e){const t=function(e){let t=((new Date).getTime()-e.getTime())/1e3;const r=t<0;return r&&(t=-t),t=Math.floor(t/60),t<60?{num:t,unit:"minutes_n",future:r}:(t=Math.floor(t/60),t<24?{num:t,unit:"hours_n",future:r}:(t=Math.floor(t/24),t<365?{num:t,unit:"days_n",future:r}:(t=Math.floor(t/365),{num:t,unit:"years_n",future:r})))}(e);if(void 0!==t.num){const e=this.textN(t.unit,t.num,t.num);return t.future?this.text("datetime.later",e):this.text("datetime.ago",e)}return e.toLocaleString()},updateTimestamps:function(e){const t=/(\d+-\d+-\d+)T(\d+:\d+:\d+)(?:\.(\d+))?Z/,r=(e=e||document).getElementsByTagName("time");for(let e=0,n=r.length;e<n;e++){const n=r[e];if(n._date)continue;const i=null!==n.getAttribute("data-relative"),a=null!==n.getAttribute("data-local");if(!i&&!a)continue;const o=n.getAttribute("datetime"),s=n.getAttribute("data-epoch");if(!o&&!s)continue;let l;if(o&&o.match(t)?l=new Date(o):s&&s.match(/^\d+$/)&&(l=new Date(+s)),l){if(i)try{n.innerHTML=this.deltaDatetime(l)}catch(e){}a&&(n.innerHTML=l.toLocaleString())}}},setupTimestampUpdater:function(){this._timestampUpdaterEnabled||(this._timestampUpdaterEnabled=!0,this.updateTimestamps(),setInterval((()=>{a.updateTimestamps()}),6e4))},project:"Epic",textDataFileNameStemSuffix:"",textDataDirName:"",dataHost:location.host,cookieDomain:".hatena.ne.jp"};/\.hatena\.com$/i.test(location.hostname)&&(a.cookieDomain=".hatena.com");class o{constructor(e){this.cookies=this.parse(e)}parse(e){const t={},r=(e||document.cookie).split(/;\s*/);for(;r.length;)try{if(!r.shift().replace(/^\s*|\s*$/g,"").match(/^([^=]*)=(.*)$/))continue;let e=RegExp.$1,n=RegExp.$2;if(-1!==n.indexOf("&")){n=n.split(/&/);for(let e=0;e<n.length;e++)n[e]=decodeURIComponent(n[e])}else n=decodeURIComponent(n);e=decodeURIComponent(e),t[e]=n}catch(e){}return t}set(e,t,r){if(this.cookies[e]=t,t instanceof Array){for(let e=0;e<t.length;e++)t[e]=encodeURIComponent(t[e]);t=t.join("&")}else t=encodeURIComponent(t);let n=`${encodeURIComponent(e)}=${t}`;if(("string"==typeof(r=r||{})||r instanceof Date)&&(r={expires:r}),r.expires||(r.expires=this.defaultExpires),/^\+?(\d+)([ymdh])$/.exec(r.expires)){const e=parseInt(RegExp.$1,10),t={y:"FullYear",m:"Month",d:"Date",h:"Hours"}[RegExp.$2],n=new Date;n[`set${t}`](n[`get${t}`]()+e),r.expires=n}return r.expires&&(r.expires.toUTCString&&(r.expires=r.expires.toUTCString()),n+=`; expires=${r.expires}`),r.domain&&(n+=`; domain=${r.domain}`),r.path?n+=`; path=${r.path}`:n+="; path=/",document.cookie=n}get(e){return this.cookies[e]}has(e){return e in this.cookies&&!(e in Object.prototype)}clear(e){this.set(e,"",new Date(0)),delete this.cookies[e]}}var s=a;t.default=s},36500:(e,t,r)=>{"use strict";var n,i=r(41960),a=r(70879),o=(n=r(57942))&&n.__esModule?n:{default:n};const s=r(65311),l=r(17187).EventEmitter;class d{constructor(e){this.window=e.window,this.key=e.key,this.eventEmitter=new l,this.messageListener=e=>this.receive(e),window.addEventListener("message",this.messageListener,!1)}send(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"*";this.window.postMessage(JSON.stringify({key:this.key,type:e,data:t}),r)}receive(e){try{const t=JSON.parse(e.data);if(t.key!==this.key)return;this.eventEmitter.emit(t.type,t.data,e.origin)}catch(e){d.ENABLE_DEBUG&&(0,a.LOG)(`${e.name}: ${e.message}`)}}destroy(){window.removeEventListener("message",this.messageListener,!1)}addEventListener(e,t){t&&this.eventEmitter.on(e,t)}removeEventListener(e,t){this.eventEmitter.removeListener(e,t)}dispatchEvent(){this.eventEmitter.emit(...arguments)}static get SIGNATURE(){return"MZ"}static createKey(){return`${d.SIGNATURE+Math.floor(2821109907456*Math.random()+2821109907456).toString(36).substring(1)}@`}static createForParent(){const e=window.name;return new d({key:e,window:window.opener||window.parent})}static createForFrame(e,t){return d.createForWindow(e.contentWindow,t)}static createForWindow(e,t){const r=d.createKey();return e.name=r,e.location.replace(t),new d({key:r,window:e})}static createForCurrentWindow(){let e=window.name;return""===e&&(e=d.createKey()),new d({key:e,window})}static send(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"*";(0,a.LOG)(["send",e,t]);try{d.messenger.send(e,t,r)}catch(t){(0,a.BUG)(t,`Messenger.send(${e})`)}}static addEventListener(e,t){try{d.messenger.addEventListener(e,t)}catch(t){(0,a.BUG)(t,`Messenger.addEventListener(${e})`)}}static listenToParent(){d.messenger=d.createForParent(),"globalheader"!==(0,o.default)("page")&&(s(".close").on("click",(()=>(d.send("close",{name:window.name}),!1))),s(window).keyup((e=>{"S-ESC"===(0,i.keyString)(e)&&d.send("close",{name:window.name})})))}static listenToFrame(e,t){d.messenger=d.createForFrame(e,t)}}!function(e,t,r){(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(d,"messenger",null),e.exports=d},11166:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CaseElementComponent=void 0;var n=o(r(67294)),i=o(r(20996)),a=r(55499);function o(e){return e&&e.__esModule?e:{default:e}}t.CaseElementComponent=e=>{let{testCase:t,closed:r,onClick:o}=e;const s=t.is_success?"blog.proxy_test.result.success":"blog.proxy_test.result.failure",l=i.default.text(s),d=t.is_success?"text-success":"text-failed",u=r?"table close":"table",c=r?"blogicon-chevron-down":"blogicon-chevron-up";return n.default.createElement("div",{className:"box-admin-section","data-testid":"case-element-component"},n.default.createElement("h3",{onClick:o,"data-testid":"case-element-component-h3"},n.default.createElement("i",{className:c}),n.default.createElement("span",{className:d},l),n.default.createElement(a.TestCodeDescriber,{testCode:t.test_code})),n.default.createElement("table",{className:u,"data-testid":"table"},n.default.createElement("tbody",null,n.default.createElement("tr",null,n.default.createElement("th",null,i.default.text("blog.proxy_test.result.request")),n.default.createElement("td",null,n.default.createElement("pre",null,n.default.createElement("code",null,t.request)))),n.default.createElement("tr",null,n.default.createElement("th",null,i.default.text("blog.proxy_test.result.response")),n.default.createElement("td",null,n.default.createElement("pre",null,n.default.createElement("code",null,t.response)))))))}},20115:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InvokeButton=void 0;var n=a(r(67294)),i=a(r(20996));function a(e){return e&&e.__esModule?e:{default:e}}t.InvokeButton=e=>{let{onClick:t,isExecuting:r}=e;return n.default.createElement("div",null,n.default.createElement("button",{type:"submit",onClick:t,disabled:r,className:"btn btn-primary","data-testid":"invoke-button"},i.default.text(r?"blog.proxy_test.executing":"blog.proxy_test.execute")))}},2221:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyTestAppComponent=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n};t.ProxyTestAppComponent=e=>{let{isInvoked:t,invoke:r,Fetcher:n,InvokeButton:a}=e;return i.default.createElement("div",null,i.default.createElement(a,{isExecuting:t,onClick:r}),t&&i.default.createElement(n,null))}},55499:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TestCodeDescriber=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n};const a="method_",o="status_code_",s="parameters_";t.TestCodeDescriber=e=>{let{testCode:t}=e;return i.default.createElement("span",null,(e=>{const t=t=>e.slice(t.length);return e.startsWith(a)?`: ${t(a)}`:e.startsWith(o)?`HTTP: ${t(o)}`:"not_cached"===e?"":e.startsWith(s)?`${t(s)}`:"custom_headers_request"===e?"":"custom_headers_response"===e?"":"redirect"===e?"Location":"content_type_request"===e?"Content-Type":"content_type_response"===e?"Content-Type":"cookies_request"===e?"Cookie":"cookies_response"===e?"Set-Cookie":"host"===e?"Host":"x_forwarded_host"===e?"X-Forwarded-Host":"path"===e?"":"scheme"===e?"scheme":"requested_host"===e?"":"cache_control"===e?"Cache-Controlprivate":"unknown"})(t))}},70059:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResultElement=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n},a=r(63550);t.ResultElement=e=>{let{result:t}=e;return i.default.createElement("section",{className:"admin-section","data-testid":"result-element"},i.default.createElement("h2",null,t.name),t.cases.map(((e,t)=>i.default.createElement(a.CaseElement,{key:t,testCase:e}))))}},38489:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResultList=void 0;var n=o(r(67294)),i=o(r(20996)),a=r(70059);function o(e){return e&&e.__esModule?e:{default:e}}t.ResultList=e=>{let{results:t}=e;const{resultCount:r,failedCount:o}=t.reduce(((e,t)=>({resultCount:e.resultCount+t.cases.length,failedCount:e.failedCount+t.cases.filter((e=>!e.is_success)).length})),{resultCount:0,failedCount:0}),s="blog.proxy_test.result.notification."+(o?"failure":"success");return n.default.createElement("div",null,r?n.default.createElement("div",{className:"message-info"},i.default.text(s,r,o)):null,n.default.createElement("div",null,t.map(((e,t)=>n.default.createElement(a.ResultElement,{key:t,result:e})))))}},99078:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResultListFetcherComponent=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n},a=r(38489);t.ResultListFetcherComponent=e=>{let{data:t,loading:r,error:n}=e;if(r)return null;if(n)return null;if(!t)throw new TypeError("'data' doesn't exist");return i.default.createElement(a.ResultList,{results:t.results})}},63550:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CaseElement=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n},a=r(52429),o=r(11166);t.CaseElement=e=>{let{testCase:t}=e;const{isToggled:r,toggle:n}=(0,a.useToggleState)(t.is_success);return i.default.createElement(o.CaseElementComponent,{testCase:t,closed:r,onClick:n})}},46728:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyTestApp=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n},a=r(25120),o=r(74894),s=r(2221),l=r(20115);function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},d.apply(this,arguments)}t.ProxyTestApp=()=>{const e=(0,o.useProxyTestAppHooks)();return i.default.createElement(s.ProxyTestAppComponent,d({},e,{Fetcher:a.ResultListFetcher,InvokeButton:l.InvokeButton}))}},25120:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResultListFetcher=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n},a=r(99078),o=r(8275);t.ResultListFetcher=()=>{const[{data:e,loading:t,error:r}]=(0,o.useProxyTestFetchEffect)();return i.default.createElement(a.ResultListFetcherComponent,{data:e,loading:t,error:r})}},74894:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useProxyTestAppHooks=void 0;var n=r(67294);t.useProxyTestAppHooks=()=>{const[e,t]=(0,n.useState)(!1),r=(0,n.useCallback)((()=>{e||t(!0)}),[e,t]),i=(0,n.useCallback)((()=>{e&&t(!1)}),[e,t]);return{isInvoked:e,invoke:r,discard:i}}},8275:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useProxyTestFetchEffect=void 0;var n=r(91289),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=a(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,r&&r.set(e,n);return n}(r(55992));function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(a=function(e){return e?r:t})(e)}t.useProxyTestFetchEffect=()=>(0,n.useXHR)({url:i.httpsAdminUserBlogUrl("/proxy_test/result"),responseType:"json"})},17565:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyTest=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n},a=r(73380),o=r(46728);t.ProxyTest=class{static init(e){(0,a.safeRender)(i.default.createElement(o.ProxyTestApp,null),e)}}},35652:(e,t,r)=>{"use strict";var n,i=(n=r(57942))&&n.__esModule?n:{default:n};var a=r(65311),o=r(66419),s=r(36500),l=r(17187).EventEmitter,d=r(75040),u=r(68871),c=60,p=10,f=r(97165),h=function(e,t,r){e.on("mouseover",(()=>{var n={top:e.offset().top,left:e.offset().left+40};t.css(n),r.show()})),e.on("mouseout",(()=>{r.hide()}))},m={targetArticle:{$el:null,title:"",uri:"",uuid:""},selectedText:"",quoteInfoLoaded:function(e){e.supported&&(m.init(e),m.Stock.init(e),e.stockable?f.init(e,this):g.init(this))},init:function(){var e,t,r=this;r.eventEmitter=new l,r.$el=a(".quote-box"),a(document).on("mousedown","body",(t=>{var n=a(t.target),i=r.getClosestArticle(n);e=r.getArticleURI(i)})),a(document).on("mouseup","body",(n=>{var i=a(n.target),s=r.getClosestArticle(i);if(t=r.getArticleURI(s),i.closest(a(".hatena-star-add-button")).length>0)return n.preventDefault(),void r.hideQuoteBox();o.defer((()=>{var o=u();if(!(i.closest(r.$el).length>0||i.closest(a(".quote-stock-panel")).length>0)){if(!e||e!==t||!r.isValidSelected(i,o))return r.selectedText="",r.setTargetArticle(null),void r.hideQuoteBox();r.selectedText=o,r.setTargetArticle(s),r.showQuoteBox(s,n.pageY),r.emit("selectionChanged")}}))}))},isValidSelected:function(e,t){var r=t.match(/^\s*$/);return!(e.closest(".comment").length>0)&&!r},showQuoteBox:function(e,t){var r=this.$el,n=e.offset().left-c;n=Math.max(n,p),r.css({top:t,left:n}),r.show()},hideQuoteBox:function(){this.$el.hide()},on:function(){this.eventEmitter.on.apply(this.eventEmitter,arguments)},emit:function(){this.eventEmitter.emit.apply(this.eventEmitter,arguments)},getClosestArticle:function(e){var t=e.closest("article");if(t.length<=0){var r=d();void 0!==r.focusNode&&(t=a(r.focusNode).closest("article"))}return t},getArticleURI:function(e){return e.find(".entry-title .entry-title-link").attr("href")},getArticleTitle:function(e){return e.find(".entry-title .entry-title-link").text()},getArticleUUID:function(e){return e.attr("data-uuid")},setTargetArticle:function(e){var t=this;t.targetArticle=e?{$el:e,uri:t.getArticleURI(e),title:t.getArticleTitle(e),uuid:t.getArticleUUID(e)}:{$el:null,uri:"",title:"",uuid:""}}};m.Stock={init:function(e){var t=this;return t.$stockButton=a(".tooltip-quote-stock"),t.$stockMessageBox=a("#quote-stock-message-box"),t.$stockSuccessMessage=a("#quote-stock-succeeded-message"),t.$stockFailMessage=a("#quote-stock-failed-message"),t.$stockCloseMessageButton=a(".quote-stock-close-message-button"),t.$stockShowEditorButton=a("#quote-stock-show-editor-button"),t.$unstockableMessageBox=a("#unstockable-quote-message-box"),t.$quoteLoginRequiredMessageBox=a("#quote-login-required-message"),t.$quoteLoginButton=a("#quote-login-button"),t.$stockButton.show(),e.should_navigate_to_login?(t.$stockButton.on("click",(()=>{var e={top:t.$stockButton.offset().top,left:t.$stockButton.offset().left+40};t.$stockMessageBox.css(e),t.$quoteLoginRequiredMessageBox.show()})),t.$quoteLoginButton.on("click",(()=>{var e,t;e=`${(0,i.default)("admin-domain")}/go?blog=${encodeURIComponent(m.targetArticle.uri)}`,t=`https://www.hatena.ne.jp/login?location=${encodeURIComponent(e)}`,location.href=t})),t.$stockCloseMessageButton.on("click",(()=>{t.$quoteLoginRequiredMessageBox.hide()})),!1):e.stockable?void t.setupQuoteStockButton():(h(t.$stockButton,t.$stockMessageBox,t.$unstockableMessageBox),!1)},setupQuoteStockButton:function(){var e=this;e.$stockButton.on("click",(()=>{var t={top:e.$stockButton.offset().top,left:e.$stockButton.offset().left+40};e.$stockMessageBox.css(t),s.send("stockQuote",{uri:m.targetArticle.uri,title:m.targetArticle.title,selected_text:m.selectedText})})),s.addEventListener("successStockQuote",(()=>{e.$stockSuccessMessage.show()})),s.addEventListener("failStockQuote",(()=>{e.$stockFailMessage.show()})),e.$stockShowEditorButton.on("click",(()=>{e.$stockSuccessMessage.hide(),s.send("quote-edit-entry",{})})),e.$stockCloseMessageButton.on("click",(()=>{e.$stockSuccessMessage.hide(),e.$stockFailMessage.hide()}))}};var g={init:function(e){this.quote=e,this.$tweetButton=this.quote.$el.find(".js-tooltip-quote-tweet"),this.$tweetAnchor=this.quote.$el.find(".js-tooltip-quote-tweet"),this.$stockMessageBox=a("#quote-stock-message-box"),this.$unstockableErrorBox=a("#unstockable-quote-message-box"),this.$tweetButton.show(),h(this.$tweetButton,this.$stockMessageBox,this.$unstockableErrorBox)}};e.exports=m},83401:(e,t,r)=>{"use strict";var n=l(r(65311)),i=l(r(66419)),a=r(17187),o=l(r(57942)),s=r(44343);function l(e){return e&&e.__esModule?e:{default:e}}const d=r(36500),u=r(75040),c=r(68871),p=r(97165),f=new s.ShortenText((0,n.default)("#quote-text"),{}),h=i.default.throttle((()=>{f.execute()}),800),m=function(e){e.stop().show().css("opacity",1).delay(1e3).fadeOut(1e3)},g={targetArticle:{$el:null,uri:"",title:"",uuid:""},selectedText:"",init:function(e){if(!e.supported)return;const t=this,r=u();t.eventEmitter=new a.EventEmitter,t.$el=(0,n.default)("#quote-base"),t.$box=(0,n.default)("#quote-box"),t.$quoteText=(0,n.default)("#quote-text"),t.$loginRequiredLink=(0,n.default)(".quote-login-link"),t.$loginRequiredMessage=(0,n.default)("#quote-login-required");const i=(0,n.default)("article").first();let s,l;t.targetArticle={$el:i,uri:i.find(".entry-title a").attr("href"),title:i.find(".entry-title a").text(),uuid:i.attr("data-uuid")},t.$el.on("touchend",(e=>{e.preventDefault()})),(0,n.default)(window).on("resize",(e=>{h()})),(0,n.default)("#container").on("click",(e=>{t.hideQuoteBox(e)})),(0,n.default)(document).on("selectionchange",(()=>{if(r.rangeCount<1)return;const e=(0,n.default)(r.anchorNode).parents("article").length>0,i=(0,n.default)(r.anchorNode).parents(".comment").length>0;e&&!i&&(t.selectedText=c().replace(/(^\s+)|(\s+$)/g,""),0!==t.selectedText.length&&(t.showQuoteBox(),t.emit("selectionChanged")))})),e.should_navigate_to_login&&(s=`${(0,o.default)("admin-domain")}/go?blog=${encodeURIComponent(t.targetArticle.uri)}`,l=`https://www.hatena.ne.jp/login?location=${encodeURIComponent(s)}`,t.$loginRequiredLink.attr("href",l),t.$loginRequiredLink.on("touchend",(()=>{location.href=l})),t.$loginRequiredMessage.show()),v.init(e),e.stockable?p.init(e,this):b.init(this)},showQuoteBox:function(){this.$el.show(),f.init(this.selectedText),h()},hideQuoteBox:function(e){const t=this;t.isBoxTouched(e.target)||(t.$el.hide(),t.$quoteText.text(""),t.selectedText="")},on:function(){this.eventEmitter.on.apply(this.eventEmitter,arguments)},emit:function(){this.eventEmitter.emit.apply(this.eventEmitter,arguments)},isBoxTouched:function(e){return(0,n.default)(e).closest(this.$box).length>0}},v={init:function(e){const t=this;return!e.should_navigate_to_login&&(t.$stockButton=(0,n.default)("#quote-stock-button"),t.$successMessageBox=(0,n.default)("#quote-stock-result"),t.$unstockableErrorBox=(0,n.default)("#quote-unstockable-error"),t.$errorBox=(0,n.default)("#quote-stock-error"),e.stockable?(t.$stockButton.addClass("available"),void t.setupQuoteStockButtonEvents()):(t.$stockButton.on("touchend",(()=>m(t.$unstockableErrorBox))),!1))},setupQuoteStockButtonEvents:function(){const e=this;e.$stockButton.on("touchend",(()=>{d.send("stockQuote",{uri:g.targetArticle.uri,title:g.targetArticle.title,selected_text:g.selectedText})})),d.addEventListener("successStockQuote",(()=>{e.closeAllMessageBoxes(),m(e.$successMessageBox)})),d.addEventListener("failStockQuote",(()=>{e.closeAllMessageBoxes(),m(e.$errorBox)}))},closeAllMessageBoxes:function(){this.$successMessageBox.hide()}},b={init:function(e){this.quote=e,this.$unstockableErrorBox=this.quote.$el.find("#quote-unstockable-error"),this.$tweetButton=this.quote.$el.find(".js-tweet-quote"),this.$tweetButton.on("touchend",(()=>m(this.$unstockableErrorBox)))}};e.exports=g},97165:(e,t,r)=>{"use strict";var n,i=(n=r(76804))&&n.__esModule?n:{default:n};var a=r(65311);const o={init:function(e,t){this.quote=t,this.state={},this.$tweetContainer=this.quote.$el.find(".js-tooltip-quote-tweet"),this.$tweetButton=this.quote.$el.find(".js-tweet-quote"),this.$tweetButton.on("click touchend",(()=>this.tweet())),this.quote.on("selectionChanged",(()=>{this.update(),this.render()}))},update:function(){const e=`https://twitter.com/share?${a.param({url:this.quote.targetArticle.uri,text:`${this.quote.selectedText}`})}`;this.state={href:e}},render:function(){this.$tweetButton.attr("href",this.state.href),this.$tweetContainer.addClass("available").show()},tweet:function(){const e={width:550,height:420};e.left=Math.floor((screen.width-e.width)/2),e.top=Math.floor((screen.height-e.height)/2);const t=(0,i.default)(e);return window.open(this.state.href,"Quote.Tweet",t),!1}};e.exports=o},59587:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColorPicker=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294)),i=r(24198),a=r(61663);function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}t.ColorPicker=e=>{let{color:t,onChange:r,isShown:o,toggle:s,buttonClassName:l}=e;const d=(0,n.useRef)(null);return(0,a.useOnClickOutside)(d,s),n.default.createElement("div",{style:{height:26,position:"relative",float:"left"},className:"js-color-picker"},n.default.createElement("button",{className:l,style:{backgroundColor:t,position:"absolute",border:"none",width:26,height:26},onClick:s,type:"button"}),o&&n.default.createElement("div",{style:{display:"inline-block",position:"absolute",zIndex:9999,top:26},ref:d},n.default.createElement(i.SketchPicker,{color:t,onChange:e=>{r(e.hex)},disableAlpha:!0})))}},83521:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Dropdown=void 0;var n,i=r(61663),a=(n=r(86010))&&n.__esModule?n:{default:n},o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(67294));function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}t.Dropdown=e=>{let{items:t}=e;const[r,n]=(0,o.useState)(!1),s=(0,o.useRef)(null),l=(0,o.useCallback)((()=>{n(!1)}),[]);return(0,i.useOnClickOutside)(s,l),o.default.createElement("div",{className:"dropdown-window-wrapper",ref:s,"data-testid":"dropdown-window-wrapper"},o.default.createElement("button",{type:"button",className:"dropdown-toggle edit-dropdown-toggle test-dropdown-button","data-testid":"dropdown-button",onClick:()=>{n(!r)},onDoubleClick:e=>{e.preventDefault()}},o.default.createElement("i",{className:"blogicon-others"})),o.default.createElement("div",{className:(0,a.default)(["entries-edit-dropdown-window","dropdown-window",{"is-open":r}]),"data-testid":"dropdown-window"},o.default.createElement("ul",{className:"list"},t.map((e=>o.default.createElement("li",{key:e.label},o.default.createElement("button",{type:"button",className:e.className,"data-testid":e.icon,onClick:t=>{n(!1),e.onClick&&e.onClick(t)}},e.icon&&o.default.createElement("i",{className:e.icon}),e.icon&&" ",e.label)))))))}},49383:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Tabs=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=i(t);if(r&&r.has(e))return r.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=a?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,r&&r.set(e,n);return n}(r(67294));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(i=function(e){return e?r:t})(e)}const a=r(19165),o=e=>{let{tab:t,currentTab:r,onClick:i}=e;const a=t.key===r;return n.default.createElement("div",{className:"react-tabs-list-item"+(a?" active":""),"data-testid":"react-tabs-list-item",onClick:()=>i(t.key)},t.name)},s=e=>{let{tab:t,currentTab:r}=e;const i=t&&t.component?t.component:null;return n.default.createElement("div",{className:"react-tabs-content","data-testid":"react-tabs-content",style:t.key===r?void 0:{display:"none"}},i&&n.default.createElement(i,t.props))};t.Tabs=e=>{let{tabs:t,className:r,localStoragePrefix:i,onSelect:l}=e;const{currentTab:d,onClick:u}=((e,t,r)=>{const[i,o]=(0,n.useState)("");return(0,n.useEffect)((()=>{const r=a.load(e),n=t.some((e=>e.key===r))?r:t[0].key;if("string"!=typeof n)throw new Error("initialTabKey is not a string.");o(n)}),[e,t]),{currentTab:i,onClick:(0,n.useCallback)((t=>{o(t.key),a.save(e,t.key),r&&r(t.key)}),[e,r])}})(i,t,l);return n.default.createElement("div",{className:"react-tabs"+(r?` ${r}`:"")},n.default.createElement("div",{className:"react-tabs-list"},t.map((e=>n.default.createElement(o,{key:`-${e.key}`,tab:e,currentTab:d,onClick:()=>u(e)})))),n.default.createElement("div",{className:"react-tabs-contents"},t.map((e=>n.default.createElement(s,{key:`-${e.key}`,tab:e,currentTab:d})))))}},46852:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HatenaIDWithNickname=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=i(t);if(r&&r.has(e))return r.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=a?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,r&&r.set(e,n);return n}(r(67294));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(i=function(e){return e?r:t})(e)}t.HatenaIDWithNickname=e=>{let{loading:t,nickname:r,hatenaId:i,authors:a}=e;return t?n.default.createElement(n.default.Fragment,null,i):a?.length?n.default.createElement(n.default.Fragment,null,a.map(((e,t)=>n.default.createElement(n.Fragment,{key:t},t?n.default.createElement("span",{className:"user-name-delimiter"},", "):null,n.default.createElement("span",{className:"user-name-author"},e))))):r?n.default.createElement(n.default.Fragment,null,n.default.createElement("span",{className:"user-name-nickname"},r)," ",n.default.createElement("span",{className:"user-name-paren"},"("),n.default.createElement("span",{className:"user-name-hatena-id"},"id:",i),n.default.createElement("span",{className:"user-name-paren"},")")):n.default.createElement(n.default.Fragment,null,i)}},76932:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Nickname=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n},a=r(76386),o=r(46852);t.Nickname=e=>{let{dataloader:t,hatenaID:r,authors:n}=e;const{loading:s,result:l}=(0,a.useFetchNickname)({dataloader:t,hatenaID:r});return i.default.createElement(o.HatenaIDWithNickname,{nickname:l?.nickname,hatenaId:r,loading:s,authors:n})}},68853:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createNicknameDataloader=void 0;var n,i=(n=r(45933))&&n.__esModule?n:{default:n},a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(347));function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}const s=async e=>{const t=await a.default.get("https://pf-api.hatena.com/profile/profiles",{responseType:"json",params:{name:e},transformRequest:a.removeXRequestWith,paramsSerializer:a.traditionalDataRequest});return e.map((e=>t.data[e]||new Error(`hatenaID:${e} is not found`)))};t.createNicknameDataloader=()=>new i.default(s,{maxBatchSize:20})},76386:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useFetchNickname=void 0;var n=r(52572);t.useFetchNickname=e=>{let{dataloader:t,hatenaID:r}=e;return(0,n.useAsync)((()=>t.load(r)),[t,r])}},43805:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useInput=void 0;var n=r(67294);t.useInput=()=>{const e=(0,n.useRef)(null),t=(0,n.useCallback)((()=>e.current?e.current.value:""),[e]),r=(0,n.useCallback)((()=>{e.current&&e.current.select()}),[e]);return{inputRef:e,select:r,getValue:t}}},61663:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useOnClickOutside=void 0;var n=r(67294);t.useOnClickOutside=(e,t)=>{(0,n.useEffect)((()=>{const r=r=>{e.current&&!e.current.contains(r.target)&&t()},n=window.setTimeout((()=>{document.addEventListener("click",r)}),0);return()=>{window.clearTimeout(n),document.removeEventListener("click",r)}}),[e,t])}},25680:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useStateWithConfigStorage=void 0;var n=r(67294);const i=r(19165);t.useStateWithConfigStorage=(e,t)=>{const[r,a]=(0,n.useState)(i.load(e)??t);return(0,n.useEffect)((()=>{i.save(e,r)}),[e,r]),[r,a]}},52429:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useToggleState=void 0;var n=r(67294);t.useToggleState=e=>{const[t,r]=(0,n.useState)(e),i=(0,n.useCallback)((()=>{r(!t)}),[t]);return{isToggled:t,toggle:i}}},91289:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useXHR=void 0;var n,i=(n=r(347))&&n.__esModule?n:{default:n};const a=(0,r(30801).makeUseAxios)({axios:i.default,cache:!1});t.useXHR=a},21655:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SubscribeButtonAdmin=void 0;var n=r(26464),i=o(r(66419)),a=o(r(57942));function o(e){return e&&e.__esModule?e:{default:e}}class s extends n.SubscribeButton{constructor(e,t,r){super(e,t,r),this.initMessages()}initMessages(){window.addEventListener("storage",(e=>{if("subscription"!==e.key)return;const t=JSON.parse(e.newValue||"")[this.blog.blogUrl];t!==this.user.isSubscribing&&(!0===t&&this.subscribe(),!1===t&&this.unsubscribe())}))}openSubscribeWindow(){const e=location.href,t=encodeURIComponent(e),r=`${(0,a.default)("admin-domain")}/${(0,a.default)("author")}/${(0,a.default)("blog")}/subscribe?from_url=${t}&utm_source=iframe_subscribe_button&utm_medium=button&utm_campaign=subscribe_blog`;window.open(r)}toggleState(){this.user.isSubscribing?(this.unsubscribe(),s.setSubscription(this.blog.blogUrl,!1)):(this.subscribe(),s.setSubscription(this.blog.blogUrl,!0))}static setSubscription(e,t){let r=JSON.parse(window.localStorage.getItem("subscription")||"");r=i.default.isObject(r)?r:{},r[e]=t,window.localStorage.setItem("subscription",JSON.stringify(r))}}t.SubscribeButtonAdmin=s},26464:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SubscribeButton=void 0;var n=a(r(65311)),i=a(r(57942));function a(e){return e&&e.__esModule?e:{default:e}}class o{constructor(e){this.isSubscribing=e.isSubscribing||!1,this.isGuest=e.isGuest||!1}toggle(){this.isSubscribing=!this.isSubscribing}}class s{constructor(e){this.subscribersCount=+(e?.subscribersCount||0),this.blogUrl=e.blogUrl,this.blogName=e.blogName,this.requestUrl=e.requestUrl}requestUpdate(e){return n.default.ajax({type:"POST",url:this.requestUrl,data:{rkm:(0,i.default)("rkm"),rkc:(0,i.default)("rkc"),delete:e.isSubscribing?1:0}})}updateSubscribersCount(e){this.subscribersCount+=e.isSubscribing?1:-1}}t.SubscribeButton=class{constructor(e,t,r){this.$el=e,this.user=new o(t),this.blog=new s(r),this.$subscribeBtn=this.$el.find(".js-hatena-follow-button"),this.$subscriptionCount=this.$el.find(".js-subscription-count"),this.$subscriptionCountBox=this.$el.find(".js-subscription-count-box"),this.updateViews(),this.initEvents()}initEvents(){this.$subscribeBtn.on("mouseenter",(()=>{this.$subscribeBtn.addClass("hover")})).on("mouseleave",(()=>{this.$subscribeBtn.removeClass("hover")})).on("click",(()=>{const e=this.$subscribeBtn.offset();return e.top+=this.$subscribeBtn.height(),this.openSubscribeWindow(e),!1}))}updateViews(){const e=this.user.isSubscribing;this.$subscribeBtn.addClass(e?"subscribing":"unsubscribing").removeClass(e?"unsubscribing":"subscribing"),this.$subscribeBtn.removeClass("hover"),this.updateCountBox()}updateCountBox(){this.blog.subscribersCount>=1?(this.$subscriptionCountBox.show(),this.$subscriptionCount.text(this.blog.subscribersCount)):this.$subscriptionCountBox.hide()}subscribe(){this.user.isSubscribing=!0,this.blog.subscribersCount++,this.updateViews()}unsubscribe(){this.user.isSubscribing=!1,this.blog.subscribersCount--,this.updateViews()}}},74302:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SubscribeButtonBlogs=void 0;var n=r(26464),i=s(r(65311)),a=s(r(57942)),o=s(r(76804));function s(e){return e&&e.__esModule?e:{default:e}}const l=r(36500);class d extends n.SubscribeButton{constructor(e,t,r,n,i){super(e,t,r),this.utmSource=i,this.messenger=n,this.initMessages()}initMessages(){this.messenger.addEventListener("subscription",(e=>{const t=e[this.blog.blogUrl];t!==this.user.isSubscribing&&(!0===t&&this.subscribe(),!1===t&&this.unsubscribe())}))}openSubscribeWindow(e,t){const r=location.href,n=encodeURIComponent(r),i=encodeURIComponent(this.utmSource),o=`${(0,a.default)("admin-domain")}/${(0,a.default)("author")}/${(0,a.default)("blog")}/subscribe?from_url=${n}&utm_source=${i}&utm_medium=button&utm_campaign=subscribe_blog`;window.open(o)}subscribeButtonHandlerWindow(e){const t={width:300,height:150};t.left=Math.floor((screen.width-t.width)/2),t.top=Math.floor((screen.height-t.height)/2);const r=window.open("","subscribe",(0,o.default)(t)),n=l.createForWindow(r,e);n.addEventListener("done",(()=>{this.toggleState(),a()}));const a=function(){n.destroy(),r?.close()};n.addEventListener("close",a),(0,i.default)(document.body).one("focus",a)}toggleState(){const e={};e[this.blog.blogUrl]=!this.user.isSubscribing,this.messenger.send("subscription",e)}}t.SubscribeButtonBlogs=d},92901:(e,t,r)=>{"use strict";var n=r(21655),i=r(74302);e.exports={Admin:n.SubscribeButtonAdmin,Blogs:i.SubscribeButtonBlogs}},32890:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HistoryStack=void 0;t.HistoryStack=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;this.maxLength=Math.max(e,1),this.history=[],this.position=0}save(e){this.position===this.maxLength?this.history.shift():this.position++,this.history=this.history.slice(0,this.position-1),this.history.push(e)}canGetCurrent(){return 0!==this.history.length}canUndo(){return this.canGetCurrent()&&this.position>1}canRedo(){return this.canGetCurrent()&&this.position<this.history.length}undo(){return this.canUndo()?this.history[--this.position-1]:null}redo(){return this.canRedo()?this.history[++this.position-1]:null}getCurrent(){return this.canGetCurrent()?this.history[this.position-1]:null}clear(){this.history=[],this.position=0}}},51525:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tracesSampler=t.setTransactionName=t.initializeSentry=t.excludeEventDefinedByUser=t.SENTRY_IGNORE_ERRORS=void 0;var n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=d(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(33646)),a=r(40533),o=r(97914),s=(n=r(57942))&&n.__esModule?n:{default:n},l=r(36414);function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(d=function(e){return e?r:t})(e)}const u=(e,t)=>{const r=e.exception&&e.exception.values&&e.exception.values[0]?e.exception.values[0].stacktrace:null,n=r?r.frames:null;if(n&&n.length>0){const r=n[n.length-1].filename;if(r&&new RegExp(`^${t}`).test(r))return e}return null};t.excludeEventDefinedByUser=u;const c=[/execute code from a freed script/,/SecurityError.*Blocked.*/,/TypeError.*valve.*/,/.*t\[0\] is undefined.*/,/.*evaluating 'e\.offset\(\)\.left'.*/,/.*Unable to get property 'left' of undefined.*/,/.*Cannot read property 'left' of undefined.*/,/.*TypeError: e\.offset\(\.\.\.\) is undefined.*/,/'_checkRecommendVisibleMain' is undefined/,/.*_checkRecommendVisibleMain.*/,/.*undefined is not an object \(evaluating 'document\.getElementsByTagName\('video'\)\[0\]\.src'\).*/];t.SENTRY_IGNORE_ERRORS=c;const p={admin:.001,blogs:.14,global:.002,unknown:0},f=["https://blog.hatenablog.com","https://developer.hatenastaff.com","https://soredoko.jp"],h=e=>{let{environment:t,routerType:r,location:n}=e;return()=>{if(t!==l.SentryEnvironment.Productrion&&t!==l.SentryEnvironment.Staging)return 0;if(window!==window.parent)return 0;if(r===l.RouterType.Blogs&&!f.includes(n.origin))return 0;const e=p[r];return t===l.SentryEnvironment.Staging?Math.ceil(e):e}};t.tracesSampler=h;const m=e=>{let{scope:t,routerType:r,deviceType:n,pageId:i,blogUUID:a}=e;i!==l.UNKNOWN_PAGE_ID&&(r===l.RouterType.Blogs?t.setTransactionName(`${r}:${n}:${i}:${a}`):t.setTransactionName(`${r}:${n}:${i}`))};t.setTransactionName=m;const g=e=>{const t=[new a.Dedupe];return p[e]>0?[...t,new o.BrowserTracing]:t};t.initializeSentry=()=>{const e=(0,s.default)("sentry-dsn");if(e){const t=(0,l.getRouterType)(),r=(0,l.getPageId)(),n=(0,l.getBlogUUID)(),a=(0,l.getDeviceType)(),o=window.location,d=(0,l.getSentryEnvironment)();i.init({dsn:e,ignoreErrors:c,release:(0,s.default)("version"),sampleRate:Number((0,s.default)("sentry-sample-rate")),tracesSampler:h({environment:d,routerType:t,location:o}),environment:(0,l.getSentryEnvironment)(),integrations:g(t),beforeSend:(e,t)=>u(e,(0,s.default)("static-domain"))}),i.configureScope((e=>{e.setTag("epic.domain",t),e.setTag("epic.page",r),m({scope:e,routerType:t,deviceType:a,pageId:r,blogUUID:n})}))}}},53736:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.attachGroupBannerQueryParameters=void 0;var n=r(36414);t.attachGroupBannerQueryParameters=()=>{document.querySelectorAll("a.js-embed-group-link").forEach((e=>{const t=new URL(e.href);t.searchParams.set("blog_id",(0,n.getBlogUUID)()),e.href=t.toString()}))}},37119:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(65311))&&n.__esModule?n:{default:n};var a=e=>{const t=e.$container,r=e.key,n=e.onchange;if(!localStorage)return;const a=`Hatena.Diary.Util.backupTab.${r}`;(()=>{const e=localStorage[a];if(void 0===e)return;const r=t.find(`input[value="${e}"]`);r.trigger("click"),n(r)})(),t.on("change","input",(e=>{const t=(0,i.default)(e.currentTarget);var r;r=t.val(),localStorage[a]=r,n(t)}))};t.default=a},60361:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bookmarkLoader=void 0;var n=a(r(347)),i=a(r(51068));function a(e){return e&&e.__esModule?e:{default:e}}const o={loadBlogBookmarksCount:e=>n.default.get("/api/hatena_bookmark/blog_bookmarks_count",{params:{blog_id:e},responseType:"json"}),loadEntriesBookmarksCount:(e,t)=>n.default.get("/api/hatena_bookmark/entries_bookmarks_count",{params:{blog_id:e,e:t},responseType:"json"}),loadEntryBookmarksCountDirectly:e=>n.default.get("https://bookmark.hatenaapis.com/count/entry",{adapter:i.default,params:{url:e}}),loadEntriesBookmarksCountDirectly:e=>{if(e.length>50)throw new Error("you can only specify up to 50 urls");if(0===e.length)return Promise.resolve({data:{},status:200});const t=new URL("https://bookmark.hatenaapis.com/count/entries");return e.forEach((e=>{t.searchParams.append("url",e)})),n.default.get(t.href,{adapter:i.default})}};t.bookmarkLoader=o},86965:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canonicalizeColor=void 0;t.canonicalizeColor=e=>{let t,r="";if(t=e.match(/#([0-9a-f]{6})/i))r=t[1];else if(t=e.match(/#([0-9a-f])([0-9a-f])([0-9a-f])/i))r=t[1]+t[1]+t[2]+t[2]+t[3]+t[3];else if(t=e.match(/rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d+)\s*)?/)){r=t[4]&&0==+t[4]?"":`0${(+t[1]).toString(16)}`.slice(-2)+`0${(+t[2]).toString(16)}`.slice(-2)+`0${(+t[3]).toString(16)}`.slice(-2)}return r.toLowerCase()}},96341:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.characterLength=void 0;t.characterLength=e=>e.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"_").length},76490:e=>{"use strict";e.exports=function(e){const t=Object.keys(e);return function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;const i={};return t.forEach((t=>{const a=e[t];i[t]=a(r[t],n)})),i}}},65400:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.composeEnhancers=void 0;const n=r(14890).compose;t.composeEnhancers=n},1606:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=e=>{const t={},r=e.split("&"),n=r.length;for(let e=0;e<n;e++){if(!r[e].match(/[=]/))continue;const n=r[e].split("="),i=decodeURIComponent(n[0]),a=n[1].replace(/\+/g," ");t[i]||(t[i]=[]),t[i].push(decodeURIComponent(a))}return t};t.default=r},35340:e=>{"use strict";e.exports=function(e){return JSON.parse(JSON.stringify(e))}},61875:e=>{"use strict";e.exports=function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&!Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=t[r])}},37213:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UNREAD_COUNT_RESPONSE_MAX=void 0,t.fetchUnreadCount=function(){const e=(0,i.protocolRelativeAdminUrl)("/api/recent_subscribing");return a.default.get(e,{responseType:"json",params:{_:Date.now()},validateStatus:e=>e<500}).then((e=>e&&e.data&&e.data.count?+e.data.count:0))};var n,i=r(55992),a=(n=r(347))&&n.__esModule?n:{default:n};t.UNREAD_COUNT_RESPONSE_MAX=20},24367:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatCategoryName=void 0;t.formatCategoryName=e=>e.trim().replace(/[\r\n]+/g,"")},849:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=e=>e.toString().split("").reverse().reduce(((e,t,r)=>0!==r&&r%3==0?t+","+e:t+e));t.default=r},74868:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatDuration=void 0;t.formatDuration=e=>{const t=Math.floor(e/3600),r=Math.floor(e%3600/60),n=Math.floor(e%3600%60),i=t.toString();let a=r.toString(),o=n.toString(),s="";return t>0&&(s+=`${i}:`,r<10&&(a=`0${a}`)),n<10&&(o=`0${o}`),s+=`${a}:${o}`,s}},75040:e=>{"use strict";e.exports=function(){return window.getSelection?window.getSelection():document.getSelection?document.getSelection():{}}},68871:e=>{"use strict";e.exports=function(){return window.getSelection?`${window.getSelection()||""}`:document.getSelection?document.getSelection():document.selection?document.selection.createRange().text:""}},77289:e=>{"use strict";e.exports=function(e,t){const r={};return e.forEach((e=>{r[e[t]]=e})),r}},46955:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.inheritGA=void 0;var n,i=(n=r(80129))&&n.__esModule?n:{default:n};t.inheritGA=(e,t)=>{const r=document.createElement("a");if(r.href=e,!r.search)return t;const n=i.default.parse(r.search.substring(1))._ga;if(!n)return t;const a=document.createElement("a");a.href=t;const o=i.default.parse(a.search.substring(1));return o._ga=n,a.search=i.default.stringify(o),a.href}},72005:(e,t,r)=>{"use strict";var n=r(70879),i=r(65311);e.exports=function(e,t){var r=i(e.children()[0]);if(0!==r.length){var a=i(document),o=i("#container"),s=function(){var n=e.offset(),i=a.scrollTop(),s=r.height(),l=o.offset().top,d=o.height();i+l<n.top?r.css({position:"static"}):!t||i<d-s?r.css({position:"fixed",top:l,left:n.left}):r.css({position:"absolute",top:l+d-s,left:n.left})};i(window).scroll(s).resize((function(){var t=e.offset();r.css({left:t.left})})),s()}else(0,n.BUG)(`ad element not found: ${e.html()}`,"followedAd")}},43652:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isIframe=void 0;t.isIframe=e=>e.parent!==e},42807:(e,t,r)=>{"use strict";var n=r(65311),i=r(66419);e.exports=function(e){var t,r=n.Deferred(),a=0,o=function(){++a===e.length&&r.resolve(t)},s=function(){r.reject(t)};return t=i.map(e,(e=>{var t=n("<img>");return t.on("load",o).on("error",s).attr("src",e),t[0]})),r.promise()}},34418:(e,t,r)=>{"use strict";var n=r(65311),i=r(66419),a=i.template('<span class="user-name-nickname"><%- nickname %></span> <span class="user-name-paren">(</span><span class="user-name-hatena-id">id:<%- hatenaId %></span><span class="user-name-paren">)</span>'),o=function(e,t){var r=t.splice(0,20);n.ajax({url:"https://pf-api.hatena.com/profile/profiles",dataType:"json",data:{name:r},traditional:!0}).done((r=>{!function(e,t){e.each((function(){var e=n(this),r=e.attr("data-user-name");if(t[r]&&t[r].nickname){var i=a({nickname:t[r].nickname,hatenaId:r});e.html(i)}}))}(e,r),t.length>0&&o(e,t)}))};e.exports=function(e){var t=e.find("[data-load-nickname]"),r=[];t.each((function(){var e=n(this).attr("data-user-name");r.push(e)})),0!==(r=i.uniq(r)).length&&o(t,r)}},1514:(e,t,r)=>{"use strict";var n=r(65311),i=r(66419);e.exports=function(e){return i.each(e,((t,r)=>{i.isArray(t)&&1===t.length&&(e[r]=t[0])})),`${location.pathname}?${n.param(e)}`}},10665:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.migrateOldStyleYoutubeURL=void 0;t.migrateOldStyleYoutubeURL=(e,t)=>(e.match(/\/v\//i)&&(e=(e=e.split(/[?&]/)[0]).replace(/\/v\//i,"/embed/")),e=e.replace("youtube.googleapis.com","www.youtube.com"),"https:"!==t&&(e=e.replace(/^https:/,"")),e)},74350:(e,t,r)=>{"use strict";r(65311);var n=r(66419);e.exports=function(e){e.need_comrule2013&&n.defer((()=>{var e=location.hostname.match(/\.hatena\.[^:]+/)[0];window.top.location.href=`http://www${e}/login?need_comrule2013=1`}))}},23218:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=e=>{const t=e.match(/(\d+)-(\d+)-(\d+)T(\d+):(\d+):(\d+)(?:([+|-])(\d+):(\d+)|Z)/);if(!t)return null;const r=new Date(Date.UTC(+t[1],+t[2]-1,+t[3],+t[4],+t[5],+t[6]));return"+"===t[7]?r.setHours(r.getHours()-+t[8],r.getMinutes()-+t[9]):"-"===t[7]&&r.setHours(r.getHours()+ +t[8],r.getMinutes()+ +t[9]),r}},76804:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=e=>Object.keys(e).map((t=>`${t}=${e[t]}`)).join(",");t.default=r},1780:(e,t,r)=>{"use strict";var n=r(66419);e.exports=function(e){n.defer((()=>{e.find(":submit").prop("disabled",!0)}))}},847:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderNicknames=void 0;var n,i=(n=r(67294))&&n.__esModule?n:{default:n},a=r(73380),o=r(68853),s=r(76932),l=r(70879),d=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=u(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(78754));function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(u=function(e){return e?r:t})(e)}const c=d.array(d.string());t.renderNicknames=e=>{if(!e)return;const t=e.querySelectorAll("[data-load-nickname]"),r=(0,o.createNicknameDataloader)();t.forEach((e=>{const t=e.getAttribute("data-user-name"),n=(e=>{if(!e)return[];try{return c.parse(JSON.parse(e))}catch(e){return(0,l.BUG)(e,"renderNicknames: input invalid data attribute"),[]}})(e.getAttribute("data-authors"));t&&(0,a.safeRender)(i.default.createElement(s.Nickname,{dataloader:r,hatenaID:t,authors:n}),e)}))}},82667:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.replaceYoutubeURL=void 0;var n,i=(n=r(65311))&&n.__esModule?n:{default:n},a=r(10665);t.replaceYoutubeURL=e=>{const t=e.get(0).ownerDocument.location.protocol;e.find('iframe[src*="youtube.com/"],iframe[src*="youtube.googleapis.com/"]').each(((e,r)=>{const n=(0,i.default)(r),o=n.attr("src"),s=(0,a.migrateOldStyleYoutubeURL)(o,t);o!==s&&n.attr("src",s)}))}},67279:(e,t,r)=>{"use strict";var n=r(36500);e.exports=function(){const e=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight);n.send("resize",{height:e})}},6220:(e,t,r)=>{"use strict";var n=r(65311),i=(r(66419),r(59662));e.exports=function(){if(!i.isTouch&&n.fn.tipsy){var e={left:"e",right:"w",bottom:"n",top:"s",northwest:"nw",southwest:"sw",northeast:"ne",southeast:"se"},t=n(document.body);for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=`.tipsy-${r}`,o=e[r];t.tipsy({gravity:o,fade:!1,opacity:1,live:a})}}}},44343:(e,t)=>{"use strict";function r(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(t,"__esModule",{value:!0}),t.ShortenText=void 0;t.ShortenText=class{constructor(e,t){r(this,"originalText",""),this.options={symbol:"...",reduce:1,...t},this.$el=e,this.$el.css({overflow:"hidden"})}init(e){this.originalText=e}execute(){const e=this.originalText,t=this.$el,r=t.clone();r.attr("id","").css({display:"none",position:"absolute",overflow:"visible",width:t.css("width"),height:"auto"}).text(e),t.after(r);let n=e,i=e;if(r.height()>t.height())for(;n.length>0&&r.height()>t.height();)[n,i]=this.shorten(n),r.text(i);t.text(i),r.remove()}shorten(e){const t=this.options,r=[e.slice(0,Math.floor((e.length-t.reduce)/2)),t.symbol,e.slice(Math.floor((e.length-t.reduce)/2)+t.reduce,e.length)];return[r[0]+r[2],r[0]+r[1]+r[2]]}}},48379:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showBookmarkCounts=void 0;var n=r(60361);t.showBookmarkCounts=async()=>{const e=document.querySelectorAll(".js-bookmark-count"),t=Array.from(e,(e=>e.getAttribute("data-entry-url")||"")),{data:r}=await n.bookmarkLoader.loadEntriesBookmarksCountDirectly(t);e.forEach((e=>{const t=e.getAttribute("data-entry-url")||"",n=r[t];n&&(e.textContent=String(n))}))}},32920:(e,t,r)=>{"use strict";const n=r(65311),i=r(66419),a=r(26410);e.exports=function(e){var t=n(`<div class="hatena-globalheader-window message"><div class="message">${i.escape(e)}</div></div>`).css({width:200,height:"auto",right:"auto",left:(n(window).width()-200)/2}).appendTo(document.body);a.show(t,{destroy:function(){t.remove()}})}},9467:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.starLoader=void 0;var n,i=(n=r(347))&&n.__esModule?n:{default:n};const a={loadBlogStarsCounts:e=>(0,i.default)({method:"get",url:"/api/hatena_star/blog_stars_counts",params:{blog_id:e},responseType:"json"}),loadEntriesStarsCount:(e,t)=>(0,i.default)({method:"get",url:"/api/hatena_star/entries_stars_count",params:{blog_id:e,e:t},responseType:"json"})};t.starLoader=a},26307:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;const r="text-unselectable",n=document.body;var i={on:()=>{n&&n.classList.add(r)},off:()=>{n&&n.classList.remove(r)}};t.default=i},64292:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.trimString=void 0;t.trimString=(e,t)=>{const r=e.replace(/\s+/g," ");return r.length>t?r.slice(0,t-1).replace(/[\uD800-\uDBFF]$/,"")+"":r}},78899:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateDynamicPieces=void 0;var n,i=(n=r(20996))&&n.__esModule?n:{default:n},a=r(53736),o=r(847);const s=r(50477);t.updateDynamicPieces=e=>{i.default.updateTimestamps(e[0]),document.dispatchEvent(new Event("hatena:star:requestrendering")),(0,o.renderNicknames)(e.get(0)),(0,a.attachGroupBannerQueryParameters)(),s.load(e)}},69152:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getUserIconUrl=t.DEFAULT_USER_ICON_URL=void 0;t.getUserIconUrl=e=>`https://cdn.profile-image.st-hatena.com/users/${encodeURIComponent(e)}/profile.gif`;t.DEFAULT_USER_ICON_URL="https://cdn.profile-image.st-hatena.com/default_profile_images/profile.gif"},68410:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.USER_NAME_PATTERN=void 0;t.USER_NAME_PATTERN=/^[a-zA-Z][A-Za-z0-9_-]{2,31}$/},28507:e=>{"use strict";e.exports=function(e,t,r){r||(r=500);var n=function(){return!!e()&&(t(),!0)};if(!n())var i=setInterval((()=>{n()&&clearInterval(i)}),r)}},347:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.withEpicRKs=t.traditionalDataRequest=t.removeXRequestWith=t.formDataRequest=t.default=void 0;var n=o(r(9669)),i=o(r(80129)),a=o(r(57942));function o(e){return e&&e.__esModule?e:{default:e}}const s=n.default.create();s.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";t.traditionalDataRequest=e=>i.default.stringify(e,{arrayFormat:"repeat"});t.formDataRequest=e=>i.default.stringify(e);t.removeXRequestWith=(e,t)=>(delete t.common["X-Requested-With"],e);t.withEpicRKs=e=>({...e,rkm:(0,a.default)("rkm"),rkc:(0,a.default)("rkc")});var l=s;t.default=l},49651:(e,t)=>{"use strict";let r;Object.defineProperty(t,"__esModule",{value:!0}),t.env=void 0;const n={get NODE_ENV(){if(r)return r;const e=document.querySelector("#hatenablog-js");return e&&(r=e.getAttribute("data-env")),r||"production"},set NODE_ENV(e){r=e}};t.env=n},74126:(e,t,r)=>{"use strict";var n,i=r(41960),a=(n=r(57942))&&n.__esModule?n:{default:n};r(5010);var o=r(66419);window._=o,window.Messenger=r(36500),window.keyString=i.keyString,window.Hatena=window.Hatena||{},r.p=`${(0,a.default)("static-domain")}/js/`,window.Hatena.Diary=o.extend(window.Hatena.Diary||{},{AppAPI:r(39769),GlobalHeader:r(75225),GlobalHeaderPage:r(11229)});r(56412).setControllers(r(26065)),r(34157)()},34157:(e,t,r)=>{"use strict";var n=r(70879),i=r(51525);const a=r(65311),o=r(66419),s=r(91269),l=r(37914),d=r(56412),u=r(85814),c=r(6220);let p=!1;e.exports=function(){a((()=>{p||(p=!0,s.load(),d.loadPage(),c(),u())})),l.domainType()===l.Admin&&(window.onerror=o.once(((e,t,r,i)=>{(0,n.BUG)(`${e} at ${r}:${i}`,"window.onerror",{reportToSentry:!1})}))),(0,i.initializeSentry)()}},41960:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.keyString=function(e){let t="",i=e.which;e.ctrlKey&&(t+="C-");e.altKey&&(t+="M-");e.metaKey&&(t+="W-");if(0===i)e.shiftKey&&(t+="S-"),t+=r[e.keyCode];else{const r=n[i];"string"==typeof r?(e.shiftKey&&(t+="S-"),t+=r):(e.ctrlKey&&i<=26&&(i+=64),65<=i&&i<=90||97<=i&&i<=122?t+=String.fromCharCode(i)[e.shiftKey?"toUpperCase":"toLowerCase"]():(e.keyCode&&e.shiftKey&&(t+="S-"),t+=String.fromCharCode(i)))}return t};const r={9:"TAB",27:"ESC",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12"},n={8:"BS",9:"TAB",16:"",17:"",18:"",27:"ESC",13:"RET",32:"SPC",224:""}},5010:(e,t,r)=>{"use strict";r(49774),r(84581),r(21793),r(59152),r(25544),r(52390)},99057:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pushToDataLayer=void 0;t.pushToDataLayer=e=>{window.dataLayer||(window.dataLayer=[]),window.dataLayer.push(e)}},49774:()=>{"use strict";window.define=void 0},37355:(e,t,r)=>{var n={"./ja":39183,"./ja.js":39183};function i(e){var t=a(e);return r(t)}function a(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}i.keys=function(){return Object.keys(n)},i.resolve=a,e.exports=i,i.id=37355},39305:e=>{"use strict";e.exports=__hatena_locale_texts__},65311:e=>{"use strict";e.exports=jQuery},24654:()=>{}},r={};function n(e){var i=r[e];if(void 0!==i)return i.exports;var a=r[e]={id:e,loaded:!1,exports:{}};return t[e].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}n.m=t,e=[],n.O=(t,r,i,a)=>{if(!r){var o=1/0;for(u=0;u<e.length;u++){for(var[r,i,a]=e[u],s=!0,l=0;l<r.length;l++)(!1&a||o>=a)&&Object.keys(n.O).every((e=>n.O[e](r[l])))?r.splice(l--,1):(s=!1,a<o&&(o=a));if(s){e.splice(u--,1);var d=i();void 0!==d&&(t=d)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[r,i,a]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n.j=507,(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var i=r.length-1;i>-1&&!e;)e=r[i--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),(()=>{var e={507:0};n.O.j=t=>0===e[t];var t=(t,r)=>{var i,a,[o,s,l]=r,d=0;if(o.some((t=>0!==e[t]))){for(i in s)n.o(s,i)&&(n.m[i]=s[i]);if(l)var u=l(n)}for(t&&t(r);d<o.length;d++)a=o[d],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(u)},r=globalThis.webpackChunkHatena_Epic=globalThis.webpackChunkHatena_Epic||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var i=n.O(void 0,[736],(()=>n(74126)));i=n.O(i)})();
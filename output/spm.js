var sohuSpm=function(){"use strict";var t,e,n,o,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},a=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),c=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)};void 0===Array.prototype.filter&&(Array.prototype.filter=function(t){if(void 0===this&&null===this)throw new TypeError;if("function"!=typeof t)throw new TypeError;for(var e=[],n=0;n<this.length;n++)t(this[n])&&e.push(this[n]);return e}),void 0===Array.prototype.forEach&&(Array.prototype.forEach=function(t){if(void 0===this&&null===this)throw new TypeError;if("function"!=typeof t)throw new TypeError;for(var e=0;e<this.length;e++)t(this[e],e,this)}),void 0===Array.prototype.indexOf&&(Array.prototype.indexOf=function(t){if(void 0===this&&null===this)throw new TypeError;for(var e=-1,n=0;n<this.length;n++)if(this[n]===t){e=n;break}return e}),void 0===Array.prototype.map&&(Array.prototype.map=function(t){for(var e=[],n=0,o=this.length;n<o;n++)e.push(t(this[n]));return e}),Array.from||(Array.from=function(t){for(var e=[],n=0;n<t.length;n++)e.push(t[n]);return e}),Object.entries||(Object.entries=function(t){for(var e=Object.keys(t),n=e.length,o=new Array(n);n--;)o[n]=[e[n],t[e[n]]];return o}),Object.keys||(Object.keys=(t=Object.prototype.hasOwnProperty,e=!{toString:null}.propertyIsEnumerable("toString"),o=(n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(i){if("object"!==(void 0===i?"undefined":r(i))&&"function"!=typeof i||null===i)throw new TypeError("Object.keys called on non-object");var a=[];for(var c in i)t.call(i,c)&&a.push(c);if(e)for(var u=0;u<o;u++)t.call(i,n[u])&&a.push(n[u]);return a})),Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)});var u,s=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7,e="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";return Array.from(Array(t)).map(function(t){return e[parseInt(Math.random()*e.length)]}).join("")},d=function(t){if(!(t=t||document.createElement("a")).tagName||"A"!==t.tagName||null===t.getAttribute("href"))return!1;if("true"===t.getAttribute("data-spm-force")||!0===t.getAttribute("data-spm-force"))return!0;var e=t.href;return!!/^[^?]*sohu.com/g.test(e)},l=function(t){var e=t||"",n=document.querySelector("body[data-spm-ext]"),o=n&&n.getAttribute("data-spm-ext");return o&&(e=t?t+";"+o:o),e},p=Array.from(document.getElementsByTagName("meta")).filter(function(t){return"data-spm"===t.getAttribute("name")}),f=p.length?p[0].getAttribute("content"):"null",m=document.querySelector("body")&&document.querySelector("body").getAttribute("data-spm"),h=window.sohuSpm&&window.sohuSpm._eCode||(new Date).getTime()+s(7)+((u=function(t){var e=t||"",n=document.querySelector("body[data-spm-ext]"),o=n&&n.getAttribute("data-spm-ext");o&&(e=t?t+";"+o:o);var r={};return e.split(";").map(function(t){var e=t.split(":");r[e[0]]=e[1]}),r}().productId)?"_"+u:""),g=function(){return{a:f,b:m,c:0,d:0,e:h}},v=function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:150,o=!0;return function(){return o?(t(),o=!1):!e&&void(e=setTimeout(function(){clearTimeout(e),e=null,t()},n))}},w=function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];if(window.console)try{var r;setTimeout((r=console[t]).bind.apply(r,[console].concat(n)))}catch(t){}},y=function(t){return Array.from(document.querySelectorAll(t))},b=function(t){var e=window.innerHeight||document.documentElement.clientHeight,n=window.innerWidth||document.documentElement.clientWidth,o=t.getBoundingClientRect(),r=o.top,i=o.bottom,a=o.left,c=o.right,u=o.height,s=o.width;u=u||t.offsetHeight,s=s||t.offsetWidth,i=e-i,c=n-c;var d=0,l=0;if(r>-1*u&&r<0)d=r+u;else if(i>-1*u&&i<0)d=i+u;else{if(!(i>=0&&r>=0))return!1;d=u}if(a>-1*s&&a<0)l=a+s;else if(c>-1*s&&c<0)l=c+s;else{if(!(c>=0&&a>=0))return!1;l=s}return d*l>=s*u*.3},A=function(t){if("function"!=typeof document.elementsFromPoint)return b(t);t.getBoundingClientRect=t.getBoundingClientRect||function(){return{}};var e=t.getBoundingClientRect(),n=e.left,o=e.right,r=e.top,i=e.bottom,a=function(e,n,o){for(var r=document.elementsFromPoint(n,o),i=0;i<r.length;i++){var a=getComputedStyle(r[i]);if(e===r[i]||!(a.opacity<1||"none"===a.display||-1===["collapse","hidden"].indexOf(t.style.visibility)))return r[i]}return r[0]};return!!b(t)&&(t.contains(a(t,n,r))||t.contains(a(t,o,r))||t.contains(a(t,o,i))||t.contains(a(t,n,i))||t.contains(a(t,n+(o-n)/2,r+(i-r)/2)))},S=[];function _(){for(var t=S.concat(),e=window.innerHeight||document.documentElement.clientHeight,n=0;n<S.length;n++){var o=S[n];o.getBoundingClientRect=o.getBoundingClientRect||function(){return{}};var r=o.getBoundingClientRect(),i=r.top,a=r.height,u=r.width;if(a=a||o.offsetHeight,u=u||o.offsetWidth,!(0===a&&0===u||i>e)){(o.hasAttribute("data-spm-visible")?"true"===o.getAttribute("data-spm-visible"):o.getAttribute("data-spm-strict")?A(o):b(o))&&(o.trigger&&o.trigger("exposure"),t.splice(t.indexOf(o),1))}}S.length=0,S.push.apply(S,c(t))}var C=function(t){return"A"===t.tagName||"content"===t.getAttribute("data-spm-type")||"promotion"===t.getAttribute("data-spm-type")||"ad"===t.getAttribute("data-spm-type")||t.getAttribute("data-spm-acode")},k=function(t,e,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(null===t.getAttribute(e)||o)&&t.setAttribute(e,n)},E=function(t){return window.encodeURIComponent&&"function"==typeof encodeURIComponent?encodeURIComponent(t):window.encodeURI&&"function"==typeof window.encodeURI?window.encodeURI(t):t},I=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"spm",n=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),o=t.match(n);return o&&unescape(o[2])||""},R=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"spm";return I(window.location.search.substr(1),t)},j=function(t){if(!t||!t.href)return{};if(!~t.href.indexOf("//"))return{spmUrl:t.href};var e=t.href.split("//")[1].split("/");e.splice(0,1);var n=e.join("/").split("?");return e=n[0],{scmCnt:I(n[1]||"","scm"),spmUrl:e}};function x(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window,o={click:"onclick",scroll:"onmousewheel"}[t]||t,r="scroll"===t?v(e):e;window.attachEvent?n.attachEvent(o,r):n.addEventListener(t,r)}var D=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!t)return"";if(!t.match(/\/\//))return t;var o=!0,r=!0,i=R("_trans_"),a=new RegExp("(\\?|&|^)spm=([^&]*)(&|$)","g"),c=new RegExp("(\\?|&|^)_trans_=([^&]*)(&|$)","g");t.match(a)&&(o=!1),t.match(c)&&(r=!1);var u=[];o&&u.push("spm="+e),r&&i&&u.push("_trans_="+i);var s,d=t.split("#"),l=(s=d,Array.isArray(s)?s:Array.from(s)),p=l[0],f=l.slice(1);return(f=f.join("#"))&&(f="#"+f),"true"===n&&(p+=f,f=""),u.length&&(~p.indexOf("?")?p+="&"+u.join("&"):p+="?"+u.join("&")),p+f},O={client:[],listen:function(t,e){var n=this._spmHashID;this.client[n]||(this.client[n]=[]),this.client[n][t]||(this.client[n][t]=[]),this.client[n][t].push(e)},trigger:function(){var t=Array.prototype.shift.call(arguments),e=this._spmHashID,n=this.client[e]&&this.client[e][t];if(!n||0===n.length)return!1;n.forEach(function(t){t.apply(this,arguments)})}};function U(t){for(var e in O)t[e]=O[e]}var P="1.0.5",H="https:"===window.location.protocol?"https:":"http:",T="track.sohu.com";window.sohuSpm&&window.sohuSpm.isDebug&&(T="test.track.sohuno.com");var q=H+"//"+T;function B(){return{page_refer_url:document.referrer.slice(0,200),device_resolution:window.screen.width+"_"+window.screen.height+"_"+(window.devicePixelRatio||1),"spm-pre":R(),"scm-cnt":R("scm"),"pvid-pre":R().split(".")[4]||"",pvid:h,traffic_trans:R("traffic_trans"),jump:R("jump"),js_version:window.spv_flag?P+"_pre":P}}var M=600;var N=new(function(){function t(){var e=this;i(this,t),this._actionCollector={},this._sender=setInterval(function(){for(var t in e._actionCollector)e.sendActionBatch(t)},M)}return a(t,[{key:"sendActionToCollector",value:function(t,e){this._actionCollector[t]?this._actionCollector[t].push(e):this._actionCollector[t]=[e]}},{key:"sendActionBatch",value:function(t){var e=this._actionCollector[t];if(0!==e.length){for(var n=e[0],o=[],r="",i=0;e.length>0;){var a=e[0];if(a.clk_param=a.clk_param||"",5500===(i+=a.clk_param.length)||i>5500)break;o.push(a.clk_param),e.shift()}1===o.length?r=o[0]:(r="[{",r+=o.join("},{"),r+="}]"),n.clk_param=r;var c=Object.entries(n).map(function(t){return t.map(function(t){return e=t,"undefined"==typeof global?encodeURIComponent&&"function"==typeof encodeURIComponent?encodeURIComponent(e):encodeURI&&"function"==typeof encodeURI?encodeURI(e):e:global.encodeURIComponent&&"function"==typeof encodeURIComponent?encodeURIComponent(e):global.encodeURI&&"function"==typeof global.encodeURI?global.encodeURI(e):e;var e}).join("=")}).join("&");(new Image).src="//track.sohu.com/sa.gif?"+c}}}]),t}()),W=window.sohuSpm&&window.sohuSpm._customSenders&&"function"==typeof window.sohuSpm._customSenders.actionSender&&window._customSenders.actionSender||function(t){window.sohuSpm&&window.sohuSpm.isDebug&&w("log","%c SpmAv %c Send:","background:#fccf2f;color:#3d2e16;","color:#fccf2f;background:#3d2e16"),window.sohuSpm&&window.sohuSpm.isDebug&&w("table",t),N.sendActionToCollector(t.acode,t)},$=function(t){var e=t.acode,n=void 0===e?"":e,o=t.clkParam,i=void 0===o?"":o,a=t.spm,c=void 0===a?"":a,u=B();u.ext=l(),u["spm-cnt"]=c||f+"."+m+".0.0."+h,u.acode=n,u.clk_param="null"===i?"":i,u.clk_param="object"===r(u.clk_param)?JSON.stringify(u.clk_param):u.clk_param,u.cache=s(5),W(u)},F=function(t,e){var n=e.split(".")[3]||0;if(k(t,"data-spm-data",n),t.getAttribute("data-spm-acode")&&x("click",function(){$({acode:t.getAttribute("data-spm-acode"),clkParam:E(t.getAttribute("data-spm-click-pm")),spm:e})},t),d(t)&&k(t,"href",D(t.href,""+e,t.getAttribute("data-spm-hashrouter")),!0),"promotion"===t.getAttribute("data-spm-type")){var o=void 0;if(t.getAttribute("data-spm-promo"))o="promotion-"+t.getAttribute("data-spm-promo");else if(t.href){var r=t.href.split("//")[1].split("/");r.splice(0,1);var i=r.join("/").split("?");r=i[0];var a=i[1]||"",c=new RegExp("(^|&)posId=([^&]*)(&|$)","i"),u=a.match(c),s=new RegExp("(^|&)itemId=([^&]*)(&|$)","i"),l=a.match(s),p=u&&u[2]||"",f=l&&l[2]||"";o="promotion-"+p+"_"+f}return k(t,"data-spm-content",o),t.getAttribute("data-spm-content-value")&&(U(t),x("click",function(t){$({acode:3600,clkParam:{promotion:o},spm:e})},t)),o}if("ad"===t.getAttribute("data-spm-type"))return k(t,"data-spm-content","ad"),"ad"},L=[],V=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];L=t.length>0?t:[]},z=function(t){var e=t.spmCnt,n=t.url,o=t.scmCnt;L.push({spmCnt:e,url:n,scmCnt:o})},J=function t(){var e=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;L.length||z({spmCnt:f+"."+m+".0.0."+h});for(var e={},n="",o=L.concat(),r=["spmCnt","url","scmCnt"],i=function(i){var a=L[i],c=r.map(function(t){return a[t]||""}).join(",");if(!e[c])if(0===i)n=c;else{if(n.length+c.length+1>t)return"break";n+=";"+c}o.shift()},a=0;a<L.length&&"break"!==i(a);a++);return V(o),n}(),n=B();window.spmExtSwitch&&(n.ext=l());var o=Object.entries(n).map(function(t){return t.map(function(t){return E(t)}).join("=")}).join("&");if(function(t){var e=new Image;e.src=t}(q+"/se.gif?"+o+"&spm-cnt-arr="+E(e)),L.length&&t(),window.sohuSpm&&window.sohuSpm.isDebug){w("log","%c SpmEv %c Send:","background:#fccf2f;color:#3d2e16;","color:#fccf2f;background:#3d2e16");var r=e.split(";").map(function(t){return function(t){var e={},n=t.split(",");return e.spm_code=n[0],e.content=n[1],e.scm=n[2],e}(t)});w("table",r,["spm_code","content","scm"])}},K=(setInterval(function(){L.length&&J()},600),z),Y=window.sohuSpm&&window.sohuSpm._customSenders&&"function"==typeof window.sohuSpm._customSenders.evSender&&window._customSenders.evSender,G=Y||K,Q=Y?function(){return Y({spmCnt:f+"."+m+".0.0."+h})}:J,X=[],Z=function(){for(var t=[],e=X.concat(),n=window.innerHeight||document.documentElement.clientHeight,o=0;o<X.length;o++){var r=X[o],i=r.el,a=r.container,u=r.spmCnt,s=void 0===u?"":u,d=r.url,l=void 0===d?"":d,p=r.scmCnt,f=void 0===p?"":p;(i=i||a).getBoundingClientRect=i.getBoundingClientRect||function(){return{}};var m=i.getBoundingClientRect(),h=m.top,g=m.height,v=m.width;if(g=g||i.offsetHeight,v=v||i.offsetWidth,!(0===g&&0===v||h>n)){(i.hasAttribute("data-spm-visible")?"true"===i.getAttribute("data-spm-visible"):i.getAttribute("data-spm-strict")?A(i):b(i))&&t.push({spmCnt:s,url:l,scmCnt:f})}}return X.length=0,X.push.apply(X,c(e)),t},tt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.target,n=t.willIgnore,o=[];try{o=y("[data-spm]:not(a):not(body)")}catch(t){o=y("*").filter(function(t){return t.getAttribute("data-spm")&&"BODY"!==t.tagName})}o.forEach(function(t){if(!(e&&t.getAttribute("data-spm")!==e||"init"===t.getAttribute("data-spm-stop")&&n)){Array.from(t.querySelectorAll("*")).filter(function(t){return"resource"===t.getAttribute("data-spm-type")}).forEach(function(t){Array.from(t.querySelectorAll("a, [data-spm-type], [data-spm-acode]")).forEach(function(t){try{t._isSpmChild=!0}catch(t){}})});var o=Array.from(t.querySelectorAll("a, [data-spm-type], [data-spm-acode]")).filter(function(t){return!!(e=t)&&!e._isSpmChild&&"nev"!==e.getAttribute("data-spm-stop")&&("resource"===e.getAttribute("data-spm-type")||C(e));var e}),r=o.filter(function(t){return!t._spmHashID}),i=o.length-r.length;r.forEach(function(e){C(e)?function(t,e,n){if(!t._spmHashID){var o=t.getAttribute("data-spm-data")||n,r=E(f+"."+m+"."+e.getAttribute("data-spm")+"."+o+"."+h);F(t,r);var i=j(t),a=i.spmUrl,c=i.scmCnt,u=t.getAttribute("data-spm-content")||a;t._spmHashID=s(7),U(t),t.listen("exposure",function(){window.spmExtSwitch="close"===e.getAttribute("data-spm-ext-switch")?"":l(),G({spmCnt:r,url:u,scmCnt:c})}),S.push(t),X.push({el:t,spmCnt:r,url:u,scmCnt:c})}}(e,t,++i):function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(!t._spmHashID){var o=t.getAttribute("data-spm-data")||n;k(t,"data-spm-data",o,!0);var r=E(f+"."+m+"."+e.getAttribute("data-spm")+"."+o+"."+h);Array.from(t.querySelectorAll("*")).filter(function(t){return C(t)}).forEach(function(t){F(t,r)});var i=t.querySelector("[data-spm-type='content']")||t.querySelector("a, [data-spm-acode], [data-spm-type]")||t,a=j(i),c=a.spmUrl,u=a.scmCnt;k(t,"data-spm-content",i.getAttribute("data-spm-content")||c),t._spmHashID=s(7),U(t),t.listen("exposure",function(){window.spmExtSwitch="close"===e.getAttribute("data-spm-ext-switch")?"":l(),G({spmCnt:r,url:t.getAttribute("data-spm-content")||c,scmCnt:u})}),S.push(t),X.push({container:t,spmCnt:r,url:t.getAttribute("data-spm-content")||c,scmCnt:u})}}(e,t,++i)})}}),_()},et=window.sohuSpm&&window.sohuSpm._customSenders&&"function"==typeof window.sohuSpm._customSenders.pvSender&&window._customSenders.pvSender||function(t){var e=new Image,n=Object.entries(t).map(function(t){return t.map(function(t){return E(t)}).join("=")}).join("&");window.sohuSpm&&window.sohuSpm.isDebug&&w("log","%c SpmPv %c Send:","background:#fccf2f;color:#3d2e16;","color:#fccf2f;background:#3d2e16"),window.sohuSpm&&window.sohuSpm.isDebug&&w("table",t),e.src=q+"/sv.gif?"+n},nt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{forceUpdate:!1,extData:""};t.forceUpdate&&(f=p.length?p[0].getAttribute("content"):"null",m=document.querySelector("body")&&document.querySelector("body").getAttribute("data-spm"),h=(new Date).getTime()+s(7),function(){for(var t,e,n=document.querySelectorAll("a[data-spm-data]"),o=0;o<n.length;o++){var r=n[o];d(r)&&(r.href=(t=r.href,e=h,t.replace(/(spm=[\w-_%]*\.[\w-_%]*\.[\w-_%]*\.[\w-_%]*)\.\w{20}/g,"$1."+e)))}}());var e=B();e.ext=l(t.extData),e["spm-cnt"]=f+"."+m+".0.0."+h,et(e),Q()},ot=function(){x("scroll",function(){_()},document),x("touchmove",function(){_()},document),x("AppVisibleChange_SPM",function(t){t.detail&&t.detail.visibility&&nt()},document)};window.spmExtSwitch=l();var rt=new function(){this.domDidChange=function(t){t?tt(t):v(tt,100)()},this.isDebug=window.sohuSpm&&window.sohuSpm.isDebug,this.getCodes=g,this.reScan=_,this.sendAction=$,this.sendPv=nt,this.getCntCodes=Z,this.init=function(){try{if(nt({extData:location.hash?"page_url:"+location.href:""}),tt({willIgnore:!0}),ot(),w("log","%c Sohu %c SPM %c v"+P+" has initialized!","background:#fccf2f;color:#3d2e16;","color:#fccf2f;background:#3d2e16",""),this.isDebug&&(w("log","%c Sohu %c SPM %c Debug mode ON!","background:#fccf2f;color:#3d2e16;","color:#fccf2f;background:#3d2e16","color: red"),w("log","%c Sohu %c SPM %c Please be informed that when you see this information, SohuSPM SDK may have completed most of the initialization work. The work of sending PV and EV and the installation of events may have been completed.","background:#fccf2f;color:#3d2e16;","color:#fccf2f;background:#3d2e16","")),"function"==typeof Event){var t=new Event("LoadFinished_SPM");document.dispatchEvent(t)}else{var e=document.createEvent("Event");e.initEvent("LoadFinished_SPM",!0,!0),document.dispatchEvent(e)}}catch(t){}}};return rt.init(),window.sohuSpm=rt,rt}();

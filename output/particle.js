!function(){function e(t){var i;return function(e){return i||t(i={exports:{},parent:e},i.exports),i.exports}}var t,u=e(function(e,t){"use strict";var d=i(p),l=i(a({})),c=i(r({}));function i(e){return e&&e.__esModule?e:{default:e}}t.initialise=function(){window.addEventListener("message",function(e){if(!d.default.isInternal()&&e.origin.match(/eip\.telegraph\.co\.uk/)&&s(e.data)){var t,i="string"==typeof e.data?JSON.parse(e.data):e.data;if(i.id&&i.index){d.default.info("Telegraph has received a new message from particle",i);var r=document.querySelector("[particle-id='"+i.id+"'][particle-index='"+i.index+"']"),a="generic";switch(document.querySelectorAll("meta[name='tmgads.businessSegment']")[0]&&(a=document.querySelectorAll("meta[name='tmgads.businessSegment']")[0].content),i.type){case"ready":d.default.info(i.id+" ("+i.index+") - Ready"),r.style.display="block";break;case"resize":l.default.update(r,i);break;case"expandable":d.default.info("Request to remove legacy show more from particle "+i.id+" has been received"),l.default.removeLegacyShowMore(r,i.id);break;case"tmg":c.default.tmgModel(i);break;case"window":c.default.windowModel(i);break;case"cookie":c.default.cookieModel(i);break;case"subscribe":window.location.href="https://secure.telegraph.co.uk/customer/secure/checkout/?productId=nyytq4zthbvwsoliojugwyzzmyzha3dt&offerId=freetrial1-website-monthly-PC259&campaignId=839X&icid="+a+"_genericsub_generic_generic_particle_"+i.id+"&redirectTo="+encodeURIComponent(window.location.href);break;case"register":window.location.href="https://secure.telegraph.co.uk/customer/secure/register?redirectTo="+encodeURIComponent(window.location.href)+"&q=registration&icid="+a+"_genericreg_generic_generic_particle_"+i.id;break;case"login":window.location.href="https://secure.telegraph.co.uk/secure/login/?ICID="+a+"_genericreg_generic_generic_particle_"+i.id+"&redirectTo="+encodeURIComponent(window.location.href);break;case"app-redirect":window.location.pathname=i.data.urlPath;break;case"showNewsletterContainer":d.default.info("Request to show the martech newsletter received","#wrp-"+i.id+" .particle-newsletter-overlay");var n=document.querySelector("#wrp-"+i.id+" .particle-newsletter-overlay");n&&(n.style.display="block");break;default:d.default.info("Legacy particle message received, please update before July 2021",i)}}else i.id&&(t=document.querySelector("[particle-id='"+i.id+"']"),i.height)&&l.default.legacyHeightUpdate(t,i)}if((d.default.isInternal()&&e.origin.match(/telegraph\.co\.uk/)||d.default.isInternal()&&e.origin.match(/localhost/)||d.default.isInternal()&&e.origin.match(/eip\.telegraph\.co\.uk/))&&s(e.data)){var o=JSON.parse(e.data);if(o.id===window.particleData.id&&o.index===window.particleData.i)switch(d.default.info("Particle has received a new message from the telegraph",o),o.type){case"tmg":d.default.info("New TMG variable data received",o),window.dispatchEvent(new CustomEvent("particleDataEvent",{detail:o}));break;case"window":d.default.info("New WINDOW variable data received",o),window.dispatchEvent(new CustomEvent("particleDataEvent",{detail:o}));break;case"cookie":d.default.info("New COOKIE received",o),window.dispatchEvent(new CustomEvent("particleDataEvent",{detail:o}))}}})},t.sendFromParticle=function(e,t){window.particleData.amp||(d.default.info("Particle ("+window.particleData.id+" ["+window.particleData.i+"]) is sending a message to the telegraph"),window.parent.postMessage(JSON.stringify({id:window.particleData.id,index:window.particleData.i,type:e,data:t}),"*")),window.particleData.amp&&"resize"===e&&(d.default.info("Particle is sending a message to AMP (Height: "+Math.max(t.height,100)+"px)"),window.parent.postMessage({sentinel:"amp",type:"embed-size",height:Math.max(t.height,100)},"*"))},t.sendFromTelegraph=function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,a=document.querySelector('[particle-index="'+r+'"][particle-id="'+i+'"]');d.default.info("Telegraph is sending a message to particle "+i+" (INDEX "+r+")"),a.contentWindow.postMessage(JSON.stringify({id:i,index:r,type:e,data:t}),"*")};var s=function(e){try{JSON.parse(e)}catch(e){return!1}return!0}}),r=e(function(e,t){"use strict";var i,r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var i=e,r=t,a=[],n=!0,e=!1,t=void 0;try{for(var o,d=i[Symbol.iterator]();!(n=(o=d.next()).done)&&(a.push(o.value),!r||a.length!==r);n=!0);}catch(i){e=!0,t=i}finally{try{!n&&d.return&&d.return()}finally{if(e)throw t}}return a}throw new TypeError("Invalid attempt to destructure non-iterable instance")},a=(i=p)&&i.__esModule?i:{default:i},n=u({});function o(e,t){var i;return void 0!==e&&(-1<(i=t.indexOf("."))?o(e[t.substring(0,i)],t.substr(i+1)):e[t])}t.tmgModel=function(e){a.default.info("New tmg factory request",e.data),(0,n.sendFromTelegraph)("tmg",{property:e.data.property,value:!0===e.data.isFunction?o(window.tmg,e.data.property)():o(window.tmg,e.data.property)},e.id,e.index)},t.windowModel=function(e){a.default.info("New window factory request",e.data),(0,n.sendFromTelegraph)("window",{property:e.data.property,value:!0===e.data.isFunction?o(window,e.data.property)():o(window,e.data.property)},e.id,e.index)},t.cookieModel=function(e){var t,i;a.default.info("New cookie factory request",e.data),(0,n.sendFromTelegraph)("cookie",{name:e.data.cookieName,value:(t=e.data.cookieName,i={},document.cookie.split(";").forEach(function(e){var e=e.split("="),e=r(e,2),t=e[0],e=e[1];i[t.trim()]=e}),i[t])},e.id,e.index)}}),a=e(function(e,t){"use strict";var i=u({}),r=o(p),a=o(g),n=o(f);function o(e){return e&&e.__esModule?e:{default:e}}t.initialise=function(){r.default.info("Initialising resize for",window.particleData.id);var e,t=0;"ResizeObserver"in window?(e=document.getElementById("particle"),new ResizeObserver(function(e){e[0].target.offsetHeight!==t&&e[0].target.offsetHeight!==t+1&&e[0].target.offsetHeight!==t+2&&((0,i.sendFromParticle)("cls",{height:e[0].target.offsetHeight}),t=e[0].target.offsetHeight),d(window.count)}).observe(e),window.addEventListener("instantResize",l)):(window.addEventListener("instantResize",l),window.addEventListener("orientationchange",d),window.addEventListener("resize",d),(0,n.default)(d)),window.particleData.amp&&(window.addEventListener("load",d),window.addEventListener("click",d))};var d=(0,a.default)(function(){var e=document.getElementById("particle");(0,i.sendFromParticle)("resize",{height:e.scrollHeight||e.offsetHeight,width:e.offsetWidth})},200),l=function(){var e=document.getElementById("particle");(0,i.sendFromParticle)("resize",{height:e.scrollHeight||e.offsetHeight,width:e.offsetWidth,instant:!0})},c=(t.update=function(e,t){500<t.data.height&&250<t.data.height-500&&("true"===e.getAttribute("data-widget-expandable")||"true"===e.getAttribute("data-widget-expandable"))?c(t.id,t.index,e,t.data.height+"px"):(e.parentNode&&-1!==e.parentNode.id.indexOf("wrp-")&&(r.default.info("Resize the particle anti-cls wrapper"),e.parentNode.style.background="transparent",e.parentNode.style.minHeight=t.data.height+"px"),t.data.instant&&"height 0.3s linear 0s"===e.style.transition&&(e.style.transition=""),e.style.height=t.data.height+"px",s(t.data.id,e))},t.legacyHeightUpdate=function(e,t){e.style.height=t.height+"px"},t.removeLegacyShowMore=function(e,t){e.setAttribute("data-widget-expandable","false"),document.querySelector(".more-"+t)&&(r.default.info("Removing legacy show more from particle "+t,e),document.querySelector(".more-"+t).parentNode.remove())},function(e,t,i,r){var a=document.querySelectorAll(".more-"+e)[0],n=void 0,o=void 0;a?"none"===a.parentNode.style.display&&(i.style.height=r):(i.style.height="500px",(n=document.createElement("div")).innerHTML='<span class="show-more-button load-more__button article-body-image-caption more-'+e+'"> Show more </span>',n.classList.add("more-wrapper"),(o=document.createElement("link")).href="https://cf.eip.telegraph.co.uk/particle-embed/css/particle-more.css",o.type="text/css",o.rel="stylesheet",i.parentNode.insertBefore(n,i.nextSibling),n.appendChild(o));for(var d=document.querySelectorAll(".more-"+e)[0].cloneNode();document.querySelectorAll(".more-"+e)[0].firstChild;)d.appendChild(document.querySelectorAll(".more-"+e)[0].lastChild);document.querySelectorAll(".more-"+e)[0].parentNode.replaceChild(d,document.querySelectorAll(".more-"+e)[0]),document.querySelectorAll(".more-"+e)[0].addEventListener("click",function(){i.style.height=r,document.querySelector(".more-wrapper").style.display="none"},{once:!0})}),s=function(e){e=document.querySelectorAll(".more-"+e)[0];e&&e.parentNode.remove()}}),p={},n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=(p.info=function(){for(var e,t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];-1!==o().indexOf("logsWontShow")&&(window.particleData&&window.particleData.i?"object"===(void 0===i?"undefined":n(i))&&Array.isArray(i)?(e=console).debug.apply(e,["%c[PARTICLES] "+i.map(function(){return"%o"}).join(""),"color: #FFD700"].concat(i)):console.debug("%c[PARTICLES] %o","color: #FFD700",i):"object"===(void 0===i?"undefined":n(i))&&Array.isArray(i)?(e=console).debug.apply(e,["%c[PARTICLES] "+i.map(function(){return"%o"}).join(""),"color: #4682B4"].concat(i)):console.debug("%c[PARTICLES] %o","color: #4682B4",i))},p.error=function(e){console.error("%c[PARTICLES] "+e,"color: #FF0000")},p.isInternal=function(){return window.particleData&&null!==window.particleData.i&&void 0!==window.particleData.i},function(){return"logsWillShow"+Math.random()}),i={},h=(t=p)&&t.__esModule?t:{default:t};i.generate=function(e,t){var i,r,a,n,o,d,l,c,s,u,p,g,f,w,m=document.createElement("iframe");m.setAttribute("id",e.getAttribute("id")),m.setAttribute("particle-id",e.getAttribute("id")),m.setAttribute("particle-index",t),m.setAttribute("data-widget-size",e.getAttribute("data-widget-size")),m.setAttribute("data-widget-expandable",e.getAttribute("data-expandable")),m.setAttribute("title",e.textContent),m.setAttribute("scrolling","no"),m.setAttribute("allowtransparency","true"),m.setAttribute("frameborder","0"),m.className="tmg-particle-"+e.getAttribute("class").replace("tmg-particle ",""),m.style.width="100%",m.style.minWidth="100%",m.style.border="none",m.style.position="static",m.style.display="block",m.style.height="0px",m.style.padding="0px",m.style.margin="0px",m.style.transition="true"===e.getAttribute("data-urgent")?"":"height .3s linear",m.src=(i=e,t=t,r=!!(window.tmg&&window.tmg.user&&window.tmg.user.isLoggedIn)&&window.tmg.user.isLoggedIn(),a=!!(window.tmg&&window.tmg.user&&window.tmg.user.isLoggedIn&&window.tmg.user.isLoggedIn()&&window.tmg.user.isSubscriber)&&window.tmg.user.isSubscriber(),n=!!(window.tmg&&window.tmg&&window.tmg.page&&window.tmg.page.isApp)&&window.tmg.page.isApp(),o=i.getAttribute("id"),d=i.getAttribute("data-html-uri"),l="true"===i.getAttribute("data-reg-required"),c=i.getAttribute("data-reg-redirect"),s="true"===i.getAttribute("data-sub-required"),u=i.getAttribute("data-sub-redirect"),p="true"===i.getAttribute("data-truncated"),g="true"===i.getAttribute("data-expandable"),i=i.getAttribute("data-prefill"),f=encodeURIComponent(window.location.href),w="default",document.querySelectorAll("meta[name='tmgads.businessSegment']")[0]&&(w=document.querySelectorAll("meta[name='tmgads.businessSegment']")[0].content),l&&c&&!r&&!n&&window.tmg?c+"?i="+t+"&ref="+f+"&channel="+w+"&id="+o+(i?"&prefill="+i:"")+"&isapp="+n+"&isregistered="+(r||n)+"&issubscribed="+(a||n)+"&truncated="+p+"&lt="+g:s&&u&&!a&&!n&&window.tmg?u+"?i="+t+"&ref="+f+"&channel="+w+"&id="+o+(i?"&prefill="+i:"")+"&isapp="+n+"&isregistered="+(r||n)+"&issubscribed="+(a||n)+"&truncated="+p+"&lt="+g:d+"?i="+t+"&ref="+f+"&channel="+w+"&id="+o+(i?"&prefill="+i:"")+"&isapp="+n+"&isregistered="+(r||n)+"&issubscribed="+(a||n)+"&truncated="+p+"&lt="+g),m.addEventListener("load",function(e){h.default.info('Particle loaded | ID: "'+e.target.getAttribute("id")+'" INDEX: '+e.target.getAttribute("particle-index"))},{once:!0}),e.parentNode.insertBefore(m,e.nextSibling),e.parentNode.removeChild(e)};var g={},f=(Object.defineProperty(g,"__esModule",{value:!0}),g.default=function(r,a){var n=void 0;return function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];clearTimeout(n),n=setTimeout(function(){return r.apply(void 0,t)},a)}},{});Object.defineProperty(f,"__esModule",{value:!0});f.default=function e(t){if(["complete","interactive"].includes(document.readyState))return t();document.addEventListener("readystatechange",function(){return e(t)},{once:!0})};var d=s(i),l=s(u({})),c=s(p);function s(e){return e&&e.__esModule?e:{default:e}}window.initialise=function(){window.particles=window.particles||{},window.particles.count=0;var e=w();0<e.length&&void 0===window.particles.interval?(c.default.info("V2 IS LOADED"),window["particle-eip-telegraph-co-uk-script-loaded"]=!0,window.particles.isLoaded=!0,m(e.filter(function(e){return"true"===e.getAttribute("data-urgent")})),window.particles.interval=setInterval(y,20),e&&e.forEach(function(e){return e.style.display="none"})):void 0===window.particles.isLoaded&&void 0!==window["particle-eip-telegraph-co-uk-script-loaded"]&&c.default.info("LEGACY LOADED FIRST")};var w=function(){var e=[].slice.call(document.getElementsByClassName("tmg-particle")),t=[];return e.forEach(function(e){"aside"===e.localName&&t.push(e)}),t},m=function(e){c.default.info("URGENT Particles Initialising",e.map(function(e){return e.textContent}).join(", ")),e.forEach(function(e,t){return d.default.generate(e,t)}),window.particles.count+=e.length},y=function(){var e;(window.tmg&&window.tmg.user||"go.arena.im"===document.location.hostname||document.location.hostname.includes("telegraph.co.uk")||document.location.hostname.includes("localhost:"))&&(clearInterval(window.particles.interval),window.particles.initialised=!0,l.default.initialise(),c.default.info("Particles Initialising"),(e=w()).forEach(function(e,t){return d.default.generate(e,t)}),window.particles.count+=e.length,delete window.particles.interval)};initialise()}();

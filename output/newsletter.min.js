!function(){function e(){var e=Array.from(document.querySelectorAll(".newsletter-subscribe")),t=Array.from(document.querySelectorAll(".newsletter-input.email-address")),n=Array.from(document.querySelectorAll(".subscribe-action.button")),o=document.getElementById("subscribe-all"),s=document.querySelectorAll("input.newsletter-checkbox:not(:checked)").length;e.length?(m=DisneyOneID.config.campaignName,window.oid.getInlineNewsletters(m).then(function(t){var a=/([A-Z() ]+) (.*)/,n=DOMPurify.sanitize(t.data.legal[0].content,{USE_PROFILES:{html:!0},RETURN_DOM_FRAGMENT:!0});window.dtci.newsletters.result[m]=t,e.forEach(function(r){var i=r.querySelector(".newsletter-list"),e=r.querySelector(".newsletter-agreement");r.classList.contains("is-init")||(e.append(n.cloneNode(!0)),t.data.marketing.forEach(function(e){var t,n;"The Undefeated"!==m?((w=e.content.match(a))||(console.warn("Malformed title: "+e.content),w=["","",e.content]),w[1]&&w[2]?(t=w[1].toLowerCase().replace("nfl ","NFL "),n=w[2]):w[2]&&(t=w[2])):t=e.content,(c=document.createElement("label")).innerText=t,c.setAttribute("for",e.code),n&&((d=document.createElement("span")).className="description",d.innerText=n),u=document.createElement("p"),(l=document.createElement("input")).id=e.code,l.type="checkbox",l.name="nl",l.value=e.code,l.className="newsletter-checkbox",l.checked=e.preselected,d&&c.appendChild(d),u.appendChild(l),u.appendChild(c),i&&i.appendChild(u),r.classList.add("is-init"),s||null===o||(o.checked=!0),i&&Array.from(i.querySelectorAll("input.newsletter-checkbox")).forEach(function(e){e.addEventListener("click",function(e){!1===this.checked&&(o.checked=!1)})})}))})})):Array.from(document.querySelectorAll("[data-newsletter]")).forEach(function(n){var r=n.getAttribute("data-newsletter"),e=n.closest(".newsletter-subscribe");console.debug(r),e.classList.contains("newsletter-subscribe--init")||(e.classList.add("newsletter-subscribe--init"),window.oid.getInlineNewsletters(r).then(function(e){var t=DOMPurify.sanitize(e.data.legal[0].content,{USE_PROFILES:{html:!0},RETURN_DOM_FRAGMENT:!0});window.dtci.newsletters.result[r]=e,n.parentNode.parentNode.querySelector(".newsletter-agreement").append(t)}))}),o&&o.addEventListener("click",function(e){!0===this.checked&&Array.from(document.querySelectorAll("input.newsletter-checkbox")).forEach(function(e){e.checked=!0})}),n.length&&(n.forEach(function(e){e.addEventListener("click",window.dtci.newsletters.submitSubscription)}),t.length&&t.forEach(function(t){t.addEventListener("keyup",function(e){13===e.keyCode&&t.parentNode.querySelector(".button").trigger("click")})}))}var c,d,l,u,w,m,o={ALREADY_OPT_IN:"You are already subscribed to that newsletter.",PROFILE_EXISTS:"You are already subscribed.","INVALID_VALUE_PROFILE.EMAIL":"Please provide a valid email address.",MISSING_VALUE_EMAIL:"Please provide a valid email address.",INVALID_EMAIL:"Please provide a valid email address.",MISSING_OPT_IN:"Please select a newsletter.",MISSING_VALUE_MARKETING:"Please select a newsletter.",PROFILE_UPDATE_INVALID:"Please select a newsletter.",GUEST_GATED_AGEBAND:"You are not old enough to subscribe."};window.dtci=window.dtci||{},window.dtci.newsletters=window.dtci.newsletters||{},window.dtci.newsletters.result={},window.dtci.newsletters.showSuccess=function(e){e.classList.add("hidden"),e.parentNode.parentNode.querySelector(".subscribed").classList.remove("hidden")},window.dtci.newsletters.showErrors=function(e,t){var n,r,i=e.querySelector(".errors"),a=e.querySelector(".subscribe-action.button");i.classList.remove("hidden"),r="string"==typeof t?t:t&&t.errors&&t.errors[0]&&t.errors[0].code?t.errors[0].code:"unknown",n=void 0===o[r]?"Sorry! Your subscription attempt failed.":o[r],i.innerText=n,a.removeAttribute("disabled")},window.dtci.newsletters.submitSubscription=function(e){var t,n,r,i,a=e.target,o=a.closest(".newsletter-form"),s=o.parentNode.querySelector(".newsletter-list"),c={},d=o.querySelector("[data-newsletter]")?o.querySelector("[data-newsletter]").getAttribute("data-newsletter"):"",l=o.querySelector(".email-address").value;r=s?DisneyOneID.config.campaignName:window.dtci.newsletters.result[d]?d:DisneyOneID.config.campaignName,i=window.dtci.newsletters.result[r],e.preventDefault(),o.querySelector(".errors").classList.add("hidden"),a.setAttribute("disabled",!0),s?Array.from(o.parentNode.querySelectorAll("input.newsletter-checkbox:checked")).forEach(function(e){c[e.value]=1}):(n=o.querySelector("[data-newsletter]").value,c[n]=1),i.data.marketing.forEach(function(e){c[e.code]&&(e.subscribed=!0)}),t={campaignId:r,email:l,marketing:i.data.marketing,legal:i.data.legal},window.oid.setInlineNewsletters(t).then(function(e){window.dtci.newsletters.showSuccess(o),a.removeAttribute("disabled"),void 0!==window.dtciDataLayer&&window.dtciDatalayer.trackDetailed({event_name:"newsletter signup:success",signup_source:window.window.__dataLayer.page.page_url,content_title:window.window.__dataLayer.page.page_name,content_id:window.window.__dataLayer.page.hasOwnProperty("page_id")?window.window.__dataLayer.page.page_id:window.window.__dataLayer.page.story_id})}).catch(function(e){window.dtci.newsletters.showErrors(o,e.error_codes)})},window.dtci.newsletters.reInit=function(){e()},document.addEventListener("oneidInit",function(){setTimeout(function(){e()},"500")})}();
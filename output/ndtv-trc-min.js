!function e() { if ("undefined" != typeof firebase) if (void 0 !== firebase.firestore) { var t = []; firebase.initializeApp({ projectId: "firestore-realtime-push" }); var i = firebase.firestore(); try { i.collection("stage.ndtv.com").doc("ndtv_homepage").onSnapshot(function (e) { for (; t.length > 0;) { var i = t.pop(); $(i).unbind("click"), $(i).removeClass("unwatched") } var o = e.data(), r = $.grep(o.experiments, function (e) { return e.siteid == __siteid }); $.each(r, function (e, i) { var o, r, s = i.Experimentvariant.length, c = "expr_" + i.experimentId, p = getCookie(c), l = ""; "" == p || null == p ? (o = 0, r = s, o = Math.ceil(o), r = Math.floor(r), l = Math.floor(Math.random() * (r - o) + o), setCookie(c, l, 1, "")) : l = p; var d = i.Experimentvariant[l], f = i.catid, h = $("[class*=-" + f + "]"); if (h.length > 0) { i.exptype; var u = $(h).find("a").filter(function () { return $(this).html().trim().replace(/&amp;/g, '&') === i.Experimentvariant[0].name.replace(new RegExp(/\bRs(\.\s|\s\b)/, "g"), "₹").trim() }); u.length > 0 && "" != d.name && (u = u[0], $(u).html(d.name.replace(new RegExp(/\bRs(\.\s|\s\b)/, "g"), "₹")), $(u).addClass("unwatched"), t.push(u), $(u).on("click", function (e) { e.preventDefault(); var t = i.masterKey + "_deleted"; n(d.variantkey + "_click", $(this).attr("href"), t, !0) }), $(u).isInViewport() && a(u, i.masterkey, d.variantkey), $(window).on("scroll", function () { $(u).isInViewport() && a(u, i.masterkey, d.variantkey) })) } }) }) } catch (e) { console.log(e) } $.fn.isInViewport = function () { var e = $(this).offset().top, t = e + $(this).outerHeight(), i = $(window).scrollTop(), n = i + $(window).height(); return t > i && e < n } } else setTimeout(e, 10); else setTimeout(e, 10); function n(e, t, i, n = !1) { var o = { key: e, type: "incr", deletedkey: i }; !function (e, t, i, n) { var o = { url: "https://hpcms.ndtv.com/sportsredisapi/webapi/ndtv-trc?q=" + n, method: "POST", timeout: 0, headers: { "Content-Type": "application/json" }, contentType: "application/json", data: JSON.stringify(e) }; $.ajax(o).done(function (e) { console.log(e), i && (window.location = t) }) }(JSON.stringify(o), t, n, e) } function o(e, t) { var i = e + "_deleted"; n(e, "", i), n(t, "", i) } function a(e, t, i) { setTimeout(function () { var n = "expr_variant_img_impr_" + i; __echImprssCount && setCookie(n, i + "_view", -1, ""), $(e).isInViewport() && $(e).hasClass("unwatched") && "" == getCookie(n) && (o(t, i + "_view"), $(e).removeClass("unwatched"), setCookie(n, i + "_view", 1, "")) }, 3e3) } }();
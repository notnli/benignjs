/** @license: OpenAdViewability (BSD-3 License): https://github.com/picatcha/OpenAdViewability/ */
!function(){"use strict";var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(l,u,o){function t(){}l.console=l.console||{log:t,warn:t,error:t,dir:t},Array.prototype.findIndex||(Array.prototype.findIndex=function(t){if(null==this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var e,n=Object(this),i=n.length>>>0,o=arguments[1],r=0;r<i;r++)if(e=n[r],t.call(o,e,r,n))return r;return-1}),Array.prototype.filter||(Array.prototype.filter=function(t){if(null==this)throw new TypeError;var e,n,i,o=Object(this),r=o.length>>>0,a=[];if("function"!=typeof t)throw new TypeError;for(a=[],e=2<=arguments.length?arguments[1]:void 0,n=0;n<r;n++)n in o&&(i=o[n],t.call(e,i,n,o)&&a.push(i));return a}),l.requestAnimFrame=l.requestAnimFrame||l.requestAnimationFrame||l.webkitRequestAnimationFrame||l.mozRequestAnimationFrame||l.oRequestAnimationFrame||l.msRequestAnimationFrame||function(t){l.setTimeout(t,1e3/60)},l.cancelAFrame=l.cancelAnimationFrame||l.webkitCancelAnimationFrame||l.mozCancelAnimationFrame||l.oCancelAnimationFrame||function(t){l.clearTimeout(t)};var e=!1;function n(){}function i(){e||"loading"===u.readyState||(e=!0,l.setTimeout(function(){f(u)},0))}function f(t){var e,n,i,o,r=[],a=[],d=t.querySelectorAll("ins.adsbyfalcon"),s=["4048","4402","4053","4406","3347","4410","4058","4414","4063","4418","4068","4422","4073","4426","4078","4430","3352","4434","3357","4438","1738","4674"];for(e=0,n=d.length;e<n;e++){var c,l=d[e],u=l.getAttribute("data-ad-slot"),f=T(l.getAttribute("data-ad-sizes")),h=l.getAttribute("data-merge-position"),m=l.getAttribute("data-next-position"),p=l.getAttribute("data-next-merge-position"),g=l.getAttribute("data-sibling-position"),v=l.offsetWidth||0,_=l.offsetHeight||0;if(u&&!k(l,"processing")&&!q(l)){if(f&&(u=(c=w((i=A(f),void 0,o=x(),i.concat([o])).sort(M)))?c.slot:u),2199==u||1101==u||2268==u){var y=[{id:u,width:v,height:_,element:l,mergePosition:h}];P(l),S(y);continue}var b={id:u,width:v,height:_,element:l,mergePosition:h,nextPosition:m,nextMergePosition:p,siblingPosition:g};-1===s.indexOf(u)?r.push(b):a.push(b),P(l)}}r.length&&S(r),setTimeout(function(){a.length&&S(a)},4e3)}function w(t){var e,n=x().width;if(1===(e=t.filter(function(t){return n>=t.width})).length)return(e=(e=t.reverse().slice(0,2)).filter(function(t){return{}.hasOwnProperty.call(t,"slot")}))[0];var i,o,r=e.findIndex(function(t){return!t.slot&&t.width===n}),a=r-1,d=r+1,s=t[r].width;return 0===r?e[1]:e.length-1===r?e[a]:(i=e[a].width,o=e[d].width,Math.abs(o-s)<Math.abs(i-s)?e[d]:e[a])}function x(){var t=Math.max(l.innerWidth,u.documentElement.clientWidth);return 793<=t&&t<=807&&(t=800),1017<=t&&t<=1031&&(t=1024),{width:t,height:Math.max(l.innerHeight,u.documentElement.clientHeight)}}function A(t){var e,n=[];for(e in t)t.hasOwnProperty(e)&&n.push({resolution:e,slot:t[e],width:Math.floor(e.match(/^\d+/)[0]),height:Math.floor(e.match(/\d+$/)[0])});return n}function M(t,e){return t.width!==e.width?e.width>t.width?1:e.width<t.width?-1:0:e.height>t.height?1:e.height<t.height?-1:0}function r(t,e){(l._piq||[]).push(["trackEvent",t,e])}function h(t,e){var n=e.ad_list[0].type,i=e.ad_list[0].hashid;"3542"===e.ad_list[0].position_id&&r("slideopen-ad-sales_3542_336-280",t+"_"+n+"_desktop_"+i+"_v1"),"3342"===e.ad_list[0].position_id&&r("inread-ad-adn_3342_336-280",t+"_"+n+"_desktop_"+i+"_v1"),"4033"===e.ad_list[0].position_id&&r("inread-ad-adn_4033_336-280",t+"_"+n+"_desktop_"+i+"_v1"),"4038"===e.ad_list[0].position_id&&r("inread-ad-adn_4038_336-280",t+"_"+n+"_desktop_"+i+"_v1"),"2982"===e.ad_list[0].position_id&&r("backdrop-ad-sales_2982_336-280",t+"_"+n+"_mobile_"+i+"_v1"),"3372"===e.ad_list[0].position_id&&r("inread-ad-adn_3372_336-280",t+"_"+n+"_mobile_"+i+"_v1")}function m(t,e,n,i){if("false"===t.getAttribute("data-embed"))return t.innerHTML=i,void function t(e){if("SCRIPT"===e.tagName)return e.parentNode.replaceChild(a(e),e),e;var n=0,i=e.childNodes;l.pix&&"INS"===e.tagName&&e&&e.classList&&e.classList.add("pixnet-ad");for(;n<i.length;)t(i[n++]);return e}(t);l.pix&&t&&t.classList&&t.classList.add("pixnet-ad");var o=u.createElement("iframe"),r="margin:0;padding:0;overflow:hidden;background-color:transparent;";o.setAttribute("allowfullscreen","auto"),o.setAttribute("style",r+"border:none;width:"+e+"px;height:"+n+"px;"),o.setAttribute("scrolling","no"),t.innerHTML="",t.appendChild(o),o.contentDocument.open(),o.contentDocument.write(i),o.contentDocument.body&&o.contentDocument.body.setAttribute("style",r),o.contentDocument.close()}function a(t){var e=u.createElement("script");e.text=t.innerHTML;for(var n=t.attributes.length-1;0<=n;n--)e.setAttribute(t.attributes[n].name,t.attributes[n].value);return e}function S(e){var t,n="11"!==_("preview_mib_fly_mobile_image_ad")?_("demo_ad_no"):"75ecc55cd322ced48ae2d4c7717a0891",i=n?"&demo_ad_no="+n:"",o=g("falcon:blogcategory"),r=g("falcon:userlists"),a=g("falcon:articlecategory"),d=l.location.origin.match(/(\.[0-9a-z_]+\.(alpha|test)\.pixnet(\.work)?$)/)||"",s="https";d&&(s="http",d=d[0]),t=s+"://"+(function(){for(var t=u.getElementsByTagName("script"),e=/\/\/([^.]*falcon)-asset\.pixfs\.net/g,n=0,i=t.length;n<i;n++){var o=e.exec(t[n].getAttribute("src"));if(o)return o[1]}}()||"falcon")+".pixnet.net"+d+"/ad/json?"+function(t){for(var e="",n=0,i=t.length;n<i;n++)e=e+p(t[n])+(n!==i-1?"&":"");return e}(e)+"&version=2&sdk_version=20221109v1&t="+(new Date).getTime()+i,o&&(t+="&blog_category="+o),r&&(t+="&user_lists="+r),a&&(t+="&article_category="+a),u.referrer&&(t+="&referrer="+encodeURI(u.referrer));var c=new XMLHttpRequest;l.XDomainRequest&&((c=new XDomainRequest).onprogress=function(){},c.ontimeout=function(){},c.onerror=function(){}),c.onload=function(){var t=T(this.responseText);(function(t){return t&&t instanceof Array})(t.ad_slots)&&t.ad_slots.length&&function(t,e){for(;e.length;){for(var n=e.shift(),i=t.shift();n.pos_id!==i.id;)i=t.shift();if(i&&!q(i.element)){if(i.siblingPosition&&(0===n.ad_num||0<n.ad_list.length&&n.ad_list[0].position_id!==i.id||y()===i.siblingPosition)&&(i.element.insertAdjacentHTML("afterend",'<ins class="adsbyfalcon" data-ad-client="1" data-ad-slot="'+i.siblingPosition+'" data-embed="false" style="display:inline-block;width:336px;height:280px;"></ins>'),f(i.element.parentNode),0<n.ad_list.length&&n.ad_list[0].position_id===i.id&&y()===i.siblingPosition)){i.element.parentNode.removeChild(i.element);continue}if(0===n.ad_num){if(!i.nextPosition){var o=i.element.getAttribute("data-ad-passback");if(""!=o&&"function"==typeof l[o]){v(i.element),l[o](i.element);continue}i.element.parentNode.removeChild(i.element),-1!==["3869","3879","3874","3884"].indexOf(i.id)&&E(l,"activateInReadSticky")}"1101"!==i.id&&"2199"!==i.id&&"2268"!==i.id||(u.querySelector("#main > .header-fixed-area").style.display="none"),i.nextPosition&&(i.id=i.nextPosition,i.mergePosition=i.nextMergePosition,i.nextPosition="",i.nextMergePosition="",S([i]));continue}if(h("load",n),("2982"===i.id&&0<n.ad_list.length&&"3372"===n.ad_list[0].position_id||"3372"===i.id)&&i.element.parentNode&&i.element.parentNode.classList.contains("in-read-ad--sticky")&&i.element.parentNode.parentNode.classList.remove("disable-sticky"),"2982"===i.id&&0<n.ad_list.length&&"2982"===n.ad_list[0].position_id&&l.location.hostname==="falcondemo.pixnet.net"+pix.domain_append&&"on"===_("is_ignore_backdrop"))continue;("3869"===n.pos_id||"3879"===n.pos_id||"3874"===n.pos_id||"3983"===n.pos_id)&&0<n.ad_list.length&&"js"===n.ad_list[0].type?(r=n,void 0,(new Image).src=r.ad_list[0].activeview_url):b(i.element,n,function(t,e,n){L(t,e,n)}),m(i.element,i.width,i.height,n.html),v(i.element)}}var r}(e,t.ad_slots)},c.addEventListener&&c.addEventListener("error",function(){},!1),c.open("get",t,!0),c.withCredentials=!0,c.send()}function p(t){var e="";return t.mergePosition&&(e=","+t.mergePosition),"pos[]="+t.id+","+t.width+","+t.height+e}function g(t){var e=u.querySelector('meta[property="'+t+'"]');return e&&e.getAttribute("content")}function P(t){return d(t,"processing")}function q(t){return k(t,"done")}function v(t){return d(t,"done")}function k(t,e){return!!t&&e===t.getAttribute("data-adsbyfalcon-status")}function d(t,e){return!!t&&t.setAttribute("data-adsbyfalcon-status",e)}function T(t){try{return JSON.parse(t)}catch(t){return{}}}function _(t){if(!t)return"";for(var e=l.location,n=(e.search.substring(1)||e.hash.split("?")[1]||"").split("&"),i=0;i<n.length;i++){var o=n[i].split("=");if(o[0]===t)return decodeURIComponent(o[1].replace(/\+/g," "))}return""}function y(){return _("ad_num")}function b(e,n,i){var o=new MutationObserver(function(t){i(e,n,o)});o.observe(e,{childList:!0,subtree:!0})}function L(n,i,t){var o=n.querySelector("[data-falcon-ad], [data-falcon-ad-video]")||n.querySelector("img, iframe"),r=function(t){return!!t.match(/backdrop/)}(n.innerHTML),a=function(t){return!!t.match(/oneadIRDFPTag/)}(n.innerHTML),d=function(t){return!!t.match(/truvid/)}(n.innerHTML),e=function(t){return!!t.match(/popIn_recommend/)}(n.innerHTML),s="load";if(e&&!o)return t.disconnect(),void c(n,i);o&&(t.disconnect(),n.querySelector("[data-falcon-ad-video]")&&(s="loadedmetadata"),o.addEventListener(s,function t(){var e=n.querySelector("[data-falcon-ad-container]")||o;r&&(e=n.querySelector("div[data-type]")||o),a&&(e=n.querySelector("#video_click_area0")),d&&(e=n.querySelector(".trvd_video_player")),c(e,i),o.removeEventListener(s,t,!1)}))}function c(t,e){var n=e.ad_list[0].activeview_url,i=new o;n&&i.checkViewability(t,function(t){t.viewabilityStatus&&((new Image).src=n,h("view",e))})}function E(t,e){var n=u.createEvent("HTMLEvents");n.initEvent(e,!0,!0),t.dispatchEvent(n)}u.addEventListener("readystatechange",i),l.PIXFalcon=(n.prototype.placeAds=function(t){var e,n,i;if(u!==t){if(0!==(n=(e=u.querySelectorAll(t)).length))for(i=0;i<n;i++)f(e[i])}else f(u)},n.prototype.placeAdByNode=function(t){f(t)},n),i()}(window,document,function(){this.checkViewability=function(r,a){if(r){var T={viewabilityStatus:!1},t=r.getBoundingClientRect(),e=t.width*t.height,L=50;242500<=e&&(L=30);var n=function(t){return"hidden"===window.getComputedStyle(t,null).getPropertyValue("visibility")},i=function(t){var e,n,i,o,r,a,d,s,c,l,u,f,h,m,p=t.getBoundingClientRect(),g=p.left+12,v=p.right-12,_=Math.max(0,p.top+12),y=p.bottom-12,b=Math.floor(p.left+p.width/2),w=Math.floor(p.top+p.height/2),x=[{x:g,y:_},{x:b,y:_},{x:v,y:_},{x:g,y:w},{x:b,y:w},{x:v,y:w},{x:g,y:y},{x:b,y:y},{x:v,y:y}],A=[];for(var M in x)if(x.hasOwnProperty(M)&&x[M]&&0<=x[M].x&&0<=x[M].y){var S=document.elementFromPoint(x[M].x,x[M].y);if(h=t,null!==(m=S)&&h!==m&&!h.contains(m)&&!m.contains(h)&&(e=h,void 0,i=(n=m).nodeName,o=window.getComputedStyle(n,null),r=e.getBoundingClientRect(),a=n.getBoundingClientRect(),d=r.top===a.top&&r.bottom===a.bottom&&r.left===a.left&&r.right===a.right&&r.height===a.height&&r.width===a.width,0!==n.childNodes.length||"DIV"!==i&&"SPAN"!==i||"none"!==o.backgroundImage||"none"!==o.borderStyle||"rgba(0, 0, 0, 0)"!==o.backgroundColor||!d)){var P=S.getBoundingClientRect();if(p.top>P.bottom)continue;var q=(c=P,void 0,l=(s=p).width*s.height,u=Math.max(0,Math.min(s.right,c.right)-Math.max(s.left,c.left)),f=Math.max(0,Math.min(s.bottom,c.bottom)-Math.max(s.top,c.top)),u*f/l);if(0<q&&(k(A,S)||A.push({el:S,area:q}),T.percentObscured>100-L))return!0}}function k(t,e){return 0<t.length&&t.map(function(t){return t.el}).some(function(t){return t===e})}return T.percentObscured=0<A.length?100*A.map(function(t){return t.area}).reduce(function(t,e){return Math.max(t,e)}):0,T.percentViewable=100-T.percentObscured,!1},d=void 0,s=L/100,c=new IntersectionObserver(function(t){var e=t[0].intersectionRatio,o=l();s<=e&&function(t){return!n(t)&&(!i(t)&&(!(T.percentViewable&&T.percentViewable<L)&&T.percentViewable))}(r)?d=window.requestAnimFrame(function t(){var e=l()-o;var n=r.querySelector("[data-falcon-ad-video]")?2e3:1e3;var i=n<=e;i?(T.viewabilityStatus=!0,a(T),c.unobserve(r),window.cancelAFrame(d)):d=window.requestAnimFrame(t)}):window.cancelAFrame(d)},{threshold:[s]});c.observe(r)}function l(){return"object"===o(window.performance)?window.performance.now():(new Date).getTime()}}})}();

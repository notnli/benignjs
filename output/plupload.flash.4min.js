(function(f,b,d,e){var a={},g={};function c(){var h;try{h=navigator.plugins["Shockwave Flash"];h=h.description}catch(j){try{h=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(i){h="0.0"}}h=h.match(/\d+/g);return parseFloat(h[0]+"."+h[1])}d.flash={trigger:function(j,h,i){setTimeout(function(){var m=a[j],l,k;if(m){m.trigger("Flash:"+h,i)}},0)}};d.runtimes.Flash=d.addRuntime("flash",{getFeatures:function(){return{jpgresize:true,pngresize:true,maxWidth:8091,maxHeight:8091,chunks:true,progress:true,multipart:true}},init:function(j,o){var n,i,k,p=0,h=b.body;if(c()<10){o({success:false});return}g[j.id]=false;a[j.id]=j;n=b.getElementById(j.settings.browse_button);i=b.createElement("div");i.id=j.id+"_flash_container";d.extend(i.style,{position:"absolute",top:"0px",background:j.settings.shim_bgcolor||"transparent",zIndex:899,width:"100%",height:"100%"});i.className="plupload flash";if(j.settings.container){h=b.getElementById(j.settings.container);h.style.position="relative"}h.appendChild(i);k="id="+escape(j.id);i.innerHTML='<object id="'+j.id+'_flash" width="100%" height="100%" style="display:block; outline:0" type="application/x-shockwave-flash" data="'+j.settings.flash_swf_url+'">'+'<param name="movie" value="'+j.settings.flash_swf_url+'" />'+'<param name="flashvars" value="'+k+'" />'+'<param name="wmode" value="transparent" />'+'<param name="allowscriptaccess" value="always" /></object>';function m(){return b.getElementById(j.id+"_flash")}function l(){if(p++>5000){o({success:false});return}if(!g[j.id]){setTimeout(l,1)}}l();n=i=null;j.bind("Flash:Init",function(){var t={},r,q=j.settings.resize||{};var s=m();if(s.setFileFilters){s.setFileFilters(j.settings.filters,j.settings.multi_selection)}if(g[j.id]){return}g[j.id]=true;j.bind("UploadFile",function(u,v){var w=u.settings;m().uploadFile(t[v.id],w.url,{name:v.target_name||v.name,mime:d.mimeTypes[v.name.replace(/^.+\.([^.]+)/,"$1")]||"application/octet-stream",chunk_size:w.chunk_size,width:q.width,height:q.height,quality:q.quality||90,multipart:w.multipart,multipart_params:w.multipart_params||{},file_data_name:w.file_data_name,format:/\.(jpg|jpeg)$/i.test(v.name)?"jpg":"png",headers:w.headers,urlstream_upload:w.urlstream_upload})});j.bind("Flash:UploadProcess",function(v,u){var w=v.getFile(t[u.id]);if(!w){return}if(w.status!=d.FAILED){w.loaded=u.loaded;w.size=u.size;v.trigger("UploadProgress",w)}});j.bind("Flash:UploadChunkComplete",function(u,w){var x,v=u.getFile(t[w.id]);x={chunk:w.chunk,chunks:w.chunks,response:w.text};u.trigger("ChunkUploaded",v,x);if(!v){return}if(v.status!=d.FAILED){m().uploadNextChunk()}if(w.chunk==w.chunks-1){v.status=d.DONE;u.trigger("FileUploaded",v,{response:w.text})}});j.bind("Flash:SelectFiles",function(u,x){var w,v,y=[],z;for(v=0;v<x.length;v++){w=x[v];z=d.guid();t[z]=w.id;t[w.id]=z;y.push(new d.File(z,w.name,w.size))}if(y.length){j.trigger("FilesAdded",y)}});j.bind("Flash:SecurityError",function(u,v){j.trigger("Error",{code:d.SECURITY_ERROR,message:d.translate("Security error."),details:v.message,file:j.getFile(t[v.id])})});j.bind("Flash:GenericError",function(u,v){j.trigger("Error",{code:d.GENERIC_ERROR,message:d.translate("Generic error."),details:v.message,file:j.getFile(t[v.id])})});j.bind("Flash:IOError",function(u,v){j.trigger("Error",{code:d.IO_ERROR,message:d.translate("IO error."),details:v.message,file:j.getFile(t[v.id])})});j.bind("Flash:ImageError",function(u,v){j.trigger("Error",{code:parseInt(v.code),message:d.translate("Image error."),file:j.getFile(t[v.id])})});j.bind("Flash:StageEvent:rollOver",function(u){var v,w;v=b.getElementById(j.settings.browse_button);w=u.settings.browse_button_hover;if(v&&w){d.addClass(v,w)}});j.bind("Flash:StageEvent:rollOut",function(u){var v,w;v=b.getElementById(j.settings.browse_button);w=u.settings.browse_button_hover;if(v&&w){d.removeClass(v,w)}});j.bind("Flash:StageEvent:mouseDown",function(u){var v,w;v=b.getElementById(j.settings.browse_button);w=u.settings.browse_button_active;if(v&&w){d.addClass(v,w);d.addEvent(b.body,"mouseup",function(){d.removeClass(v,w)},u.id)}});j.bind("Flash:StageEvent:mouseUp",function(u){var v,w;v=b.getElementById(j.settings.browse_button);w=u.settings.browse_button_active;if(v&&w){d.removeClass(v,w)}});j.bind("QueueChanged",function(u){j.refresh()});j.bind("FilesRemoved",function(u,w){var v;for(v=0;v<w.length;v++){m().removeFile(t[w[v].id])}});j.bind("StateChanged",function(u){j.refresh()});j.bind("Refresh",function(u){var v,w,y;var x=m();if(x.setFileFilters){x.setFileFilters(j.settings.filters,j.settings.multi_selection)}v=b.getElementById(u.settings.browse_button);if(v){w=d.getPos(v,b.getElementById(u.settings.container));y=d.getSize(v);d.extend(b.getElementById(u.id+"_flash_container").style,{top:w.y+"px",left:w.x+"px",width:y.w+"px",height:y.h+"px"})}});j.bind("Destroy",function(u){var v;d.removeAllEvents(b.body,u.id);delete g[u.id];delete a[u.id];v=b.getElementById(u.id+"_flash_container");if(v){h.removeChild(v)}});o({success:true})})}})})(window,document,plupload);
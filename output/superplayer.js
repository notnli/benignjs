/**
 * thumbplayer-h5
 * Update Date: 2023-03-08 16:17:38
 * Author: thumbplayer-h5 team
 * ---
 * Copyright (c) 2023 Tencent
 */

!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).SuperPlayerExport={})}(this,(function(exports){"use strict";var extendStatics$2=function(e,t){return extendStatics$2=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},extendStatics$2(e,t)};function __extends$d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}extendStatics$2(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}var __assign$e=function(){return __assign$e=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},__assign$e.apply(this,arguments)},SET_LEVEL_MODE,PLAY_MODE;function __decorate$9(e,t,o,r){var n,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,o,a):n(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a}function __metadata$9(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function __awaiter$9(e,t,o,r){return new(o||(o=Promise))((function(n,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))}function __generator$9(e,t){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function __spreadArray$4(e,t,o){if(o||2===arguments.length)for(var r,n=0,i=t.length;n<i;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||t)}Promise.prototype.finally||(Promise.prototype.finally=function(e){var t=this.constructor;return this.then((function(o){return t.resolve(e()).then((function(){return o}))}),(function(o){return t.resolve(e()).then((function(){return t.reject(o)}))}))}),function(e){e.SOFT="soft",e.HARD="hard",e.SMOOTH="smooth"}(SET_LEVEL_MODE||(SET_LEVEL_MODE={})),exports.PLAY_MODE=void 0,PLAY_MODE=exports.PLAY_MODE||(exports.PLAY_MODE={}),PLAY_MODE.VOD="vod",PLAY_MODE.LIVE="live";var CAN_PLAY_ALL=null,VIDEO_CONTAINER_CLASS="txp_videos_container",END_STATE,VIDEO_READY_STATE,VIDEO_EVTS,VIDEO_STATE,ERROR_CODE,ERROR_MSG,PLAY_EVENT,PRELOAD_EVENT,VIDEO_NODE_EVENT,PAUSE_TYPE,PLAYER_LOG_LEVEL,PRELOAD_TYPE,CODEC,VIDEO_CODEC,AUDIO_CODEC,CONTAINER_FORMAT,HDR_CAPABILITY,VIDEO_ELEMENT_STATE;exports.END_STATE=void 0,END_STATE=exports.END_STATE||(exports.END_STATE={}),END_STATE.NORMAL="normal",END_STATE.INTERRUPT="interrupt",END_STATE.ERROR="error",function(e){e[e.HAVE_NOTHING=0]="HAVE_NOTHING",e[e.HAVE_METADATA=1]="HAVE_METADATA",e[e.HAVE_CURRENT_DATA=2]="HAVE_CURRENT_DATA",e[e.HAVE_FUTURE_DATA=3]="HAVE_FUTURE_DATA",e[e.HAVE_ENOUGH_DATA=4]="HAVE_ENOUGH_DATA"}(VIDEO_READY_STATE||(VIDEO_READY_STATE={})),function(e){e.loadstart="loadstart",e.timeupdate="timeupdate",e.durationchange="durationchange",e.volumechange="volumechange",e.canplay="canplay",e.playing="playing",e.pause="pause",e.waiting="waiting",e.seeking="seeking",e.seeked="seeked",e.loadeddata="loadeddata",e.loadedmetadata="loadedmetadata",e.ended="ended",e.error="error",e.progress="progress",e.ratechange="ratechange",e.resize="resize",e.frameRender="videoFrameRender"}(VIDEO_EVTS||(VIDEO_EVTS={})),exports.VIDEO_STATE=void 0,VIDEO_STATE=exports.VIDEO_STATE||(exports.VIDEO_STATE={}),VIDEO_STATE.IDLE="idle",VIDEO_STATE.LOAD_START="loadStart",VIDEO_STATE.CANPLAY="canplay",VIDEO_STATE.PLAYING="playing",VIDEO_STATE.PAUSE="pause",VIDEO_STATE.SEEKING="seeking",VIDEO_STATE.SEEKED="seeked",VIDEO_STATE.BUFFERING="buffering",VIDEO_STATE.END="end",function(e){e.UNKNOWN_ERR="70011000",e.MEDIA_ERR_ABORTED="70016001",e.MEDIA_ERR_NETWORK="70016002",e.MEDIA_ERR_DECODE="70011102",e.MEDIA_ERR_SRC_NOT_SUPPORTED="70011103",e.ORG_LOAD_TIMEOUT="70011104",e.STATE_STUCK="70011105",e.ORG_PLAY_STUCK_ERR="70011111",e.NULL_URL="70011112",e.MISSING_KERNEL="70011113",e.KERNEL_NOT_SPT="70011114"}(ERROR_CODE||(ERROR_CODE={})),function(e){e.UNKNOWN="未知错误",e.XHR_NET="视频获取途中出现问题",e.PRELOAD_VIDEO_TIMEOUT="加载视频超时",e.PLAY_STUCK="视频无法继续播放",e.LOAD_STREAM_FAIL="视频流获取途中出现问题",e.INNER="内部错误",e.NULL_URL="传入的地址为空"}(ERROR_MSG||(ERROR_MSG={})),exports.PLAY_EVENT=void 0,PLAY_EVENT=exports.PLAY_EVENT||(exports.PLAY_EVENT={}),PLAY_EVENT.RESTART="restart",PLAY_EVENT.TIME_UPDATE="timeupdate",PLAY_EVENT.METADATA_CHANGE="metadataChange",PLAY_EVENT.RATE_CHANGE="rateChange",PLAY_EVENT.VOLUME_CHANGE="volumeChange",PLAY_EVENT.DURATION_CHANGE="durationChange",PLAY_EVENT.AUTOPLAY_BLOCKED="autoplayBlocked",PLAY_EVENT.LOAD_PROGRESS="loadProgress",PLAY_EVENT.STATE_CHANGE="stateChange",PLAY_EVENT.FIRST_PLAYING="firstPlaying",PLAY_EVENT.VIDEONODE_PLAY_OVER="videoNodePlayOver",PLAY_EVENT.VIDEONODE_START_PLAY="videoNodeStartPlay",PLAY_EVENT.VIDEONODE_FIRST_PLAYING="videoNodeFirstPlaying",PLAY_EVENT.VIDEONODE_CHANGE="videoNodeChange",PLAY_EVENT.LIST_CHANGE="listChange",PLAY_EVENT.SET_LOADING="setLoading",PLAY_EVENT.PRELOAD_START="preloadStart",PLAY_EVENT.PRELOAD_VIDEONODE_OVER="preloadVideonodeOver",PLAY_EVENT.PRELOAD_VIDEONODE_CLEAR="preloadVideonodeClear",PLAY_EVENT.PRELOAD_VIDEONODE_ERROR="preloadVideonodeError",PLAY_EVENT.VIDEO_BUFFER_CHANGE="videoBufferChange",PLAY_EVENT.SETLEVEL_START="setLevelStart",PLAY_EVENT.SETLEVEL_OVER="setLevelOver",PLAY_EVENT.SET_AUDIO_TRACK_START="setAudioTrackStart",PLAY_EVENT.SET_AUDIO_TRACK_OVER="setAudioTrackOver",PLAY_EVENT.RESIZE="resize",PLAY_EVENT.STOPED="stoped",PLAY_EVENT.ERROR="error",PLAY_EVENT.RETRY_BACKURL="retryBackUrl",PLAY_EVENT.VIDEO_FRAME_RENDER="videoFrameRender",PLAY_EVENT.ELEMENT_EVTS="elementEvts",PLAY_EVENT.VIDEO_RESIZE="videoResize",PLAY_EVENT.FULLSCREEN_CHANGE="fullscreenChange",PLAY_EVENT.CONTAINER_RESIZE="containerResize",PLAY_EVENT.ENTER_INSERT_STREAM="enterInsertStream",PLAY_EVENT.EXIT_INSERT_STREAM="exitInsertStream",function(e){e.START="START_PRELOAD",e.STOP="STOP_PRELOAD",e.UPDATE="UPDATE_PRELOAD_INFO"}(PRELOAD_EVENT||(PRELOAD_EVENT={})),function(e){e.TIME_UPDATE="vn_timeupdate",e.METADATA_CHANGE="vn_metadataChange",e.VOLUME_CHANGE="vn_volumeChange",e.DURATION_CHANGE="vn_durationChange",e.PLAY_PROMISE_CATCHED="vn_playPromiseCatched",e.LOAD_PROGRESS="vn_loadProgress",e.RATE_CHANGE="vn_rateChange",e.BUFFER_APPENDED="vn_bufferAppended",e.STATE_CHANGE="vn_stateChange",e.ERROR="vn_error",e.RETRY="vn_retry",e.SET_LOADING="vn_setLoading",e.VIDEO_BUFFER_CHANGE="vn_videoBufferChange",e.SETLEVEL_START="vn_setLevelStart",e.SETLEVEL_OVER="vn_setLevelOver",e.SET_AUDIO_TRACK_START="vn_setAudioTrackStart",e.SET_AUDIO_TRACK_OVER="vn_setAudioTrackOver",e.URL_CHANGE="vn_urlChange",e.FIRST_PLAYING="vn_firstPlaying",e.ELEMENT_EVTS="vn_elementEvts",e.PLAY_OVER="vn_playOver",e.VIDEO_RESIZE="vn_videoResize",e.VIDEO_FRAME_RENDER="vn_videoFrameRender",e.ENTER_INSERT_STREAM="enterInsertStream",e.EXIT_INSERT_STREAM="exitInsertStream"}(VIDEO_NODE_EVENT||(VIDEO_NODE_EVENT={})),function(e){e.USER="user",e.INNER="inner",e.SYS="sys"}(PAUSE_TYPE||(PAUSE_TYPE={})),function(e){e[e.NONE=0]="NONE",e[e.CORE=1]="CORE",e[e.KERNEL=2]="KERNEL"}(PLAYER_LOG_LEVEL||(PLAYER_LOG_LEVEL={})),exports.PRELOAD_TYPE=void 0,PRELOAD_TYPE=exports.PRELOAD_TYPE||(exports.PRELOAD_TYPE={}),PRELOAD_TYPE.META_DATA="metadata",PRELOAD_TYPE.AUTO="auto",PRELOAD_TYPE.AUTO_LOAD="autoLoad",function(e){e[e.H264=0]="H264",e[e.H265=1]="H265",e[e.AV1=2]="AV1"}(CODEC||(CODEC={})),exports.VIDEO_CODEC=void 0,VIDEO_CODEC=exports.VIDEO_CODEC||(exports.VIDEO_CODEC={}),VIDEO_CODEC.UNKNOWN="unknown",VIDEO_CODEC.H264="h264",VIDEO_CODEC.H265="h265",VIDEO_CODEC.H266="h266",VIDEO_CODEC.VP8="vp8",VIDEO_CODEC.VP9="vp9",VIDEO_CODEC.AV1="av1",VIDEO_CODEC.DOLBY_VISION="dolbyVision",exports.AUDIO_CODEC=void 0,AUDIO_CODEC=exports.AUDIO_CODEC||(exports.AUDIO_CODEC={}),AUDIO_CODEC.AAC="aac",AUDIO_CODEC.OPUS="opus",exports.CONTAINER_FORMAT=void 0,CONTAINER_FORMAT=exports.CONTAINER_FORMAT||(exports.CONTAINER_FORMAT={}),CONTAINER_FORMAT.MPEG_TS="mpegts",CONTAINER_FORMAT.FMP4="fmp4",CONTAINER_FORMAT.MP4="mp4",function(e){e[e.NOT_SUPPORTED=0]="NOT_SUPPORTED",e[e.WCG_DISPLAY_BUT_NO_HDR=1]="WCG_DISPLAY_BUT_NO_HDR",e[e.SUPPORTED=2]="SUPPORTED"}(HDR_CAPABILITY||(HDR_CAPABILITY={})),function(e){e.FREE="0",e.USED="1"}(VIDEO_ELEMENT_STATE||(VIDEO_ELEMENT_STATE={}));var CDN_PATH_PREFIX="//vm.gtimg.cn/thumbplayer/",CACHE_SIZE_KEY,DRM_TYPE$1,VIDEO_TYPE,KERNEL_NAME,AUDIO_TRACK_ERROR_MSG;!function(e){e.DEMUX="demux_cache_size"}(CACHE_SIZE_KEY||(CACHE_SIZE_KEY={})),function(e){e.FAIRPLAY="fairplay",e.WIDEVINE="widevine",e.PLAYREADY="playready",e.CHACHA="chacha",e.NONE="none"}(DRM_TYPE$1||(DRM_TYPE$1={})),function(e){e.HLS="hls",e.MP4="mp4",e.MOV="mov",e.FLV="flv",e.WEBRTC="webrtc",e.AVI="avi",e.MPEG="mpeg",e.WEBM="webm",e.OGG="ogg",e.OTHER="other"}(VIDEO_TYPE||(VIDEO_TYPE={})),exports.KERNEL_NAME=void 0,KERNEL_NAME=exports.KERNEL_NAME||(exports.KERNEL_NAME={}),KERNEL_NAME.ORIGIN="origin",KERNEL_NAME.DEMUX_2_FMP4="demux2fmp4",KERNEL_NAME.FLV_JS="flv.js",KERNEL_NAME.HLS_JS="hls.js",KERNEL_NAME.WASM="wasm",KERNEL_NAME.WEBRTC="webrtc",KERNEL_NAME.ELECTRON="electron",function(e){e.KERNEL_NOT_EXISTS="kernel not exists",e.NOT_SUPPORT="not support",e.STATE_INVALID="state invalid"}(AUDIO_TRACK_ERROR_MSG||(AUDIO_TRACK_ERROR_MSG={}));var defaultI18nConfig={common:{},core:{ERROR_MSG_UNKNOWN:"未知错误",ERROR_XHR_NET:"视频获取途中出现问题",ERROR_PRELOAD_VIDEO_TIMEOUT:"加载视频超时",ERROR_INNER:"视频无法继续播放",ERROR_LOAD_STREAM_FAIL:"视频流获取途中出现问题",ERROR_PLAY_STUCK:"内部错误",ERROR_NULL_URL:"传入的地址为空",ERROR_MEDIA_ERR_ABORTED:"视频获取被终止",ERROR_MEDIA_ERR_NETWORK:"下载视频发生错误",ERROR_MEDIA_ERR_DECODE:"尝试解码出错",ERROR_MEDIA_ERR_SRC_NOT_SUPPORTED:"浏览器不支持该音视频",ERROR_KERNEL_NOT_FOUND:"切换清晰度时找不到对应内核",ERROR_STATUS_NOT_INITIALIZED:"播放器尚未初始化",ERROR_STATUS_NOT_PLAYING:"播放未开始",ERROR_STATUS_EMPTY_URL:"切换目标视频地址为空",ERROR_STATUS_VIDEO_INFO:"找不到当前播放信息",ERROR_STATUS_PLAYTIME_CHECK:"播放未开始",ERROR_STATUS_CLOSE_TO_END:"播放即将结束",ERROR_STATUS_TARGET_UNCHANGED:"切换的视频地址没有变化",ERROR_DRM_UNKNOWN:"未知错误",ERROR_DRM_LICENSE_NOT_EXIST:"视频资源已加密，但未配置解密证书地址",ERROR_DRM_KEY_SYS_NOT_REQUESTED:"视频资源已加密，但尚未请求CDM",ERROR_DRM_KEY_NOT_EXIST:"视频资源已加密，但尚未获取到MediaKey",ERROR_DRM_KEY_SESSION_NOT_EXIST:"视频资源已加密，但CDM",ERROR_DRM_INIT_DATA_EMPTY:"视频资源已加密，但事件信息中没有用于创建请求的 initData",ERROR_DRM_KEY_SESSION_REQUEST_FAILED:"视频资源已加密，但 CDM Session 请求失败",ERROR_DRM_KEY_SYS_NOT_SUPPORTED:"$0 不支持",ERROR_DRM_KEY_SYS_ACCESS_FAILED:"访问CDM失败, keySystem $0",ERROR_DRM_KEY_SESSION_CREATION_FAILED:"CDM Session 初始化失败",ERROR_DRM_HDCP:"你可能链接了不支持HDCP标准的显示器",ERROR_DRM_KEY_INTERNAL:"内部错误",ERROR_DRM_KEY_EXPIRED:"MediaKey 已过期",ERROR_DRM_KEY_RELEASED:"MediaKey 已从CDM中注销",ERROR_DRM_MEDIA_KEYS_SET_FAILED:"failed to set media keys",ERROR_DRM_KEY_SESSION_UPDATE_FAILED:"CDM Session 更新失败，请检查证书解析",ERROR_DRM_LICENSE_REQUEST_FAILED:"证书请求失败 $0",ERROR_DRM_FPS_SET_KEY_FAILED:"Webkit MediaKey创建失败",ERROR_DRM_FPS_CERTIFICATE_NOT_EXIST:"视频资源已加密，但 Fairplay 服务端证书未配置"}},i18nConfig=defaultI18nConfig;function getEnvVals$1(){var e="npm";try{e="npm"}catch(e){}var t="";try{t="1.15.22"}catch(e){}var o="";try{o=1678263394019}catch(e){}var r=!1;try{r=!1}catch(e){}return{CHANNEL:e,VERSION:t,BUILD_TIME:o,LOCAL_DEV:r}}var _a$b=getEnvVals$1(),CHANNEL=_a$b.CHANNEL,BUILD_TIME$2=_a$b.BUILD_TIME,VERSION$3=_a$b.VERSION,LOCAL_DEV=_a$b.LOCAL_DEV,e$2=function(){return(e$2=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},t$1=function(){function e(){}return e.setDefault=function(t){e.defaultOptions=e$2(e$2({},e.defaultOptions),t)},e.getCookie=function(t){var o=void 0,r=document.cookie?document.cookie.split("; "):[],n={};return r.some((function(r){var i=r.split("="),a=i[0],s=i.slice(1),l=e.decode(a),c=e.parseValue(s.join("="));return l===t?(o=c,!0):(n[l]=c,!1)})),void 0===t?n:o},e.setCookie=function(t,o,r){return void 0===r&&(r={}),e.set(t,o,r)},e.clearCookie=function(t,o,r){void 0===o&&(o=""),void 0===r&&(r=""),e.setCookie(t,"",{domain:o,path:r,expires:-1})},e.clearAllCookies=function(t,o){void 0===t&&(t=""),void 0===o&&(o="");var r=document.cookie?document.cookie.split("; "):[],n={domain:t,path:o,expires:-1};r.forEach((function(t){var o=t.split("=")[0];e.set(o,"",n,!0)}))},e.set=function(t,o,r,n){void 0===n&&(n=!1);var i=e$2(e$2({},e.defaultOptions),r),a=i.domain,s=i.path,l=i.secure,c=i.expires,p=i.sameSite,d=new Date(Date.now()+24*c*60*60*1e3),u=[(n?t:e.encode(t))+"="+e.stringifyValue(o),"; expires="+d.toUTCString(),s?"; path="+s:"",a?"; domain="+a:"",p?"; SameSite="+p:"",l?"; Secure":""].join("");return document.cookie=u,u},e.encode=function(t){return e.raw?t:encodeURIComponent(t)},e.decode=function(t){return e.raw?t:decodeURIComponent(t)},e.stringifyValue=function(t){return e.encode(e.json?JSON.stringify(t):String(t))},e.parseValue=function(t){if(e.raw)return t;var o=t;0===o.indexOf('"')&&(o=o.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return o=decodeURIComponent(o.replace(/\+/g," ")),e.json?JSON.parse(o):o}catch(t){}},e.raw=!1,e.json=!1,e.defaultOptions={domain:"",path:"/",expires:365,secure:!0,sameSite:""},e}(),n$2=function(e,t){var o=""+e;return!o||o.length>=t?o:""+Array(t+1-o.length).join("0")+e},i$2=/\[([^\]]+)]|(Y|y){1,4}|M{1,4}|D{1,2}|d{1,2}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,o$2;function r$2(e,t){void 0===t&&(t="yyyy-MM-DD HH:mm:ss");var o=new Date(e);if(isNaN(o.getTime()))return o.toString();var r=t,n=""+o.getFullYear(),i=n.slice(-2),a=o.getHours(),s=""+(a%12||12),l=""+(o.getMonth()+1),c=""+o.getDate(),p=""+o.getDay(),d=""+o.getMinutes(),u=""+o.getSeconds(),A=""+o.getMilliseconds(),_=15*Math.round(o.getTimezoneOffset()/15),E=Math.abs(_),g=n$2(Math.floor(E/60),2),f=n$2(E%60,2),h=_<=0?"+":"-",v=""+h+g+":"+f,y=""+h+g+f,m={YY:i,YYYY:n,yy:i,yyyy:n,M:l,MM:n$2(l,2),D:c,DD:n$2(c,2),d:p,dd:n$2(c,2),H:""+a,HH:n$2(a,2),h:n$2(s,1),hh:n$2(s,2),a:a<12?"am":"pm",A:a<12?"AM":"PM",m:d,mm:n$2(d,2),s:u,ss:n$2(u,2),SSS:n$2(A,3),Z:v,ZZ:y};return r.replace(i$2,(function(e,t){return t||m[e]||e}))}function v$2(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}function h$2(e){var t=e.split("#"),o=t[0],r=t[1],n=void 0===r?"":r,i=o.split("?"),a=i[0],s=i[1],l=void 0===s?"":s,c=v$2(n),p=Object.create(null);return l.split("&").forEach((function(e){var t=e.split("="),o=t[0],r=t[1],n=void 0===r?"":r,i=v$2(o),a=v$2(n);null===i||null===a||""===i&&""===a||p[i]||(p[i]=a)})),{url:a,query:p,hash:c}}function y(e,t){var o;if(!t||!document.querySelectorAll("style[data-tag="+t+"]").length){var r=document.createElement("style");r.textContent=e.trim(),t&&(r.dataset.tag=t),null===(o=document.getElementsByTagName("head")[0])||void 0===o||o.appendChild(r)}}function x$1(e,t){return new Promise((function(o,r){if(t&&document.querySelectorAll("script[data-tag="+t+"]").length)return o();var n=document.createElement("script"),i=e$2({type:"text/javascript",charset:"utf-8"},e);Object.keys(i).forEach((function(e){return S$1(n,e,i[e])})),t&&(n.dataset.tag=t),n.onload=function(){return o()},n.onreadystatechange=function(){var e=n.readyState;["complete","loaded"].includes(e)&&(n.onreadystatechange=null,o())},n.onerror=r,document.body.appendChild(n)}))}function S$1(e,t,o){if(e)return void 0===o?e.getAttribute(t):e.setAttribute(t,o)}function M(e,t){return!!(null==e?void 0:e.className)&&-1!==e.getAttribute("class").split(" ").indexOf(t)}function q(e,t){if(e&&!M(e,t)){var o=(e.className+" "+t).trim();e.setAttribute("class",o)}}function _(e,t){if(e){var o=e.className.split(" "),r=o.indexOf(t);-1!==r&&(o.splice(r,1),e.className=o.join(" "))}}function E(e,t,o){if(e&&t)if("string"!=typeof t||void 0===o){if("string"==typeof t&&void 0===o)return(e.currentStyle?e.currentStyle:getComputedStyle(e,null))[t];"object"==typeof t&&Object.keys(t).forEach((function(o){return E(e,o,t[o])}))}else{var r=/width|height|left|right|top|bottom|padding|margin/i.test(t)&&"number"==typeof o;e.style[t]=r?o+"px":o}}function O(e){E(e,{display:"none"})}function k(e,t){void 0===t&&(t="block"),E(e,{display:t})}function j(e,t){if(e)return void 0===t?e.innerText:void(e.innerText=t)}function C(e,t){if(e)return void 0===t?e.innerHTML:void(e.innerHTML=t)}!function(e){e[e.equal=0]="equal",e[e.low=-1]="low",e[e.high=1]="high"}(o$2||(o$2={}));var A=/^v?(?:\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+))?(?:-[\da-z-]+(?:\.[\da-z-]+)*)?(?:\+[\da-z-]+(?:\.[\da-z-]+)*)?)?)?$/i;function P(e){var t,o=e.replace(/^v/,"").replace(/\+.*$/,""),r=("-",-1===(t=o).indexOf("-")?t.length:t.indexOf("-")),n=o.substring(0,r).split(".");return n.push(o.substring(r+1)),n}function N(e){return isNaN(Number(e))?e:Number(e)}function D(e){if("string"!=typeof e)throw new TypeError("Invalid argument expected string");if(!A.test(e))throw new Error("Invalid argument not valid semver ('"+e+"' received)")}function T(e,t){[e,t].forEach(D);for(var o=P(e),r=P(t),n=0;n<Math.max(o.length-1,r.length-1);n++){var i=parseInt(o[n]||"0",10),a=parseInt(r[n]||"0",10);if(i>a)return o$2.high;if(a>i)return o$2.low}var s=o[o.length-1],l=r[r.length-1];if(s&&l){var c=s.split(".").map(N),p=l.split(".").map(N);for(n=0;n<Math.max(c.length,p.length);n++){if(void 0===c[n]||"string"==typeof p[n]&&"number"==typeof c[n])return-1;if(void 0===p[n]||"string"==typeof c[n]&&"number"==typeof p[n])return 1;if(c[n]>p[n])return o$2.high;if(p[n]>c[n])return o$2.low}}else if(s||l)return s?o$2.low:o$2.high;return o$2.equal}var B=/</g,I=/>/g,H=/"/g,Q=/'/g,R=/&/g;function V(e){return e?(""+e).replace(R,"&amp;").replace(B,"&lt;").replace(I,"&gt;").replace(H,"&quot;").replace(Q,"&#39;"):""}var comTool={supportES6:function(){try{eval("var foo = (x)=>x+1")}catch(e){return!1}return!0},isObject:function(e){return"object"==typeof e&&e.constructor===Object},createGUID:function(e){void 0===e&&(e=32);for(var t=e||32,o="",r=1;r<=t;r++){o+=Math.floor(16*Math.random()).toString(16)}return o},xss:V,removeDiscontinuityTimeRangesFromPlayTime:function(e,t){var o=comTool.findDiscontinuityTimeRangeAtPlaytime(e,t);if(o)return o.start;var r=e;return t.forEach((function(t){t.end<e&&(r-=t.end-t.start)})),r},findDiscontinuityTimeRangeAtPlaytime:function(e,t){return comTool.mergeTimeRanges(t).find((function(t){return e>=t.start&&e<=t.end}))},mergeTimeRanges:function(e){var t=-1,o=-1,r=[];return e.forEach((function(e){var n=e.start,i=e.end;n<=o||(o>=0&&r.push({start:t,end:o}),t=n),o=i})),t>=0&&o>=0&&r.push({start:t,end:o}),r},compareVersion:T,formatPlayTime:function(e){var t=e;if("string"==typeof t&&(t=parseInt(t,10)),"number"!=typeof t||Number.isNaN(t))return"00:00";var o=function(e){return e<10?"0".concat(e):e},r=Math.floor(t/3600),n=Math.floor((t-3600*r)/60),i=Math.floor(t-3600*r-60*n);return 0===r?[o(n),o(i)].join(":"):[r,o(n),o(i)].join(":")},dateFormat:function(e,t){return void 0===t&&(t=Date.now()),r$2(t,e||"yyyy-MM-dd hh:mm:ss")},base64ToArrayBuffer:function(e){for(var t=window.atob(e),o=t.length,r=new Uint8Array(o),n=0;n<o;n++)r[n]=t.charCodeAt(n);return r},isPageHidden:function(){var e=["hidden","msHidden","webkitHidden"].find((function(e){return void 0!==document[e]}));return e?document[e]?1:0:-1},setTimeoutByRAF:function(e,t){var o=window.requestAnimationFrame||window.webkitRequestAnimationFrame,r=+new Date;!function n(){+new Date-r>t?e():o(n)}()},assignApiToPrototype:function(e,t,o){for(var r=Object.getPrototypeOf(e),n=Object.getOwnPropertyNames(t),i=0,a=o.length;i<a;i++){var s=o[i];-1!==n.indexOf(s)||"function"!=typeof r[s]||(t[s]=r[s].bind(e))}}},mobileDevReg=/android|iPod|ipad|iPhone|mobile/i;function uaMatch(e){var t,o,r;e=(e=e||navigator.userAgent).toLowerCase(),this.browser={},this.os={},this.mobile=!1,this.spider=/(googlebot|bingbot|yandex|twitterbot|facebookexternalhit|rogerbot|linkedinbot|embedly|quora link preview|showyoubot|outbrain|pinterest\/0\.|pinterestbot|slackbot|vkShare|W3C_Validator|whatsapp|petalbot|applebot|mpcrawler|spider)/i.test(e),this.headless=/headless/i.test(e),mobileDevReg.test(e)&&(this.mobile=!0);for(var n,i,a={android_1:/android[\s\/]([\d\.]+)/i,android_2:/android/i,android_3:/MIDP-/i,ipod_1:/iPod\stouch;\sCPU\siPhone\sos\s([\d_]+)/i,ipod_100:/iPod.*os\s?([\d_\.]+)/i,iphone:/iPhone;\sCPU\siPhone\sos\s([\d_]+)/i,iphone_100:/iPhone.*os\s?([\d_\.]+)/i,ipad_1:/ipad;\scpu\sos\s([\d_]+)/i,ipad_2:/ipad([\d]+)?/i,windows:/windows\snt\s([\d\.]+)/i,mac:/Macintosh.*mac\sos\sx\s([\d_\.]+)/i,linux:/Linux/i},s=Object.keys(a),l=0,c=s.length;l<c;l++){var p=s[l];if(n=a[p].exec(e)){i=p.replace(/_\d+/,""),this.os[i]=!0,this.os.osName=i,n[1]&&(this.os.version=n[1].replace(/_/g,"."));break}}(this.os.iphone||this.os.ipad||this.os.ipod)&&(this.os.ios=!0);var d,u,A={wechat:/MicroMessenger\/([\d\.]+)/i,ipadqq:/IPadQQ\/([\d\.]+)/i,mqq:/qq\/([\d\.]+)/i,qzone:/QZONEJSSDK\/([\d\.]+)/i,mqqbrowser:/mqqbrowser\/([\d\.]+)/i,qqbrowser:/[^m]QQBrowser\/([\d\.]+)/i,x5:/tbs\/(\d+)/i,uc:/UCBrowser\/([\d\.]+)/i,safari_1:/Version\/(([\d\.]+))\sSafari\/[\d\.]+/i,safari_2:/Safari\/([\d\.]+)/i,chrome_1:/CriOS\/([\d\.]+)/i,chrome_2:/Chrome\/([\d\.]+)/i,firefox:/Firefox\/([\d\.]+)/i,ie_1:/MSIE\s([\d\.]+)/i,ie_2:/(trident\/\d\.\d)/i,ie_3:/(Edge)\/\d+\.\d+/i,weibo:/weibo__([\d\.]+)/i,qqnews:/qqnews\/([\d\.]+)/i,qqlive_1:/QQLiveBrowser\/([\d\.]+)/i,qqlive_2:/QQLiveHDBrowser\/([\d\.]+)/i,kuaibao:/qnreading\/([\d\.]+)/i,liebao:/LieBaoFast\/([\d\.]+)/i,douban:/com\.douban\.frodo\/([\d\.]+)/i,miuibrowser:/MiuiBrowser/i,baidu:/baiduboxapp/i,browser360:/360browser/i,oppobrowser:/OppoBrowser/i,qqdownloader:/qqdownloader\/([\d\.]+)/i},_=Object.keys(A),E=0;for(c=_.length;E<c;E++){var g=_[E];if(d=A[g].exec(e)){if(u=g.replace(/_\d+/,""),this.browser[u])return this;this.browser[u]={version:d[1]},this.browser.browserName=u,this.browser.version=d[1]}}return this.os.android&&this.browser.safari&&(this.browser.safari=null),this.browser.chrome&&this.browser.safari&&(this.browser.safari=null),(null===(r=null===(o=null===(t=this.browser)||void 0===t?void 0:t.ie)||void 0===o?void 0:o.version)||void 0===r?void 0:r.indexOf("trident"))>-1&&(this.browser.ie.version.indexOf("6.0")>-1?this.browser.ie.version="10":this.browser.ie.version.indexOf("5.0")>-1?this.browser.ie.version="9":this.browser.ie.version.indexOf("4.0")>-1?this.browser.ie.version="8":this.browser.ie.version="11"),this}var uaTool=uaMatch.call({},navigator.userAgent),jsonTool={safelyStringify:function(e){try{return JSON.stringify(e)}catch(e){return"{}"}}},__assign$d=window&&window.__assign||function(){return __assign$d=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},__assign$d.apply(this,arguments)},__spreadArray$3=window&&window.__spreadArray||function(e,t,o){if(o||2===arguments.length)for(var r,n=0,i=t.length;n<i;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))},LogCacheLimit=4e3,noop=function(){},dummyConsole={trace:noop,debug:noop,info:noop,log:noop,warn:noop,error:noop},PatchedConsole=Object.assign({},dummyConsole),LogMode;function patchConsole(e){(e||Object.keys(dummyConsole)).forEach((function(e){var t;PatchedConsole[e]=(null===(t=self.console)||void 0===t?void 0:t[e])||noop}))}function enableConsoleOutput(e){patchConsole(e);try{PatchedConsole.log()}catch(e){PatchedConsole=dummyConsole}}function logtool(e){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]}}!function(e){e[e.console=1]="console",e[e.cache=2]="cache"}(LogMode||(LogMode={}));var Logger=function(){function e(t,o,r){if(this.playerId=t,this.scopeName=o,!this.playerId)throw new Error("Missing logger id");e.cache[t]||(e.cache[t]=[]),this.logModeConfig=__assign$d({trace:LogMode.console,debug:LogMode.console,info:LogMode.console,log:LogMode.cache|LogMode.console,warn:LogMode.cache|LogMode.console,error:LogMode.cache|LogMode.console},r)}return e.prototype.trace=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.callApi.apply(this,__spreadArray$3(["trace"],e,!1))},e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.callApi.apply(this,__spreadArray$3(["debug"],e,!1))},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.callApi.apply(this,__spreadArray$3(["info"],e,!1))},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.callApi.apply(this,__spreadArray$3(["log"],e,!1))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.callApi.apply(this,__spreadArray$3(["warn"],e,!1))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.callApi.apply(this,__spreadArray$3(["error"],e,!1))},e.prototype.callApi=function(t){for(var o=[],r=1;r<arguments.length;r++)o[r-1]=arguments[r];var n=this,i=n.playerId,a=n.scopeName,s="[".concat(i.slice(-8),"][").concat(getLogTime(),"]").concat(a?"[".concat(a,"]"):"");if(this.logModeConfig[t]&LogMode.cache){var l="[".concat(t,"]").concat(s," ").concat(o.join(","));l.length>=LogCacheLimit&&(PatchedConsole.warn("Logger cache limit exceeded: ".concat(l.length)),l="".concat(l.slice(0,LogCacheLimit),"...")),e.cache[i].push(l)}this.logModeConfig[t]&LogMode.console&&PatchedConsole[t].apply(PatchedConsole,__spreadArray$3([s],o,!1))},e.level=0,e.cache={},e}(),logMethodCallDecoratorCreator=function(e){void 0===e&&(e="");return function(t,o,r){var n=r.value;r.value=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var i=this._logger||this.logger;return"function"==typeof(null==i?void 0:i.log)&&i.log("@".concat(e,".").concat(o,"()"),jsonTool.safelyStringify(t)),n.apply(this,t)}}};function dumpLog(e){var t=document.createElement("a"),o=e.join("\n\n");t.setAttribute("href","data:text/plain;charset=utf-8,".concat(encodeURIComponent(o))),t.setAttribute("download","tp-log-".concat(Date.now(),".txt")),t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t)}function getLogTime(){var e=new Date;return"".concat(e.getHours(),":").concat(e.getMinutes(),":").concat(e.getSeconds())+".".concat("0000".concat(e.getMilliseconds()).slice(-3))}var __awaiter$8=window&&window.__awaiter||function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},__generator$8=window&&window.__generator||function(e,t){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};function requireModule(e,t){var o;return __awaiter$8(this,void 0,void 0,(function(){var r;return __generator$8(this,(function(n){r=self;try{if("object"==typeof(null===(o=r.module)||void 0===o?void 0:o.export))return[2,r.module.export[e]];if("function"==typeof r.define&&r.define.amd&&"function"==typeof r.require)return[2,new Promise((function(t){r.require([e],(function(e){t(e)}))}))]}catch(e){}return[2,r[t||e]]}))}))}var cookieTool={set:function(e,t,o,r,n){var i={domain:o,path:r};return n&&(i.expires=(new Date).getTime()+3600*n*1e3),t$1.setCookie(e,t,i),!0},get:function(e){return t$1.getCookie(e)||""},del:t$1.clearCookie},lsTool={getData:function(e){var t="";try{window.localStorage&&(t=window.localStorage[e])}catch(e){window.console.log(e)}return t},setData:function(e,t){if("undefined"!==e&&void 0!==e)try{window.localStorage&&(window.localStorage[e]=t)}catch(e){window.console.log(e)}},delData:function(e){try{window.localStorage&&window.localStorage.removeItem(e)}catch(e){window.console.log(e)}}},urlTool={object2string:function(e,t){return void 0===t&&(t="&"),this.convertUrlParam(e,t,!1)},convertUrlParam:function(e,t,o){if(void 0===t&&(t="&"),void 0===o&&(o=!0),!e)return"";var r=Object.keys(e);if(r.length<=0)return"";var n=[];return r.forEach((function(t){var r="";r=o?"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(e[t])):"".concat(t,"=").concat(e[t]),n.push(r)})),n.join(t)},getRootDomain:function(){var e=window.location.hostname||window.location.host,t=window.location.host.split(".");return t.length>1&&(e=t.slice(t.length-2).join(".")),e},getTopFrameUrl:function(){var e="";if(window.top!==window)try{e=window.top.location.href}catch(t){e=document.referrer}else e=window.location.href;return e},getDomainOfURL:function(e){if(null==e||""===e)return"";try{return new URL(e).hostname}catch(e){return""}},getUrlParamByKey:function(e,t){return h$2(e||location.href).query[t]||""},getUrlParams:function(e){return h$2(e||location.href).query},updateUrlParam:function(e,t,o){var r=e,n=this.getUrlParamByKey(r,t),i="".concat(t,"=").concat(o);return r=n?r.replace("".concat(t,"=").concat(n),i):r+(-1!==r.indexOf("?")?"&":"?")+i},getFileName:function(e){if(!e)return null;var t=e,o=t.indexOf("?");o>0&&(t=t.slice(0,o));var r=t.lastIndexOf("/");r>0&&(t=t.slice(r+1,t.length));var n=t.lastIndexOf("#");return n>0&&(t=t.slice(0,n)),t},getFileExtension:function(e){if(!e)return null;if(this.isWebRTCLink(e))return"webrtc";var t=urlTool.getFileName(e);if(t){var o=t.split(".");if(o&&o.length>1)return o[o.length-1]}return null},isWebRTCLink:function(e){return/^webrtc:\/\//.test(e)}},__extends$c=window&&window.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),SimpleDefer=function(){var e=this;this.state="pending",this.promise=new Promise((function(t,o){e.resolve=function(o){e.state="fulfilled",t(o)},e.reject=function(t){e.state="rejected",o(t)}}))},TimeoutDefer=function(e){function t(t){var o=e.call(this)||this;return t.timeoutMS>0&&setTimeout((function(){return o.reject()}),t.timeoutMS),o}return __extends$c(t,e),t}(SimpleDefer),__assign$c=window&&window.__assign||function(){return __assign$c=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},__assign$c.apply(this,arguments)},domTool={insertStyle:y,loadScript:function(e,t,o,r){var n=new TimeoutDefer({timeoutMS:o});return x$1(__assign$c(__assign$c({},r),{src:e}),t).then(n.resolve).catch(n.reject),n.promise},attr:S$1,removeAttr:function(e,t){e&&t&&("src"===t?delete e.src:e.removeAttribute(t))},css:E,append:function(e,t){e&&e.appendChild(t)},prepend:function(e,t){e.children[0]?e.insertBefore(t,e.children[0]):e.appendChild(t)},addClass:q,removeClass:_,hasClass:M,hide:O,show:k,text:j,html:C,creatDom:function(e){return this.createDom(e)},createDom:function(e){var t=document.createElement("div");return t.innerHTML=e,t.firstChild},getDomSize:function(e){if(!e)return{width:0,height:0};var t=e.currentStyle?e.currentStyle:window.getComputedStyle(e,null);return{width:parseFloat(t.width),height:parseFloat(t.height)}},createVideoDom:function(e){var t=e||{},o=t.attrOpts,r=void 0===o?{}:o,n=t.cssOpts,i=void 0===n?{}:n,a=document.createElement("video");return Object.keys(r).forEach((function(e){a.setAttribute(e,r[e])})),E(a,i),a},getElementFromConfig:function(e){return"string"==typeof e?document.querySelector(e):e}},e$1=function(){return(e$1=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},o$1;function v$1(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}function g(e,t){var o=[null,void 0,"",NaN].includes(e);if(t.isSkipEmpty&&o)return null;var r=!t.isSkipEmpty&&o?"":e;try{return t.encode?encodeURIComponent(r):r}catch(e){return null}}function h$1(e){var t=e.split("#"),o=t[0],r=t[1],n=void 0===r?"":r,i=o.split("?"),a=i[0],s=i[1],l=void 0===s?"":s,c=v$1(n),p=Object.create(null);return l.split("&").forEach((function(e){var t=e.split("="),o=t[0],r=t[1],n=void 0===r?"":r,i=v$1(o),a=v$1(n);null===i||null===a||""===i&&""===a||p[i]||(p[i]=a)})),{url:a,query:p,hash:c}}function m(e,t){void 0===t&&(t={encode:!0,isSkipEmpty:!1});var o=e.url,r=e.query,n=void 0===r?{}:r,i=e.hash,a=o.split("#"),s=a[0],l=a[1],c=void 0===l?"":l,p=s.split("?")[0],d=[],u=g(i||c,t),A=e$1(e$1({},h$1(o).query),n);return Object.keys(A).forEach((function(e){var o=g(e,t),r=g(A[e],t);null!==o&&null!==r&&d.push(o+"="+r)})),p+(d.length?"?"+d.join("&"):"")+(u?"#"+u:"")}function x(e,t){return new Promise((function(o,r){if(t&&document.querySelectorAll("script[data-tag="+t+"]").length)return o();var n=document.createElement("script"),i=e$1({type:"text/javascript",charset:"utf-8"},e);Object.keys(i).forEach((function(e){return S(n,e,i[e])})),t&&(n.dataset.tag=t),n.onload=function(){return o()},n.onreadystatechange=function(){var e=n.readyState;["complete","loaded"].includes(e)&&(n.onreadystatechange=null,o())},n.onerror=r,document.body.appendChild(n)}))}function S(e,t,o){if(e)return void 0===o?e.getAttribute(t):e.setAttribute(t,o)}!function(e){e[e.equal=0]="equal",e[e.low=-1]="low",e[e.high=1]="high"}(o$1||(o$1={}));var r$1=function(){return(r$1=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function n$1(e,t,o,r){return new(o||(o=Promise))((function(n,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))}function o(e,t){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((n=(n=a.trys).length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var i$1=function(){function e(){this.interceptors=[]}return e.prototype.use=function(e,t){return this.interceptors.push({resolved:e,rejected:t}),this.interceptors.length-1},e.prototype.traverse=function(e,t){void 0===t&&(t=!1);var o=Promise.resolve(e);return(t?Array.prototype.reduceRight:Array.prototype.reduce).call(this.interceptors,(function(e,t){if(t){var r=t.resolved,n=t.rejected;o=o.then(r,n)}return e}),""),o},e.prototype.eject=function(e){this.interceptors[e]&&(this.interceptors[e]=null)},e}(),c={defaults:{timeout:0,method:"GET",mode:"cors",redirect:"follow",credentials:"same-origin"},headers:{common:{Accept:"application/json, text/plain, */*"},POST:{"Content-Type":"application/x-www-form-urlencoded"},PUT:{"Content-Type":"application/x-www-form-urlencoded"},PATCH:{"Content-Type":"application/x-www-form-urlencoded"}},baseURL:"",polyfillUrl:"https://vm.gtimg.cn/comps/script/fetch.min.js",interceptors:{request:new i$1,response:new i$1}},u=/^([a-z][a-z\d+\-.]*:)?\/\//i,a=Object.prototype.toString;function s$1(e){return n$1(this,void 0,void 0,(function(){var t;return o(this,(function(o){switch(o.label){case 0:if(window.fetch)return[2];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,x({src:e})];case 2:return o.sent(),[3,4];case 3:throw t=o.sent(),new Error("加载 polyfill "+e+" 失败: "+t.message);case 4:return[2]}}))}))}function l(e){return["Accept","Content-Type"].forEach((function(t){return o=t,void((r=e.headers)&&Object.keys(r).forEach((function(e){e!==o&&e.toUpperCase()===o.toUpperCase()&&(r[o]=r[e],delete r[e])})));var o,r})),function(e){if("[object Object]"!==a.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}(e.body)&&(e.body=JSON.stringify(e.body),e.headers&&(e.headers["Content-Type"]="application/json;charset=utf-8")),e}var f=function(){},d=1;function h(e,t){return void 0===t&&(t={}),new Promise((function(o,r){var n,i=t.name,a=t.query,s=void 0===a?{}:a,l=t.param,c=void 0===l?"callback":l,p=t.timeout,u=void 0===p?6e4:p,A=t.prefix,_=void 0===A?"jsonp_":A,E=t.controller,g=t.charset,h=i||""+_+d++,v=document.createElement("script"),y=u?setTimeout((function(){T(!0),r(new Error("jsonp timeout"))}),u):null,T=function(e){var t;void 0===e&&(e=!1),null===(t=v.parentNode)||void 0===t||t.removeChild(v),y&&clearTimeout(y),E&&(E.element=null),window[h]=e?f:null},C=m({url:e,query:r$1(r$1({},s),(n={},n[c]=h,n))});v.src=C,g&&(v.charset=g),E&&(E.element=v),v.onerror=function(e){T(),r(e)},window[h]=function(e){T(),o(e)},document.body.appendChild(v)}))}function v(e){return n$1(this,void 0,void 0,(function(){var t,r,n,i,a,s,p,d,A,_,E,g,f,h,v,y,T;return o(this,(function(o){switch(o.label){case 0:return t=c.baseURL,r=c.defaults,n=c.interceptors,[4,s$1(c.polyfillUrl)];case 1:return o.sent(),(i=r$1(r$1({},r),e)).headers||(i.headers=function(e){void 0===e&&(e="GET");var t=c.headers[e]||{};return r$1(r$1({},c.headers.common),t)}(i.method)),l(i),[4,n.request.traverse(i,!0)];case 2:if((a=o.sent())instanceof Error)throw a;return a.url=function(e,t){return!e||u.test(t)?t:e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,"")}(t,a.url),s=a.url,p=a.timeout,d=a.params,A=a.method,_=["GET","DELETE","OPTIONS","HEAD"].includes(void 0===A?"GET":A)&&!!d,E=_?m({url:s,query:d}):s,g=[],p&&!a.signal&&(v=new Promise((function(e){f=setTimeout((function(){e(new Error("timeout"))}),p)})),g.push(v),h=new AbortController,a.signal=h.signal),g.push(fetch(E,a).catch((function(e){return e}))),[4,Promise.race(g)];case 3:return y=o.sent(),f&&clearTimeout(f),[4,n.response.traverse(y)];case 4:if((T=o.sent())instanceof Error)throw null==h||h.abort(),T;return[2,T]}}))}))}var netTool={jsonp:h,img:function(e){return new window.Promise((function(t,o){(new Image).src=e,t()}))},fetch:function(e,t){return void 0===t&&(t={}),v({url:e,method:t.method,body:t.body}).then((function(e){return e.json()}))},xhr:function(e){var t=e.retryCount||0,o=+new Date,r=0,n=function(i,a){var s=function(e){void 0===e&&(e="xhrNetworkError"),r<t?(r++,n(i,a)):a({error:e,target:l})},l=new XMLHttpRequest;l.open(e.method||"get",e.url),e.timeout&&(l.timeout=e.timeout),e.responseType&&(l.responseType=e.responseType),l.withCredentials=!!e.withCredentials,l.ontimeout=e.ontimeout,e.range&&l.setRequestHeader("Range","bytes=".concat(e.range[0],"-").concat(e.range[1])),e.headers&&Object.keys(e.headers).forEach((function(t){l.setRequestHeader(t,e.headers[t])})),l.onload=function(){200!==l.status&&206!==l.status?s("xhrStatusCodeError"):i({data:l.response,target:l,startTimestamp:o})},l.onerror=function(e){s()},l.onabort=function(){},l.ontimeout=function(){s("xhrTimeoutError")},e.body?l.send(e.body):l.send()};return new Promise((function(e,t){n(e,t)}))}};function getEventEmitterBinder(e,t){return t?e.on.bind(e):e.off.bind(e)}function getEventTargetBinder(e,t){return t?e.addEventListener.bind(e):e.removeEventListener.bind(e)}function compile(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];if("function"==typeof e)return e.apply(void 0,t);for(var r=e,n=0;n<t.length;n++)r=r.replace("$".concat(n),String(t[n]));return r}var i18nTool={compile:compile},_a$a,ErrorTypeCodeMap=(_a$a={},_a$a.native=11,_a$a.network=16,_a$a.encryption=90,_a$a.custom=-1,_a$a),MediaElementNetworkErrorCode=[1,2],MediaElementPlaybackErrorCode=[3,4],ErrorBase=function(){function e(e,t){this.detail=null;var o=t.code,r=t.detail,n=t.message,i=t.fatal,a=t.debugMessage;this.type=e,this.errorCode=o,this.detail=null!=r?r:null,this.fatal=null!=i&&i,this.message=null!=n?n:compile(defaultI18nConfig.core.ERROR_MSG_UNKNOWN),this.debugMessage=a}return Object.defineProperty(e.prototype,"code",{get:function(){var e="custom"===this.type?"".concat(this.errorCode):"".concat(ThumbPlayerErrorPrefix).concat(ErrorTypeCodeMap[this.type]).concat(patchCode(this.errorCode));return this.detail?"".concat(e,".").concat(this.detail):e},enumerable:!1,configurable:!0}),e.prototype.equals=function(t,o){return void 0===o&&(o=!1),t instanceof e?this.type===t.type&&this.errorCode===t.errorCode&&(!o||this.detail===t.detail):this.code===(null==t?void 0:t.code)},e.prototype.toString=function(){return this.serialize()},e.prototype.toJSON=function(){return this.serialize()},e.prototype.serialize=function(){var e,t;return"error=".concat(this.code,";fatal=").concat(+this.fatal,";msg=").concat(null!==(t=null!==(e=this.debugMessage)&&void 0!==e?e:this.message)&&void 0!==t?t:"")},e}(),ThumbPlayerErrorPrefix="700";function patchCode(e){return"000".concat(e).slice(-3)}var PlayerError=function(){function e(){}return e.CustomError=function(e){return new ErrorBase("custom",e)},e.NativeError=function(e){return new ErrorBase("native",e)},e.NetworkError=function(e){return new ErrorBase("network",e)},e.EncryptionError=function(e){return new ErrorBase("encryption",e)},e}(),r;function t(e,t,o,r){return new(o||(o=Promise))((function(n,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))}function e(e,t){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((n=(n=a.trys).length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function n(e,t,o){if(o||2===arguments.length)for(var r,n=0,i=t.length;n<i;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))}!function(e){e[e.sync=1]="sync",e[e.async=0]="async"}(r||(r={}));var i=function(){function e(){this._hasPriority=!1,this._array=[]}return e.prototype.insert=function(e,t){if(void 0===t&&(t=!1),0!==e.priority&&(this._hasPriority=!0),!this._hasPriority)return t?(this._array.unshift(e),0):(this._array.push(e),this._array.length-1);var o=this._array.findIndex((function(o){return o.priority===e.priority?t:o.priority<e.priority}));return-1===o?(this._array.push(e),this._array.length-1):(this._array.splice(o,0,e),o)},e.prototype.clone=function(){return n([],this._array,!0)},e.prototype.getListener=function(e){return this._array[e]},e.prototype.getListeners=function(){return this._array.map((function(e){return e.listener}))},e.prototype.remove=function(e){var t=this._array.findIndex((function(t){return t.listener===e}));-1!==t&&(this._array[t].isRemove=!0,this._array.splice(t,1))},e.prototype.findIdx=function(e){return this._array.findIndex((function(t){return t.listener===e}))},e.prototype.size=function(){return this._array.length},e}(),s=function(){function o(e){void 0===e&&(e={}),this._events=Object.create(null),this._cacheEvents=Object.create(null);var t=e.maxListeners,o=void 0===t?10:t,n=e.replayType,i=void 0===n?r.sync:n,a=e.isCache,s=void 0!==a&&a;this._isCache=s,this._replayType=i,this._maxListeners=o}return o.prototype.setCacheStatus=function(e){this._isCache=e},o.prototype.setReplayType=function(e){this._replayType=e},o.prototype.getCacheStatus=function(){return this._isCache},o.prototype.clearCache=function(){this._isCache=!1,this._cacheEvents=Object.create(null)},o.prototype.setMaxListeners=function(e){return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return this._maxListeners},o.prototype.emit=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];return this._emit.apply(this,n([!1,e],t,!1))},o.prototype.asyncEmit=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];return this._emit.apply(this,n([!0,e],t,!1))},o.prototype.addListener=function(e,t){return this._addListener(e,{listener:t,priority:0,isOnce:!1})},o.prototype.on=function(e,t,o){return void 0===o&&(o=0),this._addListener(e,{listener:t,priority:o,isOnce:!1})},o.prototype.listeners=function(e){var t=this._events[e];return t?t.getListeners():[]},o.prototype.prependListener=function(e,t){return this._addListener(e,{listener:t,priority:0,isOnce:!1},!0)},o.prototype.once=function(e,t,o){return void 0===o&&(o=0),this._addListener(e,{listener:t,priority:o,isOnce:!0})},o.prototype.removeListener=function(e,t){var o=this._events[e];return o?(o.remove(t),this):this},o.prototype.off=function(e,t){return this.removeListener(e,t)},o.prototype.removeAllListeners=function(e){return void 0===e?(this._events=Object.create(null),this):(this._events[e]&&delete this._events[e],this)},o.prototype.listenerCount=function(e){var t;return(null===(t=this._events[e])||void 0===t?void 0:t.size())||0},o.prototype.eventNames=function(){return Object.getOwnPropertyNames(this._events)},o.prototype._emit=function(r,n){var i=this;void 0===r&&(r=!1);for(var a=[],s=2;s<arguments.length;s++)a[s-2]=arguments[s];var l=[{type:n,target:this,data:1===a.length?a[0]:a}],c=this._events[n],p={stopIndex:-1,onceCount:0,emitData:l};if(this._addCacheEvent(n,p,r),!c)return!!r&&Promise.resolve(!1);var d=Promise.resolve();return c.clone().some((function(n,a){return(n.isOnce||n.isRemove)&&(p.onceCount+=1),!n.isRemove&&(r?(d=d.then((function(){return t(i,void 0,void 0,(function(){return e(this,(function(e){switch(e.label){case 0:return p.stopIndex>=0||n.isRemove?[2]:(n.isOnce&&c.remove(n.listener),[4,n.listener.apply(this,l)]);case 1:return e.sent()===o.STOP_IMMEDIATE_PROPAGATION&&(p.stopIndex=Math.max(a-p.onceCount,0)),[2]}}))}))})),!1):(n.isOnce&&c.remove(n.listener),n.listener.apply(i,l)===o.STOP_IMMEDIATE_PROPAGATION&&(p.stopIndex=Math.max(a-p.onceCount,0),!0)))})),!r||d.then((function(){return!0}))},o.prototype._addCacheEvent=function(e,t,o){if(this._isCache){var r=o?Promise.resolve(t):t;this._cacheEvents[e]?this._cacheEvents[e].push(r):this._cacheEvents[e]=[r]}},o.prototype._replayCacheEvent=function(r,n,i,a){var s=this,l=a||this._cacheEvents[r];if(this._isCache&&l){var c=n.isOnce?1:0;l.some((function(a,p){return a instanceof Promise?(l[p]=a.then((function(a){return t(s,void 0,void 0,(function(){var t;return e(this,(function(e){switch(e.label){case 0:return a.stopIndex>=0&&i>a.stopIndex?[2,a]:[4,n.listener.apply(this,a.emitData)];case 1:return t=e.sent(),n.isOnce&&this.off(r,n.listener),t===o.STOP_IMMEDIATE_PROPAGATION?a.stopIndex=Math.max(i-c,0):a.stopIndex>=0&&i<=a.stopIndex&&(a.stopIndex=a.stopIndex-c+1),[2,a]}}))}))})),n.isOnce):(a.stopIndex>=0&&i>a.stopIndex||(n.isOnce&&s.off(r,n.listener),n.listener.apply(s,a.emitData)===o.STOP_IMMEDIATE_PROPAGATION?a.stopIndex=Math.max(i-c,0):a.stopIndex>=0&&i<=a.stopIndex&&(a.stopIndex=a.stopIndex-c+1)),n.isOnce)}))}},o.prototype._addListener=function(e,t,o){var a=this;void 0===o&&(o=!1),this._events[e]||(this._events[e]=new i);var s=this._events[e].insert(t,o);if(this._maxListeners>0&&this._events[e].size()===this._maxListeners&&console.warn("Possible EventEmitter memory leak detected. ".concat(this._events[e].size()," ").concat(String(e)," listeners ")+"added. Use emitter.setMaxListeners() to increase limit"),this._replayType===r.async){var l=this._cacheEvents[e]?n([],this._cacheEvents[e],!0):null;if(!l)return this;setTimeout((function(){var o=a._events[e].findIdx(t.listener);-1!==o&&a._replayCacheEvent(e,t,o,l)}))}else this._replayCacheEvent(e,t,s);return this},o.STOP_IMMEDIATE_PROPAGATION="EventEmitter.STOP_IMMEDIATE_PROPAGATION",o}();function transformInitData(e,t,o){var r=stringTool.stringToArray(t),n=e.byteLength+4+r.byteLength+4+o.byteLength,i=0,a=new ArrayBuffer(n),s=new DataView(a),l=new Uint8Array(a,i,e.byteLength);l.set(e),i+=l.byteLength,s.setUint32(i,r.byteLength,!0),i+=4;var c=new Uint16Array(a,i,r.length);return c.set(r),i+=c.byteLength,s.setUint32(i,o.byteLength,!0),i+=4,new Uint8Array(a,i,o.byteLength).set(o),new Uint8Array(a,0,a.byteLength)}function getContentId(e){var t,o,r;return null===(r=null===(o=null===(t=stringTool.arrayToString(e).split("skd://"))||void 0===t?void 0:t[1])||void 0===o?void 0:o.split("?"))||void 0===r?void 0:r[0]}function builtMessageXML(e){return(new DOMParser).parseFromString(String.fromCharCode.apply(null,new Uint16Array(e)),"application/xml")}function getChallenge(e){var t=e.getElementsByTagName("Challenge")[0];try{return atob(t.childNodes[0].nodeValue)}catch(e){throw"cannot parse <Challenge> from init message"}}function builtHeadersFromXML(e){var t={},o=e.getElementsByTagName("name"),r=e.getElementsByTagName("value");if(o.length!==r.length)throw"header names and values are not match";for(var n=0;n<o.length;n++)t[o[n].childNodes[0].nodeValue]=r[n].childNodes[0].nodeValue;return t}var __extends$b=window&&window.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),__assign$b=window&&window.__assign||function(){return __assign$b=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},__assign$b.apply(this,arguments)},__awaiter$7=window&&window.__awaiter||function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},__generator$7=window&&window.__generator||function(e,t){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i18nCore$1=i18nConfig.core,KeySystems;function getSupportedKeySystemConfig(e){switch(e){case KeySystems.FairPlayWebKit:return null;case KeySystems.Widevine:return{initDataTypes:["cenc"],audioCapabilities:[{contentType:'audio/mp4; codecs="mp4a.40.2"',robustness:"SW_SECURE_CRYPTO"}],videoCapabilities:[{contentType:'video/mp4; codecs="avc1.42E01E"',robustness:"SW_SECURE_CRYPTO"}]};case KeySystems.FairPlay:return{initDataTypes:["skd","cenc"],videoCapabilities:[{contentType:"application/vnd.apple.mpegurl",robustness:""}]};case KeySystems.PlayReady:case KeySystems.PlayReadyHardware:return{initDataTypes:["keyids","cenc"],audioCapabilities:[{contentType:'audio/mp4; codecs="mp4a.40.2"'}],videoCapabilities:[{contentType:'video/mp4; codecs="avc1.42E01E"'}]};default:return null}}!function(e){e.FairPlayWebKit="com.apple.fps.1_0",e.Widevine="com.widevine.alpha",e.FairPlay="com.apple.fps",e.Chacha="com.tencent.chacha",e.PlayReady="com.microsoft.playready",e.PlayReadyHardware="com.microsoft.playready.hardware"}(KeySystems||(KeySystems={}));var ERR="error",DRM=function(e){function t(o,r,n){var i=e.call(this)||this;return i.started=!1,i.mediaKeyDescriptor=null,i.mediaKeyPromise=null,i.onVideoEncrypted=function(e){i.logger.log("media encrypted",e),i.mediaKeyPromise?i.mediaKeyPromise.then((function(t){i.mediaKeyDescriptor?i.mediaKeyDescriptor.hasInitialized?i.logger.warn("Media key-session has been initialized but requested again"):i.mediaKeyDescriptor.mediaKeys?i.mediaKeyDescriptor.mediaKeySession?e.initData?(i.mediaKeyDescriptor.mediaKeySession.generateRequest(e.initDataType,e.initData).catch((function(e){i.emit(ERR,{code:13,message:compile(i18nConfig.ERROR_DRM_KEY_SESSION_REQUEST_FAILED)})})),i.mediaKeyDescriptor.initData=e.initData,i.mediaKeyDescriptor.hasInitialized=!0):i.emit(ERR,{code:7,message:compile(i18nCore$1.ERROR_DRM_INIT_DATA_EMPTY)}):i.emit(ERR,{code:5,message:compile(i18nConfig.ERROR_DRM_KEY_SESSION_NOT_EXIST)}):i.emit(ERR,{code:6,message:compile(i18nCore$1.ERROR_DRM_KEY_NOT_EXIST)}):i.emit(ERR,{code:6,message:compile(i18nCore$1.ERROR_DRM_KEY_NOT_EXIST)})})):i.emit(ERR,{code:4,message:compile(i18nCore$1.ERROR_DRM_KEY_SYS_NOT_REQUESTED)})},i.onVideoWebkitneedkey=function(e){var o=i.config.fpsCustomContentId(e.initData),r=t.serverCertificate[KeySystems.FairPlayWebKit];if(r){var n=i.config.fpsCustomTransformInitData(e.initData,o,r);i.mediaKeyDescriptor.initData=n,i.mediaKeyDescriptor.mediaKeySession?i.logger.warn("Media key-session has already been initialized"):(i.mediaKeyDescriptor.mediaKeySession=i.createSessionWithMediaKey(i.mediaKeyDescriptor.mediaKeys,n),i.mediaKeyDescriptor.assetID=o,i.mediaKeyDescriptor.mediaKeySession.onwebkitkeyadded=i.onFPSKeySessionKeyAdded,i.mediaKeyDescriptor.mediaKeySession.onwebkitkeyerror=i.onFPSKeySessionKeyError,i.mediaKeyDescriptor.mediaKeySession.onwebkitkeymessage=function(e){i.onMediaKeySessionMessage(i.mediaKeyDescriptor.mediaKeySession,e)})}else i.emit(ERR,{code:9,message:compile(i18nCore$1.ERROR_DRM_FPS_CERTIFICATE_NOT_EXIST)})},i.onFPSKeySessionKeyAdded=function(e){},i.onFPSKeySessionKeyError=function(e){var t=i.mediaKeyDescriptor.mediaKeySession.error;if(t.systemCode){var o={1212433232:[10,compile(i18nCore$1.ERROR_DRM_HDCP)]};o[t.systemCode]&&i.emit(ERR,{code:o[t.systemCode][0],message:o[t.systemCode][1]})}else i.emit(ERR,{code:0,message:compile(i18nCore$1.ERROR_DRM_UNKNOWN)})},i.media=o,i.logger=n,i.config=__assign$b({keySystem:null,fpsCustomContentId:getContentId,fpsCustomTransformInitData:transformInitData},r),i}return __extends$b(t,e),Object.defineProperty(t.prototype,"isFairPlay",{get:function(){var e=this.config.keySystem;return e===KeySystems.FairPlay||e===KeySystems.FairPlayWebKit},enumerable:!1,configurable:!0}),t.isKeySystemSupported=function(e){var t,o,r;return null===(r=((t={})[KeySystems.FairPlayWebKit]=[null===(o=self.WebKitMediaKeys)||void 0===o?void 0:o.isTypeSupported(e,"video/mp4")],t[KeySystems.FairPlay]=[uaTool.browser.safari,self.MediaKeys,self.navigator.requestMediaKeySystemAccess],t[KeySystems.Widevine]=[self.MediaKeys,self.navigator.requestMediaKeySystemAccess],t[KeySystems.PlayReady]=[self.MediaKeys,self.navigator.requestMediaKeySystemAccess],t[KeySystems.PlayReadyHardware]=[self.MediaKeys,self.navigator.requestMediaKeySystemAccess],t)[e])||void 0===r?void 0:r.every(Boolean)},t.prototype.destroy=function(){this.removeAllListeners(),this.logger=null},t.prototype.configure=function(e){var o=this;this.config=__assign$b(__assign$b({},this.config),e),this.config.certificate&&Object.keys(this.config.certificate).forEach((function(e){t.serverCertificate[e]=o.config.certificate[e]}))},t.prototype.hasStarted=function(){return this.started},t.prototype.init=function(e){return __awaiter$7(this,void 0,void 0,(function(){return __generator$7(this,(function(o){switch(o.label){case 0:return[4,this.reset()];case 1:return o.sent(),e&&this.configure(e),"string"!=typeof t.serverCertificate[this.config.keySystem]?[3,3]:[4,this.requestServerCertificate(this.config.keySystem,t.serverCertificate[this.config.keySystem])];case 2:o.sent(),o.label=3;case 3:return this.bind(),this.logger.log("drm module initialized",this.config),[2]}}))}))},t.prototype.reset=function(){return __awaiter$7(this,void 0,void 0,(function(){var e,t,o;return __generator$7(this,(function(r){switch(r.label){case 0:if(this.started=!1,!this.config.keySystem||!this.mediaKeyDescriptor)return[2];if((o={})[KeySystems.FairPlayWebKit]=this.cleanupFPSSession,o[KeySystems.FairPlay]=this.cleanupMediaKeySession,o[KeySystems.Widevine]=this.cleanupMediaKeySession,o[KeySystems.PlayReady]=this.cleanupMediaKeySession,o[KeySystems.PlayReadyHardware]=this.cleanupMediaKeySession,e=o,this.videoEncryptedEventPicker(!1),!e[this.config.keySystem])return[3,4];t=this.mediaKeyDescriptor.mediaKeySession,this.mediaKeyPromise=null,this.mediaKeyDescriptor=null,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,e[this.config.keySystem].call(this,t)];case 2:case 3:return r.sent(),[3,4];case 4:return[2]}}))}))},t.prototype.bind=function(){var e=this.config.keySystem;e&&(t.isKeySystemSupported(e)?(this.started=!0,this.mediaKeyPromise=this.createKeySystemAccess(e),this.videoEncryptedEventPicker(!0)):this.logger.warn("当前环境不支持 ".concat(e)))},t.prototype.cleanupMediaKeySession=function(e){return this.media&&e?(e.onmessage=null,e.onkeystatuseschange=null,e.close().catch((function(){})),this.media.setMediaKeys(null)):Promise.resolve()},t.prototype.videoEncryptedEventPicker=function(e){var t;void 0===e&&(e=!0);var o=((t={})[KeySystems.FairPlayWebKit]=["webkitneedkey",this.onVideoWebkitneedkey],t[KeySystems.Widevine]=["encrypted",this.onVideoEncrypted],t[KeySystems.FairPlay]=["encrypted",this.onVideoEncrypted],t[KeySystems.PlayReady]=["encrypted",this.onVideoEncrypted],t[KeySystems.PlayReadyHardware]=["encrypted",this.onVideoEncrypted],t)[this.config.keySystem],r=o[0],n=o[1];e?this.media.addEventListener(r,n):this.media.removeEventListener(r,n)},t.prototype.createSessionWithMediaKey=function(e,t){var o;return((o={})[KeySystems.FairPlayWebKit]=this.createFPSWebkitSession,o[KeySystems.Widevine]=this.createMediaKeySession,o[KeySystems.FairPlay]=this.createMediaKeySession,o[KeySystems.PlayReady]=this.createMediaKeySession,o[KeySystems.PlayReadyHardware]=this.createMediaKeySession,o)[this.config.keySystem].call(this,e,t)},t.prototype.createKeySystemAccess=function(e){var t;return((t={})[KeySystems.Widevine]=this.requestKeySystemAccess,t[KeySystems.FairPlay]=this.requestKeySystemAccess,t[KeySystems.FairPlayWebKit]=this.requestFPSMediaKeys,t[KeySystems.PlayReady]=this.requestKeySystemAccess,t[KeySystems.PlayReadyHardware]=this.requestKeySystemAccess,t)[this.config.keySystem].call(this,e)},t.prototype.requestLicense=function(e,t){var o;if(this.config.licenseUrl)return((o={})[KeySystems.FairPlayWebKit]=this.createFPSLicenseRequest,o[KeySystems.Widevine]=this.createWidevineLicenseRequest,o[KeySystems.PlayReady]=this.createPlayReadyLicenseRequest,o[KeySystems.FairPlay]=this.createFPSLicenseRequest,o[KeySystems.PlayReadyHardware]=this.createPlayReadyLicenseRequest,o)[this.config.keySystem].call(this,e,t);this.emit(ERR,{code:12,message:compile(i18nCore$1.ERROR_DRM_LICENSE_NOT_EXIST)})},t.prototype.requestServerCertificate=function(e,o){return __awaiter$7(this,void 0,void 0,(function(){var r;return __generator$7(this,(function(n){switch(n.label){case 0:return[4,netTool.xhr({method:"GET",responseType:"arraybuffer",url:o})];case 1:return r=n.sent().data,t.serverCertificate[e]=new Uint8Array(r),[2]}}))}))},t.prototype.requestKeySystemAccess=function(e){return __awaiter$7(this,void 0,void 0,(function(){var t,o;return __generator$7(this,(function(r){switch(r.label){case 0:if(!(t=getSupportedKeySystemConfig(e)))return this.emit(ERR,{code:3,message:compile(i18nCore$1.ERROR_DRM_KEY_SYS_NOT_SUPPORTED,e)}),[2];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,self.navigator.requestMediaKeySystemAccess(e,[t])];case 2:return o=r.sent(),[2,this.onMediaKeySystemObtained(e,o)];case 3:return r.sent(),this.emit(ERR,{code:1,message:compile(i18nCore$1.ERROR_DRM_KEY_SYS_ACCESS_FAILED,e)}),[2];case 4:return[2]}}))}))},t.prototype.onMediaKeySystemObtained=function(e,o){return __awaiter$7(this,void 0,void 0,(function(){var r;return __generator$7(this,(function(n){switch(n.label){case 0:return[4,o.createMediaKeys()];case 1:r=n.sent(),this.mediaKeyDescriptor={hasInitialized:!1,mediaKeySession:null,mediaKeySystemAccess:o,mediaKeys:r},n.label=2;case 2:return n.trys.push([2,5,,6]),e!==KeySystems.FairPlay?[3,4]:[4,r.setServerCertificate(t.serverCertificate[KeySystems.FairPlay])];case 3:n.sent(),n.label=4;case 4:return this.createSessionWithMediaKey(r),[2,r];case 5:return n.sent(),this.emit(ERR,{code:2,message:compile(i18nCore$1.ERROR_DRM_KEY_SESSION_CREATION_FAILED)}),[2];case 6:return[2]}}))}))},t.prototype.createMediaKeySession=function(e){var t=this;if(this.mediaKeyDescriptor.mediaKeySession)this.logger.warn("Media key-session has already been initialized");else{var o={"output-restricted":[10,compile(i18nCore$1.ERROR_DRM_HDCP)],"output-downscaled":[10,compile(i18nCore$1.ERROR_DRM_HDCP)],"status-pending":null,"internal-error":[17,compile(i18nCore$1.ERROR_DRM_KEY_INTERNAL)],usable:null,expired:[15,compile(i18nCore$1.ERROR_DRM_KEY_EXPIRED)],released:[16,compile(i18nCore$1.ERROR_DRM_KEY_RELEASED)]};this.mediaKeyDescriptor.mediaKeySession=e.createSession(),this.mediaKeyDescriptor.mediaKeySession.onkeystatuseschange=function(e){var r,n,i;null===(i=null===(n=null===(r=e.target)||void 0===r?void 0:r.keyStatuses)||void 0===n?void 0:n.forEach)||void 0===i||i.call(n,(function(e,r){if(t.mediaKeyDescriptor&&o[e]){var n=o[e],i=n[0],a=n[1];t.emit(ERR,{code:i,message:a})}}))},this.mediaKeyDescriptor.mediaKeySession.onmessage=function(e){t.onMediaKeySessionMessage(t.mediaKeyDescriptor.mediaKeySession,e)},this.media.setMediaKeys(e).then((function(){t.logger.log("media keys set")})).catch((function(e){t.logger.error("media keys set failed",e),t.emit(ERR,{code:18,message:compile(i18nCore$1.ERROR_DRM_MEDIA_KEYS_SET_FAILED)})}))}},t.prototype.onMediaKeySessionMessage=function(e,t){var o=this;this.logger.log("received media key session message",t),this.requestLicense(t,(function(t){var r=t.data;if(o.config.licenseResponseSetup&&(r=o.config.licenseResponseSetup(r)||r),r){var n=e.update(r);null==n||n.catch((function(e){o.emit(ERR,{code:14,message:compile(i18nCore$1.ERROR_DRM_KEY_SESSION_UPDATE_FAILED)})}))}else o.emit(ERR,{code:14,message:compile(i18nCore$1.ERROR_DRM_KEY_SESSION_UPDATE_FAILED)})}))},t.prototype.createWidevineLicenseRequest=function(e,t){var o=this,r={method:"POST",responseType:"arraybuffer",body:e.message,url:this.config.licenseUrl,headers:{"Content-Type":"application/x-www-form-urlencoded"}};this.config.licenseRequestSetup&&(r=this.config.licenseRequestSetup(r)),netTool.xhr(r).then((function(e){t(e)})).catch((function(e){var t=e||{},r=t.code,n=t.message;o.emit(ERR,{code:11,detail:r,message:compile(i18nConfig.core.ERROR_DRM_LICENSE_REQUEST_FAILED,"[code: ".concat(r,"] ").concat(n))})}))},t.prototype.createPlayReadyLicenseRequest=function(e,t){var o=this,r=builtMessageXML(e.message),n={method:"POST",responseType:"arraybuffer",body:getChallenge(r),url:this.config.licenseUrl,headers:builtHeadersFromXML(r)};this.config.licenseRequestSetup&&(n=this.config.licenseRequestSetup(n)),netTool.xhr(n).then((function(e){t(e)})).catch((function(e){o.logger.warn("failed to get license",e),o.emit(ERR,{code:11,message:compile(i18nCore$1.ERROR_DRM_LICENSE_REQUEST_FAILED,null==e?void 0:e.message)})}))},t.prototype.createFPSLicenseRequest=function(e,t){var o=this,r=e.message,n=encodeURIComponent(stringTool.arrayBufferToBase64(r)),i={method:"POST",responseType:"arraybuffer",body:"spc=".concat(n,"&assetId=").concat(this.mediaKeyDescriptor.assetID),url:this.config.licenseUrl,headers:{"Content-Type":"application/x-www-form-urlencoded"}};this.config.licenseRequestSetup&&(i=this.config.licenseRequestSetup(i)),netTool.xhr(i).then((function(e){t(e)})).catch((function(e){o.logger.warn("license request error",e),o.emit(ERR,{code:11,message:compile(i18nCore$1.LICENSE_REQUEST_FAILED)})}))},t.prototype.requestFPSMediaKeys=function(){var e=new window.WebKitMediaKeys(KeySystems.FairPlayWebKit);return this.media.webkitSetMediaKeys(e),this.mediaKeyDescriptor={mediaKeySession:null,initData:null,hasInitialized:!1,mediaKeySystemAccess:null,mediaKeys:this.media.webkitKeys},Promise.resolve(e)},t.prototype.createFPSWebkitSession=function(e,t){if(e){var o=e.createSession("video/mp4",t);if(o)return o;this.emit(ERR,{code:2,message:compile(i18nCore$1.ERROR_DRM_KEY_SESSION_CREATION_FAILED)})}else this.emit(ERR,{code:8,message:compile(i18nCore$1.ERROR_DRM_FPS_SET_KEY_FAILED)})},t.prototype.cleanupFPSSession=function(e){return e?(this.media.webkitSetMediaKeys(null),e.onwebkitkeyadded=null,e.onwebkitkeyerror=null,e.onwebkitkeymessage=null,Promise.resolve()):Promise.resolve()},t.serverCertificate={},t}(s),__awaiter$6=window&&window.__awaiter||function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},__generator$6=window&&window.__generator||function(e,t){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},testVideoElement=document.createElement("video"),wasmDetectionCache=null,videoTool={getBuffered:function(e){for(var t=[],o=e.buffered.length,r=0;r<o;r++)t.push({start:e.buffered.start(r),end:e.buffered.end(r)});return t},checkTimeInBuffer:function(e,t){for(var o=!1,r=t.length,n=0;n<r;n++){var i=t[n].start,a=t[n].end;if(e>=i&&e<=a){o=!0;break}}return o},clear:function(e){e&&(e instanceof HTMLVideoElement?(e.removeAttribute("src"),e.srcObject=null):(e.srcConfig=null,e.src=null),e.load())},destroyElement:function(e){var t;e&&(null===(t=e.destroy)||void 0===t||t.call(e),videoTool.clear(e),videoTool.removeElement(e,null))},captureVideo:function(e,t){var o=t.dx,r=t.dy,n=t.dw,i=t.dh,a=e.videoWidth,s=e.videoHeight,l=document.createElement("canvas");l.width=a,l.height=s;var c=l.getContext("2d");return c.drawImage(e,0,0,a,s),{captureHeight:i,captureWidth:n,captureX:o,captureY:r,playtime:e.currentTime,data:c.getImageData(o,r,n,i)}},resizeElement:function(e,t){var o;if(t&&e)if(e instanceof HTMLElement)domTool.css(e,t);else{var r=t.width,n=t.height;"number"==typeof r&&"number"==typeof n&&(null===(o=e.resize)||void 0===o||o.call(e,r,n))}},appendElement:function(e,t){var o;e instanceof HTMLElement?domTool.append(t,e):null===(o=e.appendToParent)||void 0===o||o.call(e,t)},removeElement:function(e,t){var o;e instanceof HTMLElement?(null==e?void 0:e.parentNode)&&e.remove():null===(o=e.removeFromParent)||void 0===o||o.call(e,t)},setElementFitType:function(e,t){e&&e instanceof HTMLElement&&domTool.css(e,{"object-fit":t})},getDefaultMaxBufferTime:function(){var e=navigator.connection;return e&&"wifi"===e.type?180:e&&"4g"===e.type?120:180},isAutoPlayBlockedMessage:function(e){return e&&/interact|not allowed|user gesture/.test(e)},supportSameTimePlay:function(){return(!uaTool.browser.x5||-1===["45031","45032"].indexOf("".concat(uaTool.browser.x5.version)))&&(!(uaTool.browser.mqqbrowser&&!(uaTool.browser.qqlive||uaTool.browser.wechat||uaTool.browser.mqq))&&!(uaTool.os.ios&&uaTool.os.version&&comTool.compareVersion(uaTool.os.version,"11.0")<0))},cannotDetectAutoPlayBlock:function(){return uaTool.browser.chrome&&comTool.compareVersion(uaTool.browser.chrome.version,"66.0")<0},supportMediaFragmentsURISpec:function(e){return void 0!==e?!!e:-1===window.navigator.userAgent.indexOf("jsdom")&&(!uaTool.mobile||!!uaTool.os.ios)},getVideoPlaybackQuality:function(e){var t=0,o=0;if(null==e?void 0:e.getVideoPlaybackQuality){var r=e.getVideoPlaybackQuality();o=r.droppedVideoFrames||0,t=r.totalVideoFrames||0}else e&&e.webkitDecodedFrameCount&&(t=e.webkitDecodedFrameCount,o=e.webkitDroppedFrameCount);return{totalVideoFrames:t,droppedVideoFrames:o}},supportMSE:function(){var e=videoTool.getMediaSource();if(!e)return!1;var t=window.SourceBuffer||window.WebKitSourceBuffer,o=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),r=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove;return!!o&&!!r},supportVideoFormat:function(){var e={mp4:"video/mp4",mov:"video/mp4",hls:"application/x-mpegURL",avi:"video/x-msvideo",mpeg:"video/mpeg",webm:"video/webm",ogg:"video/ogg"},t=[];return Object.keys(e).forEach((function(o){var r=e[o],n=testVideoElement.canPlayType(r);-1!==["maybe","probably"].indexOf(n)&&t.push(o)})),t},supportAV1:function(){return videoTool.isMediaSourceTypeSupported("video/mp4;codecs=av01.0.12M.08")},supportHevc:function(){return videoTool.isMediaSourceTypeSupported('video/mp4;codecs="hev1.1.6.L120.90"')},supportHEVCMain10:function(){return videoTool.isMediaSourceTypeSupported('video/mp4;codecs="hev1.2.4.L120.90"')},isVideoCanPlayType:function(e){return testVideoElement.canPlayType(e)},isMediaSourceTypeSupported:function(e){var t;try{return null===(t=videoTool.getMediaSource())||void 0===t?void 0:t.isTypeSupported(e)}catch(e){return!1}},isMediaCapabilitiesTypeSupported:function(e){return __awaiter$6(this,void 0,void 0,(function(){var t,o,r,n,i,a,s,l,c,p,d,u;return __generator$6(this,(function(A){switch(A.label){case 0:t=e.type,o=e.mimeType,r=e.resolution,n=void 0===r?"860x480":r,i=e.bitrate,a=void 0===i?800:i,s=e.framerate,l=void 0===s?30:s,A.label=1;case 1:switch(A.trys.push([1,3,,4]),c={type:"media-source"},t){case"audio":c.audio={contentType:o};break;case"audio-spatial":c.audio={contentType:o,spatialRendering:!0};break;case"video":p=n.toLowerCase().split("x"),d=p[0],u=p[1],c.video={contentType:o,bitrate:a,framerate:l,height:+d,width:+u}}return[4,navigator.mediaCapabilities.decodingInfo(c)];case 2:return[2,A.sent().supported];case 3:return A.sent(),[2,!1];case 4:return[2]}}))}))},isHDRSupported:function(){try{return window.matchMedia("(dynamic-range: high)").matches?HDR_CAPABILITY.SUPPORTED:window.matchMedia("(color-gamut: p3)").matches?HDR_CAPABILITY.WCG_DISPLAY_BUT_NO_HDR:HDR_CAPABILITY.NOT_SUPPORTED}catch(e){return HDR_CAPABILITY.NOT_SUPPORTED}},isDolbyVisionSupported:function(){return videoTool.isMediaSourceTypeSupported('video/mp4; codecs="dvhe"')},isDolbyAtomsSupported:function(e){return videoTool.isMediaSourceTypeSupported('audio/mp4; codecs="ec-3"')},getMediaSource:function(){if("undefined"!=typeof window)return window.MediaSource||window.WebKitMediaSource},isEncryptionSupported:function(e,t){return __awaiter$6(this,void 0,void 0,(function(){var o,r;return __generator$6(this,(function(n){switch(n.label){case 0:if(o=t||getSupportedKeySystemConfig(e),r=[window.MediaKeys,window.WebKitMediaKeys].some((function(e){return e})),!r)return[2,!1];if(!(void 0!==window.navigator.requestMediaKeySystemAccess))return[2,!1];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,window.navigator.requestMediaKeySystemAccess(e,[o])];case 2:return[2,!!n.sent()];case 3:return n.sent(),[2,!1];case 4:return[2]}}))}))},supportWidevine:function(){return __awaiter$6(this,void 0,void 0,(function(){return __generator$6(this,(function(e){return[2,videoTool.isEncryptionSupported(KeySystems.Widevine)]}))}))},supportFairplay:function(){var e=KeySystems.FairPlayWebKit;return!!window.WebKitMediaKeys&&window.WebKitMediaKeys.isTypeSupported(e,"video/mp4")},supportWebGL:function(){var e,t=document.createElement("canvas");try{e=t.getContext("webgl")}catch(e){return!1}return!!e},isWebRTCSupported:function(){var e=Boolean(uaTool.os.ios),t=Boolean(uaTool.browser.uc),o=Boolean(uaTool.browser.safari);return!t&&(!(e&&o&&comTool.compareVersion(uaTool.os.version,"11.1.2")<0)&&("RTCPeerConnection"in window||"webkitRTCPeerConnection"in window))},isPositionBuffered:function(e,t){for(var o=e.buffered,r=t||e.currentTime,n=0;n<o.length;n++)if(r>=o.start(n)&&r<=o.end(n))return!0;return!1},getNextBufferedStart:function(e,t){for(var o=e.buffered,r=t||e.currentTime,n=0;n<o.length;n++)if(o.start(n)>r)return o.start(n);return-1},getLastBufferedEnd:function(e,t){for(var o=e.buffered,r=t||e.currentTime,n=o.length-1;n>=0;n--)if(o.end(n)<r)return o.end(n);return-1},isHardwareAccelerated:function(){try{var e=document.createElement("canvas"),t={alpha:!0,antialias:!1,depth:!0,failIfMajorPerformanceCaveat:!0,stencil:!0};return!(!e.getContext("webgl",t)&&!e.getContext("experimental-webgl",t))}catch(e){return!1}},isWasmSupported:function(){if(null!==wasmDetectionCache)return wasmDetectionCache;if(!window.WebAssembly)return wasmDetectionCache=!1,!1;try{var e=Uint8Array.from([0,97,115,109,1,0,0,0]),t=new WebAssembly.Module(e),o=new WebAssembly.Instance(t);wasmDetectionCache=o instanceof WebAssembly.Instance}catch(e){wasmDetectionCache=!1}finally{return wasmDetectionCache}},isWasmKernelSupported:function(){return this.isWasmSupported()&&!!window.customElements&&comTool.supportES6()&&videoTool.supportWebGL()},commonErrorParse:function(e){if(e instanceof ErrorBase)return e;if(e){var t=e.code,o=e.message;return PlayerError.NativeError({code:0,detail:t,message:o||compile(i18nConfig.core.ERROR_MSG_UNKNOWN),debugMessage:o})}return PlayerError.NativeError({code:0,message:compile(i18nConfig.core.ERROR_MSG_UNKNOWN)})},getVideoError:function(e){void 0===e&&(e=3);var t={1:1,2:2,3:102,4:103},o={1:compile(i18nConfig.core.ERROR_MEDIA_ERR_ABORTED),2:compile(i18nConfig.core.ERROR_MEDIA_ERR_NETWORK),3:compile(i18nConfig.core.ERROR_MEDIA_ERR_DECODE),4:compile(i18nConfig.core.ERROR_MEDIA_ERR_SRC_NOT_SUPPORTED)},r=+e;if(MediaElementNetworkErrorCode.includes(r))return PlayerError.NetworkError({code:t[r],fatal:!1,message:o[r]});if(MediaElementPlaybackErrorCode.includes(r)){var n=0;return n|=+!videoTool.isVideoCanPlayType('video/mp4; codecs="avc1.42E01E"')<<1,n|=+!videoTool.isHardwareAccelerated(),PlayerError.NativeError({code:t[r],fatal:!1,detail:n,message:o[r]})}}},stringTool={arrayToString:function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))},base64ToUint8Array:function(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),o=window.atob(t),r=new Uint8Array(o.length),n=0;n<o.length;++n)r[n]=o.charCodeAt(n);return r},arrayBufferToBase64:function(e){for(var t="",o=new Uint8Array(e),r=o.byteLength,n=0;n<r;n++)t+=String.fromCharCode(o[n]);return window.btoa(t)},stringToArray:function(e){for(var t=e.length,o=new ArrayBuffer(2*t),r=new Uint16Array(o),n=0;n<t;n++)r[n]=e.charCodeAt(n);return r}},_a$9,LoopMode;!function(e){e[e.Timer=0]="Timer",e[e.RAF=1]="RAF"}(LoopMode||(LoopMode={}));var LoopRunnerPair=(_a$9={},_a$9[LoopMode.RAF]=[window.requestAnimationFrame.bind(window),window.cancelAnimationFrame.bind(window)],_a$9[LoopMode.Timer]=[window.setTimeout.bind(window),window.clearTimeout.bind(window)],_a$9),TaskLoop=function(){function e(e,t){this.running=!1,this.callback=e,t===LoopMode.RAF&&LoopRunnerPair[t][0]?this.mode=LoopMode.RAF:this.mode=LoopMode.Timer,this.runner=LoopRunnerPair[this.mode][0]}return e.prototype.start=function(e){var t=this;if(void 0===e&&(e=0),!this.running){this.running=!0;var o=function(){var r;t.running&&(null===(r=t.callback)||void 0===r||r.call(t),t.loopId=t.runner(o,e))};this.loopId=this.runner(o,e)}},e.prototype.stop=function(){this.running&&(this.running=!1,this.loopId&&LoopRunnerPair[this.mode][1](this.loopId),this.loopId=null)},e.prototype.destroy=function(){this.stop(),this.callback=null,this.loopId=null},e}(),ResizeObserverPolyfilled=function(){function e(e){var t=this;this.targetOptionMap=new Map,this.pollTimer=null,this.lastRectMap=new Map,this.pollTimeout=DEFAULT_INTERVAL_TIMEOUT,this.onPollTimeout=function(){var e=[];t.removeDisconnectedElements(),t.targetOptionMap.forEach((function(o,r){var n=r.getBoundingClientRect(),i=t.lastRectMap.get(r);t.diffRect(i,n,null==o?void 0:o.box)&&e.push(t.assembleEntries(r,n)),t.lastRectMap.set(r,n)})),e.length&&t.callback(e,t)},this.callback=e}return e.prototype.disconnect=function(){this.targetOptionMap.clear(),this.setPoll(!1)},e.prototype.observe=function(e,t){this.targetOptionMap.set(e,t),this.setPoll(!0)},e.prototype.unobserve=function(e){this.targetOptionMap.delete(e)},e.prototype.setPoll=function(e){void 0===e&&(e=!0),this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null),e&&(this.pollTimer=setInterval(this.onPollTimeout,this.pollTimeout))},e.prototype.removeDisconnectedElements=function(){var e=this;this.targetOptionMap.forEach((function(t,o){o.isConnected||(e.targetOptionMap.delete(o),e.lastRectMap.delete(o))}))},e.prototype.assembleEntries=function(e,t){return{target:e,borderBoxSize:[],contentBoxSize:[],contentRect:t,devicePixelContentBoxSize:[]}},e.prototype.diffRect=function(e,t,o){return void 0===o&&(o="content-box"),!e||DIFF_ATTR_RULE_MAP[o].some((function(o){return e[o]!==t[o]}))},e}(),DEFAULT_INTERVAL_TIMEOUT=200,DIFF_ATTR_RULE_MAP={"border-box":["height","width","left","right","top","bottom"],"content-box":["height","width"],"device-pixel-content-box":["height","width"]},ResizeObserver=window.ResizeObserver||ResizeObserverPolyfilled,defaultPlayerConfig={type:exports.PLAY_MODE.VOD,interruptPlayNextMinTime:1,backupUrlsMaxRetryCount:5,maxPreloadTimeout:3e4,maxBufferingTimeout:3e4,maxStateStalledTime:3e4,maxPlaytimeStalledTime:1e4,isPlayList:!1,preloadType:exports.PRELOAD_TYPE.AUTO_LOAD,maxVideoNodeCount:1,minFillBlackBorder:10,minFragmentCountForSmoothLevelSwitching:3,ignoreEndedWhenLive:!0},__assign$a=window&&window.__assign||function(){return __assign$a=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},__assign$a.apply(this,arguments)};function createConfig(e){var t,o,r;return __assign$a(__assign$a(__assign$a({instanceId:comTool.createGUID()},defaultPlayerConfig),e),{maxVideoNodeCount:null!==(r=null!==(t=e.maxVideoNodeCount)&&void 0!==t?t:null===(o=e.originKernelConfig)||void 0===o?void 0:o.maxVideoNodeCount)&&void 0!==r?r:defaultPlayerConfig.maxVideoNodeCount})}function convertVideoElementConfig(e){var t={position:"absolute",width:"100%",height:"100%",top:0,left:0,objectFit:"contain"},o=Object.keys(t),r={playsinline:{playsinline:"isiPhoneShowPlaysinline","webkit-playsinline":"isiPhoneShowPlaysinline"},airplay:{airplay:"allow","x-webkit-airplay":"allow"},crossorigin:{crossOrigin:"anonymous"},"h5-page":{"x5-video-player-type":"h5-page"}},n={playsinline:!0,"h5-page":!0};Object.keys(e).forEach((function(t){-1===o.indexOf(t)&&(n[t]=e[t])}));var i=Object.keys(n).reduce((function(e,t){return r[t]&&"boolean"==typeof n[t]?e=__assign$a(__assign$a({},e),n[t]?r[t]:{}):e[t]=n[t],e}),{}),a=o.reduce((function(o,r){var n;return o[r]=null!==(n=e[r])&&void 0!==n?n:t[r],o}),{});return{attrOpts:i,cssOpts:a}}var __assign$9=window&&window.__assign||function(){return __assign$9=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},__assign$9.apply(this,arguments)},CHANNEL_MAP;!function(e){e[e.npm=0]="npm",e[e.cdn=1]="cdn"}(CHANNEL_MAP||(CHANNEL_MAP={}));var ReferenceReport=function(){function e(){this.isCollected=!1,this.attaid="05700050920",this.token="3619167286",this.timeout=3e3}return e.getReporter=function(){return this.reporter||(this.reporter=new e),this.reporter},e.prototype.collectUsage=function(e,t,o){if(void 0===e&&(e=0),void 0===t&&(t=CHANNEL),void 0===o&&(o=""),!this.isCollected){this.isCollected=!0;var r=urlTool.getTopFrameUrl(),n=null==r?void 0:r.split("?")[0],i=urlTool.getDomainOfURL(r),a={attaid:this.attaid,token:this.token,topUrl:"".concat(encodeURIComponent(r)),pageUrl:"".concat(encodeURIComponent(n)),domain:"".concat(encodeURIComponent(i)),channel:"".concat(CHANNEL_MAP[t]||0),from:"".concat(e),version:VERSION$3,platform:o,kernel:Object.keys(KernelFactory$1.kernelMap).join("$"),_dc:"".concat(Math.random())};this.send(a)}},e.prototype.send=function(e){setTimeout((function(){(new Image).src="https://h.trace.qq.com/kv?".concat(urlTool.object2string(__assign$9({},e),"&"))}),this.timeout)},e}(),AutoPlayPolicy=function(){function e(e,t){this._logger=new Logger(t.instanceId,"AutoPlayPolicy"),this._videoElement=e}return e.prototype.userTrigger=function(){var e,t=this;this._triggerDefer=new SimpleDefer,this._logger.log("userTrigger(), start");var o=this._videoElement.play();if(this._videoElement.pause(),0===this._videoElement.readyState)o&&o.catch((function(o){e>0&&(clearTimeout(e),e=0),t._logger.log("userTrigger(), catch: ",o.name,o.message),videoTool.isAutoPlayBlockedMessage(o.message)?t._triggerDefer.reject(o):(t._logger.log("userTrigger() over, catched."),t._triggerDefer.resolve())})),e=window.setTimeout((function(){t._logger.log("userTrigger() over, timeout."),t._triggerDefer.resolve()}),300);else{this._logger.log("userTrigger() over, sync.");var r=uaTool.browser.safari&&!uaTool.mobile?400:0;window.setTimeout((function(){t._triggerDefer.resolve()}),r)}return this._triggerDefer.promise},e.prototype.destroy=function(){this._videoElement=null},e}(),__extends$a=window&&window.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),__assign$8=window&&window.__assign||function(){return __assign$8=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},__assign$8.apply(this,arguments)},__decorate$8=window&&window.__decorate||function(e,t,o,r){var n,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,o,a):n(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},__metadata$8=window&&window.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter$5=window&&window.__awaiter||function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},__generator$5=window&&window.__generator||function(e,t){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},logMethodCall$9=logMethodCallDecoratorCreator("KernelProxy"),loadKernelDeferMap={},KernelProxy=function(e){function t(t){var o=e.call(this)||this;return o.volumeInner=1,o.videoElementsInner=[],o.addedEvts=[],o.isDestroyed=!1,o.playerConfig=createConfig(t),o.logger=new Logger(o.playerConfig.instanceId,"KernelProxy"),t.logLevel>PLAYER_LOG_LEVEL.NONE&&enableConsoleOutput(),o.playerConfig.videoElements||(o.playerConfig.videoElements=o.createVideoElements()),o.createVideoElementsContainer(),o.kernelEvtFuncs=o.kernelEvtHandler.bind(o),o.playerConfig.isPrivateDeployment||ReferenceReport.getReporter().collectUsage(),o}return __extends$a(t,e),Object.defineProperty(t.prototype,"config",{get:function(){var e;return(null===(e=this.kernel)||void 0===e?void 0:e.config)||this.playerConfig},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"useWorker",{get:function(){var e;return!!(null===(e=this.kernel)||void 0===e?void 0:e.useWorker)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"kernelName",{get:function(){var e;return null===(e=this.kernel)||void 0===e?void 0:e.kernelName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"videoElements",{get:function(){var e;return(null===(e=this.kernel)||void 0===e?void 0:e.videoElements)||[]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentVideoElement",{get:function(){var e;return null===(e=this.kernel)||void 0===e?void 0:e.currentVideoElement},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportPreload",{get:function(){var e;return!!(null===(e=this.kernel)||void 0===e?void 0:e.supportPreload)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){var e;return(null===(e=this.kernel)||void 0===e?void 0:e.duration)||0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playtime",{get:function(){var e;return(null===(e=this.kernel)||void 0===e?void 0:e.playtime)||0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"videoInfos",{get:function(){var e;return(null===(e=this.kernel)||void 0===e?void 0:e.videoInfos)||[]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"preloadVideoInfos",{get:function(){var e;return null===(e=this.kernel)||void 0===e?void 0:e.preloadVideoInfos},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentVideoInfo",{get:function(){var e;return null===(e=this.kernel)||void 0===e?void 0:e.currentVideoInfo},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentVideoInfoIdx",{get:function(){var e;return(null===(e=this.kernel)||void 0===e?void 0:e.currentVideoInfoIdx)||0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalVideoInfoCount",{get:function(){var e;return(null===(e=this.kernel)||void 0===e?void 0:e.totalVideoInfoCount)||0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportPlaybackRate",{get:function(){var e;return!!(null===(e=this.kernel)||void 0===e?void 0:e.supportPlaybackRate)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"played",{get:function(){var e;return!!(null===(e=this.kernel)||void 0===e?void 0:e.played)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){var e;return(null===(e=this.kernel)||void 0===e?void 0:e.state)||exports.VIDEO_STATE.IDLE},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"videoSize",{get:function(){var e;return(null===(e=this.kernel)||void 0===e?void 0:e.videoSize)||{width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"videoBuffered",{get:function(){var e;return(null===(e=this.kernel)||void 0===e?void 0:e.videoBuffered)||[]},enumerable:!1,configurable:!0}),t.prototype.captureVideo=function(e,t,o,r,n){var i;return null===(i=this.kernel)||void 0===i?void 0:i.captureVideo(e,t,o,r,n)},t.prototype.log=function(){for(var e,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];null===(e=this.logger)||void 0===e||e.log.apply(e,t)},t.prototype.warn=function(){for(var e,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];null===(e=this.logger)||void 0===e||e.warn.apply(e,t)},t.prototype.error=function(){for(var e,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];null===(e=this.logger)||void 0===e||e.error.apply(e,t)},t.prototype.hasAppended=function(e){var t;return!!(null===(t=this.kernel)||void 0===t?void 0:t.hasAppended(e))},t.prototype.hasPreloaded=function(e){var t;return!!(null===(t=this.kernel)||void 0===t?void 0:t.hasPreloaded(e))},Object.defineProperty(t.prototype,"volume",{get:function(){var e;return(null===(e=this.kernel)||void 0===e?void 0:e.volume)||this.volumeInner},set:function(e){this.volumeInner=e,this.kernel?this.kernel.volume=e:this.emit(exports.PLAY_EVENT.VOLUME_CHANGE,{volume:e})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playbackRate",{get:function(){var e;return(null===(e=this.kernel)||void 0===e?void 0:e.playbackRate)||this.playbackRateInner},set:function(e){this.playbackRateInner=e,this.kernel?this.kernel.playbackRate=e:this.emit(exports.PLAY_EVENT.RATE_CHANGE,{playbackRate:e})},enumerable:!1,configurable:!0}),t.prototype.resizeVideoElements=function(e){var t;null===(t=this.kernel)||void 0===t||t.resizeVideoElements(e)},t.prototype.resize=function(e){var t;null===(t=this.kernel)||void 0===t||t.resize(e)},t.prototype.seek=function(e){var t;return null===(t=this.kernel)||void 0===t?void 0:t.seek(e)},t.prototype.play=function(e,t){var o;return __awaiter$5(this,void 0,void 0,(function(){return __generator$5(this,(function(r){switch(r.label){case 0:return[4,this.checkConfigBeforeLoad(e,t)];case 1:return r.sent(),[2,null===(o=this.kernel)||void 0===o?void 0:o.play(e,t)]}}))}))},t.prototype.load=function(e,t){var o;return __awaiter$5(this,void 0,void 0,(function(){return __generator$5(this,(function(r){switch(r.label){case 0:return[4,this.checkConfigBeforeLoad(e,t)];case 1:return r.sent(),[2,null===(o=this.kernel)||void 0===o?void 0:o.load(e,t)]}}))}))},t.prototype.playNext=function(e){var t;null===(t=this.kernel)||void 0===t||t.playNext(e)},t.prototype.pause=function(e){var t;null===(t=this.kernel)||void 0===t||t.pause(e)},t.prototype.stop=function(e){var t;null===(t=this.kernel)||void 0===t||t.stop(e)},t.prototype.appendNext=function(e){var t;return!!(null===(t=this.kernel)||void 0===t?void 0:t.appendNext(e))},t.prototype.preloadNext=function(){for(var e,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];return null===(e=this.kernel)||void 0===e?void 0:e.preloadNext.apply(e,t)},t.prototype.clearAllPreload=function(){var e;null===(e=this.kernel)||void 0===e||e.clearAllPreload()},t.prototype.triggerAutoplay=function(){var e,t=this;if(!this.kernel){this.logger.log("triggerAutoplay(), start");var o=this.videoElementsInner.map((function(e){return new AutoPlayPolicy(e,{instanceId:t.playerConfig.instanceId}).userTrigger()}));return Promise.all(o)}return null===(e=this.kernel)||void 0===e?void 0:e.triggerAutoplay()},t.prototype.setAudioTrack=function(e){return this.kernel?this.kernel.setAudioTrack(e):Promise.reject(new Error(AUDIO_TRACK_ERROR_MSG.KERNEL_NOT_EXISTS))},t.prototype.getAudioTrackList=function(){return this.currentVideoInfo?this.currentVideoInfo.audioTracks:[]},t.prototype.getCurrentAudioTrack=function(){return this.currentVideoInfo?this.currentVideoInfo.currentAudioTrack:NaN},t.prototype.setLevel=function(e,t,o){return __awaiter$5(this,void 0,void 0,(function(){var r,n,i,a,s;return __generator$5(this,(function(l){switch(l.label){case 0:return this.kernel?(r="string"==typeof e?__assign$8(__assign$8({},o),{url:e}):e,n=this.currentVideoInfo,[4,this.checkWhetherNeedToSwitchKernel(r,null,!1)]):[2,Promise.reject(compile(i18nConfig.core.ERROR_KERNEL_NOT_FOUND))];case 1:return i=l.sent(),a=i.isKernelSwitched,(null==(s=i.error)?void 0:s.message)?[2,Promise.reject(null==s?void 0:s.message)]:a?[2,this.setLevelWhenKernelSwitched(__assign$8(__assign$8(__assign$8({},r),{backupUrls:t}),o),n)]:"string"==typeof e?[2,this.kernel.setLevel(e,t,o)]:[2,this.kernel.setLevel(e)]}}))}))},t.prototype.on=function(t,o,r){return e.prototype.on.call(this,t,o,r),this.proxyEvent(t),this},t.prototype.once=function(t,o,r){return e.prototype.once.call(this,t,o,r),this.proxyEvent(t,!0),this},t.prototype.destroy=function(){var e;this.videoElementsInner&&(this.videoElementsInner.forEach((function(e){videoTool.destroyElement(e)})),this.videoElementsInner=null),(null===(e=this.videoElementsContainer)||void 0===e?void 0:e.parentNode)&&this.videoElementsContainer.remove(),this.destroyKernel(),this.removeAllListeners(),this.kernelEvtFuncs=null,this.playerConfig=null,this.isDestroyed=!0},t.prototype.checkWhetherNeedToSwitchKernel=function(e,t,o){return void 0===o&&(o=!0),__awaiter$5(this,void 0,void 0,(function(){var r,n,i,a;return __generator$5(this,(function(s){switch(s.label){case 0:return r=e instanceof Array?e[0]:e,n=(null==t?void 0:t.kernelName)||r.kernelName,"string"!=typeof(i=KernelFactory$1.selectKernel(e,n,this.playerConfig.kernelPriority))?[2,{isKernelSwitched:!1,error:i}]:(this.logger.log("kernel select:",i),!i||KernelFactory$1.kernelMap[i]?[3,2]:[4,this.loadKernel(i)]);case 1:s.sent(),s.label=2;case 2:return a=KernelFactory$1.kernelMap[i]?i:exports.KERNEL_NAME.ORIGIN,this.kernel&&this.kernel.kernelName!==a&&(this.kernel.played&&o&&this.emit(exports.PLAY_EVENT.STOPED,{videoInfo:this.kernel.currentVideoInfo,endState:exports.END_STATE.INTERRUPT}),this.destroyKernel()),this.kernel?[3,4]:[4,this.createKernel(a)];case 3:return s.sent(),[2,{isKernelSwitched:!0}];case 4:return[2,{isKernelSwitched:!1}]}}))}))},t.prototype.loadKernel=function(e,t){return void 0===t&&(t=3),__awaiter$5(this,void 0,void 0,(function(){var o,r,n,i;return __generator$5(this,(function(a){switch(a.label){case 0:return this.config.isPrivateDeployment?[2,!1]:(o=getKernelCdnPath(e,this.playerConfig.autoLoadKernelVerMap))?loadKernelDeferMap[e]?(this.logger.log("auto download kernel [".concat(o,"] has been started!")),[4,loadKernelDeferMap[e].promise]):[3,2]:[2,!1];case 1:return r=a.sent(),this.logger.log("auto download kernel [".concat(o,"] succ=").concat(r)),[2,r];case 2:loadKernelDeferMap[e]=new SimpleDefer,this.logger.log("auto download kernel [".concat(o,"]")),n=!1,i=0,a.label=3;case 3:if(!(i<t))return[3,9];a.label=4;case 4:return a.trys.push([4,6,,7]),[4,domTool.loadScript("".concat(CDN_PATH_PREFIX+o,"?max_age=86400"),null,1e4)];case 5:return a.sent(),this.isDestroyed?[2,new Promise((function(){}))]:(this.logger.log("auto download kernel [".concat(o,"] succ=true")),n=!0,[3,7]);case 6:return a.sent(),n=!1,this.logger.error("auto download kernel [".concat(o,"] failed")),[3,7];case 7:if(n)return[3,9];a.label=8;case 8:return i++,[3,3];case 9:return loadKernelDeferMap[e].resolve(n),[2,n]}}))}))},t.prototype.createKernel=function(e){this.kernel=KernelFactory$1.createKernel(e,this.playerConfig),void 0!==this.volumeInner&&(this.kernel.volume=this.volumeInner),void 0!==this.playbackRateInner&&(this.kernel.playbackRate=this.playbackRateInner),this.setKernelEvts(!0)},t.prototype.createVideoElements=function(){for(var e=this.playerConfig,t=e.instanceId,o=e.videoElementConfig,r=e.maxVideoNodeCount,n=convertVideoElementConfig(__assign$8(__assign$8({preload:this.playerConfig.preloadType===exports.PRELOAD_TYPE.META_DATA?"metadata":"auto"},o),{playerid:t})),i=0;i<r;i++){var a=domTool.createVideoDom(n);this.videoElementsInner.push(a)}return this.videoElementsInner},t.prototype.createVideoElementsContainer=function(){var e=this.playerConfig.container,t=domTool.getElementFromConfig(e);this.videoElementsContainer=domTool.createDom('\n      <div class="'.concat(VIDEO_CONTAINER_CLASS,'" style="position:absolute;left:0;top:0;width:100%;height:100%;z-index:0;">\n      </div>\n    ').trim()),domTool.append(t,this.videoElementsContainer)},t.prototype.setKernelEvts=function(e){var t=this;if(this.kernel){e&&this.setKernelEvts(!1);var o=e?this.kernel.on:this.kernel.off;this.addedEvts.forEach((function(e){o.apply(t.kernel,[e,t.kernelEvtFuncs])}))}},t.prototype.kernelEvtHandler=function(e){this.setLevelWhenKernelSwitchedDefer?this.checkSetLevelOverWhenKernelSwitched(e)&&(this.setLevelWhenKernelSwitchedDefer=null):this.emit(e.type,e.data)},t.prototype.setLevelWhenKernelSwitched=function(e,t){return this.emit(exports.PLAY_EVENT.SETLEVEL_START,{videoInfo:t,mode:SET_LEVEL_MODE.HARD}),this.kernel.play(e,{startTime:(null==t?void 0:t.playtime)||0}),this.setLevelWhenKernelSwitchedDefer=new SimpleDefer,this.setLevelWhenKernelSwitchedDefer.promise},t.prototype.checkSetLevelOverWhenKernelSwitched=function(e){var t;return e.type===exports.PLAY_EVENT.STATE_CHANGE&&e.data.new===exports.VIDEO_STATE.PLAYING?(this.setLevelWhenKernelSwitchedDefer.resolve(),this.emit(exports.PLAY_EVENT.SETLEVEL_OVER,{videoInfo:this.currentVideoInfo}),!0):e.type===exports.PLAY_EVENT.ERROR&&(this.setLevelWhenKernelSwitchedDefer.reject(null===(t=e.data.videoInfo)||void 0===t?void 0:t.error),this.emit(exports.PLAY_EVENT.SETLEVEL_OVER,{videoInfo:this.currentVideoInfo,fail:!0}),!0)},t.prototype.proxyEvent=function(e,t){void 0===t&&(t=!1),this.addedEvts.includes(e)||(this.addedEvts.push(e),this.kernel&&(t?this.kernel.once(e,this.kernelEvtFuncs):this.kernel.on(e,this.kernelEvtFuncs)))},t.prototype.checkConfigBeforeLoad=function(e,t){return __awaiter$5(this,void 0,void 0,(function(){var o;return __generator$5(this,(function(r){switch(r.label){case 0:return e?[4,this.checkWhetherNeedToSwitchKernel(e,t)]:[2];case 1:if(o=r.sent().error)throw this.emit(exports.PLAY_EVENT.ERROR,{videoInfo:{error:o}}),o;return[2]}}))}))},t.prototype.destroyKernel=function(){var e;this.kernel&&(this.setKernelEvts(!1),null===(e=this.kernel)||void 0===e||e.destroy(),this.kernel=null)},__decorate$8([logMethodCall$9,__metadata$8("design:type",Function),__metadata$8("design:paramtypes",[Object,Object]),__metadata$8("design:returntype",Promise)],t.prototype,"play",null),__decorate$8([logMethodCall$9,__metadata$8("design:type",Function),__metadata$8("design:paramtypes",[Object,Object]),__metadata$8("design:returntype",Promise)],t.prototype,"load",null),__decorate$8([logMethodCall$9,__metadata$8("design:type",Function),__metadata$8("design:paramtypes",[Object]),__metadata$8("design:returntype",void 0)],t.prototype,"setAudioTrack",null),__decorate$8([logMethodCall$9,__metadata$8("design:type",Function),__metadata$8("design:paramtypes",[Object,Array,Object]),__metadata$8("design:returntype",Promise)],t.prototype,"setLevel",null),__decorate$8([logMethodCall$9,__metadata$8("design:type",Function),__metadata$8("design:paramtypes",[]),__metadata$8("design:returntype",void 0)],t.prototype,"destroy",null),__decorate$8([logMethodCall$9,__metadata$8("design:type",Function),__metadata$8("design:paramtypes",[Object,Object,Object]),__metadata$8("design:returntype",Promise)],t.prototype,"checkWhetherNeedToSwitchKernel",null),__decorate$8([logMethodCall$9,__metadata$8("design:type",Function),__metadata$8("design:paramtypes",[String]),__metadata$8("design:returntype",void 0)],t.prototype,"createKernel",null),t}(s),kernelAvailable={isHlsjsAvailable:function(e){return!!e&&(e.videoType===VIDEO_TYPE.HLS&&e.drmType!==DRM_TYPE$1.FAIRPLAY&&(!(e.vcodec===CODEC.H265&&!videoTool.supportHevc())&&(!(e.vcodec===CODEC.AV1&&!videoTool.supportAV1())&&videoTool.supportMSE())))},isFlvjsAvailable:function(e){return!(!e||uaTool.mobile)&&(e.videoType===VIDEO_TYPE.FLV&&e.drmType===DRM_TYPE$1.NONE&&videoTool.supportMSE())},isDemux2fmp4Available:function(e){return!!e&&((e.videoType===VIDEO_TYPE.MP4||e.videoType===VIDEO_TYPE.MOV)&&((void 0===e.vcodec||e.vcodec===CODEC.H264)&&videoTool.supportMSE()))},isWebrtcplayerAvailable:function(e){return!!e&&(e.videoType===VIDEO_TYPE.WEBRTC&&videoTool.isWebRTCSupported())},isWasmplayerAvailble:function(e){return!(!e||uaTool.mobile)&&videoTool.isWasmKernelSupported()},isElectronPlayerAailble:function(){return/electron\//i.test(navigator.userAgent)}},_a$8,UrlParamKey$1;function createMetadata(e){return{urlConfig:e,videoType:getUrlConfigVideoType(e),drmType:getDrmType(e),vcodec:null==e?void 0:e.vcodec}}function getDrmType(e){var t;if(null==e?void 0:e.chachaParam)return DRM_TYPE$1.CHACHA;var o=null===(t=null==e?void 0:e.drmConfig)||void 0===t?void 0:t.keySystem;return[KeySystems.FairPlay,KeySystems.FairPlayWebKit].includes(o)?DRM_TYPE$1.FAIRPLAY:KeySystems.Widevine===o?DRM_TYPE$1.WIDEVINE:DRM_TYPE$1.NONE}!function(e){e.forceKernel="__forceKernel"}(UrlParamKey$1||(UrlParamKey$1={}));var KERNEL_NAME_BY_PRIORITY=[exports.KERNEL_NAME.HLS_JS,exports.KERNEL_NAME.FLV_JS,exports.KERNEL_NAME.WEBRTC,exports.KERNEL_NAME.ORIGIN],VIDEO_TYPE_2_AVAILABEL_MAP=(_a$8={},_a$8[exports.KERNEL_NAME.HLS_JS]=kernelAvailable.isHlsjsAvailable,_a$8[exports.KERNEL_NAME.FLV_JS]=kernelAvailable.isFlvjsAvailable,_a$8[exports.KERNEL_NAME.WEBRTC]=kernelAvailable.isWebrtcplayerAvailable,_a$8[exports.KERNEL_NAME.DEMUX_2_FMP4]=kernelAvailable.isDemux2fmp4Available,_a$8[exports.KERNEL_NAME.ORIGIN]=function(){return!0},_a$8[exports.KERNEL_NAME.WASM]=kernelAvailable.isWasmplayerAvailble,_a$8[exports.KERNEL_NAME.ELECTRON]=kernelAvailable.isElectronPlayerAailble,_a$8);exports.KERNEL_NAME.FLV_JS,exports.KERNEL_NAME.HLS_JS,exports.KERNEL_NAME.WEBRTC;var KernelSelector=function(){function e(){}return e.getSelector=function(){return this.selector||(this.selector=new e),this.selector},e.prototype.selectByURLConfig=function(e,t,o){var r=createMetadata(e);return this.selectKernelWithAssign(r,t)||this.selectKernelInPresetMap(r,o)},e.prototype.selectKernelWithAssign=function(e,t){var o,r=t,n=urlTool.getUrlParamByKey(location.href,UrlParamKey$1.forceKernel);if(n&&Object.keys(VIDEO_TYPE_2_AVAILABEL_MAP).includes(n)&&(r=n),!r)return null;if(null===(o=VIDEO_TYPE_2_AVAILABEL_MAP[r])||void 0===o?void 0:o.call(VIDEO_TYPE_2_AVAILABEL_MAP,e))return r;var i=this.suggestKernelNameByMetadata(e,KERNEL_NAME_BY_PRIORITY),a="".concat(r!==exports.KERNEL_NAME.ORIGIN?"".concat(r,"内核"):"","无法播放当前格式")+"".concat(i&&i!==exports.KERNEL_NAME.ORIGIN?"，请尝试使用".concat(i,"内核播放"):"");return{code:ERROR_CODE.MISSING_KERNEL,message:a}},e.prototype.selectKernelInPresetMap=function(e,t){var o;if(t){o=t;for(var r=0;r<KERNEL_NAME_BY_PRIORITY.length;r++)-1===t.indexOf(KERNEL_NAME_BY_PRIORITY[r])&&o.push(KERNEL_NAME_BY_PRIORITY[r])}else o=KERNEL_NAME_BY_PRIORITY;return this.suggestKernelNameByMetadata(e,o)},e.prototype.suggestKernelNameByMetadata=function(e,t){var o;if(!e)return null;for(var r=0;r<t.length;r++){var n=t[r];if(null===(o=VIDEO_TYPE_2_AVAILABEL_MAP[n])||void 0===o?void 0:o.call(VIDEO_TYPE_2_AVAILABEL_MAP,e))return n}return null},e.prototype.isKernelSupportByUrlConfig=function(e,t){var o=VIDEO_TYPE_2_AVAILABEL_MAP[e];return!!o&&o(createMetadata(t))},e}(),KernelFactory=function(){function e(){}return e.registerKernel=function(e,t){var o,r,n;this.kernelMap[e]?null===(r=(o=this.kernelMap[e]).unregister)||void 0===r||r.call(o):!this.kernelMap[e]&&t&&(null===(n=t.register)||void 0===n||n.call(t)),this.kernelMap[e]=t},e.createKernel=function(t,o){if(t){var r=e.kernelMap[t];if(!r)throw new Error("Can't find [".concat(t,"] kernel"));if(r.isEnvSupport){var n=new r(o);return r.exportApis&&comTool.assignApiToPrototype(n,KernelProxy.prototype,r.exportApis),n}window.console.log("Browser does not support kernelName[".concat(t,"]"))}return new e.kernelMap.origin(o)},e.create=function(e){return new KernelProxy(e)},e.getKernelByName=function(t){return e.kernelMap[t]},e.isKernelSupportByUrlConfig=function(e,t){return KernelSelector.getSelector().isKernelSupportByUrlConfig(e,t)},e.selectKernel=function(e,t,o){var r=e instanceof Array?e[0]:e;return KernelSelector.getSelector().selectByURLConfig(r,t,o)},e.kernelMap={},e}(),KernelFactory$1=KernelFactory,_a$7;function getKernelCdnPath(e,t){var o;void 0===t&&(t={});var r=LOCAL_DEV?"latest":t[e]||VERSION$3,n="core/".concat(r);return((o={})[exports.KERNEL_NAME.HLS_JS]="".concat(n,"/txhlsjs-kernel.js"),o[exports.KERNEL_NAME.FLV_JS]="".concat(n,"/flvjs-kernel.js"),o[exports.KERNEL_NAME.DEMUX_2_FMP4]="".concat(n,"/demux2fmp4-kernel.js"),o[exports.KERNEL_NAME.WASM]="".concat(n,"/wasm-kernel.js"),o[exports.KERNEL_NAME.WEBRTC]="".concat(n,"/webrtc-kernel.js"),o)[e]}function compareUrlConfig(e,t){return!(!e||!t)&&(!(!e.uid||!t.uid||e.uid!==t.uid)||e===t)}function fileExtension2VideoType(e){switch(null==e?void 0:e.toLocaleLowerCase()){case"m3u8":case"m3u":return VIDEO_TYPE.HLS;case"mp4":case"mov":return VIDEO_TYPE.MP4;case"flv":case"f4v":return VIDEO_TYPE.FLV;case"avi":return VIDEO_TYPE.AVI;case"mpeg":return VIDEO_TYPE.MPEG;case"webm":return VIDEO_TYPE.WEBM;case"ogg":return VIDEO_TYPE.OGG}return VIDEO_TYPE.OTHER}function checkUrlConfigVailed(e,t){var o;if(!e)return{code:ERROR_CODE.NULL_URL,message:compile(i18nConfig.core.ERROR_NULL_URL),fatal:!0};null===(o=KernelFactory$1.getKernelByName(t))||void 0===o||o.canPlayType;var r=function(e,t){if(!e.url)return{code:ERROR_CODE.NULL_URL,message:compile(i18nConfig.core.ERROR_NULL_URL),fatal:!0}};if(!(e instanceof Array))return r(e);for(var n=0,i=e.length;n<i;n++){var a=r(e[n]);if(a)return a}}function getUrlConfigVideoType(e){var t=(e||{}).url;return!t||t.startsWith("blob:")?VIDEO_TYPE.OTHER:t.startsWith("webrtc:")?VIDEO_TYPE.WEBRTC:fileExtension2VideoType(urlTool.getFileExtension(t))}function findFreeBaseVideoElement(e){if(!e||0===e.length)throw new Error("videoElements is null or length equal 0");for(var t=null,o=0;o<e.length;o++){var r=e[o];if(void 0===r.dataset.used||r.dataset.used===VIDEO_ELEMENT_STATE.FREE){t=e[o];break}}if(!t)throw new Error("Unable to find free video element!");return t.dataset.used=VIDEO_ELEMENT_STATE.USED,t}var videoEvt2PlayerEvtMap=(_a$7={},_a$7[VIDEO_NODE_EVENT.DURATION_CHANGE]=exports.PLAY_EVENT.DURATION_CHANGE,_a$7[VIDEO_NODE_EVENT.VOLUME_CHANGE]=exports.PLAY_EVENT.VOLUME_CHANGE,_a$7[VIDEO_NODE_EVENT.ERROR]=exports.PLAY_EVENT.ERROR,_a$7[VIDEO_NODE_EVENT.METADATA_CHANGE]=exports.PLAY_EVENT.METADATA_CHANGE,_a$7[VIDEO_NODE_EVENT.SETLEVEL_OVER]=exports.PLAY_EVENT.SETLEVEL_OVER,_a$7[VIDEO_NODE_EVENT.SETLEVEL_START]=exports.PLAY_EVENT.SETLEVEL_START,_a$7[VIDEO_NODE_EVENT.SET_LOADING]=exports.PLAY_EVENT.SET_LOADING,_a$7[VIDEO_NODE_EVENT.STATE_CHANGE]=exports.PLAY_EVENT.STATE_CHANGE,_a$7[VIDEO_NODE_EVENT.TIME_UPDATE]=exports.PLAY_EVENT.TIME_UPDATE,_a$7[VIDEO_NODE_EVENT.VIDEO_BUFFER_CHANGE]=exports.PLAY_EVENT.VIDEO_BUFFER_CHANGE,_a$7[VIDEO_NODE_EVENT.LOAD_PROGRESS]=exports.PLAY_EVENT.LOAD_PROGRESS,_a$7[VIDEO_NODE_EVENT.FIRST_PLAYING]=exports.PLAY_EVENT.VIDEONODE_FIRST_PLAYING,_a$7[VIDEO_NODE_EVENT.RATE_CHANGE]=exports.PLAY_EVENT.RATE_CHANGE,_a$7[VIDEO_NODE_EVENT.RETRY]=exports.PLAY_EVENT.RETRY_BACKURL,_a$7[VIDEO_NODE_EVENT.ELEMENT_EVTS]=exports.PLAY_EVENT.ELEMENT_EVTS,_a$7[VIDEO_NODE_EVENT.PLAY_OVER]=exports.PLAY_EVENT.STOPED,_a$7[VIDEO_NODE_EVENT.VIDEO_RESIZE]=exports.PLAY_EVENT.VIDEO_RESIZE,_a$7[VIDEO_NODE_EVENT.VIDEO_FRAME_RENDER]=exports.PLAY_EVENT.VIDEO_FRAME_RENDER,_a$7[VIDEO_NODE_EVENT.SET_AUDIO_TRACK_OVER]=exports.PLAY_EVENT.SET_AUDIO_TRACK_OVER,_a$7[VIDEO_NODE_EVENT.SET_AUDIO_TRACK_START]=exports.PLAY_EVENT.SET_AUDIO_TRACK_START,_a$7[VIDEO_NODE_EVENT.ENTER_INSERT_STREAM]=exports.PLAY_EVENT.ENTER_INSERT_STREAM,_a$7[VIDEO_NODE_EVENT.EXIT_INSERT_STREAM]=exports.PLAY_EVENT.EXIT_INSERT_STREAM,_a$7),IGNORE_EVT_TYPE=[VIDEO_NODE_EVENT.TIME_UPDATE,VIDEO_NODE_EVENT.VIDEO_BUFFER_CHANGE,VIDEO_NODE_EVENT.VIDEO_FRAME_RENDER],IGNORE_VIDEO_EVT=[VIDEO_EVTS.timeupdate,VIDEO_EVTS.progress,VIDEO_EVTS.frameRender],__extends$9=window&&window.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),CheckHealth=function(e){function t(t){var o=e.call(this)||this;return o.stateStartTimeStamp=0,o.preFramePlaytime=0,o.playtimeStalledFrameCount=0,o.videoNode=t,o.setVideoNodeEvts(!0),o}return __extends$9(t,e),t.prototype.loop=function(){var e=+new Date;this.checkStateStalled(e),this.checkPlaytimeStalled()},t.prototype.destroy=function(){this.setVideoNodeEvts(!1),this.removeAllListeners(),this.stateStartTimeStamp=0,this.videoNode=null,this.videoNodeEvtMap=null,this.preFramePlaytime=0,this.playtimeStalledFrameCount=0},t.prototype.setVideoNodeEvts=function(e){var t,o=this;this.videoNode&&(this.videoNodeEvtMap||(this.videoNodeEvtMap=((t={})[VIDEO_NODE_EVENT.STATE_CHANGE]=this.videoNodeStateChange.bind(this),t)),Object.keys(this.videoNodeEvtMap).forEach((function(t){e?o.videoNode.on(t,o.videoNodeEvtMap[t]):o.videoNode.off(t,o.videoNodeEvtMap[t])})))},t.prototype.videoNodeStateChange=function(e){this.stateStartTimeStamp=+new Date},t.prototype.checkStateStalled=function(e){var t=this.videoNode,o=t.config,r=t.state;-1!==[exports.VIDEO_STATE.BUFFERING,exports.VIDEO_STATE.SEEKING].indexOf(r)&&(this.stateStartTimeStamp<=0||o.maxStateStalledTime<=0||e-this.stateStartTimeStamp>o.maxStateStalledTime&&(this.stateStartTimeStamp=0,this.emit(HEALTH_EVTS.STATE_STUCK,{code:ERROR_CODE.STATE_STUCK,message:compile(i18nConfig.core.ERROR_PLAY_STUCK),state:r})))},t.prototype.checkPlaytimeStalled=function(){var e=this.videoNode,t=e.config,o=e.state,r=e.videoElement;o!==exports.VIDEO_STATE.PLAYING||r.duration<=0||r.currentTime<=0||t.maxPlaytimeStalledTime<=0||(this.preFramePlaytime>0&&(this.preFramePlaytime!==r.currentTime?this.playtimeStalledFrameCount=0:(this.playtimeStalledFrameCount++,16.7*this.playtimeStalledFrameCount>t.maxPlaytimeStalledTime&&(this.playtimeStalledFrameCount=0,this.emit(HEALTH_EVTS.PLAYTIME_STUCK,{code:ERROR_CODE.ORG_PLAY_STUCK_ERR,message:compile(i18nConfig.core.ERROR_PLAY_STUCK),state:o})))),this.preFramePlaytime=r.currentTime)},t}(s),HEALTH_EVTS;!function(e){e.STATE_STUCK="state-stuck",e.PLAYTIME_STUCK="playtime-stuck"}(HEALTH_EVTS||(HEALTH_EVTS={}));var CheckVideoNodeStatus=function(){function e(e){this.videoNode=e}return e.prototype.checkIsSetLevelOver=function(e,t){if(void 0===e&&(e=VIDEO_EVTS.playing),void 0===t&&(t=0),!this.videoNode||!this.videoNode.videoElement)throw new Error("Target VideoNode is null!");if(!this.videoNode.getLevelSwitching())return null;var o=!1,r=!1,n=!1;if(this.videoNode.config.type===exports.PLAY_MODE.LIVE)o=e===VIDEO_EVTS.playing,n=e===VIDEO_EVTS.timeupdate;else{var i=videoTool.supportMediaFragmentsURISpec(this.videoNode.config.enableMediaFragmentsURI);o=e===VIDEO_EVTS.playing&&i,r=e===VIDEO_EVTS.seeked&&!i;var a=this.videoNode.videoElement.currentTime-t>=.3;n=e===VIDEO_EVTS.timeupdate&&a}return o||r||n?{succInPlaying:o,succInSeeked:r,succInTimeupdate:n}:null},e.prototype.checkCanSetLevel=function(){return this.videoNode?this.videoNode.played?this.videoNode.getLevelSwitching()?{canSetLevel:!1,message:"setLevel(), in progress."}:!this.videoNode.currentVideoInfo||this.videoNode.currentVideoInfo.playtime<=0?{canSetLevel:!1,message:"setLevel(), setLevel can't start."}:this.videoNode.config.type===exports.PLAY_MODE.VOD&&this.videoNode.currentVideoInfo.playtime+1>=this.videoNode.currentVideoInfo.duration?{canSetLevel:!1,message:"setLevel(), video is about to end."}:{canSetLevel:!0,message:"setLevel(), can set level now"}:{canSetLevel:!1,message:"setLevel(), play is not triggered."}:{canSetLevel:!1,message:"videoNode is null"}},e.prototype.checkCanSeek=function(e){if(!this.videoNode||!this.videoNode.currentVideoInfo)return{canSeek:!1,message:"seek(), because videonode or videoInfo is null"};if(this.videoNode.videoElement.duration<=0)return{canSeek:!1,message:"seek(), cannot seek when the duration is 0"};var t=e||{},o=t.seektime,r=void 0===o?NaN:o,n=t.userActivation,i=void 0!==n&&n,a=t.setLevelMode,s=void 0===a?SET_LEVEL_MODE.HARD:a;return Number.isNaN(r)?{canSeek:!1,message:"target time is NaN"}:r-this.videoNode.currentVideoInfo.duration>=1?{canSeek:!1,message:"seek(), return because too large time, uid=".concat(this.videoNode.currentVideoInfo.uid,"/idx=").concat(this.videoNode.idx,"/time=").concat(r)+"/duration=".concat(this.videoNode.currentVideoInfo.duration)}:void 0!==s&&s!==SET_LEVEL_MODE.SMOOTH&&this.videoNode.getLevelSwitching()&&i?{canSeek:!1,message:"seek(), cannot seek when hard/soft level switching"}:{canSeek:!0,message:"seek(), can seek now"}},e.prototype.checkCanSetAudioTrack=function(e){return e?{canSetAudioTrack:!1,message:"setAudioTrack(), in progress"}:this.videoNode?this.videoNode.hasAltAudio?this.videoNode.played?{canSetAudioTrack:!0,message:"setAudioTrack(), can set audio track now"}:{canSetAudioTrack:!1,message:"setAudioTrack(), can only be invoked after content plays"}:{canSetAudioTrack:!1,message:"setAudioTrack(), current content does not contain alternative audio track"}:{canSetAudioTrack:!1,message:"setAudioTrack(), because videonode is null"}},e.prototype.destroy=function(){this.videoNode=null},e}(),kernelEvtBus=new s,preloadEvtBus=new s,__assign$7=window&&window.__assign||function(){return __assign$7=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},__assign$7.apply(this,arguments)},LatencyController=function(){function e(e,t,o,r,n){var i=this;this.onLatencyExceeded=function(){},this.onLatencyDropped=function(){},this.latencyCalculationMethod=defaultLatencyCalculationMethod,this.setupEvents=function(){i.media.addEventListener("timeupdate",i.onTimeUpdate)},this.onTimeUpdate=function(){var e=i.media,t=e.buffered,o=e.currentTime;if(!e.paused){var r=i.latencyCalculationMethod(o,t);r<0||isNaN(r)||(r>i.config.expectedLatency&&1!==i.state?(i.onLatencyExceeded(o,r,i.media),i.state=1):r<=i.config.minLatency&&0!==i.state&&(i.onLatencyDropped(o,r,i.media),i.state=0))}},this.media=e,this.config=__assign$7(__assign$7({},defaultConfig),t),this.state=0,"function"==typeof o&&(this.onLatencyExceeded=o),"function"==typeof r&&(this.onLatencyDropped=r),"function"==typeof n&&(this.latencyCalculationMethod=n),this.setupEvents()}return e.prototype.destroy=function(){this.media.removeEventListener("timeupdate",this.onTimeUpdate),this.onLatencyExceeded=null,this.onLatencyDropped=null,this.latencyCalculationMethod=null},e}(),defaultConfig={expectedLatency:5,minLatency:2,syncSpeed:1.75};function defaultLatencyCalculationMethod(e,t){if(!(t.length>0&&e>0))return-1;for(var o=0;o<t.length;o++){var r=t.start(o),n=t.end(o);if(e>=r&&e<=n)return n-e}}var Loading=function(){function e(e){this.delayTimeoutId=0,this.evtEmiter=e}return e.prototype.show=function(e){var t=this;void 0===e&&(e=0),this.evtEmiter&&(this.clearDelay(),0!==e?this.delayTimeoutId=window.setTimeout((function(){t.evtEmiter.emit(VIDEO_NODE_EVENT.SET_LOADING,{show:!0})}),e):this.evtEmiter.emit(VIDEO_NODE_EVENT.SET_LOADING,{show:!0}))},e.prototype.hide=function(){this.evtEmiter&&(this.clearDelay(),this.evtEmiter.emit(VIDEO_NODE_EVENT.SET_LOADING,{show:!1}))},e.prototype.clearDelay=function(){this.delayTimeoutId>0&&(window.clearTimeout(this.delayTimeoutId),this.delayTimeoutId=0)},e}(),PerformanceMonitor=function(){function e(e){this.totalVideoFrames=0,this.droppedVideoFrames=0,this.totalDecodeTimeInMs=0,this.presentedVideoFrames=0,this.preTotalVideoFrames=-1,this.preDroppedVideoFrames=-1,this.calcIntervalFrameDroppedTickCount=0,this.video=e}return e.prototype.calcIntervalFrameDropped=function(){if(this.calcIntervalFrameDroppedTickCount++,!(this.calcIntervalFrameDroppedTickCount<5)){if(this.calcIntervalFrameDroppedTickCount=0,this.preVisiblityState!==document.visibilityState)this.reset();else if("visible"===this.preVisiblityState){var e=videoTool.getVideoPlaybackQuality(this.video),t=e.totalVideoFrames,o=e.droppedVideoFrames;-1===this.preTotalVideoFrames&&(this.preTotalVideoFrames=t),-1===this.preDroppedVideoFrames&&(this.preDroppedVideoFrames=o);var r=t-this.preTotalVideoFrames,n=o-this.preDroppedVideoFrames;if(this.preTotalVideoFrames=t,this.preDroppedVideoFrames=o,r>0)return n/r}return 0}},e.prototype.reset=function(){this.preTotalVideoFrames=-1,this.preDroppedVideoFrames=-1,this.preVisiblityState=document.visibilityState},e.prototype.report=function(){var e=videoTool.getVideoPlaybackQuality(this.video),t=e.totalVideoFrames,o=e.droppedVideoFrames;this.totalVideoFrames=t,this.droppedVideoFrames=o;var r=this.totalDecodeTimeInMs/this.presentedVideoFrames;isNaN(r)&&(r=-1);var n=this.droppedVideoFrames/this.totalVideoFrames*100;return isNaN(n)&&(n=-1),{totalDecodeTimeInMs:this.totalDecodeTimeInMs,droppedVideoFrames:this.droppedVideoFrames,presentedVideoFrames:this.presentedVideoFrames,totalVideoFrames:this.totalVideoFrames,averageDecodeTimeInMs:r,frameDroppedInPercentage:n}},e}(),__decorate$7=window&&window.__decorate||function(e,t,o,r){var n,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,o,a):n(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},__metadata$7=window&&window.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},_a$6,VALID_PREVIOUS_STATE_MAP=(_a$6={},_a$6[exports.VIDEO_STATE.LOAD_START]=[exports.VIDEO_STATE.IDLE],_a$6[exports.VIDEO_STATE.CANPLAY]=[exports.VIDEO_STATE.LOAD_START],_a$6[exports.VIDEO_STATE.PLAYING]=[exports.VIDEO_STATE.CANPLAY,exports.VIDEO_STATE.SEEKED,exports.VIDEO_STATE.PAUSE,exports.VIDEO_STATE.BUFFERING],_a$6[exports.VIDEO_STATE.BUFFERING]=[exports.VIDEO_STATE.PLAYING],_a$6[exports.VIDEO_STATE.PAUSE]=[exports.VIDEO_STATE.PLAYING,exports.VIDEO_STATE.BUFFERING],_a$6[exports.VIDEO_STATE.SEEKING]=[exports.VIDEO_STATE.CANPLAY,exports.VIDEO_STATE.PLAYING,exports.VIDEO_STATE.PAUSE,exports.VIDEO_STATE.BUFFERING,exports.VIDEO_STATE.SEEKING],_a$6[exports.VIDEO_STATE.SEEKED]=[exports.VIDEO_STATE.SEEKING],_a$6[exports.VIDEO_STATE.END]=[exports.VIDEO_STATE.LOAD_START,exports.VIDEO_STATE.CANPLAY,exports.VIDEO_STATE.SEEKING,exports.VIDEO_STATE.SEEKED,exports.VIDEO_STATE.BUFFERING,exports.VIDEO_STATE.PLAYING,exports.VIDEO_STATE.PAUSE],_a$6[exports.VIDEO_STATE.IDLE]=[exports.VIDEO_STATE.END],_a$6),VALID_STATE_IN_LEVEL_SWITCHING=[exports.VIDEO_STATE.PAUSE,exports.VIDEO_STATE.PLAYING,exports.VIDEO_STATE.END,exports.VIDEO_STATE.IDLE],logMethodCall$8=logMethodCallDecoratorCreator("StateMgr"),StateMgr=function(){function e(e){var t;this.videoEvtHandler=((t={})[VIDEO_EVTS.canplay]=this.onCanplayEvt.bind(this),t[VIDEO_EVTS.playing]=this.setPlaying.bind(this),t[VIDEO_EVTS.waiting]=this.setWaiting.bind(this),t[VIDEO_EVTS.pause]=this.onPauseEvt.bind(this),t[VIDEO_EVTS.seeking]=this.onSeekingEvt.bind(this),t[VIDEO_EVTS.seeked]=this.onSeekedEvt.bind(this),t),this.videoNode=e,this.logger=new Logger(e.config.instanceId,"StateMgr")}return e.prototype.destroy=function(){this.videoNode=null},e.prototype.validCallState=function(e){var t;return null===(t=VALID_PREVIOUS_STATE_MAP[e])||void 0===t?void 0:t.includes(this.videoNode.state)},e.prototype.setEnded=function(){this.setVideoNodeState(exports.VIDEO_STATE.END),this.setVideoNodeState(exports.VIDEO_STATE.IDLE)},e.prototype.setLoadStart=function(){this.setVideoNodeState(exports.VIDEO_STATE.LOAD_START)},e.prototype.setCanplay=function(){this.setVideoNodeState(exports.VIDEO_STATE.CANPLAY)},e.prototype.setWaiting=function(){this.setVideoNodeState(exports.VIDEO_STATE.BUFFERING)},e.prototype.setPlaying=function(){this.setVideoNodeState(exports.VIDEO_STATE.PLAYING)},e.prototype.onSetLevelOver=function(){this.videoNode.state===exports.VIDEO_STATE.PAUSE&&this.setVideoNodeState(exports.VIDEO_STATE.PLAYING)},e.prototype.receiveVideoEvt=function(e){var t,o;null===(o=(t=this.videoEvtHandler)[e])||void 0===o||o.call(t)},e.prototype.setVideoNodeState=function(e){!this.videoNode.getLevelSwitching()||VALID_STATE_IN_LEVEL_SWITCHING.includes(e)?VALID_PREVIOUS_STATE_MAP[e].includes(this.videoNode.state)?this.videoNode.state=e:this.logger.log("can not set state from ".concat(this.videoNode.state," to ").concat(e)):this.logger.log("can not set state 2 ".concat(e," when level switching"))},e.prototype.onCanplayEvt=function(){(uaTool.os.ios||uaTool.browser.safari)&&this.isVideoElementPlaying()&&this.videoNode.state===exports.VIDEO_STATE.BUFFERING?this.setVideoNodeState(exports.VIDEO_STATE.PLAYING):this.setVideoNodeState(exports.VIDEO_STATE.CANPLAY)},e.prototype.onPauseEvt=function(){this.setVideoNodeState(exports.VIDEO_STATE.PAUSE)},e.prototype.onSeekingEvt=function(){this.setVideoNodeState(exports.VIDEO_STATE.SEEKING)},e.prototype.onSeekedEvt=function(){this.setVideoNodeState(exports.VIDEO_STATE.SEEKED),(uaTool.os.ios||uaTool.browser.safari)&&this.isVideoElementPlaying()&&this.setVideoNodeState(exports.VIDEO_STATE.PLAYING)},e.prototype.isVideoElementPlaying=function(){return!this.videoNode.videoElement.paused&&!this.videoNode.videoElement.ended},__decorate$7([logMethodCall$8,__metadata$7("design:type",Function),__metadata$7("design:paramtypes",[]),__metadata$7("design:returntype",void 0)],e.prototype,"destroy",null),__decorate$7([logMethodCall$8,__metadata$7("design:type",Function),__metadata$7("design:paramtypes",[String]),__metadata$7("design:returntype",void 0)],e.prototype,"validCallState",null),__decorate$7([logMethodCall$8,__metadata$7("design:type",Function),__metadata$7("design:paramtypes",[]),__metadata$7("design:returntype",void 0)],e.prototype,"setEnded",null),__decorate$7([logMethodCall$8,__metadata$7("design:type",Function),__metadata$7("design:paramtypes",[]),__metadata$7("design:returntype",void 0)],e.prototype,"setLoadStart",null),__decorate$7([logMethodCall$8,__metadata$7("design:type",Function),__metadata$7("design:paramtypes",[]),__metadata$7("design:returntype",void 0)],e.prototype,"setCanplay",null),__decorate$7([logMethodCall$8,__metadata$7("design:type",Function),__metadata$7("design:paramtypes",[]),__metadata$7("design:returntype",void 0)],e.prototype,"setWaiting",null),__decorate$7([logMethodCall$8,__metadata$7("design:type",Function),__metadata$7("design:paramtypes",[]),__metadata$7("design:returntype",void 0)],e.prototype,"setPlaying",null),e}(),VIDEO_FILL_TYPE;!function(e){e.COVER="cover",e.CONTAIN="contain"}(VIDEO_FILL_TYPE||(VIDEO_FILL_TYPE={}));var VideoResizeAutoFill=function(){function e(e,t){void 0===t&&(t=10),this.minFillBlackBorder=10,this.videoElement=e,this.minFillBlackBorder=t,this.addToObserver()}return e.prototype.resizeAutoFill=function(){if(this.videoElement instanceof HTMLVideoElement&&!(this.minFillBlackBorder<=0)&&0!==this.videoElement.videoWidth&&0!==this.videoElement.videoHeight){var e=domTool.getDomSize(this.videoElement),t=e.width,o=e.height,r=this.videoElement.videoWidth*(o/this.videoElement.videoHeight),n=this.videoElement.videoHeight*(t/this.videoElement.videoWidth);r<t&&r>=t-this.minFillBlackBorder||n<o&&n>=o-this.minFillBlackBorder?videoTool.setElementFitType(this.videoElement,VIDEO_FILL_TYPE.COVER):videoTool.setElementFitType(this.videoElement,VIDEO_FILL_TYPE.CONTAIN)}},e.prototype.destroy=function(){this.videoElement&&this.videoElement instanceof HTMLVideoElement&&this.videoResizeObserver&&(this.videoResizeObserver.disconnect(),this.videoResizeObserver.unobserve(this.videoElement),this.videoResizeObserver=null,this.videoElement=null)},e.prototype.addToObserver=function(){var e=this;this.videoElement&&this.videoElement instanceof HTMLVideoElement&&(this.videoResizeObserver=new ResizeObserver((function(){e.resizeAutoFill()})),this.videoResizeObserver.observe(this.videoElement))},e}(),__extends$8=window&&window.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),__assign$6=window&&window.__assign||function(){return __assign$6=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},__assign$6.apply(this,arguments)},__decorate$6=window&&window.__decorate||function(e,t,o,r){var n,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,o,a):n(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},__metadata$6=window&&window.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},logMethodCall$7=logMethodCallDecoratorCreator("BaseVideoNode"),BaseVideoNode=function(e){function t(t){var o,r=e.call(this)||this;r._played=!1,r._evtBlocking=!1,r._pauseCloseToEndStateCheckTimeoutId=0,r._targetSeekTime=-1,r._userStartTime=0,r._isUserSeek=!1,r.isUserSwitchAudioTrack=!1,r.loadTimeoutId=0,r.levelSwitchTargetPlaytime=-1,r.setLevelMode=SET_LEVEL_MODE.SOFT,r.altAudio=!1,r.latencyController=null,r._logger=new Logger(t.instanceId,"BaseVideoNode"),r._config=t,r.stateMgr=new StateMgr(r),r.checkPlayHealth=new CheckHealth(r),r.loading=new Loading(r),r.setHealthEvents(),r.mainTaskLoop=new TaskLoop(r.mainLoopInProcess.bind(r),LoopMode.RAF);var n=r._config.container;return r._video=r.findFreeVideoElement(),r._autoPlayPolicy=new AutoPlayPolicy(r._video,{instanceId:t.instanceId}),r._state=exports.VIDEO_STATE.IDLE,r._playbackRate=1,r._idx=0,r._videoInfo=null,r._pauseType=void 0,r._videoEventMap=((o={})[VIDEO_EVTS.loadstart]=r.onVideoEventLoadStart.bind(r),o[VIDEO_EVTS.timeupdate]=r.onVideoEventTimeUpdate.bind(r),o[VIDEO_EVTS.durationchange]=r.onVideoEventDurationChange.bind(r),o[VIDEO_EVTS.volumechange]=r.onVideoEventVolumeChange.bind(r),o[VIDEO_EVTS.canplay]=r.onVideoEventCanplay.bind(r),o[VIDEO_EVTS.playing]=r.onVideoEventPlaying.bind(r),o[VIDEO_EVTS.pause]=r.onVideoEventPause.bind(r),o[VIDEO_EVTS.waiting]=r.onVideoEventWaiting.bind(r),o[VIDEO_EVTS.seeking]=r.onVideoEventSeeking.bind(r),o[VIDEO_EVTS.seeked]=r.onVideoEventSeeked.bind(r),o[VIDEO_EVTS.loadeddata]=r.onVideoEventLoadeddata.bind(r),o[VIDEO_EVTS.loadedmetadata]=r.onVideoEventLoadedmetadata.bind(r),o[VIDEO_EVTS.ended]=r.onVideoEventEnded.bind(r),o[VIDEO_EVTS.error]=r.onVideoEventError.bind(r),o[VIDEO_EVTS.progress]=r.onVideoEventProgress.bind(r),o[VIDEO_EVTS.ratechange]=r.onVideoEventRateChange.bind(r),o[VIDEO_EVTS.resize]=r.onVideoEventResize.bind(r),o),r._drm=new DRM(r._video,t.drmConfig,new Logger(t.instanceId,"DRM")),r._drm.on("error",r.onDrmError.bind(r)),r._eventMap={video:r.onVideoEvents.bind(r)},r._eventAddedMap={},r._videoElementContainer=domTool.getElementFromConfig(n).querySelector(".".concat(VIDEO_CONTAINER_CLASS)),videoTool.appendElement(r._video,r._videoElementContainer),r.performanceMonitor=new PerformanceMonitor(r._video),r.videoResizeAutoFill=new VideoResizeAutoFill(r._video,r._config.minFillBlackBorder),r.vnStatusChecker=new CheckVideoNodeStatus(r),t.type===exports.PLAY_MODE.LIVE&&(r.latencyController=new LatencyController(r._video,t.latencyConfig,r.onLatencyExceeded.bind(r),r.onLatencyDropped.bind(r),r.latencyCalculationMethod.bind(r))),r}return __extends$8(t,e),t.prototype.triggerAutoplay=function(){var e=this;return this._evtBlocking=!0,this._autoPlayPolicy.userTrigger().then((function(){return e._evtBlocking=!1})).catch((function(t){throw e._evtBlocking=!1,t}))},t.prototype.videoplay=function(){var e,t=this;this._logger.log("videoplay(), uid=".concat(null===(e=this._videoInfo)||void 0===e?void 0:e.uid,"/state=").concat(this.state,"/idx=").concat(this.idx));var o=this._video.play();return o?o.catch((function(e){t._logger.warn("".concat(t.idx," play() catch: ").concat(e.name,", ").concat(e.message));var o=videoTool.isAutoPlayBlockedMessage(e.message);o&&t.loading.hide(),t.emit(VIDEO_NODE_EVENT.PLAY_PROMISE_CATCHED,{videoInfo:t._videoInfo,isAutoPlayBlocked:o})})):o=Promise.resolve(),this._video.playbackRate=this._playbackRate,o},t.prototype.pause=function(e){void 0===e&&(e=PAUSE_TYPE.USER),this._played?this.stateMgr.validCallState(exports.VIDEO_STATE.PAUSE)?this.pauseInner(e):this._logger.log("call pause in invaild state ".concat(this._state)):this._logger.warn("pause(), VideoNode has not been played")},t.prototype.resume=function(){throw new Error("not implements")},t.prototype.stop=function(){this.stopInner()},t.prototype.destroy=function(){var e,t,o,r,n,i,a,s,l;this.stopInner(),null===(e=this.latencyController)||void 0===e||e.destroy(),this.latencyController=null,this._video&&(this._eventMap&&(this.setVideoEvents(!1),this._eventMap=null),videoTool.clear(this._video),videoTool.removeElement(this._video,this._videoElementContainer),this._video.dataset.used=VIDEO_ELEMENT_STATE.FREE),null===(t=this._autoPlayPolicy)||void 0===t||t.destroy(),this._autoPlayPolicy=null,null===(o=this.stateMgr)||void 0===o||o.destroy(),this.stateMgr=null,this.removeAllListeners(),null===(r=this._drm)||void 0===r||r.destroy(),this._drm=null,this._video=null,this._videoInfo=null,this._videoElementContainer=null,this._played=!1,this._config=null,null===(n=this.checkPlayHealth)||void 0===n||n.destroy(),this.checkPlayHealth=null,null===(i=this.loading)||void 0===i||i.clearDelay(),this.loading=null,null===(a=this.mainTaskLoop)||void 0===a||a.destroy(),this.mainTaskLoop=null,this.performanceMonitor=null,null===(s=this.videoResizeAutoFill)||void 0===s||s.destroy(),this.videoResizeAutoFill=null,null===(l=this.vnStatusChecker)||void 0===l||l.destroy(),this.vnStatusChecker=null,this._logger.log("VideoNode has been destroyed!")},t.prototype.setLevel=function(e){if(void 0===e&&(e=SET_LEVEL_MODE.HARD),!this.checkCanSetLevel())return Promise.reject(new Error("setLevel can't start"));this._logger.log("setLevel(), succ exec: ",this._videoInfo);var t=this._videoInfo.playtime;this.load(this._videoInfo,{startTime:t}),this.play();var o=new SimpleDefer;return this._levelSwitchingDefer=o,this.levelSwitchTargetPlaytime=t,this.loading.show(),this.emit(VIDEO_NODE_EVENT.SETLEVEL_START,{videoInfo:this._videoInfo,mode:e}),o.promise},t.prototype.getLevelSwitching=function(){return!!this._levelSwitchingDefer},t.prototype.setAudioTrack=function(e){return this.checkCanSetAudioTrack()?Promise.reject(AUDIO_TRACK_ERROR_MSG.NOT_SUPPORT):Promise.reject(AUDIO_TRACK_ERROR_MSG.STATE_INVALID)},t.prototype.hasAltAudio=function(){return this.altAudio},t.prototype.isCurrentContentDRMEncrypted=function(){return this._state!==exports.VIDEO_STATE.IDLE&&this._drm.hasStarted()},Object.defineProperty(t.prototype,"volume",{get:function(){return this._video.muted?0:this._video.volume},set:function(e){e<0||e>1?this._logger.warn("The volume value range is [0,1]"):(this._video.volume=e,this._video.muted=e<=0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playtime",{get:function(){return this._videoInfo?this._videoInfo.playtime:0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},set:function(e){var t;if(this._state!==e){var o=this._state;this._state=e,this._videoInfo&&(this._videoInfo.state=this._state),this._logger.log("set state(), uid=".concat(null===(t=this._videoInfo)||void 0===t?void 0:t.uid,"/idx=").concat(this._idx,"/old=").concat(o,"/new=").concat(e));var r={videoInfo:this._videoInfo,new:e,old:o};e===exports.VIDEO_STATE.PAUSE?(r.pauseType=this._pauseType||PAUSE_TYPE.SYS,this._pauseType=void 0):e===exports.VIDEO_STATE.SEEKING?(r.seekingTime=this._targetSeekTime,r.isUserSeek=this._isUserSeek,this._targetSeekTime=-1):e===exports.VIDEO_STATE.SEEKED&&(r.isUserSeek=this._isUserSeek),this.setLoadingOnStateChange(),this.emit(VIDEO_NODE_EVENT.STATE_CHANGE,r)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"played",{get:function(){return this._played},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"useWorker",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"idx",{get:function(){return this._idx},set:function(e){this._idx=e,this._video.dataset.idx="".concat(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"videoElement",{get:function(){return this._video},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"videoSize",{get:function(){return{width:this._video.videoWidth,height:this._video.videoHeight}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"videoBuffered",{get:function(){return videoTool.getBuffered(this._video)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"config",{get:function(){return this._config},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playbackRate",{get:function(){return this._video.playbackRate},set:function(e){this._playbackRate=e;try{this._video.playbackRate=e}catch(e){this._logger.warn("set playbackRate: ".concat(null==e?void 0:e.message))}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentVideoInfo",{get:function(){return this._videoInfo},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportPlaybackRate",{get:function(){return!uaTool.browser.x5},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){var e=this._videoInfo?this._videoInfo.duration:0;return Number.isNaN(e)?0:e},enumerable:!1,configurable:!0}),t.prototype.latencyCalculationMethod=function(e,t){return-1},t.prototype.onLatencyExceeded=function(e,t,o){},t.prototype.onLatencyDropped=function(e,t,o){},t.prototype.setHealthEvents=function(){var e=this,t=function(t){e._logger.warn("get health evt!!! evt=".concat(t.type,"/uid=").concat(e._videoInfo.uid,"/idx=").concat(e._idx,"/state=").concat(e._state)),e.errorHandler(t.data)};this.checkPlayHealth.on(HEALTH_EVTS.STATE_STUCK,t),this.checkPlayHealth.on(HEALTH_EVTS.PLAYTIME_STUCK,t)},t.prototype.setVideoEvents=function(e){var t,o=this;this._eventAddedMap.videoEventAdded!==e&&(this._logger.log("setVideoEvents(), idx=".concat(this._idx,"/value=").concat(e,"/uid=").concat(null===(t=this._videoInfo)||void 0===t?void 0:t.uid)),this._eventAddedMap.videoEventAdded=e,Object.keys(this._videoEventMap).forEach((function(t){e?o._video.addEventListener(t,o._eventMap.video):o._video.removeEventListener(t,o._eventMap.video)})))},t.prototype.onVideoEvents=function(e){var t,o=this;if(this.state!==exports.VIDEO_STATE.IDLE&&this._videoInfo&&!this._evtBlocking){IGNORE_VIDEO_EVT.includes(e.type)||this._logger.log("videoevt, uid=".concat(this._videoInfo.uid,"/idx=").concat(this.idx,"/type=").concat(e.type,"/")+"time=".concat(this._video.currentTime,"/duration=").concat(this._video.duration)),this.emit(VIDEO_NODE_EVENT.ELEMENT_EVTS,{videoInfo:this._videoInfo,elementEvtType:e.type});var r=Math.abs(this._videoInfo.duration-this._videoInfo.playtime)<.1&&this._videoInfo.duration>0;"pause"===e.type&&r?this._pauseCloseToEndStateCheckTimeoutId=window.setTimeout((function(){o._videoEventMap[e.type]&&o._videoEventMap[e.type](e)}),0):("ended"===e.type&&this._pauseCloseToEndStateCheckTimeoutId>0&&(window.clearTimeout(this._pauseCloseToEndStateCheckTimeoutId),this._pauseCloseToEndStateCheckTimeoutId=0),this._videoEventMap[e.type]&&this._videoEventMap[e.type](e))}else this._logger.log("videoevt discard, idx=".concat(this._idx,"/uid=").concat(null===(t=this._videoInfo)||void 0===t?void 0:t.uid,"/evttype=").concat(e.type,"/")+"state=".concat(this.state,"/evtBlocking=").concat(this._evtBlocking))},t.prototype.onVideoEventPlaying=function(){this.setCheckLoadTimeoutEnable(!1),this._isUserSeek=!1,this.updateVideoSize(),uaTool.browser.x5&&this.onVideoEventDurationChange(),this._videoInfo.hasFirstPlaying||this.emit(VIDEO_NODE_EVENT.FIRST_PLAYING,{videoInfo:this._videoInfo}),this.stateMgr.receiveVideoEvt(VIDEO_EVTS.playing),this._videoInfo&&(this._videoInfo.hasFirstPlaying=!0,this._videoInfo.stateWhenErrorHappen=null),this._userStartTime=0,this.checkSetLevelOver(VIDEO_EVTS.playing)},t.prototype.onVideoEventCanplay=function(){this.setCheckLoadTimeoutEnable(!1),this._videoInfo&&(this._videoInfo.qualityInfo.canplaytime||(this._videoInfo.qualityInfo.canplaytime=videoTool.getBuffered(this._video)),this.stateMgr.receiveVideoEvt(VIDEO_EVTS.canplay))},t.prototype.onVideoEventPause=function(){this._pauseType!==PAUSE_TYPE.INNER&&this.stateMgr.receiveVideoEvt(VIDEO_EVTS.pause)},t.prototype.onVideoEventEnded=function(){this._logger.log("setEndInner(), reason=endedEvt"),this.setEndInner()},t.prototype.onVideoEventSeeked=function(){this.stateMgr.receiveVideoEvt(VIDEO_EVTS.seeked),this.checkSetLevelOver(VIDEO_EVTS.seeked),this.resumeAfterSeek(),this._isUserSeek=!1},t.prototype.onVideoEventLoadStart=function(){},t.prototype.onVideoEventWaiting=function(){this.stateMgr.receiveVideoEvt(VIDEO_EVTS.waiting)},t.prototype.onVideoEventSeeking=function(){this.stateMgr.receiveVideoEvt(VIDEO_EVTS.seeking)},t.prototype.onVideoEventProgress=function(){this.emit(VIDEO_NODE_EVENT.VIDEO_BUFFER_CHANGE,{videoInfo:this._videoInfo})},t.prototype.onVideoEventLoadedmetadata=function(e){this.updateVideoSize(),this.emit(VIDEO_NODE_EVENT.METADATA_CHANGE,{videoInfo:this._videoInfo})},t.prototype.onVideoEventResize=function(){this.updateVideoSize(!0)},t.prototype.onVideoEventRateChange=function(){this.emit(VIDEO_NODE_EVENT.RATE_CHANGE,{playbackRate:this.playbackRate,videoInfo:this._videoInfo})},t.prototype.onVideoEventDurationChange=function(){this._video.duration>0&&this._video.duration!==this._videoInfo.duration&&(this._videoInfo.duration=this._video.duration,this._logger.log("onVideoEventDurationChange(), uid=".concat(this._videoInfo.uid,"/duration=").concat(this._videoInfo.duration,"/")+"idx=".concat(this.idx)),this.emit(VIDEO_NODE_EVENT.DURATION_CHANGE,{videoInfo:this._videoInfo}))},t.prototype.onVideoEventVolumeChange=function(){this.emit(VIDEO_NODE_EVENT.VOLUME_CHANGE,{volume:this.volume,videoInfo:this._videoInfo})},t.prototype.onVideoEventTimeUpdate=function(){var e;if(0!==this._video.currentTime){this.updatePlaytime(this._video.currentTime),this.checkSetLevelOver(VIDEO_EVTS.timeupdate),this._state===exports.VIDEO_STATE.BUFFERING&&this.stateMgr.setPlaying();var t=null===(e=this.performanceMonitor)||void 0===e?void 0:e.calcIntervalFrameDropped();"number"==typeof t&&this._videoInfo&&(this._videoInfo.qualityInfo.intervalFrameDropped=t)}},t.prototype.onAudioTrackSwitched=function(e,t){void 0===t&&(t=!1),this.audioTrackSwitchingDefer&&(this.audioTrackSwitchingDefer.resolve({userTrigger:this.isUserSwitchAudioTrack,id:e,fail:t}),this.audioTrackSwitchingDefer=null,this.emit(VIDEO_NODE_EVENT.SET_AUDIO_TRACK_OVER,{videoInfo:this._videoInfo,id:e,fail:t,userTrigger:this.isUserSwitchAudioTrack}))},t.prototype.onVideoEventLoadeddata=function(){this.emit(VIDEO_NODE_EVENT.VIDEO_BUFFER_CHANGE,{videoInfo:this._videoInfo})},t.prototype.onVideoEventError=function(){this.errorHandler()},t.prototype.onDrmError=function(e){var t=e.data,o=t.code,r=t.message,n=t.detail,i=PlayerError.EncryptionError({code:o,detail:n,message:r});this._videoInfo.error=i,this.stopInner(!1,this._videoInfo)},t.prototype.checkCanSetLevel=function(){var e=this.vnStatusChecker.checkCanSetLevel();return!!e.canSetLevel||(this._logger.warn(e.message),!1)},t.prototype.checkSetLevelOver=function(e){var t=this.vnStatusChecker.checkIsSetLevelOver(e,this.levelSwitchTargetPlaytime);t&&(this._logger.log("setLevelOver(), reason: "+"succOnPlaying=".concat(t.succInPlaying,"/succOnSeeked=").concat(t.succInSeeked,"/succOnTimeupdate=").concat(t.succInTimeupdate)),this.setLevelOver())},t.prototype.setLevelOver=function(){this._levelSwitchingDefer&&(this._levelSwitchingDefer.resolve(),this._levelSwitchingDefer=null,this.levelSwitchTargetPlaytime=-1,this.loading.hide(),this.stateMgr.onSetLevelOver(),this.emit(VIDEO_NODE_EVENT.SETLEVEL_OVER,{videoInfo:this._videoInfo}))},t.prototype.checkCanSeek=function(e,t){void 0===t&&(t=!1);var o=this.vnStatusChecker.checkCanSeek({seektime:e,userActivation:t,setLevelMode:this.setLevelMode});return!!o.canSeek||(this._logger.warn(o.message),!1)},t.prototype.checkCanSetAudioTrack=function(){var e=this.vnStatusChecker.checkCanSetAudioTrack(this.audioTrackSwitchingDefer);return!!e.canSetAudioTrack||(this._logger.warn(e.message),!1)},t.prototype.findFreeVideoElement=function(){return findFreeBaseVideoElement(this._config.videoElements)},t.prototype.setMainLoopEnable=function(e){e?this.mainTaskLoop.start():this.mainTaskLoop.stop()},t.prototype.mainLoopInProcess=function(){this.updateAccuratePlaytime(),this.checkPlayHealth.loop()},t.prototype.updateAccuratePlaytime=function(){var e;this._state!==exports.VIDEO_STATE.PLAYING||this._video.duration<=0||this._video.readyState<VIDEO_READY_STATE.HAVE_ENOUGH_DATA||(null===(e=this.onAccurateTimeupdate)||void 0===e||e.call(this,this._video.currentTime,this._video.duration),this.updatePlaytime(this._video.currentTime,!0))},t.prototype.updatePlaytime=function(e,t){if(void 0===t&&(t=!1),this._videoInfo){var o=this.performanceMonitor.report(),r=o.averageDecodeTimeInMs,n=o.totalVideoFrames,i=o.droppedVideoFrames,a=o.frameDroppedInPercentage;this._videoInfo.qualityInfo.droppedVideoFrames=i,this._videoInfo.qualityInfo.totalVideoFrames=n,this._videoInfo.qualityInfo.averageDecodeTimeInMs=r,this._videoInfo.qualityInfo.frameDroppedInPercentage=a,this._videoInfo.playtime!==e&&(this._videoInfo.playtime=e),t||this.emit(VIDEO_NODE_EVENT.TIME_UPDATE,{videoInfo:this._videoInfo})}},t.prototype.setCheckLoadTimeoutEnable=function(e){var t=this;if(this.loadTimeoutId&&clearTimeout(this.loadTimeoutId),e){var o=this._config.maxPreloadTimeout;o<=0||(this.loadTimeoutId=setTimeout((function(){t.errorHandler(PlayerError.NativeError({code:104,detail:comTool.isPageHidden(),fatal:!1,message:compile(i18nConfig.core.ERROR_PRELOAD_VIDEO_TIMEOUT)}))}),o))}},t.prototype.resumeAfterSeek=function(){this._played&&!this._video.ended&&this._isUserSeek&&(this._video.paused?this._config.remainPauseStateAfterSeek||this.videoplay():this.stateMgr.setPlaying())},t.prototype.pauseInner=function(e){var t;void 0===e&&(e=PAUSE_TYPE.INNER),this._logger.log("pause(), uid=".concat(null===(t=this._videoInfo)||void 0===t?void 0:t.uid,"/state=").concat(this.state,"/idx=").concat(this.idx,"/type=").concat(e)),this._pauseType=e,this._video.pause()},t.prototype.setEndInner=function(){this._state!==exports.VIDEO_STATE.END&&this._state!==exports.VIDEO_STATE.IDLE&&(this._logger.log("setEndInner(), idx=".concat(this._idx,"/uid=").concat(this._videoInfo.uid,"/playtime=").concat(this._videoInfo.playtime)+"/duration=".concat(this._videoInfo.duration,"}")),this.stateMgr.setEnded(),this.emit(VIDEO_NODE_EVENT.PLAY_OVER,{isUserStop:!1,endState:exports.END_STATE.NORMAL,videoInfo:this._videoInfo}))},t.prototype.stopInner=function(e,t){var o,r;this._video&&this._videoInfo&&(null===(o=this.performanceMonitor)||void 0===o||o.reset(),this.setMainLoopEnable(!1),this.setCheckLoadTimeoutEnable(!1),this._isUserSeek=!1,this._logger.log("stopInner(), uid/state/idx: ".concat(null===(r=this._videoInfo)||void 0===r?void 0:r.uid,"/").concat(this.state,"/").concat(this.idx)),this.setVideoEvents(!1),this._config.clearVideoAfterStop?videoTool.clear(this._video):this._video.pause(),this._config.createVideoNodeWhenLoad&&(this._video.dataset.used=VIDEO_ELEMENT_STATE.FREE),this._videoInfo&&(this._videoInfo.extraVars.isLoadstarted=!1,this._videoInfo=null),this._pauseCloseToEndStateCheckTimeoutId>0&&(window.clearTimeout(this._pauseCloseToEndStateCheckTimeoutId),this._pauseCloseToEndStateCheckTimeoutId=0),this.state!==exports.VIDEO_STATE.IDLE&&(e||(this.stateMgr.setEnded(),this._played=!1,this._levelSwitchingDefer=null,(null==t?void 0:t.error)&&this.emit(VIDEO_NODE_EVENT.ERROR,{videoInfo:t}))))},t.prototype.updateVideoSize=function(e){void 0===e&&(e=!1);var t=this._video.videoWidth,o=this._video.videoHeight;!this._videoInfo||this._videoInfo.videoWidth===t&&this._videoInfo.videoHeight===o||(this._videoInfo.videoWidth=t,this._videoInfo.videoHeight=o,this.emit(VIDEO_NODE_EVENT.VIDEO_RESIZE,{videoInfo:this._videoInfo,isNative:e}),this.videoResizeAutoFill.resizeAutoFill())},t.prototype.setLoadingOnStateChange=function(){if(this._played)if([exports.VIDEO_STATE.BUFFERING,exports.VIDEO_STATE.SEEKING].includes(this._state)){this.loading.show(500)}else(this._config.type===exports.PLAY_MODE.LIVE&&exports.VIDEO_STATE.CANPLAY!==this._state||this._config.type===exports.PLAY_MODE.VOD)&&this.loading.hide();else this.loading.hide()},t.prototype.errorHandler=function(e){var t=this.parseErrorData(e);this._logger.log("video encounter error",t);var o=videoTool.isPositionBuffered(this._video);this._logger.log("current position buffered=".concat(o)),o||(this._logger.warn("current position is not buffered, check close range"),this._logger.warn("next buffered start=".concat(videoTool.getNextBufferedStart(this._video))),this._logger.warn("last buffered end=".concat(videoTool.getLastBufferedEnd(this._video)))),this.retryWhenError(t)},t.prototype.retryWhenError=function(e){var t=this._videoInfo,o=this.setRetryUrl(t),r=t.config.expireTimeStamp,n=void 0!==r&&r<+new Date;if(null===this._videoInfo.stateWhenErrorHappen&&(this._videoInfo.stateWhenErrorHappen=this._state),!e.fatal&&!n&&o){var i=t.getRetryCount();return this._logger.log("retryOnError(), retryCount=",i),this.emit(VIDEO_NODE_EVENT.RETRY,__assign$6({error:e,retryCount:i,videoInfo:t},o)),this.stopInner(!0),this.stateMgr.setWaiting(),this._state!==exports.VIDEO_STATE.BUFFERING&&this.loading.show(),void this.doRetry(t)}this._logger.log("retryOnError(), fatal."),this._videoInfo.error=e,this._levelSwitchingDefer&&this._levelSwitchingDefer.reject(),this.stopInner(!1,this._videoInfo)},t.prototype.parseErrorData=function(e){var t,o;return e?videoTool.commonErrorParse(e):null!==(o=videoTool.getVideoError(null===(t=this._video.error)||void 0===t?void 0:t.code))&&void 0!==o?o:PlayerError.NativeError({code:0,fatal:!1,message:compile(i18nConfig.core.ERROR_MSG_UNKNOWN),debugMessage:jsonTool.safelyStringify(this._video.error)})},t.prototype.doRetry=function(e){var t=e.playtime,o=e.stateWhenErrorHappen,r=this._video.currentTime>0?this._video.currentTime:t,n=this._played?r:this._userStartTime;this._logger.log("do retry [url], stateWhenErrorHappen=".concat(o)),e.playtime=n,this._played&&o!==exports.VIDEO_STATE.PAUSE?this.play(e,{startTime:n}):this.load(e,{startTime:n})},t.prototype.setRetryUrl=function(e){var t=e.loadingUrl;return e.setNextBackUrl()?{prevUrl:t,curUrl:e.loadingUrl}:null},t.prototype.emitKernelEvt=function(e,t){kernelEvtBus.emit(e,__assign$6(__assign$6({},t),{playerInstanceId:this.config.instanceId}))},t.prototype.adjustSeekTime=function(e){var t=e;return(uaTool.browser.x5||uaTool.browser.safari)&&Math.abs(t-this._videoInfo.duration)<=1&&(t=this._videoInfo.duration-1),t},__decorate$6([logMethodCall$7,__metadata$6("design:type",Function),__metadata$6("design:paramtypes",[String]),__metadata$6("design:returntype",void 0)],t.prototype,"pause",null),__decorate$6([logMethodCall$7,__metadata$6("design:type",Function),__metadata$6("design:paramtypes",[]),__metadata$6("design:returntype",void 0)],t.prototype,"stop",null),__decorate$6([logMethodCall$7,__metadata$6("design:type",Function),__metadata$6("design:paramtypes",[]),__metadata$6("design:returntype",void 0)],t.prototype,"destroy",null),__decorate$6([logMethodCall$7,__metadata$6("design:type",Function),__metadata$6("design:paramtypes",[String]),__metadata$6("design:returntype",Promise)],t.prototype,"setLevel",null),__decorate$6([logMethodCall$7,__metadata$6("design:type",Function),__metadata$6("design:paramtypes",[Object]),__metadata$6("design:returntype",Promise)],t.prototype,"setAudioTrack",null),__decorate$6([logMethodCall$7,__metadata$6("design:type",Function),__metadata$6("design:paramtypes",[Boolean]),__metadata$6("design:returntype",void 0)],t.prototype,"setCheckLoadTimeoutEnable",null),__decorate$6([logMethodCall$7,__metadata$6("design:type",Function),__metadata$6("design:paramtypes",[String]),__metadata$6("design:returntype",void 0)],t.prototype,"pauseInner",null),__decorate$6([logMethodCall$7,__metadata$6("design:type",Function),__metadata$6("design:paramtypes",[]),__metadata$6("design:returntype",void 0)],t.prototype,"setEndInner",null),__decorate$6([logMethodCall$7,__metadata$6("design:type",Function),__metadata$6("design:paramtypes",[Boolean,Object]),__metadata$6("design:returntype",void 0)],t.prototype,"stopInner",null),__decorate$6([logMethodCall$7,__metadata$6("design:type",Function),__metadata$6("design:paramtypes",[Object]),__metadata$6("design:returntype",void 0)],t.prototype,"retryWhenError",null),t}(s),__extends$7=window&&window.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),__decorate$5=window&&window.__decorate||function(e,t,o,r){var n,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,o,a):n(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},__metadata$5=window&&window.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},logMethodCall$6=logMethodCallDecoratorCreator("OrgVideoNode"),OrgVideoNode=function(e){function t(t){var o=e.call(this,t)||this;return o._logger=new Logger(t.instanceId,"OrgVideoNode"),o}return __extends$7(t,e),t.prototype.onVideoEventCanplay=function(){var t;null===(t=this._canplayDefer)||void 0===t||t.resolve(),e.prototype.onVideoEventCanplay.call(this)},t.prototype.onVideoEventLoadedmetadata=function(){e.prototype.onVideoEventLoadedmetadata.call(this),(uaTool.os.ios||uaTool.browser.safari)&&[exports.PRELOAD_TYPE.META_DATA,exports.PRELOAD_TYPE.AUTO].includes(this._config.preloadType)&&this.onVideoEventCanplay()},t.prototype.onVideoEventLoadeddata=function(){e.prototype.onVideoEventLoadeddata.call(this),this.checkPlayInitSeek()},t.prototype.onVideoEventTimeUpdate=function(){e.prototype.onVideoEventTimeUpdate.call(this),this.checkPlayInitSeek()},t.prototype.onVideoEventLoadStart=function(){this.resolveWaitVideoLoadStartEvt()},t.prototype.load=function(e,t){var o=this;return!!e.loadingUrl&&(this.stopInner(!0),this._drm.init(e.config.drmConfig),this._videoInfo=e,this._videoInfo.extraVars.isLoadstarted=!0,this.setVideoEvents(!0),this.stateMgr.setLoadStart(),this.assignStartTime((null==t?void 0:t.startTime)||0),this._video.src=this._videoInfo.loadingUrl,this._logger.log("load(), loadingUrl=".concat(this._videoInfo.loadingUrl,", uid=").concat(this._videoInfo.uid)),this._config.preloadType===exports.PRELOAD_TYPE.AUTO_LOAD&&this._video.load(),this.setCheckLoadTimeoutEnable(!0),this._canplayDefer=new SimpleDefer,this.waitVideoLoadStartEvt().then((function(){o._logger.log("load(), video load succ...")})).catch((function(){o._logger.error("load(), video load cannot be trigger..."),o.onVideoEventCanplay()})),!0)},t.prototype.play=function(e,t){var o=this;this._logger.log("play(), uid=".concat(null==e?void 0:e.uid,"/idx=").concat(this.idx,"/state=").concat(this.state)),this._played=!0,e&&!e.extraVars.isLoadstarted&&this.load(e,t);var r=null;return uaTool.browser.safari&&this._canplayDefer?this._canplayDefer.promise.then((function(){o.videoplay()})):r=this.videoplay(),this.setMainLoopEnable(!0),r},t.prototype.assignStartTime=function(e){if(this._config.type!==exports.PLAY_MODE.LIVE){this._userStartTime=e;var t=!Number.isNaN(e)&&e>=0?e:0;t<=0||(videoTool.supportMediaFragmentsURISpec(this._config.enableMediaFragmentsURI)&&!this._videoInfo.loadingUrl.startsWith("blob:")?(this._logger.log("assignStartTime by #t"),this._videoInfo.setLoadingUrlStartTime(t)):(this._logger.log("assignStartTime with seek()"),this._needPlaySeektime=t))}},t.prototype.checkPlayInitSeek=function(){this._needPlaySeektime>0&&this._videoInfo&&this._video.duration>0&&(this._logger.log("checkPlayInitSeek(), idx=".concat(this.idx,"/seektime=").concat(this._needPlaySeektime)),this.seek(this._needPlaySeektime),this._needPlaySeektime=0)},t.prototype.stopInner=function(t,o){this._canplayDefer=null,this._needPlaySeektime=0,e.prototype.stopInner.call(this,t,o)},t.prototype.seek=function(e,t){void 0===t&&(t=!1);var o=e;return!!this.checkCanSeek(o,t)&&(o=this.adjustSeekTime(o),this._isUserSeek=t,this._logger.log("seek(), uid".concat(this._videoInfo.uid,"/idx=").concat(this.idx,"/time=").concat(o,"/duration=").concat(this._video.duration,"/")+"state=".concat(this.state)),this._targetSeekTime=o,this._video.currentTime=o,!0)},t.prototype.updateAccuratePlaytime=function(){e.prototype.updateAccuratePlaytime.call(this);var t=Math.abs(this._video.duration-this._video.currentTime),o=this._config.originKernelConfig.advanceEndTime;o>0&&t<=o&&(this._logger.log("setEndInner(), reason=leftTimeCheck"),this.setEndInner())},t.prototype.setEndInner=function(){this.state!==exports.VIDEO_STATE.END&&this.state!==exports.VIDEO_STATE.IDLE&&(this.onAccurateTimeupdate&&this.onAccurateTimeupdate(0),this.updatePlaytime(this._video.currentTime)),e.prototype.setEndInner.call(this)},t.prototype.waitVideoLoadStartEvt=function(){var e=this;this._waitVideoLoadStartEvtDefer=new SimpleDefer;return window.setTimeout((function(){"rejected"!==e._waitVideoLoadStartEvtDefer.state&&e._waitVideoLoadStartEvtDefer.reject()}),50),this._waitVideoLoadStartEvtDefer.promise},t.prototype.resolveWaitVideoLoadStartEvt=function(){this._waitVideoLoadStartEvtDefer&&this._waitVideoLoadStartEvtDefer.resolve()},__decorate$5([logMethodCall$6,__metadata$5("design:type",Function),__metadata$5("design:paramtypes",[Object,Object]),__metadata$5("design:returntype",void 0)],t.prototype,"load",null),__decorate$5([logMethodCall$6,__metadata$5("design:type",Function),__metadata$5("design:paramtypes",[Object,Object]),__metadata$5("design:returntype",void 0)],t.prototype,"play",null),__decorate$5([logMethodCall$6,__metadata$5("design:type",Function),__metadata$5("design:paramtypes",[Boolean,Object]),__metadata$5("design:returntype",void 0)],t.prototype,"stopInner",null),__decorate$5([logMethodCall$6,__metadata$5("design:type",Function),__metadata$5("design:paramtypes",[Number,Object]),__metadata$5("design:returntype",void 0)],t.prototype,"seek",null),t}(BaseVideoNode),__extends$6=window&&window.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),__decorate$4=window&&window.__decorate||function(e,t,o,r){var n,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,o,a):n(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},__metadata$4=window&&window.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},logMethodCall$5=logMethodCallDecoratorCreator("OrgIOSVideoNode"),PAUSE_TIME_THRESHOLD=5e3,OrgIOSVideoNode=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.lastPausePlayTime=null,t.lastPauseTimeStamp=null,t.disableSeekEvt=!1,t}return __extends$6(t,e),Object.defineProperty(t,"shouldUseResumeFix",{get:function(){return uaTool.os.ios&&comTool.compareVersion(uaTool.os.version,"15.0")>=0},enumerable:!1,configurable:!0}),t.prototype.setLevel=function(t){return void 0===t&&(t=SET_LEVEL_MODE.HARD),this.clearPauseMemTime(),e.prototype.setLevel.call(this,t)},t.prototype.onVideoEventPause=function(){return this.isOriginHlsPlaying()&&(this.lastPausePlayTime=this._video.currentTime,this.lastPauseTimeStamp=Date.now()),e.prototype.onVideoEventPause.call(this)},t.prototype.onVideoEventSeeking=function(){if(this.clearPauseMemTime(),!this.disableSeekEvt)return e.prototype.onVideoEventSeeking.call(this)},t.prototype.onVideoEventSeeked=function(){this.disableSeekEvt?this.disableSeekEvt=!1:e.prototype.onVideoEventSeeked.call(this)},t.prototype.onVideoEventPlaying=function(){return t.shouldUseResumeFix&&this.lastPausePlayTime&&Date.now()-this.lastPauseTimeStamp>PAUSE_TIME_THRESHOLD&&(this.disableSeekEvt=!0,this._video.currentTime=this.lastPausePlayTime),this.clearPauseMemTime(),e.prototype.onVideoEventPlaying.call(this)},t.prototype.clearPauseMemTime=function(){this.lastPausePlayTime=null,this.lastPauseTimeStamp=null},t.prototype.isOriginHlsPlaying=function(){var e=this.currentVideoInfo.loadingUrl;return fileExtension2VideoType(urlTool.getFileExtension(e))===VIDEO_TYPE.HLS},__decorate$4([logMethodCall$5,__metadata$4("design:type",Function),__metadata$4("design:paramtypes",[Object]),__metadata$4("design:returntype",void 0)],t.prototype,"setLevel",null),t}(OrgVideoNode),__awaiter$4=window&&window.__awaiter||function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},__generator$4=window&&window.__generator||function(e,t){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};function detectStream(e){return __awaiter$4(this,void 0,void 0,(function(){var t,o,r,n,i,a,s,l,c,p;return __generator$4(this,(function(d){switch(d.label){case 0:t={httpCode:-1},d.label=1;case 1:return d.trys.push([1,3,,4]),[4,netTool.xhr({url:e,retryCount:0,responseType:"arraybuffer",range:[0,102400]})];case 2:o=d.sent(),r=o.data,p=o.target,n=o.startTimestamp,t.httpCode=p.status,i=r.byteLength/1024,a=(+new Date-n)/1e3,t.downloadSpeed="".concat(Math.floor(i/a),"kb/s");try{t.headers=p.getAllResponseHeaders()}catch(e){}return[3,4];case 3:return s=d.sent(),c=(l=s||{}).error,p=l.target,t.httpCode=null==p?void 0:p.status,t.error=c,[3,4];case 4:return[2,t]}}))}))}function runValidators(e,t,o){var r;return void 0===o&&(o=null),e.length?(e.every((function(e){return(r=t.call(o,e)||EMPTY_VALIDATE_RESULT).isValid})),r):VALIDATE_PASS_RESULT}var VALIDATE_PASS_RESULT={isValid:!0,message:""},EMPTY_VALIDATE_RESULT={isValid:!1,message:"Validator does not return anything."},i18nCore=i18nConfig.core,CheckPlayerStatus=function(){function e(e){var t=this;this.setLevelValidator={NOT_INITIALIZED:function(){return t.player?VALIDATE_PASS_RESULT:{isValid:!1,message:compile(i18nCore.ERROR_STATUS_NOT_INITIALIZED)}},NOT_PLAYING:function(){return t.player.played?VALIDATE_PASS_RESULT:{isValid:!1,message:compile(i18nCore.ERROR_STATUS_NOT_PLAYING)}},EMPTY_URL:function(e){return e?VALIDATE_PASS_RESULT:{isValid:!1,message:compile(i18nCore.ERROR_STATUS_EMPTY_URL)}},EMPTY_VIDEO_INFO:function(){return t.player.currentVideoInfo?VALIDATE_PASS_RESULT:{isValid:!1,message:compile(i18nCore.ERROR_STATUS_VIDEO_INFO)}},PLAYTIME_CHECK:function(){return t.player.currentVideoInfo.playtime<=0?{isValid:!1,message:compile(i18nCore.ERROR_STATUS_PLAYTIME_CHECK)}:VALIDATE_PASS_RESULT},CLOSE_TO_END:function(){var e=t.player.currentVideoInfo;return t.player.config.type===exports.PLAY_MODE.VOD&&e.playtime+1>=e.duration&&e.duration!==1/0?{isValid:!1,message:compile(i18nCore.ERROR_STATUS_CLOSE_TO_END)}:VALIDATE_PASS_RESULT},TARGET_NOT_CHANGE:function(e){return e===t.player.currentVideoInfo.loadingUrl?{isValid:!1,message:compile(i18nCore.ERROR_STATUS_TARGET_UNCHANGED)}:VALIDATE_PASS_RESULT}},this.player=e}return e.prototype.checkSetLevelMode=function(e,t){return e<2?SET_LEVEL_MODE.HARD:t||SET_LEVEL_MODE.SOFT},e.prototype.checkCanAppend=function(e){if(!this.player||!this.player.config)return{canAppend:!1,message:"BasePlayer or basePlayer.config is null"};if(!this.player.config.isPlayList)return{canAppend:!1,message:"Only supported when [isPlayList] is true"};if(!this.player.played)return{canAppend:!1,message:"Player has not been played"};var t=checkUrlConfigVailed(e,this.player.kernelName);return t?{canAppend:!1,message:"urlconfig err=".concat(t)}:{canAppend:!0,message:"Can append video now"}},e.prototype.checkCanPreloadEnvi=function(e){var t=this.checkCanAppend(e);return t.canAppend?this.player.supportPreload?{canPreload:!0,message:"Can preload video now"}:{canPreload:!1,message:"preloadNext() fail, browser not support preload."}:{canPreload:!1,message:t.message}},e.prototype.checkCanPreloadEachConfig=function(e){if(!this.player||!this.player.videoInfos)return{canPreload:!1,message:"preloadInner() fail, because player or videoInfo is null."};var t=this.player.videoInfos.findIndex((function(t){return compareUrlConfig(t.config,e)}));return-1!==t&&t<=this.player.curUrlIdx?{canPreload:!1,message:"preloadInner() fail, because this videoInfo has been played."}:-1!==t&&t>this.player.curUrlIdx+1?{canPreload:!1,message:"preloadInner() fail, can not skip next to preload."}:this.player.nextVideoInfo&&!compareUrlConfig(this.player.nextVideoInfo.config,e)?{canPreload:!1,message:"preloadInner() fail, the next has been appended, you only can preload next."}:-1!==this.player.preloadVideoInfos.findIndex((function(t){return compareUrlConfig(t.config,e)}))?{canPreload:!1,message:"preloadInner() fail, the VideoInfo has been preloaded."}:{canPreload:!0,message:"Can preload video now"}},e.prototype.checkSetLevelError=function(e){var t=runValidators(Object.values(this.setLevelValidator),(function(t){return t(e)}));return t.isValid?null:t.message},e.prototype.checkCanPlayNext=function(){return this.player&&this.player.videoInfos?this.player.played?this.player.nextVideoInfo?{canPlayNext:!0,message:"checkPlayNext(), curUrlIdx=".concat(this.player.curUrlIdx,"/urlLength=").concat(this.player.videoInfos.length,"/")+"nextStartTime: ".concat(this.player.nextVideoInfo.playtime)}:{canPlayNext:!1,message:"Playlist over>>>, total len: ', ".concat(this.player.videoInfos.length)}:{canPlayNext:!1,message:"Player has not been played"}:{canPlayNext:!1,message:"Player or player.videoInfo is null"}},e.prototype.checkAutoPreloadNext=function(e){if(!this.player||!this.player.currentVideoInfo)return{canPreload:!1,message:"Player or player.currentVideoInfo is null"};if(!this.player.nextVideoInfo||-1!==this.player.preloadVideoInfos.indexOf(this.player.nextVideoInfo))return{canPreload:!1,message:"nextVideoInfo is null or nextVideoInfo is already preload now"};var t=this.player.currentVideoInfo.config.autoPreloadLeftTime;return t<=0?{canPreload:!1,message:"Can not preload,autoPreloadLeftTime <= 0"}:t>=this.player.currentVideoInfo.duration&&this.player.currentVideoInfo.playtime>0||t>=e?{canPreload:!0,message:"Can preload now"}:{canPreload:!1,message:"Can not preload,autoPreloadLeftTime is illegal"}},e.prototype.destroy=function(){this.player=null},e}(),__awaiter$3=window&&window.__awaiter||function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},__generator$3=window&&window.__generator||function(e,t){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},ScreenWakeLock=function(){function e(){this.wakeLock=null}return Object.defineProperty(e.prototype,"isAlive",{get:function(){return!!this.wakeLock},enumerable:!1,configurable:!0}),e.prototype.keepAlive=function(e){return e?this.requestWakeLock():this.realseWakeLock()},e.prototype.requestWakeLock=function(){return __awaiter$3(this,void 0,void 0,(function(){var e;return __generator$3(this,(function(t){switch(t.label){case 0:if(this.wakeLock)return[2];t.label=1;case 1:return t.trys.push([1,3,,4]),e=this,[4,window.navigator.wakeLock.request("screen")];case 2:return e.wakeLock=t.sent(),[3,4];case 3:return t.sent(),this.wakeLock=null,[3,4];case 4:return[2]}}))}))},e.prototype.realseWakeLock=function(){return __awaiter$3(this,void 0,void 0,(function(){return __generator$3(this,(function(e){return this.wakeLock?(this.wakeLock.release(),this.wakeLock=null,[2]):[2]}))}))},e}(),__assign$5=window&&window.__assign||function(){return __assign$5=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},__assign$5.apply(this,arguments)},GUID_LEN=8,VideoInfo=function(){function e(e,t){this.playtime=0,this.currentAudioTrack=NaN,this.duration=0,this.performance={},this.startTime=0,this.state=exports.VIDEO_STATE.IDLE,this.fileSize=0,this.videoWidth=0,this.videoHeight=0,this.hasFirstPlaying=!1,this.startPts=0,this.discontinuityTimeRanges=[],this.videoFrameRate=0,this.audioTracks=[],this.currentLevelIndex=-1,this.levels=[],this.currentLevel=null,this.isAutoLevel=!1,this.stateWhenErrorHappen=null,this._logger=new Logger(t.instanceId,"VideoInfo"),this._extraVars={},this._qualityInfo={},this._uid=comTool.createGUID(GUID_LEN),this._config=e,this._playerConfig=t,this.codecs=this._config.codec?__assign$5({},this._config.codec):{video:"",audio:""},this.reset(),this._logger.log("new VideoInfo(), uid: ".concat(this.uid))}return e.prototype.toJSON=function(){return this.serializedString()},e.prototype.toString=function(){return this.serializedString()},Object.defineProperty(e.prototype,"config",{get:function(){return this._config},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"qualityInfo",{get:function(){return this._qualityInfo},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uid",{get:function(){return this._uid},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"loadingUrl",{get:function(){return this._loadingUrl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"extraVars",{get:function(){return this._extraVars},enumerable:!1,configurable:!0}),e.prototype.reset=function(){this._nextBackUrlIdx=0,this._retryCount=0,this.performance={},this._loadingUrl=this._config.url,this.audioTracks=[]},e.prototype.setLoadingUrlStartTime=function(e){this._loadingUrl&&e>0&&(this._loadingUrl="".concat(this._loadingUrl.split("#t=")[0],"#t=").concat(e))},e.prototype.setDependVideoInfo=function(e){return this.startTime=e?e.startTime+e.duration:0,this._logger.log("setDependVideoInfo succ, uid/starttime: ".concat(this.uid,"/").concat(this.startTime)),!0},e.prototype.setNextBackUrl=function(){return!(!this._config.url||this._retryCount>=this._playerConfig.backupUrlsMaxRetryCount)&&(this._retryCount++,this._config.backupUrls&&this._config.backupUrls.length>0?this._nextBackUrlIdx>=this._config.backupUrls.length?(this._loadingUrl=this._config.url,this._nextBackUrlIdx=0):(this._loadingUrl=this._config.backupUrls[this._nextBackUrlIdx],this._nextBackUrlIdx++):this._loadingUrl=this._config.url,!0)},e.prototype.getRetryCount=function(){return this._retryCount},e.prototype.destroy=function(){this._extraVars=null},e.prototype.serializedString=function(){var e,t;return"VideoInfo{u:".concat(this._loadingUrl,",t:").concat(this.playtime,",s:").concat(this.state,",ec:").concat((null===(e=this.error)||void 0===e?void 0:e.code)||"",",em:").concat((null===(t=this.error)||void 0===t?void 0:t.message)||"",",r:").concat(this._nextBackUrlIdx,"}")},e}(),__extends$5=window&&window.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),__assign$4=window&&window.__assign||function(){return __assign$4=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},__assign$4.apply(this,arguments)},__decorate$3=window&&window.__decorate||function(e,t,o,r){var n,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,o,a):n(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},__metadata$3=window&&window.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter$2=window&&window.__awaiter||function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},__generator$2=window&&window.__generator||function(e,t){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},__spreadArray$2=window&&window.__spreadArray||function(e,t,o){if(o||2===arguments.length)for(var r,n=0,i=t.length;n<i;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))},logMethodCall$4=logMethodCallDecoratorCreator("BasePlayer"),BasePlayer=function(e){function t(t){var o,r=e.call(this)||this;return r._firstPlaying=!1,r._hasUserGestures=!1,r._volume=1,r._playbackRate=1,r._playBlocking=!1,r.lastVideoInfo=null,r._logger=new Logger(t.instanceId,"BasePlayer"),r._config=t,r._videoInfos=[],r._curUrlIdx=-1,r._curVideoNode=null,r._preloaders=[],r._vnList=[],r._eventMap={videonode:r.videonodeEventHandler.bind(r),document:r.visibilityChangeHandler.bind(r)},r._played=!1,r.videoEvtHandlerMap=((o={})[VIDEO_NODE_EVENT.STATE_CHANGE]=r.onVideoNodeStateChange.bind(r),o[VIDEO_NODE_EVENT.PLAY_PROMISE_CATCHED]=r.onVideoNodePlayPromiseCatched.bind(r),o[VIDEO_NODE_EVENT.FIRST_PLAYING]=r.onVideoNodeFirstPlaying.bind(r),o[VIDEO_NODE_EVENT.PLAY_OVER]=r.onVideoNodePlayOver.bind(r),o[VIDEO_NODE_EVENT.ERROR]=r.onVideoNodeError.bind(r),o),r.screenWakeLock=new ScreenWakeLock,r.playerStatusChecker=new CheckPlayerStatus(r),document.addEventListener("visibilitychange",r._eventMap.document),r._config.createVideoNodeWhenLoad||r.createVideoNodes(r._config.maxVideoNodeCount),r}return __extends$5(t,e),t.prototype.load=function(e,t){return __awaiter$2(this,void 0,void 0,(function(){return __generator$2(this,(function(o){return!e||e instanceof Array&&e.length<=0?(this.clearBeforeLoad(),[2]):(this.loadInner(e,t),[2])}))}))},t.prototype.play=function(e,t){return __awaiter$2(this,void 0,void 0,(function(){return __generator$2(this,(function(o){switch(o.label){case 0:return this.state!==exports.VIDEO_STATE.IDLE||e?(this._checkPlayBlocked=!0,this._vnList.length<=1||this._hasUserGestures?(this._logger.log("play(), skip triggerAutoplay()."),this.triggerPlayResolve(e,t),[3,4]):[3,1]):(this._logger.warn("play(), no urlConfig when idle state"),[2]);case 1:return o.trys.push([1,3,,4]),[4,this.triggerAutoplay()];case 2:return o.sent(),this.triggerPlayResolve(e,t),[3,4];case 3:return o.sent(),this._config.type===exports.PLAY_MODE.VOD&&e&&this.loadInner(e,t),[3,4];case 4:return[2]}}))}))},t.prototype.triggerAutoplay=function(){var e=this;if(this._triggerAutoplayPromise)return this._triggerAutoplayPromise;this._logger.log("triggerAutoplay(), start");for(var t=[],o=this._vnList.length,r=0;r<o;r++){var n=this._vnList[r].triggerAutoplay();t.push(n)}return this._triggerAutoplayPromise=Promise.all(t),this._triggerAutoplayPromise.catch((function(t){e._logger.log("play() triggerAutoplay catched: ",t),e.playBlocked()})),this._triggerAutoplayPromise},t.prototype.seek=function(e){var t;return this.state!==exports.VIDEO_STATE.IDLE&&(!(e<0||!(null===(t=this._curVideoNode)||void 0===t?void 0:t.currentVideoInfo))&&this._curVideoNode.seek(e,!0))},t.prototype.pause=function(e){this._played?this.pauseInner(e||PAUSE_TYPE.USER):this._logger.warn("pause(), player has not been played")},t.prototype.stop=function(e){void 0===e&&(e=exports.END_STATE.INTERRUPT),this.state!==exports.VIDEO_STATE.IDLE&&this.stopInner(e,!0)},t.prototype.setLevel=function(e,t,o){var r;"string"==typeof e?r=e:(r=e.url,t=e.backupUrls,o=e);var n=this.playerStatusChecker.checkSetLevelError(r);return n?(this._logger.warn("setLevel(), ".concat(n)),Promise.reject(new Error(n))):(this._urlBeforeSetLevel={url:r,backupUrls:t},this.currentVideoInfo.config.url=r,t&&(this.currentVideoInfo.config.backupUrls=t),o&&(Object.assign(this._urlBeforeSetLevel,o),Object.assign(this.currentVideoInfo.config,o)),this.currentVideoInfo.reset(),this.setLevelInner(this.currentVideoInfo.config))},t.prototype.appendNext=function(e){var t=this.playerStatusChecker.checkCanAppend(e);if(!t.canAppend)return this._logger.warn(t.message),!1;var o=this._videoInfos.find((function(t){return compareUrlConfig(t.config,e)}));if(o)return this._logger.warn("appendNext(), duplicate append! uid[".concat(o.uid,"]")),!1;var r=this.preloadVideoInfos.find((function(t){return compareUrlConfig(t.config,e)}));return r||(r=new VideoInfo(e,this._config)),this.clearAllPreloadInner(r),this._videoInfos=this._videoInfos.slice(0,this._curUrlIdx+1),this._videoInfos=this._videoInfos.concat(r),this._logger.log("appendNext() succ, appendVideoInfo=",r),this.emit(exports.PLAY_EVENT.LIST_CHANGE),this.appendAfter(r),!0},t.prototype.preloadNext=function(){for(var e=this,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];var r=this.playerStatusChecker.checkCanPreloadEnvi(t);if(!r.canPreload)return this._logger.warn(r.message),!1;var n=[];return t.forEach((function(t){var o=e.playerStatusChecker.checkCanPreloadEachConfig(t);o.canPreload?e.nextVideoInfo&&compareUrlConfig(t,e.nextVideoInfo.config)?n.push(e.nextVideoInfo):n.push(new VideoInfo(t,e._config)):e._logger.warn(o.message)})),this.preloadInner.apply(this,__spreadArray$2([!1,{startTime:0,kernelName:this.kernelName}],n,!1)),!0},t.prototype.clearAllPreload=function(){this.clearAllPreloadInner()},t.prototype.playNext=function(e){this._played?this.playNextInner({isInterrupt:!0}):this._logger.warn("playNext(), player has not been played")},t.prototype.hasAppended=function(e){return!!this._videoInfos.find((function(t){return compareUrlConfig(t.config,e)}))},t.prototype.hasPreloaded=function(e){return!!this.preloadVideoInfos.find((function(t){return compareUrlConfig(t.config,e)}))},t.prototype.setAudioTrack=function(e){return Promise.reject(AUDIO_TRACK_ERROR_MSG.NOT_SUPPORT)},t.prototype.getAudioTrackList=function(){return this.currentVideoInfo?this.currentVideoInfo.audioTracks:[]},t.prototype.getCurrentAudioTrack=function(){return this.currentVideoInfo?this.currentVideoInfo.currentAudioTrack:NaN},t.prototype.resizeVideoElements=function(e){var t=this.videoElements;!e||!t||t.length<=0||(t.forEach((function(t){videoTool.resizeElement(t,e)})),this.emit(exports.PLAY_EVENT.RESIZE,e))},t.prototype.resize=function(e){this.resizeVideoElements(e)},t.prototype.captureVideo=function(e,t,o,r,n){var i,a=this.currentVideoElement;if(a){if(a instanceof HTMLVideoElement)try{var s=videoTool.captureVideo(a,{dx:e,dy:t,dw:o,dh:r});return Promise.resolve(s)}catch(e){return Promise.reject(e)}return null===(i=a.captureVideo)||void 0===i?void 0:i.call(a,e,t,o,r)}},t.prototype.destroy=function(){var e,t;if(this.stopInner(),this._vnList)for(var o=this._vnList.length,r=0;r<o;r++)this._vnList[r].destroy();this._preloaders&&(this._preloaders.forEach((function(e){e.clear()})),this._preloaders=null),document.removeEventListener("visibilitychange",this._eventMap.document),this.removeAllListeners(),null===(e=this.screenWakeLock)||void 0===e||e.keepAlive(!1),this.screenWakeLock=null,this._videoInfos=null,this._curVideoNode=null,this._vnList=null,this._eventMap=null,this.lastVideoInfo=null,null===(t=this.playerStatusChecker)||void 0===t||t.destroy(),this.playerStatusChecker=null},Object.defineProperty(t.prototype,"duration",{get:function(){return this._curVideoNode?this._curVideoNode.duration:0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playtime",{get:function(){return this._curVideoNode?this._curVideoNode.playtime:0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._curVideoNode?this._curVideoNode.state:exports.VIDEO_STATE.IDLE},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"played",{get:function(){return this._played},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(e){this._playbackRate=e;for(var t=this._vnList.length,o=0;o<t;o++)this._vnList[o].playbackRate=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportPlaybackRate",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportPreload",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"volume",{get:function(){return this._volume},set:function(e){this._volume=e;for(var t=this._vnList.length,o=0;o<t;o++)this._vnList[o].volume=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"useWorker",{get:function(){return!!this._curVideoNode&&this._curVideoNode.useWorker},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"videoElements",{get:function(){var e;return null===(e=this._vnList)||void 0===e?void 0:e.map((function(e){return e.videoElement}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentVideoElement",{get:function(){return this._curVideoNode?this._curVideoNode.videoElement:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"videoInfos",{get:function(){return this._videoInfos},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"preloadVideoInfos",{get:function(){return this._preloaders.map((function(e){return e.videoInfo}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"videoSize",{get:function(){return this._curVideoNode?this._curVideoNode.videoSize:{width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"videoBuffered",{get:function(){return this._curVideoNode?this._curVideoNode.videoBuffered:[{start:0,end:0}]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentVideoInfo",{get:function(){return this._curVideoNode?this._curVideoNode.currentVideoInfo:this.lastVideoInfo},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nextVideoInfo",{get:function(){return this._videoInfos[this._curUrlIdx+1]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentVideoInfoIdx",{get:function(){return this._curVideoNode?this._videoInfos.indexOf(this._curVideoNode.currentVideoInfo):-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalVideoInfoCount",{get:function(){return this._videoInfos.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"config",{get:function(){return this._config},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"curUrlIdx",{get:function(){return this._curUrlIdx},enumerable:!1,configurable:!0}),t.prototype.log=function(){for(var e,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];null===(e=this._logger)||void 0===e||e.log.apply(e,t)},t.prototype.loadInner=function(e,t){var o=this;this.clearBeforeLoad();var r=checkUrlConfigVailed(e,this.kernelName);if(r)return this.emit(exports.PLAY_EVENT.ERROR,{videoInfo:{error:r}}),!1;this._config.createVideoNodeWhenLoad&&(this._vnList.forEach((function(e){return e.destroy()})),this._vnList.length=0,this.createVideoNodes(this._config.maxVideoNodeCount)),this.emit(exports.PLAY_EVENT.RESTART);var n=(t||{}).startTime,i=void 0===n?0:n;this._videoInfos=[].concat(e).map((function(e){return new VideoInfo(e,o._config)})),this.emit(exports.PLAY_EVENT.LIST_CHANGE);var a=this._videoInfos[0];return this.preloadInner(!0,__assign$4(__assign$4({},t),{startTime:i,kernelName:this.kernelName}),a),!0},t.prototype.pauseInner=function(e){void 0===e&&(e=PAUSE_TYPE.INNER),this.state!==exports.VIDEO_STATE.PAUSE&&this._curVideoNode&&this._curVideoNode.pause(e)},t.prototype.resumeInner=function(){var e;this._played&&(null===(e=this._curVideoNode)||void 0===e?void 0:e.currentVideoInfo)&&(0===this._curVideoNode.duration||this._curVideoNode.playtime<this._curVideoNode.duration)&&this._curVideoNode.videoplay()},t.prototype.stopInner=function(e,t,o){var r;void 0===e&&(e=exports.END_STATE.NORMAL),void 0===t&&(t=!1),void 0===o&&(o=null),(null===(r=this._config)||void 0===r?void 0:r.type)===exports.PLAY_MODE.VOD&&this.clearAllPreloadInner();var n=this._videoInfos;if(this._videoInfos=[],this.lastVideoInfo=this.currentVideoInfo,this._vnList)for(var i=this._vnList.length,a=0;a<i;a++)this._vnList[a].stop(),this.setPlayEvents(this._vnList[a],!1);this._curUrlIdx=-1,n&&n.forEach((function(e){e.destroy()})),this._firstPlaying=!1,this._played=!1,this._curVideoNode=null;var s=null==o?void 0:o.error,l=s?exports.END_STATE.ERROR:e;this._logger.log("stopInner(), endState=".concat(l)),t&&(this.emit(exports.PLAY_EVENT.STOPED,{videoInfo:o,isUserStop:e===exports.END_STATE.INTERRUPT,endState:l}),s&&this.emit(exports.PLAY_EVENT.ERROR,{videoInfo:o}))},t.prototype.preloadInner=function(e,t){for(var o=[],r=2;r<arguments.length;r++)o[r-2]=arguments[r];var n=[],i=o.length;if(!(i<=0)){for(var a=0;a<i;a++)if(o[a]){this.clearPreloader(o[a]);var s=this.preparePreloader(e,o[a]);s&&(o[a].setDependVideoInfo(this.currentVideoInfo),s.load(e,this,o[a],t),n.push(s))}this._preloaders=this._preloaders.concat(n),this._logger.log("preload(), preloader's length: ",this._preloaders.length),n.length>0&&this.emit(exports.PLAY_EVENT.PRELOAD_START,{preloadVideoInfos:n.map((function(e){return e.videoInfo}))})}},t.prototype.playNextInner=function(e){var t=(e||{}).isInterrupt;this._logger.log("playNextInner(), curUrlIdx=".concat(this._curUrlIdx,"/")+"urlLength=".concat(this._videoInfos.length,"/isInterrupt=").concat(t));var o=Math.abs(this.playtime-this.duration)<=this._config.interruptPlayNextMinTime;if(t&&o&&this.state===exports.VIDEO_STATE.PLAYING)this._logger.log("playNextInner(), playNext right now! return!");else if(this._curUrlIdx+1>=this._videoInfos.length)this._logger.warn("There is no next VideoInfo.");else{this._curUrlIdx+=1,this.setPlayEvents(this._curVideoNode,!1),t&&this._curVideoNode.pause(PAUSE_TYPE.INNER);var r=this._videoInfos[this._curUrlIdx];this.clearAllPreloadInner(r),t&&this.emit(exports.PLAY_EVENT.VIDEONODE_PLAY_OVER,{videoInfo:this.currentVideoInfo}),this.playInner()}},t.prototype.clearAllPreloadInner=function(e){var t=this;!this._preloaders||this._preloaders.length<=0||this._preloaders.filter((function(t){return t.videoInfo!==e})).forEach((function(e){t.clearPreloader(e.videoInfo)}))},t.prototype.clearBeforeLoad=function(){var e;null===(e=this._vnList)||void 0===e||e.forEach((function(e){videoTool.clear(e.videoElement)})),this.stopInner(this._played?exports.END_STATE.INTERRUPT:exports.END_STATE.NORMAL,this._played,this._played?this.currentVideoInfo:null)},t.prototype.clearPreloader=function(e,t){if(this._preloaders&&!(this._preloaders.length<=0)&&e){var o=this.findPreloadIdxByVideoInfo(e);if(-1!==o)this._preloaders.splice(o,1)[0].clear(t)}},t.prototype.findPreloadIdxByVideoInfo=function(e){return e?this._preloaders.findIndex((function(t){return t.videoInfo===e})):-1},t.prototype.decideSetLevelMode=function(e){return this.playerStatusChecker.checkSetLevelMode(this._vnList.length,e)},t.prototype.createVideoNode=function(e){return uaTool.os.ios?new OrgIOSVideoNode(e):new OrgVideoNode(e)},t.prototype.createVideoNodes=function(e){for(var t=0;t<e;t++){var o=this.createVideoNode(this._config);o.idx=t,o.volume=this._volume,o.playbackRate=this._playbackRate,o.videoElement instanceof HTMLElement&&(o.videoElement.dataset.idx="".concat(t)),this._vnList.push(o)}},t.prototype.setPlayEvents=function(e,t){var o=this;e&&(t&&this.setPlayEvents(e,!1),this._logger.log("set VideoNode evts, idx=".concat(e.idx,"/isSet=").concat(t)),Object.keys(VIDEO_NODE_EVENT).forEach((function(r){(t?e.on:e.off).apply(e,[VIDEO_NODE_EVENT[r],o._eventMap.videonode])})))},t.prototype.videonodeEventHandler=function(e){this.logVideoNodeEvts(e);var t=!0;this.videoEvtHandlerMap[e.type]&&(t=this.videoEvtHandlerMap[e.type](e)),t&&e.type in videoEvt2PlayerEvtMap&&this.emit(videoEvt2PlayerEvtMap[e.type],e.data)},t.prototype.onVideoNodeStateChange=function(e){return e.data.new===exports.VIDEO_STATE.PAUSE&&e.data.pauseType===PAUSE_TYPE.INNER?(this._logger.log("inner pause does not emit event."),!1):(e.data.new===exports.VIDEO_STATE.PLAYING&&(this._checkPlayBlocked=!1),this.screenWakeLock.keepAlive(e.data.new===exports.VIDEO_STATE.PLAYING),!0)},t.prototype.onVideoNodePlayPromiseCatched=function(e){return this._checkPlayBlocked&&e.data.isAutoPlayBlocked&&(this._checkPlayBlocked=!1,this.playBlocked()),!0},t.prototype.onVideoNodeFirstPlaying=function(e){return this._firstPlaying||(this.emit(exports.PLAY_EVENT.FIRST_PLAYING,{videoInfo:this.currentVideoInfo}),this._firstPlaying=!0,this._hasUserGestures=!0),!0},t.prototype.onVideoNodePlayOver=function(e){if(this._config.isPlayList||this.nextVideoInfo)this.emit(exports.PLAY_EVENT.VIDEONODE_PLAY_OVER,{videoInfo:this.currentVideoInfo}),this.checkPlayNext();else{var t=this.currentVideoInfo;this.stopInner(exports.END_STATE.NORMAL,!0,t),this.emit(exports.PLAY_EVENT.VIDEONODE_PLAY_OVER,{videoInfo:t})}return!1},t.prototype.onVideoNodeError=function(e){var t=(e.data||{}).videoInfo;return this.stopInner(exports.END_STATE.ERROR,!0,t),!1},t.prototype.logVideoNodeEvts=function(e){var t,o;if(!(IGNORE_EVT_TYPE.includes(e.type)||e.type===VIDEO_NODE_EVENT.ELEMENT_EVTS&&IGNORE_VIDEO_EVT.includes(e.data.elementEvtType))){var r=e.data;e.type===VIDEO_NODE_EVENT.STATE_CHANGE?r="[".concat(e.data.old,"->").concat(e.data.new,"]"):e.type===VIDEO_NODE_EVENT.ELEMENT_EVTS&&(r="[elementEvtType=".concat(e.data.elementEvtType,"]")),this._logger.log("get VideoNode evt, type=".concat(e.type,"/uid=").concat(null===(o=null===(t=this._curVideoNode)||void 0===t?void 0:t.currentVideoInfo)||void 0===o?void 0:o.uid,"/data="),r)}},t.prototype.playBlocked=function(){var e=this;this._playBlocking=!0,this._triggerAutoplayPromise=null,setTimeout((function(){e.emit(exports.PLAY_EVENT.AUTOPLAY_BLOCKED,{videoInfo:e.currentVideoInfo})}),0),this.setLoading(!1)},t.prototype.checkPlayNext=function(){var e=this.playerStatusChecker.checkCanPlayNext();this._logger.log(e.message),e.canPlayNext&&this.playNextInner()},t.prototype.checkAutoPreloadNext=function(e){this.playerStatusChecker.checkAutoPreloadNext(e).canPreload&&this.preloadInner(!1,{startTime:0,kernelName:this.kernelName},this.nextVideoInfo)},t.prototype.setCurVideoNode=function(e,t){void 0===t&&(t=!1),(this._curVideoNode!==e||t)&&(this._curVideoNode&&(this._curVideoNode.onAccurateTimeupdate=null,this.setPlayEvents(this._curVideoNode,!1)),e&&(this._curVideoNode=e,this._curVideoNode.onAccurateTimeupdate=this.checkAccuratePlaytime.bind(this),this.setPlayEvents(this._curVideoNode,!0)))},t.prototype.detectSourceOnError=function(e){var t=this,o=e||{},r=o.loadingUrl,n=o.uid;r?detectStream(r).then((function(e){t._logger.error("detectSourceOnError=".concat(jsonTool.safelyStringify(__assign$4({uid:n},e))))})).catch((function(e){t._logger.error("detectSourceOnError err",null==e?void 0:e.message)})):this._logger.error("detectSourceOnError, url=null")},t.prototype.setLoading=function(e){this.emit(exports.PLAY_EVENT.SET_LOADING,{show:e})},t.prototype.visibilityChangeHandler=function(){this.screenWakeLock.keepAlive(this.state===exports.VIDEO_STATE.PLAYING)},t.prototype.triggerPlayResolve=function(e,t){var o=this;if(!e)return this._played?this._playBlocking||videoTool.cannotDetectAutoPlayBlock()?(this._playBlocking=!1,void setTimeout((function(){var e,t;(null===(t=null===(e=o._curVideoNode)||void 0===e?void 0:e.videoBuffered)||void 0===t?void 0:t.length)<=0&&o.setLoading(!0),o.resumeInner()}),0)):void(-1===[exports.VIDEO_STATE.PAUSE,exports.VIDEO_STATE.CANPLAY,exports.VIDEO_STATE.SEEKED].indexOf(this.state)?this._logger.log("play() has been called, but cannot do nothing."):this.resumeInner()):(this.setLoading(!0),void this.triggerPlayAfterLoad());this.loadInner(e,t)&&(this.setLoading(!0),this.triggerPlayAfterLoad())},t.prototype.triggerPlayAfterLoad=function(){this._played||-1!==this._curUrlIdx||this._videoInfos[0]&&(this._played=!0,this._curUrlIdx=0,this.playInner())},__decorate$3([logMethodCall$4,__metadata$3("design:type",Function),__metadata$3("design:paramtypes",[Object,Object]),__metadata$3("design:returntype",Promise)],t.prototype,"load",null),__decorate$3([logMethodCall$4,__metadata$3("design:type",Function),__metadata$3("design:paramtypes",[Object,Object]),__metadata$3("design:returntype",Promise)],t.prototype,"play",null),__decorate$3([logMethodCall$4,__metadata$3("design:type",Function),__metadata$3("design:paramtypes",[Number]),__metadata$3("design:returntype",void 0)],t.prototype,"seek",null),__decorate$3([logMethodCall$4,__metadata$3("design:type",Function),__metadata$3("design:paramtypes",[String]),__metadata$3("design:returntype",void 0)],t.prototype,"stop",null),__decorate$3([logMethodCall$4,__metadata$3("design:type",Function),__metadata$3("design:paramtypes",[Object,Array,Object]),__metadata$3("design:returntype",Promise)],t.prototype,"setLevel",null),__decorate$3([logMethodCall$4,__metadata$3("design:type",Function),__metadata$3("design:paramtypes",[Object]),__metadata$3("design:returntype",void 0)],t.prototype,"appendNext",null),__decorate$3([logMethodCall$4,__metadata$3("design:type",Function),__metadata$3("design:paramtypes",[Object]),__metadata$3("design:returntype",void 0)],t.prototype,"preloadNext",null),__decorate$3([logMethodCall$4,__metadata$3("design:type",Function),__metadata$3("design:paramtypes",[Object]),__metadata$3("design:returntype",void 0)],t.prototype,"playNext",null),__decorate$3([logMethodCall$4,__metadata$3("design:type",Function),__metadata$3("design:paramtypes",[Object]),__metadata$3("design:returntype",Promise)],t.prototype,"setAudioTrack",null),__decorate$3([logMethodCall$4,__metadata$3("design:type",Function),__metadata$3("design:paramtypes",[Object]),__metadata$3("design:returntype",void 0)],t.prototype,"resizeVideoElements",null),__decorate$3([logMethodCall$4,__metadata$3("design:type",Function),__metadata$3("design:paramtypes",[]),__metadata$3("design:returntype",void 0)],t.prototype,"destroy",null),__decorate$3([logMethodCall$4,__metadata$3("design:type",Function),__metadata$3("design:paramtypes",[]),__metadata$3("design:returntype",void 0)],t.prototype,"resumeInner",null),__decorate$3([logMethodCall$4,__metadata$3("design:type",Function),__metadata$3("design:paramtypes",[String,Object,Object]),__metadata$3("design:returntype",void 0)],t.prototype,"stopInner",null),__decorate$3([logMethodCall$4,__metadata$3("design:type",Function),__metadata$3("design:paramtypes",[Boolean,Object,Object]),__metadata$3("design:returntype",void 0)],t.prototype,"preloadInner",null),__decorate$3([logMethodCall$4,__metadata$3("design:type",Function),__metadata$3("design:paramtypes",[Object]),__metadata$3("design:returntype",void 0)],t.prototype,"playNextInner",null),__decorate$3([logMethodCall$4,__metadata$3("design:type",Function),__metadata$3("design:paramtypes",[]),__metadata$3("design:returntype",void 0)],t.prototype,"playBlocked",null),__decorate$3([logMethodCall$4,__metadata$3("design:type",Function),__metadata$3("design:paramtypes",[]),__metadata$3("design:returntype",void 0)],t.prototype,"checkPlayNext",null),t}(s),__assign$3=window&&window.__assign||function(){return __assign$3=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},__assign$3.apply(this,arguments)},defaultOriginKernelConfig={maxVideoNodeCount:1,advanceEndTime:0,prePlayNextTime:0};function mergeKernelConfig(e){return __assign$3(__assign$3({},e),{originKernelConfig:__assign$3(__assign$3({},defaultOriginKernelConfig),e.originKernelConfig)})}var __decorate$2=window&&window.__decorate||function(e,t,o,r){var n,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,o,a):n(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},__metadata$2=window&&window.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},logMethodCall$3=logMethodCallDecoratorCreator("OrgPreLoader"),OrgPreLoader=function(){function e(e){var t;this.playerConfig=e,this._defer=new SimpleDefer,this._logger=new Logger(e.instanceId,"OrgPreLoader"),this._evtMaps=((t={})[VIDEO_NODE_EVENT.STATE_CHANGE]=this.firstLoadStateChangeHandler.bind(this),t[VIDEO_NODE_EVENT.ERROR]=this.errorHandler.bind(this),t)}return Object.defineProperty(e.prototype,"promise",{get:function(){return this._defer.promise},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"videoInfo",{get:function(){return this._videoInfo},enumerable:!1,configurable:!0}),e.prototype.getVideoNode=function(){var e;return null===(e=this._videoInfo)||void 0===e?void 0:e.extraVars.preloadVideoNode},e.prototype.errorHandler=function(e){this.preloadFail(e.data.videoInfo.error)},e.prototype.firstLoadStateChangeHandler=function(e){e.data.new===exports.VIDEO_STATE.CANPLAY&&this.preloadSucc()},e.prototype.preloadSucc=function(){this._logger.log("preload url ready>>>>>> uid=".concat(this._videoInfo.uid)),this.clearInner(!0),this._evtDispatcher.emit(exports.PLAY_EVENT.PRELOAD_VIDEONODE_OVER,{videoInfo:this._videoInfo}),this._defer.resolve()},e.prototype.preloadFail=function(e){this._logger.log("preload url fail>>>>>> uid: ".concat(this._videoInfo.uid)),this.clearInner(),this._evtDispatcher.emit(exports.PLAY_EVENT.PRELOAD_VIDEONODE_ERROR,{videoInfo:this._videoInfo}),this._videoInfo.error=e,this._defer.reject(e)},e.prototype.setVideoNodeEvents=function(e){var t=this,o=this.getVideoNode();Object.keys(this._evtMaps).forEach((function(r){e?o.on(r,t._evtMaps[r]):o.off(r,t._evtMaps[r])}))},e.prototype.load=function(e,t,o,r){this._videoInfo=o,this._evtDispatcher=t,this.setVideoNodeEvents(!0),this._logger.log("load(), isFirstLoad=".concat(e)),this.getVideoNode().load(o,r)},e.prototype.clearInner=function(e,t){if(this._videoInfo){var o=this.getVideoNode();o&&(this._logger.log("clear(), uid=".concat(this._videoInfo.uid,"/keep=").concat(e)),this.setVideoNodeEvents(!1),e||(this._videoInfo.extraVars.preloadVideoNode=null,o.stop()),t&&this._evtDispatcher.emit(exports.PLAY_EVENT.PRELOAD_VIDEONODE_CLEAR,{videoInfo:this._videoInfo}))}},e.prototype.clear=function(e){this.clearInner(e,!0)},__decorate$2([logMethodCall$3,__metadata$2("design:type",Function),__metadata$2("design:paramtypes",[Boolean,s,Object,Object]),__metadata$2("design:returntype",void 0)],e.prototype,"load",null),__decorate$2([logMethodCall$3,__metadata$2("design:type",Function),__metadata$2("design:paramtypes",[Boolean]),__metadata$2("design:returntype",void 0)],e.prototype,"clear",null),e}(),__extends$4=window&&window.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),__decorate$1=window&&window.__decorate||function(e,t,o,r){var n,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,o,a):n(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},__metadata$1=window&&window.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},logMethodCall$2=logMethodCallDecoratorCreator("MultiPlayer"),MultiPlayer=function(e){function t(t){var o,r=e.call(this,mergeKernelConfig(t))||this;return r._needHideVideoNode=null,r._videonodeEventMap=((o={})[VIDEO_NODE_EVENT.STATE_CHANGE]=r.onCurVideoNodeStateChange.bind(r),o),r}return __extends$4(t,e),Object.defineProperty(t,"canPlayType",{get:function(){return videoTool.supportVideoFormat()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportPreload",{get:function(){return videoTool.supportSameTimePlay()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"kernelName",{get:function(){return exports.KERNEL_NAME.ORIGIN},enumerable:!1,configurable:!0}),t.prototype.seek=function(t){return!this.getLevelSwitching()&&e.prototype.seek.call(this,t)},t.prototype.createVideoNodes=function(t){e.prototype.createVideoNodes.call(this,t);for(var o=0;o<this._vnList.length;o++){var r=this._vnList[o];0===o?this._firstVideoNode=r:this.visibleVideoNode(r,!1)}},t.prototype.videonodeEventHandler=function(t){this._videonodeEventMap[t.type]&&this._videonodeEventMap[t.type](t),e.prototype.videonodeEventHandler.call(this,t)},t.prototype.onCurVideoNodeStateChange=function(e){if(e.data.new===exports.VIDEO_STATE.PLAYING&&(this.switchVideoNode(),!this.currentVideoInfo.extraVars.isStartPlay)){this.currentVideoInfo.extraVars.isStartPlay=!0;var t=this.currentVideoInfo?this.currentVideoInfo.uid:null;this._logger.log("videoNodeStartPlay: uid[".concat(t,"]")),this.emit(exports.PLAY_EVENT.VIDEONODE_START_PLAY,{videoInfo:this.currentVideoInfo})}},t.prototype.onVideoNodeStateChange=function(t){return!(this.getLevelSwitching()&&!VALID_STATE_IN_LEVEL_SWITCHING.includes(t.data.new))&&e.prototype.onVideoNodeStateChange.call(this,t)},t.prototype.pauseInner=function(t){void 0===t&&(t=PAUSE_TYPE.INNER),this._prePlayNext?this._logger.warn("pause when preplaynext, return!!"):e.prototype.pauseInner.call(this,t)},t.prototype.resumeInner=function(){this.getLevelSwitching()?this._setLevelVideoNode.play():e.prototype.resumeInner.call(this)},t.prototype.loadInner=function(t,o){for(var r,n=(null===(r=this._vnList)||void 0===r?void 0:r.length)||0,i=0;i<n;i++)this.visibleVideoNode(this._vnList[i],!1);return e.prototype.loadInner.call(this,t,o)},t.prototype.playInner=function(e){if(this.checkBeforePlay()){this.playStartTime=e;var t=this._videoInfos[this._curUrlIdx],o=this.findPreloadIdxByVideoInfo(t);-1!==o?this.preloadToPlay(t,o):t.error?(this._logger.log("play(), got preload error"),this.stopInner(exports.END_STATE.ERROR,!0,t)):this.enterVideoNodePlay(t)}},t.prototype.visibleVideoNode=function(e,t){var o;e&&e.videoElement&&(this.setVideoElementState(e.videoElement,t),this._logger.log(">>>visibleVideoNode<<<, value=".concat(t,"/uid=").concat(null===(o=e.currentVideoInfo)||void 0===o?void 0:o.uid)))},t.prototype.setVideoElementState=function(e,t){var o=t?this._volume:0;e.volume!==o&&(e.volume=o);var r=this._volume<=0||!t;e.muted!==r&&(e.muted=r),domTool.css(e,"zIndex",t?"0":"-1"),domTool.css(e,"visibility",t?"inherit":"hidden")},t.prototype.switchVideoNode=function(){if(this._needHideVideoNode&&this._curVideoNode!==this._needHideVideoNode){this._logger.log(">>>>>switchVideoNode<<<<<"),this.visibleVideoNode(this._curVideoNode,!0);var e=this._needHideVideoNode;this.visibleVideoNode(e,!1),e&&e.stop(),this._needHideVideoNode=null}},t.prototype.playNextInner=function(t){this._needHideVideoNode=this._curVideoNode,this._prePlayNext=!1,e.prototype.playNextInner.call(this,t)},t.prototype.appendAfter=function(e){var t=!this._curVideoNode||this._curVideoNode.state===exports.VIDEO_STATE.IDLE;this._played&&this._curUrlIdx+1===this._videoInfos.indexOf(e)&&t&&this.playNextInner()},t.prototype.preparePreloader=function(e,t){this._logger.log("preparePreloader(), isFirstLoad=",e);var o=this.getIdleVideoNode();return o?(t.extraVars.preloadVideoNode=o,e&&(this.setCurVideoNode(o),this.visibleVideoNode(o,!0)),new OrgPreLoader(this._config)):null},t.prototype.getIdleVideoNode=function(){if(this._firstVideoNode){var e=this._firstVideoNode;return this._firstVideoNode=null,e}for(var t=null,o=this._vnList.length,r=0;r<o;r++)if(this._vnList[r].state===exports.VIDEO_STATE.IDLE&&this._vnList[r]!==this._curVideoNode){t=this._vnList.splice(r,1)[0];break}return t&&this._vnList.push(t),t},t.prototype.getLevelSwitching=function(){return!!this._setLevelVideoNode},t.prototype.setLevelInner=function(e){var t=this.decideSetLevelMode(null==e?void 0:e.setLevelMode);return this._logger.log("setLevelMode=".concat(t)),t===SET_LEVEL_MODE.HARD||t===SET_LEVEL_MODE.SMOOTH?this._curVideoNode.setLevel(t):this.setLevelSoftMode()},t.prototype.switchVideoNodeWhenSetLevelSucc=function(e){this._logger.log(">>>>>switchLevelVideoNode<<<<<"),e===this._curVideoNode?this.visibleVideoNode(this._curVideoNode,!0):(this.visibleVideoNode(this._curVideoNode,!0),this.visibleVideoNode(e,!1),null==e||e.stop())},t.prototype.checkAccuratePlaytime=function(e,t){var o,r,n=this._config.originKernelConfig.prePlayNextTime,i=Math.abs(t-e);if(n>0&&i<n&&!this._prePlayNext){this._prePlayNext=!0;var a=this.findPreloadIdxByVideoInfo(this.nextVideoInfo);if(this.nextVideoInfo&&-1!==a){var s=null===(r=null===(o=this._preloaders[a])||void 0===o?void 0:o.videoInfo)||void 0===r?void 0:r.extraVars.preloadVideoNode;s&&(this._logger.log("preplay next!! idx/state: ".concat(s.idx,"/").concat(s.state)),s.play())}}this.checkAutoPreloadNext(i)},t.prototype.stopInner=function(t,o,r){void 0===t&&(t=exports.END_STATE.NORMAL),void 0===o&&(o=!1),void 0===r&&(r=null),this._firstVideoNode=null,this._prePlayNext=!1,this.playStartTime=0,this.clearSetLevelThings(!0),e.prototype.stopInner.call(this,t,o,r)},t.prototype.destroy=function(){this._needHideVideoNode=null,this._setLevelVideoNode=null,this._firstVideoNode=null,this.playStartTime=0;var t=this.videoElements;e.prototype.destroy.call(this),t.forEach((function(e){e instanceof HTMLVideoElement&&(e.volume=1,e.muted=!1,domTool.css(e,{zIndex:"0",visibility:"inherit"}),e.dataset.idx="0")}))},t.prototype.checkBeforePlay=function(){return this.getLevelSwitching()?(this._setLevelVideoNode.play(),this._logger.log("play(), setlevel"),!1):!(this._videoInfos.length<=0||!this._videoInfos[this._curUrlIdx])||(this._logger.warn("play(), !videoInfo"),!1)},t.prototype.emitStateChange=function(e,t){this.emit(exports.PLAY_EVENT.STATE_CHANGE,{videoInfo:e,new:t,old:this._curVideoNode?this._curVideoNode.state:exports.VIDEO_STATE.IDLE})},t.prototype.preloadToPlay=function(e,t){var o=this,r=0;e.hasFirstPlaying&&(r=window.setTimeout((function(){o.emitStateChange(e,exports.VIDEO_STATE.BUFFERING)}),200)),this._preloaders[t].promise.then((function(){clearTimeout(r),o._logger.log("play(), preloadVideoNode succ, uid=".concat(e.uid)),o.enterVideoNodePlay(e,t)})).catch((function(t){o._logger.log("play(), preloadVideoNode error, uid=".concat(e.uid,"/error="),t),t.code in ERROR_CODE&&(clearTimeout(r),e.error=t,o.stopInner(exports.END_STATE.ERROR,!0,e))}))},t.prototype.enterVideoNodePlay=function(e,t){var o,r,n;void 0===t&&(t=-1);var i=-1!==t;this._logger.log("enterVideoNodePlay(), preloadSucc=".concat(i));var a=-1!==t?null===(r=null===(o=this._preloaders[t])||void 0===o?void 0:o.videoInfo)||void 0===r?void 0:r.extraVars.preloadVideoNode:null;(this.findIdleVideoNode(a),-1!==t)&&this._preloaders.splice(t,1)[0].clear(!0);this._needHideVideoNode?this._needHideVideoNode===this._curVideoNode?(this.visibleVideoNode(this._curVideoNode,!0),this._logger.log("visibleVideoNode, need==current")):i&&this.switchVideoNode():(this.visibleVideoNode(this._curVideoNode,!0),this._logger.log("visibleVideoNode, null need")),this._curVideoNode.state!==exports.VIDEO_STATE.PLAYING&&this._curVideoNode.play(e,{startTime:this.playStartTime}),this.emit(exports.PLAY_EVENT.VIDEONODE_CHANGE,{videoInfo:this.currentVideoInfo}),this._logger.log("enterMultiPlay(), uid=".concat(null===(n=this.currentVideoInfo)||void 0===n?void 0:n.uid,"/")+"urlIdx=".concat(this._curUrlIdx,"/state=").concat(this._curVideoNode.state)),i&&(0!==this._videoInfos.indexOf(this.currentVideoInfo)&&(this.emit(exports.PLAY_EVENT.DURATION_CHANGE,{videoInfo:this.currentVideoInfo}),this.emitStateChange(this.currentVideoInfo,this._curVideoNode.state)),this.currentVideoInfo.extraVars.isStartPlay||(this.currentVideoInfo.extraVars.isStartPlay=!0,this._logger.log("videoNodeStartPlay: uid[".concat(this.currentVideoInfo.uid,"]")),this.emit(exports.PLAY_EVENT.VIDEONODE_START_PLAY,{videoInfo:this.currentVideoInfo})))},t.prototype.findIdleVideoNode=function(e){var t,o=!1;if((t=e)||(t=this.getIdleVideoNode()),!t&&this._curVideoNode&&this._curVideoNode.state===exports.VIDEO_STATE.IDLE&&(t=this._curVideoNode,o=!0),!t)throw this._logger.warn("can not find idle videonode!"),new Error("can not find idle videonode!");this.setCurVideoNode(t,o)},t.prototype.setLevelSoftMode=function(){var e=this,t=new SimpleDefer,o=this.currentVideoInfo;this._logger.log("setLevelInner(), uid: ".concat(o.uid)),this.pauseInner(),this.setPlayEvents(this._curVideoNode,!1),this.emit(exports.PLAY_EVENT.SETLEVEL_START,{videoInfo:o,mode:SET_LEVEL_MODE.SMOOTH}),this.setLoading(!0);var r=this._curVideoNode.playtime,n=this.getIdleVideoNode();n?this.visibleVideoNode(n,!1):(this._curVideoNode.stop(),n=this._curVideoNode),o.extraVars.isLoadstarted=!1,this._setLevelVideoNode=n,this._setLevelVideoNode.setLevelEvtMap={};var i=this._curVideoNode;return this.setCurVideoNode(n,!0),n.setLevelEvtMap[VIDEO_NODE_EVENT.STATE_CHANGE]=function(r){r.data.new===exports.VIDEO_STATE.PLAYING&&e.setLevelSoftModeHandler(o,t,i)},n.setLevelEvtMap[VIDEO_NODE_EVENT.ERROR]=function(r){e.setLevelSoftModeHandler(o,t)},n.on(VIDEO_NODE_EVENT.STATE_CHANGE,n.setLevelEvtMap[VIDEO_NODE_EVENT.STATE_CHANGE]),n.on(VIDEO_NODE_EVENT.ERROR,n.setLevelEvtMap[VIDEO_NODE_EVENT.ERROR]),n.play(o,{startTime:r}),t.promise},t.prototype.clearSetLevelThings=function(e){if(this.getLevelSwitching()){var t=this._setLevelVideoNode;t.setLevelEvtMap&&(Object.keys(t.setLevelEvtMap).forEach((function(e){t.off(e,t.setLevelEvtMap[e])})),t.setLevelEvtMap=null),e||t.stop(),this.clearAllPreloadInner(),this._setLevelVideoNode=null}},t.prototype.setLevelSoftModeHandler=function(e,t,o){var r;void 0===o&&(o=null);var n=!!o;this._logger.log("setLevel succ>>>>>> ".concat(n," uid: ").concat(e.uid)),this.clearSetLevelThings(n),n?(this.switchVideoNodeWhenSetLevelSucc(o),t.resolve()):(this.rollbackLevelVideoNode(),t.reject(new Error("setLevel failed, ".concat(null===(r=e.error)||void 0===r?void 0:r.message)))),this.emit(exports.PLAY_EVENT.SETLEVEL_OVER,{videoInfo:e,fail:!n}),this.setLoading(!1)},t.prototype.rollbackLevelVideoNode=function(){this._logger.log(">>>>>rollbackLevelVideoNode<<<<<"),this._urlBeforeSetLevel&&(Object.assign(this.currentVideoInfo.config,this._urlBeforeSetLevel),this.currentVideoInfo.reset(),this._urlBeforeSetLevel=null),this.setPlayEvents(this._curVideoNode,!0),this.resumeInner()},t.isEnvSupport=!0,__decorate$1([logMethodCall$2,__metadata$1("design:type",Function),__metadata$1("design:paramtypes",[Number]),__metadata$1("design:returntype",void 0)],t.prototype,"playInner",null),__decorate$1([logMethodCall$2,__metadata$1("design:type",Function),__metadata$1("design:paramtypes",[]),__metadata$1("design:returntype",void 0)],t.prototype,"switchVideoNode",null),t}(BasePlayer),__extends$3=window&&window.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),BaseLivePlayer=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends$3(t,e),t.prototype.playInner=function(e){var t=this._videoInfos[0];this.setPlayEvents(this._curVideoNode,!0),this._curVideoNode.play(t),this.emit(exports.PLAY_EVENT.VIDEONODE_CHANGE,{videoInfo:t})},t.prototype.resumeInner=function(){var e;this._played&&(null===(e=this._curVideoNode)||void 0===e?void 0:e.currentVideoInfo)&&this._curVideoNode.videoplay()},t.prototype.loadInner=function(t,o){return!!e.prototype.loadInner.call(this,t,o)&&(this.setCurVideoNode(this._vnList[0]),this._curVideoNode.load(this._videoInfos[0]),!0)},t.prototype.appendAfter=function(e){},t.prototype.checkAccuratePlaytime=function(e,t){},t.prototype.preparePreloader=function(e,t){return null},t.prototype.getIdleVideoNode=function(){return this._vnList[0]},t.prototype.setLevelInner=function(e){return this._curVideoNode.setLevel(e.setLevelMode)},t.prototype.playBlocked=function(){e.prototype.playBlocked.call(this),this.pause()},Object.defineProperty(t.prototype,"supportPreload",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportPlaybackRate",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nextVideoInfo",{get:function(){return this.currentVideoInfo},enumerable:!1,configurable:!0}),t}(BasePlayer);["seek","hasAppended","hasPreloaded","playNext","appendNext","preloadNext","clearAllPreload","appendAfter","checkPlayNext","playNextInner","checkAutoPreloadNext","clearAllPreloadInner"].forEach((function(e){BaseLivePlayer.prototype[e]=function(){console.warn("[thumbplayer] ".concat(e,"() is not support due to live stream"))}}));var __extends$2=window&&window.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),LivePlayer=function(e){function t(t){return e.call(this,mergeKernelConfig(t))||this}return __extends$2(t,e),Object.defineProperty(t.prototype,"kernelName",{get:function(){return exports.KERNEL_NAME.ORIGIN},enumerable:!1,configurable:!0}),t}(BaseLivePlayer),OrgPlayer=function(){function e(e){return e.type===exports.PLAY_MODE.LIVE?new LivePlayer(e):new MultiPlayer(e)}return Object.defineProperty(e,"canPlayType",{get:function(){return videoTool.supportVideoFormat()},enumerable:!1,configurable:!0}),e.isEnvSupport=!0,e.VERSION=VERSION$3,e.BUILD_TIME=BUILD_TIME$2,e}(),ThumbPlayerCore$1=Object.freeze({__proto__:null,MultiPlayer:MultiPlayer,OrgPlayer:OrgPlayer,OrgVideoNode:OrgVideoNode,OrgPreloader:OrgPreLoader,originDefaultConfig:defaultOriginKernelConfig,VideoInfo:VideoInfo,BaseVideoNode:BaseVideoNode,BasePlayer:BasePlayer,BaseLivePlayer:BaseLivePlayer,defaultPlayerConfig:defaultPlayerConfig,EvtEmitter:s,SimpleDefer:SimpleDefer,get DrmKeySystems(){return KeySystems},KernelFactory:KernelFactory$1,KernelProxy:KernelProxy,ReferenceReport:ReferenceReport,kernelEvtBus:kernelEvtBus,preloadEvtBus:preloadEvtBus,get SET_LEVEL_MODE(){return SET_LEVEL_MODE},get PLAY_MODE(){return exports.PLAY_MODE},CAN_PLAY_ALL:CAN_PLAY_ALL,VIDEO_CONTAINER_CLASS:VIDEO_CONTAINER_CLASS,get END_STATE(){return exports.END_STATE},get VIDEO_READY_STATE(){return VIDEO_READY_STATE},get VIDEO_EVTS(){return VIDEO_EVTS},get VIDEO_STATE(){return exports.VIDEO_STATE},get ERROR_CODE(){return ERROR_CODE},get ERROR_MSG(){return ERROR_MSG},get PLAY_EVENT(){return exports.PLAY_EVENT},get PRELOAD_EVENT(){return PRELOAD_EVENT},get VIDEO_NODE_EVENT(){return VIDEO_NODE_EVENT},get PAUSE_TYPE(){return PAUSE_TYPE},get PLAYER_LOG_LEVEL(){return PLAYER_LOG_LEVEL},get PRELOAD_TYPE(){return exports.PRELOAD_TYPE},get CODEC(){return CODEC},get VIDEO_CODEC(){return exports.VIDEO_CODEC},get AUDIO_CODEC(){return exports.AUDIO_CODEC},get CONTAINER_FORMAT(){return exports.CONTAINER_FORMAT},get HDR_CAPABILITY(){return HDR_CAPABILITY},get VIDEO_ELEMENT_STATE(){return VIDEO_ELEMENT_STATE},CDN_PATH_PREFIX:CDN_PATH_PREFIX,get CACHE_SIZE_KEY(){return CACHE_SIZE_KEY},get DRM_TYPE(){return DRM_TYPE$1},get VIDEO_TYPE(){return VIDEO_TYPE},get KERNEL_NAME(){return exports.KERNEL_NAME},defaultI18nConfig:defaultI18nConfig,i18nConfig:i18nConfig,get AUDIO_TRACK_ERROR_MSG(){return AUDIO_TRACK_ERROR_MSG},commonTool:comTool,uaTool:uaTool,logTool:logtool,logMethodCallDecoratorCreator:logMethodCallDecoratorCreator,logMethodCallDecoratorCreater:logMethodCallDecoratorCreator,Logger:Logger,enableConsoleOutput:enableConsoleOutput,get LogMode(){return LogMode},dumpLog:dumpLog,requireModule:requireModule,cookieTool:cookieTool,lsTool:lsTool,urlTool:urlTool,domTool:domTool,netTool:netTool,getEventEmitterBinder:getEventEmitterBinder,getEventTargetBinder:getEventTargetBinder,videoTool:videoTool,stringTool:stringTool,jsonTool:jsonTool,TaskLoop:TaskLoop,get LoopMode(){return LoopMode},ResizeObserver:ResizeObserver,ResizeObserverPolyfilled:ResizeObserverPolyfilled,t:compile,compileI18n:compile,i18nTool:i18nTool,CHANNEL:CHANNEL,BUILD_TIME:BUILD_TIME$2,VERSION:VERSION$3,LOCAL_DEV:LOCAL_DEV,ErrorTypeCodeMap:ErrorTypeCodeMap,PlayerError:PlayerError,ErrorBase:ErrorBase});KernelFactory$1.registerKernel(exports.KERNEL_NAME.ORIGIN,OrgPlayer),window.ThumbPlayerCore=ThumbPlayerCore$1;var ThumbPlayerCore=Object.freeze({__proto__:null,MultiPlayer:MultiPlayer,OrgPlayer:OrgPlayer,OrgVideoNode:OrgVideoNode,OrgPreloader:OrgPreLoader,originDefaultConfig:defaultOriginKernelConfig,VideoInfo:VideoInfo,BaseVideoNode:BaseVideoNode,BasePlayer:BasePlayer,BaseLivePlayer:BaseLivePlayer,defaultPlayerConfig:defaultPlayerConfig,EvtEmitter:s,SimpleDefer:SimpleDefer,get DrmKeySystems(){return KeySystems},KernelFactory:KernelFactory$1,KernelProxy:KernelProxy,ReferenceReport:ReferenceReport,kernelEvtBus:kernelEvtBus,preloadEvtBus:preloadEvtBus,get SET_LEVEL_MODE(){return SET_LEVEL_MODE},get PLAY_MODE(){return exports.PLAY_MODE},CAN_PLAY_ALL:CAN_PLAY_ALL,VIDEO_CONTAINER_CLASS:VIDEO_CONTAINER_CLASS,get END_STATE(){return exports.END_STATE},get VIDEO_READY_STATE(){return VIDEO_READY_STATE},get VIDEO_EVTS(){return VIDEO_EVTS},get VIDEO_STATE(){return exports.VIDEO_STATE},get ERROR_CODE(){return ERROR_CODE},get ERROR_MSG(){return ERROR_MSG},get PLAY_EVENT(){return exports.PLAY_EVENT},get PRELOAD_EVENT(){return PRELOAD_EVENT},get VIDEO_NODE_EVENT(){return VIDEO_NODE_EVENT},get PAUSE_TYPE(){return PAUSE_TYPE},get PLAYER_LOG_LEVEL(){return PLAYER_LOG_LEVEL},get PRELOAD_TYPE(){return exports.PRELOAD_TYPE},get CODEC(){return CODEC},get VIDEO_CODEC(){return exports.VIDEO_CODEC},get AUDIO_CODEC(){return exports.AUDIO_CODEC},get CONTAINER_FORMAT(){return exports.CONTAINER_FORMAT},get HDR_CAPABILITY(){return HDR_CAPABILITY},get VIDEO_ELEMENT_STATE(){return VIDEO_ELEMENT_STATE},CDN_PATH_PREFIX:CDN_PATH_PREFIX,get CACHE_SIZE_KEY(){return CACHE_SIZE_KEY},get DRM_TYPE(){return DRM_TYPE$1},get VIDEO_TYPE(){return VIDEO_TYPE},get KERNEL_NAME(){return exports.KERNEL_NAME},defaultI18nConfig:defaultI18nConfig,i18nConfig:i18nConfig,get AUDIO_TRACK_ERROR_MSG(){return AUDIO_TRACK_ERROR_MSG},commonTool:comTool,uaTool:uaTool,logTool:logtool,logMethodCallDecoratorCreator:logMethodCallDecoratorCreator,logMethodCallDecoratorCreater:logMethodCallDecoratorCreator,Logger:Logger,enableConsoleOutput:enableConsoleOutput,get LogMode(){return LogMode},dumpLog:dumpLog,requireModule:requireModule,cookieTool:cookieTool,lsTool:lsTool,urlTool:urlTool,domTool:domTool,netTool:netTool,getEventEmitterBinder:getEventEmitterBinder,getEventTargetBinder:getEventTargetBinder,videoTool:videoTool,stringTool:stringTool,jsonTool:jsonTool,TaskLoop:TaskLoop,get LoopMode(){return LoopMode},ResizeObserver:ResizeObserver,ResizeObserverPolyfilled:ResizeObserverPolyfilled,t:compile,compileI18n:compile,i18nTool:i18nTool,CHANNEL:CHANNEL,BUILD_TIME:BUILD_TIME$2,VERSION:VERSION$3,LOCAL_DEV:LOCAL_DEV,ErrorTypeCodeMap:ErrorTypeCodeMap,PlayerError:PlayerError,ErrorBase:ErrorBase}),commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},sha256={exports:{}};(function(module){(function(){var ERROR="input is invalid type",WINDOW="object"==typeof window,root=WINDOW?window:{};root.JS_SHA256_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&"object"==typeof self,NODE_JS=!root.JS_SHA256_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node;NODE_JS?root=commonjsGlobal:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_SHA256_NO_COMMON_JS&&module.exports,ARRAY_BUFFER=!root.JS_SHA256_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,HEX_CHARS="0123456789abcdef".split(""),EXTRA=[-2147483648,8388608,32768,128],SHIFT=[24,16,8,0],K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],OUTPUT_TYPES=["hex","array","digest","arrayBuffer"],blocks=[];!root.JS_SHA256_NO_NODE_JS&&Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),!ARRAY_BUFFER||!root.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(e){return"object"==typeof e&&e.buffer&&e.buffer.constructor===ArrayBuffer});var createOutputMethod=function(e,t){return function(o){return new Sha256(t,!0).update(o)[e]()}},createMethod=function(e){var t=createOutputMethod("hex",e);NODE_JS&&(t=nodeWrap(t,e)),t.create=function(){return new Sha256(e)},t.update=function(e){return t.create().update(e)};for(var o=0;o<OUTPUT_TYPES.length;++o){var r=OUTPUT_TYPES[o];t[r]=createOutputMethod(r,e)}return t},nodeWrap=function(method,is224){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),algorithm=is224?"sha224":"sha256",nodeMethod=function(e){if("string"==typeof e)return crypto.createHash(algorithm).update(e,"utf8").digest("hex");if(null==e)throw new Error(ERROR);return e.constructor===ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||ArrayBuffer.isView(e)||e.constructor===Buffer?crypto.createHash(algorithm).update(new Buffer(e)).digest("hex"):method(e)};return nodeMethod},createHmacOutputMethod=function(e,t){return function(o,r){return new HmacSha256(o,t,!0).update(r)[e]()}},createHmacMethod=function(e){var t=createHmacOutputMethod("hex",e);t.create=function(t){return new HmacSha256(t,e)},t.update=function(e,o){return t.create(e).update(o)};for(var o=0;o<OUTPUT_TYPES.length;++o){var r=OUTPUT_TYPES[o];t[r]=createHmacOutputMethod(r,e)}return t};function Sha256(e,t){t?(blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=e}function HmacSha256(e,t,o){var r,n=typeof e;if("string"===n){var i,a=[],s=e.length,l=0;for(r=0;r<s;++r)(i=e.charCodeAt(r))<128?a[l++]=i:i<2048?(a[l++]=192|i>>6,a[l++]=128|63&i):i<55296||i>=57344?(a[l++]=224|i>>12,a[l++]=128|i>>6&63,a[l++]=128|63&i):(i=65536+((1023&i)<<10|1023&e.charCodeAt(++r)),a[l++]=240|i>>18,a[l++]=128|i>>12&63,a[l++]=128|i>>6&63,a[l++]=128|63&i);e=a}else{if("object"!==n)throw new Error(ERROR);if(null===e)throw new Error(ERROR);if(ARRAY_BUFFER&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||ARRAY_BUFFER&&ArrayBuffer.isView(e)))throw new Error(ERROR)}e.length>64&&(e=new Sha256(t,!0).update(e).array());var c=[],p=[];for(r=0;r<64;++r){var d=e[r]||0;c[r]=92^d,p[r]=54^d}Sha256.call(this,t,o),this.update(p),this.oKeyPad=c,this.inner=!0,this.sharedMemory=o}Sha256.prototype.update=function(e){if(!this.finalized){var t,o=typeof e;if("string"!==o){if("object"!==o)throw new Error(ERROR);if(null===e)throw new Error(ERROR);if(ARRAY_BUFFER&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||ARRAY_BUFFER&&ArrayBuffer.isView(e)))throw new Error(ERROR);t=!0}for(var r,n,i=0,a=e.length,s=this.blocks;i<a;){if(this.hashed&&(this.hashed=!1,s[0]=this.block,s[16]=s[1]=s[2]=s[3]=s[4]=s[5]=s[6]=s[7]=s[8]=s[9]=s[10]=s[11]=s[12]=s[13]=s[14]=s[15]=0),t)for(n=this.start;i<a&&n<64;++i)s[n>>2]|=e[i]<<SHIFT[3&n++];else for(n=this.start;i<a&&n<64;++i)(r=e.charCodeAt(i))<128?s[n>>2]|=r<<SHIFT[3&n++]:r<2048?(s[n>>2]|=(192|r>>6)<<SHIFT[3&n++],s[n>>2]|=(128|63&r)<<SHIFT[3&n++]):r<55296||r>=57344?(s[n>>2]|=(224|r>>12)<<SHIFT[3&n++],s[n>>2]|=(128|r>>6&63)<<SHIFT[3&n++],s[n>>2]|=(128|63&r)<<SHIFT[3&n++]):(r=65536+((1023&r)<<10|1023&e.charCodeAt(++i)),s[n>>2]|=(240|r>>18)<<SHIFT[3&n++],s[n>>2]|=(128|r>>12&63)<<SHIFT[3&n++],s[n>>2]|=(128|r>>6&63)<<SHIFT[3&n++],s[n>>2]|=(128|63&r)<<SHIFT[3&n++]);this.lastByteIndex=n,this.bytes+=n-this.start,n>=64?(this.block=s[16],this.start=n-64,this.hash(),this.hashed=!0):this.start=n}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Sha256.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[16]=this.block,e[t>>2]|=EXTRA[3&t],this.block=e[16],t>=56&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}},Sha256.prototype.hash=function(){var e,t,o,r,n,i,a,s,l,c=this.h0,p=this.h1,d=this.h2,u=this.h3,A=this.h4,_=this.h5,E=this.h6,g=this.h7,f=this.blocks;for(e=16;e<64;++e)t=((n=f[e-15])>>>7|n<<25)^(n>>>18|n<<14)^n>>>3,o=((n=f[e-2])>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,f[e]=f[e-16]+t+f[e-7]+o<<0;for(l=p&d,e=0;e<64;e+=4)this.first?(this.is224?(i=300032,g=(n=f[0]-1413257819)-150054599<<0,u=n+24177077<<0):(i=704751109,g=(n=f[0]-210244248)-1521486534<<0,u=n+143694565<<0),this.first=!1):(t=(c>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10),r=(i=c&p)^c&d^l,g=u+(n=g+(o=(A>>>6|A<<26)^(A>>>11|A<<21)^(A>>>25|A<<7))+(A&_^~A&E)+K[e]+f[e])<<0,u=n+(t+r)<<0),t=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),r=(a=u&c)^u&p^i,E=d+(n=E+(o=(g>>>6|g<<26)^(g>>>11|g<<21)^(g>>>25|g<<7))+(g&A^~g&_)+K[e+1]+f[e+1])<<0,t=((d=n+(t+r)<<0)>>>2|d<<30)^(d>>>13|d<<19)^(d>>>22|d<<10),r=(s=d&u)^d&c^a,_=p+(n=_+(o=(E>>>6|E<<26)^(E>>>11|E<<21)^(E>>>25|E<<7))+(E&g^~E&A)+K[e+2]+f[e+2])<<0,t=((p=n+(t+r)<<0)>>>2|p<<30)^(p>>>13|p<<19)^(p>>>22|p<<10),r=(l=p&d)^p&u^s,A=c+(n=A+(o=(_>>>6|_<<26)^(_>>>11|_<<21)^(_>>>25|_<<7))+(_&E^~_&g)+K[e+3]+f[e+3])<<0,c=n+(t+r)<<0;this.h0=this.h0+c<<0,this.h1=this.h1+p<<0,this.h2=this.h2+d<<0,this.h3=this.h3+u<<0,this.h4=this.h4+A<<0,this.h5=this.h5+_<<0,this.h6=this.h6+E<<0,this.h7=this.h7+g<<0},Sha256.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,o=this.h2,r=this.h3,n=this.h4,i=this.h5,a=this.h6,s=this.h7,l=HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>4&15]+HEX_CHARS[15&e]+HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>4&15]+HEX_CHARS[15&t]+HEX_CHARS[o>>28&15]+HEX_CHARS[o>>24&15]+HEX_CHARS[o>>20&15]+HEX_CHARS[o>>16&15]+HEX_CHARS[o>>12&15]+HEX_CHARS[o>>8&15]+HEX_CHARS[o>>4&15]+HEX_CHARS[15&o]+HEX_CHARS[r>>28&15]+HEX_CHARS[r>>24&15]+HEX_CHARS[r>>20&15]+HEX_CHARS[r>>16&15]+HEX_CHARS[r>>12&15]+HEX_CHARS[r>>8&15]+HEX_CHARS[r>>4&15]+HEX_CHARS[15&r]+HEX_CHARS[n>>28&15]+HEX_CHARS[n>>24&15]+HEX_CHARS[n>>20&15]+HEX_CHARS[n>>16&15]+HEX_CHARS[n>>12&15]+HEX_CHARS[n>>8&15]+HEX_CHARS[n>>4&15]+HEX_CHARS[15&n]+HEX_CHARS[i>>28&15]+HEX_CHARS[i>>24&15]+HEX_CHARS[i>>20&15]+HEX_CHARS[i>>16&15]+HEX_CHARS[i>>12&15]+HEX_CHARS[i>>8&15]+HEX_CHARS[i>>4&15]+HEX_CHARS[15&i]+HEX_CHARS[a>>28&15]+HEX_CHARS[a>>24&15]+HEX_CHARS[a>>20&15]+HEX_CHARS[a>>16&15]+HEX_CHARS[a>>12&15]+HEX_CHARS[a>>8&15]+HEX_CHARS[a>>4&15]+HEX_CHARS[15&a];return this.is224||(l+=HEX_CHARS[s>>28&15]+HEX_CHARS[s>>24&15]+HEX_CHARS[s>>20&15]+HEX_CHARS[s>>16&15]+HEX_CHARS[s>>12&15]+HEX_CHARS[s>>8&15]+HEX_CHARS[s>>4&15]+HEX_CHARS[15&s]),l},Sha256.prototype.toString=Sha256.prototype.hex,Sha256.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,o=this.h2,r=this.h3,n=this.h4,i=this.h5,a=this.h6,s=this.h7,l=[e>>24&255,e>>16&255,e>>8&255,255&e,t>>24&255,t>>16&255,t>>8&255,255&t,o>>24&255,o>>16&255,o>>8&255,255&o,r>>24&255,r>>16&255,r>>8&255,255&r,n>>24&255,n>>16&255,n>>8&255,255&n,i>>24&255,i>>16&255,i>>8&255,255&i,a>>24&255,a>>16&255,a>>8&255,255&a];return this.is224||l.push(s>>24&255,s>>16&255,s>>8&255,255&s),l},Sha256.prototype.array=Sha256.prototype.digest,Sha256.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(this.is224?28:32),t=new DataView(e);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),t.setUint32(20,this.h5),t.setUint32(24,this.h6),this.is224||t.setUint32(28,this.h7),e},HmacSha256.prototype=new Sha256,HmacSha256.prototype.finalize=function(){if(Sha256.prototype.finalize.call(this),this.inner){this.inner=!1;var e=this.array();Sha256.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(e),Sha256.prototype.finalize.call(this)}};var exports=createMethod();exports.sha256=exports,exports.sha224=createMethod(!0),exports.sha256.hmac=createHmacMethod(),exports.sha224.hmac=createHmacMethod(!0),COMMON_JS?module.exports=exports:(root.sha256=exports.sha256,root.sha224=exports.sha224)})()})(sha256);var h5playerI18nConfig={ERROR_GETINFO_PLUGIN_MISSING:"没有找到获取视频信息插件",ERROR_GETINFO_INNER:"获取视频信息内部错误",ERROR_GETINFO_NET:"无法获取视频信息",ERROR_GETINFO_TIMEOUT:"获取视频信息超时",ERROR_GETINFO_PARSE:"视频信息无法解析",ERROR_GETINFO_CODE:"播放后台返回错误",ERROR_UNOFFICIAL_PLUGIN_NEEDS_URL:"您所传入的插件不是官方插件，必须提供 url",ERROR_PLAY_LIMIT_EMPTY_CONFIG:"配置不能为空",ERROR_PLAY_LIMIT_POINTS_BOTH_EMPTY:"startPoint / endPoint 配置不能同时为空",ERROR_PLAY_LIMIT_START_TIME_BELOW_ZERO:"startPoint.value 值不能小于 0",ERROR_PLAY_LIMIT_END_TIME_BELOW_START_TIME:"endPoint.value 值不能小于 startPoint.value"};defaultI18nConfig.h5player=h5playerI18nConfig;var adPluginMap={};function setAdPlugin(e,t){adPluginMap[e]=t}function getAdPlugin(e){return adPluginMap[e]}var AdPluginName="__thumbplayer-ad",AD_TYPE;function isPreOrPostAd(e){return-1!==[exports.AD_TYPE.PRE,exports.AD_TYPE.POST].indexOf(e.adType)}exports.AD_TYPE=void 0,AD_TYPE=exports.AD_TYPE||(exports.AD_TYPE={}),AD_TYPE.PRE="preAd",AD_TYPE.ZT="ZT",AD_TYPE.POST="postAd";var defaultH5PlayerConfig={container:void 0,enableQAreporter:!0,maxRetryGetinfoTimes:3,maxRetryGetinfoTimesInVodSession:10,maxRetryGetinfoTimesInLiveSession:30},ErrorCode,ErrorMsg,H5_EXT_EVENT,H5_PLAY_EVENT;exports.ErrorCode=void 0,ErrorCode=exports.ErrorCode||(exports.ErrorCode={}),ErrorCode.SUC="0",ErrorCode.UNKNOWN="70040000",ErrorCode.AD_END_DEFAULT_FAIL="70040002",ErrorCode.AD_REQ_INFO_DEFAULT_FAIL="70040003",ErrorCode.GETINFO_PLUGIN_MISSING="70040001",ErrorCode.GETINFO_NET="70014001",ErrorCode.GETINFO_TIMEOUT="70014003",ErrorCode.GETINFO_PARSE="70014004",ErrorCode.GETINFO_INNER="70014005",ErrorCode.GETINFO_SERVER_CODE_PREFIX="70013",ErrorCode.GETINFO_LIVE_SERVER_CODE_PREFIX="70023",ErrorCode.GETINFO_UNIFIED_LIVE_SERVER_CODE_PREFIX="70033",ErrorCode.UNPAIED_1080P="70013091.0",exports.ErrorMsg=void 0,ErrorMsg=exports.ErrorMsg||(exports.ErrorMsg={}),ErrorMsg.GETINFO_PLUGIN_MISSING="没有找到获取视频信息插件",ErrorMsg.GETINFO_INNER="获取视频信息内部错误",ErrorMsg.GETINFO_NET="无法获取视频信息",ErrorMsg.GETINFO_TIMEOUT="获取视频信息超时",ErrorMsg.GETINFO_PARSE="视频信息无法解析",ErrorMsg.GETINFO_CODE="播放后台返回错误",exports.PLAY_EVENT_EXT=void 0,H5_EXT_EVENT=exports.PLAY_EVENT_EXT||(exports.PLAY_EVENT_EXT={}),H5_EXT_EVENT.AD_COUNTDOWN_CHANGE="AD_COUNTDOWN_CHANGE",H5_EXT_EVENT.SET_LOADING="SET_LOADING",H5_EXT_EVENT.PROXY_HTTP_START="PROXY_HTTP_START",H5_EXT_EVENT.PROXY_HTTP_END="PROXY_HTTP_END",H5_EXT_EVENT.GETINFO_START="GETINFO_START",H5_EXT_EVENT.GETINFO_OVER="GETINFO_OVER",H5_EXT_EVENT.PRELOAD_GETINFO_OVER="PRELOAD_GETINFO_OVER",H5_EXT_EVENT.VID_CHANGE="VID_CHANGE",H5_EXT_EVENT.DESTROY="DESTROY",H5_EXT_EVENT.DATASET_UPDATE="data-set:update",H5_EXT_EVENT.DATASET_STATE_UPDATE="data-set:stateUpdate",H5_EXT_EVENT.RETRY_PLAY="retryPlay",H5_EXT_EVENT.DEGRADE_CODEC_PLAY="degradeCodecPlay",H5_EXT_EVENT.FLOW_NODE_PRELOAD="FLOW_NODE_PRELOAD",H5_EXT_EVENT.FLOW_NODE_START="FLOW_NODE_START",H5_EXT_EVENT.FLOW_NODE_END="FLOW_NODE_END",H5_EXT_EVENT.FLOW_NODE_ABORT="FLOW_NODE_ABORT",exports.H5_PLAY_EVENT=void 0,H5_PLAY_EVENT=exports.H5_PLAY_EVENT||(exports.H5_PLAY_EVENT={}),H5_PLAY_EVENT.PLAY_SESSION_START="PLAY_SESSION_START",H5_PLAY_EVENT.AD_REQ_INFO_START="AD_REQ_INFO_START",H5_PLAY_EVENT.AD_REQ_INFO_END="AD_REQ_INFO_END",H5_PLAY_EVENT.AD_REQ_ASSETS_START="AD_REQ_ASSETS_START",H5_PLAY_EVENT.AD_AUTOPLAY_BLOCKED="AD_AUTOPLAY_BLOCKED",H5_PLAY_EVENT.AD_PLAYING="AD_PLAYING",H5_PLAY_EVENT.AD_VOLUME_CHANGE="AD_VOLUME_CHANGE",H5_PLAY_EVENT.AD_ASSETS_LOADED="AD_ASSETS_LOADED",H5_PLAY_EVENT.AD_PAUSE="AD_PAUSE",H5_PLAY_EVENT.AD_RESUME="AD_RESUME",H5_PLAY_EVENT.AD_END="AD_END",H5_PLAY_EVENT.AD_TIME_UPDATE="AD_TIME_UPDATE",H5_PLAY_EVENT.VIDEO_REQ_INFO_START="VIDEO_REQ_INFO_START",H5_PLAY_EVENT.VIDEO_REQ_INFO_END="VIDEO_REQ_INFO_END",H5_PLAY_EVENT.VIDEO_LOAD_START="VIDEO_LOAD_START",H5_PLAY_EVENT.VIDEO_LOAD_PROGRESS="VIDEO_LOAD_PROGRESS",H5_PLAY_EVENT.VIDEO_DURATION_CHANGE="VIDEO_DURATION_CHANGE",H5_PLAY_EVENT.VIDEO_METADATA_CHANGE="VIDEO_METADATA_CHANGE",H5_PLAY_EVENT.VIDEO_TIMEUPDATE="VIDEO_TIMEUPDATE",H5_PLAY_EVENT.VIDEO_VOLUME_CHANGE="VIDEO_VOLUME_CHANGE",H5_PLAY_EVENT.VIDEO_RATE_CHANGE="VIDEO_RATE_CHANGE",H5_PLAY_EVENT.VIDEO_CANPLAY="VIDEO_CANPLAY",H5_PLAY_EVENT.VIDEO_PLAYING="VIDEO_PLAYING",H5_PLAY_EVENT.VIDEO_AUTOPLAY_BLOCKED="VIDEO_AUTOPLAY_BLOCKED",H5_PLAY_EVENT.VIDEO_PAUSE="VIDEO_PAUSE",H5_PLAY_EVENT.VIDEO_BUFFERING="VIDEO_BUFFERING",H5_PLAY_EVENT.VIDEO_SEEKING="VIDEO_SEEKING",H5_PLAY_EVENT.VIDEO_SEEKED="VIDEO_SEEKED",H5_PLAY_EVENT.VIDEO_SETLEVEL_START="VIDEO_SETLEVEL_START",H5_PLAY_EVENT.VIDEO_SETLEVEL_END="VIDEO_SETLEVEL_END",H5_PLAY_EVENT.VIDEO_RESIZE="VIDEO_RESIZE",H5_PLAY_EVENT.VIDEO_END="VIDEO_END",H5_PLAY_EVENT.PLAY_SESSION_END="PLAY_SESSION_END";var pluginStorage={},pluginExists=function(e){return Object.prototype.hasOwnProperty.call(pluginStorage,e)},getPlugin=function(e){return pluginExists(e)?pluginStorage[e]:void 0};function registerPlugin(e,t){if("string"!=typeof e)throw new Error('Illegal plugin name, "'.concat(e,'", must be a string, was ').concat(typeof e,"."));if("function"!=typeof t)throw new Error('Illegal plugin for "'.concat(e,'", must be a function, was ').concat(typeof t,"."));if(!pluginExists(e))return pluginStorage[e]=t,t;console.warn('A plugin named "'.concat(e,'" already exists. You may want to avoid re-registering plugins!'))}function deregisterPlugin(e){pluginExists(e)&&delete pluginStorage[e]}function getPlugins(e){var t;return void 0===e&&(e=Object.keys(pluginStorage)),e.forEach((function(e){var o=getPlugin(e);o&&((t=t||{})[e]=o)})),t}var methodPrefix="hook",playHooks=Object.values(exports.H5_PLAY_EVENT),Plugin=function(e){function t(o,r,n){var i=this.constructor,a=e.call(this)||this;if(a.player=o,a.config=r,a.hookMap={},i===t)throw new Error("Plugin must be sub-classed; not directly instantiated.");a.logger_=new Logger(o.config.instanceId,a.constructor.pluginName);var s=(n||{}).msg;return a.msg=s,a.registerHook(),a}return __extends$d(t,e),t.prototype.log=function(){for(var e,t,o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];null===(t=(e=this.logger_).log)||void 0===t||t.call.apply(t,__spreadArray$4([e],o,!1))},t.prototype.warn=function(){for(var e,t,o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];null===(t=(e=this.logger_).warn)||void 0===t||t.call.apply(t,__spreadArray$4([e],o,!1))},t.prototype.error=function(){for(var e,t,o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];null===(t=(e=this.logger_).error)||void 0===t||t.call.apply(t,__spreadArray$4([e],o,!1))},t.prototype.debug=function(){for(var e,t,o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];null===(t=(e=this.logger_).debug)||void 0===t||t.call.apply(t,__spreadArray$4([e],o,!1))},t.prototype.info=function(){for(var e,t,o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];null===(t=(e=this.logger_).info)||void 0===t||t.call.apply(t,__spreadArray$4([e],o,!1))},t.prototype.hasPlugin=function(e){return!!pluginExists(e)},t.prototype.destroy=function(){var e,t=this.player,o=this.name;(null===(e=t.plugins)||void 0===e?void 0:e[o])&&delete t.plugins[o],this.unRegisterHook(),this.hookMap=null,this.player=null,this.removeAllListeners()},t.prototype.hookPlaySessionStart=function(e){},t.prototype.hookAdReqInfoStart=function(e){},t.prototype.hookAdReqInfoEnd=function(e){},t.prototype.hookAdReqAssetsStart=function(e){},t.prototype.hookAdAutoplayBlocked=function(e){},t.prototype.hookAdPlaying=function(e){},t.prototype.hookAdVolumeChange=function(e){},t.prototype.hookAdAssetsLoaded=function(e){},t.prototype.hookAdPause=function(e){},t.prototype.hookAdResume=function(e){},t.prototype.hookAdEnd=function(e){},t.prototype.hookAdTimeUpdate=function(e){},t.prototype.hookVideoReqInfoStart=function(e){},t.prototype.hookVideoReqInfoEnd=function(e){},t.prototype.hookVideoLoadStart=function(e){},t.prototype.hookVideoMetadataChange=function(e){},t.prototype.hookVideoLoadProgress=function(e){},t.prototype.hookVideoDurationChange=function(e){},t.prototype.hookVideoTimeupdate=function(e){},t.prototype.hookVideoVolumeChange=function(e){},t.prototype.hookVideoResize=function(e){},t.prototype.hookVideoRateChange=function(e){},t.prototype.hookVideoCanplay=function(e){},t.prototype.hookVideoPlaying=function(e){},t.prototype.hookVideoAutoplayBlocked=function(e){},t.prototype.hookVideoPause=function(e){},t.prototype.hookVideoBuffering=function(e){},t.prototype.hookVideoSeeking=function(e){},t.prototype.hookVideoSeeked=function(e){},t.prototype.hookVideoSetlevelStart=function(e){},t.prototype.hookVideoSetlevelEnd=function(e){},t.prototype.hookVideoEnd=function(e){},t.prototype.hookPlaySessionEnd=function(e){},t.prototype.registerHook=function(){var e=this;playHooks.forEach((function(t){var o=getHookMethodName(t);e.hookMap[t]=function(t){var r;return null===(r=e[o])||void 0===r?void 0:r.call(e,t.data)},e.player.on(t,e.hookMap[t])}))},t.prototype.unRegisterHook=function(){var e=this;playHooks.forEach((function(t){e.hookMap[t]&&e.player.off(t,e.hookMap[t])}))},t.VERSION="",t.pluginName="",t}(s);function isFunctionPlugin(e){var t="string"==typeof e?getPlugin(e):e;return"function"==typeof t&&!Object.prototype.isPrototypeOf.call(Plugin.prototype,t.prototype)}function createPluginFactory(e,t){for(var o=[],r=2;r<arguments.length;r++)o[r-2]=arguments[r];var n,i=o[0];if(isFunctionPlugin(t))n=t.apply(i,o);else{var a=t;a.prototype.name=e,n=new(a.bind.apply(a,__spreadArray$4([void 0],o,!1)))}return n&&(i.plugins[e]=n),n}function getHookMethodName(e){return methodPrefix+e.toLowerCase().replace(/^[a-z]/,(function(e){return e.toUpperCase()})).replace(/_[a-z]/g,(function(e){return e[1].toUpperCase()}))}function isVideoId(e){return"string"==typeof e||"number"==typeof e}var DRM_TYPE={NONE:0,CHACHA:3,FAIR_PLAY:4,WIDEVINE:5,ChinaDRM:6},DRM_VALUE={NONE:0,CHACHA:8,FAIR_PLAY:16,WIDEVINE:32},DATA_EVENTS,DATA_STATE,LOG_TYPE,BUFFER_REASON,PersistedUserSettings;exports.DATA_EVENTS=void 0,DATA_EVENTS=exports.DATA_EVENTS||(exports.DATA_EVENTS={}),DATA_EVENTS.UPDATE="data-set:update",DATA_EVENTS.STATE_UPDATE="data-set:stateUpdate",exports.DATA_STATE=void 0,DATA_STATE=exports.DATA_STATE||(exports.DATA_STATE={}),DATA_STATE.INIT="PLAYER:init",DATA_STATE.SESSION_START="PLAYER:session_start",DATA_STATE.SESSION_END="PLAYER:session_end",DATA_STATE.GET_INFO="PLAYER:getinfo",DATA_STATE.GET_INFO_START="PLAYER:getinfo_start",DATA_STATE.GET_INFO_END="PLAYER:getinfo_end",DATA_STATE.SUBTITLE="PLAYER:subtitle",DATA_STATE.SUBTITLE_START="PLAYER:subtitle_start",DATA_STATE.SUBTITLE_END="PLAYER:subtitle_end",DATA_STATE.LOAD_START="PLAYER:load_start",DATA_STATE.LOAD_END="PLAYER:load_end",DATA_STATE.LOAD="PLAYER:load",DATA_STATE.BUFFER="PLAYER:buffer",DATA_STATE.BUFFER_START="PLAYER:buffer_start",DATA_STATE.BUFFER_END="PLAYER:buffer_end",DATA_STATE.SEEK="PLAYER:seek",DATA_STATE.SEEK_START="PLAYER:seek_start",DATA_STATE.SEEK_END="PLAYER:seek_end",DATA_STATE.USER_SEEK_START="PLAYER:user_seek_start",DATA_STATE.USER_SEEK_END="PLAYER:user_seek_end",DATA_STATE.END="PLAYER:end",DATA_STATE.ERROR="PLAYER:error",DATA_STATE.FATAL_ERROR="PLAYER:fatal_error",DATA_STATE.FIRST_PLAY="PLAYER:firstPlay",DATA_STATE.IDLE="PLAYER:idle",DATA_STATE.PLAYING="PLAYER:playing",DATA_STATE.SET_LEVEL="PLAYER:setLevel",DATA_STATE.SET_LEVEL_START="PLAYER:setLevel_start",DATA_STATE.SET_LEVEL_END="PLAYER:setLevel_end",DATA_STATE.PAUSE="PLAYER:pause",DATA_STATE.PAUSE_START="PLAYER:pause_start",DATA_STATE.PAUSE_END="PLAYER:pause_end",DATA_STATE.SET_RATE="PLAYER:setRate",DATA_STATE.RETRY_BACKURL="PLAYER:retryBackUrl",DATA_STATE.RETRY_PLAY="PLAYER:retryPlay",DATA_STATE.AUTO_PLAY_BLOCKED="PLAYER:autoplayBlocked",DATA_STATE.CODEC_DEGRADE="PLAYER:codecDegrade",exports.LOG_TYPE=void 0,LOG_TYPE=exports.LOG_TYPE||(exports.LOG_TYPE={}),LOG_TYPE.USER_ACTION="log:userAction",LOG_TYPE.PLUGIN_ACTION="log:pluginAction",LOG_TYPE.CORE_EVENT="log:coreEvent",LOG_TYPE.API_INVOKE="log:apiInvoke",LOG_TYPE.UNCATEGORIZED="log:uncategorized",exports.BUFFER_REASON=void 0,BUFFER_REASON=exports.BUFFER_REASON||(exports.BUFFER_REASON={}),BUFFER_REASON[BUFFER_REASON.NETWORK_UNSTABLE=1400027]="NETWORK_UNSTABLE",BUFFER_REASON[BUFFER_REASON.PARALLEL_DOWNLOAD=1400028]="PARALLEL_DOWNLOAD",BUFFER_REASON[BUFFER_REASON.CDN_NO_CONNECTION=1400007]="CDN_NO_CONNECTION",BUFFER_REASON[BUFFER_REASON.CDN_URL_SWITCH_SUCCESS=1400029]="CDN_URL_SWITCH_SUCCESS",BUFFER_REASON[BUFFER_REASON.CDN_SLOW=1400030]="CDN_SLOW",BUFFER_REASON[BUFFER_REASON.CDN_URL_SWITCH_UNSUCCESS=1400031]="CDN_URL_SWITCH_UNSUCCESS",BUFFER_REASON[BUFFER_REASON.CDN_TIMEOUT=1400026]="CDN_TIMEOUT",BUFFER_REASON[BUFFER_REASON.CDN_TIMEOUT_URL_SWITCH=1400032]="CDN_TIMEOUT_URL_SWITCH",BUFFER_REASON[BUFFER_REASON.BYTERATE_ERROR=1400033]="BYTERATE_ERROR",BUFFER_REASON[BUFFER_REASON.DOWNLOAD_TOO_SHORT=1400034]="DOWNLOAD_TOO_SHORT",BUFFER_REASON[BUFFER_REASON.P2P_UPLOAD_SLOW=1400035]="P2P_UPLOAD_SLOW",BUFFER_REASON[BUFFER_REASON.DEFAULT=0]="DEFAULT",exports.LOCAL_KEY=void 0,function(e){e.GUID="thumbplayer-h5-guid",e.VOLUME="thumbplayer-h5-volume"}(exports.LOCAL_KEY||(exports.LOCAL_KEY={})),exports.PersistedUserSettings=void 0,PersistedUserSettings=exports.PersistedUserSettings||(exports.PersistedUserSettings={}),PersistedUserSettings.definition="user-setting:definition",PersistedUserSettings.volume="user-setting:volume",PersistedUserSettings.playbackRate="user-setting:playbackRate",PersistedUserSettings.subtitle="user-setting:subtitle",PersistedUserSettings.audioTrack="user-setting:audioTrack";var DEFAULT_KEY={loginid:"",loginex:"",logintype:"",hh_ip:"",hc_main_login:"",hc_vuserid:"",hc_openid:"",hc_appid:"",hc_access_token:"",hc_vuession:"",vip:0,codec:CODEC.H264,freetype:0,videoCapability:"",mobile:0,guid:"",ua:"",uip:"",device:"",resolution:"",osver:"",p2pver:"",appVer:"",playerver:"",playertype:0,playercore:"",confid:"",downloadkit:0,online:1,p2p:0,sstrength:0,network:0,testid:0,curcore:"",curcorever:"",speed:0,quic:0,platform:"",flowid:"",vid:"",cid:"",columnId:"",livepid:"",interactid:"",url:"",referrer:"",topUrl:"",drm:0,drmtype:0,fmt:0,cdnid:0,dltype:"",rate:0,clip:0,status:0,duration:0,isPreload:0,type:0,cdnuip:"",cdnip:"",ptag:"",sdtfrom:"",authfrom:"",currentDefnList:[],currentDefn:"",currentAudioTrack:0,currentAudioTrackList:[],currentSubtitle:"",currentSubtitleList:[],sessionBufferCount:0,sessionRetryBackUrlCount:0,sessionRetryPlayCount:0},COMMON_DATA_KEY={},_a$1$1;Object.keys(DEFAULT_KEY).forEach((function(e){return COMMON_DATA_KEY[e]=e}));var FreezeKey="thumbplayer-h5-dataset",KeySystemToDrmType=(_a$1$1={},_a$1$1[KeySystems.Widevine]=DRM_TYPE.WIDEVINE,_a$1$1[KeySystems.FairPlay]=DRM_TYPE.FAIR_PLAY,_a$1$1[KeySystems.FairPlayWebKit]=DRM_TYPE.FAIR_PLAY,_a$1$1.none=DRM_TYPE.NONE,_a$1$1),confIdMap={default:0,hlsProgressive:1,hlsFragPrefetch:2},DataSet=function(e){function t(o,r,n){var i=e.call(this,o,r,n)||this;return i.player=o,i.isSeeking=!1,i.isBuffering=!1,i.isSettingLevel=!1,i.isLoading=!1,i.lastPlay=0,i.playDuration=0,i.prevPlayTimeS=0,i.sessionBufferCount=0,i.sessionRetryBackUrlCount=0,i.sessionRetryPlayCount=0,i.commonMapFreeze={},i.stateMapFreeze={},i.isLive=!1,i.isAdPlaying=!1,i.evtIdMap={},i.writeCommon=function(e,o,r){var n=i.commonMap[e];return i.commonMap[e]=o,t.canUseProxy||i.emit(exports.DATA_EVENTS.UPDATE,{key:e,oldVal:n,newVal:o}),!!r&&i.freeze("common",e,r)},i.writeState=function(e,o,r){var n=o.type||exports.LOG_TYPE.UNCATEGORIZED,a=i.stateMap[e],s=i.getStartEventData(e);return i.stateMap[e]=__assign$e(__assign$e(__assign$e({},n===exports.LOG_TYPE.CORE_EVENT?i.stats:{}),{type:n,ftime:+new Date,name:e,eventId:i.generateEvtId()}),o),!t.canUseProxy&&i.commonMap[COMMON_DATA_KEY.flowid]&&i.emit(exports.DATA_EVENTS.STATE_UPDATE,{key:e,oldVal:a,newVal:i.stateMap[e],startEvent:s}),!!r&&i.freeze("state",e,r)},i.onClose=function(){var e=+new Date;return{code:exports.ErrorCode.SUC,playDuration:i.playDuration,ftime:e}},i.getStats=function(){return __assign$e(__assign$e({playDuration:i.playDuration},i.stats),i.visualStats)},i.generateFlowId=function(){return comTool.createGUID(32)},i.generateEvtId=function(){return comTool.createGUID(8)},i.getStartEventData=function(e){var t;return((t={})[exports.DATA_STATE.SEEK_END]=i.stateMap[exports.DATA_STATE.SEEK_START],t[exports.DATA_STATE.BUFFER_END]=i.stateMap[exports.DATA_STATE.BUFFER_START],t[exports.DATA_STATE.LOAD_END]=i.stateMap[exports.DATA_STATE.LOAD_START],t[exports.DATA_STATE.SET_LEVEL_END]=i.stateMap[exports.DATA_STATE.SET_LEVEL_START],t[exports.DATA_STATE.PAUSE_END]=i.stateMap[exports.DATA_STATE.PAUSE_START],t[exports.DATA_STATE.GET_INFO_END]=i.stateMap[exports.DATA_STATE.GET_INFO_START],t)[e]},i.resetState=function(){i.isBuffering=!1,i.isSeeking=!1,i.isSettingLevel=!1},i.finalCleanup=function(e,t){var o,r,n=t.error,a=t.loadingUrl,s=t.config,l=null!==(r=null===(o=null==s?void 0:s.backupUrls)||void 0===o?void 0:o.findIndex((function(e){return e===a})))&&void 0!==r?r:-1;i.isSeeking&&(i.writeState(exports.DATA_STATE.SEEK_END,{currentUrl:a,urlIndex:l,type:exports.LOG_TYPE.CORE_EVENT,ftime:e,error:n,code:(null==n?void 0:n.code)||exports.ErrorCode.SUC,name:exports.DATA_STATE.SEEK_END,eventId:i.evtIdMap[exports.DATA_STATE.SEEK_START]}),i.isSeeking=!1),i.isBuffering&&(i.writeState(exports.DATA_STATE.BUFFER_END,{currentUrl:a,urlIndex:l,type:exports.LOG_TYPE.CORE_EVENT,ftime:e,code:(null==n?void 0:n.code)||exports.ErrorCode.SUC,error:n,name:exports.DATA_STATE.BUFFER_END,eventId:i.evtIdMap[exports.DATA_STATE.BUFFER_START]}),i.isBuffering=!1),i.isSettingLevel&&(i.isSettingLevel=!1,i.writeState(exports.DATA_STATE.SET_LEVEL_END,{currentUrl:a,urlIndex:l,type:exports.LOG_TYPE.CORE_EVENT,ftime:e,code:(null==n?void 0:n.code)||exports.ErrorCode.SUC,error:n,name:exports.DATA_STATE.SET_LEVEL_END,eventId:i.evtIdMap[exports.DATA_STATE.SET_LEVEL_START]})),i.isLoading&&(i.isLoading=!1,i.writeState(exports.DATA_STATE.LOAD_END,{type:exports.LOG_TYPE.CORE_EVENT,currentUrl:a,urlIndex:l,ftime:e,error:n,code:(null==n?void 0:n.code)||exports.ErrorCode.SUC,name:exports.DATA_STATE.LOAD_END,eventId:i.evtIdMap[exports.DATA_STATE.LOAD_START]})),i.isAdPlaying=!1},i.onAutoplayBlocked=function(e){i.writeState(exports.DATA_STATE.AUTO_PLAY_BLOCKED,{type:exports.LOG_TYPE.CORE_EVENT,name:exports.DATA_STATE.AUTO_PLAY_BLOCKED,eventId:i.generateEvtId(),ftime:+new Date})},i.onAdPlaying=function(e){e.data.adType===exports.AD_TYPE.PRE&&(i.isAdPlaying=!0)},i.onAdEnd=function(e){e.data.adType===exports.AD_TYPE.PRE&&(i.isAdPlaying=!1)},i.onRetryLoad=function(e){var t=e.data,o=t.prevUrl,r=t.curUrl,n=t.error,a=void 0===n?{}:n;i.writeState(exports.DATA_STATE.RETRY_BACKURL,{type:exports.LOG_TYPE.CORE_EVENT,name:exports.DATA_STATE.RETRY_BACKURL,eventId:i.generateEvtId(),prevUrl:o,currentUrl:r,ftime:+new Date,error:a,code:null==a?void 0:a.code}),i.sessionRetryBackUrlCount++,i.writeCommon(COMMON_DATA_KEY.sessionRetryBackUrlCount,i.sessionRetryBackUrlCount)},i.onRetryPlay=function(e){var t=e.data.retryTimes,o=void 0===t?0:t;i.writeState(exports.DATA_STATE.RETRY_PLAY,{type:exports.LOG_TYPE.CORE_EVENT,name:exports.DATA_STATE.RETRY_PLAY,eventId:i.generateEvtId(),ftime:+new Date,ext:{retryTimes:o}}),i.sessionRetryPlayCount++,i.writeCommon(COMMON_DATA_KEY.sessionRetryPlayCount,i.sessionRetryPlayCount)},i.onBuffering=function(e){if(!i.isBuffering){i.isBuffering=!0;var t=i.generateEvtId();i.evtIdMap[exports.DATA_STATE.BUFFER_START]=t,i.writeState(exports.DATA_STATE.BUFFER_START,{type:exports.LOG_TYPE.CORE_EVENT,name:exports.DATA_STATE.BUFFER_START,eventId:t,prevState:e.old,ftime:+new Date}),i.sessionBufferCount++,i.writeCommon(COMMON_DATA_KEY.sessionBufferCount,i.sessionBufferCount)}},i.onLoadStart=function(e){var t,o,r,n,a,s,l,c,p;i.resetState();var d=null===(t=e.videoInfo)||void 0===t?void 0:t.config,u=+new Date;i.writeCommon(COMMON_DATA_KEY.curcore,i.player.kernelName);var A=null===(o=KernelFactory$1.getKernelByName(i.player.kernelName))||void 0===o?void 0:o.VERSION;i.writeCommon(COMMON_DATA_KEY.curcorever,A),i.writeCommon(COMMON_DATA_KEY.drmtype,KeySystemToDrmType[(null===(r=d.drmConfig)||void 0===r?void 0:r.keySystem)||"none"]),i.writeCommon(COMMON_DATA_KEY.playertype,i.player.kernelName===exports.KERNEL_NAME.ORIGIN?"0":"1");var _=null===(s=null===(a=null===(n=i.player.corePlayer)||void 0===n?void 0:n.kernel)||void 0===a?void 0:a.getP2P)||void 0===s?void 0:s.call(a);if(i.writeCommon(COMMON_DATA_KEY.p2pver,null!==(c=null===(l=null==_?void 0:_.getVersion)||void 0===l?void 0:l.call(_))&&void 0!==c?c:0),i.writeCommon(COMMON_DATA_KEY.p2p,_?"1":"0"),i.player.kernelName===exports.KERNEL_NAME.HLS_JS&&!_){var E=+(null!==(p=i.player.config.enableP2P)&&void 0!==p?p:2),g=+!!i.player.currentVideoInfo.config.p2pConfig;i.writeCommon(COMMON_DATA_KEY.confid,"7003".concat(E).concat(g))}i.isLoading=!0;var f=i.generateEvtId();i.evtIdMap[exports.DATA_STATE.LOAD_START]=f,i.writeState(exports.DATA_STATE.LOAD_START,{type:exports.LOG_TYPE.CORE_EVENT,eventId:f,name:exports.DATA_STATE.LOAD_START,ftime:u})},i.onEnd=function(e){i.writeState(exports.DATA_STATE.END,{type:exports.LOG_TYPE.CORE_EVENT,name:exports.DATA_STATE.END,eventId:i.generateEvtId(),ftime:+new Date,ext:{playDuration:i.playDuration},code:exports.ErrorCode.SUC})},i.onIdle=function(e,t){},i.onSeeking=function(e){var t,o,r=+new Date;i.isSeeking&&i.writeState(exports.DATA_STATE.SEEK_END,{type:exports.LOG_TYPE.CORE_EVENT,name:exports.DATA_STATE.SEEK_END,ftime:r,eventId:i.evtIdMap[exports.DATA_STATE.SEEK_START],ext:{isUserSeek:(null===(o=null===(t=i.stateMap[exports.DATA_STATE.SEEK_START])||void 0===t?void 0:t.ext)||void 0===o?void 0:o.isUserSeek)||!1}}),i.isLive||i.resetState(),i.isSeeking=!0;var n=i.generateEvtId();i.evtIdMap[exports.DATA_STATE.SEEK_START]=n,i.writeState(exports.DATA_STATE.SEEK_START,{type:exports.LOG_TYPE.CORE_EVENT,ftime:r,name:exports.DATA_STATE.SEEK_START,eventId:n,ext:{inBufferedRange:videoTool.checkTimeInBuffer(e.seekingTime,i.player.videoBuffered),isUserSeek:e.isUserSeek}})},i.onSeeked=function(e){i.isSeeking&&(i.isSeeking=!1,i.writeState(exports.DATA_STATE.SEEK_END,{type:exports.LOG_TYPE.CORE_EVENT,eventId:i.evtIdMap[exports.DATA_STATE.SEEK_START],ftime:+new Date,name:exports.DATA_STATE.SEEK_END,ext:{isUserSeek:e.isUserSeek},code:exports.ErrorCode.SUC}))},i.onPause=function(e){var t=e.pauseType,o=i.generateEvtId();i.evtIdMap[exports.DATA_STATE.PAUSE_START]=o,i.writeState(exports.DATA_STATE.PAUSE_START,{type:exports.LOG_TYPE.CORE_EVENT,ftime:+new Date,name:exports.DATA_STATE.PAUSE_START,eventId:o,pauseType:t})},i.onPlaying=function(e){var t=+new Date;i.isBuffering&&(i.writeState(exports.DATA_STATE.BUFFER_END,{type:exports.LOG_TYPE.CORE_EVENT,name:exports.DATA_STATE.BUFFER_END,ftime:t,eventId:i.evtIdMap[exports.DATA_STATE.BUFFER_START]}),i.isBuffering=!1),i.lastPlay=t,i.evtIdMap[exports.DATA_STATE.PAUSE_START]&&(i.writeState(exports.DATA_STATE.PAUSE_END,{type:exports.LOG_TYPE.CORE_EVENT,name:exports.DATA_STATE.PAUSE_END,eventId:i.evtIdMap[exports.DATA_STATE.PAUSE_START],ftime:t,code:exports.ErrorCode.SUC}),delete i.evtIdMap[exports.DATA_STATE.PAUSE_START])},i.onCanPlay=function(e){if(i.isLoading){var t=+new Date;i.writeState(exports.DATA_STATE.LOAD_END,{type:exports.LOG_TYPE.CORE_EVENT,ftime:t,name:exports.DATA_STATE.LOAD_END,eventId:i.evtIdMap[exports.DATA_STATE.LOAD_START],code:exports.ErrorCode.SUC,ext:{isAdPlaying:i.isAdPlaying}}),i.isLoading=!1}},i.onCodecDegrade=function(e){var t,o=+new Date;i.writeState(exports.DATA_STATE.CODEC_DEGRADE,{type:exports.LOG_TYPE.CORE_EVENT,ftime:o,name:exports.DATA_STATE.CODEC_DEGRADE,code:null!==(t=e.data.degradeReason)&&void 0!==t?t:exports.ErrorCode.SUC})},i.onSetLevelStart=function(e){var t=+new Date;i.isSeeking&&(i.isSeeking=!1,i.writeState(exports.DATA_STATE.SEEK_END,{type:exports.LOG_TYPE.CORE_EVENT,name:exports.DATA_STATE.SEEK_END,ftime:t,eventId:i.evtIdMap[exports.DATA_STATE.SEEK_START]})),i.resetState(),i.isSettingLevel=!0;var o=i.generateEvtId();i.evtIdMap[exports.DATA_STATE.SET_LEVEL_START]=o,i.writeState(exports.DATA_STATE.SET_LEVEL_START,{type:exports.LOG_TYPE.CORE_EVENT,ftime:t,eventId:o,name:exports.DATA_STATE.SET_LEVEL_START,ext:{defn:i.commonMap.currentDefn,mode:e.data.mode}})},i.onSetLevelEnd=function(e){var t=e.data,o=((void 0===t?{}:t).videoInfo||{}).error;i.isSettingLevel=!1,i.writeCommon(COMMON_DATA_KEY.curcore,i.player.kernelName),i.writeState(exports.DATA_STATE.SET_LEVEL_END,{type:exports.LOG_TYPE.CORE_EVENT,name:exports.DATA_STATE.SET_LEVEL_END,ftime:+new Date,eventId:i.evtIdMap[exports.DATA_STATE.SET_LEVEL_START],error:o,code:(null==o?void 0:o.code)||exports.ErrorCode.SUC})},i.onError=function(e){var t,o,r=(e.data||{}).videoInfo,n=r||{},a=n.error,s=n.state,l=n.currentFragSn,c=n.currentFragUrl,p=n.loadingUrl,d=n.config,u=+new Date;i.writeState(exports.DATA_STATE.ERROR,{currentUrl:p,urlIndex:null!==(o=null===(t=null==d?void 0:d.backupUrls)||void 0===t?void 0:t.findIndex((function(e){return e===p})))&&void 0!==o?o:-1,type:exports.LOG_TYPE.CORE_EVENT,name:exports.DATA_STATE.ERROR,eventId:i.generateEvtId(),fragUrl:c,ext:{fragSn:l},code:a.code,error:a,ftime:u,prevState:s}),i.finalCleanup(u,r)},i.onDurationChange=function(e){var t=e.data,o=((void 0===t?{}:t).videoInfo||{}).duration,r=void 0===o?0:o;i.commonMap.duration=r},i.onFirstPlay=function(e){var t=+new Date;i.writeState(exports.DATA_STATE.FIRST_PLAY,{type:exports.LOG_TYPE.CORE_EVENT,name:exports.DATA_STATE.FIRST_PLAY,ftime:t,eventId:i.generateEvtId()})},i.onTimeChange=function(e){var t=Math.floor(i.player.playtime);t&&t!==i.prevPlayTimeS&&(i.prevPlayTimeS=t,i.playDuration||(i.playDuration=0),i.playDuration+=1)},i.onStateChange=function(e){var t,o=e.data,r=o.new,n=((t={})[exports.VIDEO_STATE.BUFFERING]=i.onBuffering,t[exports.VIDEO_STATE.LOAD_START]=i.onLoadStart,t[exports.VIDEO_STATE.END]=i.onEnd,t[exports.VIDEO_STATE.IDLE]=i.onIdle,t[exports.VIDEO_STATE.SEEKING]=i.onSeeking,t[exports.VIDEO_STATE.SEEKED]=i.onSeeked,t[exports.VIDEO_STATE.PAUSE]=i.onPause,t[exports.VIDEO_STATE.PLAYING]=i.onPlaying,t[exports.VIDEO_STATE.CANPLAY]=i.onCanPlay,t[exports.VIDEO_STATE.SEEKING]=i.onSeeking,t);n[r]&&n[r](o)},i.onRateChange=function(e){i.writeState(exports.DATA_STATE.SET_RATE,{type:exports.LOG_TYPE.CORE_EVENT,name:exports.DATA_STATE.SET_RATE,eventId:i.generateEvtId(),ftime:+new Date})},i.onVideoReqInfoStart=function(){var e=i.generateEvtId();i.evtIdMap[exports.DATA_STATE.GET_INFO_START]=e,i.writeState(exports.DATA_STATE.GET_INFO_START,{type:exports.LOG_TYPE.CORE_EVENT,name:exports.DATA_STATE.GET_INFO_START,eventId:e,ftime:+new Date})},i.onVideoReqInfoEnd=function(e){var t=e.data,o=t.code,r=t.data,n=void 0===r?{}:r;i.sessionRetryBackUrlCount=0,i.evtIdMap[exports.DATA_STATE.GET_INFO_START]&&i.writeState(exports.DATA_STATE.GET_INFO_END,{type:exports.LOG_TYPE.CORE_EVENT,name:exports.DATA_STATE.GET_INFO_END,code:o,ext:{reqBody:urlTool.object2string(n.reqParams||{},"&"),reqPath:n.reqPath||"",retryCount:n.alreadyRetryCount||0},error:n.error||{},eventId:i.evtIdMap[exports.DATA_STATE.GET_INFO_START],ftime:+new Date})},i.onPlaySessionStart=function(e){var t=e.data;i.writeCommon(COMMON_DATA_KEY.flowid,t.flowid),i.writeCommon(COMMON_DATA_KEY.isPreload,Number(t.isPreload)),isVideoId(t.playItem)&&i.writeCommon(COMMON_DATA_KEY.vid,t.playItem),i.emit(exports.DATA_EVENTS.STATE_UPDATE,{key:exports.DATA_STATE.INIT,oldVal:void 0,newVal:i.stateMap[exports.DATA_STATE.INIT],startEvent:void 0}),i.writeState(exports.DATA_STATE.SESSION_START,{eventId:i.generateEvtId(),type:exports.LOG_TYPE.CORE_EVENT,name:exports.DATA_STATE.SESSION_START,ftime:+new Date})},i.onPlaySessionEnd=function(e){var t=e.data.code,o=t===exports.ErrorCode.SUC?__assign$e({},i.stateMap[exports.DATA_STATE.END]):__assign$e({},i.stateMap[exports.DATA_STATE.ERROR]);t!==exports.ErrorCode.SUC&&i.removeUserSetting([exports.PersistedUserSettings.definition,exports.PersistedUserSettings.audioTrack]),i.writeState(exports.DATA_STATE.SESSION_END,__assign$e(__assign$e({},o),{code:t,eventId:i.generateEvtId(),name:exports.DATA_STATE.SESSION_END,type:exports.LOG_TYPE.CORE_EVENT,ftime:+new Date})),i.playDuration=0,i.prevPlayTimeS=0,i.sessionBufferCount=0,i.sessionRetryBackUrlCount=0,i.sessionRetryPlayCount=0},i.getGUID=function(){var e=lsTool.getData(exports.LOCAL_KEY.GUID);if(e)return e;var t=comTool.createGUID(32);return lsTool.setData(exports.LOCAL_KEY.GUID,t),t},i.isTabFocused=function(){var e=["hidden","msHidden","webkitHidden"].find((function(e){return void 0!==document[e]}));return e?document[e]?0:1:-1},i.isPlayerInViewport=function(){var e=i.player.container;if(!e.offsetParent)return 0;var t=e.getBoundingClientRect(),o=window.innerHeight||document.documentElement.clientHeight,r=window.innerWidth||document.documentElement.clientWidth,n=t.top<=o&&t.top+t.height>=0,a=t.left<=r&&t.left+t.width>=0;return+(n&&a)},i.commonMap=t.canUseProxy?new Proxy({},{get:function(e,t,o){return Reflect.get(e,t,o)},set:function(e,t,o,r){if("string"!=typeof t)return!1;if(i.commonMapFreeze[t])return!1;var n=Reflect.get(e,t,r),a=Reflect.set(e,t,o,r);return n!==o&&i.emit(exports.DATA_EVENTS.UPDATE,{key:t,oldVal:n,newVal:o}),a}}):{},i.stateMap=t.canUseProxy?new Proxy({},{get:function(e,t,o){return Reflect.get(e,t,o)},set:function(e,t,o,r){if("string"!=typeof t)return!1;if(i.stateMapFreeze[t])return!1;var n=Reflect.get(e,t,r),a=Reflect.set(e,t,o,r);return i.commonMap[COMMON_DATA_KEY.flowid]&&i.emit(exports.DATA_EVENTS.STATE_UPDATE,{key:t,oldVal:n,newVal:o,startEvent:i.getStartEventData(t),startEventData:i.getStartEventData(t)}),a}}):{},i.isLive=i.player.config.type===exports.PLAY_MODE.LIVE,i.setEnv(),i.collectBaseInfo(),i.collectVideoCapability(),i.persistUserSetting(),i}return __extends$d(t,e),Object.defineProperty(t.prototype,"stats",{get:function(){var e,t,o,r,n,i,a,s=this.player,l=s.playbackRate,c=s.volume,p=s.played,d=s.playtime,u=s.currentVideoInfo;return{volume:c,playbackRate:l,played:p,playtime:d,urlIndex:null!==(o=null===(t=null===(e=null==u?void 0:u.config)||void 0===e?void 0:e.backupUrls)||void 0===t?void 0:t.findIndex((function(e){return e===u.loadingUrl})))&&void 0!==o?o:-1,frameDroppedInPercentage:null!==(n=null===(r=null==u?void 0:u.qualityInfo)||void 0===r?void 0:r.frameDroppedInPercentage)&&void 0!==n?n:-1,averageDecodeTimeInMs:null!==(a=null===(i=null==u?void 0:u.qualityInfo)||void 0===i?void 0:i.averageDecodeTimeInMs)&&void 0!==a?a:-1,currentUrl:null==u?void 0:u.loadingUrl,paused:this.paused,fragUrl:null==u?void 0:u.currentFragUrl}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"visualStats",{get:function(){return{isTabFocused:this.isTabFocused(),isPlayerInViewport:this.isPlayerInViewport()}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"paused",{get:function(){var e,t;return null===(t=null===(e=this.player)||void 0===e?void 0:e.currentVideoElement)||void 0===t?void 0:t.paused},enumerable:!1,configurable:!0}),t.prototype.defrost=function(e,t,o){switch(void 0===o&&(o="secret"),e){case"state":return this.stateMapFreeze[t]===o&&(delete this.stateMapFreeze[t],!0);case"common":return this.commonMapFreeze[t]===o&&(delete this.commonMapFreeze[t],!0)}},t.prototype.freeze=function(e,t,o){switch(void 0===o&&(o="secret"),e){case"state":return this.stateMapFreeze[t]?(this.player.log("".concat(t,"已锁定")),!1):(this.stateMapFreeze[t]=o,!0);case"common":return this.commonMapFreeze[t]?(this.player.log("".concat(t,"已锁定")),!1):(this.commonMapFreeze[t]=o,!0);default:return!1}},t.prototype.setEnv=function(){var e=this;this.player.on(exports.PLAY_EVENT.STATE_CHANGE,this.onStateChange),this.player.on(exports.PLAY_EVENT.FIRST_PLAYING,this.onFirstPlay),this.player.on(exports.PLAY_EVENT.TIME_UPDATE,this.onTimeChange),this.player.on(exports.PLAY_EVENT.DURATION_CHANGE,this.onDurationChange),this.player.on(exports.PLAY_EVENT.ERROR,this.onError),this.player.on(exports.PLAY_EVENT.SETLEVEL_START,this.onSetLevelStart),this.player.on(exports.PLAY_EVENT.SETLEVEL_OVER,this.onSetLevelEnd),this.player.on(exports.PLAY_EVENT.RATE_CHANGE,this.onRateChange),this.player.on(exports.PLAY_EVENT.RETRY_BACKURL,this.onRetryLoad),this.player.on(exports.PLAY_EVENT.AUTOPLAY_BLOCKED,this.onAutoplayBlocked),this.player.on(exports.H5_PLAY_EVENT.AD_PLAYING,this.onAdPlaying),this.player.on(exports.H5_PLAY_EVENT.AD_END,this.onAdEnd),this.player.on(exports.H5_PLAY_EVENT.VIDEO_REQ_INFO_START,this.onVideoReqInfoStart),this.player.on(exports.H5_PLAY_EVENT.VIDEO_REQ_INFO_END,this.onVideoReqInfoEnd),this.player.on(exports.H5_PLAY_EVENT.PLAY_SESSION_START,this.onPlaySessionStart),this.player.on(exports.H5_PLAY_EVENT.PLAY_SESSION_END,this.onPlaySessionEnd),this.player.on(exports.H5_PLAY_EVENT.VIDEO_REQ_INFO_END,(function(t){var o=t.data;if(o.code!==exports.ErrorCode.SUC){var r=o.data,n=((null==r?void 0:r.error)||{}).code;e.writeState(exports.DATA_STATE.ERROR,{eventId:e.generateEvtId(),type:exports.LOG_TYPE.CORE_EVENT,name:exports.DATA_STATE.ERROR,code:n,ftime:+new Date})}})),this.msg.on(exports.PLAY_EVENT_EXT.RETRY_PLAY,this.onRetryPlay),this.msg.on(exports.PLAY_EVENT_EXT.DEGRADE_CODEC_PLAY,this.onCodecDegrade)},t.prototype.collectBaseInfo=function(){var e=uaTool.os,t=uaTool.mobile;this.writeCommon(COMMON_DATA_KEY.mobile,t?1:0,FreezeKey),this.writeCommon(COMMON_DATA_KEY.online,1,FreezeKey),this.writeCommon(COMMON_DATA_KEY.resolution,"".concat(screen.width,"*").concat(screen.height,"*").concat(window.devicePixelRatio||1),FreezeKey),this.writeCommon(COMMON_DATA_KEY.ua,navigator.userAgent.replace(/,/g,"\\,"),FreezeKey),this.writeCommon(COMMON_DATA_KEY.osver,"".concat(e.osName," ").concat(e.version),FreezeKey),this.writeCommon(COMMON_DATA_KEY.playertype,0),this.writeCommon(COMMON_DATA_KEY.confid,confIdMap.default),this.writeCommon(COMMON_DATA_KEY.playercore,Object.keys(KernelFactory$1.kernelMap).join(","),FreezeKey),this.writeCommon(COMMON_DATA_KEY.playerver,VERSION$3),this.writeCommon(COMMON_DATA_KEY.speed,0),this.writeCommon(COMMON_DATA_KEY.drm,0),this.writeCommon(COMMON_DATA_KEY.url,location.href,FreezeKey),this.writeCommon(COMMON_DATA_KEY.topUrl,urlTool.getTopFrameUrl(),FreezeKey),this.writeCommon(COMMON_DATA_KEY.referrer,document.referrer,FreezeKey),this.writeCommon(COMMON_DATA_KEY.guid,this.getGUID())},t.prototype.collectVideoCapability=function(){try{var e={concurrency:navigator.hardwareConcurrency},t={av1:+videoTool.supportAV1(),hevc:+videoTool.supportHevc(),dolby:+videoTool.isDolbyVisionSupported()},o={hls:+videoTool.supportVideoFormat().includes("hls")},r=videoTool.isHDRSupported(),n=jsonTool.safelyStringify({codec:t,format:o,hdr:r,hw:e,wasm:+videoTool.isWasmSupported()}).replace(/,/g,"\\,");this.writeCommon(COMMON_DATA_KEY.videoCapability,n),this.log("device capability info: ".concat(n))}catch(e){}},t.prototype.persistUserSetting=function(){var e=this,o={},r=this.player.config,n=r.disableUserSettingCache,i=r.type,a=function(e){var t;return(null===(t=null==n?void 0:n.indexOf)||void 0===t?void 0:t.call(n,e))>-1};t.SETTING_CONFIG.forEach((function(t){var r=t.dsKey,n=t.lsKey,s=t.oldDsKey,l="".concat(n,"_").concat(i);if(!(a(r)||s&&a(s))){o[r]=l;var c=lsTool.getData(l);c&&r&&e.writeCommon(r,c)}})),this.msg.on(exports.PLAY_EVENT_EXT.DATASET_UPDATE,(function(e){var t=e.data,r=t.newVal,n=t.key;o[n]&&lsTool.setData(o[n],r)}))},t.prototype.removeUserSetting=function(e){var t=this;("string"==typeof e?[e]:e).forEach((function(e){t.writeCommon(e,"")}))},t.pluginName="dataset",t.UserSettingKeyPrefix="__thumbplayer_setting_",t.SETTING_CONFIG=[{oldDsKey:COMMON_DATA_KEY.currentDefn,dsKey:exports.PersistedUserSettings.definition,lsKey:"".concat(t.UserSettingKeyPrefix,"_definition")},{oldDsKey:COMMON_DATA_KEY.currentSubtitle,dsKey:exports.PersistedUserSettings.subtitle,lsKey:"".concat(t.UserSettingKeyPrefix,"_subtitle")},{oldDsKey:COMMON_DATA_KEY.currentAudioTrack,dsKey:exports.PersistedUserSettings.audioTrack,lsKey:"".concat(t.UserSettingKeyPrefix,"_audioTrack")},{dsKey:exports.PersistedUserSettings.volume,lsKey:"".concat(t.UserSettingKeyPrefix,"_volume")},{dsKey:exports.PersistedUserSettings.playbackRate,lsKey:"".concat(t.UserSettingKeyPrefix,"_playbackRate")}],t.canUseProxy=void 0!==window.Proxy,t}(Plugin);function proxyPlayEvent(e,t){var o,r=((o={})[exports.PLAY_EVENT.DURATION_CHANGE]={evt:exports.H5_PLAY_EVENT.VIDEO_DURATION_CHANGE,getParam:function(e){return{duration:e.videoInfo.duration}}},o[exports.PLAY_EVENT.METADATA_CHANGE]={evt:exports.H5_PLAY_EVENT.VIDEO_METADATA_CHANGE,getParam:function(e){return{width:e.videoInfo.videoWidth,height:e.videoInfo.videoHeight}}},o[exports.PLAY_EVENT.VIDEO_BUFFER_CHANGE]={evt:exports.H5_PLAY_EVENT.VIDEO_LOAD_PROGRESS,getParam:function(){return{bufferRange:e.videoBuffered}}},o[exports.PLAY_EVENT.TIME_UPDATE]={evt:exports.H5_PLAY_EVENT.VIDEO_TIMEUPDATE,getParam:function(e){return{playtime:e.videoInfo.playtime}}},o[exports.PLAY_EVENT.VOLUME_CHANGE]={evt:exports.H5_PLAY_EVENT.VIDEO_VOLUME_CHANGE,getParam:function(){return{volume:e.volume}}},o[exports.PLAY_EVENT.RATE_CHANGE]={evt:exports.H5_PLAY_EVENT.VIDEO_RATE_CHANGE,getParam:function(){return{rate:e.playbackRate}}},o[exports.PLAY_EVENT.VIDEO_RESIZE]={evt:exports.H5_PLAY_EVENT.VIDEO_RESIZE,getParam:function(e){return{videoWidth:e.videoInfo.videoWidth,videoHeight:e.videoInfo.videoHeight}}},o[exports.PLAY_EVENT.AUTOPLAY_BLOCKED]={evt:exports.H5_PLAY_EVENT.VIDEO_AUTOPLAY_BLOCKED,getParam:function(){}},o[exports.PLAY_EVENT.SETLEVEL_OVER]={evt:exports.H5_PLAY_EVENT.VIDEO_SETLEVEL_END,getParam:function(e){var t,o,r,n=null!==(r=null===(o=null===(t=e.videoInfo)||void 0===t?void 0:t.error)||void 0===o?void 0:o.code)&&void 0!==r?r:exports.ErrorCode.UNKNOWN;return{code:e.fail?n:exports.ErrorCode.SUC}}},o);Object.keys(r).forEach((function(o){t.on(o,(function(t){var n=r[o],i=n.evt,a=n.getParam;e.emit(i,a(t.data))}))}))}var adEvents=[exports.H5_PLAY_EVENT.AD_REQ_INFO_START,exports.H5_PLAY_EVENT.AD_REQ_INFO_END,exports.H5_PLAY_EVENT.AD_REQ_ASSETS_START,exports.H5_PLAY_EVENT.AD_ASSETS_LOADED,exports.H5_PLAY_EVENT.AD_END,exports.H5_PLAY_EVENT.AD_PLAYING,exports.H5_PLAY_EVENT.AD_AUTOPLAY_BLOCKED,exports.H5_PLAY_EVENT.AD_PAUSE,exports.H5_PLAY_EVENT.AD_RESUME,exports.H5_PLAY_EVENT.AD_TIME_UPDATE,exports.H5_PLAY_EVENT.AD_VOLUME_CHANGE],FullScreenMode;function proxyAdEvent(e){var t=getAdPlugin(e.config.instanceId);t&&adEvents.forEach((function(o){t.on(o,(function(t){var r=t.data;e.emit(o,r)}))}))}function requestFakeFullScreen(e,t){void 0===t&&(t=!0),domTool.insertStyle(styleStr,styleTag),e.classList.toggle(FakeFullscreenClass,t)}function isFakeFullscreen(e){return e.classList.contains(FakeFullscreenClass)}exports.FullScreenMode=void 0,FullScreenMode=exports.FullScreenMode||(exports.FullScreenMode={}),FullScreenMode.FAKE_FULLSCREEN="fakeFullscreen",FullScreenMode.FULL_SCREEN="fullscreen";var FakeFullscreenClass="thumbplayer-fake-fullscreen",styleTag="thumbplayer-fake-fullscreen-style",styleStr="\n.".concat(FakeFullscreenClass," {\n  position: fixed !important;\n  top: 0 !important;\n  right: 0 !important;\n  bottom: 0 !important;\n  left: 0 !important;\n  width: 100% !important;\n  height: 100% !important;\n  z-index: 9999 !important;\n}\n");function requestElFullScreen(e,t){if(void 0===t&&(t=!0),!(e instanceof HTMLElement))return Promise.reject("requestElFullScreen: container is not an element");var o=function(e){var t;return null===(t=e.requestFullscreen||e.mozRequestFullScreen||e.webkitRequestFullscreen||e.webkitRequestFullScreen||e.msRequestFullscreen)||void 0===t?void 0:t.bind(e)},r=function(e){var t;return null===(t=e.cancelFullScreen||e.mozCancelFullScreen||e.webkitCancelFullScreen||e.exitFullscreen||e.webkitExitFullscreen||e.msExitFullscreen)||void 0===t?void 0:t.bind(e)},n=o(e)||o(document),i=r(e)||r(document),a=t?n:i;try{return Promise.resolve(a())}catch(e){return Promise.reject(e)}}function requestVideoFullScreen(e,t){return void 0===t&&(t=!0),__awaiter$9(this,void 0,void 0,(function(){var o,r;return __generator$9(this,(function(n){if(!(e&&e instanceof HTMLVideoElement))throw new Error("videoRequestFullScreen: video is not an VideoElement");if(o=e.requestFullscreen||e.webkitEnterFullscreen||e.webkitRequestFullScreen,!(r=t?o:e.webkitExitFullscreen))throw new Error("Video Fullscreen API is not supported.");return[2,r.call(e)]}))}))}function isElFullScreen(e){if(!e)return!1;var t=document;if(!(t.fullscreen||t.mozFullScreen||t.webkitIsFullScreen||t.msFullscreenElement))return!1;var o=t.fullscreenElement||t.webkitFullscreenElement||t.mozFullScreenElement||t.msFullscreenElement;return o===e||o===document}function isVideoFullScreen(e){return!!e&&((e.webkitDisplayingFullscreen||"fullscreen"===e.webkitPresentationMode)&&!isEnterPipInApple(e))}function isEnterPipInApple(e){return!(!uaTool.os.ios&&!uaTool.browser.safari)&&(document.pictureInPictureEnabled||document.pictureInPictureElement===e)}var VIDEO_FULLSCREEN_TAG="fullscreen_handler",fullscreenEvents=["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"],FullScreenLogics=function(){function e(e,t){var o=this;this.player=e,this.onVideoLoadStart=function(){o.player.videoElements.forEach((function(e){e instanceof HTMLVideoElement&&!e.dataset[VIDEO_FULLSCREEN_TAG]&&o.bindVideoElFullscreenEvt(e,!0)}))},this.onPlaySessionEnd=function(){uaTool.mobile&&o.fullscreenMode===exports.FullScreenMode.FULL_SCREEN&&o.requestFullScreen(!1,exports.FullScreenMode.FULL_SCREEN)},this.fullscreenChangeHandler=function(){var e=o.fullscreenMode;o.player.emit(exports.PLAY_EVENT.FULLSCREEN_CHANGE,{isEnter:e===exports.FullScreenMode.FULL_SCREEN,mode:exports.FullScreenMode.FULL_SCREEN})},this.logger=new Logger(e.config.instanceId,"FullscreenLogics"),this.container=t||e.container,this.listenFullScreenEvts(!0)}return Object.defineProperty(e.prototype,"fullscreenMode",{get:function(){var e=this.container,t=this.player.currentVideoElement,o=this.player.config.videoElements;return isElFullScreen(e)||isVideoFullScreen(t)||o[0]instanceof HTMLVideoElement&&isVideoFullScreen(o[0])?exports.FullScreenMode.FULL_SCREEN:isFakeFullscreen(e)?exports.FullScreenMode.FAKE_FULLSCREEN:null},enumerable:!1,configurable:!0}),e.prototype.requestFullScreen=function(e,t){return void 0===e&&(e=!0),__awaiter$9(this,void 0,void 0,(function(){var o,r,n,i,a,s,l,c;return __generator$9(this,(function(p){switch(p.label){case 0:if(o=this.container,r=this.player,n=r.currentVideoElement,i=r.config,a=i.videoElements,s=this.fullscreenMode,l=this.getFullScreenMode(t),e&&s){if(s===l)return[2];this.requestFullScreen(!1,s)}if(!e&&!s||!e&&s!==l)return[2];p.label=1;case 1:if(p.trys.push([1,7,,8]),l===exports.FullScreenMode.FAKE_FULLSCREEN)return requestFakeFullScreen(o,e),this.player.emit(exports.PLAY_EVENT.FULLSCREEN_CHANGE,{isEnter:e,mode:l}),[2];p.label=2;case 2:return p.trys.push([2,4,,6]),[4,requestElFullScreen(o,e)];case 3:return p.sent(),[3,6];case 4:return p.sent(),[4,requestVideoFullScreen(n||a[0],e)];case 5:return p.sent(),[3,6];case 6:return[3,8];case 7:throw c=p.sent(),this.logger.error("@FullscreenLogics.requestFullScreen, isEnter=".concat(e,", mode=").concat(l,", err=").concat(c)),c;case 8:return[2]}}))}))},e.prototype.destroy=function(){this.listenFullScreenEvts(!1)},e.prototype.getFullScreenMode=function(e){return e||(!uaTool.mobile||uaTool.os.ios?exports.FullScreenMode.FULL_SCREEN:exports.FullScreenMode.FAKE_FULLSCREEN)},e.prototype.listenFullScreenEvts=function(e){var t,o=this;void 0===e&&(e=!0);var r=e?document.addEventListener.bind(document):document.removeEventListener.bind(document),n=e?this.player.on.bind(this.player):this.player.off.bind(this.player);n(exports.H5_PLAY_EVENT.VIDEO_LOAD_START,this.onVideoLoadStart),n(exports.H5_PLAY_EVENT.PLAY_SESSION_END,this.onPlaySessionEnd),fullscreenEvents.forEach((function(e){r(e,o.fullscreenChangeHandler)})),e||null===(t=this.player.videoElements)||void 0===t||t.forEach((function(e){e instanceof HTMLVideoElement&&o.bindVideoElFullscreenEvt(e,!1)}))},e.prototype.bindVideoElFullscreenEvt=function(e,t){var o=t?e.addEventListener.bind(e):e.removeEventListener.bind(e);o("webkitendfullscreen",this.fullscreenChangeHandler),o("webkitbeginfullscreen",this.fullscreenChangeHandler),t?e.dataset[VIDEO_FULLSCREEN_TAG]=String(!0):delete e.dataset[VIDEO_FULLSCREEN_TAG]},e}(),ReportSource,BridgeMessageName;!function(e){e.WHITE_LIST="white"}(ReportSource||(ReportSource={})),function(e){e.STORAGE_INIT_FAILED="storageInitFailed",e.STORAGE_READY="storageReady",e.REQUEST_STORE_LOG="requestStoreLog",e.STORE_LOG_SUCCESS="storeLogSuccess",e.STORE_LOG_FAILED="storeLogFailed",e.REQUEST_REPORT_LOG="requestReportLog",e.REPORT_LOG_SUCCESS="reportLogSuccess",e.REPORT_LOG_FAILED="reportLogFailed",e.REPORT_PROGRESS="reportProgress",e.REQUEST_DOWNLOAD_LOG="requestDownloadLog"}(BridgeMessageName||(BridgeMessageName={}));var REMOTE_STORAGE_CLASS_NAME="thumbplayer-remote-storage-bridge",DEFAULT_IFRAME_TIMEOUT=1e4,REPORT_TIMEOUT=3e4,MessageBridge=function(){function e(e,t){var o=this;this.sender=e,this.receiver=t,this.callbackMap={},this.hasDestroy=!1,this.onReceiverMessage=function(e){o.receiverMessageHandler(e)},this.sender.addEventListener("message",this.onReceiverMessage)}return e.prototype.postMessage=function(e){if(this.hasDestroy)throw new Error("Cannot exec postMessage after destroy");this.receiver.postMessage(e,"*")},e.prototype.on=function(e,t){this.hasDestroy||(this.callbackMap[e]||(this.callbackMap[e]=[]),this.callbackMap[e].push(t))},e.prototype.off=function(e,t){if(!this.hasDestroy){var o=this.callbackMap[e];if(null==o?void 0:o.length){var r=o.indexOf(t);-1!==r&&o.splice(r,1)}}},e.prototype.destroy=function(){var e;this.hasDestroy=!0,null===(e=this.sender)||void 0===e||e.removeEventListener("message",this.onReceiverMessage),this.sender=null,this.receiver=null,this.callbackMap=null},e.prototype.receiverMessageHandler=function(e){var t,o=this;if(this.isBridgeMessage(e.data)&&!this.hasDestroy){var r=e.data;null===(t=this.callbackMap[r.name])||void 0===t||t.forEach((function(e){e(r,o.postMessage.bind(o))}))}},e.prototype.isBridgeMessage=function(e){return"object"==typeof e&&"string"==typeof(null==e?void 0:e.name)&&"string"==typeof(null==e?void 0:e.instanceId)},e}(),RemoteStorageBridge=function(e){function t(o,r,n){void 0===n&&(n=DEFAULT_IFRAME_TIMEOUT);var i=e.call(this,self,t.getIframe(o,n).contentWindow)||this;return i.instanceId=r,i.timeout=n,t.instanceCount+=1,i}return __extends$d(t,e),t.getIframe=function(e,o){if(void 0===o&&(o=DEFAULT_IFRAME_TIMEOUT),t.iframeEl)return t.iframeEl;var r=document.createElement("iframe");return r.src=e,document.body.append(r),r.style.display="none",r.classList.add(REMOTE_STORAGE_CLASS_NAME),t.iframeEl=r,t.rejectTimeout=window.setTimeout((function(){t.storageDefer.reject(new Error("IFrame wait timeout"))}),o),r},t.prototype.storeLogs=function(e){return __awaiter$9(this,void 0,void 0,(function(){return __generator$9(this,(function(o){switch(o.label){case 0:return[4,t.storageDefer.promise];case 1:return o.sent(),[4,this.postMessagePromise({message:{name:BridgeMessageName.REQUEST_STORE_LOG,instanceId:this.instanceId,data:e},resolveMessageName:BridgeMessageName.STORE_LOG_SUCCESS,rejectMessageName:BridgeMessageName.STORE_LOG_FAILED})];case 2:return o.sent(),[2]}}))}))},t.prototype.report=function(e,o){return __awaiter$9(this,void 0,void 0,(function(){return __generator$9(this,(function(r){switch(r.label){case 0:return[4,t.storageDefer.promise];case 1:return r.sent(),[4,this.postMessagePromise({message:{name:BridgeMessageName.REQUEST_REPORT_LOG,instanceId:this.instanceId,data:e},resolveMessageName:BridgeMessageName.REPORT_LOG_SUCCESS,rejectMessageName:BridgeMessageName.REPORT_LOG_FAILED,progressMessageName:BridgeMessageName.REPORT_PROGRESS,onProgress:o,timeout:REPORT_TIMEOUT})];case 2:return r.sent(),[2]}}))}))},t.prototype.downloadLogs=function(){return __awaiter$9(this,void 0,void 0,(function(){return __generator$9(this,(function(e){switch(e.label){case 0:return[4,t.storageDefer.promise];case 1:return e.sent(),this.postMessage({instanceId:this.instanceId,name:BridgeMessageName.REQUEST_DOWNLOAD_LOG}),[2]}}))}))},t.prototype.postMessagePromise=function(e){var t=this,o=e.message,r=e.resolveMessageName,n=e.rejectMessageName,i=e.progressMessageName,a=e.timeout,s=void 0===a?this.timeout:a,l=e.onProgress;return new Promise((function(e,a){var c=o.instanceId,p=function(){return setTimeout((function(){a(new Error("PostMessage response timeout: ".concat(o.name," / ").concat(o.instanceId))),u(!1)}),s)},d=p(),u=function(e){void 0===e&&(e=!1);var o=e?t.on.bind(t):t.off.bind(t);o(i,A),o(n,_),o(r,E),e||clearTimeout(d)},A=function(e){clearTimeout(d),d=p(),null==l||l(e.data.progress)},_=function(e){c===e.instanceId&&(a(e.data),u(!1))},E=function(t){c===t.instanceId&&(e(t.data),u(!1))};u(!0),t.postMessage(o)}))},t.prototype.destroy=function(){var o;t.instanceCount-=1,t.instanceCount<=0&&(clearTimeout(t.rejectTimeout),t.rejectTimeout=null,null===(o=t.iframeEl)||void 0===o||o.remove(),t.iframeEl=null,t.instanceCount=0,t.storageDefer=new SimpleDefer,e.prototype.destroy.call(this))},t.prototype.receiverMessageHandler=function(o){if(this.isBridgeMessage(o.data))return o.data.name===BridgeMessageName.STORAGE_READY?(t.storageDefer.resolve(),void clearTimeout(t.rejectTimeout)):void e.prototype.receiverMessageHandler.call(this,o)},t.storageDefer=new SimpleDefer,t.instanceCount=0,t}(MessageBridge),PageWatcher=function(e){function t(){var o=e.call(this)||this;return o.emitPageLeave=function(){"hidden"===document.visibilityState&&(Date.now()-o.pageLeaveTimeStamp<=t.THROTTLE_GAP||(o.pageLeaveTimeStamp=Date.now(),o.emit(PageWatcherEvent.PageLeave)))},o.emitPageUnload=function(){Date.now()-o.pageUnloadTimeStamp<=t.THROTTLE_GAP||(o.pageUnloadTimeStamp=Date.now(),o.emit(PageWatcherEvent.UNLOAD))},o.setPageLeave(),o.setPageUnload(),o}return __extends$d(t,e),t.prototype.setPageLeave=function(){window.addEventListener("pagehide",this.emitPageLeave),document.addEventListener("visibilitychange",this.emitPageLeave)},t.prototype.setPageUnload=function(){window.addEventListener("beforeunload",this.emitPageUnload),window.addEventListener("unload",this.emitPageUnload)},t.THROTTLE_GAP=10,t}(s),PageWatcherEvent;!function(e){e.PageLeave="pageLeave",e.UNLOAD="unload"}(PageWatcherEvent||(PageWatcherEvent={}));var singleton=new PageWatcher,PageWatcher$1={instance:singleton,PageWatcherEvent:PageWatcherEvent},WHITE_LIST_URL="//v.qq.com/cache/wuji/object?appid=tenvideo_offline_log&schemaid=whileList&schemakey=d5dccc35902346b2bdcbcef774fefe99",cbIndex=0,WhiteListType;function fetchWhiteList(e){var t=encodeURIComponent('projectId="'.concat(e,'"')),o="".concat(WHITE_LIST_URL,"&include=encryptValue,type,errorCode,rate&filter=").concat(t,"&otype=jsonp");return cbIndex+=1,netTool.jsonp(o,{name:"offline_log"+cbIndex%200,timeout:3e3})}function collectData(){return{vuid:cookieTool.get("vqq_vuserid")||cookieTool.get("vuserid"),openid:cookieTool.get("openid")||cookieTool.get("vqq_openid"),guid:lsTool.getData(exports.LOCAL_KEY.GUID)}}function validateWhiteList(e){return __awaiter$9(this,void 0,void 0,(function(){var t;return __generator$9(this,(function(o){t=collectData();try{return[2,Object.entries(WhiteListType).some((function(o){var r=o[0],n=o[1],i=t[r];return i&&e.some((function(e){return e.type===n&&e.encryptValue===sha256.exports.sha256(i)}))}))]}catch(e){return[2,!1]}return[2]}))}))}function buildReportCodeMap(e){return e.reduce((function(e,t){var o;return t.errorCode&&t.rate?__assign$e(__assign$e({},e),((o={})[t.errorCode]=t.rate,o)):e}),{})}!function(e){e.vuid="2",e.guid="5",e.openid="6",e.code="7"}(WhiteListType||(WhiteListType={}));var OfflineLogPlugin=function(e){function t(o,r,n){var i=e.call(this,o,r,n)||this;return i.pageWatcher=PageWatcher$1.instance,i.logInfoChange={},i.isDestroy=!1,i.onPageLeave=function(){i.storeLogs()},i.storeLogs=function(e){return __awaiter$9(i,void 0,void 0,(function(){var t,o,r,n,i;return __generator$9(this,(function(a){switch(a.label){case 0:if(!(t=this.instanceId))return[2];if(o=Logger.cache[t],r={logs:o,info:this.logInfoChange,ext:e},n=e||r.logs.length||Boolean(Object.keys(this.logInfoChange).length),Logger.cache[t]=[],this.logInfoChange={},!n)return[2];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.remoteStorage.storeLogs(r)];case 2:return a.sent(),[3,4];case 3:return i=a.sent(),this.logger.error("Error occur when store offlineLog: ".concat(i)),[3,4];case 4:return[2]}}))}))},i.onPlayerError=function(e){var t,o,r;i.logInfoChange.code=null===(r=null===(o=null===(t=e.data)||void 0===t?void 0:t.videoInfo)||void 0===o?void 0:o.error)||void 0===r?void 0:r.code,i.storeLogs()},i.config=__assign$e(__assign$e(__assign$e({},DEFAULT_CONFIG$1),r||{}),i.player.config.offlineConfig),i.logger=new Logger(i.instanceId,t.pluginName),i.remoteStorage=new RemoteStorageBridge(i.config.iframePath||RECORDER_DEPLOY_URL,i.instanceId),RemoteStorageBridge.storageDefer.promise.then((function(){i.isDestroy||(i.downloadOnQuery(),i.setPollLogger(),i.setPageWatcher(),i.setPlayerEvt())})).catch((function(e){i.logger.error("Error occur when init DB: ".concat(e))})),i.logEnvInfo(),i.checkWhiteList(),i}return __extends$d(t,e),Object.defineProperty(t,"isEnvSupport",{get:function(){return"function"==typeof window.Proxy},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){return __awaiter$9(this,void 0,void 0,(function(){return __generator$9(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,3,4]),this.isDestroy=!0,this.setPollLogger(!1),this.setPageWatcher(!1),this.setPlayerEvt(!1),[4,this.storeLogs({clearContentCache:!0})];case 1:case 2:return t.sent(),[3,4];case 3:return this.remoteStorage.destroy(),e.prototype.destroy.call(this),[7];case 4:return[2]}}))}))},t.prototype.report=function(e,o,r){return __awaiter$9(this,void 0,void 0,(function(){return __generator$9(this,(function(n){switch(n.label){case 0:if(!e&&!t.isInWhiteList)return[2];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.remoteStorage.report({downloadOnFailed:e,reportSource:o,onlyCurrent:!1},r)];case 2:return n.sent(),[2,{status:!0,msg:""}];case 3:return[2,{status:!1,msg:n.sent().message}];case 4:return[2]}}))}))},t.prototype.downloadLogs=function(){return this.remoteStorage.downloadLogs()},t.prototype.logEnvInfo=function(){try{this.logger.log("URL: ".concat(location.href)),this.logger.log("TOP URL: ".concat(urlTool.getTopFrameUrl())),this.logger.log("Kernel List: ".concat(Object.keys(KernelFactory$1.kernelMap).join(","))),this.logger.log("PlayItem: ".concat(jsonTool.safelyStringify(this.player.currentPlayItem)))}catch(e){}},t.prototype.downloadOnQuery=function(){var e=location.search.includes(DOWNLOAD_LOGS_QUERY);!t.hasDownloadOnInit&&e&&(this.downloadLogs(),t.hasDownloadOnInit=!0)},t.prototype.checkWhiteList=function(){return __awaiter$9(this,void 0,void 0,(function(){var e,o,r,n;return __generator$9(this,(function(i){switch(i.label){case 0:return e=this.config.platform,t.hasCheckWhiteList?[2]:(t.hasCheckWhiteList=!0,[4,fetchWhiteList(e)]);case 1:return o=i.sent().data,t.reportCodeRateMap=buildReportCodeMap(o),r=t,[4,validateWhiteList(o)];case 2:if(r.isInWhiteList=i.sent(),!t.isInWhiteList)return[3,6];i.label=3;case 3:return i.trys.push([3,5,,6]),[4,this.report(!1,"white")];case 4:return i.sent(),[3,6];case 5:return n=i.sent(),this.logger.error("Error occur when reporting: ".concat(n)),[3,6];case 6:return[2]}}))}))},t.prototype.setPollLogger=function(e){void 0===e&&(e=!0);var t=this.config.pollTime,o=void 0===t?3e3:t;clearInterval(this.pollTimer),e&&(this.pollTimer=window.setInterval(this.storeLogs,o))},t.prototype.setPageWatcher=function(e){void 0===e&&(e=!0);var t=this.pageWatcher,o=e?t.on.bind(t):t.off.bind(t);o(PageWatcher$1.PageWatcherEvent.PageLeave,this.onPageLeave),o(PageWatcher$1.PageWatcherEvent.UNLOAD,this.onPageLeave)},t.prototype.setPlayerEvt=function(e){void 0===e&&(e=!0),(e?this.player.on.bind(this.player):this.player.off.bind(this.player))(exports.PLAY_EVENT.ERROR,this.onPlayerError)},t.prototype.hookVideoReqInfoEnd=function(e){var t,o,r=null===(o=null===(t=e.data)||void 0===t?void 0:t.error)||void 0===o?void 0:o.code;r&&(this.logInfoChange.code=r),this.logInfoChange.videoName=this.player.dataset.commonMap.videoName,this.storeLogs()},t.prototype.hookPlaySessionStart=function(){this.logInfoChange=this.collectLogInfo(),this.logEnvInfo(),this.storeLogs()},t.prototype.hookPlaySessionEnd=function(e){var o,r;return __awaiter$9(this,void 0,void 0,(function(){var n,i;return __generator$9(this,(function(a){switch(a.label){case 0:return this.logInfoChange.code=e.code,[4,this.storeLogs({clearInfoCache:!0})];case 1:return a.sent(),n=null===(r=null===(o=e.code)||void 0===o?void 0:o.split)||void 0===r?void 0:r.call(o,".")[0],i=t.reportCodeRateMap[n],!uaTool.spider&&"number"==typeof i&&Math.random()<=i&&(console.log("Hit ErrorCode report: ".concat(e.code,", start reporting...")),this.remoteStorage.report({onlyCurrent:!0,downloadOnFailed:!1,reportSource:ReportSource.WHITE_LIST})),[2]}}))}))},t.prototype.collectLogInfo=function(){var e=this.player.dataset.commonMap,t=e.guid,o=e.drm,r=e.videoName,n=e.vid,i=e.hc_vuserid,a=e.flowid,s=e.platform;return{code:"",drm:Boolean(o),startTime:Date.now(),endTime:Date.now(),guid:t,ua:navigator.userAgent,url:location.href,videoName:r,vid:n,platform:s,vuid:i,instanceId:this.instanceId,id:a}},Object.defineProperty(t.prototype,"instanceId",{get:function(){return this.player.config.instanceId},enumerable:!1,configurable:!0}),t.pluginName="offlineLog",t.hasCheckWhiteList=!1,t.hasDownloadOnInit=!1,t.isInWhiteList=!1,t.reportCodeRateMap={},t}(Plugin),DEFAULT_CONFIG$1={platform:"1",disable:!1,pollTime:3e3},RECORDER_DEPLOY_URL="https://v.qq.com/thumbplayer-offline-log.html?max_age=3600",DOWNLOAD_LOGS_QUERY="thumbplayer_download_logs=1",DEFAULT_PRIORITY=0,DEFAULT_END_STATE=exports.END_STATE.NORMAL,DEFAULT_PLAYTIME_BOUNDARY={startTime:0,startPriority:DEFAULT_PRIORITY,endTime:1/0,endPriority:DEFAULT_PRIORITY,endState:exports.END_STATE.NORMAL},ruleValidator={emptyConfigCheck:function(e){if(!e)return compile(i18nConfig.h5player.ERROR_PLAY_LIMIT_EMPTY_CONFIG)},emptyStartAndEndCheck:function(e){var t=e.startPoint,o=e.endPoint;if(!t&&!o)return compile(i18nConfig.h5player.ERROR_PLAY_LIMIT_POINTS_BOTH_EMPTY)},startBelowZero:function(e){var t=e.startPoint;if(t&&t.value<0)return compile(i18nConfig.h5player.ERROR_PLAY_LIMIT_START_TIME_BELOW_ZERO)},endBelowStart:function(e){var t=e.startPoint,o=e.endPoint;if(t&&o&&t.value>=o.value)return compile(i18nConfig.h5player.ERROR_PLAY_LIMIT_END_TIME_BELOW_START_TIME)}},CONFIG_ID_START=0,PlaytimeLimiterPlugin=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.configRules=ruleValidator,t.nextId=CONFIG_ID_START,t.limitConfigMap={},t.isCanplayEmitted=!1,t.canplaySeekPos=null,t.hookVideoTimeupdate=function(e){if(!(e.playtime<t.range.endTime))return t.player.corePlayer.stop(t.range.endState),s.STOP_IMMEDIATE_PROPAGATION},t.hookPlaySessionEnd=function(){t.isCanplayEmitted=null,t.canplaySeekPos=null},t}return __extends$d(t,e),Object.defineProperty(t.prototype,"range",{get:function(){return this.limitRange||(this.limitRange=this.mergePlaytimeLimitConfigs(Object.values(this.limitConfigMap))),__assign$e({},this.limitRange)},enumerable:!1,configurable:!0}),t.prototype.addLimitConfig=function(e){var t;if(!this.validatePlayTimeConfig(e))return null;var o=null!==(t=e.id)&&void 0!==t?t:this.generateID();return this.limitConfigMap[o]=__assign$e(__assign$e({},e),{vidOrUrl:this.player.vid||this.player.url}),this.onConfigChange(),o},t.prototype.deleteLimitConfig=function(e){delete this.limitConfigMap[e],this.onConfigChange()},t.prototype.clearAllConfig=function(e){var t=this;Object.entries(this.limitConfigMap).forEach((function(o){var r=o[0];o[1].vidOrUrl!==e&&delete t.limitConfigMap[r]})),this.limitRange=null},t.prototype.getLimitConfig=function(e){return this.limitConfigMap[e]},t.prototype.setLimitConfig=function(e,t){return!(!this.getLimitConfig(e)||!this.validatePlayTimeConfig(t))&&(this.limitConfigMap[e]=t,this.onConfigChange(),!0)},t.prototype.generateID=function(){return this.nextId++},t.prototype.validatePlayTimeConfig=function(e){var t=this;return Object.values(this.configRules).every((function(o){var r=o(e);return!r||(t.player.log(r),!1)}))},t.prototype.mergePlaytimeLimitConfigs=function(e){var t=this,o=__assign$e({},DEFAULT_PLAYTIME_BOUNDARY);return e.forEach((function(e){var r=e.startPoint,n=e.endPoint;o=t.mergeStartPoint(o,r),o=t.mergeEndPoint(o,n)})),o},t.prototype.mergeStartPoint=function(e,t){return this.shouldUpdateStartTime(e,t)?__assign$e(__assign$e({},e),{startTime:t.value,startPriority:t.priority||DEFAULT_PRIORITY}):e},t.prototype.shouldUpdateStartTime=function(e,t){if(!t)return!1;var o=t.value,r=t.priority,n=void 0===r?DEFAULT_PRIORITY:r,i=e.startTime,a=e.startPriority;return o<e.endTime&&(n>a||n===a&&o>i)},t.prototype.mergeEndPoint=function(e,t){return this.shouldUpdateEndTime(e,t)?__assign$e(__assign$e({},e),{endTime:t.value,endPriority:t.priority||DEFAULT_PRIORITY,endState:t.endState||DEFAULT_END_STATE}):e},t.prototype.shouldUpdateEndTime=function(e,t){if(!t)return!1;var o=t.value,r=t.priority,n=void 0===r?DEFAULT_PRIORITY:r,i=e.startTime,a=e.endPriority,s=e.endTime;return o>i&&(n>a||n===a&&o<s)},t.prototype.onConfigChange=function(){if(this.limitRange=this.mergePlaytimeLimitConfigs(Object.values(this.limitConfigMap)),!(this.player.playtime>=this.range.startTime))return this.seekPlayer(this.range.startTime),__assign$e({},this.limitRange)},t.prototype.hookVideoCanplay=function(){!this.isCanplayEmitted&&this.canplaySeekPos&&(this.player.seek(this.canplaySeekPos),this.canplaySeekPos=null),this.isCanplayEmitted=!0},t.prototype.seekPlayer=function(e){this.isCanplayEmitted?this.player.seek(this.canplaySeekPos):this.canplaySeekPos=e},t.pluginName="playtimeLimiter",t}(Plugin),report=function(e){var t=e.data,o=void 0===t?{}:t,r=e.url,n=void 0===r?"":r,i=e.forceImage,a=void 0!==i&&i,s=constructPayload(o);!a&&s.length>MAX_LENGTH_OF_PAYLOAD?netTool.xhr({method:"POST",url:n,withCredentials:!0,headers:{"Content-Type":"application/x-www-form-urlencoded"},body:s}):(new Image).src="".concat(n,"&").concat(s)},constructPayload=function(e){void 0===e&&(e={});var t=Object.keys(e).reduce((function(t,o){var r;return t[o]=encodeURIComponent(null!==(r=e[o])&&void 0!==r?r:""),t}),{_dc:Math.random()});return urlTool.object2string(t,"&")},MAX_LENGTH_OF_PAYLOAD=2048,BaseReporter=function(e){function t(t,o,r){var n=e.call(this,t,o,r)||this;return n.RELEASE_DELAY=3e5,n.reporter=report,n.reportedEvt={},n.FLOW_DATA_KEY="",n.REPORT_URL="",n.REPORT_KEY="",n.config=o,n}return __extends$d(t,e),t.prototype.saveToLS=function(e,t){var o=this.getPrevData();o[e]={data:t,ts:Date.now()},lsTool.setData(this.FLOW_DATA_KEY,JSON.stringify(o))},t.prototype.removeFromLS=function(e){var t=this.getPrevData();delete t[e],lsTool.setData(this.FLOW_DATA_KEY,JSON.stringify(t))},t.prototype.reportPrev=function(){var e=this,t=this.getPrevData();Object.keys(t).forEach((function(o){t[o].ts+e.RELEASE_DELAY<Date.now()&&(e.report(t[o].data),delete t[o])})),lsTool.setData(this.FLOW_DATA_KEY,JSON.stringify(t))},t.prototype.report=function(e){var t;if(void 0===e&&(e={}),!uaTool.spider){var o=__assign$e(__assign$e({},this.reportHeader),e);if(this.reporter({data:o,url:this.REPORT_URL,key:this.REPORT_KEY,forceImage:this.config.forceImage}),"function"==typeof(null===(t=this.config)||void 0===t?void 0:t.onAfterReport))try{this.config.onAfterReport(o)}catch(e){}}},t.prototype.handlePageHide=function(e){if(void 0===e&&(e={}),!uaTool.spider&&this.reporterForPageHide){var t=__assign$e(__assign$e({},this.reportHeader),e);this.reporterForPageHide({data:t,url:this.REPORT_URL,key:this.REPORT_KEY})}},t.prototype.getPrevData=function(){var e,t=lsTool.getData(this.FLOW_DATA_KEY)||"{}";try{e=JSON.parse(t)}catch(t){e={}}return e},t}(Plugin),VodQaReportBeaconAppKey="0WEB0QEJW44KW5A5",LiveQaReportBeaconAppKey="0WEB0CN7W9446C2I",VodQaReportCacheKey="__thumbplayer_vod_qa_report__",BeaconSDKPath="//beacon.cdn.qq.com/sdk/4.5.16/beacon_web.min.js",RequestMaxRetry=3,BeaconRequest=function(){function e(){}return e.loadBeaconSDK=function(){var t=this;return"function"==typeof window.BeaconAction?Promise.resolve():(e.SDKLoadingDefer||(e.SDKLoadingDefer=new Promise((function(e,o){return __awaiter$9(t,void 0,void 0,(function(){var t,r,n;return __generator$9(this,(function(i){switch(i.label){case 0:r=0,i.label=1;case 1:if(!(r<RequestMaxRetry))return[3,6];i.label=2;case 2:return i.trys.push([2,4,,5]),[4,domTool.loadScript(BeaconSDKPath)];case 3:return i.sent(),e(),[3,6];case 4:return n=i.sent(),t=n,[3,5];case 5:return r++,[3,1];case 6:return o(t),[2]}}))}))}))),e.SDKLoadingDefer)},e.flushQueue=function(t){e.queues[t]&&e.instances[t]&&(e.queues[t].forEach((function(t){e.report(t)})),e.queues[t]=[])},e.clear=function(t){e.queues[t]=[]},e.report=function(t){var o=t.data,r=t.key,n=e.instances[r],i=(o||{}).stepname;n?n.onDirectUserAction(i,o):e.queues[r].push(t)},e.reportWhenPageHide=function(t){var o=t.data,r=t.key,n=e.instances[r],i=(o||{}).stepname;n&&n.onSendBeacon(i,o)},e.register=function(t,o){return __awaiter$9(this,void 0,void 0,(function(){var r,n,i,a,s;return __generator$9(this,(function(l){switch(l.label){case 0:if(r=t,n=!1,"object"==typeof t&&(r=t.appKey,n=!!t.isOversea),e.queues[r])return[2];e.queues[r]=[],o&&(e.SDKLoadingDefer=o),l.label=1;case 1:return l.trys.push([1,4,,5]),[4,e.loadBeaconSDK()];case 2:return l.sent(),e.SDKLoadingDefer=null,[4,this.requireBeaconModule()];case 3:return i=l.sent(),a=new i({needQueryConfig:!1,appkey:r,strictMode:!1,isOversea:n}),e.instances[r]=a,e.flushQueue(r),[3,5];case 4:return s=l.sent(),console.error(s),[3,5];case 5:return[2]}}))}))},e.requireBeaconModule=function(){return requireModule(BEACON_MODULE_NAME,BEACON_GLOBAL_NAME)},e.instances={},e.queues={},e}(),BEACON_MODULE_NAME="BeaconAction",BEACON_GLOBAL_NAME="BeaconAction",getQQFromCookie$1=function(){var e=cookieTool.get("luin")||cookieTool.get("uin");return e&&(e=e.replace(/\D/g,"").replace(/^0+/,"")),e},BufferThresholds=1200,PlatCode;!function(e){e.Web="web",e.H5="h5"}(PlatCode||(PlatCode={}));var DEFAULT_KEYS$1$1={cdnuip:"",iqq:"",pvid:"",qqopen_id:COMMON_DATA_KEY.hc_openid,playno:COMMON_DATA_KEY.flowid,cdnid:COMMON_DATA_KEY.cdnid,guid:COMMON_DATA_KEY.guid,fplayerver:COMMON_DATA_KEY.playerver,dsip:"",sstrength:"",devtype:"",nettype:"",freetype:"",platform:COMMON_DATA_KEY.platform,vplatform:COMMON_DATA_KEY.platform,codec:COMMON_DATA_KEY.codec,device:COMMON_DATA_KEY.device,resolution:COMMON_DATA_KEY.resolution,osver:COMMON_DATA_KEY.osver,playertype:COMMON_DATA_KEY.playertype,appver:COMMON_DATA_KEY.appVer,use_p2p:COMMON_DATA_KEY.p2p,p2p_play:COMMON_DATA_KEY.p2p,p2pver:COMMON_DATA_KEY.p2pver,playtype:"",scenesid:COMMON_DATA_KEY.sid,sid:COMMON_DATA_KEY.vid,livepid:COMMON_DATA_KEY.livepid,contentid:COMMON_DATA_KEY.cid,drm:COMMON_DATA_KEY.drmtype,videocapability:COMMON_DATA_KEY.videoCapability,playtime:"",isuserpay:"",live_type:"",xserverip:"",durl:"",lookback:"",live_tag:"",extraInfo:"",spanId:"",tuid:"",ext1:"",ext2:"",ext3:""},LiveQaReporterPlugin=function(e){function t(t,o,r){var n=e.call(this,t,o,r)||this;n.REPORT_KEY=LiveQaReportBeaconAppKey,n.seq=0,n.lastPlayDuration=0,n.bufferHistory=[],n.flowHeader={cnntime:0,maxspeed:0,testspeed:0,downspeed:0,recnncount:0,loadingtime:0,blockcount:0,blocktime:0,errorcode:0,geturltime:0,fullecode:"",prdlength:0,get_stream_data_duration:0,get_sync_frame_duration:0,live_delay:0},n.isSettingLevel=!1,n.setEvtHandler=function(){n.msg.on(exports.PLAY_EVENT_EXT.DATASET_STATE_UPDATE,n.onStateChange),n.player.on(exports.PLAY_EVENT.RETRY_BACKURL,n.onRetryUrl)},n.onRetryUrl=function(){n.flowHeader.recnncount=n.flowHeader.recnncount+1},n.onStateChange=function(e){var t,o=e.data,r=o.key,i=((t={})[exports.DATA_STATE.LOAD_END]=n.onLoad,t[exports.DATA_STATE.BUFFER_END]=n.onBuffer,t[exports.DATA_STATE.GET_INFO_END]=n.onGetinfoEnd,t[exports.DATA_STATE.SET_LEVEL_START]=n.onSetLevel,t[exports.DATA_STATE.SESSION_START]=n.onSessionStart,t[exports.DATA_STATE.SESSION_END]=n.onSessionEnd,t[exports.DATA_STATE.CODEC_DEGRADE]=n.onCodecDegrade,t);i[r]&&i[r](o)},n.onSessionStart=function(){n.resetLoopData(),n.seq=0},n.onSessionEnd=function(e){var t=e.newVal,o=(void 0===t?{}:t).code;n.onPeriod({code:o}),n.seq=0,n.endPeriodReport(),n.reportedEvt={}},n.startPeriodReport=function(){n.endPeriodReport(),n.period=setInterval(n.onPeriod,6e4)},n.endPeriodReport=function(){n.period&&(clearInterval(n.period),n.period=null)},n.onSetLevel=function(){n.isSettingLevel=!0,n.onPeriod(),n.endPeriodReport()},n.onBuffer=function(e){var t=e.newVal,o=void 0===t?{}:t,r=e.startEvent,i=void 0===r?{}:r,a=o.ftime,s=i.ftime;a-s<=BufferThresholds||n.bufferHistory.push({stime:s,etime:a})},n.onGetinfoEnd=function(e){var t=e.newVal,o=e.startEvent,r=t.ftime,i=o.ftime;n.flowHeader.geturltime=r-i},n.onCodecDegrade=function(e){var t=e.newVal,o=void 0===t?{}:t,r=o.ftime,i=o.code;n.report({step:701,stepname:"codec_degrade",etime:r,code:i})},n.onLoad=function(e){if(!n.reportedEvt[205]||n.isSettingLevel){n.reportedEvt[205]=!0,n.isSettingLevel=!1;var t=e.startEvent,o=void 0===t?{}:t,r=e.newVal,i=void 0===r?{}:r,a=i.code;a===exports.ErrorCode.SUC&&(n.flowHeader.loadingtime=i.ftime-o.ftime,n.flowHeader.errorcode=a,n.flowHeader.fullecode=a,n.report({step:205,stepname:"live_loading",code:a}),n.startPeriodReport())}},n.onPeriod=function(e){var t=(e||{code:exports.ErrorCode.SUC}).code,o=void 0===t?exports.ErrorCode.SUC:t,r=n.bufferHistory.reduce((function(e,t){return[e[0]+1,e[1]+(t.etime-t.stime)]}),[0,0]),i=r[0],a=r[1],s=n.player.dataset.getStats().playDuration;n.flowHeader.blockcount=i,n.flowHeader.blocktime=a,n.flowHeader.prdlength=s-n.lastPlayDuration,n.flowHeader.errorcode=o,n.flowHeader.fullecode=o;var l={step:o===exports.ErrorCode.SUC?263:150,stepname:o===exports.ErrorCode.SUC?"live_period":"live_error",code:o};n.report(l),n.resetLoopData(),n.lastPlayDuration=s},n.resetLoopData=function(){n.bufferHistory=[],n.flowHeader=__assign$e(__assign$e({},n.flowHeader),{blockcount:0,blocktime:0,errorcode:0,loadingtime:0,fullecode:"",prdlength:0,recnncount:0,downspeed:0,live_delay:0})};var i=t.config.liveQaReporterConfig;return n.config={paramsKey:__assign$e(__assign$e({},DEFAULT_KEYS$1$1),(null==i?void 0:i.paramsKey)||{}),onAfterReport:null==i?void 0:i.onAfterReport,onBeforeReport:null==i?void 0:i.onBeforeReport},n.setEvtHandler(),BeaconRequest.register({appKey:n.REPORT_KEY,isOversea:!!(null==i?void 0:i.isOversea)},null==i?void 0:i.externalBeaconDefer),n.log("live-qa-reporter registered to ".concat(n.REPORT_KEY,", oversea: ").concat(!!(null==i?void 0:i.isOversea))),n.reporter=BeaconRequest.report,n}return __extends$d(t,e),Object.defineProperty(t.prototype,"reportHeader",{get:function(){var e,t,o=this.config.paramsKey,r=void 0===o?{}:o,n=this.player.getCommonKv;return __assign$e({videocapability:n(r.videocapability)||"",cdnuip:n(r.cdnuip)||"",iqq:n(r.iqq)||getQQFromCookie$1(),qqopen_id:n(r.qqopen_id)||"",pvid:cookieTool.get("pgv_pvid")||"",playno:n(r.playno)||"",cdnid:n(r.cdnid)||"",guid:n(r.guid)||"",fplayerver:n(r.fplayerver)||"",dsip:n(r.dsip)||"",sstrength:n(r.sstrength)||0,devtype:n(r.devtype)||0,nettype:n(r.nettype)||100,codec:n(r.codec)||CODEC.H264,freetype:n(r.freetype)||0,platform:n(r.platform)||"",vplatform:n(r.platform)||"",device:n(r.device)||"",resolution:n(r.resolution)||"",osver:n(r.osver)||"",playertype:n(r.playertype)||0,appver:n(r.appver)||"",use_p2p:n(r.use_p2p)||0,p2p_play:n(r.p2p_play)||0,p2pver:n(r.p2pver)||"",playtype:n(r.playtype)||1,scenesid:n(r.scenesid)||0,drm:n(r.drm)||0,sid:n(r.sid)||0,livepid:n(r.livepid)||0,contentid:n(r.contentid)||0,playtime:n(r.playtime)||0,isuerpay:n(r.isuserpay)||0,live_type:n(r.live_type)||0,xserverip:n(r.xserverip)||"",durl:n(r.durl)||(null===(t=null===(e=this.player)||void 0===e?void 0:e.currentVideoInfo)||void 0===t?void 0:t.loadingUrl)||"",lookback:n(r.lookback)||0,live_tag:n(r.live_tag)||0,extraInfo:n(r.extraInfo)||"",spanId:n(r.spanId)||"",tuid:n(r.tuid)||"",kernel:this.player.kernelName,plat_code:uaTool.mobile?PlatCode.H5:PlatCode.Web,domain:urlTool.getDomainOfURL(urlTool.getTopFrameUrl()),seq:this.seq,ext1:n(r.ext1)||"",ext2:n(r.ext2)||"",ext3:n(r.ext3)||""},this.flowHeader)},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){this.endPeriodReport(),BeaconRequest.clear(this.REPORT_KEY),e.prototype.destroy.call(this)},t.prototype.report=function(t){e.prototype.report.call(this,t),this.seq=this.seq+1},t.pluginName="live-qa-reporter",t}(BaseReporter),AdReportHelper=function(){function e(e){var t=this;this.reportData={},this.currentBufferHistory=[],this.onStateChange=function(e){var o,r=e.data,n=r.new,i=r.old,a=((o={})[exports.VIDEO_STATE.CANPLAY]=t.onCanPlay,o[exports.VIDEO_STATE.BUFFERING]=t.onBuffering,o[exports.VIDEO_STATE.END]=t.onEnd,o);a[n]&&a[n](e.data.videoInfo,i)},this.onError=function(e){var o,r,n=e.data.videoInfo;if(n){var i=n.uid,a=n.error,s=t.reportData[i];s&&(s.load>=0&&(t.emitToMainReporter({code:a.code,step:"30",stime:s.load,stepname:STEP_NAME.FIRST_LOAD,etime:Date.now(),url:n.loadingUrl,urlIndex:(null===(r=null===(o=n.config)||void 0===o?void 0:o.backupUrls)||void 0===r?void 0:r.findIndex((function(e){return e===n.loadingUrl})))||-1},s),s.load=-1),t.emitToMainReporter({step:"50",playDuration:n.playtime,code:a.code,stepname:STEP_NAME.END,tbcount:0,tbduration:0,scount:0,etime:Date.now(),bcount:t.currentBufferHistory.length,tduration:t.currentBufferHistory.reduce((function(e,t){return e+(t.etime-t.stime)}),0)},s))}},this.onFirstPlaying=function(e){var o=e.data.videoInfo;if(o){var r=t.reportData[o.uid];if(r){r.load>=0&&t.reportFirstLoad(o,r);var n=Date.now(),i={step:"32",stepname:STEP_NAME.FIRST_RENDERING,stime:n,etime:n,code:exports.ErrorCode.SUC};t.emitToMainReporter(i,r)}else;}},this.onVideoNodeChange=function(e){var o=e.data.videoInfo;o&&!t.reportData[o.uid]&&(t.reportData[o.uid]={seq:0,flowidSuffix:"_ad".concat(t.getAdClipNumber()),load:Date.now()})},this.reportFirstLoad=function(e,o){var r,n,i,a,s=null!==(n=null===(r=t.adPlayer.currentVideoInfo)||void 0===r?void 0:r.cacheSize)&&void 0!==n?n:0,l={step:"30",stepname:STEP_NAME.FIRST_LOAD,stime:o.load,etime:Date.now(),url:e.loadingUrl,urlIndex:(null===(a=null===(i=e.config)||void 0===i?void 0:i.backupUrls)||void 0===a?void 0:a.findIndex((function(t){return t===e.loadingUrl})))||-1,code:exports.ErrorCode.SUC,cachesize:s};t.emitToMainReporter(l,o),o.load=-1},this.onCanPlay=function(e){if(e){var o=t.reportData[e.uid];if(o){if(o.load>=0)return void t.reportFirstLoad(e,o);if(o.buffer>=0){var r=Date.now(),n=o.buffer;if(o.buffer=-1,r-n<=1200)return;t.currentBufferHistory.push({stime:n,etime:Date.now()});var i={step:"35",stime:n,stepname:STEP_NAME.BUFFERING,etime:Date.now(),ptime:t.adPlayer.playtime,code:exports.ErrorCode.SUC};return void t.emitToMainReporter(i,o)}}}},this.onEnd=function(e){if(e){var o=t.reportData[e.uid];if(o){var r={step:"50",playDuration:e.playtime,code:exports.ErrorCode.SUC,stepname:STEP_NAME.END,tbcount:0,tbduration:0,scount:0,etime:Date.now(),bcount:t.currentBufferHistory.length,tduration:t.currentBufferHistory.reduce((function(e,t){return e+(t.etime-t.stime)}),0)};t.emitToMainReporter(r,o)}}},this.onBuffering=function(e){if(e){var o=t.reportData[e.uid];o&&(o.buffer=Date.now())}},this.reporterPlugin=e}return e.prototype.destroy=function(){this.unbindCoreEvents()},e.prototype.init=function(e,t){this.adPlayer&&this.unbindCoreEvents();var o=e.currentVideoInfo;o&&(this.adPlayer=e,this.adType=t,this.bindCoreEvents(),this.reportData={},this.reportData[o.uid]={seq:0,flowidSuffix:"ad".concat(this.getAdClipNumber()),load:Date.now()})},e.prototype.getAdClipNumber=function(){return Object.keys(this.reportData).length},e.prototype.bindCoreEvents=function(){this.adPlayer.on(exports.PLAY_EVENT.STATE_CHANGE,this.onStateChange),this.adPlayer.on(exports.PLAY_EVENT.ERROR,this.onError),this.adPlayer.on(exports.PLAY_EVENT.VIDEONODE_FIRST_PLAYING,this.onFirstPlaying),this.adPlayer.on(exports.PLAY_EVENT.VIDEONODE_CHANGE,this.onVideoNodeChange)},e.prototype.unbindCoreEvents=function(){this.adPlayer.off(exports.PLAY_EVENT.STATE_CHANGE,this.onStateChange),this.adPlayer.off(exports.PLAY_EVENT.ERROR,this.onError),this.adPlayer.off(exports.PLAY_EVENT.VIDEONODE_FIRST_PLAYING,this.onFirstPlaying),this.adPlayer.off(exports.PLAY_EVENT.VIDEONODE_CHANGE,this.onVideoNodeChange)},e.prototype.emitToMainReporter=function(e,t){var o=__assign$e(__assign$e({code:exports.ErrorCode.SUC},e),{flowid:t.flowidSuffix,seq:t.seq,scenesid:SCENES_ID[this.adType]||SCENES_ID.otherAd,duration:this.adPlayer.duration,kernel:this.adPlayer.kernelName,vid:"",fmt:"",rate:"",cdnid:"",cdnip:"",drm:"",definition:"",dltype:""});t.seq+=1,this.reporterPlugin.emit("adReport",o)},e}(),STEP_NAME,SCENES_ID;!function(e){e.INIT="init_player",e.GETINFO="get_cdn_url",e.FIRST_LOAD="first_load",e.FIRST_RENDERING="first_rendering",e.BUFFERING="second_buffering",e.SEEKING="user_seek",e.END="play_done",e.CODEC_DEGRADE="codec_degrade"}(STEP_NAME||(STEP_NAME={})),function(e){e[e.preAd=400]="preAd",e[e.ZT=401]="ZT",e[e.postAd=402]="postAd",e[e.otherAd=403]="otherAd",e[e.video=421]="video"}(SCENES_ID||(SCENES_ID={}));var DEFAULT_KEYS$2={platform:COMMON_DATA_KEY.platform,vplatform:COMMON_DATA_KEY.platform,flowid:COMMON_DATA_KEY.flowid,uin:"",QQopenid:COMMON_DATA_KEY.hc_openid,WXopenid:COMMON_DATA_KEY.hc_openid,logintype:COMMON_DATA_KEY.hc_main_login,guid:COMMON_DATA_KEY.guid,uip:"",cdnuip:COMMON_DATA_KEY.cdnuip,codec:COMMON_DATA_KEY.codec,cdnip:COMMON_DATA_KEY.cdnip,online:COMMON_DATA_KEY.online,p2p:COMMON_DATA_KEY.p2p,sstrength:COMMON_DATA_KEY.sstrength,network:COMMON_DATA_KEY.network,speed:COMMON_DATA_KEY.speed,device:COMMON_DATA_KEY.device,resolution:COMMON_DATA_KEY.resolution,testid:COMMON_DATA_KEY.testid,osver:COMMON_DATA_KEY.osver,p2pver:COMMON_DATA_KEY.p2pver,appver:COMMON_DATA_KEY.appVer,playerver:COMMON_DATA_KEY.playerver,playertype:COMMON_DATA_KEY.playertype,confid:COMMON_DATA_KEY.confid,cdnid:COMMON_DATA_KEY.cdnid,drm:COMMON_DATA_KEY.drmtype,scenesid:"",playtype:"",dltype:COMMON_DATA_KEY.dltype,vid:COMMON_DATA_KEY.vid,definition:COMMON_DATA_KEY.currentDefn,fmt:COMMON_DATA_KEY.fmt,rate:COMMON_DATA_KEY.rate,videocapability:COMMON_DATA_KEY.videoCapability,isad:"",duration:"",kernel:"",ext1:"",ext2:"",ext3:""},VodQaReporterPlugin=function(e){function t(t,o,r){var n=e.call(this,t,o,r)||this;n.REPORT_KEY=VodQaReportBeaconAppKey,n.FLOW_DATA_KEY=VodQaReportCacheKey,n.seq=0,n.bufferHistory=[],n.seekHistory=[],n.initData={fmt:"",rate:"",cdnid:""},n.bufferCount=0,n.seekCount=0,n.setEvtHandler=function(){n.msg.on(exports.PLAY_EVENT_EXT.DATASET_STATE_UPDATE,n.onStateChange),n.player.on(exports.PLAY_EVENT.SETLEVEL_OVER,(function(){n.bufferCount=0,n.seekCount=0})),window.addEventListener("pagehide",n.onPageHide)},n.onPageHide=function(){n.handlePageHide(n.collectFinalData())},n.onStateChange=function(e){var t,o=e.data,r=o.key,i=((t={})[exports.DATA_STATE.INIT]=n.onPlayerInit,t[exports.DATA_STATE.LOAD_END]=n.onLoad,t[exports.DATA_STATE.BUFFER_END]=n.onBuffer,t[exports.DATA_STATE.GET_INFO_END]=n.onGetinfoEnd,t[exports.DATA_STATE.SEEK_END]=n.onSeek,t[exports.DATA_STATE.SESSION_END]=n.onPlaySessionEnd,t[exports.DATA_STATE.FIRST_PLAY]=n.onFirstPlay,t[exports.DATA_STATE.SESSION_START]=n.reset,t[exports.DATA_STATE.CODEC_DEGRADE]=n.onCodecDegrade,t[exports.DATA_STATE.RETRY_BACKURL]=function(){n.bufferCount=0,n.seekCount=0},t);i[r]&&i[r](o)},n.onPlayerInit=function(e){var t=e.newVal,o=t.ftime,r=t.ext,i=(void 0===r?{}:r).stime;n.report({stepname:STEP_NAME.INIT,step:"5",stime:i,etime:o,code:exports.ErrorCode.SUC})},n.onGetinfoEnd=function(e){var t=e.newVal,o=e.startEvent,r=t.ftime,i=t.code,a=o.ftime;n.report({stepname:STEP_NAME.GETINFO,step:"15",stime:a,etime:r,code:i})},n.onLoad=function(e){var t=e.newVal,o=void 0===t?{}:t,r=e.startEvent,i=void 0===r?{}:r,a=o,s=a.ftime,l=a.currentUrl,c=a.urlIndex,p=a.code,d=a.ext,u=(null==d?void 0:d.isAdPlaying)?s:i.ftime;n.report({stepname:STEP_NAME.FIRST_LOAD,step:"30",stime:u,etime:s,url:l||"",urlindex:c+1,fileopenedtime:0,firstpacketreadtime:0,ext1:n.player.getCommonKv(COMMON_DATA_KEY.isPreload)||0,ext2:Number(null==d?void 0:d.isAdPlaying),code:p})},n.onFirstPlay=function(){if(!n.reportedEvt[STEP_NAME.FIRST_RENDERING]){n.reportedEvt[STEP_NAME.FIRST_RENDERING]=!0;var e=+new Date;n.report({step:"32",stepname:STEP_NAME.FIRST_RENDERING,stime:e,etime:e,code:exports.ErrorCode.SUC})}},n.onBuffer=function(e){var t=e.newVal,o=void 0===t?{}:t,r=e.startEvent,i=void 0===r?{}:r,a=o.ftime,s=o.playtime,l=o.currentUrl,c=o.code,p=i.ftime,d=i.prevState===exports.VIDEO_STATE.SEEKING?1:0,u=n.player.playbackRate>1?2:1;a-p<=BufferThresholds||(n.bufferHistory.push({stime:p,etime:a}),n.bufferCount<20&&(n.report({step:"35",stepname:STEP_NAME.BUFFERING,ptime:s,levent:d,stime:p,etime:a,scene:u,format:n.player.getCommonKv(n.config.paramsKey.fmt)||0,url:l||"",reason:0,code:c,vt:n.player.getCommonKv(n.config.paramsKey.cdnid)||0}),n.bufferCount+=1))},n.onSeek=function(e){var t=e.newVal,o=void 0===t?{}:t,r=e.startEvent,i=void 0===r?{}:r,a=o.ftime,s=o.playtime,l=o.code,c=o.ext,p=void 0===c?{}:c,d=i.ftime,u=i.playtime;p.isUserSeek&&(n.seekHistory.push({lstime:d,letime:a}),n.seekCount<20&&(n.report({step:"40",stepname:STEP_NAME.SEEKING,lstime:d,letime:a,pstime:u,petime:s,format:n.player.getCommonKv(n.config.paramsKey.fmt)||0,code:l}),n.seekCount+=1))},n.onPlaySessionEnd=function(e){if(!n.reportedEvt[STEP_NAME.END]){n.reportedEvt[STEP_NAME.END]=!0;var t=e.newVal,o=void 0===t?{}:t,r=o.ftime,i=o.code,a=n.player.dataset.getStats().playDuration,s=[0===i.indexOf(exports.ErrorCode.GETINFO_SERVER_CODE_PREFIX),0===i.indexOf("70014"),0===i.indexOf("7004"),"70011112"===i,"70011113"===i].some((function(e){return e})),l=s?exports.ErrorCode.SUC:i;n.report(__assign$e(__assign$e({step:"50",stepname:STEP_NAME.END,etime:r,playduration:a,code:l},n.seekStat),n.bufferStat)),n.removeFromLS(n.player.getCommonKv(COMMON_DATA_KEY.flowid)),n.seq=0}},n.onCodecDegrade=function(e){var t=e.newVal,o=void 0===t?{}:t,r=o.ftime,i=o.code;n.report({step:"701",stepname:STEP_NAME.CODEC_DEGRADE,etime:r,code:i})},n.onInit=function(){n.reportPrev()},n.collectFinalData=function(){var e=+new Date;if(n.player.getCommonKv(COMMON_DATA_KEY.flowid)&&!n.reportedEvt[STEP_NAME.END]){var t=n.player.dataset.getStats().playDuration;return __assign$e(__assign$e({step:"50",stepname:STEP_NAME.END,etime:e,code:exports.ErrorCode.SUC,playduration:t},n.seekStat),n.bufferStat)}},n.reset=function(){n.reportedEvt={},n.initData.fmt="",n.initData.rate="",n.initData.cdnid="",n.bufferHistory=[],n.seekHistory=[],n.bufferCount=0,n.seekCount=0};var i=t.config.vodQaReporterConfig;return n.config={paramsKey:__assign$e(__assign$e({},DEFAULT_KEYS$2),(null==i?void 0:i.paramsKey)||{}),onAfterReport:null==i?void 0:i.onAfterReport,onBeforeReport:null==i?void 0:i.onBeforeReport},n.setEvtHandler(),BeaconRequest.register({appKey:n.REPORT_KEY,isOversea:!!(null==i?void 0:i.isOversea)},null==i?void 0:i.externalBeaconDefer),n.log("vod-qa-reporter registered to ".concat(n.REPORT_KEY,", oversea: ").concat(!!(null==i?void 0:i.isOversea))),n.reporter=BeaconRequest.report,n.reporterForPageHide=BeaconRequest.reportWhenPageHide,n.onInit(),n.adReportHelper=new AdReportHelper(n),n.player.on(exports.H5_PLAY_EVENT.AD_REQ_ASSETS_START,(function(e){var o=e.data;setTimeout((function(){var e,r=getAdPlugin(null==t?void 0:t.config.instanceId),i=null===(e=null==r?void 0:r.getPlayerInstance)||void 0===e?void 0:e.call(r,o.adType);i&&n.adReportHelper.init(i,o.adType)}))})),n.on("adReport",(function(t){e.prototype.report.call(n,__assign$e(__assign$e({},t.data),{flowid:"".concat(n.reportHeader.flowid,"_").concat(t.data.flowid),isad:1}))})),n}return __extends$d(t,e),Object.defineProperty(t.prototype,"seekStat",{get:function(){var e=this.seekHistory.reduce((function(e,t){var o=e[0],r=e[1],n=t.letime-t.lstime;return n>BufferThresholds?[o+1,r+n]:e}),[0,0]);return{tbcount:e[0],tbduration:e[1],scount:this.seekHistory.length}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bufferStat",{get:function(){return{tduration:this.bufferHistory.reduce((function(e,t){return e+(t.etime-t.stime)}),0),bcount:this.bufferHistory.length}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"reportHeader",{get:function(){var e,t=this,o=this.config.paramsKey,r=this.player.getCommonKv,n=this.player.dataset.getStats(),i=n.averageDecodeTimeInMs,a=n.frameDroppedInPercentage;return Object.entries(this.initData).forEach((function(e){var n=e[0];e[1]||(t.initData[n]=r(o[n])||"")})),{videocapability:r(o.videocapability)||"",platform:r(o.platform)||"",vplatform:r(o.platform)||"",flowid:r(o.flowid)||"",uin:r(o.uin)||getQQFromCookie$1(),QQopenid:r(o.QQopenid)||"",WXopenid:r(o.WXopenid)||"",logintype:r(o.logintype)||0,guid:r(o.guid)||"",uip:r(o.uip)||"",cdnuip:r(o.cdnuip)||"",cdnip:r(o.cdnip)||"",online:r(o.online)||1,p2p:r(o.p2p)||0,sstrength:r(o.sstrength)||0,network:r(o.network)||0,speed:r(o.speed)||0,device:r(o.device)||"",resolution:r(o.resolution)||"",testid:r(o.testid)||0,codec:r(o.codec)||CODEC.H264,osver:r(o.osver)||"",p2pver:r(o.p2pver)||"",appver:r(o.appver)||"",playerver:r(o.playerver)||"",confid:r(o.confid)||0,playertype:r(o.playertype)||0,cdnid:this.initData.cdnid,scenesid:r(o.scenesid)||SCENES_ID.video,playtype:0,dltype:r(o.dltype)||0,vid:r(o.vid)||"",fmt:this.initData.fmt,rate:this.initData.rate,drm:r(o.drm)||0,definition:r(o.definition)||"",duration:Math.round(r(o.duration)||this.player.duration),seq:this.seq,kernel:null!==(e=this.player.kernelName)&&void 0!==e?e:"unknown",domain:urlTool.getDomainOfURL(urlTool.getTopFrameUrl()),isad:0,ext1:r(o.ext1)||"",ext2:r(o.ext2)||"",ext3:r(o.ext3)||"",framedrop:a,avgdecodecost:i}},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){window.removeEventListener("pagehide",this.onPageHide),BeaconRequest.clear(this.REPORT_KEY),e.prototype.destroy.call(this)},t.prototype.report=function(t){e.prototype.report.call(this,t),this.seq=this.seq+1},t.pluginName="vod-qa-reporter",t}(BaseReporter),OFFICIAL_PLUGIN={VOD_FLOW_REPORTER:"vod-flow-reporter",LIVE_FLOW_REPORTER:"live-flow-reporter",GETINFO_LIVE:"getinfo-live",GETINFO_VOD:"getinfo-vod",GETINFO_TC:"getinfo-tc",BARRAGE:"barrage",MARKID:"markid",CONTEXT_MENU:"context-menu",WATERMARK:"ui-watermark",UI_PREVIEW:"ui-preview",UI_PREVIEW_LIST:"ui-preview-list",POLL_DURATION:"poll-duration",REPORTERS:"reporters",UI_ROLE_FILTER:"ui-role-filter",SETTING_BTN:"setting-btn",CTRLBAR:"ctrlbar",ERROR_PAGE:"error-page",FULLSCREEN_RATIO:"fullscreen-ratio",INFO_PANEL:"info-panel",LIVE_POLL:"live-poll",POSTER:"poster",SUBTITLE:"subtitle",TIPS:"tips",UI_LOADING:"ui-loading",VR:"vr",TVK_UTILS:"tvk-utils",UNMUTE_BTN:"unmute-btn"},PLUGIN_MAP={"vod-flow-reporter":{cdnPath:"thumbplayer-plugin-atta-reporter",version:"1.4.104"},"live-flow-reporter":{cdnPath:"thumbplayer-plugin-atta-reporter",version:"1.4.104"},"getinfo-live":{pluginName:"__thumbplayer-video-request",version:"1.4.133"},"getinfo-vod":{pluginName:"__thumbplayer-video-request",version:"1.4.133"},"getinfo-tc":{pluginName:"__thumbplayer-video-request",version:"1.4.125"},barrage:{pluginName:"Barrage",version:"1.4.133"},markid:{pluginName:"ui-markid",version:"1.4.133"},"context-menu":{cdnPath:"thumbplayer-plugin-ui-contextmenu",version:"1.4.133"},"ui-preview-list":{cdnPath:"thumbplayer-plugin-ui-preview",version:"1.4.133"},"ui-preview":{cdnPath:"thumbplayer-plugin-ui-preview",version:"1.4.133"},"ui-watermark":{cdnPath:"thumbplayer-plugin-watermark",version:"1.4.133"},"poll-duration":{version:"1.4.133"},reporters:{version:"1.4.133"},"ui-role-filter":{version:"1.4.133"},"setting-btn":{version:"1.4.133"},ctrlbar:{version:"1.4.133"},"error-page":{version:"1.4.133"},"fullscreen-ratio":{version:"1.4.133"},"info-panel":{version:"1.4.133"},"live-poll":{version:"1.4.104"},poster:{version:"1.4.133"},subtitle:{version:"1.4.133"},tips:{version:"1.4.133"},"ui-loading":{version:"1.4.133"},vr:{version:"1.4.133"},"tvk-utils":{version:"1.4.133"},"unmute-btn":{version:"1.4.133"}},H5_PAUSE_TYPE,AUTO_PLAY_POLICY,PictureDirection;exports.H5_PAUSE_TYPE=void 0,H5_PAUSE_TYPE=exports.H5_PAUSE_TYPE||(exports.H5_PAUSE_TYPE={}),H5_PAUSE_TYPE.USER_CLICK="user-click",exports.AUTO_PLAY_POLICY=void 0,AUTO_PLAY_POLICY=exports.AUTO_PLAY_POLICY||(exports.AUTO_PLAY_POLICY={}),AUTO_PLAY_POLICY.IN_MUTED="autoPlayInMuted",AUTO_PLAY_POLICY.USER_GESTURE="autoPlayRequireByUserGesture",exports.PictureDirection=void 0,PictureDirection=exports.PictureDirection||(exports.PictureDirection={}),PictureDirection.NORMAL="normal",PictureDirection.VERTICAL="vertical",PictureDirection.HORIZON="horizon";var PluginablePlayer=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.plugins={},t.pluginMsg=new s,t.playerApiProxy={},t.pluginMsgProxy={on:t.pluginMsg.on.bind(t.pluginMsg),off:t.pluginMsg.off.bind(t.pluginMsg),once:t.pluginMsg.once.bind(t.pluginMsg)},t._destroyed=!1,t.loadPlugin=function(e){var o=e.config,r=e.timeout,n=e.version,i=e.crossOrigin,a=e.globalName,s=e.pluginName,l=void 0===s?a:s,c=e.insName,p=e.url;if(!p&&!PLUGIN_MAP[l])throw new Error(compile(i18nConfig.h5player.ERROR_UNOFFICIAL_PLUGIN_NEEDS_URL));if(!p&&PLUGIN_MAP[l]){var d=n||PLUGIN_MAP[l].version,u=PLUGIN_MAP[l].cdnPath||"thumbplayer-plugin-".concat(l);l=PLUGIN_MAP[l].pluginName||l,p="//vm.gtimg.cn/thumbplayer/plugins/".concat(u,"/").concat(d,"/index.min.js")}return c=c||l,domTool.loadScript(p,void 0,r,{crossOrigin:i}).then((function(){t._destroyed||(getPlugin(l)||registerPlugin(l,window[a]),t.plugins[c]||t.createPlugin(c,__assign$e(__assign$e({},o),{pluginName:l})))}))},t}return __extends$d(t,e),t.prototype.createPlugin=function(e,t){void 0===t&&(t={});var o=t.pluginName,r=void 0===o?e:o,n=getPlugin(r);if(!n)throw new Error("cannot find plugin: ".concat(r));this.triggerSetupEvent({name:e,plugin:n,instance:null},!0),createPluginFactory(e,n,this,t,{msg:this.pluginMsgProxy,api:this.playerApiProxy}),r===AdPluginName&&(setAdPlugin(this.config.instanceId,this.plugins[AdPluginName]),delete this.plugins[AdPluginName]),this.triggerSetupEvent({name:e,plugin:n,instance:null})},t.prototype.createPlugins=function(e){var t=this;e.forEach((function(e){try{"string"==typeof e?t.createPlugin(e):t.createPlugin.apply(t,e)}catch(e){console.error(e)}}))},t.prototype.triggerSetupEvent=function(e,t){var o=this;void 0===t&&(t=!1);var r="".concat(t?"before":"","pluginsetup");setTimeout((function(){o.pluginMsg.emit("".concat(r,":").concat(e.name),e)}))},t.registerPlugin=registerPlugin,t.deregisterPlugin=deregisterPlugin,t.getPlugins=getPlugins,t.getPlugin=getPlugin,t.isFunctionPlugin=isFunctionPlugin,t.pluginExists=pluginExists,t.isBasicPlugin=isFunctionPlugin,t}(s),FlowNodeReqInfo=function(){function e(e){this.vinfoCache=null,this.adCache=null,this.config=e}return Object.defineProperty(e.prototype,"startParam",{get:function(){return this.config.startParam},set:function(e){this.config.startParam=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"flowid",{get:function(){return this.config.flowid},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"videoLoadParam",{get:function(){return this.config.startParam.videoLoadParam},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"videoReqInfoParam",{get:function(){return this.config.startParam.videoReqInfoParam},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"vid",{get:function(){return this.config.startParam.vid},enumerable:!1,configurable:!0}),e.prototype.getAdParam=function(e){return __assign$e({adType:e},this.startParam.adParam)},e.prototype.shouldRequest=function(){return!!this.config.videoReqInfoPlugin},e.prototype.setVideoInfo=function(){var e,t;return __awaiter$9(this,void 0,void 0,(function(){var o;return __generator$9(this,(function(r){switch(r.label){case 0:return this.vinfoCache&&this.vid&&this.shouldRequest()?[4,this.vinfoCache]:[2];case 1:return(o=r.sent())?(null===(t=(e=this.config.videoReqInfoPlugin).setVideoInfo)||void 0===t||t.call(e,this.vid,o),[2]):[2]}}))}))},e.prototype.getOutputData=function(){var e,t;return __awaiter$9(this,void 0,void 0,(function(){var o;return __generator$9(this,(function(r){switch(r.label){case 0:return this.vinfoCache&&this.vid?[4,this.vinfoCache]:[2];case 1:return(o=r.sent())?[2,null===(t=null===(e=this.config.videoReqInfoPlugin)||void 0===e?void 0:e.parseVideoInfo)||void 0===t?void 0:t.call(e,this.vid,o,{flowid:this.flowid})]:[2]}}))}))},e.prototype.requestVod=function(e,t){var o;return void 0===t&&(t=!0),__awaiter$9(this,void 0,void 0,(function(){var r,n,i,a;return __generator$9(this,(function(s){switch(s.label){case 0:return r=this.config,n=r.videoReqInfoPlugin,i=r.startParam,a=r.flowid,this.shouldRequest()?(null===(o=n.abort)||void 0===o||o.call(n),[4,n.request(i.vid,__assign$e(__assign$e(__assign$e({},i.videoReqInfoParam),{flowid:a}),e),[],t)]):[2,null];case 1:return[2,s.sent()]}}))}))},e.prototype.requestRawVod=function(){this.vinfoCache=this.requestVod({},!1).then((function(e){return null==e?void 0:e.resData}))},e}(),RetryManager=function(){function e(e){var t,o=this;this.player=e,this.retryCheckers=[],this.retryTimesInSession=0,this.onPlaySessionStartHandler=function(){o.retryTimesInSession=0,o.retryCheckers.forEach((function(e){return e.onSessionStart()}))},this.onVideoPlaying=function(e){e.data,o.retryCheckers.forEach((function(e){return e.onRetrySucc()}))},this.checkerEvtHandler=function(e){var t;if(o.player.canGetinfoRetry()){var r=o.getHitChecker(e);if(r){var n=r.outOfTimes,i=void 0!==n&&n,a=o.player.config,s=a.type,l=a.maxRetryGetinfoTimesInLiveSession,c=a.maxRetryGetinfoTimesInVodSession;o.retryTimesInSession>=(s===exports.PLAY_MODE.LIVE?l:c)&&(i=!0),o.retryTimesInSession++,o.logger.log("retry on ".concat(e.type,",\n    outOfTimes=").concat(i,",\n    retryTimes=").concat(r.retryTimes,", retryTimesInSession=").concat(o.retryTimesInSession,",\n    playParam=").concat(jsonTool.safelyStringify(r.updatePlayParam),",\n    error=").concat(null===(t=r.error)||void 0===t?void 0:t.code)),o.player.startGetinfoRetry(r,i)}}},this.player.getRetryCheckClasses().forEach((function(t){o.retryCheckers.push(new t(e))})),this.logger=new Logger(this.player.config.instanceId,"RetryManager"),this.evtMap=((t={})[exports.H5_PLAY_EVENT.PLAY_SESSION_START]=this.onPlaySessionStartHandler,t[exports.H5_PLAY_EVENT.VIDEO_PLAYING]=this.onVideoPlaying,t),this.setCheckEvents(!0),this.setPlayerEvents(!0)}return e.prototype.destroy=function(){this.setCheckEvents(!1),this.setPlayerEvents(!1),this.retryCheckers.forEach((function(e){return e.destroy()})),this.player=null,this.retryCheckers=null},e.prototype.getHitChecker=function(e){for(var t=0;t<this.retryCheckers.length;t++){var o=this.retryCheckers[t];if(o.checkEvt===e.type){var r=o.check(e);if(r)return this.logger.log("checker hit ".concat(o.name)),r}}return null},e.prototype.setCheckEvents=function(e){var t=this;void 0===e&&(e=!0);for(var o=e?this.player.on:this.player.off,r=[],n=0;n<this.retryCheckers.length;n++)-1===r.indexOf(this.retryCheckers[n].checkEvt)&&r.push(this.retryCheckers[n].checkEvt);r.forEach((function(e){o.call(t.player,e,t.checkerEvtHandler)}))},e.prototype.setPlayerEvents=function(e){var t=this,o=e?this.player.on:this.player.off;Object.keys(this.evtMap).forEach((function(e){o.call(t.player,e,t.evtMap[e])}))},e}(),BaseCheck=function(){function e(e){this.name="",this.checkEvt=null,this.retryTimes=0,this.player=e,this.logger=new Logger(this.player.config.instanceId,"RetryChecker")}return e.prototype.destroy=function(){this.player=null},e.prototype.onSessionStart=function(){this.retryTimes=0},e.prototype.onRetrySucc=function(){this.retryTimes=0},e.prototype.check=function(e){return null},e.prototype.getRetryConfig=function(e){var t=e.playtime;return{error:e.error,updatePlayParam:{videoReqInfoParam:{},videoLoadParam:{startTime:t,kernelName:void 0}},retryTimes:this.retryTimes}},e}(),REC_PLAY_TIME_INIT_VALUE=-1,RetryNames$1={CheckNormalError:"CheckNormalError"},CheckNormalError=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name=RetryNames$1.CheckNormalError,t.checkEvt=exports.PLAY_EVENT.ERROR,t.stateWhenErrorHappen=null,t.playtimeWhenErrorHappen=REC_PLAY_TIME_INIT_VALUE,t}return __extends$d(t,e),t.prototype.check=function(e){var t=e.data.videoInfo.error,o=this.player.config.maxRetryGetinfoTimes;return this.retryTimes>=o?{outOfTimes:!0,error:t,retryTimes:this.retryTimes}:this.checkNormalErrorCode(e)},t.prototype.onRetrySucc=function(){e.prototype.onRetrySucc.call(this),this.stateWhenErrorHappen=null,this.playtimeWhenErrorHappen=REC_PLAY_TIME_INIT_VALUE},t.prototype.updateRetryTimes=function(){this.retryTimes+=1},t.prototype.checkNormalErrorCode=function(e){var t,o=e.data.videoInfo,r=o.stateWhenErrorHappen,n=o.playtime;null===this.stateWhenErrorHappen&&(this.stateWhenErrorHappen=r),this.playtimeWhenErrorHappen===REC_PLAY_TIME_INIT_VALUE&&(this.playtimeWhenErrorHappen=n),this.updateRetryTimes();var i=this.getRetryConfig(o);return i.stateWhenErrorHappen=this.stateWhenErrorHappen,this.playtimeWhenErrorHappen!==REC_PLAY_TIME_INIT_VALUE&&(null===(t=null==i?void 0:i.updatePlayParam)||void 0===t?void 0:t.videoLoadParam)&&this.player.config.type===exports.PLAY_MODE.VOD&&(i.updatePlayParam.videoLoadParam.startTime=this.playtimeWhenErrorHappen),i},t}(BaseCheck);function definePlugins(e){return e.map((function(e){return[e[0].pluginName,e[1]]}))}function autobind(e){return function(t,o,r){var n=e;if(!n){var i="on".length,a=o.slice(i).toLowerCase(),s=Object.keys(exports.PLAY_EVENT).find((function(e){return exports.PLAY_EVENT[e].toLowerCase()===a}));s?n=exports.PLAY_EVENT[s]:(s=Object.keys(exports.H5_PLAY_EVENT).find((function(e){return exports.H5_PLAY_EVENT[e].toLowerCase()===a})),n=exports.H5_PLAY_EVENT[s])}var l=r.value;r.value=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];n&&this.player?this.player.on(n,l.bind(this)):l.apply(this,e)}}}var logApiInvoke=function(e,t,o){var r=o.value;o.value=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var n="";try{n=JSON.stringify(e)}catch(e){n="parse arg failed"}return this.setStateKv(t,{type:exports.LOG_TYPE.API_INVOKE,ftime:Date.now(),ext:{from:"thumbplayer-h5",args:n}}),r.apply(this,e)}},once=function(e,t,o){var r=o.value;o.value=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];if(!this["__hasRun".concat(t)])return this["__hasRun".concat(t)]=!0,r.apply(this,e)}},BaseFlowNode=function(e){function t(t){var o=e.call(this)||this;return o.flowid=t.flowid,o}return __extends$d(t,e),t.prototype.destroy=function(){this.removeAllListeners()},t.prototype.getName=function(){return""},t.prototype.pause=function(e){},t.prototype.resume=function(){},t.prototype.replay=function(e,t){return Promise.reject("replay not implemented! (".concat(this.getName(),")"))},t.prototype.start=function(){return Promise.resolve()},t.prototype.preload=function(e){return Promise.resolve()},t.prototype.retry=function(e,t){},t}(s),FLOW_NODE_EVENT;exports.FLOW_NODE_EVENT=void 0,FLOW_NODE_EVENT=exports.FLOW_NODE_EVENT||(exports.FLOW_NODE_EVENT={}),FLOW_NODE_EVENT.PRELOAD_NEXT="PRELOAD_NEXT",FLOW_NODE_EVENT.PRELOAD="PRELOAD",FLOW_NODE_EVENT.START="START",FLOW_NODE_EVENT.END="END",FLOW_NODE_EVENT.ABORT="ABORT";var AdFlowNode=function(e){function t(t){var o,r=this;return(r=e.call(this,t)||this).config=t,r.isPreloadNext=!1,r.onAdCountdown=function(e){var t=e.data;t.adType!==exports.AD_TYPE.PRE||!r.config.enableP2P||t.countdown>60||(r.preloadNext(),preloadEvtBus.emit(PRELOAD_EVENT.UPDATE,{instanceId:r.config.instanceId,remainTime:t.countdown}))},r.onAdEnd=function(e){var t,o=e.data;o.adType===exports.AD_TYPE.PRE&&(r.config.corePlayer.volume=null===(t=getAdPlugin(r.config.instanceId))||void 0===t?void 0:t.getAdVolume()),r.isInValidAd(o)||r.endFlow()},r.onAdAssetsLoaded=function(e){var t=e.data;r.isInValidAd(t)||r.preloadNext()},r.onAdPlayBlocked=function(e){var t=e.data;r.isInValidAd(t)||(r.isPreload=!0)},r.logger=new Logger(t.instanceId,"AdFlowNode"),null===(o=getAdPlugin(t.instanceId))||void 0===o||o.on(exports.H5_PLAY_EVENT.AD_AUTOPLAY_BLOCKED,r.onAdPlayBlocked),r}return __extends$d(t,e),t.prototype.getName=function(){return"AdFlowNode.".concat(this.config.adType)},t.prototype.start=function(){return this.logger.log("".concat(this.getName()," exec start")),this.emit(exports.FLOW_NODE_EVENT.START,{name:this.getName()}),this.checkCanPlayAd()?(this.isPreload=!1,this.bindAdEvents(),this.playAd()):(this.logger.log("".concat(this.getName()," skip exec start")),void this.endFlow())},t.prototype.preload=function(){var e,t=this;this.logger.log("".concat(this.getName()," exec preload")),this.emit(exports.FLOW_NODE_EVENT.PRELOAD,{name:this.getName()});var o=function(){t.emit(exports.FLOW_NODE_EVENT.PRELOAD_NEXT,{forcePreload:!0,name:t.getName()})};return this.checkCanPlayAd()?(this.isPreload=!0,this.bindAdEvents(),null===(e=getAdPlugin(this.config.instanceId))||void 0===e?void 0:e.loadAd(this.startParam).then((function(e){!1===e&&o()})).catch(o)):(this.logger.log("".concat(this.getName()," skip exec preload")),void o())},t.prototype.pause=function(){var e;this.logger.log("".concat(this.getName()," exec pause")),null===(e=getAdPlugin(this.config.instanceId))||void 0===e||e.pauseAd(this.config.adType)},t.prototype.resume=function(){var e;this.logger.log("".concat(this.getName()," exec resume")),null===(e=getAdPlugin(this.config.instanceId))||void 0===e||e.resumeAd(this.config.adType)},t.prototype.destroy=function(){var t=getAdPlugin(this.config.instanceId);t&&(t.off(exports.PLAY_EVENT_EXT.AD_COUNTDOWN_CHANGE,this.onAdCountdown),t.off(exports.H5_PLAY_EVENT.AD_END,this.onAdEnd),t.off(exports.H5_PLAY_EVENT.AD_ASSETS_LOADED,this.onAdAssetsLoaded),t.off(exports.H5_PLAY_EVENT.AD_AUTOPLAY_BLOCKED,this.onAdPlayBlocked)),e.prototype.destroy.call(this)},t.prototype.checkCanPlayAd=function(){var e=this.config,t=e.instanceId,o=e.reqInfo;return!(!getAdPlugin(t)||!this.startParam)&&(o.adCache&&(getAdPlugin(t).setAdInfo(o.adCache),o.adCache=null),!0)},t.prototype.bindAdEvents=function(){var e=getAdPlugin(this.config.instanceId);e&&(e.on(exports.PLAY_EVENT_EXT.AD_COUNTDOWN_CHANGE,this.onAdCountdown),e.on(exports.H5_PLAY_EVENT.AD_END,this.onAdEnd),e.on(exports.H5_PLAY_EVENT.AD_ASSETS_LOADED,this.onAdAssetsLoaded))},t.prototype.playAd=function(){var e,t=this;return null===(e=getAdPlugin(this.config.instanceId))||void 0===e?void 0:e.playAd(this.startParam).catch((function(){return t.endFlow()}))},Object.defineProperty(t.prototype,"startParam",{get:function(){var e=this.config,t=e.reqInfo,o=e.adType;return t.getAdParam(o)},enumerable:!1,configurable:!0}),t.prototype.preloadNext=function(){this.isPreloadNext||(this.isPreloadNext=!0,this.emit(exports.FLOW_NODE_EVENT.PRELOAD_NEXT,{name:this.getName()}))},t.prototype.endFlow=function(){this.emit(exports.FLOW_NODE_EVENT.END,{name:this.getName()}),this.destroy()},t.prototype.isInValidAd=function(e){return e.adType!==this.config.adType},__decorate$9([once,__metadata$9("design:type",Function),__metadata$9("design:paramtypes",[]),__metadata$9("design:returntype",void 0)],t.prototype,"bindAdEvents",null),t}(BaseFlowNode),FlowManager=function(){function e(e){this.config=e,this.flowNodeList=[],this.currentFlowNodeIndex=0,this.lastNodeList=[],this.logger=new Logger(e.playerInstanceId,"FlowManager")}return Object.defineProperty(e.prototype,"onFlowEnd",{get:function(){return this.config.onFlowEnd||function(){}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onFlowEvts",{get:function(){return this.config.onFlowEvts||function(){}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentFlowNode",{get:function(){return this.flowNodeList[this.currentFlowNodeIndex]},enumerable:!1,configurable:!0}),e.prototype.push=function(){for(var e,t=this,o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];o.forEach((function(e){return t.bindNodeEvents(e)})),(e=this.flowNodeList).push.apply(e,o)},e.prototype.setLastNode=function(e){this.lastNodeList.push(e)},e.prototype.clear=function(){this.flowNodeList.forEach((function(e){return e.destroy()})),this.flowNodeList=[],this.lastNodeList=[],this.currentFlowNodeIndex=0},e.prototype.bindNodeEvents=function(e){var t,o=this,r=((t={})[exports.FLOW_NODE_EVENT.PRELOAD_NEXT]=function(t){var r,n=t.data;o.logger.log("".concat(e.getName()," emited: FLOW_NODE_EVENT.PRELOAD_NEXT")),o.config.disablePreload&&!(null==n?void 0:n.forcePreload)||null===(r=o.getNextNode(e))||void 0===r||r.preload(!!(null==n?void 0:n.forcePreload))},t[exports.FLOW_NODE_EVENT.END]=function(t){var r=t.data;o.logger.log("".concat(e.getName()," emited: FLOW_NODE_EVENT.END")),r.videoEndState&&(o.videoEndState=r.videoEndState),e.removeAllListeners();var n=o.getNextNode(e);if(!n){var i=e.getName();return o.logger.log("no next node after ".concat(i,", clear")),o.clear(),o.onFlowEnd({code:exports.ErrorCode.SUC,endState:o.videoEndState,curFlowNodeName:i}),void(o.videoEndState="")}if(o.lastNodeList.includes(e)){i=e.getName();return o.logger.log("lastNodeList includes ".concat(i,", end")),o.onFlowEnd({code:exports.ErrorCode.SUC,curFlowNodeName:i})}o.currentFlowNodeIndex+=1,o.logger.log("next node start, current index is ".concat(o.currentFlowNodeIndex)),n.start()},t[exports.FLOW_NODE_EVENT.ABORT]=function(t){var r=t.data,n=e.getName();o.logger.log("".concat(n," emited: FLOW_NODE_EVENT.ABORT")),o.clear(),o.onFlowEnd(__assign$e(__assign$e({},r),{endState:r.endState||exports.END_STATE.ERROR,curFlowNodeName:n}))},t);Object.keys(exports.FLOW_NODE_EVENT).forEach((function(t){e.on(t,(function(e){var t=e.type,n=e.data;o.onFlowEvts(t,n),r[t]&&r[t]({data:n})}))}))},e.prototype.getNextNode=function(e){var t=this.flowNodeList.indexOf(e);if(-1!==t)return this.flowNodeList[t+1]},e}(),PreloadFlowNode=function(e){function t(t){var o=e.call(this,__assign$e(__assign$e({},t),{flowid:t.reqInfo.flowid}))||this;return o.config=t,o.logger=new Logger(t.instanceId,"PreloadFlowNode"),o}return __extends$d(t,e),t.prototype.getName=function(){return"PreloadFlowNode"},t.prototype.start=function(){return __awaiter$9(this,void 0,void 0,(function(){var e,t,o,r,n,i,a,s,l,c,p=this;return __generator$9(this,(function(d){switch(d.label){case 0:return e=this.config,t=e.reqInfo,o=e.videoEndTime,r=e.playerConfig,n=e.corePlayer,i=e.extEvtDispatcher,[4,t.getOutputData()];case 1:return(a=d.sent())&&a.kernelName&&!a.error?(i.emit(exports.PLAY_EVENT_EXT.PRELOAD_GETINFO_OVER,a),s=a.kernelName,l=a.urlConfig,this.preloadKernel=s,preloadEvtBus.emit(PRELOAD_EVENT.START,{kernelName:s,urlConfig:l,instanceId:this.config.instanceId,videoLoadParam:t.videoLoadParam,playerConfig:r}),this.logger.log("start; kernelName=".concat(s)),c=-1,this.preloadLoop=new TaskLoop((function(){var e=o||n.duration,t=Math.floor(Math.max(e-n.playtime,0));c!==t&&(c=t,preloadEvtBus.emit(PRELOAD_EVENT.UPDATE,{kernelName:s,remainTime:t}),p.logger.log("update; kernelName=".concat(s,", remainTime=").concat(t)),t||p.preloadLoop.destroy())}),LoopMode.Timer),this.preloadLoop.start(LOOP_INTERVAL),[2]):(this.logger.error("preload() error; urlConfig=".concat(jsonTool.safelyStringify(a))),[2])}}))}))},t.prototype.destroy=function(){var t;e.prototype.destroy.call(this),preloadEvtBus.emit(PRELOAD_EVENT.STOP,{kernelName:this.preloadKernel}),this.logger.log("stop; kernelName=".concat(this.preloadKernel)),null===(t=this.preloadLoop)||void 0===t||t.destroy()},t}(BaseFlowNode),LOOP_INTERVAL=1e3,RequestFlowNode=function(e){function t(t){var o=e.call(this,__assign$e(__assign$e({},t),{flowid:t.reqInfo.flowid}))||this;return o.config=t,o.logger=new Logger(t.instanceId,"RequestFlowNode"),o}return __extends$d(t,e),t.prototype.getName=function(){return"RequestFlowNode.".concat(this.config.adType)},t.prototype.start=function(){return __awaiter$9(this,void 0,void 0,(function(){return __generator$9(this,(function(e){switch(e.label){case 0:return this.logger.log("".concat(this.getName()," start")),this.emit(exports.FLOW_NODE_EVENT.START,{name:this.getName()}),this.loadDefer?[4,this.loadDefer]:[3,2];case 1:return e.sent(),[3,4];case 2:return[4,this.request()];case 3:e.sent(),e.label=4;case 4:return this.endFlow(),[2]}}))}))},t.prototype.preload=function(){var e=this;return this.emit(exports.FLOW_NODE_EVENT.PRELOAD,{name:this.getName()}),this.isPreload=!0,this.loadDefer=this.request().then((function(){e.emit(exports.FLOW_NODE_EVENT.PRELOAD_NEXT,{forcePreload:e.config.adType===exports.AD_TYPE.PRE,name:e.getName()})})),this.loadDefer},t.prototype.request=function(){return __awaiter$9(this,void 0,void 0,(function(){var e,t;return __generator$9(this,(function(o){return this.logger.log("".concat(this.getName()," request")),e=this.config,t=e.reqInfo,e.adType===exports.AD_TYPE.PRE&&t.requestRawVod(),[2]}))}))},t.prototype.destroy=function(){e.prototype.destroy.call(this)},t.prototype.endFlow=function(){this.logger.log("".concat(this.getName()," end")),this.emit(exports.FLOW_NODE_EVENT.END,{name:this.getName()}),this.destroy()},t}(BaseFlowNode),VideoFlowNode=function(e){function t(t){var o,r=e.call(this,t)||this;return r.config=t,r.isReplaying=!1,r.isDestroyed=!1,r.onVideoPlayBlocked=function(){return r.isPreload=!0},r.onVideoTimeUpdate=function(){var e;if(!r.isLive){var t=null!==(e=r.startParam.postAdReqLeftTime)&&void 0!==e?e:10;Number.isNaN(t)||r.corePlayer.playtime+t>=r.corePlayer.duration&&r.emitPreloadNext()}},r.onVideoStop=function(e){var t,o=e.data;if(r.isReplaying)r.isReplaying=!1;else if(!(null===(t=o.videoInfo)||void 0===t?void 0:t.error)){r.flowOverHandler();var n=o.isUserStop?exports.FLOW_NODE_EVENT.ABORT:exports.FLOW_NODE_EVENT.END;r.emit(n,{videoEndState:o.endState,name:r.getName()})}},r.onVideoError=function(e){var t,o=e.data;if(!r.startParam.vid){var n=null===(t=null==o?void 0:o.videoInfo)||void 0===t?void 0:t.error;r.flowOverHandler(),r.emit(exports.FLOW_NODE_EVENT.ABORT,__assign$e(__assign$e({},n),{code:(null==n?void 0:n.code)||exports.ErrorCode.UNKNOWN,name:r.getName()}))}},r.logger=new Logger(r.corePlayer.config.instanceId,"VideoFlowNode"),r.evtMap=((o={})[exports.PLAY_EVENT.TIME_UPDATE]=r.onVideoTimeUpdate,o[exports.PLAY_EVENT.STOPED]=r.onVideoStop,o[exports.PLAY_EVENT.ERROR]=r.onVideoError,o[exports.PLAY_EVENT.AUTOPLAY_BLOCKED]=r.onVideoPlayBlocked,o),r.setPlayerEvents(!0),r}return __extends$d(t,e),Object.defineProperty(t.prototype,"isLive",{get:function(){return this.corePlayer.config.type===exports.PLAY_MODE.LIVE},enumerable:!1,configurable:!0}),t.prototype.getName=function(){return"VideoFlowNode"},t.prototype.start=function(){return __awaiter$9(this,void 0,void 0,(function(){var e,t,o;return __generator$9(this,(function(r){switch(r.label){case 0:return this.logger.log("".concat(this.getName()," exec start")),this.emit(exports.FLOW_NODE_EVENT.START,{name:this.getName()}),this.isPreload?(this.logger.log("".concat(this.getName()," exec start on preloaded")),this.loadDefer?[4,this.loadDefer.promise]:[3,2]):[3,3];case 1:r.sent(),r.label=2;case 2:return this.isLive&&this.corePlayer.resize({width:"100%"}),this.corePlayer.play(),[3,5];case 3:return[4,this.getVideoRsp()];case 4:e=r.sent(),t=e.urlConfig,o=e.kernelName,this.updateKernel(o),"function"==typeof this.config.videoLoadParamModifier&&(this.startParam.videoLoadParam=this.config.videoLoadParamModifier(this.startParam.videoLoadParam)),this.corePlayer.play(t,this.startParam.videoLoadParam),r.label=5;case 5:return this.isPreload=!1,preloadEvtBus.emit(PRELOAD_EVENT.STOP,{instanceId:this.corePlayer.config.instanceId}),[2]}}))}))},t.prototype.preload=function(e){return void 0===e&&(e=!0),__awaiter$9(this,void 0,void 0,(function(){var t,o,r;return __generator$9(this,(function(n){switch(n.label){case 0:return this.logger.log("".concat(this.getName()," exec preload")),this.emit(exports.FLOW_NODE_EVENT.PRELOAD,{name:this.getName()}),this.isPreload=!0,this.loadDefer=new SimpleDefer,[4,this.getVideoRsp()];case 1:return t=n.sent(),o=t.urlConfig,r=t.kernelName,this.updateKernel(r),this.isLive?(this.corePlayer.volume=0,[4,this.corePlayer.play(o,this.startParam.videoLoadParam)]):[3,3];case 2:return n.sent(),this.corePlayer.resize({width:0}),this.loadDefer.resolve(),[3,5];case 3:return[4,this.corePlayer.load(o,__assign$e(__assign$e({},this.startParam.videoLoadParam),{isPreload:!e}))];case 4:n.sent(),this.loadDefer.resolve(),n.label=5;case 5:return[2]}}))}))},t.prototype.pause=function(e){this.logger.log("".concat(this.getName()," exec pause")),this.corePlayer.pause(e)},t.prototype.resume=function(){this.logger.log("".concat(this.getName()," exec resume")),this.corePlayer.play()},t.prototype.setLevel=function(e,t){var o,r,n;return void 0===t&&(t={}),__awaiter$9(this,void 0,void 0,(function(){var i,a,s=this;return __generator$9(this,(function(l){switch(l.label){case 0:return i=null===(o=this.corePlayer.currentVideoInfo)||void 0===o?void 0:o.config,this.emitFromVideoNode(exports.H5_PLAY_EVENT.VIDEO_SETLEVEL_START,{level:e}),[4,this.getLevelUrlConfig(e)];case 1:if(!(a=l.sent())||!a.url)throw new Error("setLevel url is empty");return t.setLevelMode?a.setLevelMode=t.setLevelMode:((null==i?void 0:i.drmConfig)||a.drmConfig||a.chachaParam)&&(a.setLevelMode=SET_LEVEL_MODE.HARD),null!==(r=a.setLevelMode)&&void 0!==r||(a.setLevelMode=SET_LEVEL_MODE.HARD),[2,null===(n=this.corePlayer.setLevel(a.url,a.backupUrls,a))||void 0===n?void 0:n.catch((function(t){throw s.emitFromVideoNode(exports.H5_PLAY_EVENT.VIDEO_SETLEVEL_END,{code:(null==t?void 0:t.code)||exports.ErrorCode.UNKNOWN,message:null==t?void 0:t.message,level:e}),t}))]}}))}))},t.prototype.updatePlayParam=function(e){var t=__assign$e(__assign$e({},this.startParam.videoReqInfoParam),null==e?void 0:e.videoReqInfoParam),o=__assign$e(__assign$e({},this.startParam.videoLoadParam),null==e?void 0:e.videoLoadParam);this.startParam=__assign$e(__assign$e({},this.startParam),{videoReqInfoParam:t,videoLoadParam:o})},t.prototype.replay=function(e,t,o){return __awaiter$9(this,void 0,void 0,(function(){var r,n,i,a;return __generator$9(this,(function(s){switch(s.label){case 0:return this.updatePlayParam(t),isVideoId(e)?(this.logger.log("replay(), start request video info: ",this.startParam.videoReqInfoParam),[4,this.requestVideoInfo({emitFlowEvent:!1})]):(this.logger.log("replay(), start replay urlConfig: ",e),this.isReplaying=!0,[2,this.corePlayer.play(e,this.startParam.videoLoadParam)]);case 1:if(r=s.sent(),this.isDestroyed)return[2];if(i=(n=r||{}).error,a=n.urlConfig,i)throw i;return this.isReplaying=!0,this.logger.log("do retry [getinfo], stateWhenErrorHappen=".concat(o)),o===exports.VIDEO_STATE.PAUSE?[2,this.corePlayer.load(a,this.startParam.videoLoadParam)]:[2,this.corePlayer.play(a,this.startParam.videoLoadParam)]}}))}))},t.prototype.retry=function(e,t){var o=this,r=t||{},n=r.error,i=r.updatePlayParam,a=r.retryTimes,s=void 0===a?0:a,l=r.degradeReason,c=void 0===l?0:l;if(e)return this.flowOverHandler(),void this.emit(exports.FLOW_NODE_EVENT.ABORT,__assign$e(__assign$e({},n),{code:(null==n?void 0:n.code)||exports.ErrorCode.UNKNOWN,name:this.getName()}));this.logger.log("play retry, retryTimes=".concat(s,", degradeReason=").concat(c)),this.config.extEvtDispatcher.emit(exports.PLAY_EVENT_EXT.RETRY_PLAY,{retryTimes:s,degradeReason:c}),0!==c&&this.config.extEvtDispatcher.emit(exports.PLAY_EVENT_EXT.DEGRADE_CODEC_PLAY,{degradeReason:c}),this.isPreload?(this.updatePlayParam(i),this.preload(!0)):this.replay(this.startParam.vid,i,null==t?void 0:t.stateWhenErrorHappen).catch((function(e){o.logger.log("retry replay err=".concat(null==e?void 0:e.code,", ").concat(null==e?void 0:e.message)),o.flowOverHandler(),o.emit(exports.FLOW_NODE_EVENT.ABORT,__assign$e(__assign$e({},e),{code:(null==e?void 0:e.code)||exports.ErrorCode.UNKNOWN,name:o.getName()}))}))},t.prototype.destroy=function(){this.isDestroyed=!0,this.setPlayerEvents(!1),e.prototype.destroy.call(this)},t.prototype.emitPreloadNext=function(){this.emit(exports.FLOW_NODE_EVENT.PRELOAD_NEXT,{forcePreload:!0,name:this.getName()})},t.prototype.updateKernel=function(e){e&&(this.startParam.videoLoadParam=__assign$e({kernelName:e},this.startParam.videoLoadParam))},t.prototype.requestVideoInfo=function(e){var t;return void 0===e&&(e={}),__awaiter$9(this,void 0,void 0,(function(){var o,r,n,i,a,s,l,c=this;return __generator$9(this,(function(p){switch(p.label){case 0:return o=this.config.reqInfo,r=e.extraData,n=void 0===r?{}:r,i=e.emitFlowEvent,a=void 0===i||i,o.shouldRequest()?a?(this.tryEmit((function(){return c.emitFromVideoNode(exports.H5_PLAY_EVENT.VIDEO_REQ_INFO_START)})),[4,o.setVideoInfo()]):[3,2]:[2];case 1:p.sent(),p.label=2;case 2:return this.tryEmit((function(){return c.config.extEvtDispatcher.emit(exports.PLAY_EVENT_EXT.GETINFO_START)})),[4,o.requestVod(n)];case 3:return s=p.sent(),this.tryEmit((function(){return c.config.extEvtDispatcher.emit(exports.PLAY_EVENT_EXT.GETINFO_OVER,s)})),l=(null===(t=null==s?void 0:s.error)||void 0===t?void 0:t.code)||exports.ErrorCode.SUC,a&&this.tryEmit((function(){return c.emitFromVideoNode(exports.H5_PLAY_EVENT.VIDEO_REQ_INFO_END,{code:l,data:s})})),[2,s]}}))}))},t.prototype.getVideoRsp=function(){return __awaiter$9(this,void 0,void 0,(function(){var e,t,o,r,n,i;return __generator$9(this,(function(a){switch(a.label){case 0:if(e=this.startParam.urlConfig)return[2,{urlConfig:e}];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.requestVideoInfo()];case 2:if(t=a.sent(),r=(o=t||{}).urlConfig,n=o.error)throw n;if(!isUrlConfigValid(r))throw{message:"url config invalid",code:exports.ErrorCode.GETINFO_PARSE};return[2,t];case 3:return i=a.sent(),this.logger.error(i),this.flowOverHandler(),this.emit(exports.FLOW_NODE_EVENT.ABORT,__assign$e(__assign$e({},i),{code:(null==i?void 0:i.code)||exports.ErrorCode.GETINFO_NET,name:this.getName()})),[2,{urlConfig:null}];case 4:return[2]}}))}))},t.prototype.setPlayerEvents=function(e){var t=this;void 0===e&&(e=!0);var o=e?this.corePlayer.on:this.corePlayer.off;Object.keys(this.evtMap).forEach((function(e){o.call(t.corePlayer,e,t.evtMap[e])}))},t.prototype.flowOverHandler=function(){},Object.defineProperty(t.prototype,"corePlayer",{get:function(){return this.config.corePlayer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"emitFromVideoNode",{get:function(){return this.config.emitFromVideoNode},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"startParam",{get:function(){return this.config.reqInfo.startParam},set:function(e){this.config.reqInfo.startParam=e},enumerable:!1,configurable:!0}),t.prototype.getLevelUrlConfig=function(e){var t,o;return __awaiter$9(this,void 0,void 0,(function(){var r,n,i,a;return __generator$9(this,(function(s){switch(s.label){case 0:return isUrlConfig(e)?(r=e,[3,4]):[3,1];case 1:return"string"!=typeof e?[3,2]:(r={url:e},[3,4]);case 2:return n=__assign$e(__assign$e({},this.startParam.videoReqInfoParam),e),this.startParam=__assign$e(__assign$e({},this.startParam),{videoReqInfoParam:n}),[4,this.requestVideoInfo({emitFlowEvent:!1,extraData:n})];case 3:if(!(i=s.sent()))throw new Error;if(r=i.urlConfig,i.error)throw a=null===(o=null===(t=i.error.data)||void 0===t?void 0:t.params)||void 0===o?void 0:o.msg,this.emitFromVideoNode(exports.H5_PLAY_EVENT.VIDEO_SETLEVEL_END,{code:i.error.code||exports.ErrorCode.UNKNOWN,message:a||i.error.message,level:e}),i.error;s.label=4;case 4:return[2,r]}}))}))},t.prototype.tryEmit=function(e){try{e()}catch(e){this.logger.error(e)}},__decorate$9([once,__metadata$9("design:type",Function),__metadata$9("design:paramtypes",[]),__metadata$9("design:returntype",void 0)],t.prototype,"emitPreloadNext",null),t}(BaseFlowNode);function isUrlConfigValid(e){return Array.isArray(e)?e.every(isUrlConfig):isUrlConfig(e)}function isUrlConfig(e){return"string"==typeof(null==e?void 0:e.url)}var FlowPlayer=function(e){function t(t){var o=e.call(this)||this;o.isSettingLevel=!1,o.isFirstPlaying=!0,o.emitFromVideoNode=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];o.emit.apply(o,__spreadArray$4([e],t,!1))},o.onFlowEnd=function(e){var t,r=e.code,n=void 0===r?exports.ErrorCode.SUC:r,i=e.endState,a=void 0===i?exports.END_STATE.NORMAL:i,s=e.curFlowNodeName;o.log("onFlowEnd, code=".concat(n,", endState=").concat(a,", curFlowNodeName=").concat(s)),o.config.type===exports.PLAY_MODE.LIVE&&(null===(t=getAdPlugin(o.config.instanceId))||void 0===t||t.stopAd()),o.emit(exports.PLAY_EVENT.SET_LOADING,{show:!1}),o.emit(exports.H5_PLAY_EVENT.PLAY_SESSION_END,__assign$e(__assign$e({},e),{endState:a,code:n,curFlowNodeName:s}))},o.onFlowEvts=function(e,t){var r,n=((r={})[exports.FLOW_NODE_EVENT.PRELOAD]=exports.PLAY_EVENT_EXT.FLOW_NODE_PRELOAD,r[exports.FLOW_NODE_EVENT.START]=exports.PLAY_EVENT_EXT.FLOW_NODE_START,r[exports.FLOW_NODE_EVENT.END]=exports.PLAY_EVENT_EXT.FLOW_NODE_END,r[exports.FLOW_NODE_EVENT.ABORT]=exports.PLAY_EVENT_EXT.FLOW_NODE_ABORT,r);o.pluginMsg.emit(n[e],t)};var r=t.useSingleVideoElement,n=void 0===r?uaTool.mobile:r;return o.corePlayer=new KernelProxy(__assign$e(__assign$e({},t),{maxVideoNodeCount:n?1:null==t?void 0:t.maxVideoNodeCount,createVideoNodeWhenLoad:n})),o.logger=new Logger(o.config.instanceId,"FlowPlayer"),o.flowManager=new FlowManager({playerInstanceId:o.config.instanceId,onFlowEnd:o.onFlowEnd,onFlowEvts:o.onFlowEvts,disablePreload:n}),o.retryManager=new RetryManager(o),o.proxyAllPlayEvent(),o.proxyStateChange(),o.proxyVideoStopped(),proxyPlayEvent(o,o.corePlayer),o.on(exports.H5_PLAY_EVENT.PLAY_SESSION_START,(function(){o.isSettingLevel=!1})),o}return __extends$d(t,e),Object.defineProperty(t.prototype,"videoElementsContainer",{get:function(){return this.corePlayer.videoElementsContainer},enumerable:!1,configurable:!0}),t.prototype.load=function(e,t){var o;return __awaiter$9(this,void 0,void 0,(function(){return __generator$9(this,(function(r){return e?(this.createFlowNodes(e,t),[2,null===(o=this.flowManager.currentFlowNode)||void 0===o?void 0:o.preload()]):[2,this.corePlayer.load()]}))}))},t.prototype.play=function(e,t){var o;return __awaiter$9(this,void 0,void 0,(function(){return __generator$9(this,(function(r){return e?(this.createFlowNodes(e,t),[2,null===(o=this.flowManager.currentFlowNode)||void 0===o?void 0:o.start()]):[2,this.resumePlay()]}))}))},t.prototype.preload=function(e,t,o){return __awaiter$9(this,void 0,void 0,(function(){return __generator$9(this,(function(r){return this.log("preload() start; ".concat(jsonTool.safelyStringify(e),", ").concat(jsonTool.safelyStringify(t))),this.endPreload(),this.nextReqInfo=new FlowNodeReqInfo({flowid:comTool.createGUID(),startParam:this.getStartParam(e,t),videoReqInfoPlugin:this.videoReqInfoPlugin,instanceId:this.config.instanceId}),this.nextFlowManager=new FlowManager({playerInstanceId:this.config.instanceId}),"function"==typeof this.nodeBeforePreAd&&this.nextFlowManager.push(this.nodeBeforePreAd(this.nextReqInfo)),this.nextFlowManager.push(new PreloadFlowNode({instanceId:this.config.instanceId,corePlayer:this.corePlayer,extEvtDispatcher:this.pluginMsg,reqInfo:this.nextReqInfo,playerConfig:this.config,videoEndTime:o})),this.nextFlowManager.currentFlowNode.start(),[2]}))}))},t.prototype.setAudioTrack=function(e){return this.corePlayer.setAudioTrack(e)},t.prototype.getAudioTrackList=function(){return this.currentVideoInfo?this.currentVideoInfo.audioTracks:[]},t.prototype.getCurrentAudioTrack=function(){return this.currentVideoInfo?this.currentVideoInfo.currentAudioTrack:NaN},t.prototype.updateReqInfo=function(e){if(e&&this.curReqInfo){var t=e.videoReqInfoParam,o=e.videoLoadParam;o&&Object.assign(this.curReqInfo.videoLoadParam,o),t&&Object.assign(this.curReqInfo.videoReqInfoParam,t)}},t.prototype.setLevel=function(e,t){return void 0===t&&(t={}),__awaiter$9(this,void 0,void 0,(function(){return __generator$9(this,(function(o){switch(o.label){case 0:if(!this.checkCanSetLevel())throw new Error("setLevel can't start");this.isSettingLevel=!0,o.label=1;case 1:return o.trys.push([1,3,4,5]),[4,this.videoNode.setLevel(e,t)];case 2:return o.sent(),[3,5];case 3:throw o.sent();case 4:return this.isSettingLevel=!1,[7];case 5:return[2]}}))}))},t.prototype.preloadVid=function(e){throw new Error("Method not implemented.")},t.prototype.pause=function(e){var t=this.flowManager.currentFlowNode;return t?t.pause(e):this.corePlayer.pause(e)},t.prototype.seek=function(e){return this.corePlayer.seek(e)},t.prototype.stop=function(e){var t,o,r;if(this.flowManager.currentFlowNode){var n=this.flowManager.currentFlowNode.getName();this.log("stop(), endState=".concat(e,", curFlowNodeName=").concat(n)),this.flowManager.clear(),null===(o=getAdPlugin(null===(t=this.config)||void 0===t?void 0:t.instanceId))||void 0===o||o.stopAd(),null===(r=this.videoReqInfoPlugin)||void 0===r||r.abort(),this.corePlayer.stop(e),this.emit(exports.PLAY_EVENT.SET_LOADING,{show:!1}),this.emit(exports.H5_PLAY_EVENT.PLAY_SESSION_END,{curFlowNodeName:n,code:exports.ErrorCode.SUC,endState:e||exports.END_STATE.INTERRUPT})}},t.prototype.startGetinfoRetry=function(e,t){return!!this.videoNode&&(this.videoNode.retry(t,e),!0)},t.prototype.canGetinfoRetry=function(){return!0},t.prototype.getRetryCheckClasses=function(){return[CheckNormalError]},t.prototype.destroy=function(){this.stop(),this.removeAllListeners(),this.corePlayer.destroy(),this._destroyed=!0},t.prototype.checkCanSetLevel=function(){return this.videoNode&&!this.isSettingLevel},t.prototype.checkUsePreloadCache=function(e){var t;return!!(null===(t=this.nextReqInfo)||void 0===t?void 0:t.vid)&&e.vid===this.nextReqInfo.vid},t.prototype.loadPostAd=function(){this.videoNode&&this.flowManager.currentFlowNode===this.videoNode&&this.videoNode.emitPreloadNext()},t.prototype.nodeBeforePreAd=function(e){return new RequestFlowNode({reqInfo:e,instanceId:this.config.instanceId,adType:exports.AD_TYPE.PRE})},t.prototype.nodeBeforePostAd=function(e){return new RequestFlowNode({reqInfo:e,instanceId:this.config.instanceId,adType:exports.AD_TYPE.POST})},Object.defineProperty(t.prototype,"videoNode",{get:function(){return this.flowManager.flowNodeList.find((function(e){return e instanceof VideoFlowNode}))},enumerable:!1,configurable:!0}),t.prototype.proxyAllPlayEvent=function(){var e=this;Object.keys(exports.PLAY_EVENT).forEach((function(t){e.corePlayer.on(exports.PLAY_EVENT[t],(function(o){var r=o.data;return e.emit(exports.PLAY_EVENT[t],r)}))}))},t.prototype.proxyStateChange=function(){var e,t=this,o=((e={})[exports.VIDEO_STATE.LOAD_START]=exports.H5_PLAY_EVENT.VIDEO_LOAD_START,e[exports.VIDEO_STATE.CANPLAY]=exports.H5_PLAY_EVENT.VIDEO_CANPLAY,e[exports.VIDEO_STATE.BUFFERING]=exports.H5_PLAY_EVENT.VIDEO_BUFFERING,e[exports.VIDEO_STATE.SEEKING]=exports.H5_PLAY_EVENT.VIDEO_SEEKING,e[exports.VIDEO_STATE.SEEKED]=exports.H5_PLAY_EVENT.VIDEO_SEEKED,e);this.corePlayer.on(exports.PLAY_EVENT.STATE_CHANGE,(function(e){var r=e.data,n=r.new;if(o[n])return t.emit(o[n],{});n!==exports.VIDEO_STATE.PLAYING&&n!==exports.VIDEO_STATE.PAUSE||t.proxyPlayPause(n,r)}))},t.prototype.proxyVideoStopped=function(){var e=this;this.corePlayer.on(exports.PLAY_EVENT.STOPED,(function(t){var o,r=t.data,n=null===(o=null==r?void 0:r.videoInfo)||void 0===o?void 0:o.error,i=__assign$e(__assign$e({},r),{code:(null==n?void 0:n.code)||exports.ErrorCode.SUC});e.emit(exports.H5_PLAY_EVENT.VIDEO_END,i)}))},t.prototype.proxyPlayPause=function(e,t){if(e===exports.VIDEO_STATE.PLAYING){var o=this.isFirstPlaying;this.isFirstPlaying=!1,this.emit(exports.H5_PLAY_EVENT.VIDEO_PLAYING,{isFirst:o})}else e===exports.VIDEO_STATE.PAUSE&&this.emit(exports.H5_PLAY_EVENT.VIDEO_PAUSE,{pauseType:t.pauseType})},t.prototype.resumePlay=function(){var e=this.flowManager.currentFlowNode;e?e.isPreload?e.start():e.resume():this.corePlayer.play()},t.prototype.getStartParam=function(e,t){var o=__assign$e({},t);return isVideoId(e)?o.vid=e:o.urlConfig=e,o},t.prototype.createFlowNodes=function(e,t){var o,r,n;this.flowManager.currentFlowNode&&(this.log("loadItem(), stop because of currentFlowNode is running"),this.stop()),this.endPreload();var i=this.getStartParam(e,t),a=this.checkUsePreloadCache(i),s=this.config,l=s.instanceId,c=s.enableP2P;this.curReqInfo=a?this.nextReqInfo:new FlowNodeReqInfo({flowid:comTool.createGUID(),startParam:i,instanceId:l,videoReqInfoPlugin:this.videoReqInfoPlugin}),this.nextReqInfo=null,this.curReqInfo.startParam=i;var p=this.curReqInfo.flowid;if(this.resetWhenSessionStart(),this.emit(exports.H5_PLAY_EVENT.PLAY_SESSION_START,{flowid:p,playItem:e,isPreload:a}),!this._destroyed){var d=null===(r=(o=this.config).prerequisiteCheck)||void 0===r?void 0:r.call(o,e);if(d)this.emit(exports.H5_PLAY_EVENT.PLAY_SESSION_END,{endState:exports.END_STATE.ERROR,code:d.code,message:d.message});else{"function"==typeof this.nodeBeforePreAd&&this.flowManager.push(this.nodeBeforePreAd(this.curReqInfo));var u=new AdFlowNode({flowid:p,instanceId:l,enableP2P:c,adType:exports.AD_TYPE.PRE,reqInfo:this.curReqInfo,corePlayer:this.corePlayer});this.flowManager.push(u);var A=new VideoFlowNode({flowid:p,corePlayer:this.corePlayer,reqInfo:this.curReqInfo,extEvtDispatcher:this.pluginMsg,emitFromVideoNode:this.emitFromVideoNode,videoLoadParamModifier:this.videoLoadParamModifier});if(this.flowManager.push(A),this.config.type!==exports.PLAY_MODE.LIVE){"function"==typeof this.nodeBeforePostAd&&this.flowManager.push(this.nodeBeforePostAd(this.curReqInfo));var _=new AdFlowNode({flowid:p,instanceId:l,reqInfo:this.curReqInfo,adType:exports.AD_TYPE.POST,corePlayer:this.corePlayer});this.flowManager.push(_),this.flowManager.setLastNode(_)}this.log("loadItem(), flowNodeList=".concat(null===(n=this.flowManager.flowNodeList)||void 0===n?void 0:n.map((function(e){return e.getName()}))))}}},t.prototype.resetWhenSessionStart=function(){this.isFirstPlaying=!0},t.prototype.endPreload=function(){var e;null===(e=this.nextFlowManager)||void 0===e||e.clear(),this.nextFlowManager=null},Object.defineProperty(t.prototype,"config",{get:function(){return this.corePlayer.config},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"useWorker",{get:function(){return this.corePlayer.useWorker},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"kernelName",{get:function(){return this.corePlayer.kernelName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"videoElements",{get:function(){return this.corePlayer.videoElements},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentVideoElement",{get:function(){return this.corePlayer.currentVideoElement},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportPreload",{get:function(){return this.corePlayer.supportPreload},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){return this.corePlayer.duration},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playtime",{get:function(){return this.corePlayer.playtime},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"videoInfos",{get:function(){return this.corePlayer.videoInfos},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"preloadVideoInfos",{get:function(){return this.corePlayer.preloadVideoInfos},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentVideoInfo",{get:function(){return this.corePlayer.currentVideoInfo},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentVideoInfoIdx",{get:function(){return this.corePlayer.currentVideoInfoIdx},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalVideoInfoCount",{get:function(){return this.corePlayer.totalVideoInfoCount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportPlaybackRate",{get:function(){return this.corePlayer.supportPlaybackRate},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"played",{get:function(){return this.corePlayer.played},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this.corePlayer.state},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"videoSize",{get:function(){return this.corePlayer.videoSize},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"videoBuffered",{get:function(){return this.corePlayer.videoBuffered},enumerable:!1,configurable:!0}),t.prototype.log=function(){for(var e,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];return(e=this.logger).log.apply(e,t)},t.prototype.hasAppended=function(e){return this.corePlayer.hasAppended(e)},t.prototype.hasPreloaded=function(e){return this.corePlayer.hasPreloaded(e)},Object.defineProperty(t.prototype,"volume",{get:function(){return this.corePlayer.volume},set:function(e){this.corePlayer.volume=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playbackRate",{get:function(){return this.corePlayer.playbackRate},set:function(e){this.corePlayer.playbackRate=e},enumerable:!1,configurable:!0}),t.prototype.resizeVideoElements=function(e){return this.corePlayer.resizeVideoElements(e)},t.prototype.resize=function(e){return this.corePlayer.resize(e)},t.prototype.playNext=function(e){return this.corePlayer.playNext(e)},t.prototype.captureVideo=function(e,t,o,r,n){return this.corePlayer.captureVideo(e,t,o,r,n)},t.prototype.appendNext=function(e){return this.corePlayer.appendNext(e)},t.prototype.preloadNext=function(){for(var e,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];return(e=this.corePlayer).preloadNext.apply(e,t)},t.prototype.clearAllPreload=function(){return this.corePlayer.clearAllPreload()},t.prototype.triggerAutoplay=function(){return this.corePlayer.triggerAutoplay()},t}(PluginablePlayer),_a$5,logMethodCall$1=logMethodCallDecoratorCreator("H5Player"),rotateTransformValue=(_a$5={},_a$5[exports.PictureDirection.VERTICAL]="rotateX(180deg)",_a$5[exports.PictureDirection.HORIZON]="rotateY(180deg)",_a$5[exports.PictureDirection.NORMAL]="none",_a$5);function collectUsage(){var e="npm";try{e="npm"}catch(e){}ReferenceReport.getReporter().collectUsage(1,e)}var H5Player=function(e){function t(t){var o=this;t.isPrivateDeployment||collectUsage(),(o=e.call(this,__assign$e(__assign$e(__assign$e({},defaultH5PlayerConfig),t.coreConfig),t))||this).plugins={},o.interactMod=null,o.getCommonKv=function(e){return o.dataset.commonMap[e]},o.getStateKv=function(e){return o.dataset.stateMap[e]},o.mutedVolume=1,o.hasMutePlayed=!1,o.mixin=function(e){var t="function"==typeof e?e():e;Object.keys(t).forEach((function(e){if(e in o)throw new Error("cannot override existing player method: ".concat(e));var r=t[e];"function"==typeof r?o[e]=r:console.error("mixin ".concat(r," is not a function"))}))},o.log("new H5Player(), input config=",jsonTool.safelyStringify(t));var r=Date.now(),n=t.container,i=t.plugins,a=t.mixins,s=t.lazyInitPlugins;if(o.container="string"==typeof n?document.querySelector(n):n,!o.container)throw new Error("cannot find container: ".concat(n));o.fullscreenLogics=new FullScreenLogics(o,o.config.fullscreenContainer);return o.setMaxListeners(100),o.createClickMask(),o.createInnerPlugins(),i instanceof Array&&(s?setTimeout((function(){o.createPlugins(i),o.initGetinfoModule(t)})):(o.createPlugins(i),o.initGetinfoModule(t))),a instanceof Array&&a.forEach(o.mixin),o.initPlayerResizeObserver(),o.initPluginApis(),o.forwardPluginEvents(),o.initContainerStyle(),o.setupEventFlagData(),o.setupLoopPlay(),o.checkAutoPlayInMute(),o.autoHideMouse(),o.applyStyleOnVideoNodeChange(),o.on(exports.H5_PLAY_EVENT.PLAY_SESSION_START,(function(){o.hasMutePlayed=!1})),o.setStateKv(exports.DATA_STATE.INIT,{type:exports.LOG_TYPE.CORE_EVENT,ftime:Date.now(),ext:{stime:r}}),o}return __extends$d(t,e),t.registerSavedCommonKey=function(e){DataSet.SETTING_CONFIG[e]?console.warn("key ".concat(e," already registered")):DataSet.SETTING_CONFIG.push({dsKey:e,lsKey:"__thumbplayer_custom_".concat(e,"__")})},t.prototype.load=function(t,o){return t?(this.cacheLoadParam(t,o),this.corePlayer.load(),e.prototype.load.call(this,t,this.getParamWithStartTime(t,o))):e.prototype.load.call(this)},t.prototype.play=function(t,o){return t?(this.cacheLoadParam(t,o),this.corePlayer.load(),e.prototype.play.call(this,t,this.getParamWithStartTime(t,o))):e.prototype.play.call(this)},t.prototype.createPlugin=function(t,o){void 0===o&&(o={}),e.prototype.createPlugin.call(this,t,o);var r=o.pluginName;(void 0===r?t:r)===AdPluginName&&proxyAdEvent(this)},t.prototype.replay=function(){var e,t,o=this.vid,r=this.playUrl;if(null===(t=null===(e=this.loadParam)||void 0===e?void 0:e.videoLoadParam)||void 0===t||delete t.startTime,o)return this.play(o,this.loadParam);if(r){var n=r.lastIndexOf("#");return n>0&&(r=r.slice(0,n)),this.play({url:r},this.loadParam)}this.log("Current player has no available vid or url to replay")},t.prototype.pause=function(t){return e.prototype.pause.call(this,t)},t.prototype.seek=function(t){var o=this.timeRange,r=o.startTime,n=o.endTime,i=Math.min(n,Math.max(r,t));return e.prototype.seek.call(this,i)},t.prototype.setPictureImage=function(e){void 0===e&&(e=exports.PictureDirection.NORMAL),this.pictureDirection=e,this.isPlayingAd?this.setAdVideoStyle({transform:rotateTransformValue[e]}):this.setVideoStyle({transform:rotateTransformValue[e]}),e===exports.PictureDirection.NORMAL&&(this.rotateDegree=0)},t.prototype.setRotate=function(e){"number"!=typeof e||Number.isNaN(e)||(this.rotateDegree=e,this.isPlayingAd?this.setAdVideoStyle({transform:"rotate(".concat(e,"deg)")}):this.setVideoStyle({transform:"rotate(".concat(e,"deg)")}))},t.prototype.getRotate=function(){return this.rotateDegree},t.prototype.requestFullScreen=function(e,t){return void 0===e&&(e=!0),__awaiter$9(this,void 0,void 0,(function(){return __generator$9(this,(function(o){return[2,this.fullscreenLogics.requestFullScreen(e,t)]}))}))},Object.defineProperty(t.prototype,"fullscreenMode",{get:function(){return this.fullscreenLogics.fullscreenMode},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"volume",{get:function(){return this.corePlayer.volume},set:function(e){var t;this.corePlayer.volume=e,null===(t=getAdPlugin(this.config.instanceId))||void 0===t||t.setAdVolume(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"timeRange",{get:function(){return this.playtimeLimiter.range},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){var e,t,o,r=this;try{this.stop(),this.pluginMsg.emit(exports.PLAY_EVENT_EXT.DESTROY)}catch(e){this.log(e)}this.plugins&&(Object.keys(this.plugins).forEach((function(e){var t,o;null===(o=null===(t=r.plugins[e])||void 0===t?void 0:t.destroy)||void 0===o||o.call(t)})),delete this.plugins),setAdPlugin(null===(e=this.config)||void 0===e?void 0:e.instanceId,null),null===(t=this.containerResizeObserver)||void 0===t||t.disconnect(),this.containerResizeObserver=null,this.fullscreenLogics.destroy(),this.removeAllListeners(),this.pluginMsg.removeAllListeners(),this.corePlayer.destroy(),this.container.innerHTML="",null===(o=this.interactMod)||void 0===o||o.remove(),this.interactMod=null;var n=this.container.cloneNode();this.container.parentNode.replaceChild(n,this.container),this.container=n,clearTimeout(this.mouseMoveTimer),"none"===this.container.style.cursor&&(this.container.style.cursor="auto"),this._destroyed=!0},Object.defineProperty(t.prototype,"offlineLogPlugin",{get:function(){return this.plugins[OfflineLogPlugin.pluginName]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pluginInstances",{get:function(){return this.plugins},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"player",{get:function(){return this},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,PlaytimeLimiterPlugin.pluginName,{get:function(){return this.plugins[PlaytimeLimiterPlugin.pluginName]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,DataSet.pluginName,{get:function(){return this.plugins[DataSet.pluginName]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,OfflineLogPlugin.pluginName,{get:function(){return this.plugins[OfflineLogPlugin.pluginName]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"vid",{get:function(){return isVideoId(this.currentPlayItem)?this.currentPlayItem:null},enumerable:!1,configurable:!0}),t.prototype.canGetinfoRetry=function(){return!!this.player.vid},Object.defineProperty(t.prototype,"url",{get:function(){var e;return null===(e=this.currentVideoInfo)||void 0===e?void 0:e.loadingUrl},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"paused",{get:function(){return this.state===exports.VIDEO_STATE.PAUSE},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"muted",{get:function(){return 0===this.volume},set:function(e){e?(this.mutedVolume=this.volume,this.volume=0):this.muted&&(this.volume=this.mutedVolume)},enumerable:!1,configurable:!0}),t.prototype.setStateKv=function(e,t,o){this.dataset.writeState(e,t,o)},t.prototype.setCommonKv=function(e,t,o){var r=this;"string"==typeof e?this.dataset.writeCommon(e,t,o):Object.keys(e).forEach((function(o){return r.dataset.writeCommon(o,e[o],t)}))},Object.defineProperty(t.prototype,"videoReqParam",{get:function(){var e;return null===(e=this.loadParam)||void 0===e?void 0:e.videoReqInfoParam},enumerable:!1,configurable:!0}),t.prototype.selectGetinfoModule=function(e){return null==e?void 0:e.getinfoModule},t.prototype.getParamWithStartTime=function(e,t){var o;void 0===t&&(t={});var r=this.playtimeLimiter;if(!e)return t;if(null===(o=t.videoLoadParam)||void 0===o?void 0:o.startTime)return t;if("string"==typeof e||"number"==typeof e)r.clearAllConfig(e);else{if(Array.isArray(e))return t;r.clearAllConfig(e.url)}return t.playTimeLimit&&r.addLimitConfig(t.playTimeLimit),__assign$e(__assign$e({},t),{videoLoadParam:__assign$e(__assign$e({},t.videoLoadParam),{startTime:this.timeRange.startTime})})},t.prototype.createClickMask=function(){var e=this,t=this.config,o=t.enableInteractMod,r=void 0===o||o,n=t.type;if(r&&n!==exports.PLAY_MODE.LIVE){var i=document.createElement("div");i.classList.add("thumbplayer-user-mod"),domTool.css(i,{width:"100%",height:"100%",position:"absolute","z-index":1}),domTool.append(this.container,i),i.addEventListener("click",(function(){[exports.VIDEO_STATE.PAUSE,exports.VIDEO_STATE.CANPLAY].includes(e.state)?e.play():[exports.VIDEO_STATE.PLAYING,exports.VIDEO_STATE.BUFFERING].includes(e.state)&&e.pause(exports.H5_PAUSE_TYPE.USER_CLICK)})),this.interactMod=i}},t.prototype.initContainerStyle=function(){var e=this.container;e.style.outline="0 none",e.style.overflow="hidden",e.style.backgroundColor="#000","static"===getComputedStyle(e).position&&(e.style.position="relative")},t.prototype.forwardPluginEvents=function(){var e=this;this[DataSet.pluginName].on(exports.DATA_EVENTS.STATE_UPDATE,(function(t){var o=t.data;e.pluginMsg.emit(exports.PLAY_EVENT_EXT.DATASET_STATE_UPDATE,o)})),this[DataSet.pluginName].on(exports.DATA_EVENTS.UPDATE,(function(t){var o=t.data;e.pluginMsg.emit(exports.PLAY_EVENT_EXT.DATASET_UPDATE,o)})),this.on(exports.PLAY_EVENT.SET_LOADING,(function(t){var o=t.data;e.pluginMsg.emit(exports.PLAY_EVENT_EXT.SET_LOADING,{value:o.show})}))},t.prototype.createInnerPlugins=function(){var e;this.createPlugin(DataSet.pluginName),!OfflineLogPlugin.isEnvSupport||(null===(e=this.config.offlineConfig)||void 0===e?void 0:e.disable)||this.config.isPrivateDeployment||this.createPlugin(OfflineLogPlugin.pluginName),this.createPlugin(PlaytimeLimiterPlugin.pluginName),this.config.enableQAreporter&&!this.config.isPrivateDeployment&&this.createPlugin(this.config.type===exports.PLAY_MODE.LIVE?LiveQaReporterPlugin.pluginName:VodQaReporterPlugin.pluginName)},t.prototype.cacheLoadParam=function(e,t){e&&(isVideoId(e)&&this.pluginMsg.emit(exports.PLAY_EVENT_EXT.VID_CHANGE,{oldVal:this.vid,newVal:e}),this.currentPlayItem=e,t&&Object.keys(t).length&&(this.loadParam=t))},t.prototype.setupEventFlagData=function(){var e=this;this.on(exports.H5_PLAY_EVENT.AD_PLAYING,(function(){return e.isPlayingAd=!0})),this.on(exports.H5_PLAY_EVENT.AD_END,(function(){return e.isPlayingAd=!1}))},t.prototype.setupLoopPlay=function(){var e=this;this.on(exports.H5_PLAY_EVENT.PLAY_SESSION_END,(function(t){var o=t.data.endState===exports.END_STATE.NORMAL;e.config.loop&&o&&e.replay()})),this.on(exports.H5_PLAY_EVENT.VIDEO_PLAYING,(function(t){if(t.data.isFirst&&e.config.loop){var o=e.currentVideoElement;o instanceof HTMLVideoElement&&(o.loop=isUrlConfig(e.currentPlayItem)&&e.corePlayer.kernelName===exports.KERNEL_NAME.ORIGIN)}}))},Object.defineProperty(t.prototype,"playUrl",{get:function(){var e=this.currentPlayItem;if(!isVideoId(e)&&!Array.isArray(e))return null==e?void 0:e.url},enumerable:!1,configurable:!0}),t.prototype.checkAutoPlayInMute=function(){var e=this;if(this.config.autoPlayInMute||this.config.autoPlayPolicy===exports.AUTO_PLAY_POLICY.IN_MUTED){var t=function(){var t;e.hasMutePlayed||(e.hasMutePlayed=!0,e.muted=!0,null===(t=getAdPlugin(e.config.instanceId))||void 0===t||t.setAdVolume(0),e.play())};this.on(exports.H5_PLAY_EVENT.AD_AUTOPLAY_BLOCKED,(function(){return setTimeout(t)})),this.on(exports.H5_PLAY_EVENT.VIDEO_AUTOPLAY_BLOCKED,t)}},t.prototype.autoHideMouse=function(){var e=this;this.container.addEventListener("mousemove",(function(){"none"===e.container.style.cursor&&(e.container.style.cursor="auto"),clearTimeout(e.mouseMoveTimer),e.mouseMoveTimer=setTimeout(e.hideMouseOnFullscreen.bind(e),5e3)}))},t.prototype.hideMouseOnFullscreen=function(){var e=document,t=e.fullscreenElement||e.webkitFullscreenElement||e.mozFullScreenElement||e.msFullscreenElement;(this.config.autoHideMouse||t)&&this.state===exports.VIDEO_STATE.PLAYING&&(this.container.style.cursor="none")},t.prototype.initPlayerResizeObserver=function(){var e=this;this.containerResizeObserver=new ResizeObserver((function(){var t=e.container,o=t.clientWidth,r=t.clientHeight;e.emit(exports.PLAY_EVENT.CONTAINER_RESIZE,{width:o,height:r})})),this.containerResizeObserver.observe(this.container)},t.prototype.setVideoStyle=function(e){domTool.css(this.corePlayer.currentVideoElement,e)},t.prototype.setAdVideoStyle=function(e){var t,o,r,n=null===(r=null===(o=getAdPlugin(null===(t=this.config)||void 0===t?void 0:t.instanceId))||void 0===o?void 0:o.videoAdPlayer)||void 0===r?void 0:r.videoElements;n&&n.forEach((function(t){return domTool.css(t,e)}))},t.prototype.applyStyleOnVideoNodeChange=function(){var e=this,t=function(){if(void 0!==e.pictureDirection||void 0!==e.rotateDegree)return rotateTransformValue[e.pictureDirection]||"rotate(".concat(e.rotateDegree,"deg)")};this.corePlayer.on(exports.PLAY_EVENT.VIDEONODE_CHANGE,(function(){var o=t();o&&e.setVideoStyle({transform:o})})),this.on(exports.H5_PLAY_EVENT.AD_REQ_ASSETS_START,(function(o){if(isPreOrPostAd(o.data)){var r=t();r&&e.setAdVideoStyle({transform:r})}})),this.on(exports.H5_PLAY_EVENT.AD_END,(function(o){isPreOrPostAd(o.data)&&(t()&&e.setAdVideoStyle({transform:"none"}))}))},t.prototype.initPluginApis=function(){var e=this;this.playerApiProxy.replayInCurFlowNode=function(t,o){var r;return e.log("replayInCurFlowNode(), vid=".concat(t,", param=").concat(jsonTool.safelyStringify(o))),null===(r=e.flowManager.currentFlowNode)||void 0===r?void 0:r.replay(t,o)}},t.prototype.initGetinfoModule=function(e){var t=this.selectGetinfoModule(e);t&&(this.videoReqInfoPlugin=new t(this))},t.registerKernel=KernelFactory$1.registerKernel,t.KernelFactory=KernelFactory$1,__decorate$9([logMethodCall$1,__metadata$9("design:type",Function),__metadata$9("design:paramtypes",[Object,Object]),__metadata$9("design:returntype",void 0)],t.prototype,"load",null),__decorate$9([logMethodCall$1,__metadata$9("design:type",Function),__metadata$9("design:paramtypes",[Object,Object]),__metadata$9("design:returntype",void 0)],t.prototype,"play",null),__decorate$9([logMethodCall$1,__metadata$9("design:type",Function),__metadata$9("design:paramtypes",[]),__metadata$9("design:returntype",void 0)],t.prototype,"replay",null),__decorate$9([logMethodCall$1,__metadata$9("design:type",Function),__metadata$9("design:paramtypes",[String]),__metadata$9("design:returntype",void 0)],t.prototype,"pause",null),__decorate$9([logMethodCall$1,__metadata$9("design:type",Function),__metadata$9("design:paramtypes",[Number]),__metadata$9("design:returntype",void 0)],t.prototype,"seek",null),t}(FlowPlayer);function createH5Player(e){return new H5Player(e)}H5Player.registerPlugin(DataSet.pluginName,DataSet),H5Player.registerPlugin(PlaytimeLimiterPlugin.pluginName,PlaytimeLimiterPlugin),H5Player.registerPlugin(OfflineLogPlugin.pluginName,OfflineLogPlugin),H5Player.registerPlugin(VodQaReporterPlugin.pluginName,VodQaReporterPlugin),H5Player.registerPlugin(LiveQaReporterPlugin.pluginName,LiveQaReporterPlugin);var BUILD_TIME$1=1678263401454,VERSION$2="1.15.22",ThumbPlayerH5=Object.freeze({__proto__:null,createH5Player:createH5Player,H5Player:H5Player,BUILD_TIME:BUILD_TIME$1,VERSION:VERSION$2,BaseReporter:BaseReporter,kernelEvtBus:kernelEvtBus,preloadEvtBus:preloadEvtBus,EvtEmitter:s,PLAY_EVENT:exports.PLAY_EVENT,VIDEO_STATE:exports.VIDEO_STATE,KERNEL_NAME:exports.KERNEL_NAME,PLAY_MODE:exports.PLAY_MODE,END_STATE:exports.END_STATE,PRELOAD_TYPE:exports.PRELOAD_TYPE,VIDEO_CODEC:exports.VIDEO_CODEC,CONTAINER_FORMAT:exports.CONTAINER_FORMAT,AUDIO_CODEC:exports.AUDIO_CODEC,i18nConfig:i18nConfig,t:compile,get ErrorCode(){return exports.ErrorCode},get ErrorMsg(){return exports.ErrorMsg},get FullScreenMode(){return exports.FullScreenMode},getAdPlugin:getAdPlugin,adEvents:adEvents,BaseFlowNode:BaseFlowNode,get FLOW_NODE_EVENT(){return exports.FLOW_NODE_EVENT},BeaconRequest:BeaconRequest,ImageRequest:report,definePlugins:definePlugins,autobind:autobind,logApiInvoke:logApiInvoke,once:once,get H5_EXT_EVENT(){return exports.PLAY_EVENT_EXT},get H5_PLAY_EVENT(){return exports.H5_PLAY_EVENT},Plugin:Plugin,isFunctionPlugin:isFunctionPlugin,createPluginFactory:createPluginFactory,getHookMethodName:getHookMethodName,registerPlugin:registerPlugin,deregisterPlugin:deregisterPlugin,getPlugin:getPlugin,getPlugins:getPlugins,pluginExists:pluginExists,AdPluginName:AdPluginName,get AD_TYPE(){return exports.AD_TYPE},isPreOrPostAd:isPreOrPostAd,isVideoId:isVideoId,DRM_TYPE:DRM_TYPE,DRM_VALUE:DRM_VALUE,OFFICIAL_PLUGIN:OFFICIAL_PLUGIN,PLUGIN_MAP:PLUGIN_MAP,get H5_PAUSE_TYPE(){return exports.H5_PAUSE_TYPE},get AUTO_PLAY_POLICY(){return exports.AUTO_PLAY_POLICY},get PictureDirection(){return exports.PictureDirection},get DATA_EVENTS(){return exports.DATA_EVENTS},get DATA_STATE(){return exports.DATA_STATE},get LOG_TYPE(){return exports.LOG_TYPE},get BUFFER_REASON(){return exports.BUFFER_REASON},get LOCAL_KEY(){return exports.LOCAL_KEY},get PersistedUserSettings(){return exports.PersistedUserSettings},DEFAULT_KEY:DEFAULT_KEY,COMMON_DATA_KEY:COMMON_DATA_KEY}),VideoReqInfoPluginName="__thumbplayer-video-request";window.ThumbPlayerH5=ThumbPlayerH5;var ThumbPlayerH5$1=Object.freeze({__proto__:null,get AD_TYPE(){return exports.AD_TYPE},get AUTO_PLAY_POLICY(){return exports.AUTO_PLAY_POLICY},AdPluginName:AdPluginName,get BUFFER_REASON(){return exports.BUFFER_REASON},BUILD_TIME:BUILD_TIME$1,BaseCheck:BaseCheck,BaseFlowNode:BaseFlowNode,BaseReporter:BaseReporter,BeaconRequest:BeaconRequest,COMMON_DATA_KEY:COMMON_DATA_KEY,get DATA_EVENTS(){return exports.DATA_EVENTS},get DATA_STATE(){return exports.DATA_STATE},DEFAULT_KEY:DEFAULT_KEY,DRM_TYPE:DRM_TYPE,DRM_VALUE:DRM_VALUE,get ErrorCode(){return exports.ErrorCode},get ErrorMsg(){return exports.ErrorMsg},get FLOW_NODE_EVENT(){return exports.FLOW_NODE_EVENT},get FullScreenMode(){return exports.FullScreenMode},H5Player:H5Player,get H5_EXT_EVENT(){return exports.PLAY_EVENT_EXT},get H5_PAUSE_TYPE(){return exports.H5_PAUSE_TYPE},get H5_PLAY_EVENT(){return exports.H5_PLAY_EVENT},ImageRequest:report,get LOCAL_KEY(){return exports.LOCAL_KEY},get LOG_TYPE(){return exports.LOG_TYPE},OFFICIAL_PLUGIN:OFFICIAL_PLUGIN,PLUGIN_MAP:PLUGIN_MAP,get PersistedUserSettings(){return exports.PersistedUserSettings},get PictureDirection(){return exports.PictureDirection},Plugin:Plugin,VERSION:VERSION$2,VideoReqInfoPluginName:VideoReqInfoPluginName,adEvents:adEvents,autobind:autobind,createH5Player:createH5Player,createPluginFactory:createPluginFactory,definePlugins:definePlugins,deregisterPlugin:deregisterPlugin,getAdPlugin:getAdPlugin,getHookMethodName:getHookMethodName,getPlugin:getPlugin,getPlugins:getPlugins,isFunctionPlugin:isFunctionPlugin,isPreOrPostAd:isPreOrPostAd,isVideoId:isVideoId,logApiInvoke:logApiInvoke,once:once,pluginExists:pluginExists,registerPlugin:registerPlugin,get AUDIO_CODEC(){return exports.AUDIO_CODEC},get CONTAINER_FORMAT(){return exports.CONTAINER_FORMAT},get END_STATE(){return exports.END_STATE},EvtEmitter:s,get KERNEL_NAME(){return exports.KERNEL_NAME},get PLAY_EVENT(){return exports.PLAY_EVENT},get PLAY_MODE(){return exports.PLAY_MODE},get PRELOAD_TYPE(){return exports.PRELOAD_TYPE},get VIDEO_CODEC(){return exports.VIDEO_CODEC},get VIDEO_STATE(){return exports.VIDEO_STATE},i18nConfig:i18nConfig,kernelEvtBus:kernelEvtBus,preloadEvtBus:preloadEvtBus,t:compile}),extendStatics$1=function(e,t){return extendStatics$1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},extendStatics$1(e,t)};function __extends$1(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}extendStatics$1(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}var __assign$2=function(){return __assign$2=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},__assign$2.apply(this,arguments)};function __decorate(e,t,o,r){var n,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,o,a):n(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a}function __metadata(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function __awaiter$1(e,t,o,r){return new(o||(o=Promise))((function(n,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))}function __generator$1(e,t){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function __spreadArray$1(e,t,o){if(o||2===arguments.length)for(var r,n=0,i=t.length;n<i;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))}var isMobile=uaTool.mobile,txpHideClass="txp_none";function styleInject$5(e,t){void 0===t&&(t={});var o=t.insertAt;if(e&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css","top"===o&&r.firstChild?r.insertBefore(n,r.firstChild):r.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}}var css_248z$6=".txp_video_error{position:absolute;top:0;left:0;width:100%;height:100%;z-index:99;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;background-color:#111;color:#fff}.txp_video_error.txp_none,.txp_video_error .txp_none{display:none!important}.txp_video_error a{color:#fff;text-decoration:none}.txp_video_error .txp_error_title{margin:10px 20px;font-size:18px;line-height:1.6;text-align:center}.txp_video_error .txp_error_title .txp_btn{color:#ff6428;font-size:inherit}.txp_video_error .error-noise-bg{position:absolute;width:100%;height:100%;left:0;top:0;z-index:-1}.txp_video_error .txp_error_code{margin:30px 20px 0;line-height:1.5;color:#666;pointer-events:auto;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;text-align:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.txp_video_error .txp_error_code a{cursor:pointer;color:#666;border-bottom:1px solid}.txp_video_error .txp_error_code a:hover{color:#ff6428}.txp_video_error .txp_error_code::-moz-selection, .txp_video_error .txp_error_code ::-moz-selection{color:#fff;background:#eee}.txp_video_error .txp_error_code::selection,.txp_video_error .txp_error_code ::selection{color:#fff;background:#eee}.txp_video_error .txp_error_code::-moz-selection,.txp_video_error .txp_error_code ::-moz-selection{color:#fff;background:#eee}.txp_video_error .none{display:none}.txp_video_error .txp_link_refresh{color:#fc6526}.txp_video_error .txp_link_btn{display:block;outline:none;border:none;margin-bottom:16px;padding:0 20px;border-radius:15px;background:#26262b;color:#fc6526;font-size:14px;line-height:30px;cursor:pointer}.txp_video_error .txp_link_btn:hover{color:#fff;background-color:#fc6526}.txp_video_error .txp_browser a{text-decoration:underline;cursor:pointer}.txp_video_error .txp_browser a:hover{color:#ff6428}";styleInject$5(css_248z$6);var queue=[],isReq=!1,qqlive=0,getClient=function(e){if(qqlive)e(qqlive);else if(queue.push(e),!isReq){if(isReq=!0,"qq.com"!=document.domain)throw new Error("document.domain is not qq.com");var t=document.createElement("iframe");t.src="javascript:'<script>window.onload=function(){document.write(\\'<script>document.domain=\\\"qq.com\\\";<\\\\/script>\\');document.close();};<\/script>'",t.style.cssText="display:none;",document.body.appendChild(t),t.getClient=function(e){qqlive=e;for(var t=queue.shift();t;)t&&t(e),t=queue.shift()},t.src="//v.qq.com/iframe/client.html"}},ErrorPagePluginName$1="error-page",ErrorPagePluginEvents$1={REPORT_LOG:"error-page:report-log"},defaultErrorText$1="出错啦",defaultErrorMsg$1="这个视频被外星人劫走，暂时看不了了~",dataRoleMap$1={error:"txp-ui-error",errorMsg:"txp-ui-error-msg",errorHandler:"txp-ui-error-handler",errorRefresh:"txp-ui-error-refresh",errorCode:"txp-ui-error-code",background:"txp-ui-error-background",clientBtn:"txp-ui-error-client-btn",browserTip:"txp-ui-error-browser"},DRM_MODULE_ERROR_CODE_REGEX=/^7009\d+(\.?-?\d+)?$/,ENV_NOT_SUPPORT_ENCRYPTION_LIVE_CODES=["70023097","70023098"],ENV_NOT_SUPPORT_ENCRYPTION_VOD_CODES=["70013069.4","70013097.0","70013097.2","70013098.1","70013080.14"],NO_PLAYBACK_COPYRIGHTS_CODE="70013080.2";function getGuidingMessage(e){return-1!==__spreadArray$1(__spreadArray$1([],ENV_NOT_SUPPORT_ENCRYPTION_LIVE_CODES,!0),ENV_NOT_SUPPORT_ENCRYPTION_VOD_CODES,!0).indexOf(e)||DRM_MODULE_ERROR_CODE_REGEX.test(e)?"<p>为保护正版防止盗版，您可以尝试</p>":"<p>您可以尝试</p>"}function checkIfClientNeeded(e,t){return void 0===t&&(t=!1),!!DRM_MODULE_ERROR_CODE_REGEX.test(e)||(t?-1!==ENV_NOT_SUPPORT_ENCRYPTION_LIVE_CODES.indexOf(e):-1!==__spreadArray$1(__spreadArray$1([],ENV_NOT_SUPPORT_ENCRYPTION_VOD_CODES,!0),[NO_PLAYBACK_COPYRIGHTS_CODE],!1).indexOf(e))}function saveChannel(e){var t="qqlivechannel=channel1."+e;if(uaTool.browser.ie){var o=new Date;o.setTime(o.getTime()+864e5),document.cookie=t+";path=/;expires="+o.toUTCString()}else{var r=document.createElement("input");document.querySelector("body").append(r),r.style.position="absolute",r.style.top="-9999px",r.value=t,r.style.top=document.querySelector("body").scrollTop+"px",r.focus(),r.setSelectionRange(0,t.length),document.queryCommandSupported("copy")&&document.execCommand("copy",!0),r.remove()}}function openClient(e){if(e.support&&e.sso){try{saveChannel(e.atag)}catch(e){}try{getClient((function(t){t&&t.exist().done((function(){t.open(e.sso),e.success()})).fail((function(){e.error()}))}))}catch(e){console.log(e)}}}Object.keys(defaultI18nConfig.core).forEach((function(e){/ERROR_DRM_.*/.test(e)&&(defaultI18nConfig.core[e]="该视频因版权方安全保密级别较高，当前浏览器不支持加密播放")}));var qqbrowserHelper={exist:!1,isLatestChromeSupportDrm:function(){var e=uaTool.os;if(e.windows)return parseFloat(e.version)>6;if(e.mac){if(uaTool.browser.qqbrowser)return!1;var t=(e.version||"").split(".");return parseFloat((t[0]||"0")+"."+(t[1]||"0"))>10.1}return!e.linux&&void 0},detect:function(){var e=new SimpleDefer,t=document.createElement("meta");return t.name="referrer",t.content="always",document.head.prepend(t),this.isLatestChromeSupportDrm()?fetch("http://127.0.0.1:28653/api/handle",{method:"POST",body:JSON.stringify({action:"GetQBVersion",cmd:""})}).then((function(e){return e.json()})).then((function(o){t.remove();var r=!1,n=o.result||"";n&&(r=-1!==comTool.compareVersion(n,"10.2.2101.400")),r?(qqbrowserHelper.exist=!0,e.resolve({exist:!0})):(qqbrowserHelper.exist=!1,e.resolve({exist:!1}))})).catch((function(){t.remove(),qqbrowserHelper.exist=!1,e.resolve({exist:!1})})):e.reject(),e},download:function(){try{location.assign("http://dldir1.qq.com/invc/tt/QQBrowser_Setup_DRM.exe")}catch(e){}},open:function(e){if(qqbrowserHelper.exist){var t=document.createElement("meta");t.name="referrer",t.content="always",document.head.prepend(t),fetch("http://127.0.0.1:28653/api/handle",{method:"POST",body:JSON.stringify({action:"Open",cmd:encodeURIComponent(e)})}).then((function(){t.remove()})).catch((function(){t.remove()}))}else this.download()}},defaultNoiseConfig={enable:!isMobile,interval:150,performanceRatio:5,size:4,opacity:.05},WHITE_RGB_VALUE=16777215,ErrorPagePlugin=function(e){function t(t,o,r){var n,i=e.call(this,t,o,r)||this;return i.innerElements={},i.clientExistDefer=new SimpleDefer,i.noiseAnimation=function(e,t,o,r,n){var i=Math.floor(o/n),a=e.createImageData(t,i),s=new Uint32Array(a.data.buffer);e.clearRect(0,0,t,o);for(var l=0;l<s.length;l++)s[l]=((255*Math.random()*r|0)<<24)+WHITE_RGB_VALUE;for(l=0;l<=n;l++)e.putImageData(a,0,i*l)},i.browserTipClick=function(){qqbrowserHelper.open(location.href)},i.config=__assign$2(__assign$2({},t.config.errorPageConfig),o),i.config.noiseConfig=__assign$2(__assign$2({},defaultNoiseConfig),null===(n=i.config)||void 0===n?void 0:n.noiseConfig),i.insertDOM(),i.setupDOMEvents(),i.setupPlayerEvents(),i}return __extends$1(t,e),t.prototype.show=function(e){void 0===e&&(e=defaultErrorText$1);var t=this.player.getCommonKv(COMMON_DATA_KEY.flowid),o="object"==typeof e&&Boolean(null==e?void 0:e.img);if("string"==typeof e)this.innerElements.errorMsg.innerHTML=e,this.innerElements.errorCode.innerHTML=t||"",this.innerElements.background.classList.add(txpHideClass),this.innerElements.errorRefresh.classList.remove(txpHideClass);else{var r=e.text,n=void 0===r?defaultErrorText$1:r,i=e.code,a=void 0===i?"":i,s=e.img,l=void 0===s?"":s,c=e.hideRefresh,p=void 0!==c&&c;this.innerElements.errorMsg.innerHTML=n,this.innerElements.errorCode.innerHTML=a?String(a)+"-"+t:t,this.innerElements.background.src=l,this.innerElements.background.classList.toggle(txpHideClass,!l),this.innerElements.errorRefresh.classList.toggle(txpHideClass,p)}this.rootEl.classList.remove(txpHideClass),this.setNoise(!o)},t.prototype.hide=function(){this.rootEl.classList.add(txpHideClass),this.setNoise(!1),domTool.addClass(this.innerElements.clientBtn,txpHideClass),domTool.addClass(this.innerElements.browserTip,txpHideClass),domTool.addClass(this.innerElements.errorRefresh,txpHideClass)},t.prototype.destroy=function(){var t;this.setNoise(!1),this.rootEl.parentNode&&this.rootEl.remove(),this.innerElements={},null===(t=this.noiseBg)||void 0===t||t.remove(),this.noiseBg=null,this.rootEl=null,e.prototype.destroy.call(this)},t.prototype.insertDOM=function(){var e=this,t=this.player.container,o=this.config.noiseConfig,r='<div data-role="'+dataRoleMap$1.error+'" class="txp_video_error '+txpHideClass+'">\n      '+(o.enable?'<canvas class="error-noise-bg"></canvas>':"")+'\n      <img data-role="'+dataRoleMap$1.background+'" alt="error-background"/>\n      <div data-role="'+dataRoleMap$1.errorMsg+'" class="txp_error_title"></div>\n      <div data-role="'+dataRoleMap$1.errorHandler+'" class="txp_error_desc">\n        <span data-role="'+dataRoleMap$1.errorRefresh+'">\n          你可以 <a href="javascript:;" class="txp_link_refresh">刷新</a> 试试\n        </span>\n      </div>\n      <button data-role="'+dataRoleMap$1.clientBtn+'" class="txp_link_btn '+txpHideClass+'"></button>\n      <div data-role="'+dataRoleMap$1.browserTip+'" class="txp_browser '+txpHideClass+'"></div>\n      <div class="txp_error_code" data-role="'+dataRoleMap$1.errorCode+'"></div>\n    </div>';t.insertAdjacentHTML("beforeend",r),this.rootEl=t.querySelector('[data-role="'+dataRoleMap$1.error+'"]'),this.noiseBg=this.rootEl.querySelector("canvas"),Object.keys(dataRoleMap$1).forEach((function(o){e.innerElements[o]=t.querySelector('[data-role="'+dataRoleMap$1[o]+'"]')}))},t.prototype.setupDOMEvents=function(){var e=this;this.innerElements.errorRefresh.querySelector(".txp_link_refresh").addEventListener("click",(function(){e.config.useReplay?e.player.replay():location.reload()}));var o=0,r=0;this.innerElements.errorCode.addEventListener("click",(function(){(o+=1)>=5&&(o=0,e.emit(t.Events.REPORT_LOG)),r&&clearTimeout(r),r=window.setTimeout((function(){return o=0}),300)})),this.innerElements.clientBtn.addEventListener("click",(function(){e.clientExistDefer.promise.then((function(t){e.clickClientBtnOnExist(t)})).catch((function(){e.clickClientBtnOnNoExist()}))}))},t.prototype.setupPlayerEvents=function(){var e=this,t=this.player;t.on(exports.H5_PLAY_EVENT.PLAY_SESSION_END,(function(o){var r=o.data;if(e.config.showOnError){var n=r.code;if(n!==exports.ErrorCode.SUC){var i=e.config.img,a=e.config.hideRefresh,s=t.config.type===exports.PLAY_MODE.LIVE,l=checkIfClientNeeded(n,s);if(s&&r.data){if("setErrorView"!==r.data.name)return;var c=r.data.params,p=c.hideRefresh,d=c.hideCode;p?domTool.addClass(e.innerElements.errorRefresh,txpHideClass):domTool.removeClass(e.innerElements.errorRefresh,txpHideClass),a=p,d?domTool.addClass(e.innerElements.errorCode,txpHideClass):domTool.removeClass(e.innerElements.errorCode,txpHideClass)}l&&(e.config.useClientBtn&&(e.checkClientExist(),e.setClientBtn(),a=!0),e.config.useBrowserTip&&(e.setBrowserTip(),a=!0));var u=e.getErrMsg(r,s,l);e.show({code:n,text:u,hideRefresh:a,img:i})}}})),t.on(exports.PLAY_EVENT.STATE_CHANGE,(function(t){var o=t.data.new;o!==exports.VIDEO_STATE.PLAYING&&o!==exports.VIDEO_STATE.CANPLAY||e.hide()})),t.on(exports.H5_PLAY_EVENT.PLAY_SESSION_START,(function(){return e.hide()}))},t.prototype.getErrMsg=function(e,t,o){var r=o&&(this.config.useClientBtn||this.config.useBrowserTip);return(t?this.getLiveErrMsg(e,r):this.getVodErrMsg(e,r))||defaultErrorMsg$1},t.prototype.getLiveErrMsg=function(e,t){var o=e.message;if(!e.data)return o;var r=e.data.params.msg,n=e.code;return r&&(o=r),t&&(o=""+o+getGuidingMessage(n)),o},t.prototype.getVodErrMsg=function(e,t){var o=e.message,r=e.code;return r.startsWith(exports.ErrorCode.GETINFO_SERVER_CODE_PREFIX)||r.startsWith("7009")?(t&&(o=""+o+getGuidingMessage(r)),o):o},t.prototype.setClientBtn=function(){var e=this,t=uaTool.os.mac?"Mac客户端观看":"PC客户端观看";uaTool.os.mac?this.innerElements.clientBtn.innerHTML="打开"+t:this.clientExistDefer.promise.then((function(){e.innerElements.clientBtn.innerHTML="打开"+t})).catch((function(){e.innerElements.clientBtn.innerHTML="下载"+t})),domTool.removeClass(this.innerElements.clientBtn,txpHideClass)},t.prototype.setNoise=function(e){var t=this;void 0===e&&(e=!0);var o=this.config.noiseConfig,r=o.enable,n=o.performanceRatio,i=o.opacity;if(r&&this.noiseBg&&(clearInterval(this.noiseTimer),domTool.css(this.noiseBg,"display",e?"block":"none"),e)){var a=this.noiseBg.getContext("2d");this.resizeNoise();var s=this.noiseBg,l=s.width,c=s.height;if(!l||!c)return;this.noiseAnimation(a,l,c,i,n),this.noiseTimer=setInterval((function(){t.noiseAnimation(a,l,c,i,n)}),o.interval)}},t.prototype.resizeNoise=function(){if(this.noiseBg){var e=this.player.container,t=e.clientWidth,o=e.clientHeight,r=this.config.noiseConfig.size;this.noiseBg.width=t/r,this.noiseBg.height=o/r}},t.prototype.checkClientExist=function(){var e=this;try{getClient((function(t){t?t.exist().done((function(){e.clientExistDefer.resolve(t)})).fail((function(){e.clientExistDefer.reject()})):e.clientExistDefer.reject()}))}catch(e){this.clientExistDefer.reject()}},t.prototype.clickClientBtnOnExist=function(e){if(this.player.config.type===exports.PLAY_MODE.LIVE){var t="qqlive://sso/pid="+(this.player.getCommonKv(COMMON_DATA_KEY.livepid)||"")+"&projectid="+(this.player.vid||"");e.open(t)}else{var o=this.player.vid;openClient({support:!0,atag:"playererror",sso:"qqlive://sso/vbarid="+(this.player.getCommonKv(COMMON_DATA_KEY.cid)||"")+"&videoid="+o+"&start="+Math.max(this.player.playtime-5,0)+"&atag=web.playererror",success:function(){},error:function(){this.openDownLoadLink()}})}},t.prototype.clickClientBtnOnNoExist=function(){this.openDownLoadLink()},t.prototype.openDownLoadLink=function(){window.open("https://v.qq.com/download.html#"+(uaTool.os.mac?"Mac":"Windows"),"_blank")},t.prototype.setBrowserTip=function(){this.innerElements.browserTip.removeEventListener("click",this.browserTipClick),domTool.removeClass(this.innerElements.browserTip,txpHideClass),uaTool.os.mac?this.innerElements.browserTip.innerHTML="或下载最新 Chrome、Safari 浏览器观看":this.innerElements.browserTip.innerHTML="或下载最新 Chrome、Edge 浏览器观看"},t.Events=ErrorPagePluginEvents$1,t.pluginName=ErrorPagePluginName$1,t}(Plugin);H5Player.registerPlugin(ErrorPagePlugin.pluginName,ErrorPagePlugin);var FUNC_ERROR_TEXT="Expected a function",NAN=NaN,symbolTag="[object Symbol]",reTrim=/^\s+|\s+$/g,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt,freeGlobal="object"==typeof commonjsGlobal&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal,freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")(),objectProto=Object.prototype,objectToString=objectProto.toString,nativeMax=Math.max,nativeMin=Math.min,now=function(){return root.Date.now()};function debounce(e,t,o){var r,n,i,a,s,l,c=0,p=!1,d=!1,u=!0;if("function"!=typeof e)throw new TypeError(FUNC_ERROR_TEXT);function A(t){var o=r,i=n;return r=n=void 0,c=t,a=e.apply(i,o)}function _(e){return c=e,s=setTimeout(g,t),p?A(e):a}function E(e){var o=e-l;return void 0===l||o>=t||o<0||d&&e-c>=i}function g(){var e=now();if(E(e))return f(e);s=setTimeout(g,function(e){var o=t-(e-l);return d?nativeMin(o,i-(e-c)):o}(e))}function f(e){return s=void 0,u&&r?A(e):(r=n=void 0,a)}function h(){var e=now(),o=E(e);if(r=arguments,n=this,l=e,o){if(void 0===s)return _(l);if(d)return s=setTimeout(g,t),A(l)}return void 0===s&&(s=setTimeout(g,t)),a}return t=toNumber(t)||0,isObject(o)&&(p=!!o.leading,i=(d="maxWait"in o)?nativeMax(toNumber(o.maxWait)||0,t):i,u="trailing"in o?!!o.trailing:u),h.cancel=function(){void 0!==s&&clearTimeout(s),c=0,r=l=n=s=void 0},h.flush=function(){return void 0===s?a:f(now())},h}function throttle(e,t,o){var r=!0,n=!0;if("function"!=typeof e)throw new TypeError(FUNC_ERROR_TEXT);return isObject(o)&&(r="leading"in o?!!o.leading:r,n="trailing"in o?!!o.trailing:n),debounce(e,t,{leading:r,maxWait:t,trailing:n})}function isObject(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function isObjectLike(e){return!!e&&"object"==typeof e}function isSymbol(e){return"symbol"==typeof e||isObjectLike(e)&&objectToString.call(e)==symbolTag}function toNumber(e){if("number"==typeof e)return e;if(isSymbol(e))return NAN;if(isObject(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=isObject(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(reTrim,"");var o=reIsBinary.test(e);return o||reIsOctal.test(e)?freeParseInt(e.slice(2),o?2:8):reIsBadHex.test(e)?NAN:+e}var lodash_throttle=throttle,css_248z$1$1='.plugin_ctrl_txp_shadow{position:absolute;z-index:2;left:0;top:0;width:100%;height:100%}.plugin_ctrl_txp_shadow.txp_none{display:none}.plugin_ctrl_airplay_btn svg{-webkit-transform:scale(.9);transform:scale(.9)}.plugin_ctrl_center_btn{position:absolute;left:0;top:0;width:100%;height:100%;z-index:5;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;pointer-events:none}.plugin_ctrl_center_btn.txp_none{display:none}.plugin_ctrl_center_btn .txp_none{display:none!important}.plugin_ctrl_center_btn .btn_play{width:68px;height:68px;pointer-events:auto;cursor:pointer}.plugin_ctrl_center_btn .btn_play .icon_play{width:100%;height:100%}.plugin_ctrl_center_btn .btn_replay{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding:0 22px;line-height:40px;border-radius:99em;color:#fff;font-size:14px;background-color:rgba(59,59,59,.95);pointer-events:auto;cursor:pointer}.plugin_ctrl_center_btn .btn_replay .icon_replay{margin-right:4px;width:15px;height:15px;fill:#fff}.plugin_ctrl_txp_gradient_bottom{position:absolute;z-index:3;left:0;bottom:0;width:100%;height:120px;background-image:-webkit-gradient(linear,left bottom, left top,color-stop(0, rgba(0,0,0,.5)),to(transparent));background-image:linear-gradient(0deg,rgba(0,0,0,.5) 0,transparent);opacity:1;-webkit-transition:opacity .15s ease-out;transition:opacity .15s ease-out;pointer-events:none}.plugin_ctrl_txp_gradient_bottom.txp_none{display:none}.plugin_ctrl_fake_fullscreen{overflow:hidden}._mod_thumbplayer_container_:-webkit-full-screen{width:100%!important;height:100%!important}._mod_thumbplayer_container_.thumbplayer-fullscreen{width:100%!important;height:100%!important}@-webkit-keyframes txp_icon_scale{0%{-webkit-transform:scale(1);transform:scale(1);-webkit-transform-origin:center center;transform-origin:center center}50%{-webkit-transform:scale(1.2);transform:scale(1.2);-webkit-transform-origin:center center;transform-origin:center center}to{-webkit-transform:scale(1);transform:scale(1);-webkit-transform-origin:center center;transform-origin:center center}}@keyframes txp_icon_scale{0%{-webkit-transform:scale(1);transform:scale(1);-webkit-transform-origin:center center;transform-origin:center center}50%{-webkit-transform:scale(1.2);transform:scale(1.2);-webkit-transform-origin:center center;transform-origin:center center}to{-webkit-transform:scale(1);transform:scale(1);-webkit-transform-origin:center center;transform-origin:center center}}.plugin_ctrl_txp_bottom{position:absolute;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:6;bottom:0;left:0;width:100%;height:48px;line-height:1;max-width:100%;max-height:100%;overflow:initial;text-indent:0;text-align:left;white-space:normal;word-break:break-all;color:#fff;font-size:14px;font-family:PingFangSC-Regular,Helvetica Neue,Helvetica,Roboto,Microsoft Yahei,Arial,sans-serif;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-font-smoothing:antialiased;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-touch-callout:none}.plugin_ctrl_txp_bottom.txp_none{display:none}.plugin_ctrl_txp_bottom .txp_btn{position:relative;cursor:pointer;background:none;border:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;font-family:inherit}.plugin_ctrl_txp_bottom .txp_btn:hover .txp_icon{fill:#ff6022;cursor:pointer}.plugin_ctrl_txp_bottom .txp_icon_airplay .txp_icon_pip,.plugin_ctrl_txp_bottom .txp_icon_fake,.plugin_ctrl_txp_bottom .txp_icon_fullscreen,.plugin_ctrl_txp_bottom .txp_icon_volume,.plugin_ctrl_txp_bottom .txp_icon_volume_mute{stroke:#fff}.plugin_ctrl_txp_bottom .txp_btn:hover .txp_icon_airplay,.plugin_ctrl_txp_bottom .txp_btn:hover .txp_icon_fake,.plugin_ctrl_txp_bottom .txp_btn:hover .txp_icon_fullscreen,.plugin_ctrl_txp_bottom .txp_btn:hover .txp_icon_pip,.plugin_ctrl_txp_bottom .txp_btn:hover .txp_icon_volume,.plugin_ctrl_txp_bottom .txp_btn_fake[data-status=true] .txp_icon_fake{stroke:#ff6022}.plugin_ctrl_txp_bottom .txp_btn_pip[data-status=true] .txp_icon_pip{stroke:#ff6022;fill:#ff6022}.plugin_ctrl_txp_bottom .txp_controls{display:-webkit-box;display:-ms-flexbox;display:flex;position:absolute;bottom:0;left:0;width:100%;height:100%}.plugin_ctrl_txp_bottom *,.plugin_ctrl_txp_bottom :after,.plugin_ctrl_txp_bottom :before{margin:0;padding:0;-webkit-box-sizing:border-box;box-sizing:border-box;text-indent:0}.plugin_ctrl_txp_bottom a,.plugin_ctrl_txp_bottom a:hover,.plugin_ctrl_txp_bottom a:visited{color:#fff;text-decoration:none!important}.plugin_ctrl_txp_bottom :focus,.plugin_ctrl_txp_bottom a:active{outline:0 none}.plugin_ctrl_txp_bottom .txp_left_controls,.plugin_ctrl_txp_bottom .txp_right_controls{position:relative;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.plugin_ctrl_txp_bottom .txp_controls .txp_btn{height:100%;text-align:center;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.plugin_ctrl_txp_bottom .txp_left_controls .txp_btn{margin-right:16px;text-align:center;-webkit-box-flex:0;-ms-flex:none;flex:none}.plugin_ctrl_txp_bottom .txp_left_controls .txp_btn:first-child{margin-left:16px}.plugin_ctrl_txp_bottom .txp_center_controls{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}.plugin_ctrl_txp_bottom .txp_right_controls{z-index:8}.plugin_ctrl_txp_bottom .txp_right_controls .txp_btn{margin-right:16px}.plugin_ctrl_txp_bottom .txp_right_controls .txp_btn_definition,.plugin_ctrl_txp_bottom .txp_right_controls .txp_btn_language,.plugin_ctrl_txp_bottom .txp_right_controls .txp_btn_playrate{margin-right:24px}.plugin_ctrl_txp_bottom .txp_left_controls .txp_icon{display:block;margin:auto}.plugin_ctrl_txp_bottom .txp_left_controls .txp_icon_next{pointer-events:none}.plugin_ctrl_txp_bottom .txp_right_controls .txp_icon{display:block}.plugin_ctrl_txp_bottom .txp_controls .txp_tooltip{position:absolute;z-index:14;height:26px;border-radius:16px;font-size:12px;line-height:18px;display:none;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;top:-30px;padding:4px 12px;white-space:nowrap;background-color:rgba(0,0,0,.8);left:50%;-webkit-transform:translate(-50%);transform:translate(-50%)}.plugin_ctrl_txp_bottom .txp_controls .txp_btn_fake .txp_tooltip{left:-15px;-webkit-transform:translate(0);transform:translate(0)}.plugin_ctrl_txp_bottom .txp_controls .txp_btn_play .txp_tooltip{left:-6px;-webkit-transform:translate(0);transform:translate(0)}.plugin_ctrl_txp_bottom .txp_controls .txp_btn_next .txp_tooltip{left:-11px;-webkit-transform:translate(0);transform:translate(0)}.plugin_ctrl_txp_bottom .txp_controls .txp_btn_fullscreen .txp_tooltip{left:auto;right:-10px;-webkit-transform:translate(0);transform:translate(0)}.plugin_ctrl_txp_bottom .txp_btn_setting:hover .txp_icon_setting{-webkit-animation:txp_icon_rotate .3s ease both;animation:txp_icon_rotate .3s ease both}.plugin_ctrl_txp_bottom .txp_air_play:hover .txp_icon,.plugin_ctrl_txp_bottom .txp_btn_fake:hover .txp_icon,.plugin_ctrl_txp_bottom .txp_btn_fullscreen:hover .txp_icon,.plugin_ctrl_txp_bottom .txp_btn_pip:hover .txp_icon{-webkit-animation:txp_icon_scale .4s ease both;animation:txp_icon_scale .4s ease both}.plugin_ctrl_txp_bottom .txp_time_display{height:100%;margin-left:8px;white-space:nowrap;font-size:0;-webkit-box-flex:0;-ms-flex:none;flex:none;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.plugin_ctrl_txp_bottom .txp_time_display.reach_hour{margin-left:-8px}.plugin_ctrl_txp_bottom .txp_time_display.reach_hour .txp_time_current,.plugin_ctrl_txp_bottom .txp_time_display.reach_hour .txp_time_duration{width:50px}.plugin_ctrl_txp_bottom .txp_time_display.reach_hour .txp_time_current{text-align:right}.plugin_ctrl_txp_bottom .txp_time_display.reach_hour .txp_time_duration{text-align:left}.plugin_ctrl_txp_bottom .txp_time_display>div{display:inline;font-size:12px}.plugin_ctrl_txp_bottom .txp_time_display .txp_time_separator{margin:0 3px;color:hsla(0,0%,100%,.5)}.plugin_ctrl_txp_bottom .txp_time_display .txp_time_current,.plugin_ctrl_txp_bottom .txp_time_display .txp_time_duration{width:32px;text-align:center}.plugin_ctrl_txp_bottom .txp_time_display .txp_time_duration{color:hsla(0,0%,100%,.5)}.plugin_ctrl_txp_bottom .txp_time_display .txp_live_badge{position:relative;font-size:12px;display:inline;margin-top:-1px;line-height:40px;padding-left:10px;cursor:default}.plugin_ctrl_txp_bottom .txp_time_display .txp_live_badge:before{content:"";position:absolute;left:0;top:17px;display:inline-block;width:6px;height:6px;border-radius:100%;background-color:#ff7000}.plugin_ctrl_txp_bottom .txp_time_display .txp_live_badge_back:before{background-color:#bbb}.plugin_ctrl_txp_bottom .txp_time_display_live{margin-left:0}.plugin_ctrl_txp_bottom .txp_progress_bar_container{position:absolute;z-index:4;left:0;top:-8px;width:100%;height:8px;padding:0;vertical-align:top;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer}.plugin_ctrl_txp_bottom .txp_progress_bar_container:after{content:"";display:block;width:100%;height:12px;position:absolute;bottom:-2px;z-index:-1}.plugin_ctrl_txp_bottom .txp_progress_bar_container:hover{z-index:9;cursor:pointer}.plugin_ctrl_txp_bottom .txp_progress_list{position:absolute;left:0;top:0;height:8px;width:100%}.plugin_ctrl_txp_bottom .txp_progress_list:after{content:"";position:absolute;left:0;top:0;width:100%;height:100%;background-color:hsla(0,0%,100%,.35);-webkit-transform:scaleY(.5);transform:scaleY(.5);-webkit-transition:all .15s ease;transition:all .15s ease;z-index:-1}.plugin_ctrl_txp_bottom .txp_progress_load,.plugin_ctrl_txp_bottom .txp_progress_play{position:absolute;left:0;top:0;height:100%;width:2px;background-color:#ff6429;-webkit-transform:scaleY(.5);transform:scaleY(.5);-webkit-transition:all .15s ease;transition:all .15s ease}.plugin_ctrl_txp_bottom .txp_progress_bar_container:hover .txp_progress_list:after,.plugin_ctrl_txp_bottom .txp_progress_bar_container:hover .txp_progress_load,.plugin_ctrl_txp_bottom .txp_progress_bar_container:hover .txp_progress_play,.plugin_ctrl_txp_bottom .txp_progress_bar_container:hover .txp_progress_role{-webkit-transform:scaleY(1);transform:scaleY(1)}.plugin_ctrl_txp_bottom .txp_progress_load{background-color:hsla(0,0%,100%,.5)}.plugin_ctrl_txp_bottom .txp_progress_role{position:absolute;left:0;top:0;height:100%;width:2px;background-color:rgba(178,250,77,.5);-webkit-transform:scaleY(.5);transform:scaleY(.5);-webkit-transition:all .15s ease;transition:all .15s ease}.plugin_ctrl_txp_bottom .txp_btn_scrubber{position:absolute;width:12px;height:12px;top:-2px;margin-left:-6px;cursor:pointer;-webkit-transform:scale(0);transform:scale(0);-webkit-transition:all .15s ease;transition:all .15s ease}.plugin_ctrl_txp_bottom .txp_scrubber_indicator{position:relative;width:12px;height:12px;border-radius:100%;background-color:#ff6429}.plugin_ctrl_txp_bottom .txp_scrubber_indicator:before{content:"";position:absolute;left:-4px;top:-4px;width:20px;height:20px;border-radius:100%;display:block;background-color:rgba(254,100,41,.3)}.plugin_ctrl_txp_bottom .txp_progress_bar_container:hover .txp_btn_scrubber{-webkit-transform:scale(1);transform:scale(1)}.plugin_ctrl_txp_bottom .txp_btn_scrubber:hover .txp_scrubber_indicator:before{width:24px;height:24px;left:-6px;top:-6px}.plugin_ctrl_txp_bottom .txp_btn_play .txp_svg_symbol{visibility:hidden;opacity:0}.plugin_ctrl_txp_bottom .txp_btn_play[data-status=pause] .txp_svg_pause,.plugin_ctrl_txp_bottom .txp_btn_play[data-status=play] .txp_svg_play,.plugin_ctrl_txp_bottom .txp_btn_play[data-status=replay] .txp_svg_replay,.plugin_ctrl_txp_bottom .txp_btn_play[data-status=stop] .txp_svg_stop{visibility:visible;opacity:1;-webkit-animation:none;animation:none}.plugin_ctrl_txp_bottom .txp_popup{position:absolute;bottom:34px;z-index:20;width:100%;padding-bottom:24px;color:#eee;cursor:default}.plugin_ctrl_txp_bottom .txp_popup_content{background-color:rgba(0,0,0,.8);border-radius:4px}.plugin_ctrl_txp_bottom .txp_popup_audio_track,.plugin_ctrl_txp_bottom .txp_popup_definition,.plugin_ctrl_txp_bottom .txp_popup_language,.plugin_ctrl_txp_bottom .txp_popup_playrate{width:auto;left:50%;-webkit-transform:translate(-50%);transform:translate(-50%);font-size:0}.plugin_ctrl_txp_bottom .txp_popup_audio_track .txp_popup_content,.plugin_ctrl_txp_bottom .txp_popup_definition .txp_popup_content,.plugin_ctrl_txp_bottom .txp_popup_language .txp_popup_content,.plugin_ctrl_txp_bottom .txp_popup_playrate .txp_popup_content{padding-top:10px}.plugin_ctrl_txp_bottom .txp_popup_audio_track .txp_menuitem,.plugin_ctrl_txp_bottom .txp_popup_definition .txp_menuitem,.plugin_ctrl_txp_bottom .txp_popup_language .txp_menuitem,.plugin_ctrl_txp_bottom .txp_popup_playrate .txp_menuitem{min-width:104px;position:relative;padding:10px 22px;font-size:14px;text-align:center;cursor:pointer;white-space:nowrap;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.plugin_ctrl_txp_bottom .txp_popup_audio_track .txp_menuitem:last-of-type,.plugin_ctrl_txp_bottom .txp_popup_definition .txp_menuitem:last-of-type,.plugin_ctrl_txp_bottom .txp_popup_language .txp_menuitem:last-of-type,.plugin_ctrl_txp_bottom .txp_popup_playrate .txp_menuitem:last-of-type{padding-bottom:20px}.plugin_ctrl_txp_bottom .txp_popup_audio_track .txp_menuitem:active,.plugin_ctrl_txp_bottom .txp_popup_audio_track .txp_menuitem:hover,.plugin_ctrl_txp_bottom .txp_popup_definition .txp_menuitem:active,.plugin_ctrl_txp_bottom .txp_popup_definition .txp_menuitem:hover,.plugin_ctrl_txp_bottom .txp_popup_language .txp_menuitem:active,.plugin_ctrl_txp_bottom .txp_popup_language .txp_menuitem:hover,.plugin_ctrl_txp_bottom .txp_popup_playrate .txp_menuitem:active,.plugin_ctrl_txp_bottom .txp_popup_playrate .txp_menuitem:hover{color:#ff6429}.plugin_ctrl_txp_bottom .txp_btn .txp_label{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:relative;padding:1px 4px;cursor:pointer;color:#ececec;white-space:nowrap;border:2px solid #fff;border-radius:4px;font-weight:700}.plugin_ctrl_txp_bottom .txp_btn .txp_label:hover{color:#ff6022;border-color:#ff6022}.plugin_ctrl_txp_bottom .txp_btn_definition{position:relative;height:100%;white-space:nowrap;text-align:center;-webkit-box-flex:0;-ms-flex:none;flex:none}.plugin_ctrl_txp_bottom .txp_volume{position:relative;display:table-cell;width:44px;height:45px;vertical-align:top;color:#fff}.plugin_ctrl_txp_bottom .txp_volume_text{padding-top:8px}.plugin_ctrl_txp_bottom .txp_btn_volume .txp_svg_symbol{display:none}.plugin_ctrl_txp_bottom .txp_btn_volume[data-status=mute] .txp_svg_volume_mute,.plugin_ctrl_txp_bottom .txp_btn_volume[data-status=normal] .txp_svg_volume{display:block}.plugin_ctrl_txp_bottom .txp_popup_volume{width:42px;-webkit-transform:translate(-50%);transform:translate(-50%);left:50%}.plugin_ctrl_txp_bottom .txp_popup_volume .txp_popup_content{overflow:hidden}.plugin_ctrl_txp_bottom .txp_volume_range{position:relative;margin:10px 19px;width:4px;height:90px;background-color:hsla(0,0%,65.1%,.5);border-radius:2px;cursor:pointer}.plugin_ctrl_txp_bottom .txp_volume_range:after{content:"";display:block;width:42px;height:90px;position:absolute;left:-19px;top:0}.plugin_ctrl_txp_bottom .txp_volume_range_current{position:absolute;left:0;bottom:0;width:100%;height:50%;background-color:#ff6429;border-radius:2px;z-index:1}.plugin_ctrl_txp_bottom .txp_volume_handle{position:absolute;top:-4px;left:-2px;width:8px;height:8px;background-color:#fff;border-radius:100%;cursor:pointer}.plugin_ctrl_txp_bottom .txp_volume_handle:before{content:"";display:block;position:absolute;left:-3px;top:-3px;width:14px;height:14px;opacity:0;-webkit-transform:scale(0);transform:scale(0);background-color:hsla(0,0%,100%,.2);border-radius:7px}.plugin_ctrl_txp_bottom .txp_volume_handle:after{content:"";width:32px;height:32px;display:block;position:absolute;left:-12px;top:-12px;z-index:-1;opacity:.5;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAMAAAC7IEhfAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAADAUExURQAAAP+ZAP+RAP9/AP+aAP9/AP+OCP//AP9/AP+qAP+QDf+SDP+TDv+TCv+RCP+ZAP+TC/+TCP+QC/+RCv+SCf+SCv+QCv+RCv+TCf+PD/+PCP+RDP+RCf+RCv+PCf+RB/+RCv+RCf6RCv+ZEf+RC/+RCf+RC/+RC/6RCv+OB/+QC/+RC/+RCv+TC/+QC/+SC/+RC/+RCv+RCv+RCv+RC/6RCv6RCv6RCv6SCv6SCv2QC/+RCv+SCv+RC/+RCv2RCn+uAUwAAABAdFJOUwAFBwYIBAsBAgMNExEYOAoWHit4JUtXYhoQHCg1MT4gRmmHD1SlsbaUIi5BIy1DUltIb2VygY+Jm6KYrHyYuqzDURAFAAAB/klEQVQ4y6WVWZeiMBSEhQZmDAgJO7LIIrivuNv2/P9/NTdRp7VlTmfO1BMP36kKl5ui1XrQD9DPm+hzq1lXqn3TlW3mKCXLApMsU7aBpHaUehMlJvGNsq+mzE6mlKEwGZSVX0yZnSBKBkJFoIGCAiFDEgVm+oUDO4Q0FeMOCGNVQ+hq+kAyDuwCFfuE9ECE+FgNwJSRz5yCNMCmdmiCQnsKqIaURxKCKVeone4onMWRDoriWTgiHbWg5D0cDAXRQGqH2GasJ/N0tUrniR6bNpDIEIW7JQtGGnDjKEmdhQtaOGkSjYHU0Gc4GEoowF17rE+c/tKrs6z2ln1noo/tLg6QdLdsyzTYH5nRxHG9bGOBNpnnOpPIHPk0XG5fQUFSNEzCOHHcem1t8/0+31rr2nWSOCRYU6glBekJVX8609O+t37Pd8PTabjL39deP9VnU7CkL85A0SjghGC4zKx8eDiW5fEwzK1sCZZwygKyGSiISgDJ0Xzhbba7Q/mrqs7lYbfdeIt5BNmBAhNiIByx0zMhuQbD47kaDKrzESxryDZ7dELP4MrNrP2prAYfH4OqvOytzF39H/h9NO/LcI/nZeCXS/PAuT8h91Lc1ow0rRl5XDPuxeW+CtyXi/u68hfAn0pRnitFeakU7pJ6rj0E+lvt8RcpfzX/Q9l/8/v4DS6tX+XyhPN2AAAAAElFTkSuQmCC);background-size:32px 32px;pointer-events:none}.plugin_ctrl_txp_bottom .txp_volume_handle:hover:before{opacity:1;-webkit-transform:scale(1);transform:scale(1)}.plugin_ctrl_txp_bottom .txp_volume_handle:hover:after{opacity:1}.plugin_ctrl_txp_bottom .txp_right_controls .txp_btn_popup{width:24px}.plugin_ctrl_txp_bottom .txp_right_controls .txp_icon_popup{width:20px;height:20px;margin-top:0}.plugin_ctrl_txp_bottom .txp_btn_fake .txp_svg_symbol,.plugin_ctrl_txp_bottom .txp_btn_fullscreen .txp_svg_symbol{display:none}.plugin_ctrl_txp_bottom .txp_btn_fake[data-status=false] .txp_svg_fake,.plugin_ctrl_txp_bottom .txp_btn_fake[data-status=true] .txp_svg_fake_true,.plugin_ctrl_txp_bottom .txp_btn_fullscreen[data-status=false] .txp_svg_fullscreen,.plugin_ctrl_txp_bottom .txp_btn_fullscreen[data-status=true] .txp_svg_fullscreen_true{display:block}.plugin_ctrl_txp_bottom .txp_popup .txp_current{color:#ff6429}.plugin_ctrl_txp_bottom .txp_btn_loop .txp_svg_loop,.plugin_ctrl_txp_bottom .txp_btn_loop .txp_svg_loop_off{display:none}.plugin_ctrl_txp_bottom .txp_btn_loop[data-status=false] .txp_svg_loop_off,.plugin_ctrl_txp_bottom .txp_btn_loop[data-status=true] .txp_svg_loop,.plugin_ctrl_txp_bottom .txp_controls .txp_btn:hover .txp_tooltip{display:block}.plugin_ctrl_txp_bottom .txp_controls .txp_btn:visited .txp_tooltip{display:none}.plugin_ctrl_txp_bottom .txp_popup:hover{display:block}.plugin_ctrl_txp_bottom .txp_icon{position:relative;width:28px;height:28px;fill:#fff}.plugin_ctrl_txp_bottom .txp_icon:after,.plugin_ctrl_txp_bottom .txp_icon:before,.plugin_ctrl_txp_bottom .txp_icon_inner:after,.plugin_ctrl_txp_bottom .txp_icon_inner:before{content:"";position:absolute;-webkit-box-sizing:content-box;box-sizing:content-box}.plugin_ctrl_txp_bottom .txp_icon_inner{position:absolute;width:100%;height:100%}.plugin_ctrl_txp_bottom .txp_controls .txp_disabled{cursor:default;opacity:.5;pointer-events:none}.plugin_ctrl_txp_bottom .txp_gradient_top{display:none}.plugin_ctrl_txp_bottom .txp_btn_scrubber,.plugin_ctrl_txp_bottom .txp_progress_load,.plugin_ctrl_txp_bottom .txp_progress_play{-webkit-transition:-webkit-transform .15s ease;transition:-webkit-transform .15s ease;transition:transform .15s ease;transition:transform .15s ease, -webkit-transform .15s ease}.plugin_ctrl_txp_bottom .txp_none{display:none!important}.plugin_ctrl_txp_mode_fullscreen .txp_controls .txp_btn_fullscreen .txp_tooltip{left:auto;right:0;-webkit-transform:translate(0);transform:translate(0)}.plugin_ctrl_txp_mode_fullscreen .txp_controls .txp_btn_fake .txp_tooltip{left:-26px;-webkit-transform:translate(0);transform:translate(0)}.plugin_ctrl--large .plugin_ctrl_txp_gradient_bottom{height:100px}.plugin_ctrl--large .plugin_ctrl_txp_bottom{height:88px}.plugin_ctrl--large .plugin_ctrl_txp_bottom .txp_popup{bottom:64px}.plugin_ctrl--large .plugin_ctrl_txp_bottom .txp_left_controls .txp_btn,.plugin_ctrl--large .plugin_ctrl_txp_bottom .txp_right_controls .txp_btn{margin-right:24px}.plugin_ctrl--large .plugin_ctrl_txp_bottom .txp_left_controls .txp_btn .txp_label,.plugin_ctrl--large .plugin_ctrl_txp_bottom .txp_right_controls .txp_btn .txp_label{height:26px;font-size:16px}.plugin_ctrl--large .plugin_ctrl_txp_bottom .txp_left_controls .txp_icon,.plugin_ctrl--large .plugin_ctrl_txp_bottom .txp_right_controls .txp_icon{width:40px;height:40px}.plugin_ctrl--large .plugin_ctrl_txp_bottom .txp_left_controls .txp_time_display{margin-left:0}.plugin_ctrl--large .plugin_ctrl_txp_bottom .txp_left_controls .txp_btn:first-child{margin-left:32px}.plugin_ctrl--large .plugin_ctrl_txp_bottom .txp_right_controls .txp_btn_definition,.plugin_ctrl--large .plugin_ctrl_txp_bottom .txp_right_controls .txp_btn_language,.plugin_ctrl--large .plugin_ctrl_txp_bottom .txp_right_controls .txp_btn_playrate{margin-right:32px}.txp_interact_dot{position:absolute;top:2px;width:4px;height:4px;margin-left:-2px;border-radius:100%;background-color:#fff;-webkit-transition:all .1s;transition:all .1s}.txp_interact_dot:after{position:absolute;top:-4px;right:-4px;bottom:-4px;left:-4px;content:""}.txp_interact_dot:hover{-webkit-transform:scale(2);transform:scale(2);-webkit-box-shadow:0 0 2px #ffb821;box-shadow:0 0 2px #ffb821}.txp_hotpoint_tip{color:#fff;position:relative;width:200px;bottom:60px;font-size:12px;line-height:24px;height:50px;padding:0 6px;background-color:rgba(0,0,0,.9);display:-webkit-box;overflow:hidden;text-overflow:ellipsis;-webkit-box-orient:vertical;-webkit-line-clamp:2;word-wrap:break-word}.txp_hotpoint_tip .txp_hotpoint_tip_title{color:#bbb}.txp_hotpoint_tip .txp_hotpoint_tip_detail{max-width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}',css_248z$5='.plugin_ctrl_txp_shadow{position:absolute;z-index:2;left:0;top:0;width:100%;height:100%}.plugin_ctrl_txp_shadow.txp_none{display:none}.plugin_ctrl_airplay_btn svg{-webkit-transform:scale(.9);transform:scale(.9)}.plugin_ctrl_center_btn{position:absolute;left:0;top:0;width:100%;height:100%;z-index:5;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;pointer-events:none}.plugin_ctrl_center_btn.txp_none{display:none}.plugin_ctrl_center_btn .txp_none{display:none!important}.plugin_ctrl_center_btn .btn_play{width:68px;height:68px;pointer-events:auto;cursor:pointer}.plugin_ctrl_center_btn .btn_play .icon_play{width:100%;height:100%}.plugin_ctrl_center_btn .btn_replay{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding:0 22px;line-height:40px;border-radius:99em;color:#fff;font-size:14px;background-color:rgba(59,59,59,.95);pointer-events:auto;cursor:pointer}.plugin_ctrl_center_btn .btn_replay .icon_replay{margin-right:4px;width:15px;height:15px;fill:#fff}.plugin_ctrl_txp_gradient_bottom{position:absolute;z-index:3;left:0;bottom:0;width:100%;height:120px;background-image:-webkit-gradient(linear,left bottom, left top,color-stop(0, rgba(0,0,0,.5)),to(transparent));background-image:linear-gradient(0deg,rgba(0,0,0,.5) 0,transparent);opacity:1;-webkit-transition:opacity .15s ease-out;transition:opacity .15s ease-out;pointer-events:none}.plugin_ctrl_txp_gradient_bottom.txp_none{display:none}.plugin_ctrl_fake_fullscreen{overflow:hidden}._mod_thumbplayer_container_:-webkit-full-screen{width:100%!important;height:100%!important}._mod_thumbplayer_container_.thumbplayer-fullscreen{width:100%!important;height:100%!important}.plugin_ctrl_mobile_txp_bottom{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;position:absolute;z-index:6;bottom:0;left:0;width:100%;height:40px;overflow:initial;line-height:1;max-width:100%;max-height:100%;color:#fff;font-size:14px;font-family:PingFangSC-Regular,Helvetica Neue,Helvetica,Roboto,sans-serif;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-font-smoothing:antialiased;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-touch-callout:none}.plugin_ctrl_mobile_txp_bottom.txp_none{display:none}.plugin_ctrl_mobile_txp_bottom .txp_disabled{opacity:.5;pointer-events:none}.plugin_ctrl_mobile_txp_bottom *,.plugin_ctrl_mobile_txp_bottom :after,.plugin_ctrl_mobile_txp_bottom :before{margin:0;padding:0;-webkit-box-sizing:border-box;box-sizing:border-box}.plugin_ctrl_mobile_txp_bottom a,.plugin_ctrl_mobile_txp_bottom a:hover,.plugin_ctrl_mobile_txp_bottom a:visited{color:#fff;text-decoration:none!important;pointer-events:auto}.plugin_ctrl_mobile_txp_bottom .txp_btn:active,.plugin_ctrl_mobile_txp_bottom .txp_btn:focus,.plugin_ctrl_mobile_txp_bottom a:focus{outline:0 none}.plugin_ctrl_mobile_txp_bottom .txp_icon{position:relative;display:inline-block;fill:#fff}.plugin_ctrl_mobile_txp_bottom .txp_icon:after,.plugin_ctrl_mobile_txp_bottom .txp_icon:before,.plugin_ctrl_mobile_txp_bottom .txp_icon_inner:after,.plugin_ctrl_mobile_txp_bottom .txp_icon_inner:before{content:"";position:absolute;-webkit-box-sizing:content-box;box-sizing:content-box}.plugin_ctrl_mobile_txp_bottom .txp_icon_inner{position:absolute;width:100%;height:100%}.plugin_ctrl_mobile_txp_bottom .txp_left_controls,.plugin_ctrl_mobile_txp_bottom .txp_right_controls{position:relative;float:left;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.plugin_ctrl_mobile_txp_bottom .txp_left_controls{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start}.plugin_ctrl_mobile_txp_bottom .txp_right_controls{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}.plugin_ctrl_mobile_txp_bottom .txp_btn{position:relative;cursor:pointer;background:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;font-family:PingFangSC-Regular,Helvetica Neue,Helvetica,Roboto,Microsoft Yahei,Arial,sans-serif;border:none;text-align:center;-webkit-box-flex:0;-ms-flex:none;flex:none;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.plugin_ctrl_mobile_txp_bottom .txp_btn_play{width:60px;height:100%}.plugin_ctrl_mobile_txp_bottom .txp_btn_play .txp_icon_play{display:block;width:30px;height:30px;margin:auto;fill:#fff}.plugin_ctrl_mobile_txp_bottom .txp_btn_play use{display:none}.plugin_ctrl_mobile_txp_bottom .txp_btn_play.play_btn_pause .txp_svg_pause,.plugin_ctrl_mobile_txp_bottom .txp_btn_play.play_btn_play .txp_svg_play,.plugin_ctrl_mobile_txp_bottom .txp_btn_play.play_btn_replay .txp_svg_replay,.plugin_ctrl_mobile_txp_bottom .txp_btn_play.play_btn_stop .txp_svg_stop{display:block}.plugin_ctrl_mobile_txp_bottom .txp_time_display{height:100%;padding:4px 8px 0 0;white-space:nowrap;font-size:0;-webkit-box-flex:0;-ms-flex:none;flex:none;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.plugin_ctrl_mobile_txp_bottom .txp_time_display>div{display:inline;font-size:9px}.plugin_ctrl_mobile_txp_bottom .txp_time_display .txp_time_separator{margin:0 1px}.plugin_ctrl_mobile_txp_bottom .txp_btn_fullscreen{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:45px;height:100%;-webkit-box-flex:0;-ms-flex:none;flex:none}.plugin_ctrl_mobile_txp_bottom .txp_icon_fullscreen{display:block;width:30px;height:30px;margin:auto}.plugin_ctrl_mobile_txp_bottom .txp_icon_fullscreen use{display:none}.plugin_ctrl_mobile_txp_bottom .txp_btn_fullscreen[data-status=false] .txp_svg_fullscreen,.plugin_ctrl_mobile_txp_bottom .txp_btn_fullscreen[data-status=true] .txp_svg_fullscreen_true{display:block}.plugin_ctrl_mobile_txp_bottom .txp_unfullscreen .txp_btn_value{background-position:right 0}.plugin_ctrl_mobile_txp_bottom .txp_btn_fullsize{width:45px;height:100%;-webkit-box-flex:0;-ms-flex:none;flex:none;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.plugin_ctrl_mobile_txp_bottom .txp_btn_fullsize[data-status=false] .txp_svg_fullscreen,.plugin_ctrl_mobile_txp_bottom .txp_btn_fullsize[data-status=true] .txp_svg_fullscreen_true{display:block}.plugin_ctrl_mobile_txp_bottom .txp_unfullsize .txp_btn_value{background-position:right 0}.plugin_ctrl_mobile_txp_bottom .txp_progress_bar_container{position:relative;height:100%;padding:0;vertical-align:top;-webkit-box-flex:1000;-ms-flex:1000;flex:1000}.plugin_ctrl_mobile_txp_bottom .txp_progress_list{position:absolute;left:0;top:20px;width:100%;height:2px;background-color:rgba(31,31,31,.9);-webkit-transform:translateZ(0);transform:translateZ(0)}.plugin_ctrl_mobile_txp_bottom .txp_progress_play{position:absolute;left:0;top:0;height:100%;width:2px;background-color:#fd9000}.plugin_ctrl_mobile_txp_bottom .txp_btn_scrubber{position:absolute;width:30px;height:40px;margin-left:-10px}.plugin_ctrl_mobile_txp_bottom .txp_scrubber_indicator{position:absolute;top:16px;left:10px;width:10px;height:10px;border-radius:99em;background-color:#ff7000}.plugin_ctrl_mobile_txp_bottom .txp_scrubber_indicator:before{content:"";position:absolute;left:-4px;top:-4px;width:18px;height:18px;background-color:#ff7000;opacity:.4;border-radius:99em}.plugin_ctrl_mobile_txp_bottom .txp_btn_definition,.plugin_ctrl_mobile_txp_bottom .txp_btn_playrate{position:relative;padding:0 8px;height:44px;color:#fff;white-space:nowrap;text-align:center;-webkit-box-flex:0;-ms-flex:none;flex:none;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.plugin_ctrl_mobile_txp_bottom .txp_btn_definition .txp_label,.plugin_ctrl_mobile_txp_bottom .txp_btn_playrate .txp_label{margin:auto}.plugin_ctrl_mobile_txp_bottom .txp_btn .txp_tooltip{display:none!important}.plugin_ctrl_mobile_txp_bottom .txp_right_controls{min-width:15px}.plugin_ctrl_mobile_txp_bottom .txp_none{display:none}.plugin_ctrl_mobile_txp_bottom~video::-webkit-media-controls,.plugin_ctrl_mobile_txp_bottom~video::-webkit-media-controls-start-playback-button{display:none!important}.plugin_ctrl_mod_overlay_wrapper{position:static}.plugin_ctrl_mod_overlay_wrapper ol,.plugin_ctrl_mod_overlay_wrapper ul{list-style:none}.plugin_ctrl_mod_overlay_wrapper li{vertical-align:top}.plugin_ctrl_mod_overlay_wrapper *{-webkit-box-sizing:border-box;box-sizing:border-box}.plugin_ctrl_mod_overlay_wrapper .mod_overlay{position:absolute;background:rgba(0,0,0,.75);left:0;top:0;right:0;bottom:0;z-index:998;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;color:#fff}.plugin_ctrl_mod_overlay_wrapper .mod_overlay.overlay_flex{display:-webkit-box;display:-ms-flexbox;display:flex}.plugin_ctrl_mod_overlay_wrapper .mod_overlay.txp_none{display:none}.plugin_ctrl_mod_overlay_wrapper .mod_speed_select{width:100%;text-align:center}.plugin_ctrl_mod_overlay_wrapper .mod_speed_select .title{font-size:16px}.plugin_ctrl_mod_overlay_wrapper .mod_speed_select ul{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row wrap;flex-flow:row wrap;font-size:18px;font-weight:700;padding:0 12px}.plugin_ctrl_mod_overlay_wrapper .mod_speed_select li{height:70px;margin-right:6px;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;padding:0 12px}.plugin_ctrl_mod_overlay_wrapper .mod_speed_select li div:last-child{margin-top:6px;font-size:14px;font-weight:500}.plugin_ctrl_mod_overlay_wrapper .mod_speed_select li.current{color:#ff6022}.plugin_ctrl_mod_overlay_wrapper .mod_speed_select li.current span{position:relative}.plugin_ctrl_mod_overlay_wrapper .mod_speed_select li.current span:after{content:"";width:100%;height:3px;background:#ff6022;position:absolute;bottom:-3px;left:0}.plugin_ctrl_mod_overlay_wrapper .txp_btn_playrate{position:relative;width:55px;height:44px;color:#fff;white-space:nowrap;text-align:center;-webkit-box-flex:0;-ms-flex:none;flex:none;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.plugin_ctrl_txp_mode_fullscreen .plugin_ctrl_mobile_txp_bottom{padding-bottom:env(safe-area-inset-bottom)}';function adaptMobileAdPlugin(e,t){uaTool.mobile&&(t.on(exports.H5_PLAY_EVENT.AD_PLAYING,(function(){return e.hide(!0)})),t.on(exports.H5_PLAY_EVENT.AD_END,(function(){return e.el.style.display=""})))}var Component=function(){function e(e,t,o){this.player=e,this.config=o,this.CLICK_EVENT_NAME="click",this.eventMap={};var r=e.container;this.el=r.querySelector(t),this.isMobile=null==o?void 0:o.isMobile,this.isLive="live"===this.config.mode,this.showEl()}return e.isEnabled=function(e){return!0},Object.defineProperty(e.prototype,"playtime",{get:function(){var e=this.config.timeOffset,t=this.player.playtime;return e?e(t,!1):t},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){var e;(null===(e=this.el)||void 0===e?void 0:e.parentNode)&&this.el.remove(),this.setEvts(!0),this.el=null,this.player=null},e.prototype.setEvts=function(e){var t=this;void 0===e&&(e=!1);var o=e?this.player.off:this.player.on;Object.keys(this.eventMap).forEach((function(e){o.call(t.player,e,t.eventMap[e])}))},e.prototype.showEl=function(t){void 0===t&&(t=this.el),t&&t.classList.remove(e.hideClassName)},e.prototype.hideEl=function(t){void 0===t&&(t=this.el),t&&t.classList.add(e.hideClassName)},e.sel="",e.disabledClassName="txp_disabled",e.curClassName="txp_current",e.hideClassName="txp_none",e}(),hideCSS="txp_none",disableCSS="txp_disabled",shouldDisableState=[exports.VIDEO_STATE.END,exports.VIDEO_STATE.IDLE,exports.VIDEO_STATE.LOAD_START],AirPlayBtn=function(e){function t(o,r,n){var i=e.call(this,o,t.sel,r)||this;i.config=r,i.ctrlbar=n,i.handlePlayerCanPlay=function(){i.hideDependOnKernel(),i.setBtnState(!0)},i.handleSetLevelEnd=function(){i.hideDependOnKernel()},i.handlePlayerSessionEnd=function(){i.setBtnState(!1)},i.handleClick=function(){var e,t;null===(t=null===(e=i.player.currentVideoElement)||void 0===e?void 0:e.webkitShowPlaybackTargetPicker)||void 0===t||t.call(e)};var a=!shouldDisableState.includes(i.player.state);return i.setupDOMEvents(),i.setupPlayerEvents(!0),i.show(),i.setBtnState(a),i}return __extends$1(t,e),t.isEnabled=function(e){var t=e.isMobile;return uaTool.browser.safari&&!t},t.prototype.show=function(){this.el.classList.remove(hideCSS)},t.prototype.hide=function(){this.el.classList.add(hideCSS)},t.prototype.setBtnState=function(e){if(e)return this.el.classList.remove(disableCSS);this.el.classList.add(disableCSS)},t.prototype.destroy=function(){var e;this.setupPlayerEvents(!1),null===(e=this.el)||void 0===e||e.remove()},t.prototype.setupPlayerEvents=function(e){void 0===e&&(e=!0);var t=e?this.player.on.bind(this.player):this.player.off.bind(this.player);t(exports.H5_PLAY_EVENT.VIDEO_CANPLAY,this.handlePlayerCanPlay),t(exports.H5_PLAY_EVENT.PLAY_SESSION_END,this.handlePlayerSessionEnd),t(exports.H5_PLAY_EVENT.VIDEO_SETLEVEL_END,this.handleSetLevelEnd)},t.prototype.setupDOMEvents=function(){this.el=this.player.container.querySelector(t.sel),this.el.addEventListener("click",this.handleClick)},t.prototype.hideDependOnKernel=function(){this.player.kernelName===exports.KERNEL_NAME.WASM?this.hide():this.show()},t.sel=".plugin_ctrl_airplay_btn",t.compName="AirPlayBtn",t}(Component),HOTPOINT_EVENTS$1;!function(e){e.HOT_MOUSE_OVER="ctrl:hotpoint-mouseover",e.HOT_MOUSE_MOVE="ctrl:hotpoint-mousemove",e.HOT_MOUSE_OUT="ctrl:hotpoint-mouseout"}(HOTPOINT_EVENTS$1||(HOTPOINT_EVENTS$1={}));var CtrlbarPluginName$2="ctrlbar",CTRL_EVENTS$2=__assign$2(__assign$2({FULLSCREEN_CHANGE:"windowFullscreenChange",FULLSCREEN_ERROR:"fullscreenError",FAKE_FULLSCREEN_CHANGE:"browserFullscreenChange",CLICK_PIPBTN:"ctrl:click-pipbtn",CLICK_NEXTBTN:"ctrl:click-nextbtn",CLICK_PLAYBTN:"ctrl:click-playbtn",CLICK_REPLAY:"ctrl:click-replay",SET_LANGUAGE:"ctrl:set-language",SET_LEVEL:"ctrl:set-level",SET_AUDIO:"ctrl:set-audio",SET_PLAYRATE:"ctrl:set-playrate",SET_VOLUME:"ctrl:set-volume",TOGGLE_OVERLAY:"ctrl:toggle-overlay",MOUSE_DONW:"ctrl:progress-mousedown",MOUSE_DOWN:"ctrl:progress-mousedown",MOUSE_MOVE:"ctrl:progress-mousemove",MOUSE_UP:"ctrl:progress-mouseup",SHOW:"ctrl:show",HIDE:"ctrl:hide"},HOTPOINT_EVENTS$1),{TEST_EVENT:"ctrl:inner-test-event",RESIZE:"ctrl:resize",SHOW_LEVELS:"ctrl:show-levels",HOVER_PROGRESS:"ctrl:hover-progress"}),pcRootClassName$1=".plugin_ctrl_txp_bottom",mobileRootClassName$1=".plugin_ctrl_mobile_txp_bottom",getRootClassName$1=function(e){return e?mobileRootClassName$1:pcRootClassName$1},shadowClassName$1=".plugin_ctrl_txp_shadow",gradientClassName$1=".plugin_ctrl_txp_gradient_bottom",containerClassName$1="_mod_thumbplayer_container_",largeSizeClassName$1="plugin_ctrl--large",bodyOverflowClassName$1="plugin_ctrl_fake_fullscreen",CTRL_SIZE$1,PlayBtnStatus$1;!function(e){e.LARGE="large",e.NORMAL="normal"}(CTRL_SIZE$1||(CTRL_SIZE$1={})),function(e){e.PAUSE="pause",e.PLAY="play",e.REPLAY="replay",e.STOP="stop"}(PlayBtnStatus$1||(PlayBtnStatus$1={}));var Popup=function(e){function t(t,o,r){var n=e.call(this,t,o.selector,o)||this;return n.ctrlbar=r,n.hideEl(),n.popup=n.isMobile?n.player.container.querySelector(o.modSelector):n.el.querySelector(".txp_popup"),n.el?(n.label=n.el.querySelector(".txp_label"),n.isMobile?n.label.addEventListener(n.CLICK_EVENT_NAME,(function(){!n.popup.classList.contains(Component.hideClassName)?n.hideEl(n.popup):(n.showEl(n.popup),n.popup.classList.add("overlay_flex")),n.ctrlbar.emit(CTRL_EVENTS$2.TOGGLE_OVERLAY,!0),n.hideEl(n.ctrlbar.el)})):(n.label.addEventListener("mouseover",(function(){return n.showEl(n.popup)})),n.el.addEventListener("mouseleave",(function(){n.hideEl(n.popup)}))),n.initItemClick(),n):n}return __extends$1(t,e),Object.defineProperty(t.prototype,"curClass",{get:function(){return this.isMobile?"current":Component.curClassName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selected",{get:function(){return this.selectedValue},set:function(e){var t,o=null===(t=this.popupOptions)||void 0===t?void 0:t.find((function(t){return String(t.value)===String(e)}));if(this.selectedValue=e,!o)return this.label.textContent="",void this.hideEl();this.showEl(),this.setCurrent(o)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"popupOptions",{get:function(){return this.allValue},set:function(e){var t=this,o=e.find((function(e){return String(e.value)===String(t.selectedValue)}));o?(this.setCurrent(o),this.showEl()):this.label.textContent="",this.allValue=e;var r=this.isMobile?"li":"div",n=/(<([^>]+)>)/;this.popup.querySelector(this.isMobile?".select_list":".txp_popup_content").innerHTML=e.map((function(e){return"<"+r+' \n      class="txp_menuitem '+(e.value===t.selected?t.curClass:"")+'" \n      data-label="'+(n.test(e.label)?"":e.label)+'"\n      data-value="'+e.value+'" \n      data-payload="'+(e.payload||"")+'">'+e.label+"</"+r+">"})).join("")},enumerable:!1,configurable:!0}),t.prototype.setCurrent=function(e){var t,o=this;this.label.innerHTML=null!==(t=null==e?void 0:e.btnLabel)&&void 0!==t?t:null==e?void 0:e.label,this.popup.querySelectorAll(".txp_menuitem").forEach((function(t){t.getAttribute("data-value")===String(e.value)?t.classList.add(o.curClass):t.classList.remove(o.curClass)}))},t.prototype.hookPlaySessionEnd=function(){this.el&&this.el.classList.add(Component.disabledClassName)},t.prototype.hookFlowNodeStart=function(e){"VideoFlowNode"===e.data.name&&this.el.classList.remove(Component.disabledClassName)},t.prototype.initItemClick=function(){var e=this;this.popup.addEventListener(this.CLICK_EVENT_NAME,(function(t){var o,r;e.player.setStateKv("ctrlbar:"+e.popupName+":"+e.CLICK_EVENT_NAME,{type:exports.LOG_TYPE.USER_ACTION});for(var n=t.target;n&&!(null===(o=n.classList)||void 0===o?void 0:o.contains("txp_menuitem"));)n=n.parentNode;e.isMobile&&(e.hideEl(e.popup),e.popup.classList.remove("overlay_flex"),e.ctrlbar.emit(CTRL_EVENTS$2.TOGGLE_OVERLAY,!1));var i=null==n?void 0:n.dataset;(null==i?void 0:i.value)&&i.value!==String(e.selected)&&(null===(r=e.onSelect)||void 0===r||r.call(e,i),e.config.hidePopupOnClick&&e.hideEl(e.popup))}))},t.compName="popup",t}(Component),AudioTrackPopup=function(e){function t(o,r,n){var i=e.call(this,o,__assign$2(__assign$2({},r),{selector:t.popupSelector}),n)||this;return i.popupName="audiotrack",i.onSelect=function(e){i.ctrlbar.emit(CTRL_EVENTS$2.SET_AUDIO,e)},i}return __extends$1(t,e),t.isEnabled=function(e){return!(e.isMobile||e.disableAudioTrack)},t.compName="AudioTrackPopup",t.popupSelector=".txp_right_controls .txp_btn_audio_track",t}(Popup);function onBtnClickPlay(e,t){t.isInRequest?e.triggerAutoplay().then((function(){return e.play()})):e.play()}var CenterBtn=function(e){function t(o,r,n){var i=e.call(this,o,t.sel,r)||this;return i.config=r,i.ctrlbar=n,i.prepareDOM(),i.initDOMEvents(),i.initPlayerEvents(),i}return __extends$1(t,e),t.isEnabled=function(e){var t=e.showCenterPlayBtn,o=e.showCenterReplayBtn;return t||o},t.prototype.initDOMEvents=function(){var e=this;this.playBtn.addEventListener("click",(function(){e.hideEl(e.playBtn),onBtnClickPlay(e.player,e.ctrlbar)})),this.replayBtn.addEventListener("click",(function(){e.hideEl(e.replayBtn),e.player.replay()}))},t.prototype.initPlayerEvents=function(){var e=this,t=this.player,o=function(){e.config.showCenterPlayBtn&&e.showEl(e.playBtn)};o(),t.on(exports.H5_PLAY_EVENT.AD_AUTOPLAY_BLOCKED,(function(e){e.data.adType===exports.AD_TYPE.PRE&&o()})),t.on(exports.H5_PLAY_EVENT.AD_PAUSE,(function(){e.showEl(e.playBtn)})),t.on(exports.H5_PLAY_EVENT.AD_RESUME,(function(){e.hideEl(e.playBtn)})),t.on(exports.H5_PLAY_EVENT.VIDEO_AUTOPLAY_BLOCKED,o),t.on(exports.H5_PLAY_EVENT.AD_PLAYING,(function(){return e.hideEl(e.playBtn)})),t.on(exports.H5_PLAY_EVENT.VIDEO_PLAYING,(function(t){t.data.isFirst&&e.hideEl(e.playBtn)})),t.on(exports.H5_PLAY_EVENT.PLAY_SESSION_END,(function(t){var o=t.data;e.hideEl(e.playBtn),e.config.showCenterReplayBtn&&o.endState===exports.END_STATE.NORMAL&&e.showEl(e.replayBtn)})),t.on(exports.H5_PLAY_EVENT.PLAY_SESSION_START,(function(){e.hideEl(e.replayBtn)}))},t.prototype.prepareDOM=function(){var e='<div class="'+t.sel.slice(1)+'">\n      <div class="btn_play '+Component.hideClassName+'">\n        <svg class="icon_play" viewBox="0 0 100 100">\n          <circle cx="50" cy="50" r="50" style="fill:#222;fill-opacity:0.75"></circle>\n          <path\n            transform="translate(36, 33)"\n            d="M0.6,2C0.6,2,0,3.5,0,16.9C0,30.3,0.6,32,0.6,32c0,1.5,1.6,2.5,2.9,1.8c0,0,3-0.5,15.2-6.6c12.2-6.1,14.2-8.4,14.2-8.4c1.5-0.7,1.5-2.8,0-3.6c0,0-3.3-3.1-14.2-8.6C7.9,1.1,3.5,0.2,3.5,0.2C2.1-0.5,0.6,0.5,0.6,2z"\n            style="fill:#fff;"\n          />\n        </svg>\n      </div>\n\n      <div class="btn_replay '+Component.hideClassName+'">\n        <svg class="icon_replay" viewBox="0 0 30 30">\n          <use xlink:href="#txp_svg_replay"></use>\n        </svg>\n        <div>重新播放</div>\n      </div>\n    </div>';this.ctrlbar.el.insertAdjacentHTML("beforebegin",e),this.el=this.player.container.querySelector(t.sel),this.playBtn=this.el.querySelector(".btn_play"),this.replayBtn=this.el.querySelector(".btn_replay")},t.sel=".plugin_ctrl_center_btn",t.compName="CenterBtn",t}(Component),DefinitionPopup=function(e){function t(o,r,n){var i=e.call(this,o,__assign$2(__assign$2({},r),{selector:t.popupSelector,modSelector:t.modSelector}),n)||this;return i.popupName="definition",i.onSelect=function(e){i.ctrlbar.emit(CTRL_EVENTS$2.SET_LEVEL,e)},i.onShowLevel=function(){i.ctrlbar.emit(CTRL_EVENTS$2.SHOW_LEVELS)},i.label.addEventListener("mouseover",i.onShowLevel),i}return __extends$1(t,e),t.isEnabled=function(){return!0},t.compName="DefinitionPopup",t.popupSelector=".txp_right_controls .txp_btn_definition",t.modSelector=".mod_overlay.definition",t}(Popup),FakeFullscreen=function(e){function t(o,r,n){var i=e.call(this,o,t.sel,r)||this;return i.ctrlbar=n,i.tip=i.el.querySelector(".txp_tooltip"),i.el.classList.remove(Component.hideClassName),i.setupDOMEvents(),i}return __extends$1(t,e),t.isEnabled=function(e){var t=e.disableFakeFullscreen,o=e.useH5FakeFullscreen,r=e.isMobile;return r&&void 0!==o?!!o:void 0!==t?!t:!(!uaTool.os.android&&r)},Object.defineProperty(t.prototype,"isFullScreen",{get:function(){return this.player.fullscreenMode===exports.FullScreenMode.FAKE_FULLSCREEN},enumerable:!1,configurable:!0}),t.prototype.setTipStatus=function(e){this.el.dataset.status=String(e),this.isMobile||(this.tip.innerText=e?"退出网页全屏":"网页全屏")},t.prototype.requestFullScreen=function(e){void 0===e&&(e="enter");var t="enter"===e;this.player.requestFullScreen(t,exports.FullScreenMode.FAKE_FULLSCREEN)},t.prototype.setupDOMEvents=function(){var e=this;this.el.addEventListener(this.CLICK_EVENT_NAME,(function(){e.player.setStateKv("ctrlbar:"+t.compName+":"+e.CLICK_EVENT_NAME,{type:exports.LOG_TYPE.USER_ACTION}),e.requestFullScreen(e.isFullScreen?"exit":"enter")})),this.isMobile||(this.el.addEventListener("mouseover",(function(){e.showEl(e.tip)})),this.el.addEventListener("mouseout",(function(){e.hideEl(e.tip)}))),this.player.on(exports.PLAY_EVENT.FULLSCREEN_CHANGE,(function(o){var r=o.data,n=r.mode,i=r.isEnter;if(n===exports.FullScreenMode.FAKE_FULLSCREEN){var a=e.player.config.fullscreenContainer||e.player.container;e.setTipStatus(i),a.classList.toggle(t.fullscreenClassName,i),e.ctrlbar.emit(CTRL_EVENTS$2.FAKE_FULLSCREEN_CHANGE,i)}}))},t.sel=".txp_right_controls .txp_btn_fake",t.fullscreenClassName="plugin_ctrl_txp_mode_fullscreen",t.compName="FakeFullscreen",t}(Component),fullscreenClassName="thumbplayer-fullscreen",Fullscreen=function(e){function t(o,r,n){var i=e.call(this,o,t.sel,r)||this;return i.ctrlbar=n,i.onFullscreenChange=function(e){var t=e.data,o=t.mode,r=t.isEnter;o===exports.FullScreenMode.FULL_SCREEN&&(i.setDOMStatus(r?FullscreenStatus.Exit:FullscreenStatus.Enter),i.ctrlbar.emit(CTRL_EVENTS$2.FULLSCREEN_CHANGE,r),(i.player.config.fullscreenContainer||i.player.container).classList.toggle(fullscreenClassName,r))},i.onPlaySessionEnd=function(){uaTool.os.ios&&i.el.classList.add(Component.disabledClassName)},i.onPlaySessionStart=function(){i.el.classList.remove(Component.disabledClassName)},i.tip=i.el.querySelector(".txp_tooltip"),i.setupDOMEvents(),i.isMobile||i.listenDblclick(),i}return __extends$1(t,e),t.isEnabled=function(e){var t=e.isMobile,o=e.useH5FakeFullscreen;return t&&void 0!==o?!o:!(!uaTool.os.ios&&t)},Object.defineProperty(t.prototype,"isFullScreen",{get:function(){return this.player.fullscreenMode===exports.FullScreenMode.FULL_SCREEN},enumerable:!1,configurable:!0}),t.prototype.setDOMStatus=function(e){this.el.dataset.status=e,this.isMobile||(this.tip.innerText=e===FullscreenStatus.Exit?"退出全屏":"全屏")},t.prototype.requestFullScreen=function(e){var t=this;return void 0===e&&(e="enter"),this.player.requestFullScreen("enter"===e,exports.FullScreenMode.FULL_SCREEN).catch((function(e){t.ctrlbar.emit(CTRL_EVENTS$2.FULLSCREEN_ERROR,e)}))},t.prototype.listenDblclick=function(){var e=this;this.player.container.querySelector(shadowClassName$1).addEventListener("dblclick",(function(){var t;(null===(t=e.ctrlbar.instances.FakeFullscreen)||void 0===t?void 0:t.isFullScreen)?e.ctrlbar.instances.FakeFullscreen.requestFullScreen("exit"):e.requestFullScreen(e.isFullScreen?"exit":"enter")}))},t.prototype.setupDOMEvents=function(){var e=this;this.el.addEventListener("click",(function(){e.el.classList.contains(Component.disabledClassName)||(e.player.setStateKv("ctrlbar:"+t.compName+":click",{type:exports.LOG_TYPE.USER_ACTION,message:"fullscreen="+e.isFullScreen}),e.requestFullScreen(e.isFullScreen?"exit":"enter"))})),this.isMobile||(this.el.addEventListener("mouseover",(function(){return e.showEl(e.tip)})),this.el.addEventListener("mouseout",(function(){return e.hideEl(e.tip)}))),this.player.on(exports.PLAY_EVENT.FULLSCREEN_CHANGE,this.onFullscreenChange),this.player.on(exports.H5_PLAY_EVENT.PLAY_SESSION_END,this.onPlaySessionEnd),this.player.on(exports.H5_PLAY_EVENT.PLAY_SESSION_START,this.onPlaySessionStart)},t.sel=".txp_right_controls .txp_btn_fullscreen",t.compName="Fullscreen",t}(Component),FullscreenStatus,HOTPOINT_TIP_TYPE;!function(e){e.Enter="false",e.Exit="true"}(FullscreenStatus||(FullscreenStatus={})),function(e){e.DEFAULT="default",e.WITH_PREVIEW="with-preview",e.NONE="none"}(HOTPOINT_TIP_TYPE||(HOTPOINT_TIP_TYPE={}));var THROTTLE_WAIT=16.6,mouseEvtMap={mouseover:HOTPOINT_EVENTS$1.HOT_MOUSE_OVER,mousemove:HOTPOINT_EVENTS$1.HOT_MOUSE_MOVE,mouseout:HOTPOINT_EVENTS$1.HOT_MOUSE_OUT},HotPoint=function(e){function t(o,r,n){var i,a=e.call(this,o,t.sel,r)||this;return a.ctrlbar=n,a.hotPointMap={},a.isReady=!1,a.onVideoCanPlay=function(){a.isReady||(a.isReady=!0,a.renderDom())},a.onPlaySessionEnd=function(){a.isReady=!1,a.tipEl.classList.add(t.hideClassName),a.clearHotPoints()},a.config.hotPointTipType||(a.config.hotPointTipType=HOTPOINT_TIP_TYPE.DEFAULT),a.mouseEvtHandler=a.mouseEvtHandler.bind(a),a.mouseEvtFuncMap={mouseover:a.onMouseOver.bind(a),mousemove:lodash_throttle(a.onMouseMove.bind(a),THROTTLE_WAIT,{trailing:!1}),mouseout:a.onMouseOut.bind(a)},a.eventMap=((i={})[exports.H5_PLAY_EVENT.VIDEO_CANPLAY]=a.onVideoCanPlay,i[exports.H5_PLAY_EVENT.PLAY_SESSION_END]=a.onPlaySessionEnd,i),a.config.hotPointTipType===HOTPOINT_TIP_TYPE.DEFAULT&&a.setupTip(),a.setEvts(!1),a.logger=new Logger(a.player.config.instanceId,"Ctrl:HotPoints"),a}return __extends$1(t,e),t.isEnabled=function(e){return!e.isMobile},t.prototype.clearHotPoints=function(){Object.values(this.hotPointMap).forEach((function(e){var t=e.el;t instanceof HTMLElement&&t.remove()})),this.hotPointMap={}},t.prototype.addHotPoints=function(e){var t=this;if(null==e?void 0:e.length){var o=e.map((function(e){var o=__assign$2({},e);return o.uuid=comTool.createGUID(),t.hotPointMap[o.uuid]=o,o}));return this.isReady&&this.renderDom(),o}},t.prototype.deleteHotPoints=function(e){var t=this;e.forEach((function(e){var o,r=t.hotPointMap[e];r&&(null===(o=r.el)||void 0===o||o.remove(),delete t.hotPointMap[e])}))},t.prototype.setEvts=function(t){var o=this;void 0===t&&(t=!1);var r=t?this.el.removeEventListener:this.el.addEventListener;Object.keys(mouseEvtMap).forEach((function(e){r.call(o.el,e,o.mouseEvtHandler,!1)})),e.prototype.setEvts.call(this,t)},t.prototype.isValidHotPoint=function(e){return e.timing<=this.player.duration},t.prototype.renderDom=function(){var e=this;Object.entries(this.hotPointMap).forEach((function(t){var o=t[0],r=t[1];if(!(r.el instanceof HTMLElement)){var n=e.createPointElement(r);n&&(e.el.insertAdjacentElement("beforeend",n),e.hotPointMap[o]=__assign$2(__assign$2({},r),{el:n}))}}))},t.prototype.createPointElement=function(e){if(this.isValidHotPoint(e)){var o=document.createElement("div"),r=e.timing/this.ctrlbar.duration*100;return o.classList.add(t.defaultPointClass),o.style.left=r+"%",o.dataset.info=JSON.stringify(e),o}this.logger.warn("ctrlbar: hotpoint 入值非法，已忽略",e)},t.prototype.setupTip=function(){var e;this.config.hotPointCustomTipEl?e=this.config.hotPointCustomTipEl:(e=document.createElement("div")).classList.add(t.defaultTipClass),e.classList.add(t.hideClassName),this.el.insertAdjacentElement("beforeend",e),this.tipEl=e},Object.defineProperty(t.prototype,"offsetLeft",{get:function(){return this.player.container.getBoundingClientRect().left},enumerable:!1,configurable:!0}),t.prototype.mouseEvtHandler=function(e){var t=e.target.dataset;if(t.info){var o=this.config.hotPointTipType,r=JSON.parse(t.info);o===HOTPOINT_TIP_TYPE.DEFAULT&&this.mouseEvtFuncMap[e.type]({point:r,mouseEvent:e}),this.ctrlbar.emit(mouseEvtMap[e.type],{point:r,mouseEvent:e,hotPointTipType:o})}},t.prototype.onMouseOver=function(e){var o=e.point;this.tipEl&&o.text&&(this.tipEl.textContent=o.text,this.tipEl.classList.remove(t.hideClassName))},t.prototype.onMouseMove=function(e){if(this.tipEl){var t=e.mouseEvent,o=this.player.container,r=this.tipEl.getBoundingClientRect().width,n=t.clientX-this.offsetLeft-r/2;n<0&&(n=0),n>o.clientWidth-r&&(n=o.clientWidth-r),this.tipEl.style.transform="translateX("+n+"px)"}},t.prototype.onMouseOut=function(){this.tipEl&&this.tipEl.classList.add(t.hideClassName)},t.sel=".txp_hotpoint",t.compName="HotPoint",t.defaultPointClass="txp_interact_dot",t.defaultTipClass="txp_hotpoint_tip",t}(Component),LanguagePopup=function(e){function t(o,r,n){var i=e.call(this,o,__assign$2(__assign$2({},r),{selector:t.popupSelector,modSelector:t.modSelector}),n)||this;return i.popupName="language",i.onSelect=function(e){i.ctrlbar.emit(CTRL_EVENTS$2.SET_LANGUAGE,e)},i}return __extends$1(t,e),t.isEnabled=function(e){return!(e.isMobile||e.disableLang)},t.compName="LanguagePopup",t.modSelector=".mod_overlay.language",t.popupSelector=".txp_right_controls .txp_btn_language",t}(Popup),Progress=function(e){function t(o,r,n){var i,a=e.call(this,o,t.sel,r)||this;a.ctrlbar=n,a.isMouseDown=!1,a.maxPercent=1,a.isActive=!0,a.shouldHideHoverTime=!1,a.onMouseMove=function(e){if(e.preventDefault(),a.isMouseDown){var t=Math.min(a.getPercentByClientX(e),a.maxPercent);a.updateProgress(t),a.ctrlbar.emit(CTRL_EVENTS$2.MOUSE_MOVE,t),e.preventDefault()}},a.onMouseUp=function(e){if(e.preventDefault(),document.removeEventListener("touchmove",a.onMouseMove),document.removeEventListener("mousemove",a.onMouseMove),document.removeEventListener("touchend",a.onMouseUp),document.removeEventListener("mouseup",a.onMouseUp),a.isMouseDown){a.player.setStateKv("ctrlbar:"+t.compName+":"+(a.isMobile?"touchend":"mouseup"),{type:exports.LOG_TYPE.USER_ACTION,eventId:a.evtId}),a.isMouseDown=!1;var o=parseFloat(a.progressPlayed.style.width)/100;a.doSeek(o),a.ctrlbar.emit(CTRL_EVENTS$2.MOUSE_UP,o)}},a.onMouseDown=function(e){if(e.preventDefault(),document.addEventListener("touchend",a.onMouseUp),document.addEventListener("mouseup",a.onMouseUp),document.addEventListener("touchmove",a.onMouseMove,{passive:!1}),document.addEventListener("mousemove",a.onMouseMove,{passive:!1}),a.evtId=a.player.dataset.generateEvtId(),a.player.setStateKv("ctrlbar:"+t.compName+":"+(a.isMobile?"touchstart":"mousedown"),{type:exports.LOG_TYPE.USER_ACTION,eventId:a.evtId}),a.player.state!==exports.VIDEO_STATE.IDLE){a.beforeSeek(),a.isMouseDown=!0;var o=Math.min(a.getPercentByClientX(e),a.maxPercent);a.updateProgress(o),a.ctrlbar.emit(CTRL_EVENTS$2.MOUSE_DOWN,o)}},a.eventMap=((i={})[exports.PLAY_EVENT.TIME_UPDATE]=a.onTimeUpdate.bind(a),i[exports.PLAY_EVENT.STATE_CHANGE]=a.onStateChange.bind(a),i[exports.PLAY_EVENT.VIDEO_BUFFER_CHANGE]=function(){return a.updateBufferedBar()},i),a.setEvts(),a.progressLoaded=a.el.querySelector(".txp_progress_load"),a.progressPlayed=a.el.querySelector(".txp_progress_play"),a.scrubber=a.el.querySelector(".txp_btn_scrubber"),a.tooltip=a.el.querySelector(".txp_tooltip");return a.tooltipPosLimit=45/a.player.container.clientWidth/2*100+.5,a.isMobile&&a.el.appendChild(a.scrubber),a.el.addEventListener("touchstart",a.onMouseDown),a.el.addEventListener("mousedown",a.onMouseDown),a.isMobile||(a.setTooltipOnHover(),a.el.addEventListener("mouseover",(function(){n.emit(CTRL_EVENTS$2.HOVER_PROGRESS)}))),a.listenReqInfoEnd(),a}return __extends$1(t,e),Object.defineProperty(t.prototype,"offsetLeft",{get:function(){return this.el.getBoundingClientRect().left},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bufferedTime",{get:function(){var e=this,t=this.player.videoBuffered,o=t.length;if(1===o)return t[0].end;var r=0;return t.forEach((function(n,i){var a=n.start,s=n.end,l=e.playtime;if(l>=a&&l<=s)if(o>i+1)for(var c=i+1;c<o;c++){var p=t[c].start-t[c-1].end;if(!(0<=p&&p<=.2)){r=t[c-1].end;break}r=t[c].end}else r=n.end})),r},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){this.el.removeEventListener("touchstart",this.onMouseDown),this.el.removeEventListener("mousedown",this.onMouseDown),document.removeEventListener("touchmove",this.onMouseMove),document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("touchend",this.onMouseUp),document.removeEventListener("mouseup",this.onMouseUp),e.prototype.destroy.call(this)},t.prototype.setActive=function(e){this.isActive!==e&&(this.isActive=e,this.setEvts(!this.isActive),this.isActive?this.showEl():this.hideEl())},t.prototype.setTooltip=function(e){var t=this.tooltip,o=this.tooltipPosLimit;t.innerText=comTool.formatPlayTime(e*this.ctrlbar.duration);var r=Math.max(o,Math.min(100*e,100-o));t.style.left=r+"%"},t.prototype.updateBufferedBar=function(e){if(void 0===e&&(e=this.bufferedTime),0!==e){if(this.ctrlbar.duration&&"number"==typeof e){var t=Math.min(Math.round(100*e/this.ctrlbar.duration),100*this.maxPercent);t>=99&&(t=100),this.progressLoaded.style.width=t+"%"}}else this.progressLoaded.style.width="0"},t.prototype.updateProgress=function(e){if(!Number.isNaN(e)){var t=100*e;this.progressPlayed.style.width=t+"%",this.scrubber.style.left=t+"%"}},t.prototype.getPercentByClientX=function(e){var t=("touches"in e?e.touches[0]:e).clientX-this.offsetLeft;Math.abs(t-this.el.clientWidth)<=1&&(t=this.el.clientWidth);var o=t/this.el.clientWidth;return o=Math.max(0,Math.min(1,o))},t.prototype.onTimeUpdate=function(){if(!this.isMouseDown){var e=this.playtime/this.ctrlbar.duration;this.updateProgress(e),this.updateBufferedBar()}},t.prototype.onStateChange=function(e){var t=e.data;-1!==[exports.VIDEO_STATE.IDLE,exports.VIDEO_STATE.END].indexOf(t.new)&&(this.updateProgress(0),this.updateBufferedBar(0))},t.prototype.setTooltipOnHover=function(){var e=this;this.el.addEventListener("mouseover",(function(t){if(!(e.config.hideHoverTime||void 0===e.config.hideHoverTime&&e.shouldHideHoverTime)){var o=e.getPercentByClientX(t);e.setTooltip(o),e.showEl(e.tooltip),e.tooltip.style.display="flex"}})),this.el.addEventListener("mouseout",(function(){return e.hideEl(e.tooltip)})),this.el.addEventListener("mousemove",(function(t){var o=e.getPercentByClientX(t);e.setTooltip(o)}))},t.prototype.beforeSeek=function(){var e=this;this.pauseTimer=window.setTimeout((function(){return e.player.pause()}),300)},t.prototype.doSeek=function(e){var t=this.config.timeOffset,o=e*this.ctrlbar.duration;this.player.seek(t?t(o,!0):o),this.pauseTimer&&(window.clearTimeout(this.pauseTimer),this.pauseTimer=null),this.player.state!==exports.VIDEO_STATE.PAUSE||this.player.config.remainPauseStateAfterSeek||this.player.play()},t.prototype.listenReqInfoEnd=function(){var e=this;this.player.pluginMsg.on(exports.PLAY_EVENT_EXT.GETINFO_OVER,(function(t){var o,r,n,i=t.data,a=e.player.plugins,s=a["ui-preview"]||a["ui-preview-list"],l=(null===(o=i.parseData)||void 0===o?void 0:o.preview)>0;e.shouldHideHoverTime=!(!s||l||!(null===(n=null===(r=i.parseData)||void 0===r?void 0:r.previewList)||void 0===n?void 0:n.length))}))},t.sel=".txp_progress_bar_container",t.compName="Progress",t}(Component),TIME_UPDATE_GAP_MS=200,PLAY_BACK_STATE;!function(e){e.IDLE="idle",e.BACK_PLAYING="backPlaying",e.LIVE_PLAYING="livePlaying"}(PLAY_BACK_STATE||(PLAY_BACK_STATE={}));var LiveProgress=function(e){function t(t,o,r,n){var i=e.call(this,t,o,r)||this;return i.ctrlbar=r,i.timeupdateTimerID=0,i.playbackStateInner=PLAY_BACK_STATE.IDLE,i.maxBackDurationOverflow=!1,i.curBackDurationMS=0,i.liveStateTimeStr="",i.isSwitchBackOp=!1,i.playerApiForPlugins=null==n?void 0:n.api,i.logger=new Logger(i.player.config.instanceId,"LiveProgress"),i.addReturnLiveBtn(),i.addLiveTimeDisplay(),i.setActive(!1),i.addPlayerEvts(),i}return __extends$1(t,e),t.isEnabled=function(e){return!e.isMobile},t.prototype.destroy=function(){var t,o;(null===(t=this.liveTimeDisplayDom)||void 0===t?void 0:t.parentNode)&&(this.liveTimeDisplayDom.remove(),this.liveTimeDisplayDom=null),(null===(o=this.returnLiveBtn)||void 0===o?void 0:o.parentNode)&&(this.returnLiveBtn.remove(),this.returnLiveBtn=null),this.playerApiForPlugins=null,this.setTimeupdateTimer(!1),e.prototype.destroy.call(this)},t.prototype.setActive=function(t){e.prototype.setActive.call(this,t),this.liveTimeDisplayDom.style.display=t?"flex":"none",this.hideEl(this.returnLiveBtn)},t.prototype.setTooltip=function(e){var t=this.tooltip,o=this.tooltipPosLimit,r=Math.max(o,Math.min(100*e,100-o)),n=this.getTimeTip(e);t.style.left=r+"%",t.innerText=n},t.prototype.updateBufferedBar=function(e){},t.prototype.onTimeUpdate=function(){},t.prototype.onStateChange=function(){},t.prototype.beforeSeek=function(){},t.prototype.doSeek=function(e){this.seek(e)},t.prototype.addLiveTimeDisplay=function(){var e=this.ctrlbar.el.querySelector(".txp_left_controls");this.liveTimeDisplayDom=domTool.creatDom('<txpdiv class="txp_time_display txp_time_display_live" style="display: none;">\n      <txpdiv class="txp_live_badge" style="display: block">直播中</txpdiv>\n    </txpdiv>'),this.liveBadgeDom=this.liveTimeDisplayDom.querySelector(".txp_live_badge"),e.append(this.liveTimeDisplayDom)},t.prototype.addReturnLiveBtn=function(){var e=this,t=this.ctrlbar.el.querySelector(".txp_left_controls");this.returnLiveBtn=domTool.creatDom('<txpdiv class="txp_btn txp_btn_return txp_none">\n      <txpdiv class="txp_label">返回直播</txpdiv>\n    </txpdiv>'),t.append(this.returnLiveBtn),this.returnLiveBtn.addEventListener("click",(function(){e.seek(1)}))},t.prototype.updateLiveTime=function(e,t){void 0===t&&(t=""),domTool.text(this.liveBadgeDom,e+" "+t)},t.prototype.setPlayBackState=function(e){e?(domTool.addClass(this.liveBadgeDom,"txp_live_badge_back"),this.showEl(this.returnLiveBtn)):(domTool.removeClass(this.liveBadgeDom,"txp_live_badge_back"),this.hideEl(this.returnLiveBtn))},t.prototype.addPlayerEvts=function(){var e=this;this.player.on(exports.H5_PLAY_EVENT.VIDEO_REQ_INFO_END,(function(t){var o,r=t.data.data;if(r&&!r.error){var n=(r||{}).resData;e.clientStartTimeMS=Date.now(),e.playbackData=null===(o=n)||void 0===o?void 0:o.playback,e.playbackData?e.playbackState===PLAY_BACK_STATE.IDLE&&(e.setPlayBackEnabled(!0),e.player.loadParam.videoReqInfoParam.playbacktime>0?e.enterState(PLAY_BACK_STATE.BACK_PLAYING):e.enterState(PLAY_BACK_STATE.LIVE_PLAYING)):e.setPlayBackEnabled(!1)}})),this.player.on(exports.H5_PLAY_EVENT.PLAY_SESSION_END,(function(){e.isSwitchBackOp?e.isSwitchBackOp=!1:e.enterState(PLAY_BACK_STATE.IDLE)})),this.player.on(exports.H5_PLAY_EVENT.VIDEO_PLAYING,(function(){e.isSwitchBackOp=!1}))},t.prototype.setPlayBackEnabled=function(e){this.setActive(e),this.setTimeupdateTimer(e)},t.prototype.enterState=function(e,t){var o=this;if(this.playbackData&&this.playbackState!==e){var r=this.playbackState;if(this.logger.log("enterState from "+r+" to "+e),r===PLAY_BACK_STATE.IDLE&&e===PLAY_BACK_STATE.LIVE_PLAYING)this.playbackState=e;else if(r===PLAY_BACK_STATE.LIVE_PLAYING&&e===PLAY_BACK_STATE.BACK_PLAYING){var n=t.backDurationMS,i=this.calcBackAbsoluteTimeS(Date.now(),n);this.switchPlay(i,(function(){o.curBackDurationMS=n,o.playbackState=e}),(function(e){o.playbackState=PLAY_BACK_STATE.LIVE_PLAYING;var t=e||{},r=t.code,n=t.message,i=t.data;(null==r?void 0:r.startsWith(exports.ErrorCode.GETINFO_LIVE_SERVER_CODE_PREFIX))&&o.emitPlayerEvts("playbackFailed",__assign$2({code:r,message:n},i));var a=o.player.plugins.tips;"function"==typeof(null==a?void 0:a.show)&&a.show("抱歉，进入回看失败..."),o.logger.warn("enter playback failed, code="+r+", message="+n)}))}else r===PLAY_BACK_STATE.BACK_PLAYING&&e===PLAY_BACK_STATE.LIVE_PLAYING?this.switchPlay(0,(function(){o.playbackState=e})):e===PLAY_BACK_STATE.IDLE&&(this.playbackState=e)}},Object.defineProperty(t.prototype,"playbackState",{get:function(){return this.playbackStateInner},set:function(e){this.playbackStateInner=e,this.onPlaybackStateChange(e),this.emitPlayerEvts("playbackStateChange",{state:this.playbackState})},enumerable:!1,configurable:!0}),t.prototype.onPlaybackStateChange=function(e){switch(e){case PLAY_BACK_STATE.LIVE_PLAYING:this.exitBackPlaying();break;case PLAY_BACK_STATE.BACK_PLAYING:this.enterBackPlaying();break;case PLAY_BACK_STATE.IDLE:this.exitBackPlaying(),this.setPlayBackEnabled(!1)}},t.prototype.emitPlayerEvts=function(e){for(var t,o=[],r=1;r<arguments.length;r++)o[r-1]=arguments[r];(t=this.player).emit.apply(t,__spreadArray$1([e],o,!1))},t.prototype.switchPlay=function(e,t,o){var r;this.isSwitchBackOp=!0,(null===(r=this.playerApiForPlugins)||void 0===r?void 0:r.replayInCurFlowNode)&&this.playerApiForPlugins.replayInCurFlowNode(this.player.vid,{videoReqInfoParam:{playbacktime:e}}).then((function(){null==t||t()})).catch((function(e){null==o||o(e)}))},t.prototype.seekInBackState=function(e){var t,o=e.backDurationMS,r=this.calcBackAbsoluteTimeS(Date.now(),o),n=this.player.currentVideoInfo.loadingUrl,i=urlTool.updateUrlParam(n,"wsStreamTimeABS",""+r);this.curBackDurationMS=o,this.isSwitchBackOp=!0,(null===(t=this.playerApiForPlugins)||void 0===t?void 0:t.replayInCurFlowNode)&&this.playerApiForPlugins.replayInCurFlowNode({url:i})},t.prototype.enterBackPlaying=function(){this.setPlayBackState(!0),this.updateLiveTime("回看中")},t.prototype.exitBackPlaying=function(){this.updateProgress(1),this.setPlayBackState(!1),this.curBackDurationMS=0,this.updatePlaybackTime(0),this.updateLiveTime("直播中")},t.prototype.updatePlaybackTime=function(e){var t,o;this.player.loadParam.videoReqInfoParam.playbacktime=e,null===(o=(t=this.player).updateReqInfo)||void 0===o||o.call(t,{videoReqInfoParam:{playbacktime:e}})},t.prototype.setTimeupdateTimer=function(e){e?0===this.timeupdateTimerID&&(this.timeupdateTimerID=window.setInterval(this.onTimeupdate.bind(this),TIME_UPDATE_GAP_MS)):this.timeupdateTimerID>0&&(window.clearInterval(this.timeupdateTimerID),this.timeupdateTimerID=0)},t.prototype.calcMaxBackDurationS=function(e){var t=this.playbackData.playbacktime;if(this.maxBackDurationOverflow)return t;var o=this.calcStreamAbsoluteDurationMS(e)/1e3;return o<t?(this.maxBackDurationOverflow=!1,o):(this.maxBackDurationOverflow=!0,t)},t.prototype.calcAbsoluteTimeMS=function(e){return 1e3*this.playbackData.svrtick+(e-this.clientStartTimeMS)},t.prototype.calcStreamAbsoluteDurationMS=function(e){return this.calcAbsoluteTimeMS(e)-1e3*this.playbackData.playbackstart},t.prototype.calcBackAbsoluteTimeS=function(e,t){return Math.round((this.calcAbsoluteTimeMS(e)-t)/1e3)},t.prototype.onTimeupdate=function(){if(!this.isMouseDown&&this.player.state===exports.VIDEO_STATE.PLAYING){var e="",t="",o=Date.now(),r=this.calcStreamAbsoluteDurationMS(o);if(this.playbackState===PLAY_BACK_STATE.BACK_PLAYING){var n=this.calcMaxBackDurationS(o),i=(r-this.curBackDurationMS)/1e3,a=this.calcBackAbsoluteTimeS(o,this.curBackDurationMS);if(this.updatePlaybackTime(a),t="回看中",e=""+comTool.formatPlayTime(i),!this.maxBackDurationOverflow){var s=(n-this.curBackDurationMS/1e3)/n;this.updateProgress(s)}}else t="直播中",e=""+comTool.formatPlayTime(r/1e3);this.liveStateTimeStr!==e&&(this.liveStateTimeStr=e,this.updateLiveTime(t,e))}},t.prototype.calcPercent2BackTimeS=function(e){return(1-e)*this.calcMaxBackDurationS(Date.now())},t.prototype.getTimeTip=function(e){var t=this.calcPercent2BackTimeS(e);return"回退"+comTool.formatPlayTime(t)},t.prototype.seek=function(e){if(1===e)return this.logger.log("percent===1, return to live"),void this.enterState(PLAY_BACK_STATE.LIVE_PLAYING);var t=1e3*this.calcPercent2BackTimeS(e);this.playbackState===PLAY_BACK_STATE.LIVE_PLAYING?(this.logger.log("live to playback"),this.enterState(PLAY_BACK_STATE.BACK_PLAYING,{backDurationMS:t})):this.playbackState===PLAY_BACK_STATE.BACK_PLAYING&&(this.logger.log("seek in playback"),this.seekInBackState({backDurationMS:t}))},t}(Progress),LoopStatus;!function(e){e.Loop="true",e.NotLoop="false"}(LoopStatus||(LoopStatus={}));var LocalLoopConfigKey="thumbplayer-h5-loop",Loop=function(e){function t(o,r){var n=e.call(this,o,t.sel,r)||this;return n.tip=n.el.querySelector(".txp_tooltip"),n.setupDOMEvents(),n.initLoopConfig(),n}return __extends$1(t,e),t.isEnabled=function(e){var t=e.enableLoop,o=e.isMobile;return t&&!o},Object.defineProperty(t.prototype,"isLoopMode",{get:function(){return this.el.dataset.status===LoopStatus.Loop},set:function(e){this.player.config.loop=e,this.el.dataset.status=String(e),this.tip.innerText=e?"关闭循环播放":"打开循环播放"},enumerable:!1,configurable:!0}),t.prototype.setupDOMEvents=function(){var e=this;this.el.addEventListener(this.CLICK_EVENT_NAME,(function(){e.isLoopMode=!e.isLoopMode,lsTool.setData(LocalLoopConfigKey,e.isLoopMode?LoopStatus.Loop:LoopStatus.NotLoop)}))},t.prototype.initLoopConfig=function(){var e=this.player.config.loop;if(void 0===e){var t=lsTool.getData(LocalLoopConfigKey);t&&(this.isLoopMode=t===LoopStatus.Loop)}else this.isLoopMode=!!e},t.compName="Loop",t.sel=".txp_left_controls .txp_btn_loop",t}(Component),NextBtn=function(e){function t(o,r,n){var i,a=e.call(this,o,t.sel,r)||this;a.ctrlbar=n;var s=r.showNextBtnUIOnly;return s?a.el.classList.remove(Component.disabledClassName):(a.onVideoNodeChange=a.onVideoNodeChange.bind(a),a.eventMap=((i={})[exports.PLAY_EVENT.VIDEONODE_CHANGE]=a.onVideoNodeChange,i[exports.PLAY_EVENT.LIST_CHANGE]=a.onVideoNodeChange,i),a.setEvts()),a.el.addEventListener(a.CLICK_EVENT_NAME,(function(){if(a.player.setStateKv("ctrlbar:"+t.compName+":"+a.CLICK_EVENT_NAME,{type:exports.LOG_TYPE.USER_ACTION}),a.ctrlbar.emit(CTRL_EVENTS$2.CLICK_NEXTBTN),!s){var e=a.player.currentVideoInfoIdx;-1===e||e>=a.player.totalVideoInfoCount-1||a.player.playNext()}})),a}return __extends$1(t,e),t.isEnabled=function(e){var t=e.isMobile,o=e.disableNextBtn,r=e.showNextBtnUIOnly;return!(t||o&&!r)},t.prototype.onVideoNodeChange=function(){var e=this.player.currentVideoInfoIdx;-1!==e&&e+1<this.player.totalVideoInfoCount?this.el.classList.remove(Component.disabledClassName):this.el.classList.add(Component.disabledClassName)},t.sel=".txp_left_controls .txp_btn_next",t.compName="NextBtn",t}(Component),PictureInPicture=function(e){function t(o,r,n){var i=e.call(this,o,t.sel,r)||this;return i.ctrlbar=n,i.isPiP=!1,i.onEnterPiP=function(){i.isPiP=!0,i.setDOMStatus(!1)},i.onLeavePiP=function(){i.isPiP=!1,i.setDOMStatus(!0)},void 0===HTMLVideoElement.prototype.requestPictureInPicture?(i.el.classList.add(Component.hideClassName),i):(i.setupDOMEvents(),i.setupPlayerEvents(),i.tooltip=i.el.querySelector(".txp_tooltip"),i)}return __extends$1(t,e),t.isEnabled=function(e){return!e.isMobile},t.prototype.enterPicInPic=function(){var e=this.player.currentVideoElement;e&&(e.requestPictureInPicture(),this.setDOMStatus(!1))},t.prototype.leavePicInPic=function(){var e,t;try{null===(t=null===(e=document.exitPictureInPicture())||void 0===e?void 0:e.catch)||void 0===t||t.call(e,(function(){}))}catch(e){}this.setDOMStatus(!0)},t.prototype.destroy=function(){this.setupVideoListener(!1),this.leavePicInPic(),e.prototype.destroy.call(this)},t.prototype.setupDOMEvents=function(){var e=this;this.el.addEventListener("click",(function(){e.isPiP?(e.leavePicInPic(),e.isPiP=!1):(e.enterPicInPic(),e.isPiP=!0),e.ctrlbar.emit(CTRL_EVENTS$2.CLICK_PIPBTN,e.isPiP)}))},t.prototype.setupPlayerEvents=function(){var e=this;this.player.on(exports.H5_PLAY_EVENT.VIDEO_PLAYING,(function(t){t.data.isFirst&&e.setPipSupportStatus(e.isKernelSupport())})),this.player.on(exports.H5_PLAY_EVENT.VIDEO_SETLEVEL_END,(function(t){t.data.code===exports.ErrorCode.SUC&&e.setPipSupportStatus(e.isKernelSupport())}))},t.prototype.setPipSupportStatus=function(e){e?(this.el.classList.remove(Component.hideClassName),this.setVideoPip()):(this.leavePicInPic(),this.el.classList.add(Component.hideClassName))},t.prototype.isKernelSupport=function(){var e=this.player.currentVideoElement;return e instanceof HTMLVideoElement&&"function"==typeof e.requestPictureInPicture},t.prototype.setVideoPip=function(){this.isPiP&&this.enterPicInPic(),this.setupVideoListener(!1),this.setupVideoListener(!0)},t.prototype.setupVideoListener=function(e){void 0===e&&(e=!0);var t=this.player.currentVideoElement;if(t){var o=e?t.addEventListener:t.removeEventListener;o.call(t,"enterpictureinpicture",this.onEnterPiP),o.call(t,"leavepictureinpicture",this.onLeavePiP)}},t.prototype.setDOMStatus=function(e){this.el&&(this.tooltip&&(this.tooltip.innerText=e?"画中画":"退出画中画"),this.el.dataset.status=String(!e))},t.sel=".txp_right_controls .txp_btn_pip",t.compName="PictureInPicture",t}(Component);function showTips(e,t){var o=e.plugins.tips;"function"==typeof(null==o?void 0:o.show)&&o.show(t)}function hideTips(e){var t=e.plugins.tips;"function"==typeof(null==t?void 0:t.hide)&&t.hide()}function getIsInAd(e){var t=e,o=t.flowManager,r=t.videoNode;return!(!getAdPlugin(e.config.instanceId)||!r||r===o.currentFlowNode)}var PlayBtn=function(e){function t(o,r,n){var i,a=e.call(this,o,t.sel,r)||this;return a.ctrlbar=n,a.onPlaySessionStart=function(){a.setPlayStatus(PlayBtnStatus$1.PLAY),a.tooltip.innerText="播放"},a.onPlaySessionEnd=function(){a.setPlayStatus(a.isLive?PlayBtnStatus$1.PLAY:PlayBtnStatus$1.REPLAY),a.tooltip.innerText="播放"},a.eventMap=((i={})[exports.PLAY_EVENT.STATE_CHANGE]=a.onPlayerStateChange.bind(a),i[exports.H5_PLAY_EVENT.PLAY_SESSION_START]=a.onPlaySessionStart,i[exports.H5_PLAY_EVENT.PLAY_SESSION_END]=a.onPlaySessionEnd,i),a.setPlayStatus(PlayBtnStatus$1.PLAY),a.setEvts(),a.tooltip=a.el.querySelector(".txp_tooltip"),a.addEventListener(),a}return __extends$1(t,e),t.prototype.setPlayStatus=function(e){this.el.dataset.status=e,this.el.className="txp_btn txp_btn_play play_btn_"+e},t.prototype.addEventListener=function(){var e=this,o=this.player;this.el.addEventListener("click",(function(){if(o.setStateKv("ctrlbar:"+t.compName+":"+e.CLICK_EVENT_NAME,{type:exports.LOG_TYPE.USER_ACTION}),!e.el.classList.contains(Component.disabledClassName))switch(e.ctrlbar.emit(CTRL_EVENTS$2.CLICK_PLAYBTN,e.el.dataset),e.el.dataset.status){case PlayBtnStatus$1.PAUSE:o.pause(exports.H5_PAUSE_TYPE.USER_CLICK);break;case PlayBtnStatus$1.STOP:o.stop();break;case PlayBtnStatus$1.PLAY:if(!e.isLive)return onBtnClickPlay(o,e.ctrlbar);e.replay();break;case PlayBtnStatus$1.REPLAY:e.ctrlbar.emit(CTRL_EVENTS$2.CLICK_REPLAY),e.replay()}}))},t.prototype.replay=function(){var e=this.player;e.vid?e.triggerAutoplay().then((function(){return e.replay()})):e.replay()},t.prototype.onVodPlaying=function(){var e=this.tooltip;this.setPlayStatus(PlayBtnStatus$1.PAUSE),e.innerText="暂停"},t.prototype.onLivePlaying=function(){var e=this,t=this.tooltip,o=function(){e.setPlayStatus(PlayBtnStatus$1.STOP),t.innerText="停止"};getIsInAd(this.player)?this.player.once(exports.H5_PLAY_EVENT.AD_END,o):o()},t.prototype.onPlayerStateChange=function(e){var t=this,o=e.data.new,r=this.tooltip;switch(o){case exports.VIDEO_STATE.PLAYING:this.isLive?this.onLivePlaying():this.onVodPlaying();break;case exports.VIDEO_STATE.PAUSE:case exports.VIDEO_STATE.CANPLAY:var n=function(){t.setPlayStatus(PlayBtnStatus$1.PLAY),r.innerText="播放"};getIsInAd(this.player)?this.player.once(exports.H5_PLAY_EVENT.AD_END,n):n()}},t.sel=".txp_left_controls .txp_btn_play",t.compName="PlayBtn",t}(Component),PlayratePopup=function(e){function t(o,r,n){var i=e.call(this,o,__assign$2(__assign$2({},r),{selector:t.popupSelector,modSelector:t.modSelector}),n)||this;return i.popupName="playrate",i.onSelect=function(e){var t=i,o=t.player;t.ctrlbar.emit(CTRL_EVENTS$2.SET_PLAYRATE,e);var r=Number(e.value);o.playbackRate!==r&&(o.playbackRate=r,i.selected=r,showTips(i.player,"正在<em>"+r+"</em>倍速度播放"))},i.onPlayRestart=function(){i.el.classList.toggle(Component.hideClassName,!i.player.supportPlaybackRate)},i.popupOptions=[{label:"0.5X",value:.5},{label:"0.75X",value:.75},{label:"1.0X",value:1,btnLabel:"倍速"},{label:"1.25X",value:1.25},{label:"1.5X",value:1.5},{label:"1.75X",value:1.75},{label:"2.0X",value:2}],i.selected=1,i.bindEvts(!0),i}return __extends$1(t,e),t.isEnabled=function(e){var t=e.isMobile,o=e.enablePlayrate;return!t||t&&o},t.prototype.destroy=function(){this.bindEvts(!1),e.prototype.destroy.call(this)},t.prototype.bindEvts=function(e){(e?this.player.on.bind(this.player):this.player.off.bind(this.player))(exports.PLAY_EVENT.RESTART,this.onPlayRestart)},t.compName="PlayratePopup",t.popupSelector=".txp_right_controls .txp_btn_playrate",t.modSelector=".mod_overlay.playrate",t}(Popup),TimeArea=function(e){function t(o,r,n){var i,a=e.call(this,o,t.sel,r)||this;a.ctrlbar=n,a.clickCount=0,a.clickTimer=0,a.onMouseup=function(){a.isMouseDown=!1},a.onMousemove=function(e){var t=e.data;a.timeCur.innerText=comTool.formatPlayTime(t*a.ctrlbar.duration)},a.onMousedown=function(e){var t=e.data;a.isMouseDown=!0,a.timeCur.innerText=comTool.formatPlayTime(t*a.ctrlbar.duration)};var s=CTRL_EVENTS$2.MOUSE_DOWN,l=CTRL_EVENTS$2.MOUSE_MOVE,c=CTRL_EVENTS$2.MOUSE_UP;return a.eventMap=((i={})[exports.PLAY_EVENT.DURATION_CHANGE]=a.onDurationChange.bind(a),i[exports.PLAY_EVENT.TIME_UPDATE]=a.onTimeUpdate.bind(a),i[exports.PLAY_EVENT.STATE_CHANGE]=a.onPlayerStateChange.bind(a),i),a.setEvts(),n.on(s,a.onMousedown),n.on(l,a.onMousemove),n.on(c,a.onMouseup),a.timeCur=a.el.querySelector(".txp_time_current"),a.timeDur=a.el.querySelector(".txp_time_duration"),r.disableTestEvent||a.bindClickOnMobile(),a}return __extends$1(t,e),t.prototype.bindClickOnMobile=function(){var e=this;if(this.isMobile){this.el.addEventListener("click",(function(){e.clickCount+=1,e.clickCount>=5&&(e.clickCount=0,e.ctrlbar.emit(CTRL_EVENTS$2.TEST_EVENT)),e.clickTimer&&clearTimeout(e.clickTimer),e.clickTimer=window.setTimeout((function(){e.clickCount=0}),300)}))}},t.prototype.onPlayerStateChange=function(e){e.data.new===exports.VIDEO_STATE.IDLE&&(this.timeCur.innerText="00:00")},t.prototype.onDurationChange=function(){var e=this.ctrlbar.duration;this.timeDur.innerText=comTool.formatPlayTime(e),this.el.classList.toggle("reach_hour",e>=3600)},t.prototype.onTimeUpdate=function(){if(!this.isMouseDown){var e=comTool.formatPlayTime(this.playtime);this.timeCur.innerText!==e&&(this.timeCur.innerText=e)}},t.sel=".txp_left_controls .txp_time_display",t.compName="TimeArea",t}(Component),VolumeStatus;!function(e){e.Mute="mute",e.Normal="normal"}(VolumeStatus||(VolumeStatus={}));var LOCAL_KEY={VOLUME:"thumbplayer-h5-volume",MUTED:"thumbplayer-h5-volume:muted"},MutedStatus;!function(e){e.muted="true",e.unmuted="false"}(MutedStatus||(MutedStatus={}));var initDragVolume=-1,Volume=function(e){function t(o,r,n){var i,a=e.call(this,o,t.sel,r)||this;return a.ctrlbar=n,a.lastVolume=.5,a.dragVolume=initDragVolume,a.onVideoPlaying=function(e){e.data.isFirst&&(a.isInLiveAd()||a.player.muted&&a.setUi(0))},a.onVolumeChange=function(){if(!a.isInLiveAd()){var e=a.player.volume;a.player.muted&&(e=0),a.setUi(e)}},a.onAdVolumeChange=function(e){var t=e.data;getIsInAd(a.player)&&a.setUi(t.volume)},a.isMobile||(a.eventMap=((i={})[exports.H5_PLAY_EVENT.VIDEO_VOLUME_CHANGE]=a.onVolumeChange,i[exports.H5_PLAY_EVENT.AD_VOLUME_CHANGE]=a.onAdVolumeChange,i[exports.H5_PLAY_EVENT.VIDEO_PLAYING]=a.onVideoPlaying,i),a.setEvts(),a.popup=a.el.querySelector(".txp_popup_volume"),a.volumeSvg=a.el.querySelector(".txp_icon_volume"),a.volumeValue=a.el.querySelector(".txp_volume_range_current"),a.volumeRange=a.el.querySelector(".txp_volume_range"),a.volumeText=a.el.querySelector(".txp_volume_text"),a.initDOMEvents(),a.config.disableCacheVolume||a.setVolumeByCache()),a}return __extends$1(t,e),t.isEnabled=function(e){return!e.isMobile},t.prototype.setVolumeByCache=function(){var e=Number(lsTool.getData(LOCAL_KEY.VOLUME)),t=lsTool.getData(LOCAL_KEY.MUTED);(Number.isNaN(e)||e>1)&&(e=1,lsTool.setData(LOCAL_KEY.VOLUME,"1")),e&&(this.lastVolume=e),t===MutedStatus.muted&&(e=0),this.setVolume(e),this.setUi()},t.prototype.setUi=function(e){void 0===e&&(e=this.getCurrentNodeVolume()),this.el.dataset.status=0===e?VolumeStatus.Mute:VolumeStatus.Normal,this.volumeValue.style.height=100*e+"%",this.volumeText.innerText=String(Math.round(100*e))},t.prototype.getCurrentNodeVolume=function(){var e,t,o=this.player;return getIsInAd(o)&&null!==(t=null===(e=getAdPlugin(o.config.instanceId))||void 0===e?void 0:e.getAdVolume())&&void 0!==t?t:o.volume},t.prototype.isInLiveAd=function(){return this.isLive&&getIsInAd(this.player)},t.prototype.setPercent=function(e,t){var o=e.clientY;this.clientY=this.volumeRange.getBoundingClientRect().top,this.clientHeight=this.volumeRange.clientHeight;var r=(o-this.clientY)/this.clientHeight;r=Math.floor(100*(1-r));var n=(r=Math.max(Math.min(r,100),0))/100;this.player.volume!==n&&(this.ctrlbar.emit(CTRL_EVENTS$2.SET_VOLUME,n),this.dragVolume=r),this.setVolume(n),this.setUi(),t&&(lsTool.setData(LOCAL_KEY.VOLUME,n),lsTool.setData(LOCAL_KEY.MUTED,!1))},t.prototype.setVolume=function(e){var t;this.isInLiveAd()?null===(t=getAdPlugin(this.player.config.instanceId))||void 0===t||t.setAdVolume(e):this.player.volume=e},t.prototype.initDOMEvents=function(){this.setupBtnMouseEvents(),this.setupVolumeClick(),this.setupVolumeRangeMouseEvents()},t.prototype.showVolumeTips=function(){var e=this;if(this.dragVolume!==initDragVolume){this.clearTipsTimer();this.volumeTipsTimer=window.setTimeout((function(){showTips(e.player,"当前音量: <em>"+e.dragVolume.toFixed(0)+"</em>")}),500)}},t.prototype.clearTipsTimer=function(){this.volumeTipsTimer&&(window.clearTimeout(this.volumeTipsTimer),this.volumeTipsTimer=0)},t.prototype.setupBtnMouseEvents=function(){var e=this;this.el.addEventListener("mouseenter",(function(){e.showEl(e.popup),e.dragVolume=initDragVolume,e.clearTipsTimer()})),this.el.addEventListener("mouseleave",(function(){e.isMouseDown||(e.hideEl(e.popup),e.showVolumeTips())}))},t.prototype.setupVolumeRangeMouseEvents=function(){var e=this,t=this.volumeRange,o=this.player;t.addEventListener("mousedown",(function(){e.isMouseDown=!0})),t.addEventListener("mousemove",(function(t){e.isMouseDown&&e.setPercent(t)})),o.container.addEventListener("mousemove",(function(t){e.isMouseDown&&e.setPercent(t)})),t.addEventListener("mouseup",(function(t){e.isMouseDown=!1,e.setPercent(t,!0)})),o.container.addEventListener("mouseup",(function(t){e.isMouseDown&&(e.isMouseDown=!1,e.setPercent(t,!0),e.hideEl(e.popup),e.showVolumeTips())}))},t.prototype.setupVolumeClick=function(){var e=this;this.volumeSvg.addEventListener(this.CLICK_EVENT_NAME,(function(){e.el.dataset.status===VolumeStatus.Mute?(e.el.dataset.status=VolumeStatus.Normal,e.setVolume(e.lastVolume),lsTool.setData(LOCAL_KEY.MUTED,MutedStatus.unmuted),lsTool.setData(LOCAL_KEY.VOLUME,e.lastVolume)):(e.lastVolume=e.getCurrentNodeVolume(),e.el.dataset.status=VolumeStatus.Mute,e.setVolume(0),lsTool.setData(LOCAL_KEY.MUTED,MutedStatus.muted)),e.player.played&&-1===[exports.VIDEO_STATE.END,exports.VIDEO_STATE.IDLE].indexOf(e.player.state)||e.setUi()}))},t.compName="Volume",t.sel=".txp_btn_volume",t}(Component),THUMBPLAYER_PREFIX="thumbplayer",svgSpriteClassName="txp_svg_sprite",ctrlBarClassName="txp_controls",svgSpriteSelector="."+THUMBPLAYER_PREFIX+"."+svgSpriteClassName,ctrlBarSelector="."+THUMBPLAYER_PREFIX+"."+ctrlBarClassName,pcViewBox="0 0 28 28",svgSprite='\n<svg class="'+THUMBPLAYER_PREFIX+" "+svgSpriteClassName+'" display="none" xmlns="http://www.w3.org/2000/svg">\n    <symbol id="txp_svg_play" viewBox="'+pcViewBox+'">\n        <path d="M6.308 6.057S6 6.857 6 13.964c0 7.108.308 7.978.308 7.978 0 .788.827 1.299 1.526.943 0 0 1.603-.25 8.057-3.493 6.455-3.244 7.534-4.45 7.534-4.45.767-.39.767-1.493 0-1.884 0 0-1.768-1.617-7.531-4.553-5.7-2.904-8.06-3.39-8.06-3.39a1.051 1.051 0 0 0-1.526.942" fill-rule="evenodd"/>\n    </symbol>\n    <symbol id="txp_svg_replay" viewBox="'+pcViewBox+'">\n        <path d="M14 4a9.994 9.994 0 0 1 8.5 4.731V6a1 1 0 0 1 2 0v5a1 1 0 0 1-.883.993L23.5 12h-5a1 1 0 0 1 0-2h2.43a8 8 0 1 0 .816 6.01 1 1 0 0 1 1.936.5A10.003 10.003 0 0 1 14 24C8.477 24 4 19.523 4 14S8.477 4 14 4Z" fill-rule="evenodd"/>\n    </symbol>\n    <symbol id="txp_svg_pause" viewBox="'+pcViewBox+'">\n        <path d="M9 5a1.5 1.5 0 0 1 1.5 1.5v15A1.5 1.5 0 0 1 9 23h-.5A1.5 1.5 0 0 1 7 21.5v-15A1.5 1.5 0 0 1 8.5 5H9Zm10.5 0A1.5 1.5 0 0 1 21 6.5v15a1.5 1.5 0 0 1-1.5 1.5H19a1.5 1.5 0 0 1-1.5-1.5v-15A1.5 1.5 0 0 1 19 5h.5Z" fill-rule="evenodd"/>\n    </symbol>\n    <symbol id="txp_svg_stop" viewBox="'+pcViewBox+'">\n      <rect x="5" y="5" width="18" height="18" rx="4" fill-rule="evenodd"/>\n    </symbol>\n\n    <symbol id="txp_svg_fake" viewBox="'+pcViewBox+'">\n        <rect fill="none" stroke-width="1.75" transform="translate(0 3.5)" x="5.25" y="3.5" width="17.5" height="14" rx="2.042"/>\n    </symbol>\n\n    <symbol id="txp_svg_loop_off" viewBox="'+pcViewBox+'">\n        <g fill-rule="evenodd"><path d="M16.859 14.22c2.738 0 4.958 2.164 4.958 4.834 0 2.67-2.22 4.834-4.958 4.834-2.739 0-4.959-2.164-4.959-4.834 0-2.67 2.22-4.835 4.959-4.835Zm0 .966c-2.19 0-3.967 1.732-3.967 3.868s1.776 3.867 3.967 3.867c2.19 0 3.967-1.731 3.967-3.867s-1.776-3.868-3.967-3.868Zm-1.206 2.02.069.056 2.975 2.9a.475.475 0 0 1 0 .684.506.506 0 0 1-.633.056l-.068-.056-2.975-2.9a.475.475 0 0 1 0-.684.506.506 0 0 1 .632-.056ZM12.591 4.9a.69.69 0 0 1 .456.171l3.812 3.346H11.9v-.001H8.925c-1.584 0-2.88 1.208-2.97 2.731l-.005.17v3.868c0 1.545 1.239 2.808 2.8 2.896l.175.005.992-.001v1.934h-.992c-2.664 0-4.838-2.048-4.953-4.619l-.005-.215v-3.868c0-2.597 2.101-4.717 4.737-4.83l.221-.004H11.9v-.892c0-.382.31-.691.691-.691Zm7.243 1.68c2.19.433 3.856 2.274 3.961 4.512l.006.225v3.868c0 .432-.058.85-.167 1.248l-1.817-2.215v-2.9c0-1.263-.827-2.338-1.982-2.736V6.581Z" fill-rule="nonzero"/></g>\n    </symbol>\n    <symbol id="txp_svg_loop" viewBox="'+pcViewBox+'">\n        <g fill-rule="evenodd"><path d="M9 8.877a3 3 0 0 0-2.995 2.824L6 11.877v4a3 3 0 0 0 2.824 2.995l.176.005a1 1 0 1 1 0 2 5 5 0 0 1-4.995-4.783L4 15.877v-4a5 5 0 0 1 4.783-4.995L9 6.877h3V5.5a.5.5 0 0 1 .834-.372L17 8.878H9Zm11 10a3 3 0 0 0 2.995-2.823l.005-.177v-4a3 3 0 0 0-2.824-2.995L20 8.877a1 1 0 0 1 0-2 5 5 0 0 1 4.995 4.783l.005.217v4a5 5 0 0 1-4.783 4.996l-.217.004h-3v1.378a.5.5 0 0 1-.834.371L12 18.877h8Z" fill-rule="nonzero"/></g>\n    </symbol>\n\n    <symbol id="txp_svg_next" viewBox="'+pcViewBox+'">\n        <path d="M21.5 7A1.5 1.5 0 0 1 23 8.5v11a1.5 1.5 0 0 1-3 0v-11A1.5 1.5 0 0 1 21.5 7Zm-16.261.822a.817.817 0 0 1 1.186-.732s1.835.378 6.266 2.636c4.481 2.282 5.855 3.54 5.855 3.54a.825.825 0 0 1 0 1.467s-.839.936-5.857 3.46c-5.017 2.522-6.264 2.715-6.264 2.715a.817.817 0 0 1-1.186-.732S5 19.498 5 13.97v-.326c.01-5.226.239-5.823.239-5.823Z" fill-rule="evenodd"/>\n    </symbol>\n\n    <symbol id="txp_svg_fullscreen" viewBox="'+pcViewBox+'">   \n        <path d="M7.438 17.063v2.625c0 .483.391.875.875.875h2.624m0-13.125H8.312a.875.875 0 0 0-.875.875v2.624h0m13.126 6.126v2.625a.875.875 0 0 1-.875.875h-2.625 0m0-13.125h2.625c.483 0 .875.391.875.874v2.625h0" stroke-width="2.188" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"/>\n    </symbol>\n    <symbol id="txp_svg_fullscreen_true" viewBox="'+pcViewBox+'">\n        <g stroke-width="2.188" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"><path d="M10.938 20.563v-2.625a.875.875 0 0 0-.875-.875H7.438h0M7.438 10.938h2.625a.875.875 0 0 0 .874-.876V7.438h0M17.063 20.562v-2.625c0-.483.391-.875.875-.875h2.625M20.563 10.938h-2.625a.875.875 0 0 1-.875-.876V7.438h0"/></g>\n    </symbol>\n\n    <symbol id="txp_svg_volume_mute" viewBox="'+pcViewBox+'">\n        <g stroke-width="2" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"><path d="M8.75 10.041H5.749c-.828 0-1.499.671-1.499 1.499v4.92c0 .828.671 1.499 1.499 1.499H8.75l4.143 4.143a.502.502 0 0 0 .857-.355V6.253a.502.502 0 0 0-.857-.355L8.75 10.041ZM17.5 11l6 6M23.5 11l-6 6"/></g>\n    </symbol>\n    <symbol id="txp_svg_volume" viewBox="'+pcViewBox+'">\n        <g stroke-width="2" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"><path d="M8.75 10.041H5.749c-.828 0-1.499.671-1.499 1.499v4.92c0 .828.671 1.499 1.499 1.499H8.75l4.143 4.143a.502.502 0 0 0 .857-.355V6.253a.502.502 0 0 0-.857-.355L8.75 10.041ZM20.786 7a9.717 9.717 0 0 1 2.964 7 9.717 9.717 0 0 1-2.964 7M17.75 9.477c1.235 1.154 2 2.753 2 4.522 0 1.746-.747 3.328-1.955 4.478"/></g>\n    </symbol>\n\n    <symbol id="txp_svg_pip" viewBox="'+pcViewBox+'">\n        <path d="M23.625 15.75c.966 0 1.75.784 1.75 1.75v4.375a1.75 1.75 0 0 1-1.75 1.75H17.5a1.75 1.75 0 0 1-1.75-1.75V17.5c0-.966.784-1.75 1.75-1.75h6.125ZM21 5.25a2.625 2.625 0 0 1 2.62 2.47l.005.155v5.25a.875.875 0 0 1-1.744.102l-.006-.102v-5.25a.875.875 0 0 0-.773-.87L21 7H7a.875.875 0 0 0-.87.773l-.005.102V19.25c0 .449.338.819.773.87l.102.005h6.125a.875.875 0 0 1 .102 1.744l-.102.006H7a2.625 2.625 0 0 1-2.62-2.47l-.005-.155V7.875a2.625 2.625 0 0 1 2.47-2.62L7 5.25h14Z" stroke-width=".5" fill-rule="evenodd"/>\n    </symbol>\n\n    <symbol id="txp_air_play" viewBox="0 0 1024 1024">\n        <path d="M547.413333 573.866667a42.666667 42.666667 0 0 0-70.826666 0l-170.666667 256a42.666667 42.666667 0 0 0 0 42.666666A42.666667 42.666667 0 0 0 341.333333 896h341.333334a42.666667 42.666667 0 0 0 37.546666-22.613333 42.666667 42.666667 0 0 0-2.133333-42.666667zM421.12 810.666667L512 674.133333l90.88 136.533334zM810.666667 128H213.333333a128 128 0 0 0-128 128v384a128 128 0 0 0 128 128h36.266667a42.666667 42.666667 0 1 0 0-85.333333H213.333333a42.666667 42.666667 0 0 1-42.666666-42.666667V256a42.666667 42.666667 0 0 1 42.666666-42.666667h597.333334a42.666667 42.666667 0 0 1 42.666666 42.666667v384a42.666667 42.666667 0 0 1-42.666666 42.666667h-36.266667a42.666667 42.666667 0 0 0 0 85.333333H810.666667a128 128 0 0 0 128-128V256a128 128 0 0 0-128-128z"/>\n    </symbol>\n</svg>\n',h5SvgSprite='\n<svg class="'+THUMBPLAYER_PREFIX+" "+svgSpriteClassName+'" display="none" xmlns="http://www.w3.org/2000/svg">\n\t<symbol id="txp_svg_play" viewBox="0 0 56 56">\n\t\t<path d="M14.569 13.867s-.563 1.42-.563 14.059.563 14.188.563 14.188a1.925 1.925 0 0 0 2.8 1.677s2.938-.442 14.763-6.211 13.8-7.914 13.8-7.914a1.859 1.859 0 0 0 0-3.352s-3.24-2.875-13.8-8.095c-10.444-5.165-14.767-6.029-14.767-6.029a1.924 1.924 0 0 0-2.796 1.677z" style="fill:#fff" />\n\t</symbol>\n    <symbol id="txp_svg_replay" viewBox="0 0 32 32">\n      <path d="M18 30a13.956 13.956 0 0 1-9.9-4.1l2.121-2.121A11 11 0 1 0 7 16h4.006L5.5 22 0 16h4a14 14 0 1 1 14 14z">\n      </path>\n    </symbol>\n    <symbol id="txp_svg_pause" viewBox="0 0 56 56">\n      <path d="M39 49a4 4 0 0 1-4-4V11a4 4 0 0 1 4-4 4 4 0 0 1 4 4v34a4 4 0 0 1-4 4zm-22 0a4 4 0 0 1-4-4V11a4 4 0 0 1 4-4 4 4 0 0 1 4 4v34a4 4 0 0 1-4 4z">\n      </path>\n    </symbol>\n    <symbol id="txp_svg_stop" viewBox="0 0 32 32">\n      <path d="M24 26H12c-1.1 0-2-0.9-2-2V12c0-1.1 0.9-2 2-2h12c1.1 0 2 0.9 2 2v12C26 25.1 25.1 26 24 26z"></path>\n    </symbol>\n\n\t<symbol id="txp_svg_fullscreen" viewBox="0 0 48 48">\n\t\t<path d="M9.5 37h10a1.5 1.5 0 0 1 0 3h-10a1.5 1.5 0 0 1 0-3zm0-10a1.5 1.5 0 0 1 1.5 1.5v10a1.5 1.5 0 0 1-3 0v-10A1.5 1.5 0 0 1 9.5 27zM8.43 37.353L19.353 26.43a1.545 1.545 0 1 1 2.185 2.184L10.614 39.538a1.545 1.545 0 1 1-2.184-2.185zM28.5 8h10a1.5 1.5 0 0 1 0 3h-10a1.5 1.5 0 0 1 0-3zm10 0A1.5 1.5 0 0 1 40 9.5v10a1.5 1.5 0 0 1-3 0v-10A1.5 1.5 0 0 1 38.5 8zM26.43 19.354L37.353 8.43a1.545 1.545 0 0 1 2.185 2.184L28.614 21.538a1.545 1.545 0 0 1-2.184-2.184z"/>\n\t</symbol>\n\t<symbol id="txp_svg_fullscreen_true" viewBox="0 0 48 48">\n\t\t<path d="M39.538 10.615L31.153 19H37.5a1.5 1.5 0 0 1 0 3h-10a1.5 1.5 0 0 1-1.386-.937 1.52 1.52 0 0 1-.114-.735V10.5a1.5 1.5 0 0 1 3 0v6.283l8.353-8.353a1.545 1.545 0 1 1 2.185 2.185zM20.5 39a1.5 1.5 0 0 1-1.5-1.5v-6.347l-8.386 8.385a1.545 1.545 0 1 1-2.184-2.184L16.783 29H10.5a1.5 1.5 0 0 1 0-3h9.828a1.518 1.518 0 0 1 .733.113A1.5 1.5 0 0 1 22 27.5v10a1.5 1.5 0 0 1-1.5 1.5z"/>\n\t</symbol>\n\t<symbol id="txp_svg_pause" viewBox="0 0 56 56">\n\t\t<path d="M39 49a4 4 0 0 1-4-4V11a4 4 0 0 1 4-4 4 4 0 0 1 4 4v34a4 4 0 0 1-4 4zm-22 0a4 4 0 0 1-4-4V11a4 4 0 0 1 4-4 4 4 0 0 1 4 4v34a4 4 0 0 1-4 4z"/>\n\t</symbol>\n\t<symbol id="txp_svg_replay" viewBox="0 0 32 32">\n\t\t<path d="M18 30a13.956 13.956 0 0 1-9.9-4.1l2.121-2.121A11 11 0 1 0 7 16h4.006L5.5 22 0 16h4a14 14 0 1 1 14 14z"/>\n\t</symbol>\n\t<symbol id="txp_svg_next" viewBox="0 0 60 60">\n\t\t<path d="M47.13825,15.0141429 C45.3628929,15.0141429 43.9239643,16.4530714 43.9239643,18.2284286 L43.9239643,41.7998571 C43.9239643,43.5752143 45.3628929,45.0141429 47.13825,45.0141429 C48.9136071,45.0141429 50.3525357,43.5752143 50.3525357,41.7998571 L50.3525357,18.2284286 C50.3525357,16.4530714 48.9136071,15.0141429 47.13825,15.0141429 M39.7389643,28.4327143 C39.7389643,28.4327143 36.7936071,25.737 27.1946786,20.8437857 C17.6986071,16.002 13.7686071,15.192 13.7686071,15.192 C12.6050357,14.5995 11.2261071,15.4502143 11.2261071,16.7637857 C11.2261071,16.7637857 10.7139643,18.0955714 10.7139643,29.9455714 C10.7139643,41.7945 11.2261071,43.2462857 11.2261071,43.2462857 C11.2261071,44.5598571 12.6050357,45.4116429 13.7686071,44.8180714 C13.7686071,44.8180714 16.4396786,44.4034286 27.1893214,38.9948571 C37.9411071,33.5852143 39.7389643,31.5762857 39.7389643,31.5762857 C41.0171786,30.9248571 41.0171786,29.0852143 39.7389643,28.4327143" id="Fill-1"></path>\n\t</symbol>\n</svg>\n',getDomText=function(e){return'\n<div class="'+gradientClassName$1.slice(1)+'"></div>\n<div class="'+getRootClassName$1(e).slice(1)+'">\n    <div class="'+THUMBPLAYER_PREFIX+" "+ctrlBarClassName+'">\n        <div class="txp_left_controls">\n            <div class="txp_none txp_btn txp_btn_play" data-status="play" aria-label="播放/暂停">\n                <svg class="txp_icon txp_icon_play" viewBox="'+pcViewBox+'">\n                    <use class="txp_svg_symbol txp_svg_play" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#txp_svg_play"></use>\n                    <use class="txp_svg_symbol txp_svg_pause" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#txp_svg_pause"></use>\n                    <use class="txp_svg_symbol txp_svg_stop" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#txp_svg_stop"></use>\n                    <use class="txp_svg_symbol txp_svg_replay" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#txp_svg_replay"></use>\n                </svg>\n                <div class="txp_tooltip">播放</div>\n            </div>\n            <div class="txp_none txp_btn txp_btn_next txp_disabled" aria-label="下一个">\n                <svg class="txp_icon txp_icon_next" viewBox="'+pcViewBox+'">\n                    <use class="txp_svg_symbol txp_svg_next" xlink:href="#txp_svg_next"></use>\n                </svg>\n                <div class="txp_tooltip">下一个</div>\n            </div>\n            <div class="txp_btn txp_btn_loop txp_none" data-status="false" aria-label="循环播放">   \n                <svg data-role="txp-ui-control-loop-play-btn" class="txp_icon txp_icon_loop" viewBox="'+pcViewBox+'">\n                    <use class="txp_svg_symbol txp_svg_loop" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#txp_svg_loop"></use>\n                    <use class="txp_svg_symbol txp_svg_loop_off" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#txp_svg_loop_off"></use>\n                </svg>\n                <div class="txp_tooltip">打开循环播放</div> \n            </div>\n\n            <div class="txp_btn txp_btn_volume txp_none" data-status="normal" aria-label="音量">     \n                <svg class="txp_icon txp_icon_volume" viewBox="'+pcViewBox+'">         \n                    <use class="txp_svg_symbol txp_svg_volume" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#txp_svg_volume"></use> \n                    <use class="txp_svg_symbol txp_svg_volume_mute" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#txp_svg_volume_mute"></use>     \n                </svg>      \n                <div class="txp_popup txp_popup_volume txp_none">\n                    <div class="txp_popup_content">             \n                        <div class="txp_volume_text">100</div>     \n                        <div class="txp_volume_range">                 \n                            <div class="txp_volume_range_current" style="height: 100%;">                     \n                                <div class="txp_volume_handle"></div>                 \n                            </div>             \n                        </div>\n                    </div>\n                </div>\n            </div>  \n\n            <div class="txp_none txp_time_display">\n                <div class="txp_time_current">00:00</div>\n                <div class="txp_time_separator">/</div>\n                <div class="txp_time_duration">00:00</div>\n            </div>\n        </div>\n\n        <div class="txp_none txp_progress_bar_container">\n            <div class="txp_progress_list">\n                <div class="txp_progress_load" style="width: 0;"></div>\n                <div class="txp_progress_play" style="width: 0;">\n                </div>\n                <div class="txp_btn_scrubber" style="left: 0">\n                    <div class="txp_scrubber_indicator"></div>\n                </div>\n            </div>\n            <div class="txp_tooltip txp_none"></div>\n            \x3c!-- 进度条标记打点 --\x3e\n            <div class="txp_hotpoint"></div> \n        </div>\n\n        <div class="txp_center_controls"></div>\n\n        <div class="txp_right_controls">\n            <div class="txp_btn txp_btn_definition txp_none" aria-label="清晰度">\n                <div class="txp_label">清晰度</div>\n                <div class="txp_popup txp_popup_definition txp_none">\n                    <div class="txp_popup_content"></div>\n                </div>\n            </div>\n\n            <div class="txp_btn txp_btn_playrate txp_none" aria-label="倍速">\n                <div class="txp_label">倍速</div>\n                <div class="txp_popup txp_popup_playrate txp_none">\n                    <div class="txp_popup_content"></div>\n                </div>\n            </div>\n\n            <div class="txp_btn txp_btn_language txp_none" aria-label="语言">\n                <div class="txp_label">语言</div>\n                <div class="txp_popup txp_popup_language txp_none">\n                    <div class="txp_popup_content"></div>\n                </div>\n            </div>\n\n            <div class="txp_btn txp_btn_audio_track txp_none" aria-label="多音轨">\n                <div class="txp_label">多音轨</div>\n                <div class="txp_popup txp_popup_audio_track txp_none">\n                    <div class="txp_popup_content"></div>\n                </div>\n            </div>\n            \n            <div class="txp_btn plugin_ctrl_airplay_btn txp_air_play txp_none" aria-label="AirPlay">\n                <svg class="txp_icon txp_icon_airplay" viewBox="0 0 1024 1024">\n                    <use class="txp_svg_symbol" xlink:href="#txp_air_play"></use>\n                </svg>\n                <div class="txp_tooltip">AirPlay</div> \n            </div>\n\n            <div class="txp_btn txp_btn_pip txp_none" data-status="false" aria-label="画中画">   \n                <svg class="txp_icon txp_icon_pip" viewBox="'+pcViewBox+'">     \n                    <use class="txp_svg_symbol txp_svg_pip" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#txp_svg_pip"></use>   \n                </svg>  \n                <div class="txp_tooltip">画中画</div> \n            </div>\n\n            <div class="txp_btn txp_btn_fake txp_none" data-status="false" aria-label="网页全屏">   \n                <svg class="txp_icon txp_icon_fake" viewBox="'+pcViewBox+'">     \n                    <use class="txp_svg_symbol txp_svg_fake" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#txp_svg_fake"></use>   \n                    <use class="txp_svg_symbol txp_svg_fake_true" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#txp_svg_fake"></use>  \n                </svg>  \n                <div class="txp_tooltip">网页全屏</div> \n            </div>\n\n            <div class="txp_btn txp_btn_fullscreen txp_none" data-status="false" aria-label="系统全屏">\n                <svg class="txp_icon txp_icon_fullscreen" viewBox="'+pcViewBox+'">     \n                    <use class="txp_svg_symbol txp_svg_fullscreen" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#txp_svg_fullscreen"></use>     \n                    <use class="txp_svg_symbol txp_svg_fullscreen_true" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#txp_svg_fullscreen_true"></use>   \n                </svg>\n                <div class="txp_tooltip">全屏</div>\n            </div>\n        </div>\n    </div>\n</div>\n\n<div class="'+shadowClassName$1.slice(1)+'"></div>\n'},h5CtrlRightDomText='\n<button class="txp_btn txp_btn_playrate txp_none" aria-label="倍速">\n    <div class="txp_label">倍速</div>\n</button>\n<button class="txp_btn txp_btn_definition txp_none" data-status="false" aria-label="清晰度">\n    <div class="txp_label">清晰度</div>\n</button>\n<button class="txp_btn txp_btn_fullscreen txp_none" data-status="false" aria-label="全屏">\n    <svg class="txp_icon txp_icon_fullscreen" viewBox="0 0 24 24">\n        <use class="txp_svg_fullscreen" xlink:href="#txp_svg_fullscreen"></use>     \n        <use class="txp_svg_fullscreen_true" xlink:href="#txp_svg_fullscreen_true"></use>   \n    </svg>\n</button>\n<button class="txp_btn txp_btn_fullscreen txp_none txp_btn_fake" data-status="false" aria-label="伪全屏">\n    <svg class="txp_icon txp_icon_fullscreen" viewBox="0 0 24 24">\n        <use class="txp_svg_fullscreen" xlink:href="#txp_svg_fullscreen"></use>     \n        <use class="txp_svg_fullscreen_true" xlink:href="#txp_svg_fullscreen_true"></use>   \n    </svg>\n</button>\n',h5OverlayText='<div class="plugin_ctrl_mod_overlay_wrapper">\n<div class="mod_overlay definition txp_none">\n    <div class="mod_speed_select">\n        <div class="title">画质</div>\n        <ul class="select_list"></ul>\n    </div>\n</div>\n<div class="mod_overlay language txp_none">\n    <div class="mod_speed_select">\n        <div class="title">语言</div>\n        <ul class="select_list"></ul>\n    </div>\n</div>\n<div class="mod_overlay playrate txp_none">\n    <div class="mod_speed_select">\n        <div class="title">播放速度</div>\n        <ul class="select_list"></ul>\n    </div>\n</div>\n</div>\n',DEFAULT_AUTO_HIDE_DELAY=3e3,CtrlShow=function(e){function t(t,o,r){var n,i=e.call(this,t,getRootClassName$1(o.isMobile),o)||this;i.ctrlbar=r,i.isMouseHoverControl=!1,i.isMouseDown=!1,i.shadowClickDisabled=!1,i.onShadowClick=function(e){if(e.target===i.shadow&&(i.clearClickTimer(),!i.shadowClickDisabled)){i.clickTimer=window.setTimeout((function(){var e=i.player;e.state===exports.VIDEO_STATE.PLAYING?e.pause(exports.H5_PAUSE_TYPE.USER_CLICK):onBtnClickPlay(e,i.ctrlbar)}),300)}},i.clearClickTimer=function(){i.clickTimer&&(clearTimeout(i.clickTimer),i.clickTimer=null)},i.clearHideTimer=function(){i.hideTid&&(clearTimeout(i.hideTid),i.hideTid=null)},i.clearTouchTimer=function(){i.touchTid&&(clearTimeout(i.touchTid),i.touchTid=null)},i.hideDelay=o.autoHideDelay||DEFAULT_AUTO_HIDE_DELAY,i.show=i.show.bind(i),i.hide=i.hide.bind(i),i.onFullscreenChange=i.onFullscreenChange.bind(i),i.eventMap=((n={})[exports.PLAY_EVENT.STATE_CHANGE]=i.onPlayerStateChange.bind(i),n[exports.PLAY_EVENT.VIDEONODE_START_PLAY]=i.onStartPlay.bind(i),n),i.setEvts(),i.control=t.container.querySelector(ctrlBarSelector),i.shadow=t.container.querySelector(shadowClassName$1),i.gradientBottom=t.container.querySelector(gradientClassName$1),r.on(CTRL_EVENTS$2.FULLSCREEN_CHANGE,i.onFullscreenChange),r.on(CTRL_EVENTS$2.FAKE_FULLSCREEN_CHANGE,i.onFullscreenChange);var a=o.showCtrlShadow;return void 0===a||a||(i.shadow.remove(),i.shadow=null),i.addEventListener(),i.isMobile&&i.toggleControlOnClick(),i}return __extends$1(t,e),Object.defineProperty(t.prototype,"isShow",{get:function(){return!this.el.classList.contains(Component.hideClassName)},enumerable:!1,configurable:!0}),t.prototype.show=function(){this.autoHide(),this.isShow||(this.showEl(),this.showEl(this.gradientBottom),this.ctrlbar.emit(CTRL_EVENTS$2.SHOW))},t.prototype.hide=function(e){this.isShow&&(e||!this.isMouseHoverControl&&this.player.state!==exports.VIDEO_STATE.PAUSE)&&(this.hideEl(),this.hideEl(this.gradientBottom),this.ctrlbar.emit(CTRL_EVENTS$2.HIDE))},t.prototype.autohide=function(){this.autoHide()},t.prototype.autoHide=function(){this.clearHideTimer(),this.hideDelay!==1/0&&(this.hideTid=window.setTimeout(this.hide,this.hideDelay))},t.prototype.destroy=function(){this.clearHideTimer(),this.clearClickTimer(),this.clearTouchTimer(),e.prototype.destroy.call(this)},t.prototype.toggleShadowClickDisabled=function(e){this.shadowClickDisabled=e},t.prototype.addEventListener=function(){var e=this,t=this,o=t.ctrlbar,r=t.player,n=t.shadow,i=r.container;this.isMobile?(o.on(CTRL_EVENTS$2.TOGGLE_OVERLAY,(function(t){var o=t.data;e.isMouseHoverControl=o,o||e.autoHide()})),o.on(CTRL_EVENTS$2.MOUSE_DOWN,(function(){return e.isMouseHoverControl=!0})),o.on(CTRL_EVENTS$2.MOUSE_UP,(function(){e.autoHide(),e.isMouseHoverControl=!1}))):(this.control.addEventListener("mouseenter",(function(){return e.isMouseHoverControl=!0})),this.control.addEventListener("mouseleave",(function(){return e.isMouseHoverControl=!1})),o.on(CTRL_EVENTS$2.MOUSE_DOWN,(function(){return e.isMouseDown=!0})),o.on(CTRL_EVENTS$2.MOUSE_UP,(function(){return e.isMouseDown=!1})),i.addEventListener("mouseenter",this.show),i.addEventListener("mousemove",this.show),i.addEventListener("mouseleave",(function(){e.isMouseDown||e.hide()})),!this.isLive&&n&&(n.addEventListener("click",this.onShadowClick),n.addEventListener("dblclick",this.clearClickTimer)))},t.prototype.toggleControlOnClick=function(){var e,t=this;null===(e=this.shadow)||void 0===e||e.addEventListener("click",(function(){t.isShow?t.hide():t.show()}))},t.prototype.onFullscreenChange=function(){this.isMouseHoverControl=!1,this.hide()},t.prototype.onPlayerStateChange=function(e){var t=e.data.new;-1!==[exports.VIDEO_STATE.PAUSE,exports.VIDEO_STATE.END,exports.VIDEO_STATE.IDLE].indexOf(t)?this.show():t===exports.VIDEO_STATE.PLAYING&&this.autoHide()},t.prototype.onStartPlay=function(){this.autoHide()},t.compName="CtrlShow",t}(Component),HotKeyCode;!function(e){e.ArrowLeft="ArrowLeft",e.ArrowRight="ArrowRight",e.ArrowUp="ArrowUp",e.ArrowDown="ArrowDown",e.Space=" ",e.Escape="Escape",e.LEFT_SQUARE_BRACKET="[",e.LEFT_SQUARE_BRACKET_CN="【",e.RIGHT_SQUARE_BRACKET="]",e.RIGHT_SQUARE_BRACKET_CN="】"}(HotKeyCode||(HotKeyCode={}));var defaultSeekGap=5,defaultBackwardGap=2,defaultActivePressTime=.5,defaultBackwardTimeout=500,liveHotKeys=[HotKeyCode.ArrowUp,HotKeyCode.ArrowDown,HotKeyCode.Escape],volumeGap=.05,HotKeys=function(){function e(e,t,o){var r,n=this;this.player=e,this.config=t,this.comps=o,this.isDisabled=!1,this.spyKeyUpOnBody=function(e){n.isEvtKeyInConfig(e)&&n.spyKeyUp(e)},this.spyKeyDownOnBody=function(e){n.isEvtKeyInConfig(e)&&n.spyKeyDown(e)},this.fastBackwardHandler=function(){var e=n.player,t=e.duration;n.backwardPlaytime=e.playtime;var o=function(){n.backwardPlaytime=Math.max(0,n.backwardPlaytime-defaultBackwardGap),n.comps.progress.updateProgress(n.backwardPlaytime/t),e.seek(n.backwardPlaytime),showTips(e,"快退至 "+comTool.formatPlayTime(n.backwardPlaytime))};n.backwardTimer=setInterval(o,defaultBackwardTimeout),o()},this.fastForwardHandler=function(){var e=n.config.pressFastForwardRate,t=void 0===e?3:e,o=n.comps.playRate,r=(o||{}).selected;if(r&&!(t<=r)){var i={label:t+"X",value:t};n.player.play(),n.lastPlaybackRate=o.selected,n.player.playbackRate=t,showTips(n.player,"正在 <em>"+i.value+"</em> 倍播放中"),setTimeout((function(){o.setCurrent(i)}),0)}},this.spyKeyUp=this.spyKeyUp.bind(this),this.spyKeyDown=this.spyKeyDown.bind(this);var i=e.container;uaTool.mobile||(i.tabIndex=-1),i.addEventListener("keyup",this.spyKeyUp),i.addEventListener("keydown",this.spyKeyDown),(null===(r=this.config.keysListenedOnBody)||void 0===r?void 0:r.length)&&(document.body.addEventListener("keyup",this.spyKeyUpOnBody),document.body.addEventListener("keydown",this.spyKeyDownOnBody))}return e.prototype.destroy=function(){var e;if(this.player){var t=this.player.container;this.cancelPressState(),t.removeEventListener("keyup",this.spyKeyUp),t.removeEventListener("keydown",this.spyKeyDown),(null===(e=this.config.keysListenedOnBody)||void 0===e?void 0:e.length)&&(document.body.removeEventListener("keyup",this.spyKeyUpOnBody),document.body.removeEventListener("keydown",this.spyKeyDownOnBody)),this.player=null}},e.prototype.isEvtKeyInConfig=function(e){return this.config.keysListenedOnBody.includes(e.key)&&e.target===document.body},e.prototype.prevent=function(e){var t,o;null===(t=e.preventDefault)||void 0===t||t.call(e),null===(o=e.stopPropagation)||void 0===o||o.call(e)},e.prototype.spyKeyUp=function(e){var t;if(!e.shiftKey&&!this.isDisabled){var o=e.key,r=this.player,n=r.state,i=this.config.seekGap,a=void 0===i?defaultSeekGap:i;if(this.pressKey)o===this.pressKey&&this.cancelPressState();else if(!this.isLive()||liveHotKeys.includes(o))switch(o){case HotKeyCode.ArrowLeft:r.setStateKv("ctrlbar:hotkey:"+o,{type:exports.LOG_TYPE.USER_ACTION}),r.seek(r.playtime-a),this.prevent(e),this.showSeekLeftTips();break;case HotKeyCode.ArrowRight:r.setStateKv("ctrlbar:hotkey:"+o,{type:exports.LOG_TYPE.USER_ACTION}),r.seek(r.playtime+a),this.prevent(e),this.showSeekRightTips();break;case HotKeyCode.Space:r.setStateKv("ctrlbar:hotkey:space",{type:exports.LOG_TYPE.USER_ACTION}),n===exports.VIDEO_STATE.PLAYING||n===exports.VIDEO_STATE.BUFFERING?r.pause(exports.H5_PAUSE_TYPE.USER_CLICK):r.play(),this.prevent(e);break;case HotKeyCode.Escape:(null===(t=this.comps.fakeFullscreen)||void 0===t?void 0:t.isFullScreen)&&(this.comps.fakeFullscreen.requestFullScreen("exit"),this.prevent(e));break;case HotKeyCode.LEFT_SQUARE_BRACKET:case HotKeyCode.LEFT_SQUARE_BRACKET_CN:this.setNextPlayBackRate(!0),this.prevent(e);break;case HotKeyCode.RIGHT_SQUARE_BRACKET:case HotKeyCode.RIGHT_SQUARE_BRACKET_CN:this.setNextPlayBackRate(!1),this.prevent(e)}}},e.prototype.setNextPlayBackRate=function(e){void 0===e&&(e=!1);var t=this.comps.playRate,o=t.popupOptions,r=t.selected,n=o.findIndex((function(e){return e.value===r}));if(-1!==n&&!(e&&0===n||!e&&n===o.length-1)){var i=Number(o[e?n-1:n+1].value);this.player.playbackRate=i,showTips(this.player,"正在 <em>"+i+"</em> 倍速播放中")}},e.prototype.enterPressMode=function(e){var t=this;if(!this.pressKey){var o=this.config,r=o.pressFastBackwardGap,n=void 0===r?defaultActivePressTime:r,i=o.pressFastForwardGap,a=e?void 0===i?defaultActivePressTime:i:n,s=e?this.fastForwardHandler:this.fastBackwardHandler;a&&(clearTimeout(this.pressTimer),this.pressTimer=setTimeout((function(){var e=t.player.state;[exports.VIDEO_STATE.PAUSE,exports.VIDEO_STATE.PLAYING].includes(e)&&s()}),1e3*a))}},e.prototype.cancelPressState=function(){var e=this.comps.playRate;e&&this.lastPlaybackRate&&(e.selected=this.lastPlaybackRate,this.player.playbackRate=this.lastPlaybackRate),hideTips(this.player),this.lastPlaybackRate=NaN,this.pressKey=null,this.backwardPlaytime=NaN,this.pressKey=null,clearTimeout(this.backwardTimer),clearTimeout(this.pressTimer)},e.prototype.spyKeyDown=function(e){if(e.shiftKey||this.isDisabled||this.pressKey)this.prevent(e);else{var t=e.key,o=e.repeat,r=this.player;if(!this.isLive()||liveHotKeys.includes(t))switch(t){case HotKeyCode.ArrowUp:r.volume=this.volumeToFixedNumber(r.volume+volumeGap),this.prevent(e),this.showVolumeTips();break;case HotKeyCode.ArrowDown:r.volume=this.volumeToFixedNumber(r.volume-volumeGap),this.prevent(e),this.showVolumeTips();break;case HotKeyCode.Space:this.prevent(e);break;case HotKeyCode.ArrowLeft:case HotKeyCode.ArrowRight:this.prevent(e),o&&(this.enterPressMode(t===HotKeyCode.ArrowRight),this.pressKey=t)}}},e.prototype.isLive=function(){return this.config.mode===exports.PLAY_MODE.LIVE},e.prototype.volumeToFixedNumber=function(e){var t=Math.max(Math.min(e,1),0);return t=Number(t.toFixed(2)),lsTool.setData(LOCAL_KEY.VOLUME,t),t},e.prototype.showSeekLeftTips=function(){if(this.player.state!==exports.VIDEO_STATE.IDLE){var e=this.config.seekGap,t=void 0===e?defaultSeekGap:e,o=Math.max(0,this.player.playtime-t);showTips(this.player,"快退至 "+comTool.formatPlayTime(o))}},e.prototype.showSeekRightTips=function(){if(this.player.state!==exports.VIDEO_STATE.IDLE){var e=this.player,t=e.playtime,o=e.duration,r=this.config.seekGap,n=void 0===r?defaultSeekGap:r,i=Math.min(t+n,o);showTips(this.player,"快进至 "+comTool.formatPlayTime(i))}},e.prototype.showVolumeTips=function(){var e;(null===(e=this.comps.volume)||void 0===e?void 0:e.popup.classList.contains(Component.hideClassName))&&showTips(this.player,"当前音量: <em>"+(100*this.player.volume).toFixed(0)+"</em>")},e.compName="HotKeys",e}(),componentMap={PlayBtn:PlayBtn,NextBtn:NextBtn,TimeArea:TimeArea,Progress:Progress,Fullscreen:Fullscreen,FakeFullscreen:FakeFullscreen,Volume:Volume,CtrlShow:CtrlShow,HotPoint:HotPoint,Loop:Loop,PictureInPicture:PictureInPicture,LiveProgress:LiveProgress,CenterBtn:CenterBtn,DefinitionPopup:DefinitionPopup,PlayratePopup:PlayratePopup,LanguagePopup:LanguagePopup,AudioTrackPopup:AudioTrackPopup},CtrlbarPlugin=function(e){function t(t,o,r){var n,i,a,s,l,c,p=e.call(this,t,o,r)||this;p.instances={},p.isInRequest=!1,p.hasCustomPlayBackRate=!1,p.config=__assign$2(__assign$2({},t.config.ctrlConfig),o);var d=uaTool.mobile;return null!==(n=(s=p.config).mode)&&void 0!==n||(s.mode=p.player.config.type),null!==(i=(l=p.config).isMobile)&&void 0!==i||(l.isMobile=d),null!==(a=(c=p.config).showCenterPlayBtn)&&void 0!==a||(c.showCenterPlayBtn=d),p.setMaxListeners(20),p.insertDom(),p.createSubComponents(r),p.setupResizeEvent(),p.setPluginEvts(!0),adaptMobileAdPlugin(p,t),p.config.isMobile&&p.hide(!0),p.config.uiDuration&&(p.duration=p.config.uiDuration),p}return __extends$1(t,e),Object.defineProperty(t.prototype,"duration",{get:function(){var e;return null!==(e=this.uiDuration)&&void 0!==e?e:this.player.duration},set:function(e){isNaN(e)&&void 0!==e||(this.uiDuration=e,this.instances[TimeArea.compName]&&(this.instances[TimeArea.compName].timeDur.innerText=comTool.formatPlayTime(e)))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"audio",{get:function(){var e;return null===(e=this.instances[AudioTrackPopup.compName])||void 0===e?void 0:e.selected},set:function(e){this.instances[AudioTrackPopup.compName]&&(this.instances[AudioTrackPopup.compName].selected=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"audioOpts",{get:function(){var e;return null===(e=this.instances[AudioTrackPopup.compName])||void 0===e?void 0:e.popupOptions},set:function(e){this.instances[AudioTrackPopup.compName]&&(this.instances[AudioTrackPopup.compName].popupOptions=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"level",{get:function(){var e;return null===(e=this.instances[DefinitionPopup.compName])||void 0===e?void 0:e.selected},set:function(e){this.instances[DefinitionPopup.compName]&&(this.instances[DefinitionPopup.compName].selected=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"levelOpts",{get:function(){var e;return null===(e=this.instances[DefinitionPopup.compName])||void 0===e?void 0:e.popupOptions},set:function(e){this.instances[DefinitionPopup.compName]&&(this.instances[DefinitionPopup.compName].popupOptions=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lang",{get:function(){var e;return null===(e=this.instances[LanguagePopup.compName])||void 0===e?void 0:e.selected},set:function(e){this.instances[LanguagePopup.compName]&&(this.instances[LanguagePopup.compName].selected=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"langOpts",{get:function(){var e;return null===(e=this.instances[LanguagePopup.compName])||void 0===e?void 0:e.popupOptions},set:function(e){this.instances[LanguagePopup.compName]&&(this.instances[LanguagePopup.compName].popupOptions=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playrate",{get:function(){var e;return null===(e=this.instances[PlayratePopup.compName])||void 0===e?void 0:e.selected},set:function(e){this.instances[PlayratePopup.compName]&&(this.instances[PlayratePopup.compName].selected=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playrateOpts",{get:function(){var e;return null===(e=this.instances[PlayratePopup.compName])||void 0===e?void 0:e.popupOptions},set:function(e){this.instances[PlayratePopup.compName]&&(this.instances[PlayratePopup.compName].popupOptions=e)},enumerable:!1,configurable:!0}),t.prototype.getIsHotKeysDisabled=function(){return this.hotKeys.isDisabled},t.prototype.prependElementToLevels=function(e){var t,o,r;null===(r=null===(o=null===(t=this.instances)||void 0===t?void 0:t[DefinitionPopup.compName])||void 0===o?void 0:o.popup)||void 0===r||r.firstElementChild.insertAdjacentElement("afterbegin",e)},t.prototype.show=function(e){void 0===e&&(e=!1),this.el.classList.remove(Component.hideClassName),this.instances.CtrlShow.gradientBottom.classList.remove(Component.hideClassName),e&&(this.el.style.display="",this.instances.CtrlShow.gradientBottom.style.display=""),this.emit(CTRL_EVENTS$2.SHOW)},t.prototype.hide=function(e){void 0===e&&(e=!1),this.el.classList.add(Component.hideClassName),this.instances.CtrlShow.gradientBottom.classList.add(Component.hideClassName),e&&(this.el.style.display="none",this.instances.CtrlShow.gradientBottom.style.display="none"),this.emit(CTRL_EVENTS$2.HIDE)},t.prototype.setHotKeysDisable=function(e){void 0===e&&(e=!0),this.hotKeys&&(this.hotKeys.isDisabled=!!e)},t.prototype.setCompDisable=function(e,t){var o=this;void 0===t&&(t=!0),(Array.isArray(e)?e:[e]).forEach((function(e){var r,n;"CtrlShow"!==e?null===(n=null===(r=o.instances[e])||void 0===r?void 0:r.el)||void 0===n||n.classList.toggle(Component.disabledClassName,t):o.instances.CtrlShow.toggleShadowClickDisabled(t)}))},t.prototype.setCompVisable=function(e,t){var o=this;void 0===t&&(t=!0),(Array.isArray(e)?e:[e]).forEach((function(e){var r,n;null===(n=null===(r=o.instances[e])||void 0===r?void 0:r.el)||void 0===n||n.classList.toggle(Component.hideClassName,!t)}))},t.prototype.removeComponent=function(e){var t,o;null===(o=null===(t=this.instances[e])||void 0===t?void 0:t.el)||void 0===o||o.remove()},t.prototype.destroy=function(){var t,o;this.setPluginEvts(!1),this.callAllComponents("destroy"),(null===(t=this.el)||void 0===t?void 0:t.parentNode)&&this.el.remove(),this.el=null,null===(o=this.hotKeys)||void 0===o||o.destroy(),e.prototype.destroy.call(this)},t.prototype.hookVideoCanplay=function(){this.config.isMobile&&this.show(!0)},t.prototype.hookAdReqInfoStart=function(){this.isInRequest=!0},t.prototype.hookAdReqInfoEnd=function(){this.isInRequest=!1},t.prototype.hookVideoReqInfoStart=function(){this.isInRequest=!0},t.prototype.hookVideoReqInfoEnd=function(){this.isInRequest=!1},t.prototype.hookVideoRateChange=function(e){var t,o=e.rate;if(!(null===(t=this.playrateOpts)||void 0===t?void 0:t.find((function(e){return Number(e.value)===o})))){var r=__spreadArray$1([],this.playrateOpts||[],!0);if(this.hotKeys.pressKey)return;return this.hasCustomPlayBackRate&&(r=this.deleteCustomPlaybackRate(r)),this.playrateOpts=__spreadArray$1([this.getCustomPlaybackRate(o)],r,!0),this.hasCustomPlayBackRate=!0,void(this.playrate=o)}this.hasCustomPlayBackRate&&(this.hasCustomPlayBackRate=!1,this.playrateOpts=this.deleteCustomPlaybackRate(this.playrateOpts)),this.playrate=o},t.prototype.hookVideoPlaying=function(e){var t;e.isFirst&&(null===(t=this.instances.CtrlShow.shadow)||void 0===t||t.classList.remove(Component.hideClassName))},t.prototype.hookPlaySessionEnd=function(e){this.callAllComponents("hookPlaySessionEnd",e)},t.prototype.onFlowNodeStart=function(e){this.callAllComponents("hookFlowNodeStart",e)},t.prototype.callAllComponents=function(e){for(var t=this,o=[],r=1;r<arguments.length;r++)o[r-1]=arguments[r];var n={};Object.keys(this.instances).forEach((function(r){try{var i=t.instances[r];if(n[i.compName])return;n[i.compName]=!0,"function"==typeof i[e]&&i[e].apply(i,o)}catch(o){t.error("ctrlbar "+e+" err: ",o)}}))},t.prototype.setPluginEvts=function(e){var t=this;this.pluginMsgEvtMap||(this.pluginMsgEvtMap={FLOW_NODE_START:this.onFlowNodeStart.bind(this)});var o=e?this.msg.on:this.msg.off;Object.keys(this.pluginMsgEvtMap).forEach((function(e){o.call(t.msg,e,t.pluginMsgEvtMap[e])}))},t.prototype.getCustomPlaybackRate=function(e){return{value:e,label:"自定义（"+e+"x）",btnLabel:e+"x",payload:{customOpt:!0}}},t.prototype.deleteCustomPlaybackRate=function(e){return e.filter((function(e){var t;return!0!==(null===(t=e.payload)||void 0===t?void 0:t.customOpt)}))},t.prototype.insertDom=function(){var e=this.player.container,o=this.config.isMobile;e.classList.add(containerClassName$1),e.insertAdjacentHTML("beforeend",getDomText(o));var r=o?css_248z$5:css_248z$1$1;domTool.insertStyle(r,t.styleDataTag);var n=getRootClassName$1(o);this.el=e.querySelector(n),document.querySelector(svgSpriteSelector)||document.body.insertAdjacentHTML("afterbegin",o?h5SvgSprite:svgSprite),o&&(this.el.innerHTML=this.el.querySelector(ctrlBarSelector).innerHTML,e.querySelector(n+" .txp_right_controls").innerHTML=h5CtrlRightDomText,e.insertAdjacentHTML("beforeend",h5OverlayText))},t.prototype.createSubComponents=function(e){if(this.initComps(e),!this.config.disableHotKey){var t=this.instances,o=t.Volume,r=t.FakeFullscreen,n=t.PlayratePopup,i=t.Progress;this.hotKeys=new HotKeys(this.player,this.config,{volume:o,fakeFullscreen:r,playRate:n,progress:i})}},t.prototype.initComps=function(e){var t=this,o=this.config,r=o.isMobile,n=o.comps,i=o.removeComps,a="live"===this.config.mode,s=a?[PlayBtn,Fullscreen,FakeFullscreen,LiveProgress,Volume,CenterBtn,AirPlayBtn,CtrlShow,DefinitionPopup]:[PlayBtn,TimeArea,Progress,Fullscreen,HotPoint,Loop,NextBtn,FakeFullscreen,Volume,PictureInPicture,CenterBtn,AirPlayBtn,CtrlShow,DefinitionPopup,LanguagePopup,PlayratePopup,AudioTrackPopup],l=[];(null==n?void 0:n.length)?-1===(l=n.map((function(e){return componentMap[e]}))).indexOf(CtrlShow)&&l.push(CtrlShow):l=(l=l.concat(s)).filter((function(e){var t=!!i&&-1!==i.indexOf(e.compName),r=e.isEnabled(o);return!t&&r})),this.log("readyCompClasses="+l.map((function(e){return e.compName}))),l.forEach((function(r){var n=new r(t.player,o,t,e);t.instances[r.compName]=n,n instanceof Popup&&(t.instances[n.popupName]=n)})),a&&r&&(this.el.style.justifyContent="space-between")},t.prototype.setupResizeEvent=function(){var e=this,t=function(t){var o=t.data;e.player.container.classList.toggle(largeSizeClassName$1,o),e.emit(CTRL_EVENTS$2.RESIZE,{size:o?CTRL_SIZE$1.LARGE:CTRL_SIZE$1.NORMAL})};this.on(CTRL_EVENTS$2.FULLSCREEN_CHANGE,(function(o){var r;!o.data&&(null===(r=e.instances.FakeFullscreen)||void 0===r?void 0:r.isFullScreen)||t(o)})),this.on(CTRL_EVENTS$2.FAKE_FULLSCREEN_CHANGE,(function(o){var r,n=o.data;document.body.classList.toggle(bodyOverflowClassName$1,n),!n&&(null===(r=e.instances.Fullscreen)||void 0===r?void 0:r.isFullScreen)||t(o)})),uaTool.mobile&&this.player.container.addEventListener("touchmove",(function(t){var o;(null===(o=e.instances.FakeFullscreen)||void 0===o?void 0:o.isFullScreen)&&t.preventDefault()}))},t.pluginName=CtrlbarPluginName$2,t.styleDataTag="thumb-ctrlbar-style",t}(Plugin);function styleInject$4(e,t){void 0===t&&(t={});var o=t.insertAt;if(e&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css","top"===o&&r.firstChild?r.insertBefore(n,r.firstChild):r.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}}H5Player.registerPlugin(CtrlbarPlugin.pluginName,CtrlbarPlugin);var css_248z$4='.txp_console{position:absolute;top:0;left:0;width:100%;height:100%;z-index:10;color:#fff;font-family:PingFangSC-Regular,Helvetica Neue,Helvetica,Roboto,Microsoft Yahei,Arial,sans-serif;font-size:10px;font-weight:400;pointer-events:none}.txp_console.txp_none,.txp_console .txp_none{display:none}.txp_console .txp_console_header .txp_info_panel_btn{margin:2px;padding:2px 4px;border-radius:2px;-webkit-transition:all .5s;transition:all .5s;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;background-color:#444;color:#fff;outline:none;border:none;font-size:10px}.txp_console .txp_console_header .txp_info_panel_btn:hover{-webkit-filter:contrast(1.5) brightness(.8);filter:contrast(1.5) brightness(.8)}.txp_console .txp_console_header .txp_info_panel_btn:active{-webkit-filter:unset;filter:unset}.txp_console .txp_console_header .txp_btn_close{-webkit-appearance:none;-moz-appearance:none;appearance:none;position:relative;border:none;background:0 0;font-family:inherit;cursor:pointer;outline:0 none;font-size:1em;color:#fff}.txp_console .txp_console_inner{position:absolute;margin:10px 0 0 10px;padding:8px 5px;background-color:rgba(28,28,28,.8);pointer-events:auto;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text;border-radius:4px}.txp_console .txp_console_inner .txp_line_container{overflow-y:auto;margin-top:8px}.txp_console .txp_console_inner .txp_console_header{display:-webkit-box;display:-ms-flexbox;display:flex;width:100%;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-sizing:border-box;box-sizing:border-box;padding:0 8px}.txp_console .txp_console_inner .txp_console_header .txp_console_header_title{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;font-size:12px;font-weight:900}.txp_console .txp_console_inner .txp_console_header .txp_log_upload{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-right:4px}.txp_console .txp_console_inner .txp_console_header .txp_log_upload.info_panel_uploading:before{display:block}.txp_console .txp_console_inner .txp_console_header .txp_log_upload:before{content:"";display:none;width:10px;height:10px;background-image:url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMTAyNCAxMDI0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMCIgaGVpZ2h0PSIxMCIgZmlsbD0iI2ZmZiI+PHBhdGggZD0iTTc4NCA5MDIuNGM5LjYgMTkuMiA2LjQgNDEuNi0xMi44IDU0LjQtMTkuMiA5LjYtNDEuNiAzLjItNTEuMi0xMi44LTkuNi0xOS4yLTYuNC00MS42IDEyLjgtNTQuNCAxNi0xMi44IDM4LjQtOCA1MS4yIDEyLjh6TTU1MC40IDk4NGMwIDIyLjQtMTYgMzguNC0zOC40IDM4LjRzLTM4LjQtMTYtMzguNC0zOC40di0yNGMwLTIyLjQgMTkuMi0zOC40IDQxLjYtMzguNCAxOS4yIDAgMzUuMiAxNiAzOC40IDM4LjR2MjUuNmgtMy4yem0tMjQwLTQzLjJjLTkuNiAxOS4yLTM1LjIgMjUuNi01NC40IDE2LTE5LjItOS42LTI1LjYtMzUuMi0xNi01MS4ybDI4LjgtNTEuMmM5LjYtMTkuMiAzNS4yLTI1LjYgNTQuNC0xNnMyNS42IDM1LjIgMTIuOCA1NC40bC0yNS42IDQ4ek0xMjEuNiA3ODRjLTE5LjIgOS42LTQxLjYgMy4yLTU0LjQtMTYtOS42LTE5LjItNi40LTQxLjYgMTIuOC01NC40bDc2LjgtNDQuOGMxOS4yLTkuNiA0MS42LTMuMiA1NC40IDE2IDkuNiAxOS4yIDMuMiA0MS42LTE2IDU0LjRMMTIxLjYgNzg0ek0zOC40IDU1MkMxNiA1NTIgMCA1MzYgMCA1MTMuNnMxNi0zOC40IDM4LjQtMzguNEgxNjBjMjIuNCAwIDM4LjQgMTkuMiAzOC40IDM4LjQgMCAyMi40LTE2IDM4LjQtMzguNCAzOC40SDM4LjR6bTQ0LjgtMjQxLjZjLTE5LjItOS42LTI1LjYtMzUuMi0xNi01MS4yIDkuNi0xOS4yIDM1LjItMjUuNiA1NC40LTE2TDI1NiAzMjBjMTkuMiA5LjYgMjUuNiAzNS4yIDE2IDU0LjRzLTM1LjIgMjUuNi01NC40IDE2bC0xMzQuNC04MHptMTYwLTE4NS42bDkyLjggMTYwYzkuNiAxOS4yIDM1LjIgMjUuNiA1NC40IDEyLjhzMjUuNi0zNS4yIDEyLjgtNTQuNGwtOTIuOC0xNjBDMjk3LjYgNjQgMjc1LjIgNjAuOCAyNTYgNzAuNGMtMTYgMTIuOC0yMi40IDMzLjYtMTIuOCA1NC40ek00NzMuNiA0MGMwLTIyLjQgMTYtMzguNCAzOC40LTM4LjRzMzguNCAxOS4yIDM4LjQgMzguNHYxODRjMCAyMi40LTE5LjIgMzguNC0zOC40IDM4LjQtMjIuNCAwLTM4LjQtMTkuMi0zOC40LTM4LjRWNDB6bTI0MCA0My4yYzkuNi0xOS4yIDM1LjItMjUuNiA1NC40LTE2IDE5LjIgOS42IDI1LjYgMzUuMiAxNiA1MS4ybC05Mi44IDE2MGMtOS42IDE5LjItMzUuMiAyNS42LTU0LjQgMTYtMTkuMi05LjYtMjUuNi0zNS4yLTEyLjgtNTQuNGw4OS42LTE1Ni44em0xODguOCAxNjBsLTE2MCA5Mi44Yy0xOS4yIDkuNi0yNS42IDM1LjItMTYgNTQuNCAxMi44IDE5LjIgMzUuMiAyNS42IDU0LjQgMTIuOGwxNjAtOTIuOGMxOS4yLTkuNiAyNS42LTM1LjIgMTIuOC01NC40LTkuNi0xNi0zMi0yNS42LTUxLjItMTIuOHpNOTg1LjYgNDcyYzIyLjQgMCAzOC40IDE2IDM4LjQgMzguNHMtMTYgMzguNC0zOC40IDM4LjRIODAwYy0yMi40IDAtMzguNC0xOS4yLTM4LjQtMzguNCAwLTIyLjQgMTkuMi0zOC40IDM4LjQtMzguNGgxODUuNnoiPjxhbmltYXRlVHJhbnNmb3JtIGF0dHJpYnV0ZU5hbWU9InRyYW5zZm9ybSIgYXR0cmlidXRlVHlwZT0iWE1MIiB0eXBlPSJyb3RhdGUiIGZyb209IjAgNTEyIDUxMiIgdG89IjM2MCA1MTIgNTEyIiBkdXI9IjFzIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIvPjwvcGF0aD48L3N2Zz4=)}.txp_console .txp_console_inner .txp_console_header .txp_log_upload.txp_none{display:none}.txp_console .txp_console_inner .txp_line{display:-webkit-box;display:-ms-flexbox;display:flex;line-height:1.6}.txp_console .txp_console_inner .txp_line .txp_compact_label,.txp_console .txp_console_inner .txp_line .txp_label{display:inline-block;-ms-flex-negative:0;flex-shrink:0;width:7em;padding-right:6px;text-align:right}.txp_console .txp_console_inner .txp_line .txp_compact_label:after,.txp_console .txp_console_inner .txp_line .txp_label:after{content:":"}.txp_console .txp_console_inner .txp_line .txp_compact_label{display:none}.txp_console .txp_console_inner .txp_line .txp_value{display:inline-block;text-align:left;vertical-align:text-top;width:30em}.txp_console.fullscreen .txp_console_inner{margin:0;-webkit-box-sizing:border-box;box-sizing:border-box;overflow:hidden;width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.txp_console.fullscreen .txp_console_inner .txp_line{display:none}.txp_console.fullscreen .txp_console_inner .txp_line.line-compact{display:-webkit-box;display:-ms-flexbox;display:flex}.txp_console.fullscreen .txp_console_inner .txp_line.line-compact .txp_compact_label,.txp_console.fullscreen .txp_console_inner .txp_line.line-compact .txp_label{display:none;width:4em}.txp_console.fullscreen .txp_console_inner .txp_line.line-compact .txp_compact_label{display:block}.txp_info_icon{position:absolute;top:8px;right:8px;z-index:4;width:24px;height:24px;fill:#fff;opacity:.5;border-radius:5px;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-transition:all .3s;transition:all .3s}.txp_info_icon:hover{opacity:1}.txp_info_icon.small{width:16px;height:16px}.txp_info_icon.txp_none{display:none!important}';styleInject$4(css_248z$4);var INFO_SVG_DOM_STR$1='<div class="txp_info_icon txp_none">\n  <svg\n  viewBox="0 0 1024 1024"\n  version="1.1"\n  xmlns="http://www.w3.org/2000/svg"\n  >\n  <path\n    d="M512 958.016C266.08 958.016 65.984 757.952 65.984 512 65.984 266.08 266.08 65.984 512 65.984c245.952 0 446.016 200.064 446.016 446.016C958.016 757.952 757.952 958.016 512 958.016zM512 129.984C301.344 129.984 129.984 301.344 129.984 512c0 210.624 171.36 382.016 382.016 382.016 210.624 0 382.016-171.36 382.016-382.016C894.016 301.344 722.624 129.984 512 129.984z"\n  ></path>\n  <path\n    d="M512 304m-48 0a1.5 1.5 0 1 0 96 0 1.5 1.5 0 1 0-96 0Z"\n  ></path>\n  <path\n    d="M512 768c-17.664 0-32-14.304-32-32l0-288c0-17.664 14.336-32 32-32s32 14.336 32 32l0 288C544 753.696 529.664 768 512 768z"\n  ></path>\n  </svg>\n</div>\n',InfoPanelPluginName$1="info-panel",InfoPanelEvents$1={CLICK_UPLOAD:"contextmenu:click-upload"},DEFAULT_SHOW_QUERY$1="show_info_panel";function copyToClipBoard(e){return canUseClipboardAPI()?copyAsync(e):copySynchronized(e)}function copySynchronized(e){var t=document.createElement("input");t.setAttribute("style","position: absolute; clip: rect(0 0 0 0); opacity: 0;"),t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy",!0),t.remove()}function copyAsync(e){return navigator.clipboard.writeText(e)}function canUseClipboardAPI(){var e;return"function"==typeof(null===(e=navigator.clipboard)||void 0===e?void 0:e.writeText)&&!uaTool.browser.x5&&!uaTool.browser.mqqbrowser}function getHtml(e){return'<div class="txp_console txp_none" style="z-index: 100">\n    <div class="txp_console_inner">\n      <div class="txp_console_header">\n      <span class="txp_console_header_title">播放信息</span>\n      <span class="txp_info_panel_btn txp_info_copy">复制</span>\n      <span class="txp_info_panel_btn txp_log_upload">\n        上传日志\n      </span>\n      <button class="txp_info_panel_btn txp_log_download">\n        调试信息\n      </button>\n      <button class="txp_btn_close" title="关闭">[X]</button>\n      </div>\n    <div class="txp_line_container">\n      '+e.map((function(e){var t=e.key,o=e.title,r=void 0===o?"":o,n=e.style,i=void 0===n?"":n,a=e.label,s=e.value,l=e.compactLabel;return'<div class="txp_line '+(l?"line-compact":"")+'" data-key="'+t+'" title="'+(r||"")+'" style="'+(i||"")+'">\n            <div class="txp_label">'+a+"</div>\n            "+(l?'<div class="txp_compact_label">'+l+"</div>":"")+'\n            <div class="txp_value">'+s+"</div>\n          </div>"})).join("")+"\n    </div>\n    </div>\n  </div>"}var InfoPanelPlugin=function(e){function t(t,o,r){var n=e.call(this,t,o,r)||this;n.inited=!0,n._itemDomMap={},n._showing=!1,n.isReporting=!1,n.curInfoMap={};var i=n.player.config.infoPanelConfig,a=void 0===i?{defaultInfo:!1,disableDefaultKey:[]}:i;return n.config=__assign$2(__assign$2({},a),o),n.renderInfoIcon(),n.createInfoItems(),n.renderInfoItems(),n.addInfoItemEvts(),n.addUIEvts(),n}return __extends$1(t,e),t.prototype.start=function(e){},t.prototype.getItemDom=function(e){return this._el?this._itemDomMap[e]:null},t.prototype.show=function(){this.updateInfoItems(),this.isMiniPanel()?this._el.classList.add("fullscreen"):this._el.classList.remove("fullscreen"),this._showing=!0,this._el.classList.remove("txp_none")},t.prototype.hide=function(){this._showing=!1,this._el.classList.add("txp_none")},t.prototype.toggle=function(){if(this._showing)return this.hide();this.show()},t.prototype.showIcon=function(){this.isMiniPanel()?this._infoIcon.classList.add("small"):this._infoIcon.classList.remove("small"),this._infoIcon.classList.remove("txp_none")},t.prototype.hideIcon=function(){this._infoIcon.classList.add("txp_none")},t.prototype.trigger=function(){this._showing?this.hide():this.show()},Object.defineProperty(t.prototype,"showing",{get:function(){return this._showing},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){clearTimeout(this.copyBtnClearTimer),this._itemDomMap=null,this._el=null,this.infoItems=null,e.prototype.destroy.call(this)},t.prototype.hookPlaySessionStart=function(){var e=this.config.showOnQuery,t=void 0===e?DEFAULT_SHOW_QUERY$1:e;urlTool.getUrlParamByKey(location.href,t)&&this.show()},t.prototype.hookVideoPause=function(){var e=this.config.showInfoIconOnPause;(void 0===e||e)&&this.showIcon()},t.prototype.hookVideoPlaying=function(){var e=this.config.showInfoIconOnPause;(void 0===e||e)&&this.hideIcon()},t.prototype.renderInfoIcon=function(){var e=this,t=this.player.container;t.insertAdjacentHTML("beforeend",INFO_SVG_DOM_STR$1),this._infoIcon=t.querySelector(".txp_info_icon"),this._infoIcon.addEventListener("click",(function(){e.toggle()}))},t.prototype.renderInfoItems=function(){var e,t=this,o=this.config.showUploadBtn,r=void 0===o?uaTool.mobile:o,n=this.infoItems,i=this.player.container,a=getHtml(n);i.insertAdjacentHTML("beforeend",a),this._el=i.querySelector(".txp_console"),this._closeBtn=this._el.querySelector(".txp_btn_close"),this._uploadBtn=this._el.querySelector(".txp_info_panel_btn.txp_log_upload"),this._copyBtn=this._el.querySelector(".txp_info_panel_btn.txp_info_copy"),this._downloadBtn=this._el.querySelector(".txp_info_panel_btn.txp_log_download"),this.player.offlineLog||(this._uploadBtn.classList.add(txpHideClass),this._downloadBtn.classList.add(txpHideClass)),!r&&(null===(e=this.player.offlineLog)||void 0===e?void 0:e.downloadLogs)?this._uploadBtn.classList.add(txpHideClass):this._downloadBtn.classList.add(txpHideClass),n.forEach((function(e){var o={el:null,value:null};o.el=t._el.querySelector('[data-key="'+e.key+'"]'),o.value=o.el.querySelector(".txp_value"),t._itemDomMap[e.key]=o}))},t.prototype.setUploadBtnState=function(e){this._uploadBtn.textContent=e?"上传中...":"上传日志",this._uploadBtn.classList.toggle("info_panel_uploading"),this._uploadBtn.dataset.reporting=String(e),this.isReporting=e},t.prototype.addUIEvts=function(){var e=this;this._closeBtn.addEventListener("click",(function(){return e.hide()})),this._uploadBtn.addEventListener("click",(function(t){return __awaiter$1(e,void 0,void 0,(function(){var e,o,r,n=this;return __generator$1(this,(function(i){switch(i.label){case 0:if(t.stopPropagation(),this.isReporting||!(null===(r=this.player.offlineLog)||void 0===r?void 0:r.report))return[2];e=this.player.offlineLog.report.bind(this.player.offlineLog),i.label=1;case 1:return i.trys.push([1,3,4,5]),this.setUploadBtnState(!0),this.showTips("开始上传日志..."),copyToClipBoard(JSON.stringify(this.curInfoMap)),[4,e(!0,"info-panel:click",(function(e){n.showTips("上传中..."+(100*e).toFixed(0)+"%")}))];case 2:return o=i.sent(),this.showTips({text:(null==o?void 0:o.status)?"日志上报成功":"日志上报失败 "+((null==o?void 0:o.msg)||""),time:10,showClose:!0}),[3,5];case 3:return i.sent(),this.showTips({text:"日志上报失败 "+(null==o?void 0:o.msg),showClose:!0,time:-1}),[3,5];case 4:return this.setUploadBtnState(!1),[7];case 5:return[2]}}))}))})),this._downloadBtn.addEventListener("click",(function(){return __awaiter$1(e,void 0,void 0,(function(){var e,t;return __generator$1(this,(function(o){return null===(t=null===(e=this.player.offlineLog)||void 0===e?void 0:e.downloadLogs)||void 0===t||t.call(e),[2]}))}))})),this._copyBtn.addEventListener("click",(function(t){return __awaiter$1(e,void 0,void 0,(function(){var e,o,r=this;return __generator$1(this,(function(n){switch(n.label){case 0:e=3e3,t.stopPropagation(),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,copyToClipBoard(JSON.stringify(this.curInfoMap))];case 2:return n.sent(),this._copyBtn.textContent="已复制",[3,4];case 3:return o=n.sent(),this._copyBtn.textContent="复制失败",this.log(o),[3,4];case 4:return clearTimeout(this.copyBtnClearTimer),this.copyBtnClearTimer=setTimeout((function(){r._copyBtn.textContent="复制"}),e),[2]}}))}))})),isMobile&&this._el.addEventListener("click",(function(){return e.hide()}))},t.prototype.showTips=function(e){var t=this.player.plugins.tips;null==t||t.show(e)},t.prototype.createInfoItems=function(){var e,t=this;if(this.config.defaultInfo){var o=((e={})[COMMON_DATA_KEY.vid]=this.createVidInfoItem,e[COMMON_DATA_KEY.flowid]=this.createFlowidInfoItem,e[COMMON_DATA_KEY.guid]=this.createGuidInfoItem,e[COMMON_DATA_KEY.curcore]=this.createKernelNameInfoItem,e.cdnInfo=this.createCdnInfoItem,e.playerSize=this.createResolutionInfoItem,e.keyFrame=this.createKeyFrameInfoItem,e.bufferRange=this.createBufferRangeInfoItem,e.net=this.createNetInfoItem,e.videoSize=this.createVideoSizeInfoItem,e.codecs=this.createCodecsInfoItem,e.debug=this.createDebugInfoItem,e),r=this.config.disableDefaultKey,n=void 0===r?[]:r,i=Object.keys(o).filter((function(e){return!n.includes(e)}));this.infoItems=i.map((function(e){return o[e].apply(t,[e])}))}else this.infoItems=[]},t.prototype.createNetInfoItem=function(e){var t=this,o=function(){var o=t.player.currentVideoInfo;if(null==o?void 0:o.performance){var r=o.performance,n=r.speed,i=void 0===n?0:n,a=r.p2pStats,s=void 0===a?"":a;t.setItemTextByKey(e,i+" KB/s "+s)}};return{key:e,updater:o,label:"网络活动",compactLabel:"net",value:"-",listeners:[{event:exports.H5_PLAY_EVENT.VIDEO_TIMEUPDATE,cb:o}]}},t.prototype.createVidInfoItem=function(e){var t=this,o=function(){var o=t.player,r=o.getCommonKv(COMMON_DATA_KEY.vid),n=o.getCommonKv(COMMON_DATA_KEY.platform),i=t.getItemDom(e);if(r||n){var a="-";r&&(a=o.config.type===exports.PLAY_MODE.LIVE?r+"-"+(o.getCommonKv(COMMON_DATA_KEY.livepid)||0)||"-":r||"-"),a+=" / "+(n||"-"),i.el.classList.remove(txpHideClass),t.setItemTextByKey(e,a)}else i.el.classList.add(txpHideClass)};return{key:e,updater:o,label:"视频ID",compactLabel:"VID",value:"-",listeners:[{dispatcher:this.msg,event:exports.PLAY_EVENT_EXT.DATASET_UPDATE,cb:function(e){e.data.key===COMMON_DATA_KEY.vid&&o()}}]}},t.prototype.createKernelNameInfoItem=function(e){var t=this,o=function(){var o,r,n,i,a,s=null!==(n=urlTool.getFileExtension(null===(r=null===(o=t.player)||void 0===o?void 0:o.currentVideoInfo)||void 0===r?void 0:r.loadingUrl))&&void 0!==n?n:"-",l=null!==(i=t.player.getCommonKv(COMMON_DATA_KEY.curcore))&&void 0!==i?i:"-",c=null!==(a=t.player.getCommonKv(COMMON_DATA_KEY.curcorever))&&void 0!==a?a:VERSION$3,p=t.player.getCommonKv(COMMON_DATA_KEY.p2pver),d=p?"-p2p-"+p:"";t.setItemTextByKey(e,s+"/"+l+" ("+c+d+")")};return{key:e,label:"播放内核",compactLabel:"Kernel",value:"-",updater:o,listeners:[{dispatcher:this.msg,event:exports.PLAY_EVENT_EXT.DATASET_UPDATE,cb:function(e){[COMMON_DATA_KEY.curcorever,COMMON_DATA_KEY.curcore,COMMON_DATA_KEY.p2pver].indexOf(e.data.key)>-1&&o()}}]}},t.prototype.createResolutionInfoItem=function(e){var t=this;return{key:e,label:"显示器信息",compactLabel:"Res",value:"-",updater:function(){var o,r,n=t.player,i=n.container,a=n.getCommonKv,s=i.clientWidth+"*"+i.clientHeight,l=a(COMMON_DATA_KEY.resolution),c=null!==(r=null===(o=window.screen)||void 0===o?void 0:o.isExtended)&&void 0!==r&&r;t.setItemTextByKey(e,s+" / "+l+" (ext:"+c+")")}}},t.prototype.createVideoSizeInfoItem=function(e){var t=this,o=function(){var o,r,n=null!==(r=null===(o=t.player)||void 0===o?void 0:o.currentVideoInfo)&&void 0!==r?r:{},i=n.videoHeight,a=void 0===i?0:i,s=n.videoWidth,l=void 0===s?0:s;t.setItemTextByKey(e,l+"*"+a)};return{key:e,updater:o,label:"视频分辨率",value:"-",listeners:[{event:exports.PLAY_EVENT.METADATA_CHANGE,cb:o},{event:exports.H5_PLAY_EVENT.VIDEO_SETLEVEL_END,cb:o}]}},t.prototype.createCodecsInfoItem=function(e){var t=this,o=function(){var o=t.getItemDom(e),r=t.player.currentVideoInfo;if(r){o.el.classList.remove(txpHideClass);var n=r.codecs,i=void 0===n?{video:"",audio:""}:n,a=i.video,s=i.audio,l=a&&s?a+" / "+s:"",c="("+(t.player.getCommonKv(COMMON_DATA_KEY.codec)||"-")+")";t.setItemTextByKey(e,(l+" "+c).trim())}else o.el.classList.add(txpHideClass)};return{key:e,updater:o,label:"编码",compactLabel:"Codec",value:"-",listeners:[{event:exports.PLAY_EVENT.METADATA_CHANGE,cb:o}]}},t.prototype.createFlowidInfoItem=function(e){var t=this,o=function(){t.setItemTextByKey(e,t.player.getCommonKv(COMMON_DATA_KEY.flowid))};return{key:e,label:"播放流水",compactLabel:"Flowid",value:"-",updater:o,listeners:[{dispatcher:this.msg,event:exports.PLAY_EVENT_EXT.DATASET_UPDATE,cb:function(e){e.data.key===COMMON_DATA_KEY.flowid&&o()}}]}},t.prototype.createGuidInfoItem=function(e){var t=this;return{key:e,label:"GUID",compactLabel:"GUID",value:"-",updater:function(){t.setItemTextByKey(e,t.player.getCommonKv(COMMON_DATA_KEY.guid))}}},t.prototype.createKeyFrameInfoItem=function(e){var t=this;return{key:e,label:"帧数",value:"-",listeners:[{event:exports.H5_PLAY_EVENT.VIDEO_TIMEUPDATE,cb:function(){var o,r,n=(null===(r=null===(o=t.player)||void 0===o?void 0:o.currentVideoInfo)||void 0===r?void 0:r.qualityInfo)||{},i=n.totalVideoFrames,a=void 0===i?0:i,s=n.droppedVideoFrames,l=void 0===s?0:s,c=l/a*100;t.setItemTextByKey(e,l+"/"+a+"; "+(isNaN(c)?0:c.toFixed(2))+"%")}}]}},t.prototype.createCdnInfoItem=function(e){var t=this,o=function(){var o,r=t.getItemDom(e);t.player.getCommonKv(COMMON_DATA_KEY.vid)?(r.el.classList.remove(txpHideClass),t.setItemTextByKey(e,urlTool.getDomainOfURL((null===(o=t.player.currentVideoInfo)||void 0===o?void 0:o.loadingUrl)||""))):r.el.classList.add(txpHideClass)};return{key:e,label:"视频CDN",value:"-",listeners:[{event:exports.H5_PLAY_EVENT.VIDEO_LOAD_START,cb:o},{event:exports.PLAY_EVENT.RETRY_BACKURL,cb:o},{event:exports.H5_PLAY_EVENT.VIDEO_SETLEVEL_END,cb:o}]}},t.prototype.createBufferRangeInfoItem=function(e){var t=this,o=function(){var o,r=t.player,n=r.videoBuffered,i=r.playtime,a=(null===(o=n.find((function(e){return e.start<=i&&e.end>=i})))||void 0===o?void 0:o.end)-i;t.setItemTextByKey(e,isNaN(a)?"-":a.toFixed(2)+"s")};return{key:e,updater:o,label:"缓冲健康度",value:"-",listeners:[{event:exports.H5_PLAY_EVENT.VIDEO_TIMEUPDATE,cb:o}]}},t.prototype.createDebugInfoItem=function(e){var t=this,o="",r=[],n=function(){var n,i,a,s,l,c,p=t.player.getCommonKv(COMMON_DATA_KEY.sessionRetryBackUrlCount)||0,d=t.player.getCommonKv(COMMON_DATA_KEY.sessionRetryPlayCount)||0,u=p||d?"r:"+[p,d].join("/"):"",A=t.player.getCommonKv(COMMON_DATA_KEY.sessionBufferCount)||0,_=A?"b:"+A:"",E=t.player.videoBuffered.map((function(e){return e.start.toFixed(3)+"-"+e.end.toFixed(3)})).join(","),g=E?"br:"+E:"",f="t:"+t.player.playtime.toFixed(2),h="pg:"+ +!!(null===(s=null===(a=null===(i=null===(n=t.player.corePlayer)||void 0===n?void 0:n.getHls)||void 0===i?void 0:i.call(n))||void 0===a?void 0:a.config)||void 0===s?void 0:s.progressive),v="s:"+r.join("->"),y=o?"a:"+o:"",m=null===(c=null===(l=t.player.currentVideoInfo)||void 0===l?void 0:l.performance)||void 0===c?void 0:c.latency,T=m?"lc:"+(m/1e3).toFixed(2):"",C=t.player.getCommonKv(COMMON_DATA_KEY.drm),I=C?"enc:"+C:"";t.setItemTextByKey(e,[u,_,g,f,h,v,y,T,I].filter(Boolean).join(" "))};return{key:e,label:"mystery",compactLabel:"mystery",value:"-",listeners:[{dispatcher:this.msg,event:exports.PLAY_EVENT_EXT.DATASET_UPDATE,cb:function(e){-1!==[COMMON_DATA_KEY.sessionRetryBackUrlCount,COMMON_DATA_KEY.sessionRetryPlayCount,COMMON_DATA_KEY.sessionBufferCount,COMMON_DATA_KEY.drm].indexOf(e.data.key)&&n()}},{event:exports.PLAY_EVENT.STATE_CHANGE,cb:function(){var e=t.player.state,o=e.charAt(0)+e.charAt(e.length-1);r.push(o),r=r.slice(-5),n()}},{event:exports.H5_PLAY_EVENT.VIDEO_LOAD_PROGRESS,cb:n},{event:exports.H5_PLAY_EVENT.VIDEO_AUTOPLAY_BLOCKED,cb:function(){o="vb"}},{event:exports.H5_PLAY_EVENT.VIDEO_TIMEUPDATE,cb:n},{event:exports.H5_PLAY_EVENT.AD_AUTOPLAY_BLOCKED,cb:function(){o="ab"}}]}},t.prototype.setItemTextByKey=function(e,t){var o=this.getItemDom(e);this.curInfoMap[e]=t,o&&(o.value.innerText=null!=t?t:"-")},t.prototype.addInfoItemEvts=function(){var e=this;this.infoItems.forEach((function(t){var o;null===(o=t.listeners)||void 0===o||o.forEach((function(t){(t.dispatcher||e.player).on(t.event,t.cb)}))}))},t.prototype.updateInfoItems=function(){this.infoItems.forEach((function(e){var t;null===(t=e.updater)||void 0===t||t.call(e)}))},t.prototype.isMiniPanel=function(){var e=this.config.smallSizeThreshold,t=void 0===e?400:e;return this.player.container.clientWidth<t},t.pluginName=InfoPanelPluginName$1,t.Events=InfoPanelEvents$1,t}(Plugin);function styleInject$3(e,t){void 0===t&&(t={});var o=t.insertAt;if(e&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css","top"===o&&r.firstChild?r.insertBefore(n,r.firstChild):r.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}}H5Player.registerPlugin(InfoPanelPlugin.pluginName,InfoPanelPlugin);var css_248z$3=".txp_poster_img{position:absolute;left:0;top:0;width:100%;height:100%;z-index:2;-o-object-fit:contain;object-fit:contain}.txp_poster_img.txp_none{display:none}";styleInject$3(css_248z$3);var PosterPluginName$1="poster",hideClass$2="txp_none",POSTER_IMAGE_ALT$1="Thumbplayer Poster Plugin Image",POSTER_IMAGE_CLASS_NAME$1="txp_poster_img",DEFAULT_RES=["496","360","228"];function findPoster(e){var t=e.vid,o=e.resolution,r=e.vidFirstPic,n=void 0!==r&&r,i=e.h5Defn,a=e.dir,s=void 0===a?"hz":a;return n?"//puui.qpic.cn/vpic_cover/"+t+"/"+t+"_first.jpg/"+("hz"===s?"640x360":"360x640"):o||DEFAULT_RES[i]?"//puui.qpic.cn/vpic_cover/"+t+"/"+t+"_hz.jpg/"+(o||DEFAULT_RES[i]||"0"):"//puui.qpic.cn/vpic_cover/"+t+"/"+t+"_"+s+".jpg"}var PosterPlugin=function(e){function t(t,o,r){var n=e.call(this,t,o,r)||this;return n.config=__assign$2(__assign$2({},t.config.poster||{}),o),n.el=n.init(),n.tryShow(),n}return __extends$1(t,e),t.prototype.destroy=function(){var t;e.prototype.destroy.call(this),null===(t=this.el)||void 0===t||t.remove()},t.prototype.show=function(e){this.el&&(e&&(this.el.src=e),this.el.classList.remove(hideClass$2))},t.prototype.showByVid=function(e){var t=e.vid,o=e.vidFirstPic,r=e.h5Defn,n=e.dir,i=e.resolution;if(e.pcFmt,t){var a=findPoster({vid:t,vidFirstPic:o,h5Defn:r,dir:n,resolution:i});this.show(a)}},t.prototype.hide=function(){this.el&&this.el.classList.add(hideClass$2)},t.prototype.hookAdPlaying=function(){this.hide()},t.prototype.hookVideoPlaying=function(e){e.isFirst&&this.hide()},t.prototype.hookVideoEnd=function(e){e.endState!==exports.END_STATE.NORMAL||this.player.config.loop||this.tryShow()},t.prototype.init=function(){var e=this.player.container,t=document.createElement("img");return t.alt=POSTER_IMAGE_ALT$1,t.classList.add(POSTER_IMAGE_CLASS_NAME$1,hideClass$2),e.prepend(t),t},t.prototype.tryShow=function(){var e,t;(null===(e=this.config)||void 0===e?void 0:e.vid)?this.showByVid(this.config):(null===(t=this.config)||void 0===t?void 0:t.src)&&this.show(this.config.src)},t.pluginName=PosterPluginName$1,t}(Plugin);function styleInject$2(e,t){void 0===t&&(t={});var o=t.insertAt;if(e&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css","top"===o&&r.firstChild?r.insertBefore(n,r.firstChild):r.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}}H5Player.registerPlugin(PosterPlugin.pluginName,PosterPlugin);var css_248z$2='.txp_alert_info{position:absolute;left:10px;bottom:67px;padding:2px 8px;line-height:24px;font-size:13px;text-align:left;color:#fff;background:rgba(0,0,0,.6);-webkit-transition:bottom .15s ease;transition:bottom .15s ease;z-index:2}.txp_alert_info.txp_none{display:none}.txp_alert_info.ctrl_resize{bottom:107px}.txp_alert_info.ctrl_hide{bottom:20px}.txp_alert_info .txp_btn{-webkit-appearance:none;-moz-appearance:none;appearance:none;position:relative;border:none;background:0 0;font-family:inherit;cursor:pointer;outline:0 none;font-size:1em}.txp_alert_info .txp_btn.txp_btn_close{position:relative;display:inline-block;margin-left:3px;width:14px;height:24px;vertical-align:top;color:#fff;cursor:pointer}.txp_alert_info .txp_btn.txp_btn_close:hover{color:#ff6429}.txp_alert_info .txp_btn.txp_btn_close:hover:before{background:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMiAxMiI+PHBhdGggZmlsbD0iI0ZGNzgwMCIgZD0iTTEwLjUgMTBsLS41LjUtNC00LTQgNC0uNS0uNSA0LTQtNC00IC41LS41IDQgNCA0LTQgLjUuNS00IDQgNCA0eiIvPjwvc3ZnPg==) 50% no-repeat}.txp_alert_info .txp_btn.txp_btn_close:before{content:"";position:absolute;left:0;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);width:12px;height:12px;background:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMiAxMiI+PHBhdGggZmlsbD0iI2ZmZiIgZD0iTTEwLjUgMTBsLS41LjUtNC00LTQgNC0uNS0uNSA0LTQtNC00IC41LS41IDQgNCA0LTQgLjUuNS00IDQgNCA0eiIvPjwvc3ZnPg==) 50% no-repeat;-webkit-box-sizing:border-box;box-sizing:border-box;margin:0;padding:0;text-indent:0}.txp_alert_info .txp_btn.txp_none{display:none}.txp_alert_info .txp_alert_content a,.txp_alert_info .txp_alert_content em{padding:0 1px;color:#ff6429;font-style:normal;font-weight:400}.txp_alert_info .txp_alert_content .txp_alert_text{display:inline}.txp_alert_info .txp_none{display:none}',HOTPOINT_EVENTS;styleInject$2(css_248z$2),function(e){e.HOT_MOUSE_OVER="ctrl:hotpoint-mouseover",e.HOT_MOUSE_MOVE="ctrl:hotpoint-mousemove",e.HOT_MOUSE_OUT="ctrl:hotpoint-mouseout"}(HOTPOINT_EVENTS||(HOTPOINT_EVENTS={}));var CtrlbarPluginName$1="ctrlbar",CTRL_EVENTS$1=__assign$2(__assign$2({FULLSCREEN_CHANGE:"windowFullscreenChange",FULLSCREEN_ERROR:"fullscreenError",FAKE_FULLSCREEN_CHANGE:"browserFullscreenChange",CLICK_PIPBTN:"ctrl:click-pipbtn",CLICK_NEXTBTN:"ctrl:click-nextbtn",CLICK_PLAYBTN:"ctrl:click-playbtn",CLICK_REPLAY:"ctrl:click-replay",SET_LANGUAGE:"ctrl:set-language",SET_LEVEL:"ctrl:set-level",SET_AUDIO:"ctrl:set-audio",SET_PLAYRATE:"ctrl:set-playrate",SET_VOLUME:"ctrl:set-volume",TOGGLE_OVERLAY:"ctrl:toggle-overlay",MOUSE_DONW:"ctrl:progress-mousedown",MOUSE_DOWN:"ctrl:progress-mousedown",MOUSE_MOVE:"ctrl:progress-mousemove",MOUSE_UP:"ctrl:progress-mouseup",SHOW:"ctrl:show",HIDE:"ctrl:hide"},HOTPOINT_EVENTS),{TEST_EVENT:"ctrl:inner-test-event",RESIZE:"ctrl:resize",SHOW_LEVELS:"ctrl:show-levels",HOVER_PROGRESS:"ctrl:hover-progress"}),CTRL_SIZE,PlayBtnStatus;!function(e){e.LARGE="large",e.NORMAL="normal"}(CTRL_SIZE||(CTRL_SIZE={})),function(e){e.PAUSE="pause",e.PLAY="play",e.REPLAY="replay",e.STOP="stop"}(PlayBtnStatus||(PlayBtnStatus={}));var defaultShowTime$1=3,classNameOnCtrlHide$1="ctrl_hide",classNameOnCtrlResize$1="ctrl_resize",TipsPluginName$1="tips",TipsPlugin=function(e){function t(t,o,r){var n=e.call(this,t,o,r)||this;return n.hide=function(){n.el.removeEventListener("click",n.clickTips),n.showOptions=null,n.el.classList.add(txpHideClass),n.emit(TipsEvents.Hide)},n.clickTips=function(e){var t;if(n.showOptions){var o=null===(t=e.target)||void 0===t?void 0:t.dataset.callback;o&&"function"==typeof n.showOptions[o]&&n.showOptions[o]()}},n.prepareDOM(),n.initDOMVars(),!1!==o.followCtrlbar&&n.followCtrlbar(),n}return __extends$1(t,e),t.prototype.destroy=function(){this.hide(),e.prototype.destroy.call(this)},t.prototype.show=function(e){var t,o=!1,r=defaultShowTime$1;"string"==typeof e||"number"==typeof e?t=String(e):(t=e.text,o=!!e.showClose,r=e.time||defaultShowTime$1,this.showOptions=e),this.$text.innerHTML=t,this.$close.classList.toggle(txpHideClass,!o),this.el.addEventListener("click",this.clickTips),this.el.classList.remove(txpHideClass),clearTimeout(this.timeoutId),-1!==r&&(this.timeoutId=window.setTimeout(this.hide,1e3*r)),this.emit(TipsEvents.Show)},t.prototype.prepareDOM=function(){var e=this.player.container,t=document.createElement("div");t.className="txp_alert_info "+txpHideClass,t.innerHTML='<div class="txp_alert_content">\n      <div class="txp_alert_text"></div>\n      <button class="txp_btn txp_btn_close" title="关闭"></button>\n    </div>',e.insertAdjacentElement("beforeend",t),this.el=t},t.prototype.initDOMVars=function(){this.$text=this.el.querySelector(".txp_alert_content .txp_alert_text"),this.$close=this.el.querySelector(".txp_btn_close"),this.$close.addEventListener("click",this.hide),isMobile&&(this.el.style.bottom="40px")},t.prototype.followCtrlbar=function(){var e=this;this.msg.on("pluginsetup:"+CtrlbarPluginName$1,(function(){var t=e.player.plugins[CtrlbarPluginName$1];t.on(CTRL_EVENTS$1.SHOW,(function(){e.el.classList.remove(classNameOnCtrlHide$1)})),t.on(CTRL_EVENTS$1.HIDE,(function(){e.el.classList.add(classNameOnCtrlHide$1)})),t.on(CTRL_EVENTS$1.RESIZE,(function(t){var o=t.data;e.el.classList.toggle(classNameOnCtrlResize$1,o.size===CTRL_SIZE.LARGE)}))}))},t.pluginName=TipsPluginName$1,t}(Plugin),TipsEvents;!function(e){e.Show="show",e.Hide="hide"}(TipsEvents||(TipsEvents={})),H5Player.registerPlugin(TipsPlugin.pluginName,TipsPlugin);var UIContextMenuPluginName$1="context-menu";function styleInject$1(e,t){void 0===t&&(t={});var o=t.insertAt;if(e&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css","top"===o&&r.firstChild?r.insertBefore(n,r.firstChild):r.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}}var css_248z$1="@-webkit-keyframes txp_overlay_play{0%{-webkit-transform:scale(.5);transform:scale(.5);opacity:1}to{-webkit-transform:scale(1);transform:scale(1);opacity:0}}@keyframes txp_overlay_play{0%{-webkit-transform:scale(.5);transform:scale(.5);opacity:1}to{-webkit-transform:scale(1);transform:scale(1);opacity:0}}.txp_contextmenu{background:rgba(30,30,32,.9);position:fixed;width:234px;z-index:9999;padding:10px 0;color:#bbb;overflow:hidden;font-size:12px}.txp_contextmenu.txp_none,.txp_contextmenu .txp_none{display:none}.txp_contextmenu .txp_clipboard{top:0;left:100%;position:absolute;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}.txp_contextmenu .txp_menuitem{padding-left:20px;height:34px;line-height:34px;cursor:pointer;max-width:100%;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.txp_contextmenu .txp_menuitem:hover{background-color:#26262b}.txp_overlay_link{position:absolute;left:0;top:0;width:100%;height:100%;z-index:5;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;visibility:hidden;font-size:14px}.txp_overlay_link.txp_show{display:-webkit-box;display:-ms-flexbox;display:flex;visibility:visible;-webkit-animation:txp_overlay_play 1s ease-out both;animation:txp_overlay_play 1s ease-out both;pointer-events:none}.txp_overlay_link .txp_icon_link{background:rgba(30,30,32,.9);width:60px;height:60px;border-radius:30px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.txp_overlay_link .txp_icon_link .txp_icon{position:relative;width:36px;height:36px;fill:#fff}";styleInject$1(css_248z$1);var UIContextMenuPlugin=function(e){function t(t,o,r){var n=e.call(this,t,o,r)||this;return n.menuConfig=[],n.show=function(){n.$el.classList.remove(txpHideClass)},n.hide=function(){n.$el.classList.add(txpHideClass)},n.config=__assign$2(__assign$2({},t.config.contextMenuConfig),o),n.start(n.config.menus,{hideVInfo:n.config.hideVInfo}),n}return __extends$1(t,e),t.prototype.start=function(e,t){if(e&&!(e.length<=0))if(!0!==(null==t?void 0:t.hideVInfo)&&e.unshift({role:"openvinfo",label:"视频信息"}),this.menuConfig=e,this.$el)this.$el.innerHTML="\n      "+e.map((function(e){return'<div class="txp_menuitem" data-role="'+(e.role||"")+'">'+e.label+"</div>"})).join("")+'\n      <textarea class="txp_clipboard" style="position: absolute; left: 100%; top: 0;"></textarea>\n      ';else{var o='\n    <div class="txp_contextmenu '+txpHideClass+'" style="overflow:hidden">\n      '+e.map((function(e){return'<div class="txp_menuitem" data-role="'+(e.role||"")+'">'+e.label+"</div>"})).join("")+'\n      <textarea class="txp_clipboard" style="position: absolute; left: 100%; top: 0;"></textarea>\n    </div>\n    <div class="txp_overlay_link '+txpHideClass+'">\n        <div class="txp_icon_link">\n            <svg class="txp_icon" viewBox="0 0 36 36" >\n              <path d="M26.5 26h-5c-.8 0-1.5-.7-1.5-1.5s.7-1.5 1.5-1.5h5c2.5 0 4.5-2 4.5-4.5S29 14 26.5 14h-5c-.8 0-1.5-.7-1.5-1.5s.7-1.5 1.5-1.5h5c4.1 0 7.5 3.4 7.5 7.5S30.6 26 26.5 26zM12 18.5c0-.8.7-1.5 1.5-1.5h9c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5h-9c-.8 0-1.5-.7-1.5-1.5zm2.5-4.5h-5C7 14 5 16 5 18.5S7 23 9.5 23h5c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5h-5C5.4 26 2 22.6 2 18.5S5.4 11 9.5 11h5c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5z"></path>\n            </svg>\n        </div>\n    </div>\n    ',r=this.player.container;r.insertAdjacentHTML("beforeend",o),this.$el=r.querySelector(".txp_contextmenu"),this.$link=r.querySelector(".txp_overlay_link"),this.bindDOMEvent()}},t.prototype.showSuccess=function(){var e,t;if(!isMobile&&!(null===(e=this.config)||void 0===e?void 0:e.disableSuccessTip)&&!(null===(t=this.config)||void 0===t?void 0:t.disableSuccussTip)){var o=this.$link,r="txp_show";o.classList.remove(txpHideClass),o.classList.add(r),clearTimeout(this.sucTid),this.sucTid=setTimeout((function(){o.classList.add(txpHideClass),o.classList.remove(r)}),1e3)}},t.prototype.destroy=function(){[this.$el,this.$link].forEach((function(e){return(null==e?void 0:e.parentNode)&&e.remove()})),e.prototype.destroy.call(this)},t.prototype.bindDOMEvent=function(){var e=this,t=this.player.container;t.addEventListener("contextmenu",(function(t){if(!e.player.isPlayingAd){e.show();var o=e.player.container.getBoundingClientRect(),r=o.left,n=o.top,i=o.width,a=o.height,s=t.clientX,l=t.clientY,c=e.$el,p=i+r-c.clientWidth,d=a+n-c.clientHeight,u=Math.min(p,s),A=Math.min(d,l);e.$el.style.left=u+"px",e.$el.style.top=A+"px",t.preventDefault()}})),t.addEventListener("click",this.hide),this.$el.addEventListener("click",(function(t){var o,r,n=t.target;e.showSuccess();var i=null===(o=e.menuConfig)||void 0===o?void 0:o.find((function(e){return e.role===n.dataset.role}));"function"==typeof(null==i?void 0:i.callback)&&i.callback(e),"openvinfo"===n.dataset.role&&(null===(r=e.player.plugins["info-panel"])||void 0===r||r.trigger()),e.emit("clickContextMenu",n.dataset)}))},t.pluginName=UIContextMenuPluginName$1,t}(Plugin);H5Player.registerPlugin(UIContextMenuPlugin.pluginName,UIContextMenuPlugin);var WaterMarkCoverClassName$1="thumbplayer-watermark-cover",WatermarkPluginName$1="ui-watermark",MaxRequestRetry$1=3,RequestTimeout$1=5e3,WatermarkError;function requestActionWatermark(e,t){return __awaiter$1(this,void 0,void 0,(function(){var o,r;return __generator$1(this,(function(n){switch(n.label){case 0:if(!e)return[2,Promise.reject(o)];r=0,n.label=1;case 1:if(!(r<MaxRequestRetry$1))return[3,6];n.label=2;case 2:return n.trys.push([2,4,,5]),[4,netTool.jsonp(e,{timeout:RequestTimeout$1})];case 3:return[2,parseActionWatermark(n.sent(),t)];case 4:return n.sent(),o=WatermarkError.ActionWatermarkRequestFailed,[3,5];case 5:return r++,[3,1];case 6:return[2,Promise.reject(o)]}}))}))}function parseActionWatermark(e,t){for(var o={},r={},n=e.start,i=e.duration,a=e.repeat,s=e.rw,l=0===a?Math.ceil(t/i):a,c=function(t){var a=n+t*i;e.scenes.forEach((function(e){var n=e.wi,i=e.in,l=e.out,c=e.start,p=e.end;n.forEach((function(e){r[e.id]=__assign$2(__assign$2({},e),{action:!0,rw:s}),o[e.id]||(o[e.id]=[]),t>=c&&(t<=p||0===t)&&o[e.id].push({start:(a+i)/1e3,end:(a+l)/1e3})}))}))},p=0;p<l;p++)c(p);return{schedules:o,watermarks:r}}!function(e){e.ActionWatermarkRequestFailed="001"}(WatermarkError||(WatermarkError={}));var str='<txpdiv data-role="txp-ui-watermark-mod" class="txp-watermark">\n</txpdiv>',Watermark=function(){function e(e,t,o){void 0===o&&(o=!1);var r=t.cfg,n=t.css;this.el=this.createImageNode(n),this.el.onload=r.onload,this.el.onerror=r.onerror,this.el.src=r.url,this.el.dataset.id=""+r.id,e.appendChild(this.el),o?this.show():this.hide()}return e.prototype.destroy=function(){var e;(null===(e=this.el)||void 0===e?void 0:e.parentNode)&&this.el.remove(),this.el=null},e.prototype.show=function(){this.el&&(this.el.style.display="block")},e.prototype.hide=function(){this.el&&(this.el.style.display="none")},e.prototype.draw=function(e){var t=e.left,o=e.top,r=e.width,n=e.height,i=e.position,a=e.opacity;this.el&&(this.el.style.left=t,this.el.style.top=o,this.el.style.width=r,this.el.style.height=n,this.el.style.opacity=a,this.el.style.position=i)},e.prototype.createImageNode=function(e){var t=e.left,o=e.top,r=e.width,n=e.height,i=e.position,a=e.opacity,s=new Image;return s.style.left=t,s.style.top=o,s.style.width=r,s.style.height=n,s.style.position=i,s.style.opacity=a,s.style.zIndex="1",s},e}(),WatermarkPlugin=function(e){function t(t,o,r){var n=e.call(this,t,o,r)||this;n.watermarks={},n.timeTable={},n.onResize=function(){Object.values(n.watermarks).forEach((function(e){var t=e[0],o=e[1],r=n.computeCss(o);t.draw(r)}))},n.computeCss=function(e){var t=e.x,o=e.y,r=e.h,i=e.w,a=e.a,s=e.rw,l=void 0===s?0:s,c=n.player,p=c.container,d=c.videoSize,u=d.width,A=d.height;u<=0&&(u=p.clientWidth),A<=0&&(A=p.clientHeight);var _=l>0?Math.min(A,u)/l:1,E=t*_,g=o*_,f=r*_,h=i*_,v=Math.min(p.clientWidth/u,p.clientHeight/A),y=u*v,m=A*v,T=Math.max((p.clientWidth-y)/2,0),C=Math.max((p.clientHeight-m)/2,0),I=h*v,P=f*v,S=T+y-I-E*v,N=C+g*v,D={x:T,y:C,w:y,h:m},O={x:S,y:N,w:I,h:P},x={left:S+"px",top:N+"px",width:I+"px",height:P+"px",position:"absolute",display:"block",opacity:""+a/100};return n.isInScreen(D,O)||(x.display="none"),x},n.config=__assign$2(__assign$2({enableProtectionWatermark:!0},n.player.config.watermarkConfig||{}),o),n.prepareDom(),window.addEventListener("resize",n.onResize),t.on(exports.PLAY_EVENT.FULLSCREEN_CHANGE,n.onResize,-1);var i=n.config.defaultText;return i&&n.watermarkThis(i),n.initMutationObserver(),n.setupPlayerEvents(),n.listenFakeFullscreen(),n}return __extends$1(t,e),t.prototype.add=function(e,t){void 0===t&&(t=!1);var o=e.url,r=e.id;if(!this.watermarks[r]){var n={css:this.computeCss(e),cfg:{id:r,url:o,onerror:function(){this.remove()}}},i=new Watermark(this.$watermarkContainer,n,t);return this.watermarks[r]=[i,e],i}},t.prototype.watermarkThis=function(e,t){void 0===t&&(t={}),this.coverWatermarkParam=null;var o=this.player.container;o.querySelectorAll("."+WaterMarkCoverClassName$1).forEach((function(e){return e.remove()}));var r=document.createElement("div"),n=document.createElementNS("http://www.w3.org/2000/svg","svg"),i=document.createElementNS("http://www.w3.org/2000/svg","text"),a=t.svg,s=void 0===a?{}:a,l=t.text,c=void 0===l?{}:l;r.classList.add(WaterMarkCoverClassName$1),r.style.position="absolute",r.style.width="100%",r.style.height="100%",r.style.userSelect="none",r.style.zIndex="1",n.setAttribute("xmlns","http://www.w3.org/2000/svg");var p=__assign$2(__assign$2({},{width:"200px",height:"200px"}),s);Object.keys(p).forEach((function(e){n.setAttribute(e,p[e])}));var d=__assign$2(__assign$2({},{stroke:"black",transform:"translate(20, 120) rotate(-30)",fill:"rgb(222, 222, 222)",opacity:.3,"stroke-opacity":.3,"stroke-width":1,"font-size":"22"}),c);return Object.keys(d).forEach((function(e){i.setAttribute(e,d[e])})),i.textContent=e,n.appendChild(i),r.style.backgroundImage='url("data:image/svg+xml;utf8,'+n.outerHTML.replace(/"/g,"'")+'")',o.appendChild(r),this.coverWatermarkParam=[e,t],r},t.prototype.remove=function(e){var t,o=(null!==(t=this.watermarks[e])&&void 0!==t?t:[])[0];o&&(o.destroy(),delete this.watermarks[e],delete this.timeTable[e])},t.prototype.clear=function(){Object.values(this.watermarks).forEach((function(e){return e[0].destroy()})),this.watermarks={},this.timeTable={}},t.prototype.get=function(e){return this.watermarks[e]},t.prototype.schedule=function(e,t,o){this.timeTable[e]?this.timeTable[e].push({start:t,end:o}):this.timeTable[e]=[{start:t,end:o}]},t.prototype.unschedule=function(e){var t;delete this.timeTable[e];var o=(null!==(t=this.watermarks[e])&&void 0!==t?t:[])[0];null==o||o.hide()},t.prototype.destroy=function(){var t,o;window.removeEventListener("resize",this.onResize),this.player.off(exports.PLAY_EVENT.FULLSCREEN_CHANGE,this.onResize),e.prototype.destroy.call(this),this.mutationObserver.disconnect(),this.mutationObserver=null,(null===(t=this.$watermarkContainer)||void 0===t?void 0:t.parentNode)&&(null===(o=this.$watermarkContainer)||void 0===o||o.remove())},t.prototype.hookPlaySessionStart=function(){this.clear()},t.prototype.hookVideoTimeupdate=function(e){var t=this,o=e.playtime;Object.entries(this.timeTable).forEach((function(e){var r=e[0],n=e[1],i=t.watermarks[r][0];i&&(n.some((function(e){var t=e.start,r=e.end;return o>t&&o<(void 0===r?1/0:r)}))?i.show():i.hide())}))},t.prototype.initMutationObserver=function(){var e=this;this.mutationObserver&&this.mutationObserver.disconnect(),this.mutationObserver=new MutationObserver((function(t){e.checkIsCoverWatermarkRemoved()})),this.mutationObserver.observe(this.player.container,{childList:!0,subtree:!0,attributes:!0})},t.prototype.checkIsCoverWatermarkRemoved=function(){if(this.coverWatermarkParam){var e=this.player.container.querySelector("."+WaterMarkCoverClassName$1);(null==e?void 0:e.offsetParent)||this.watermarkThis.apply(this,this.coverWatermarkParam)}},t.prototype.setupPlayerEvents=function(){var e=this;this.msg.on(exports.PLAY_EVENT_EXT.GETINFO_OVER,(function(t){var o=t.data;e.watermarkLoadingDefer=new Promise((function(t){return __awaiter$1(e,void 0,void 0,(function(){var e,r,n,i,a,s,l,c,p;return __generator$1(this,(function(d){switch(d.label){case 0:if(!(e=o.parseData))return[2];r=e.watermarkList,n=e.supplementaryInfo,i=(n||{}).contentInfo,a=(i||{}).protectionWatermark,this.config.enableProtectionWatermark&&a&&this.watermarkThis(a),d.label=1;case 1:return d.trys.push([1,3,,4]),[4,requestActionWatermark(null===(p=r)||void 0===p?void 0:p.action,1e3*e.duration)];case 2:return c=d.sent(),s=Object.keys(c.watermarks).map((function(e){return c.watermarks[e]})),l=c.schedules,[3,4];case 3:return d.sent(),[3,4];case 4:return s||(s=e.watermarkList.wi),t([s,l]),[2]}}))}))}))})),this.player.on(exports.H5_PLAY_EVENT.VIDEO_PLAYING,(function(t){var o=t.data;return __awaiter$1(e,void 0,void 0,(function(){var e,t,r;return __generator$1(this,(function(n){switch(n.label){case 0:return o.isFirst?this.watermarkLoadingDefer?(t=(e=this.addPendingData).apply,r=[this],[4,this.watermarkLoadingDefer]):[3,2]:[2];case 1:t.apply(e,r.concat([n.sent()])),n.label=2;case 2:return[2]}}))}))})),this.player.on(exports.H5_PLAY_EVENT.VIDEO_SETLEVEL_END,(function(t){var o=t.data;return __awaiter$1(e,void 0,void 0,(function(){var e,t,r;return __generator$1(this,(function(n){switch(n.label){case 0:return o.code!==exports.ErrorCode.SUC?[2]:(this.clear(),this.watermarkLoadingDefer?(t=(e=this.addPendingData).apply,r=[this],[4,this.watermarkLoadingDefer]):[3,2]);case 1:t.apply(e,r.concat([n.sent()])),n.label=2;case 2:return[2]}}))}))}))},t.prototype.addPendingData=function(e,t){var o=this;e&&e.forEach((function(e){return o.add(e,!e.action)})),t&&Object.keys(t).forEach((function(e){return t[e].forEach((function(t){return o.schedule(e,t.start,t.end)}))})),this.watermarkLoadingDefer=null},t.prototype.prepareDom=function(){var e=this.player.container;e.insertAdjacentHTML("beforeend",str),this.$watermarkContainer=e.querySelector('[data-role="txp-ui-watermark-mod"]')},t.prototype.isInScreen=function(e,t){var o=e.x,r=e.y,n=e.w,i=e.h,a=t.x,s=t.y,l=t.w,c=t.h;return!(a<o)&&(!(s<r)&&(!(a>o+n-l)&&s<=r+i-c))},t.prototype.listenFakeFullscreen=function(){var e=this;this.msg.on("pluginsetup:ctrlbar",(function(){e.player.plugins.ctrlbar.on("browserFullscreenChange",e.onResize)}))},t.pluginName=WatermarkPluginName$1,t}(Plugin);H5Player.registerPlugin(WatermarkPlugin.pluginName,WatermarkPlugin);var superPlayerI18nConfig={TIPS_DEGRADE_TEXT_REASON:"正在缓冲中...",TIPS_DEGRADE_TEXT_NO_REASON:"重新请求视频信息...",ERROR_PAGE_REPORT_SUCCESS:"日志上报成功",ERROR_PAGE_REPORT_FAILED:"日志上报失败 $0",DEFN_SWITCHING:"正在为您切换清晰度[$0]",DEFN_SWITCH_FAILED:"抱歉，切换清晰度失败~",DEFN_SWITCH_SUCCESS:"已为您切换到清晰度[$0]",AUDIO_SWITCHING:"正在为您切换音轨[$0]",AUDIO_SWITCH_FAILED:"抱歉，切换音轨失败~",AUDIO_SWITCH_SUCCESS:"已为您切换到音轨[$0]",LIVE_STREAM_END:"直播已结束",ERROR_LOAD_PARAM_NOT_SUPPORT:"直播模式不支持load()接口",ERROR_VID_NOT_SUPPORT:"直播模式不支持传入vid",ERROR_CNLID_NOT_SUPPORT:"点播模式不支持传入cnlid",ERROR_VID_INVALID:"vid参数非法",PREVIEW_TIPS:'可试看 $0，去腾讯视频观看完整版 <a target="_blank;" href="$1">立即前往</a>',PROXY_HTTP_PARSE_ERROR:"播放后台返回错误码（$0）"};defaultI18nConfig.superPlayer=superPlayerI18nConfig;var Poller=function(){function e(){var e=this;this.MAX_RETRY_TIMES=-1,this.markContext="last=0",this.pollInterval=3e4,this.reqData=null,this.timeout=5e3,this.loadInfo=function(){if(e.reqData){e.reqData.markContext=encodeURIComponent(e.markContext),e.reqData.tm=+new Date,e.reqData.vappid="31678259",e.reqData.vsecret="1e029a67beb2d7e7e7bb8321fb161a46fe76c7837beb2cee",e.reqData.otype="json",e.reqData.raw="1";var t={url:"https://zbaccess.video.qq.com/fcgi/live_poll?"+urlTool.object2string(e.reqData,"&")};return-1!==e.timeout&&(t.timeout=e.timeout),netTool.xhr(t).then(e.onCGIComplete).catch((function(t){throw e.onCGIError(t),t}))}},this.onCGIComplete=function(t){var o,r;e.clearTimer(),e.errorRetryTimes=0;try{r=JSON.parse(null==t?void 0:t.data).data}catch(t){e.onCGIError(t)}if(0===(null==r?void 0:r.errCode)){var n=Number(r.pollTimeOut);!isNaN(n)&&n>0&&(e.pollInterval=1e3*n),e.pollTimerID=window.setTimeout(e.loadInfo,e.pollInterval),null===(o=e.onCallback)||void 0===o||o.call(e,null,r),r.markContext&&(e.markContext=r.markContext)}else e.onCGIError(r)}}return e.prototype.start=function(e,t){return void 0===e&&(e={}),this.reqData=e,this.errorRetryTimes=0,this.onCallback=t,this.loadInfo()},e.prototype.dispose=function(){this.clearTimer(),this.reqData=null,this.onCallback=null},e.prototype.onCGIError=function(e){var t;this.clearTimer(),this.errorRetryTimes+=1,-1===this.MAX_RETRY_TIMES||this.errorRetryTimes<=this.MAX_RETRY_TIMES?this.pollTimerID=window.setTimeout(this.loadInfo,this.pollInterval):null===(t=this.onCallback)||void 0===t||t.call(this,e,null)},e.prototype.clearTimer=function(){this.pollTimerID>0&&(clearTimeout(this.pollTimerID),this.pollTimerID=0)},e}(),LIVE_STATUS;!function(e){e[e.READY=1]="READY",e[e.PLAYING=2]="PLAYING",e[e.OVER=3]="OVER"}(LIVE_STATUS||(LIVE_STATUS={}));var LIVE_EVENTS={statusChange:"statusChange"},getUin=function(){var e=cookieTool.get("uin")||cookieTool.get("luin"),t=parseInt(e.replace(/^o0*/g,""),10);return isNaN(t)||t<=1e4?0:t},LivepollPlugin=function(e){function t(t,o){var r=e.call(this,t)||this;r.status=LIVE_STATUS.READY,r.poller=new Poller,r.destory=function(){return r.poller.dispose()},r.handlerLivePollData=function(e,t){if(!e&&t){var o=Number(t.liveStatus);o!==r.status&&(r.emit(LIVE_EVENTS.statusChange,{old:r.status,new:o,raw:t}),o===LIVE_STATUS.OVER&&(r.player.stop(),r.destory())),r.status=o}},r.config=__assign$2(__assign$2({},t.config.livepollConfig),o);var n=r.config,i=n.livepid,a=n.autolisten,s=void 0===a||a,l=n.timeout,c=void 0===l?5e3:l;return r.poller.timeout=c,i&&(r.livepid=i),s&&(t.addListener(exports.PLAY_EVENT.FIRST_PLAYING,(function(){return r.request()})),t.addListener(exports.PLAY_EVENT.STOPED,r.destory)),r}return __extends$1(t,e),t.prototype.request=function(e){if((null==e?void 0:e.livepid)&&(this.livepid=e.livepid),this.poller.dispose(),this.livepid)return this.poller.start({pollDataKey:encodeURIComponent("pid="+this.livepid),needMarkInfo:1,qqlog:getUin(),guid:this.player.getCommonKv("guid")},this.handlerLivePollData)},t.pluginName="live-poll",t}(Plugin);function styleInject(e,t){void 0===t&&(t={});var o=t.insertAt;if(e&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css","top"===o&&r.firstChild?r.insertBefore(n,r.firstChild):r.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}}H5Player.registerPlugin(LivepollPlugin.pluginName,LivepollPlugin);var css_248z="@-webkit-keyframes txp_loading{0%{background-position:0 0}to{background-position:0 -600px}}@keyframes txp_loading{0%{background-position:0 0}to{background-position:0 -600px}}.txp_overlay_loading{position:absolute;left:0;top:0;width:100%;height:100%;z-index:1;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;pointer-events:none}.txp_overlay_loading.txp_none,.txp_overlay_loading .txp_none{display:none}.txp_overlay_loading .txp_icon_loading{display:block;width:54px;height:20px;margin:0 auto 10px;background:url(https://vm.gtimg.cn/tencentvideo/txp/style/img/loading.png) 0 0 no-repeat;background-size:54px 600px;-webkit-animation:txp_loading 1s steps(30) infinite;animation:txp_loading 1s steps(30) infinite}.txp_overlay_loading .txp_icon_loading.mobile{-webkit-transform:scale(.5);transform:scale(.5);margin:0 auto}";styleInject(css_248z);var hideClass$1="txp_none",htmlStr='<div class="txp_overlay_loading '+hideClass$1+'">\n<div class="txp_text" data-role="txp-ui-continue-play"></div>\n<div class="txp_icon_loading" data-role="txp-ui-loading"></div>\n</div>',UILoadingPlugin=function(e){function t(t,o,r){var n=e.call(this,t,o,r)||this;return n.show=function(e){void 0===e&&(e=""),n.$continuePlay.innerHTML=e,n.$el.classList.remove(hideClass$1)},n.hide=function(){n.$el.classList.add(hideClass$1)},n.insertDOM(),t.on(exports.PLAY_EVENT.SET_LOADING,(function(e){var t=e.data.show;n.player.setStateKv("ui-loading:"+(t?"show":"hide"),{type:exports.LOG_TYPE.PLUGIN_ACTION}),t?n.show():n.hide()})),n}return __extends$1(t,e),t.prototype.prependElement=function(e){var t;null===(t=this.$el)||void 0===t||t.insertAdjacentElement("afterbegin",e)},t.prototype.insertDOM=function(){var e,t=this.player.container;t.insertAdjacentHTML("beforeend",htmlStr),this.$el=t.querySelector(".txp_overlay_loading"),this.$continuePlay=t.querySelector('[data-role="txp-ui-continue-play"]'),this.$loading=t.querySelector('[data-role="txp-ui-loading"]'),(null===(e=this.config)||void 0===e?void 0:e.useMobileStyle)&&this.$loading.classList.add("mobile")},t.pluginName="ui-loading",t}(Plugin);H5Player.registerPlugin(UILoadingPlugin.pluginName,UILoadingPlugin);var extendStatics=function(e,t){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},extendStatics(e,t)};function __extends(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}var __assign$1=function(){return __assign$1=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},__assign$1.apply(this,arguments)};function __awaiter(e,t,o,r){return new(o||(o=Promise))((function(n,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))}function __generator(e,t){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function __spreadArray(e,t,o){if(o||2===arguments.length)for(var r,n=0,i=t.length;n<i;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))}var tvkI18nConfig={POLL_DURATION_WILL_SWITCH:"恭喜解锁新功能，本视频稍后将为你扩充为完整版！",POLL_DURATION_SWITCH_SUCCESS:"进度条抢救成功！",GETINFO_MISSING_PARAM:"缺少必要播放参数 ($0)",DEFN_ABR_LABEL:"自动",DEVICE_SCORE_NOT_PASS:"当前设备不支持播放"};defaultI18nConfig.tvk=tvkI18nConfig;var Controller=function(){function e(e,t){this.player=e,this.tvk=t,this.config=t.config}return e.prototype.destroy=function(){this.player=null,this.tvk=null},e.prototype.log=function(){for(var e,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];(e=this.tvk.logger).log.apply(e,__spreadArray(["[".concat(this.constructor.moduleName,"]")],t,!1))},e.prototype.warn=function(){for(var e,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];(e=this.tvk.logger).warn.apply(e,__spreadArray(["[".concat(this.constructor.moduleName,"]")],t,!1))},e.prototype.error=function(){for(var e,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];(e=this.tvk.logger).error.apply(e,__spreadArray(["[".concat(this.constructor.moduleName,"]")],t,!1))},e.moduleName="base-controller",e}(),AudioTrackController=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.audioTrackInfoFromServer=[],t.drmType=void 0,t.onGetInfoOver=function(e){var o,r,n=e.data,i=n.parseData,a=n.error,s=n.resData,l=n.urlConfig;!a&&i&&l?(t.drmType=null===(o=l.drmConfig)||void 0===o?void 0:o.keySystem,t.audioTrackInfoFromServer=null===(r=null==i?void 0:i.additionalTrackInfo)||void 0===r?void 0:r.altAudioTrack):t.log("no parsed info found from getvinfo",a,s)},t.onVideoSetLevelOver=function(e){if(e.data,t.player.currentVideoInfo){var o=t.player.currentVideoInfo.currentAudioTrack;t.configureDataSet(null,o)}},t.onHlsManifestParsed=function(e){var o=e.data,r=o.playerInstanceId,n=o.audioTracks,i=void 0===n?[]:n;r===t.player.config.instanceId&&0!==i.length&&(t.drmType===KeySystems.Widevine&&(i[0].default=!0),t.configureDataSet(t.updateAudioTrackInfo(i),null))},t.onVideoCanPlay=function(){if(t.player.currentVideoInfo){var e=t.player.currentVideoInfo.currentAudioTrack;t.configureDataSet(null,e)}},t.updateAudioTrackInfo=function(e){var o,r,n;if(!e.length||!t.audioTrackInfoFromServer)return null;var i=t.audioTrackInfoFromServer.find((function(e){return-1===e.id})),a=i?{value:i.id,btnLabel:null!==(o=i.name)&&void 0!==o?o:"",label:null!==(r=i.displayName)&&void 0!==r?r:"",payload:null!==(n=i.displayName)&&void 0!==n?n:""}:null,s=e.map((function(e){var o,r,n,i=t.audioTrackInfoFromServer.find((function(t){return t.name===e.name||t.name===e.lang}));return i?{value:e.id,btnLabel:null!==(o=i.name)&&void 0!==o?o:"",label:null!==(r=i.displayName)&&void 0!==r?r:"",payload:null!==(n=i.displayName)&&void 0!==n?n:""}:null})).concat(a).filter((function(e){return!!e}));return t.player.currentVideoInfo.audioTracks=s.map((function(e){return{name:e.btnLabel,id:e.value}})),s},t.onAudioTrackSwitching=function(e){t.configureDataSet(null,e.data.id)},t.onAudioTrackSwitched=function(e){e.data.fail||t.configureDataSet(null,e.data.id)},t}return __extends(t,e),Object.defineProperty(t.prototype,"ready",{get:function(){return Promise.resolve(!0)},enumerable:!1,configurable:!0}),t.prototype.init=function(){this.setupPlayerEventListeners(),this.log("init success")},t.prototype.destroy=function(){this.removePlayerEventListeners(),this.audioTrackInfoFromServer=void 0,this.drmType=void 0,e.prototype.destroy.call(this)},t.prototype.configureDataSet=function(e,t){e&&(this.log("setting audioTrack options to player",e),this.player.setCommonKv(COMMON_DATA_KEY.currentAudioTrackList,e)),"number"==typeof t&&(this.log("setting current audioTrack to player",t),this.player.setCommonKv(COMMON_DATA_KEY.currentAudioTrack,t))},t.prototype.setupPlayerEventListeners=function(){this.player.pluginMsg.on(exports.PLAY_EVENT_EXT.GETINFO_OVER,this.onGetInfoOver),this.player.on(exports.PLAY_EVENT.SET_AUDIO_TRACK_START,this.onAudioTrackSwitching),this.player.on(exports.PLAY_EVENT.SET_AUDIO_TRACK_OVER,this.onAudioTrackSwitched),this.player.on(exports.H5_PLAY_EVENT.VIDEO_CANPLAY,this.onVideoCanPlay),this.player.on(exports.H5_PLAY_EVENT.VIDEO_SETLEVEL_END,this.onVideoSetLevelOver),kernelEvtBus.on("hlsManifestParsed",this.onHlsManifestParsed)},t.prototype.removePlayerEventListeners=function(){this.player.pluginMsg.off(exports.PLAY_EVENT_EXT.GETINFO_OVER,this.onGetInfoOver),this.player.off(exports.PLAY_EVENT.SET_AUDIO_TRACK_START,this.onAudioTrackSwitching),this.player.off(exports.PLAY_EVENT.SET_AUDIO_TRACK_OVER,this.onAudioTrackSwitched),this.player.off(exports.H5_PLAY_EVENT.VIDEO_CANPLAY,this.onVideoCanPlay),this.player.off(exports.H5_PLAY_EVENT.VIDEO_SETLEVEL_END,this.onVideoSetLevelOver),kernelEvtBus.off("hlsManifestParsed",this.onHlsManifestParsed)},t.moduleName="audio-track-controller",t}(Controller),PAID_FORMAT,_a$3;function getRequestParamForPaidFormat(e){var t={spsfrhdr:0,spvideo:0,spaudio:0,defnpayver:0};return e.indexOf(exports.PAID_FORMAT.FHD)>-1&&(t.defnpayver|=1),e.indexOf(exports.PAID_FORMAT.UHD)>-1&&(t.defnpayver|=2),videoTool.supportHevc()&&videoTool.isHDRSupported()===HDR_CAPABILITY.SUPPORTED&&(e.indexOf(exports.PAID_FORMAT.HDR10)>-1&&(t.spvideo|=4,t.defnpayver|=4),e.indexOf(exports.PAID_FORMAT.SFR_HDR)>-1&&(t.spvideo|=4,t.spaudio|=64,t.spsfrhdr=100,t.defnpayver|=4),uaTool.browser.safari&&!uaTool.mobile&&e.indexOf(exports.PAID_FORMAT.DOLBY)>-1&&videoTool.isDolbyAtomsSupported()&&videoTool.isDolbyVisionSupported()&&(t.spaudio|=4,t.spvideo|=16,t.defnpayver|=4)),t}function builtDefinitionOption(e,t,o){var r={prefix:"",suffix:"",content:""};return(null==o?void 0:o.prefix)&&(r.prefix="function"==typeof o.prefix?o.prefix(e):void 0),(null==o?void 0:o.suffix)&&(r.suffix="function"==typeof o.suffix?o.suffix(e):void 0),(null==o?void 0:o.content)&&(r.content="function"==typeof o.content?o.content(e):void 0),t?builtRegularOption(e,!0,r):buildVodDefinitionOption(e,r)}function buildVodDefinitionOption(e,t){var o=e.name;return o===exports.PAID_FORMAT.HDR10||o===exports.PAID_FORMAT.SFR_HDR||o===exports.PAID_FORMAT.DOLBY?builtSpecialOption(e,o,t):builtRegularOption(e,!1,t)}function builtSpecialOption(e,t,o){var r,n=e.name,i=e.resolution,a=e.cname,s=e.lmt,l=e.sname,c=formatDefnName$1(a,!1)[0],p=void 0===c?"":c,d=o.suffix||(s?vipIcon:void 0),u=o.prefix||constructIconContainer(SpecialResolutionPrefixIcons[t],{width:"30px"}),A=((r={})[exports.PAID_FORMAT.DOLBY]=i,r[exports.PAID_FORMAT.HDR10]=constructHDRBtnLabel(l.substring(0,2)),r[exports.PAID_FORMAT.SFR_HDR]=i,r);return{label:constructDesktopOptionTemplate(p,u,d),btnLabel:A[t],value:n,payload:i}}function builtRegularOption(e,t,o){var r=e.cname,n=e.name,i=e.lmt,a=formatDefnName$1(r,t),s=a[0],l=void 0===s?"":s,c=a[1],p=void 0===c?"":c,d=o.suffix||(i?vipIcon:void 0),u=o.content||"".concat(p," ").concat(l);return{label:uaTool.mobile?constructMobileOptionTemplate(p,l):constructDesktopOptionTemplate(u,o.prefix,d),btnLabel:p,value:n,payload:"".concat(p," ").concat(l)}}function constructDesktopOptionTemplate(e,t,o){var r=createFlexDiv({alignItems:"center"});t&&r.insertAdjacentHTML("afterbegin",t);var n=createFlexDiv();return n.innerHTML=e,r.appendChild(n),o&&r.insertAdjacentHTML("beforeend",o),r.outerHTML}function constructMobileOptionTemplate(e,t){return"<div>".concat(t,"<div><div>").concat(e,"</div>")}function constructHDRBtnLabel(e){var t=createFlexDiv({alignItems:"center",width:"100%"});t.textContent=e;var o=createFlexDiv({transform:"scale(0.8)"});return o.innerHTML=hdrOptionIcon,t.insertAdjacentElement("beforeend",o),t.outerHTML}function constructIconContainer(e,t){var o=document.createElement("div");return o.className="tp-defn-option-icon-container",t&&Object.entries(t).forEach((function(e){var t=e[0],r=e[1];o.style[t]=r})),o.innerHTML=e,o.outerHTML}function createFlexDiv(e){var t=document.createElement("div");return t.style.display="flex",e&&Object.keys(e).forEach((function(o){t.style[o]=e[o]})),t}function formatDefnName$1(e,t){if(void 0===t&&(t=!1),t)return formatLiveDefnName$1(e);if(!(null==e?void 0:e.length))return["",""];var o=e.match(/(.*);\((.*)\)/);return o&&o.length>=3?[o[1],o[2]]:["",e]}function formatLiveDefnName$1(e){if(!(null==e?void 0:e.length))return["",""];var t=e.split(" ");return[t[0],t[1]]}exports.PAID_FORMAT=void 0,PAID_FORMAT=exports.PAID_FORMAT||(exports.PAID_FORMAT={}),PAID_FORMAT.FHD="fhd",PAID_FORMAT.UHD="uhd",PAID_FORMAT.DOLBY="dolby",PAID_FORMAT.HDR10="hdr10",PAID_FORMAT.SFR_HDR="sfr_hdr";var dolbyOptionIcon='<svg class="tp-dolby-prefix-icon" width="22" height="14" viewBox="0 0 22 14" fill="none" xmlns="http://www.w3.org/2000/svg">\n <path fill-rule="evenodd" clip-rule="evenodd" d="M0.714233 1.14282C0.714233 0.590537 1.16195 0.142822 1.71423 0.142822H20.2857C20.8379 0.142822 21.2857 0.590537 21.2857 1.14282V12.8571C21.2857 13.4094 20.8379 13.8571 20.2857 13.8571H1.71423C1.16195 13.8571 0.714233 13.4094 0.714233 12.8571V1.14282ZM2.42852 1.85711H4.99995C7.84027 1.85711 10.1428 4.15965 10.1428 6.99997C10.1428 9.84028 7.84027 12.1428 4.99995 12.1428H2.42852V1.85711ZM16.9999 1.85711C14.1596 1.85711 11.8571 4.15965 11.8571 6.99997C11.8571 9.84028 14.1596 12.1428 16.9999 12.1428H19.5714V1.85711H16.9999Z" fill="currentColor"/>\n </svg>',hdrOptionIcon='<svg class="tp-hdr-prefix-icon" width="12" height="14" viewBox="0 0 12 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n <path d="M0 14.4449L0.02931 12.2882L8.90291 1.4655H0.271117V0H12L0 14.4449Z" fill="currentColor"/>\n <path d="M11.8315 15.7615H0.102661L11.7925 1.72937L11.7778 4.04974L3.19975 14.296H11.8315V15.7615Z" fill="currentColor"/>\n <path d="M11.9 12.0219H8.03349L11.9 7.40312V5.12915L4.9364 13.4874H11.9V12.0219Z" fill="currentColor"/>\n </svg>',vipIcon='<div style="margin-left: 6px; padding: 0 2px;transform: scale(0.8);border: 1px solid #fc3f4c;border-radius: 2px;color: #fc3f4c;font-size: 12px;letter-spacing: 1px;line-height: 14px;text-align: center;">VIP</div>',SpecialResolutionPrefixIcons=(_a$3={},_a$3[exports.PAID_FORMAT.DOLBY]=dolbyOptionIcon,_a$3[exports.PAID_FORMAT.HDR10]=hdrOptionIcon,_a$3[exports.PAID_FORMAT.SFR_HDR]=hdrOptionIcon,_a$3),DefinitionController=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.useKernelLevel=!0,t.onVideoPlaying=function(e){var o=e.data.isFirst,r=t.player.currentVideoInfo||{},n=r.levels,i=r.currentLevel,a=r.isAutoLevel;if(o&&t.useKernelLevel&&(null==n?void 0:n.length)&&i){var s=n.sort((function(e,t){return t.bitrate-e.bitrate})).map((function(e){return t.parseKernelLevel(e)}));t.isEnableAbrLevel()&&s.length>1&&s.push(__assign$1(__assign$1({},ABR_LEVEL),{url:n[0].url})),t.configureDataSet(s,String(a?ABR_LEVEL.value:i.id))}},t.onGetInfoOver=function(e){var o,r=e.data,n=r.parseData,i=r.error;if(!i&&n){var a=n.definitionList;if(a){var s=[],l=(null===(o=a.find((function(e){return 1===e.sl})))||void 0===o?void 0:o.name)||null;a.forEach((function(e){if(t.shouldExecuteUHDHijack(e.name))s.push(t.builtUHDClientOption(e));else{var o=builtDefinitionOption(e,t.player.config.type===exports.PLAY_MODE.LIVE,t.config.definitionOptionDecorator);s.push(o)}})),t.useKernelLevel=!1,t.configureDataSet(s,l)}else t.log("no definitionList found from getvinfo",a)}else t.log("no parsed info found from getvinfo",i,n)},t.onCtrlbarSetLevel=function(e){var o=((null==e?void 0:e.data)||{}).value;if(t.shouldExecuteUHDHijack(o))return t.log("intercept uhd level switch in no hevc support environment, call native client"),t.tvk.emit("tvkRequireClient",{detail:"notSupportUHD"}),s.STOP_IMMEDIATE_PROPAGATION},t}return __extends(t,e),Object.defineProperty(t.prototype,"ready",{get:function(){return Promise.resolve(!0)},enumerable:!1,configurable:!0}),t.prototype.init=function(){this.ctrlbarPlugin=this.player.plugins[OFFICIAL_PLUGIN.CTRLBAR],this.setupPlayerEventListeners(),this.log("init success")},t.prototype.destroy=function(){this.removePlayerEventListeners(),e.prototype.destroy.call(this)},t.prototype.configureDataSet=function(e,t){e&&(this.log("setting definition options to player",e),this.player.setCommonKv(COMMON_DATA_KEY.currentDefnList,e)),t&&(this.log("setting current definition to player",t),this.player.setCommonKv(COMMON_DATA_KEY.currentDefn,t))},t.prototype.parseKernelLevel=function(e){var t=e.name,o=e.id,r=e.url;return{value:o,label:t,payload:t,btnLabel:t,url:e.masterUrl||r}},t.prototype.isEnableAbrLevel=function(){return this.player.kernelName===exports.KERNEL_NAME.HLS_JS&&this.player.config.hlsjsKernelConfig.enableAbrLevel},t.prototype.setupPlayerEventListeners=function(){var e;this.player.pluginMsg.on(exports.PLAY_EVENT_EXT.GETINFO_OVER,this.onGetInfoOver),null===(e=this.ctrlbarPlugin)||void 0===e||e.on(ctrlbarEventName,this.onCtrlbarSetLevel,Number.MAX_SAFE_INTEGER),this.player.on(exports.H5_PLAY_EVENT.VIDEO_PLAYING,this.onVideoPlaying)},t.prototype.removePlayerEventListeners=function(){var e;this.player.pluginMsg.off(exports.PLAY_EVENT_EXT.GETINFO_OVER,this.onGetInfoOver),null===(e=this.ctrlbarPlugin)||void 0===e||e.off(ctrlbarEventName,this.onCtrlbarSetLevel)},t.prototype.builtUHDClientOption=function(e){return builtDefinitionOption(e,!1,__assign$1(__assign$1({},this.config.definitionOptionDecorator),{content:function(e){return"客户端 ".concat(e.resolution)}}))},t.prototype.shouldExecuteUHDHijack=function(e){return e===exports.PAID_FORMAT.UHD&&this.config.showUHDClientGuide&&!videoTool.supportHevc()},t.moduleName="definition-controller",t}(Controller),ctrlbarEventName="ctrl:set-level",ABR_LABEL=compile(i18nConfig.tvk.DEFN_ABR_LABEL),ABR_LEVEL={value:"abr",btnLabel:ABR_LABEL,label:ABR_LABEL,payload:ABR_LABEL},defaultTVKConfig={scoreMaskForBlocking:0,scoreMaskForReporting:0,debug:!1,definitionController:DefinitionController,audioTrackController:AudioTrackController},DISCONTINUE_REGEX=/#EXT-X-DISCONTINUITY/;function rebuildM3U8(e,t){if(!t||0===t.length)return[e,[]];for(var o=[],r=e.split(/[\r\n]/),n=0,i=!1,a=[];n<r.length;){if(DISCONTINUE_REGEX.test(r[n])){if(i){a.push(n),o.push(a),a=[],i=!1,n+=1;continue}a.push(n),i=!0}n+=1}var s=mergeM3U8(t.slice().sort((function(e,t){return e.start-t.start})).map((function(e,t){return __assign$1(__assign$1({},e),{m3u8:o[t]?r.slice(o[t][0],o[t][1]+1).join("\n"):""})})));return[r.filter((function(e,t){return!o.some((function(e){return t>=e[0]&&t<=e[1]}))})).join("\n"),s]}function mergeM3U8(e){var t=[],o=e[0].start,r=-1,n=e[0].m3u8;return e.forEach((function(e){var i=e.start,a=e.end,s=e.m3u8;if(i<=r)return r=a,void(n="".concat(n,"\n").concat(s));r>=0&&t.push({start:o,end:r,m3u8:"".concat(M3U8_HEADER).concat(n,"\n").concat(M3U8_FOOTER)}),o=i,r=a,n=s})),t.push({start:o,end:r,m3u8:"".concat(M3U8_HEADER).concat(n,"\n").concat(M3U8_FOOTER)}),t}var M3U8_HEADER="#EXTM3U\n#EXT-X-VERSION:3\n#EXT-X-MEDIA-SEQUENCE:0\n#EXT-X-PLAYLIST-TYPE:VOD\n",M3U8_FOOTER="#EXT-X-ENDLIST\n",NetworkController=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onGetInfoOver=function(e){var o,r,n,i=e.data,a=i.resData,s=i.parseData;if(0===(null==a?void 0:a.em)){var l=[];if(a.play){var c=a.play,p=c.master,d=c.keyid,u=c.audiolist,A=void 0===u?[]:u,_=c.videolist,E=void 0===_?[]:_,g=c.masterurl,f=void 0===g?[]:g;return d&&p&&(t.context.m3u8[d]=p),d&&f.forEach((function(e){t.context.keyid[e]=d})),E.forEach((function(e){t.context.m3u8[e.keyid]=e.m3u8})),A.forEach((function(e){t.context.m3u8[e.keyid]=e.m3u8})),a.vl.vi[0].ul.ui.forEach((function(e){t.context.keyid[e.url]="".concat(a.vl.vi[0].keyid,".hls"),l.push(e.url)})),void t.configHlsjsKernel({externalRedundantUrls:l})}if(8===a.dltype){var h=a.vl.vi[0].ul.m3u8,v=a.vl.vi[0].keyid;if(uaTool.browser.safari){var y=rebuildM3U8(h,null===(r=null===(o=null==s?void 0:s.supplementaryInfo)||void 0===o?void 0:o.contentInfo)||void 0===r?void 0:r.ad),m=y[0],T=y[1];t.context.m3u8[v]=m,T.forEach((function(e,o){var r="".concat(v,".ad.").concat(o);t.context.m3u8[r]=e.m3u8}))}else t.context.m3u8[v]=h;return null===(n=null==s?void 0:s.urls)||void 0===n||n.forEach((function(e){KEYID_LOOKUP_REGEX.test(e.url)||(l.push(e.url),5!==t.player.getCommonKv(COMMON_DATA_KEY.drm)&&(t.context.keyid[e.url]=v))})),void t.configHlsjsKernel({externalRedundantUrls:l})}}},t.onPlaySessionEnd=function(){t.resetContext()},t.onHlsManifestParsed=function(e){var o=e.data,r=o.playerInstanceId,n=o.audioTracks,i=void 0===n?[]:n,a=o.levels,s=void 0===a?[]:a;r===t.player.config.instanceId&&(i.forEach((function(e){var o=findKeyid(e);o&&(t.context.keyid[e.url]=o)})),s.forEach((function(e){var o=findKeyid(e);o&&(t.context.keyid[e.url]=o)})))},t}return __extends(t,e),Object.defineProperty(t.prototype,"ready",{get:function(){return Promise.resolve(!0)},enumerable:!1,configurable:!0}),t.prototype.init=function(){this.resetContext(),this.configHlsjsKernel({pProxy:this.lookupCache.bind(this)}),this.setupEventListeners()},t.prototype.destroy=function(){this.removeEventListeners(),this.resetContext(),e.prototype.destroy.call(this)},t.prototype.setupEventListeners=function(){this.player.pluginMsg.on(exports.PLAY_EVENT_EXT.GETINFO_OVER,this.onGetInfoOver),this.player.pluginMsg.on(exports.PLAY_EVENT_EXT.PRELOAD_GETINFO_OVER,this.onGetInfoOver),this.player.on(exports.H5_PLAY_EVENT.PLAY_SESSION_END,this.onPlaySessionEnd),kernelEvtBus.on("hlsManifestParsed",this.onHlsManifestParsed)},t.prototype.removeEventListeners=function(){this.player.pluginMsg.off(exports.PLAY_EVENT_EXT.GETINFO_OVER,this.onGetInfoOver),this.player.pluginMsg.off(exports.PLAY_EVENT_EXT.PRELOAD_GETINFO_OVER,this.onGetInfoOver),this.player.off(exports.H5_PLAY_EVENT.PLAY_SESSION_END,this.onPlaySessionEnd),kernelEvtBus.off("hlsManifestParsed",this.onHlsManifestParsed)},t.prototype.resetContext=function(){this.log("reset context"),this.context={m3u8:{},keyid:{}}},t.prototype.configHlsjsKernel=function(e){void 0===e&&(e={});var t=Object.assign({},this.player.config.hlsjsKernelConfig,e);this.player.config.hlsjsKernelConfig=t},t.prototype.lookupCache=function(e){this.log("proxy download",e,this.context);var t=this.getKeyIdFromUrl(e);return t?this.lookupByKeyId(t):(this.log("no keyid found for url",e),null)},t.prototype.getKeyIdFromUrl=function(e){for(var t;null!==(t=KEYID_LOOKUP_REGEX.exec(e));)return t[1];return this.context.keyid[e]},t.prototype.lookupByKeyId=function(e){var t=this.context.m3u8[e];return t?(this.log("m3u8 found for keyid, network request skipped",e),t):(this.log("no m3u8 found for keyid",e),null)},t.moduleName="network-controller",t}(Controller),KEYID_LOOKUP_REGEX=/keyid:\/\/([0-9a-zA-Z.]+).m3u8/,TXV_KEYID_TAGNAME="EXT-QQHLS-STREAM-KEYID";function findKeyid(e){var t,o=e.tags;return o?null===(t=o.find((function(e){return e[0]===TXV_KEYID_TAGNAME})))||void 0===t?void 0:t[1]:null}var getQQFromCookie=function(){var e=cookieTool.get("luin")||cookieTool.get("uin");return e&&(e=e.replace(/\D/g,"").replace(/^0+/,"")),e},getPtag=function(){var e,t=document.location.toString().toLowerCase();if(e=["ptag","adtag","pgv_ref"].find((function(e){return urlTool.getUrlParamByKey(t,e)})),e)return e;try{e=sessionStorage.getItem("ptag")}catch(e){}if(e)return e;var o=urlTool.getDomainOfURL(document.referrer);return["v.qq.com","film.qq.com","m.v.qq.com"].includes(o)||(e=o.replace(/\./g,"_")),e||(e=cookieTool.get("ptag"))},LoginType;function stringifyAndReplaceCommaInParams(e){return jsonTool.safelyStringify(e).replace(/,/g,"\\,")}function safelyConvertToNumber(e,t){return void 0===t&&(t=!1),isNaN(e)||!isFinite(e)?0:t?Math.round(+e):+e}!function(e){e[e.none=0]="none",e[e.wx=3]="wx",e[e.qq=1]="qq"}(LoginType||(LoginType={}));var whichBoss$1=function(){return uaTool.mobile?{id:MOBILE_ATTAID$1,token:MOBILE_ATTA_TOKEN$1}:{id:DESKTOP_ATTAID$1,token:DESKTOP_ATTA_TOKEN$1}},DESKTOP_ATTAID$1="zae00003007",DESKTOP_ATTA_TOKEN$1="2345779398",MOBILE_ATTAID$1="zbb00003101",MOBILE_ATTA_TOKEN$1="3917576196",DEFAULT_KEYS$1={iQQ:"",sid:COMMON_DATA_KEY.vid,pid:COMMON_DATA_KEY.livepid,playno:COMMON_DATA_KEY.flowid,guid:COMMON_DATA_KEY.guid,ctime:"",sdtfrom:COMMON_DATA_KEY.sdtfrom,surl:"",sref:"",flashver:"",fplayerver:COMMON_DATA_KEY.playerver,P2PVer:"",vurl:"",tpay:"",cpay:"",ptag:"",adid:"",playtime:"",error_code:"",drm:COMMON_DATA_KEY.drmtype,rest_preview_cnt:"",hc_main_login:COMMON_DATA_KEY.hc_main_login,hc_openid:COMMON_DATA_KEY.hc_openid,hc_vuserid:COMMON_DATA_KEY.hc_vuserid,hc_appid:COMMON_DATA_KEY.hc_appid,extrainfo:"",platform:COMMON_DATA_KEY.platform},LiveFlowReporterPlugin=function(e){function t(t,o,r){var n=e.call(this,t,o,r)||this;n.FLOW_DATA_KEY="",n.REPORT_URL="//h.trace.qq.com/bosskv?",n.step5Timer=null,n.started=!1,n.setEvtHandler=function(){n.msg.on(exports.PLAY_EVENT_EXT.DATASET_STATE_UPDATE,n.onStateChange)},n.onStateChange=function(e){var t,o=e.data,r=o.key,i=((t={})[exports.DATA_STATE.LOAD_END]=n.step6,t[exports.DATA_STATE.SET_LEVEL_START]=n.step8,t[exports.DATA_STATE.GET_INFO_END]=n.step4,t[exports.DATA_STATE.SESSION_END]=n.onEnd,t[exports.DATA_STATE.SESSION_START]=n.start,t);i[r]&&i[r](o)},n.start=function(){n.started=!0,n.step3()},n.step3=function(){n.report({step:"3",val:0,val1:0,val2:0}),n.step5Timer=setInterval((function(){n.step5()}),6e4)},n.step4=function(e){var t=e.newVal,o=void 0===t?{}:t,r=e.startEvent,i=void 0===r?{}:r,a={val:o.ftime-i.ftime,val1:0,val2:0};n.reportedEvt.step4||(n.reportedEvt.step4=!0,n.report(__assign$1({step:"4"},a))),n.report(__assign$1({step:"1100"},a))},n.step5=function(){n.report({step:"5",val:6e4,val1:0,val2:0})},n.step6=function(e){var t=e.newVal,o=void 0===t?{}:t,r=e.startEvent,i=void 0===r?{}:r,a={step:"6",val:o.ftime-i.ftime,val1:n.reportedEvt.step7?1:0,val2:0};n.report(a)},n.step7=function(){n.report({step:"7",val:0,val1:0,val2:0})},n.step8=function(){n.report({step:"8",val:0,val1:0,val2:0})},n.onEnd=function(){n.step5Timer&&(clearInterval(n.step5Timer),n.step5Timer=null),n.reportedEvt={}};var i=t.config.liveFlowReporterConfig;return n.config=__assign$1({paramsKey:__assign$1(__assign$1({},DEFAULT_KEYS$1),(null==i?void 0:i.paramsKey)||{}),onBeforeReport:i.onBeforeReport,forceImage:i.forceImage},whichBoss$1()),n.setEvtHandler(),n}return __extends(t,e),Object.defineProperty(t.prototype,"reportHeader",{get:function(){var e,t=this.config.paramsKey,o=void 0===t?{}:t,r=this.player.getCommonKv;return{attaid:this.config.id,token:this.config.token,iQQ:r(o.iQQ)||getQQFromCookie(),sid:r(o.sid)||"",pid:r(o.pid)||"",playno:r(o.playno),guid:r(o.guid)||"",ctime:comTool.dateFormat(void 0,void 0),sdtfrom:r(o.sdtfrom)||"",surl:r(o.surl)||location.href,sref:r(o.sref)||document.referrer,flashver:r(o.flashver)||"",fplayerver:r(o.fplayerver)||"",P2PVer:r(o.P2PVer)||"",vurl:r(o.vurl)||(null===(e=this.player.currentVideoInfo)||void 0===e?void 0:e.loadingUrl),tpay:r(o.tpay)||0,cpay:r(o.cpay)||0,ptag:r(o.ptag)||"",adid:r(o.adid)||"",playtime:r(o.playtime)||0,error_code:r(o.error_code)||0,rest_preview_cnt:r(o.rest_preview_cnt)||-1,hc_main_login:r(o.hc_main_login)||"",hc_openid:r(o.hc_openid)||"",hc_vuserid:r(o.hc_vuserid)||"",hc_appid:r(o.hc_appid)||"",extrainfo:r(o.extrainfo)||"",platform:r(o.platform)||"",playertype:1,drm:r(o.drm)||0,kernel:this.player.kernelName}},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){e.prototype.destroy.call(this),this.step5Timer&&(clearInterval(this.step5Timer),this.step5Timer=null)},t.prototype.reportAd=function(){this.step7()},t.prototype.report=function(t){this.started&&e.prototype.report.call(this,t)},t.pluginName="live-flow-reporter",t}(BaseReporter),LiveFlyReportKeyMapping={progid:"",playno:COMMON_DATA_KEY.flowid,guid:COMMON_DATA_KEY.guid,sip:"",iqq:"",hh_ua:COMMON_DATA_KEY.ua,cdn:"",sdtfrom:COMMON_DATA_KEY.sdtfrom,loadingtime:"",blocktime:"",blockcount:"",prdlength:"",platform:COMMON_DATA_KEY.platform,errorcode:"",dsip:"",durl:"",firstreport:"",sUrl:COMMON_DATA_KEY.url,sRef:COMMON_DATA_KEY.referrer,fplayerver:COMMON_DATA_KEY.playerver,livepid:COMMON_DATA_KEY.livepid,viewid:"",seq:"",cmd:"",fullecode:"",live_type:"",geturltime:"",playtime:"",ispay:"",isuserpay:"",switch:"",lookback:"",nettype:"",freetype:"",https:"",downspeed:"",vip_type:"",playertype:"",pvid:"",login_type:"",open_id:COMMON_DATA_KEY.hc_openid,live_delay:"",use_p2p:COMMON_DATA_KEY.p2p,p2p_play:"",p2pver:COMMON_DATA_KEY.p2pver},APP_KEY="0AND0F8T5N4N7QT0",OVERSEA_APP_KEY="0DOU0M38AT4C4UVD",LiveFlyReporterPlugin=function(e){function t(t,o,r){var n,i,a=e.call(this,t,o,r)||this;a.periodTickTimer=0,a.currentPeriodStartTime=0,a.isInPlayback=0,a.lastSid=0,a.loadCost=0,a.redirectCost=0,a.bufferCount=0,a.redirectStartTime=0,a.bufferDuration=0,a.reported=!1,a.delay=0,a.seq=0,a.errCode=exports.ErrorCode.SUC,a.keyMapping=__assign$1(__assign$1({},LiveFlyReportKeyMapping),null===(n=t.config.liveFlyReporterConfig)||void 0===n?void 0:n.paramsKey);var s=null===(i=t.config.liveFlyReporterConfig)||void 0===i?void 0:i.isOversea,l={appKey:s?OVERSEA_APP_KEY:APP_KEY,isOversea:s};return a.REPORT_KEY=l.appKey,a.bindEventHandlers(),BeaconRequest.register(l),a.reporter=BeaconRequest.report,a.cachedVideoInfo=createVideoInfo(),a}return __extends(t,e),Object.defineProperty(t.prototype,"reportHeader",{get:function(){var e=this,t=e.player,o=e.keyMapping,r=e.cachedVideoInfo,n=t.currentVideoInfo,i=(null==n?void 0:n.loadingUrl)||"",a=this.getAuthInfo(),s=a.pvid,l=a.loginType;return{progid:r.liveSid||0,playno:t.getCommonKv(o.playno)||"",guid:t.getCommonKv(o.guid)||"",sip:r.clientIp||"0.0.0.0",iqq:t.getCommonKv(o.iqq)||0,hh_ua:t.getCommonKv(o.hh_ua)||"",cdn:r.cdnName||"",sdtfrom:t.getCommonKv(o.sdtfrom)||0,loadingtime:this.loadCost,blocktime:this.bufferDuration,blockcount:this.bufferCount,prdlength:0,platform:t.getCommonKv(o.platform),errorcode:this.errCode,dsip:"0.0.0.0",durl:i,firstreport:+!this.reported,sUrl:t.getCommonKv(o.sUrl)||"",sRef:t.getCommonKv(o.sRef)||"",fplayerver:t.getCommonKv(o.fplayerver)||"0.0.0",livepid:r.livePid||0,viewid:r.liveChid||0,seq:this.seq,cmd:0,fullecode:this.errCode,live_type:r.liveType,geturltime:this.redirectCost,playtime:r.previewLength||-1,ispay:r.ispay||0,isuserpay:r.isuserpay||0,switch:"",lookback:this.isInPlayback,nettype:0,freetype:0,https:+(0===i.indexOf("https://")),downspeed:0,vip_type:t.getCommonKv(o.vip_type)||0,playertype:t.getCommonKv(o.playertype)||0,pvid:s||0,login_type:l,open_id:t.getCommonKv(o.open_id)||"",live_delay:this.delay,use_p2p:t.getCommonKv(o.use_p2p)||0,p2p_play:0,p2pver:t.getCommonKv(o.p2pver)||""}},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){this.clearTick(),this.clearSessionData(),e.prototype.destroy.call(this)},t.prototype.report=function(t){var o;(null===(o=this.cachedVideoInfo)||void 0===o?void 0:o.liveSid)&&(uaTool.spider||(e.prototype.report.call(this,__assign$1(__assign$1({},t),{stepname:REPORT_EVENT_ID$1})),this.seq+=1,this.reported=!0))},t.prototype.getAuthInfo=function(){var e=this.player;return{pvid:cookieTool.get("pgv_pvid"),loginType:LoginType[e.getCommonKv(COMMON_DATA_KEY.hc_main_login)||"none"]}},t.prototype.getVideoInfo=function(e){var t,o=e.data.resData,r=0;1===o.stream&&(r|=16),2===o.vcode&&(r|=4);var n=o.play_list;if(null==n?void 0:n[0]){var i=n[0],a=i.urls[0];this.cachedVideoInfo={liveChid:o.chid,livePid:o.pid,liveSid:i.sid,cdnName:urlTool.getUrlParamByKey(a,"cdn"),liveType:r,ispay:o.pay_type,isuserpay:o.isuserpay,previewLength:null===(t=o.preview_info)||void 0===t?void 0:t.playtime,clientIp:o.client_ip}}else this.cachedVideoInfo={liveChid:o.livechid,liveSid:o.livesid,livePid:o.livepid,ispay:o.ispay,isuserpay:o.isuserpay,previewLength:o.playtime,cdnName:o.cdn_name,liveType:r,clientIp:"0.0.0.0"};this.redirectCost=Date.now()-this.redirectStartTime},t.prototype.bindEventHandlers=function(){var e=this;this.msg.on(exports.PLAY_EVENT_EXT.GETINFO_START,(function(){e.redirectStartTime=Date.now()})),this.msg.on(exports.PLAY_EVENT_EXT.GETINFO_OVER,this.getVideoInfo.bind(this)),this.msg.on(exports.PLAY_EVENT_EXT.DATASET_STATE_UPDATE,this.onDataSetStateUpdate.bind(this)),this.player.on(exports.H5_PLAY_EVENT.PLAY_SESSION_END,this.onSessionEnded.bind(this)),this.player.on(exports.H5_PLAY_EVENT.VIDEO_SETLEVEL_START,this.onSetLevelStart.bind(this))},t.prototype.onDataSetStateUpdate=function(e){var t,o=((t={})[exports.DATA_STATE.BUFFER_END]=this.onBufferEnd,t[exports.DATA_STATE.LOAD_END]=this.onLoaded,t[exports.DATA_STATE.SET_LEVEL_END]=this.onSetLevelEnd,t);o[e.data.key]&&o[e.data.key].call(this,e)},t.prototype.onLoaded=function(e){var t=e.data,o=t.newVal,r=t.startEvent,n=o.ftime,i=o.code,a=o.currentUrl,s=r.ftime;this.loadCost=n-s,this.errCode=i,this.report({cmd:i===exports.ErrorCode.SUC?CMD.load:CMD.error,cdn:urlTool.getUrlParamByKey(a,"cdn")}),this.startTick()},t.prototype.onBufferEnd=function(e){var t=e.data,o=t.newVal,r=t.startEvent,n=o.ftime,i=r.ftime;this.bufferDuration+=n-i,this.bufferCount+=1},t.prototype.onSetLevelStart=function(){this.lastSid=this.cachedVideoInfo.liveSid,this.tickImmediate()},t.prototype.onSetLevelEnd=function(e){var t=e.data,o=t.newVal,r=t.startEvent,n=o.ftime,i=o.code,a=r.ftime;i===exports.ErrorCode.SUC&&(this.loadCost=n-a,this.report({cmd:CMD.load,switch:this.lastSid}),this.startTick())},t.prototype.onSessionEnded=function(e){var t=e.data.code;this.errCode=t,this.tickImmediate(),this.clearSessionData()},t.prototype.tick=function(){var e=this,t=e.errCode,o=e.player,r=e.currentPeriodStartTime;o.currentVideoInfo&&(this.delay=o.currentVideoInfo.currentDelay||0),this.report({cmd:t===exports.ErrorCode.SUC?CMD.period:CMD.error,fullecode:t,prdlength:Date.now()-r}),this.onTickEnd()},t.prototype.clearTick=function(){this.periodTickTimer&&(window.clearInterval(this.periodTickTimer),this.periodTickTimer=null)},t.prototype.onTickEnd=function(){this.bufferCount=0,this.bufferDuration=0,this.currentPeriodStartTime=Date.now()},t.prototype.tickImmediate=function(){this.clearTick(),this.tick()},t.prototype.startTick=function(){this.periodTickTimer||(this.currentPeriodStartTime=Date.now(),this.periodTickTimer=window.setInterval(this.tick.bind(this),PeriodInterval))},t.prototype.clearSessionData=function(){this.redirectCost=0,this.redirectStartTime=0,this.currentPeriodStartTime=0,this.cachedVideoInfo=createVideoInfo(),this.loadCost=0,this.reported=!1,this.seq=0,this.delay=0,this.errCode=exports.ErrorCode.SUC},t.pluginName="live-fly-reporter",t}(BaseReporter),CMD;!function(e){e[e.load=205]="load",e[e.error=150]="error",e[e.period=263]="period"}(CMD||(CMD={}));var REPORT_EVENT_ID$1="boss_cmd_player_hit_tap_process",PeriodInterval=6e4,createVideoInfo=function(){return{liveChid:0,livePid:0,liveSid:0,liveType:0,ispay:0,isuserpay:0,previewLength:0,cdnName:"",clientIp:"0.0.0.0"}},_a$2,msUnit=.001,step8Map=(_a$2={12e4:3e4,12e5:6e4},_a$2[1/0]=3e5,_a$2),DEFAULT_KEYS={uin:"",vid:COMMON_DATA_KEY.vid,coverid:COMMON_DATA_KEY.cid,pid:COMMON_DATA_KEY.flowid,guid:COMMON_DATA_KEY.guid,cmid:COMMON_DATA_KEY.guid,unid:"",vt:COMMON_DATA_KEY.cdnid,type:"",bi:COMMON_DATA_KEY.duration,bt:"",version:COMMON_DATA_KEY.playerver,platform:COMMON_DATA_KEY.platform,format:COMMON_DATA_KEY.fmt,defn:COMMON_DATA_KEY.currentDefn,ptag:"",isvip:COMMON_DATA_KEY.vip,tpid:"",pversion:"",hc_uin:"",hc_main_login:COMMON_DATA_KEY.hc_main_login,hc_vuserid:COMMON_DATA_KEY.hc_vuserid,hc_openid:COMMON_DATA_KEY.hc_openid,hc_appid:COMMON_DATA_KEY.hc_appid,hc_access_token:COMMON_DATA_KEY.hc_access_token,hc_pvid:"",hc_ssid:"",hc_qq:"",ua:COMMON_DATA_KEY.ua,hh_ua:COMMON_DATA_KEY.ua,ckey:"",ckeyVer:"",iformat:COMMON_DATA_KEY.fmt,hh_ref:COMMON_DATA_KEY.topUrl,vurl:"",v_idx:"",rcd_info:"",extrainfo:"",bucket_id:COMMON_DATA_KEY.testid,drm:COMMON_DATA_KEY.drm,pay_type:"",pcplatform:"",drmtype:COMMON_DATA_KEY.drmtype,insert_duration_ms:"",insert_flowid:"",vip_token:"",common_rcd_info:"",common_ext_info:"",common_json_info:"",qimei36:"",format_ua:"",triggerplay:"",tpay:"",cpay:"",dltype:COMMON_DATA_KEY.dltype,cginame:"",vtype:"",p2pVer:COMMON_DATA_KEY.p2pver,playertype:COMMON_DATA_KEY.playertype,start_play_position:"",end_play_position:"",is_auto_play:""},VodFlowReporterPlugin=function(e){function t(t,o,r){var n=e.call(this,t,o,r)||this;n.FLOW_DATA_KEY="__thumbplayer_vod_flow_report__",n.UNSAFE_KEY=["hh_ref","vurl"],n.REPORT_URL="//h.trace.qq.com/bosskv?",n.startPlayTime=0,n.actualPlayTime=0,n.lastPlayTimeStamp=0,n.saveInterval=0,n.lastStep8PlayTime=0,n.step8Seq=0,n.firstLoadCost=0,n.playStartPosition=0,n.playEndPosition=0,n.setEvtHandler=function(){n.msg.on(exports.PLAY_EVENT_EXT.DATASET_STATE_UPDATE,n.onDataStateChange),n.player.on(exports.H5_PLAY_EVENT.VIDEO_PLAYING,n.onFirstPlay),n.player.on(exports.H5_PLAY_EVENT.AD_PLAYING,n.onAdPlaying),n.player.on(exports.H5_PLAY_EVENT.VIDEO_TIMEUPDATE,n.onVideoTimeUpdate),n.player.on(exports.PLAY_EVENT.STATE_CHANGE,n.onCoreStateChange),document.addEventListener("visibilitychange",n.onVisibilityChange)},n.onVisibilityChange=function(){"hidden"===document.visibilityState?n.saveData():n.player&&n.removeFromLS(n.player.getCommonKv(COMMON_DATA_KEY.flowid))},n.stopSaveData=function(){n.saveInterval&&(window.clearInterval(n.saveInterval),n.saveInterval=0)},n.onAdPlaying=function(){n.step7()},n.onFirstPlay=function(e){e.data.isFirst&&n.reportFirstPlaying()},n.reportFirstPlaying=function(){if(!n.reportedEvt.step6){n.reportedEvt.step6=!0,n.playStartPosition=n.player.playtime,n.startPlayTime=Date.now();var e={step:"6",val:safelyConvertToNumber(n.firstLoadCost),val1:n.reportedEvt.step7?0:1,val2:1,bi:0,bt:safelyConvertToNumber(n.player.getCommonKv(COMMON_DATA_KEY.duration),!0)};n.report(e)}},n.onCoreStateChange=function(e){var t=e.data,o=t.new,r=t.old,i=Date.now();o===exports.VIDEO_STATE.PLAYING?n.lastPlayTimeStamp=i:r===exports.VIDEO_STATE.PLAYING&&n.lastPlayTimeStamp&&(n.actualPlayTime+=i-n.lastPlayTimeStamp)},n.onVideoTimeUpdate=function(){n.step8(),n.playEndPosition=n.player.playtime},n.saveData=function(){var e=n.player.getCommonKv(COMMON_DATA_KEY.flowid);if(e&&!n.reportedEvt.step5){var t=Date.now(),o={step:"5",val:safelyConvertToNumber(n.startPlayTime?t-n.startPlayTime:0,!0),val1:2,bi:safelyConvertToNumber(n.actualPlayTime*msUnit,!0),bt:safelyConvertToNumber(n.player.getCommonKv(COMMON_DATA_KEY.duration),!0),heartbeat:t};n.saveToLS(e,__assign$1(__assign$1({},n.reportHeader),o))}},n.onDataStateChange=function(e){var t,o=e.data,r=o.key,i=((t={})[exports.DATA_STATE.GET_INFO_END]=n.step4,t[exports.DATA_STATE.SESSION_END]=n.step5,t[exports.DATA_STATE.LOAD_END]=n.onLoaded,t[exports.DATA_STATE.SESSION_START]=n.onSessionStart,t);i[r]&&i[r](o)},n.onLoaded=function(e){var t=e.startEvent,o=e.newVal;n.firstLoadCost=o.ftime-(null==t?void 0:t.ftime)},n.onSessionStart=function(){n.actualPlayTime=0,n.firstLoadCost=0,n.lastPlayTimeStamp=0,n.startPlayTime=0,n.reportedEvt={},n.reportPrev(),n.step3(),n.stopSaveData(),n.saveInterval=window.setInterval(n.saveData,5e3)},n.step3=function(){var e={step:"3",val:0===n.player.currentVideoInfoIdx?1:2};n.report(e)},n.step7=function(){if(!n.reportedEvt.step7){n.reportedEvt.step7=!0;n.report({step:"7",val:0,val1:0})}},n.step4=function(){if(!n.reportedEvt.step4){n.reportedEvt.step4=!0;var e={step:"4",val:1,val1:1,bi:H5Player.pluginExists(AdPluginName)?2:1};n.report(e)}},n.step5=function(e){if(!n.reportedEvt.step5){n.reportedEvt.step5=!0;var t=e.newVal.code,o=n.startPlayTime?Date.now()-n.startPlayTime:0,r={step:"5",val:Math.round(o),val1:t!==exports.ErrorCode.SUC?2:1,val2:1,bi:safelyConvertToNumber(n.actualPlayTime*msUnit,!0),bt:safelyConvertToNumber(n.player.getCommonKv(COMMON_DATA_KEY.duration),!0)};n.report(r),n.step8(!0),n.removeFromLS(n.player.getCommonKv(COMMON_DATA_KEY.flowid)),n.stopSaveData()}},n.step8=function(e){if(void 0===e&&(e=!1),n.lastPlayTimeStamp){var t=Date.now(),o=t-n.lastPlayTimeStamp,r=e?n.actualPlayTime:n.actualPlayTime+o,i=+Object.keys(step8Map).find((function(e){return r<+e})),a=r-n.lastStep8PlayTime;if(e||a>=step8Map[i]){var s={step:"8",val:safelyConvertToNumber(t-n.startPlayTime),val1:e?1:4,bi:safelyConvertToNumber(r*msUnit,!0),bt:safelyConvertToNumber(n.player.getCommonKv(COMMON_DATA_KEY.duration),!0),insert_duration_ms:a};n.lastStep8PlayTime=r,n.step8Seq+=1,n.report(s)}}};var i=t.config.vodFlowReporterConfig;return(null==i?void 0:i.releaseDelay)&&(n.RELEASE_DELAY=i.releaseDelay),n.config=__assign$1({paramsKey:__assign$1(__assign$1({},DEFAULT_KEYS),(null==i?void 0:i.paramsKey)||{}),onBeforeReport:i.onBeforeReport,forceImage:i.forceImage},whichBoss()),n.setEvtHandler(),n.reportPrev(),n}return __extends(t,e),Object.defineProperty(t.prototype,"reportHeader",{get:function(){var e,t,o,r=this.player,n=r.getCommonKv,i=r.dataset,a=r.currentVideoInfoIdx,s=r.videoSize,l=void 0===s?{width:0,height:0}:s,c=l.width,p=l.height,d=this.config.paramsKey,u=i.visualStats,A=u.isPlayerInViewport,_=u.isTabFocused,E={uin:n(d.uin)||getQQFromCookie(),vid:n(d.vid)||"",coverid:n(d.coverid)||"",pid:n(d.pid)||"",guid:n(d.guid)||"",cmid:n(d.guid)||"",unid:n(d.unid)||"",vt:n(d.vt)||"",type:n(d.type)||"",bi:n(d.bi)||0,bt:n(d.bt)||0,val:0,val1:0,val2:0,version:n(d.version)||"",platform:n(d.platform)||"",format:n(d.format)||"",defn:n(d.defn)||"",ptag:n(d.ptag)||getPtag(),isvip:n(d.isvip)||-1,tpid:n(d.tpid)||"",pversion:"thumbplayer",hc_uin:n(d.hc_uin)||getQQFromCookie(),hc_main_login:n(d.hc_main_login)||"",hc_vuserid:n(d.hc_vuserid)||"",hc_openid:n(d.hc_openid)||"",hc_appid:n(d.hc_appid)||"",hc_pvid:n(d.hc_pvid)||cookieTool.get("pgv_pvid"),hc_ssid:n(d.hc_ssid)||"",hc_qq:n(d.hc_qq)||"",hc_access_token:n(d.hc_access_token)||"",ua:n(d.ua)||"",hh_ua:n(d.hh_ua)||"",ckey:n(d.ckey)||"",iformat:n(d.iformat)||"",hh_ref:n(d.hh_ref)||"",rcd_info:n(d.rcd_info)||"",extrainfo:n(d.extrainfo)||"",bucket_id:n(d.bucket_id)||"",pay_type:n(d.pay_type)||0,idx:a||0,diagonal:Math.round(Math.sqrt(Math.pow(c,2)+Math.pow(p,2))),vurl:(null===(e=this.player.currentVideoInfo)||void 0===e?void 0:e.loadingUrl)||n(d.vurl),v_idx:this.player.currentVideoInfoIdx||0,ctime:comTool.dateFormat(void 0,void 0),url:document.URL,ref_url:document.referrer,attaid:this.config.id,token:this.config.token,isfocustab:_,isvisible:A,format_ua:n(d.format_ua)||getFormatUA(),pcplatform:n(d.pcplatform)||"web",drm:n(d.drm)?1:0,insert_flowid:this.step8Seq,vip_token:n(d.vip_token)||0,kernel:this.player.kernelName||"",drmtype:n(d.drmtype)||0};return this.config.id===MOBILE_ATTAID&&(E.common_rcd_info=n(d.common_rcd_info)||"",E.common_ext_info=n(d.common_ext_info)||"",E.common_json_info=n(d.common_json_info)||"",E.qimei36=n(d.qimei36)||""),this.config.id===DESKTOP_ATTAID&&(E.triggerplay=null!==(t=n(d.triggerplay))&&void 0!==t?t:1,E.tpay=n(d.tpay)||0,E.cpay=n(d.cpay)||0,E.dltype=n(d.dltype)||0,E.cginame=n(d.cginame)||"",E.vtype=n(d.vtype)||"",E.ckeyVer=n(d.ckeyVer)||"",E.p2pVer=n(d.p2pVer)||"",E.playertype=n(d.playertype)||"",E.sdk_extrainfo=jsonTool.safelyStringify({play_start_position:this.playStartPosition,play_end_position:this.playEndPosition,is_auto_play:null!==(o=n(d.is_auto_play))&&void 0!==o?o:1})),E},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){this.stopSaveData(),document.removeEventListener("visibilitychange",this.onVisibilityChange),e.prototype.destroy.call(this)},t.prototype.report=function(t){if(this.player.getCommonKv(COMMON_DATA_KEY.vid))return"function"==typeof this.config.onBeforeReport?e.prototype.report.call(this,this.config.onBeforeReport(t)):e.prototype.report.call(this,t)},t.pluginName="vod-flow-reporter",t}(BaseReporter);function whichBoss(){return uaTool.mobile?{id:MOBILE_ATTAID,token:MOBILE_ATTA_TOKEN}:{id:DESKTOP_ATTAID,token:DESKTOP_ATTA_TOKEN}}function getFormatUA(){var e="other",t=uaTool.browser,o=uaTool.os;return t.qqlive&&(o.iphone?e="iphone_qqlive":o.android&&(e="aphone_qqlive")),e}var DESKTOP_ATTAID="z4900004298",DESKTOP_ATTA_TOKEN="4973349567",MOBILE_ATTAID="z3000002865",MOBILE_ATTA_TOKEN="4135796792",VodFlyReporterPlugin=function(e){function t(t,o,r){var n,i,a=e.call(this,t,o,r)||this;a.seq=0,a.bufferReportCached=[],a.seekReportCached=[],a.onDataSetStateUpdate=function(e){var t,o=e.data.key,r=((t={})[exports.DATA_STATE.INIT]=a.runOnce(a.step5,a),t[exports.DATA_STATE.LOAD_END]=a.runOnce(a.step30,a),t[exports.DATA_STATE.SET_LEVEL_END]=function(){a.step45(e),a.step31(e)},t[exports.DATA_STATE.SET_LEVEL_START]=function(){a.reportStep35and40()},t[exports.DATA_STATE.RETRY_PLAY]=a.step47,t[exports.DATA_STATE.BUFFER_END]=a.recordStep35,t[exports.DATA_STATE.SEEK_END]=a.recordStep40,t[exports.DATA_STATE.FIRST_PLAY]=a.runOnce(a.step32,a),t[exports.DATA_STATE.SESSION_END]=a.runOnce(a.step50,a),t[exports.DATA_STATE.SUBTITLE_END]=a.step33,t);r[o]&&r[o].call(a,e)},a.keyMapping=__assign$1(__assign$1({},defaultKeys),null===(n=t.config.vodFlyReporterConfig)||void 0===n?void 0:n.paramsKey);var s=null===(i=t.config.vodFlyReporterConfig)||void 0===i?void 0:i.isOversea,l={appKey:s?OVERSEA_APP_KEY:APP_KEY,isOversea:s};return a.REPORT_KEY=l.appKey,a.bindEventHandlers(),BeaconRequest.register(l),a.reporter=BeaconRequest.report,a}return __extends(t,e),Object.defineProperty(t.prototype,"reportHeader",{get:function(){var e=this,t=Object.keys(this.keyMapping).reduce((function(t,o){return e.keyMapping[o]&&(t[o]=e.player.getCommonKv(e.keyMapping[o])||""),t}),{});return __assign$1(__assign$1(__assign$1(__assign$1(__assign$1({},t),this.videoInfoParams),this.firstLoadVideoInfoParam),this.getAuthInfo()),{downloadkit:+!!this.player.config.enableP2P,seq:this.seq,stepname:REPORT_EVENT_ID})},enumerable:!1,configurable:!0}),t.prototype.report=function(t){this.player.getCommonKv(COMMON_DATA_KEY.vid)&&(uaTool.spider||(e.prototype.report.call(this,t),this.seq+=1))},Object.defineProperty(t.prototype,"currentUrlInfo",{get:function(){var e,t,o;if(!this.player.currentVideoInfo||!this.rawGetinfoData)return[-1,null];var r=(null===(o=null===(t=null===(e=this.rawGetinfoData.vl)||void 0===e?void 0:e.vi[0])||void 0===t?void 0:t.ul)||void 0===o?void 0:o.ui)||[],n=urlTool.getDomainOfURL(this.player.currentVideoInfo.loadingUrl),i=null==r?void 0:r.findIndex((function(e){return urlTool.getDomainOfURL(e.url)===n}));return[i,r[i]]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentFmtId",{get:function(){var e,t,o,r;return this.rawGetinfoData&&null!==(r=null===(o=null===(t=null===(e=this.rawGetinfoData.fl)||void 0===e?void 0:e.fi)||void 0===t?void 0:t.find((function(e){return e.sl})))||void 0===o?void 0:o.id)&&void 0!==r?r:0},enumerable:!1,configurable:!0}),t.prototype.bindEventHandlers=function(){var e=this;this.msg.on(exports.PLAY_EVENT_EXT.DATASET_STATE_UPDATE,this.onDataSetStateUpdate),this.msg.on(exports.PLAY_EVENT_EXT.GETINFO_OVER,this.step15.bind(this)),this.msg.on(exports.PLAY_EVENT_EXT.GETINFO_START,(function(){e.getinfoStartTime=Date.now()}))},t.prototype.step5=function(e){var t=e.data.newVal,o=t.ftime,r=t.ext.stime;this.report({step:"5",data:stringifyAndReplaceCommaInParams({stime:r,etime:o,code:exports.ErrorCode.SUC})})},t.prototype.step10=function(){},t.prototype.step15=function(e){var t,o,r=e.data,n=r.parseData,i=r.resData,a=n||{},s=a.definitionList,l=void 0===s?[]:s,c=a.vitem,p=void 0===c?{}:c,d=p.fc,u=void 0===d?0:d,A=p.br,_=void 0===A?0:A,E=p.vst,g=void 0===E?0:E,f=p.type,h=void 0===f?0:f,v=null!==(o=null===(t=null==l?void 0:l.find((function(e){return e.sl})))||void 0===t?void 0:t.id)&&void 0!==o?o:-1;this.videoInfoParams={dltype:null==i?void 0:i.dltype,duration:null==n?void 0:n.duration,type:h,clip:u,status:g},this.firstLoadVideoInfoParam||(this.firstLoadVideoInfoParam={fmt:v,rate:_}),this.rawGetinfoData=i,this.report({step:"15",data:stringifyAndReplaceCommaInParams({stime:this.getinfoStartTime,etime:Date.now(),code:"0."+i.em,ip:i.ip})})},t.prototype.step25=function(){},t.prototype.step30=function(e){var t=e.data,o=t.newVal,r=t.startEvent,n=r.ftime,i=r.currentUrl,a=o.ftime,s=this.currentUrlInfo,l=s[0],c=s[1],p=null==c?void 0:c.vt;this.report({step:"30",data:stringifyAndReplaceCommaInParams({stime:n,etime:a,vt:p,urlindex:l,reason:"",code:"0."+o.code,url:i})})},t.prototype.step31=function(e){var t=e.data,o=t.newVal,r=t.startEvent,n=r.ftime,i=r.ext,a=o.ftime,s=i.mode,l=this.currentUrlInfo,c=l[0],p=l[1],d=null==p?void 0:p.vt;this.report({step:"31",data:stringifyAndReplaceCommaInParams({stime:s===SET_LEVEL_MODE.SMOOTH?a:n,etime:a,vt:d,urlindex:c,code:"0."+o.code})})},t.prototype.step32=function(e){var t=e.data.newVal.ftime;this.report({step:"32",data:stringifyAndReplaceCommaInParams({stime:t,etime:t,code:exports.ErrorCode.SUC})})},t.prototype.step33=function(e){var t=e.data.newVal.ext;this.report({step:"33",data:stringifyAndReplaceCommaInParams(t)})},t.prototype.recordStep35=function(e){var t=e.data,o=t.newVal,r=t.startEvent,n=r.ftime,i=r.playbackRate,a=r.playtime,s=o.ftime,l=o.currentUrl,c=1!==i?2:1;this.bufferReportCached.push({stime:n,etime:s,ptime:a,format:this.currentFmtId,url:l,scene:c,reason:0,code:"0."+o.code})},t.prototype.recordStep40=function(e){var t=e.data,o=t.newVal,r=t.startEvent,n=r.ftime,i=r.playtime,a=o.ftime,s=o.playtime;this.seekReportCached.push({lstime:n,letime:a,pstime:i,petime:s,format:this.currentFmtId,code:"0."+o.code})},t.prototype.step45=function(e){var t=e.data,o=t.newVal,r=t.startEvent,n=r.ftime,i=r.ext,a=r.playtime,s=o.ftime,l=o.playtime,c=o.currentUrl,p=i.mode,d=this.currentUrlInfo,u=d[0],A=d[1],_=null==A?void 0:A.vt;this.report({step:"45",data:stringifyAndReplaceCommaInParams({stime:p===SET_LEVEL_MODE.SMOOTH?s:n,etime:s,pstime:a,petime:l,auto:1,format:this.currentFmtId,url:c,vt:_,urlindex:u,code:"0."+o.code})})},t.prototype.step46=function(){},t.prototype.step47=function(e){var t=e.data.newVal,o=t.currentUrl,r=t.ftime,n=this.currentUrlInfo,i=n[0],a=n[1],s=null==a?void 0:a.vt;this.report({step:"47",data:stringifyAndReplaceCommaInParams({url:o,vt:s,urlindex:i,cdnip:"",stime:r,etime:r,code:"0."+t.code})})},t.prototype.step50=function(e){var t=e.data.newVal,o=t.ftime,r=t.code,n=this.player.dataset.getStats().playDuration;this.report({step:"50",data:stringifyAndReplaceCommaInParams({etime:o,playduration:n,code:"0."+filterErrorCode(r)})}),this.reportStep35and40(),this.cleanUp()},t.prototype.reportStep35and40=function(){var e=this.bufferReportCached,t=this.seekReportCached;if(e.length){var o=e.reduce((function(e,t){return t.etime-t.stime<=STALLED_THRESHOLD?e:[e[0]+1,e[1]+(t.etime-t.stime)]}),[0,0]),r=o[0],n=o[1];this.report({step:"35",data:stringifyAndReplaceCommaInParams({tcount:r,tduration:n,val:this.bufferReportCached.slice(0,BUFFER_REPORT_LIMIT)})})}if(t.length){var i=t.reduce((function(e,t){return t.letime-t.lstime<=STALLED_THRESHOLD?[e[0]+1,e[1],e[2]]:[e[0]+1,e[1]+1,e[2]+(t.letime-t.lstime)]}),[0,0,0]),a=(r=i[0],i[1]),s=i[2];this.report({step:"40",data:stringifyAndReplaceCommaInParams({tcount:r,tbcount:a,tbduration:s,val:this.seekReportCached.slice(0,SEEK_REPORT_LIMIT)})})}this.bufferReportCached=[],this.seekReportCached=[]},t.prototype.cleanUp=function(){this.bufferReportCached=[],this.seekReportCached=[],this.rawGetinfoData=null,this.firstLoadVideoInfoParam=null,this.videoInfoParams=null,this.seq=0,this.getinfoStartTime=0},t.prototype.runOnce=function(e,t){var o=this,r="";return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var a=o.player.getCommonKv(COMMON_DATA_KEY.flowid);r!==a&&(r=a,e.apply(t,n))}},t.prototype.getAuthInfo=function(){var e=this.player;return{loginid:e.getCommonKv(COMMON_DATA_KEY.hc_openid)||"",loginex:e.getCommonKv(COMMON_DATA_KEY.hc_vuserid)||"",logintype:LoginType[e.getCommonKv(COMMON_DATA_KEY.hc_main_login)||"none"],vip:+!!e.getCommonKv(COMMON_DATA_KEY.vip)}},t.pluginName="vod-fly-reporter",t}(BaseReporter),defaultKeys={stepname:"",seq:"",hc_main_login:COMMON_DATA_KEY.hc_main_login,hc_vuserid:COMMON_DATA_KEY.hc_vuserid,hc_openid:COMMON_DATA_KEY.hc_openid,hc_appid:COMMON_DATA_KEY.hc_appid,loginid:"",loginex:"",logintype:"",guid:COMMON_DATA_KEY.guid,longitude:"",latitude:"",vip:"",online:"",p2p:COMMON_DATA_KEY.p2p,downloadkit:"",resolution:COMMON_DATA_KEY.resolution,testid:COMMON_DATA_KEY.testid,osver:COMMON_DATA_KEY.osver,playerver:COMMON_DATA_KEY.playerver,playertype:COMMON_DATA_KEY.playertype,uip:COMMON_DATA_KEY.uip,confid:COMMON_DATA_KEY.confid,cdnip:COMMON_DATA_KEY.cdnip,cdnid:COMMON_DATA_KEY.cdnid,cdnuip:COMMON_DATA_KEY.uip,freetype:"",sstrength:"",network:"",speed:"",device:COMMON_DATA_KEY.device,appver:COMMON_DATA_KEY.appVer,p2pver:COMMON_DATA_KEY.p2pver,flowid:COMMON_DATA_KEY.flowid,platform:COMMON_DATA_KEY.platform,vid:COMMON_DATA_KEY.vid,bizid:"",url:COMMON_DATA_KEY.url,refer:COMMON_DATA_KEY.referrer,cid:COMMON_DATA_KEY.cid,ua:COMMON_DATA_KEY.ua,ptag:COMMON_DATA_KEY.ptag,dltype:"",fmt:"",rate:"",clip:"",status:"",type:"",duration:"",ext:"",drm:"",purevid:""},BUFFER_REPORT_LIMIT=20,SEEK_REPORT_LIMIT=20,STALLED_THRESHOLD=1200,REPORT_EVENT_ID="boss_cmd_player_quality_feitian",ErrorCodeWhiteList=[exports.ErrorCode.GETINFO_SERVER_CODE_PREFIX+"083"],_a$1,STREAM_TYPE$1,ZB_TYPE;function filterErrorCode(e){return ErrorCodeWhiteList.find((function(t){return e.startsWith(t)}))?exports.ErrorCode.SUC:e}H5Player.registerPlugin(VodFlowReporterPlugin.pluginName,VodFlowReporterPlugin),H5Player.registerPlugin(LiveFlowReporterPlugin.pluginName,LiveFlowReporterPlugin),H5Player.registerPlugin(VodFlyReporterPlugin.pluginName,VodFlyReporterPlugin),H5Player.registerPlugin(LiveFlyReporterPlugin.pluginName,LiveFlyReporterPlugin),function(e){e[e.AUTO=0]="AUTO",e[e.FLV=1]="FLV",e[e.HLS=2]="HLS"}(STREAM_TYPE$1||(STREAM_TYPE$1={})),function(e){e[e.XUEYUAN=4]="XUEYUAN",e[e.CHRISTMAS=5]="CHRISTMAS",e[e.VERIFY=50]="VERIFY",e[e.SPORTS=100]="SPORTS",e[e.MARK=200]="MARK"}(ZB_TYPE||(ZB_TYPE={}));var ZB_CGI_MAP=(_a$1={0:["//infozb6.video.qq.com/?","//bkinfozb6.video.qq.com/?"]},_a$1[ZB_TYPE.XUEYUAN]="//innerzb.video.qq.com/?",_a$1[ZB_TYPE.VERIFY]="//auth.zb.qq.com/?",_a$1[ZB_TYPE.MARK]="//infozb.pcg.com:8080/?",_a$1),ZB_CGI_TEST$1="//test.zb.video.qq.com",LIVE_GET_INFO_DATA_KEYS$1;!function(e){e.playtime="live-getinfo:playtime",e.livesid="live-getinfo:livesid",e.isuserpay="live-getinfo:isuserpay",e.cpay="live-getinfo:cpay",e.restpreviewcnt="live-getinfo:resetpreviewcnt"}(LIVE_GET_INFO_DATA_KEYS$1||(LIVE_GET_INFO_DATA_KEYS$1={}));var playErrDataMap=new Map([["videoPlayError",{name:"setErrorView",params:{}}],["areaLimit",{name:"setErrorView",params:{}}],["bandWidthLimit",{name:"setErrorView",params:{}}],["msgInterrupt",{name:"setErrorView",params:{}}],["videoNotBegin",{name:"setErrorView",params:{hideRefresh:!0,hideCode:!0}}],["videoIsOver",{name:"setErrorView",params:{isOver:!0,hideRefresh:!0,hideCode:!0}}],["numOfPeopleLimit",{name:"setQueueFullView"}],["mustLogin",{name:"setErrorView",params:{}}],["isNotInPlayList",{name:"setErrorView",params:{}}],["getLoginInfoFailed",{name:"setErrorView",params:{}}],["showPayTip",{name:"showPayTips",params:{cmd:1}}],["copyrightLimit",{name:"setErrorView",params:{}}],["universalTip",{name:"setErrorView",params:{}}],["videoCannotFind",{name:"setErrorView",params:{}}],["notSptDrm",{name:"setErrorView",params:{}}]]),VideoType$2={1:"H264",2:"H265",4:"SDR",22:"DolbyVisionTs",23:"DolbyVisionFmp4"},IS_QQ_DOMAIN=/.*\.?qq\.com/g.test(urlTool.getDomainOfURL(location.href)),PATH={COMMON:["//h5vv6.video.qq.com/getvinfo","//bkh5vv.video.qq.com/getvinfo","//av.video.qq.com/getvinfo"],TEST:"//testvv.video.qq.com/geth5info?"},CKEY_VRE,VOD_GET_INFO_DATA_KEYS;!function(e){e.CKEY_8="8.1",e.CKEY_9="9.1"}(CKEY_VRE||(CKEY_VRE={})),function(e){e.videoType="vod-getinfo:videoType",e.videoCharged="vod-getinfo:videoCharged",e.userPayType="vod-getinfo:userPayType",e.vipToken="vod-getinfo:vipToken",e.ckey="vod-getinfo:ckey",e.ckeyVersion="vod-getinfo:ckeyVersion",e.cginame="vod-getinfo:cginame",e.vurl="vod-getinfo:vurl"}(VOD_GET_INFO_DATA_KEYS||(VOD_GET_INFO_DATA_KEYS={}));var URL_EXPIRE_TIME=72e5,VideoType$1={1:"H264",2:"H265",3:"HDR10",4:"DolbyVision",5:"None(Audio Only)",6:"SDR+",7:"SDR",8:"T265",9:"IMax",10:"SFR_HDR(60FPS)",11:"SFR4X_HDR(120FPS)",12:"SFR3X_HDR(90FPS)",13:"AVS3",14:"AV1",15:"TIE_V2",16:"SFR_TIE_V2(60FPS)",17:"SFR3X_TIE_V2(90FPS)",18:"SFR4X_TIE_V2(120FPS)",19:"CUVA-HDR",20:"VVC(O266)",21:"O264",26:"VAV1"},_a$4,reporterConfig=(_a$4={},_a$4[exports.PLAY_MODE.VOD]=[VodFlowReporterPlugin.pluginName,VodFlyReporterPlugin.pluginName],_a$4[exports.PLAY_MODE.LIVE]=[LiveFlowReporterPlugin.pluginName,LiveFlyReporterPlugin.pluginName],_a$4),ReporterController=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onSessionStart=function(){t.player.setCommonKv(isAutoPlay,1),t.player.setCommonKv(bizIdKey,t.getBizIdForTencentVideo())},t.onPlayBtnClick=function(e){var o;"play"===(null===(o=e.data)||void 0===o?void 0:o.status)&&t.player.setCommonKv(isAutoPlay,0)},t}return __extends(t,e),Object.defineProperty(t.prototype,"ready",{get:function(){return Promise.resolve(!0)},enumerable:!1,configurable:!0}),t.prototype.init=function(){this.ctrlbarPlugin=this.player.plugins[OFFICIAL_PLUGIN.CTRLBAR],this.mergePlayerConfig(),this.installReporter(),this.setupEventListeners()},t.prototype.destroy=function(){this.removeEventListeners(),e.prototype.destroy.call(this)},t.prototype.getBizIdForTencentVideo=function(){return"visible"===document.visibilityState?"401":"402"},t.prototype.setupEventListeners=function(){var e;this.player.on(exports.H5_PLAY_EVENT.PLAY_SESSION_START,this.onSessionStart),null===(e=this.ctrlbarPlugin)||void 0===e||e.on("ctrl:click-playbtn",this.onPlayBtnClick)},t.prototype.removeEventListeners=function(){var e;this.player.off(exports.H5_PLAY_EVENT.PLAY_SESSION_START,this.onSessionStart),null===(e=this.ctrlbarPlugin)||void 0===e||e.off("ctrl:click-playbtn",this.onPlayBtnClick)},t.prototype.mergePlayerConfig=function(){var e,t,o,r={},n=this.player.config,i=n.type;i===exports.PLAY_MODE.VOD&&(r.vodFlowReporterConfig=__assign$1(__assign$1({forceImage:!IS_QQ_DOMAIN},null==n?void 0:n.vodFlowReporterConfig),{paramsKey:__assign$1({tpay:VOD_GET_INFO_DATA_KEYS.videoCharged,vtype:VOD_GET_INFO_DATA_KEYS.videoType,ckeyVer:VOD_GET_INFO_DATA_KEYS.ckeyVersion,pay_type:VOD_GET_INFO_DATA_KEYS.userPayType,vurl:VOD_GET_INFO_DATA_KEYS.vurl,is_auto_play:isAutoPlay},null===(e=null==n?void 0:n.vodFlowReporterConfig)||void 0===e?void 0:e.paramsKey)}),r.vodFlyReporterConfig=__assign$1(__assign$1({},null==n?void 0:n.vodFlyReporterConfig),{paramsKey:{bizid:bizIdKey}})),i===exports.PLAY_MODE.LIVE&&(r.liveQaReporterConfig=__assign$1(__assign$1({},null==n?void 0:n.liveQaReporterConfig),{paramsKey:__assign$1({sid:LIVE_GET_INFO_DATA_KEYS$1.livesid,isuserpay:LIVE_GET_INFO_DATA_KEYS$1.isuserpay,playtime:LIVE_GET_INFO_DATA_KEYS$1.playtime},null===(t=null==n?void 0:n.liveQaReporterConfig)||void 0===t?void 0:t.paramsKey)}),r.liveFlowReporterConfig=__assign$1(__assign$1({forceImage:!IS_QQ_DOMAIN},null==n?void 0:n.liveFlowReporterConfig),{paramsKey:__assign$1({sid:LIVE_GET_INFO_DATA_KEYS$1.livesid,cpay:LIVE_GET_INFO_DATA_KEYS$1.cpay,tpay:LIVE_GET_INFO_DATA_KEYS$1.isuserpay,playtime:LIVE_GET_INFO_DATA_KEYS$1.playtime,rest_preview_cnt:LIVE_GET_INFO_DATA_KEYS$1.restpreviewcnt},null===(o=null==n?void 0:n.liveFlowReporterConfig)||void 0===o?void 0:o.paramsKey)})),Object.assign(this.player.config,r)},t.prototype.installReporter=function(){if(this.player.config.type){var e=reporterConfig[this.player.config.type];this.checkIfReporterExist(e)?this.warn("reporter already detected, skip install, probably due to <1.7.4 version of SuperPlayer"):this.player.createPlugins(e)}},t.prototype.checkIfReporterExist=function(e){var t=this;return e.some((function(e){return!!t.player.plugins[e]}))},t.moduleName="reporter-controller",t}(Controller),bizIdKey="txv_biz_id",isAutoPlay="tvx_is_auto_play",TVK_ERROR_TYPE=17,TVKError=function(e){return new ErrorBase("tvk",e)};function deviceCheck(){var e=0,t=function(t){e|=t()};return t((function(){return videoTool.isVideoCanPlayType('video/mp4; codecs="avc1.42E01E"')?0:1})),t((function(){return navigator.webdriver?2:0})),t((function(){return uaTool.spider?4:0})),t((function(){return uaTool.headless?8:0})),t((function(){return 0===window.outerWidth&&0===window.outerHeight?16:0})),t((function(){return navigator.onLine?0:32})),t((function(){var e;return(null===(e=navigator.plugins)||void 0===e?void 0:e.length)>0?0:64})),t((function(){var e;return(null===(e=navigator.mimeTypes)||void 0===e?void 0:e.length)>0?0:128})),e}ErrorTypeCodeMap.tvk=TVK_ERROR_TYPE;var testScore=deviceCheck(),GuardController=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onPlaySessionEnd=t.suspiciousDeviceHandlerFactory("report"),t.blockSuspiciousDevice=function(e){return t.warn("device score not pass, block play"),TVKError({code:1,fatal:!0,message:compile(tvkI18nConfig.DEVICE_SCORE_NOT_PASS),detail:testScore,debugMessage:"device score=".concat(testScore,";mask=").concat(e)})},t.reportSuspiciousDevice=function(e){var o;return t.warn("device score not pass, upload log"),null===(o=t.player.offlineLog)||void 0===o||o.report(!0,"tvk-device-score"),null},t}return __extends(t,e),Object.defineProperty(t.prototype,"ready",{get:function(){return Promise.resolve(!0)},enumerable:!1,configurable:!0}),t.prototype.init=function(){this.patchPlayerConfig(),this.setupEventListeners()},t.prototype.destroy=function(){this.removeEventListeners()},t.prototype.setupEventListeners=function(){this.player.on(exports.H5_PLAY_EVENT.PLAY_SESSION_END,this.onPlaySessionEnd)},t.prototype.removeEventListeners=function(){this.player.off(exports.H5_PLAY_EVENT.PLAY_SESSION_END,this.onPlaySessionEnd)},t.prototype.patchPlayerConfig=function(){this.player.config.prerequisiteCheck=this.suspiciousDeviceHandlerFactory("block")},t.prototype.suspiciousDeviceHandlerFactory=function(e){var t,o,r=this,n=this.tvk.config,i=n.scoreMaskForBlocking,a=n.scoreMaskForReporting,s=((t={}).block=this.blockSuspiciousDevice,t.report=this.reportSuspiciousDevice,t),l=((o={}).block=i,o.report=a,o);return function(){return r.log("check score for ".concat(e,", device score=").concat(testScore,";mask=").concat(l[e])),testScore&l[e]?s[e](l[e]):null}},t.moduleName="guard-controller",t}(Controller),DRM_REQUEST_VALUE,DRM_CODE_FROM_VINFO;!function(e){e[e.NONE=0]="NONE",e[e.FAIRPLAY=16]="FAIRPLAY",e[e.WIDEVINE=32]="WIDEVINE",e[e.CHACHA20=8]="CHACHA20"}(DRM_REQUEST_VALUE||(DRM_REQUEST_VALUE={})),function(e){e[e.NONE=0]="NONE",e[e.FAIRPLAY=4]="FAIRPLAY",e[e.WIDEVINE=5]="WIDEVINE",e[e.CHACHA20=3]="CHACHA20"}(DRM_CODE_FROM_VINFO||(DRM_CODE_FROM_VINFO={}));var localDRMCache=DRM_REQUEST_VALUE.NONE,LOGIN_METHOD,COOKIE_NAME;function getRequestParamForDRM(e){return __awaiter(this,void 0,void 0,(function(){var t,o;return __generator(this,(function(r){switch(r.label){case 0:return void 0!==e?[2,e]:localDRMCache?[2,localDRMCache]:(t=DRM_REQUEST_VALUE.NONE,uaTool.mobile?[2,t]:(window.WebAssembly&&(t|=DRM_REQUEST_VALUE.CHACHA20),(o=uaTool.browser.chrome&&comTool.compareVersion(uaTool.browser.version,"89.0")>0)?[4,videoTool.supportWidevine()]:[3,2]));case 1:o=r.sent(),r.label=2;case 2:return o?(t|=DRM_REQUEST_VALUE.WIDEVINE,localDRMCache=t):uaTool.browser.safari&&videoTool.supportFairplay()&&(t|=DRM_REQUEST_VALUE.FAIRPLAY,localDRMCache=t),[2,t]}}))}))}!function(e){e.QQ="qq",e.WX="wx"}(LOGIN_METHOD||(LOGIN_METHOD={})),function(e){e.MAIN_LOGIN="main_login",e.GUID="video_guid",e.OPENID="openid",e.APPID="appid",e.VUSERID="vuserid",e.ACCESS_TOKEN="access_token",e.VUSESSION="vusession"}(COOKIE_NAME||(COOKIE_NAME={}));var VQQ_COOKIE_PREFIX="vqq_";function getUserCookies(e){var t,o,r,n,i,a,s,l=cookieTool.get(COOKIE_NAME.MAIN_LOGIN);if(!l)return{};var c=l===LOGIN_METHOD.QQ,p=((t={})[COOKIE_NAME.ACCESS_TOKEN]=null!==(o=getCookieWithPrefix(COOKIE_NAME.ACCESS_TOKEN,c))&&void 0!==o?o:"",t[COOKIE_NAME.APPID]=null!==(r=getCookieWithPrefix(COOKIE_NAME.APPID,c))&&void 0!==r?r:"",t[COOKIE_NAME.VUSESSION]=null!==(n=getCookieWithPrefix(COOKIE_NAME.VUSESSION,c))&&void 0!==n?n:"",t[COOKIE_NAME.OPENID]=null!==(i=getCookieWithPrefix(COOKIE_NAME.OPENID,c))&&void 0!==i?i:"",t[COOKIE_NAME.VUSERID]=null!==(a=getCookieWithPrefix(COOKIE_NAME.VUSERID,c))&&void 0!==a?a:"",t[COOKIE_NAME.GUID]=null!==(s=cookieTool.get(COOKIE_NAME.GUID))&&void 0!==s?s:"",t[COOKIE_NAME.MAIN_LOGIN]=l,t);return validateCookie(p)?e?Object.keys(e).reduce((function(t,o){return t[e[o]]=p[o],t}),{}):p:{}}function getCookieWithPrefix(e,t){return void 0===t&&(t=!1),cookieTool.get(t?"".concat(VQQ_COOKIE_PREFIX).concat(e):e)}function validateCookie(e){return!!e[COOKIE_NAME.MAIN_LOGIN]&&!!(e[COOKIE_NAME.MAIN_LOGIN]!==LOGIN_METHOD.QQ||e[COOKIE_NAME.VUSERID]&&e[COOKIE_NAME.ACCESS_TOKEN])}function commonSelectKernel(e){var t=e.codec,o=e.dltype,r=e.drm,n=void 0;return t===CODEC.H265?videoTool.supportHevc()?1===o?n=exports.KERNEL_NAME.ORIGIN:3!==o&&8!==o||(n=exports.KERNEL_NAME.HLS_JS):n=exports.KERNEL_NAME.WASM:1===o?n=exports.KERNEL_NAME.ORIGIN:8===o&&(n=exports.KERNEL_NAME.HLS_JS),r===DRM_CODE_FROM_VINFO.WIDEVINE?n=exports.KERNEL_NAME.HLS_JS:r===DRM_CODE_FROM_VINFO.FAIRPLAY?n=exports.KERNEL_NAME.ORIGIN:r===DRM_CODE_FROM_VINFO.CHACHA20&&t===CODEC.H264&&(n=exports.KERNEL_NAME.HLS_JS),n}function compose(e){return function(t,o){var r=-1;return function n(i){if(i<=r)return Promise.reject(new Error("next() called multiple times"));r=i;var a=e[i];i===e.length&&(a=o);if(!a)return Promise.resolve(null);try{return Promise.resolve(a(t,n.bind(null,i+1)))}catch(e){return Promise.reject(e)}}(0)}}var JsonpRequestor=function(){function e(e){this._jsonpPrefix=e}return e.prototype.start=function(t,o,r){return void 0===r&&(r=e.timeout),netTool.jsonp(t,{query:o,timeout:r,charset:"utf-8",name:"".concat(this._jsonpPrefix).concat(Math.floor(1e6*Math.random()))})},e.timeout=6e3,e}(),DEFAULT_GETINFO_CONFIG$2={path:"",retryCount:3,test:0,timeout:6e3,ckeyVer:CKEY_VRE.CKEY_8};function getRefer(){var e="";try{e=removeUrlParams(document.location.href),isInIframe()&&(e=removeUrlParams(document.referrer||""))}catch(e){}return e}function removeUrlParams(e){if("string"==typeof e){var t=document.createElement("a");return t.href=e,"".concat(t.protocol,"//").concat(t.host).concat(t.pathname)}}function getEhost(){var e="";try{e=location.href.replace(location.search,""),isInIframe()&&(e=removeUrlParams(top.location.href||""))}catch(e){}return e}function isTencentVideoSite(){return"v.qq.com"===location.hostname||"film.qq.com"===location.hostname}function isInIframe(){try{return window.self!==window.top}catch(e){return!0}}function getSpHttps(){return"https:"===location.protocol?1:0}function getTimeStampStr(e){var t=e||10,o=(+new Date).toString();return o.length>t?o.substring(0,t):"00000000000".concat(o).slice(-1*t)}var DEFAULT_REQ_PARAMS$2={charge:0,otype:"json",defnpayver:isTencentVideoSite()?1:0,spau:1,spaudio:1,spwm:1,sphls:uaTool.mobile?1:2,host:location.host,refer:getRefer(),ehost:getEhost(),sphttps:getSpHttps(),encryptVer:"",cKey:"",clip:4,guid:"",flowid:"",platform:"",sdtfrom:"",appVer:"1.0.0.0",unid:"",auth_from:"",auth_ext:"",vid:"",defn:"",fhdswitch:0,dtype:3,spsrt:2,tm:"",lang_code:0,logintoken:""},checkResponseMiddleWare$2=function(e,t){return __awaiter(void 0,void 0,void 0,(function(){var o,r,n,i,a,s,l,c,p,d,u,A;return __generator(this,(function(_){switch(_.label){case 0:return o=e.resData,r=void 0===o?{}:o,n=e.player,i=e.isSetPlayerData,a=void 0===i||i,s=void 0===r.em?0:+r.em,l=+r.exem,c=((null===(A=r.vl)||void 0===A?void 0:A.vi)||[])[0],a&&n.setCommonKv(((d={})[COMMON_DATA_KEY.uip]=r.ip,d[COMMON_DATA_KEY.hh_ip]=r.ip,d[VOD_GET_INFO_DATA_KEYS.vipToken]=getTokenValue(r.report||"","vip_token"),d)),c&&a&&n.setCommonKv(((u={})[VOD_GET_INFO_DATA_KEYS.videoCharged]=c.ch,u[VOD_GET_INFO_DATA_KEYS.userPayType]=computePayType(c.st,c.ch),u[VOD_GET_INFO_DATA_KEYS.videoType]=c.videotype,u)),0===s&&c&&(8!==c.st&&(isNaN(l)||0===l)||0!=+r.preview||(s=83)),0!==s?(p="".concat(exports.ErrorCode.GETINFO_SERVER_CODE_PREFIX).concat("000".concat(s).slice(-3)).concat(isNaN(l)?"":".".concat(l)),e.throw(p,r.msg||compile(i18nConfig.h5player.ERROR_GETINFO_CODE)),[2]):"o"===r.s&&c?[4,t()]:(e.throw(exports.ErrorCode.GETINFO_PARSE,compile(i18nConfig.h5player.ERROR_GETINFO_PARSE)),[2]);case 1:return _.sent(),[2]}}))}))},AD_INFO_OP_TYPE$1;function computePayType(e,t){var o=0;return 8===e?o=1:2===e&&(t>0?o=2:0===t&&(o=0)),o}function getTokenValue(e,t){var o=(e.split("$").map((function(e){return e.split("=")})).find((function(e){return e[0]===t}))||[])[1];return+(void 0===o?"0":o)}function getHlsUrls(e){return e.vl.vi[0].ul.ui.map((function(e){var t;return e.url&&(null===(t=e.hls)||void 0===t?void 0:t.pt)?{url:e.url+e.hls.pt,vt:e.vt}:{url:e.url,vt:e.vt}}))}function getM3U8Proxy(e){var t,o,r=e.play;return[{url:null!==(o=null===(t=r.masterurl)||void 0===t?void 0:t[0])&&void 0!==o?o:"keyid://".concat(r.keyid,".m3u8"),vt:e.vl.vi[0].ul.ui[0].vt}]}function getMp4Url(e,t,o,r,n,i){for(var a,s,l=[],c=e.ui.length,p=0;p<c;p++)s={url:"",vt:0},(a=e.ui[p]).url&&(a.url&&-1===a.url.indexOf("".concat(t,".flv"))&&-1===a.url.indexOf("".concat(t,".mp4"))?s.url=a.url+o:s.url=a.url,a.vt&&(s.vt=parseInt(a.vt,10)),-1===s.url.indexOf("sdtfrom")&&(s.url.indexOf("?")>-1?s.url+="&sdtfrom=".concat(n):s.url+="?sdtfrom=".concat(n),s.url+="&guid=".concat(i,"&vkey=").concat(r)),l.push(s));return l}function getUrls(e,t,o){var r,n,i,a,s,l,c,p;if(!(e&&(null===(i=null===(n=null===(r=e.vl)||void 0===r?void 0:r.vi[0].ul)||void 0===n?void 0:n.ui)||void 0===i?void 0:i.length)>0))return{urls:[],setLevelMode:SET_LEVEL_MODE.HARD};var d=e.dltype,u=(null===(a=e.vl)||void 0===a?void 0:a.vi)[0],A=u.fn,_=u.fvkey,E=u.keyid;if(3===d||8===d){if(e.play)return{urls:getM3U8Proxy(e),setLevelMode:SET_LEVEL_MODE.HARD};var g=getHlsUrls(e),f=!1;if(8===d){var h=e.vl.vi[0].ul.m3u8;h&&!(h.indexOf("#EXTINF:")>0||h.indexOf("EXT-X-TARGETDURATION:")>0)&&(f=!0,g.unshift({url:"keyid://".concat(E,".m3u8"),vt:g[0].vt}))}return{urls:g,setLevelMode:f?SET_LEVEL_MODE.HARD:SET_LEVEL_MODE.SMOOTH}}if(1===d){var v=(null===(l=null===(s=u.cl)||void 0===s?void 0:s.ci)||void 0===l?void 0:l.length)||0,y=u.fvkey&&u.fn&&(null===(p=null===(c=u.ul)||void 0===c?void 0:c.ui)||void 0===p?void 0:p.length)>0;if(v<=0&&y)return{urls:getMp4Url(u.ul,u.lnk,A,_,t,o),setLevelMode:SET_LEVEL_MODE.HARD}}return{urls:[],setLevelMode:SET_LEVEL_MODE.HARD}}function getAudioTrackInfo(e){var t,o,r,n=[];if(!e)return n;var i=e.al,a=e.vl,s=!1;null===(t=null==i?void 0:i.ai)||void 0===t||t.forEach((function(e){var t=e.keyid,o=e.sl,r=e.track,i=e.ul,a=e.name;o&&(s=!0),n.push({id:t,selected:!!o,url:i.ui[0].url,name:r,displayName:a})}));var l=null===(r=null===(o=null==a?void 0:a.vi)||void 0===o?void 0:o[0])||void 0===r?void 0:r.ai;if(l){var c=l.track,p=l.name;n.push({id:-1,selected:!s,url:"",name:c,displayName:p})}return n}function getDrm(e){var t,o=((null===(t=null==e?void 0:e.fl)||void 0===t?void 0:t.fi)||[]).find((function(e){return 1==+e.sl}));return o?+o.drm:0}function getPreview(e){var t;if(!e)return 0;var o=(null===(t=e.vl)||void 0===t?void 0:t.vi)[0],r=+e.em,n=+e.exem,i=+e.preview;return isNaN(r)||0!==r||0===i?0:n>0||8==+o.st?i:0}function parseCodecInfo$2(e){var t,o,r,n=CODEC.H264,i=((null===(t=null==e?void 0:e.vl)||void 0===t?void 0:t.vi)||[])[0],a=null===(r=null===(o=null==e?void 0:e.fl)||void 0===o?void 0:o.fi)||void 0===r?void 0:r.find((function(e){return 1===e.sl})),s=null==a?void 0:a.video;i&&(1===i.hevc&&(n=CODEC.H265));return{vtypeKey:s,vtype:VideoType$1[s]||"unknown",codec:n}}function selectKernel$2(e){var t,o,r=(e||{}).dltype,n=null===(o=null===(t=null==e?void 0:e.fl)||void 0===t?void 0:t.fi)||void 0===o?void 0:o.find((function(e){return 1===e.sl}));return commonSelectKernel({codec:parseCodecInfo$2(e).codec,dltype:r,drm:null==n?void 0:n.drm})}function parseGetinfoHlsAdRanges$1(e){var t,o,r=[];if(!(null==e?void 0:e.adpinfo))return r;try{null===(o=null===(t=JSON.parse(e.adpinfo))||void 0===t?void 0:t.assetid_info)||void 0===o||o.forEach((function(e){+e.optype===AD_INFO_OP_TYPE$1.PHLS&&r.push({start:e.ad_time_begin/1e3,end:e.ad_time_end/1e3,type:+e.optype})}))}catch(e){}return r.sort((function(e,t){return e.start-t.start})),r}!function(e){e[e.PHLS=2]="PHLS"}(AD_INFO_OP_TYPE$1||(AD_INFO_OP_TYPE$1={}));var parseResponseMiddleWare$2=function(e,t){return __awaiter(void 0,void 0,void 0,(function(){var o,r,n,i,a,s,l,c,p,d,u,A,_,E,g,f,h,v,y,m;return __generator(this,(function(T){switch(T.label){case 0:return o=e.resData,r=void 0===o?{}:o,n=e.reqParams,i=void 0===n?{}:n,a=(null===(g=r.vl)||void 0===g?void 0:g.vi)[0],s=a.td,l=a.ti,c=a.vh,p=a.vw,d=a.br,u=a.fs,A=getUrls(r,i.sdtfrom,i.guid),_=A.urls,E=A.setLevelMode,null!==(f=e.extraPlayConfig)&&void 0!==f||(e.extraPlayConfig={}),e.extraPlayConfig.setLevelMode=E,e.parseData={preview:getPreview(r),previewRemainCount:0,vitem:a,duration:s,title:l,byteRate:d,videoHeight:c,videoWidth:p,fileSize:u,urls:_,definitionList:null===(h=r.fl)||void 0===h?void 0:h.fi,subtitleList:null===(v=r.sfl)||void 0===v?void 0:v.fi,watermarkList:a.wl,previewList:a.pl?null===(y=a.pl[0])||void 0===y?void 0:y.pd:[],additionalTrackInfo:{subtitleTrack:[],altAudioTrack:getAudioTrackInfo(r)},supplementaryInfo:{contentInfo:{ad:parseGetinfoHlsAdRanges$1(a.ad)}}},null===(m=e.parseData.definitionList)||void 0===m||m.reverse(),e.logger.log("parse ",e.parseData),[4,t()];case 1:return T.sent(),[2]}}))}))},getckey=function(){var e,t,o,r,n,i=-8290,a=-496,s=s||function(e,t){var o={},r=o.a={},n=function(){},a=r.b={c:function(e){for(var t="",o=0;o<"ॅूॅक़".length;o++)t+=String.fromCharCode(2348^"ॅूॅक़".charCodeAt(o));n.prototype=this;var r=new n;return e&&r.d(e),r.hasOwnProperty(t)||(r.init=function(){r.$super.init.apply(this,arguments)}),r.init.prototype=r,r.$super=this,r},create:function(){var e=this.c();return e.init.apply(e,arguments),e},init:function(){},d:function(e){for(var t="",o=0;o<";͙ͥ;͸ͣͤͭ".length;o++)t+=String.fromCharCode(778^";͙ͥ;͸ͣͤͭ".charCodeAt(o));for(var r in e)e.hasOwnProperty(r)&&(this[r]=e[r]);e.hasOwnProperty(t)&&(this.toString=e.toString)},e:function(){return this.init.prototype.c(this)}},s=r.f=a.c({init:function(e,t){e=this.g=e||[],this.h=null!=t?t:(-2630+i+10924)*e.length},toString:function(e){return(e||c).i(this)},concat:function(e){var t=this.g,o=e.g,r=this.h;if(e=e.h,this.j(),r%4)for(var n=0;n<e;n++)t[r+n>>>2]|=(o[n>>>2]>>>24-n%4*8&255)<<24-(r+n)%4*8;else if(65535<o.length)for(n=0;n<e;n+=4)t[r+n>>>2]=o[n>>>2];else t.push.apply(t,o);return this.h+=e,this},j:function(){var t=this.g,o=this.h;t[o>>>2]&=4294967295<<32-o%4*8,t.length=e.ceil(o/4)},e:function(){var e=a.e.call(this);return e.g=this.g.slice(0),e},random:function(t){for(var o=[],r=0;r<t;r+=4)o.push(4294967296*e.random()|0);return new s.init(o,t)}}),l=o.k={},c=l.l={i:function(e){for(var t="",o=0;o<"".length;o++)t+=String.fromCharCode(368^"".charCodeAt(o));var r=e.g;e=e.h;for(var n=[],i=0;i<e;i++){var a=r[i>>>2]>>>24-i%4*8&255;n.push((a>>>4).toString(16)),n.push((15&a).toString(16))}return n.join(t)},parse:function(e){for(var t=e.length,o=[],r=0;r<t;r+=2)o[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new s.init(o,t/2)}},p=l.m={i:function(e){for(var t="",o=0;o<"".length;o++)t+=String.fromCharCode(2238^"".charCodeAt(o));var r=e.g;e=e.h;for(var n=[],i=0;i<e;i++)n.push(String.fromCharCode(r[i>>>2]>>>24-i%4*8&255));return n.join(t)},parse:function(e){for(var t=e.length,o=[],r=0;r<t;r++)o[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new s.init(o,t)}},d=l.n={i:function(e){for(var t="",o=0,r="ØôùóúçøðñµÀÁÓ¸­µñôáô";o<r.length;o++)t+=String.fromCharCode(149^r.charCodeAt(o));try{return decodeURIComponent(escape(p.i(e)))}catch(e){throw Error(t)}},parse:function(e){return p.parse(unescape(encodeURIComponent(e)))}},u=r.o=a.c({p:function(){this.q=new s.init,this.r=0},s:function(e){for(var t="",o=0;o<"ྦྷྠྦ྽ྺླ".length;o++)t+=String.fromCharCode(4052^"ྦྷྠྦ྽ྺླ".charCodeAt(o));t==typeof e&&(e=d.parse(e)),this.q.concat(e),this.r+=e.h},t:function(t){var o=this.q,r=o.g,n=o.h,i=this.u,a=n/(4*i);if(t=(a=t?e.ceil(a):e.max((0|a)-this.v,0))*i,n=e.min(4*t,n),t){for(var l=0;l<t;l+=i)this.w(r,l);l=r.splice(0,t),o.h-=n}return new s.init(l,n)},e:function(){var e=a.e.call(this);return e.q=this.q.e(),e},v:0});r.x=u.c({y:a.c(),init:function(e){this.y=this.y.c(e),this.p()},p:function(){u.p.call(this),this.z()},A:function(e){return this.s(e),this.t(),this},B:function(e){return e&&this.s(e),this.C()},u:16,D:function(e){return function(t,o){return new e.init(o).B(t)}},F:function(e){return function(t,o){return new A.HMAC.init(e,o).B(t)}}});var A=o.G={};return o}(Math);function l(e){return c.call(this,2,e)}function c(e){for(var t="",o=0;o<"ऊ".length;o++)t+=String.fromCharCode(2422^"ऊ".charCodeAt(o));for(var r="",n=0;n<"ޭ".length;n++)r+=String.fromCharCode(2001^"ޭ".charCodeAt(n));for(var p="",d=0;d<"Ҡ".length;d++)p+=String.fromCharCode(1244^"Ҡ".charCodeAt(d));for(var u="",A=0;A<"ഇ".length;A++)u+=String.fromCharCode(3451^"ഇ".charCodeAt(A));for(var _="",E=0;E<"׿".length;E++)_+=String.fromCharCode(1411^"׿".charCodeAt(E));for(var g="",f=0;f<"ࢨ".length;f++)g+=String.fromCharCode(2260^"ࢨ".charCodeAt(f));for(var h="",v=0;v<"ଶ".length;v++)h+=String.fromCharCode(2890^"ଶ".charCodeAt(v));for(var y="",m=0;m<"ƨƢǶƦǶƧǵǱƧƤ".length;m++)y+=String.fromCharCode(453^"ƨƢǶƦǶƧǵǱƧƤ".charCodeAt(m));for(var T="",C=0;C<"੸".length;C++)T+=String.fromCharCode(2564^"੸".charCodeAt(C));for(var I="",P=0;P<"ࡌ".length;P++)I+=String.fromCharCode(2096^"ࡌ".charCodeAt(P));for(var S="",N=0;N<"ٶ".length;N++)S+=String.fromCharCode(1546^"ٶ".charCodeAt(N));for(var D="",O=0;O<"ઈ".length;O++)D+=String.fromCharCode(2804^"ઈ".charCodeAt(O));for(var x="",R=0;R<"ȧ".length;R++)x+=String.fromCharCode(603^"ȧ".charCodeAt(R));for(var b="",L=0;L<"о".length;L++)b+=String.fromCharCode(1090^"о".charCodeAt(L));for(var w="",M=0;M<"ߡ".length;M++)w+=String.fromCharCode(1949^"ߡ".charCodeAt(M));for(var V="",k=0;k<"̅".length;k++)V+=String.fromCharCode(889^"̅".charCodeAt(k));for(var B="",K=0;K<"".length;K++)B+=String.fromCharCode(3568^"".charCodeAt(K));for(var Y="",F=0;F<"".length;F++)Y+=String.fromCharCode(777^"".charCodeAt(F));for(var U="",Q=0;Q<"".length;Q++)U+=String.fromCharCode(2613^"".charCodeAt(Q));for(var H="",$=0;$<"´¹²¯".length;$++)H+=String.fromCharCode(214^"´¹²¯".charCodeAt($));for(var G="",q=0;q<"ۘە۞ۃ".length;q++)G+=String.fromCharCode(1722^"ۘە۞ۃ".charCodeAt(q));for(var j="",W=0;W<"٨٩٨٣".length;W++)j+=String.fromCharCode(1542^"٨٩٨٣".charCodeAt(W));for(var z="",X=0;X<"ÁÌ".length;X++)z+=String.fromCharCode(168^"ÁÌ".charCodeAt(X));for(var J="",Z=0;Z<"ۆۋ۔".length;Z++)J+=String.fromCharCode(1698^"ۆۋ۔".charCodeAt(Z));for(var ee="",te=0,oe="ଶଋ୑୞ଈ଍଍୑୙ଶ";te<oe.length;te++)ee+=String.fromCharCode(2921^oe.charCodeAt(te));for(var re="",ne=0;ne<"יׇ׀׊ׁי".length;ne++)re+=String.fromCharCode(1454^"יׇ׀׊ׁי".charCodeAt(ne));switch(e){case 0:var ie=[];window[re]===window?ie.push(0):ie.push(1);try{var ae=ee+Math.floor(1e7*Math.random()),se=document.createElement(J);se.setAttribute(z,ae),se.style.La=j,(document.body||document.getElementsByTagName(G)[0]).appendChild(se),document.getElementById(ae)?ie.push(0):ie.push(1),(document.body||document.getElementsByTagName(H)[0]).removeChild(se)}catch(e){ie.push(1)}return ie.join(U);case 1:var le=arguments[1],ce=new s.a.f.init([1332468387,-1641050960,2136896045,-1629555948],16),pe=new s.a.f.init([22039283,1457920463,776125350,-1941999367],16);return s.Ga.$(le,ce,{ra:pe,ba:s.ba.la,qa:s.na.ma}).xa.toString().toUpperCase();case 2:return(fe=arguments[1])?fe.length>48?fe.substr(0,48):fe:Y;case 3:var de=window.document.URL,ue=window.navigator.userAgent.toLowerCase(),Ae=B;window.document.referrer.length>0&&(Ae=window.document.referrer);try{0==Ae.length&&opener.location.href.length>0&&(Ae=opener.location.href)}catch(e){}var _e=window.navigator.appCodeName,Ee=window.navigator.appName,ge=window.navigator.platform;return de=l(de),Ae=l(Ae),de+V+(ue=l(ue))+w+Ae+b+_e+x+Ee+D+ge;case 4:var fe=arguments[1],he=0;if(0==fe.length)return he;for(i=0;i<fe.length;i++){var ve=fe.charCodeAt(i);he=(he=(he<<5)-he+ve)&he}return he;case 5:var ye=S+arguments[a+i+8787]+I+arguments[2]+T+y+h+arguments[3]+g+arguments[4]+_+arguments[5]+u+function(){return c.call(this,3)}()+p+function(){return c.call(this,0)}()+r;return function(e){return c.call(this,1,e)}(t+(he=function(e){return c.call(this,4,e)}(ye))+ye)}}return function(){for(var e="",t=0,o="±²³´µ¶·¸¹º»¼½¾¿ ¡¢£¤¥¦§¨©ªàáâãäåæçèéûÿí";t<o.length;t++)e+=String.fromCharCode(208^o.charCodeAt(t));var r=s,n=r.a.f;r.k.H={i:function(e){for(var t="",o=0;o<"".length;o++)t+=String.fromCharCode(4077^"".charCodeAt(o));var r=e.g,n=e.h,i=this.I;e.j(),e=[];for(var a=0;a<n;a+=3)for(var s=(r[a>>>2]>>>24-a%4*8&255)<<16|(r[a+1>>>2]>>>24-(a+1)%4*8&255)<<8|r[a+2>>>2]>>>24-(a+2)%4*8&255,l=0;4>l&&a+.75*l<n;l++)e.push(i.charAt(s>>>6*(3-l)&63));if(r=i.charAt(64))for(;e.length%4;)e.push(r);return e.join(t)},parse:function(e){var t=e.length,o=this.I;(r=o.charAt(64))&&-1!=(r=e.indexOf(r))&&(t=r);for(var r=[],i=0,a=0;a<t;a++)if(a%4){var s=o.indexOf(e.charAt(a-1))<<a%4*2,l=o.indexOf(e.charAt(a))>>>6-a%4*2;r[i>>>2]|=(s|l)<<24-i%4*8,i++}return n.create(r,i)},I:e}}(),function(e){function t(e,t,o,r,n,i,a){return u.call(this,0,e,t,o,r,n,i,a)}function o(e,t,o,r,n,i,a){return u.call(this,1,e,t,o,r,n,i,a)}function r(e,t,o,r,n,i,a){return u.call(this,2,e,t,o,r,n,i,a)}function n(e,t,o,r,n,i,a){return u.call(this,3,e,t,o,r,n,i,a)}for(var i=s,a=(c=i.a).f,l=c.x,c=i.G,p=[],d=0;64>d;d++)p[d]=4294967296*e.abs(e.sin(d+1))|0;function u(e){switch(e){case 0:var t=arguments[1],o=arguments[2],r=arguments[3],n=arguments[4],i=arguments[5],a=arguments[6];return((t=t+(o&r|~o&n)+i+arguments[7])<<a|t>>>32-a)+o;case 1:return((t=(t=arguments[1])+((o=arguments[2])&(n=arguments[4])|(r=arguments[3])&~n)+(i=arguments[5])+arguments[7])<<(a=arguments[6])|t>>>32-a)+o;case 2:return((t=(t=arguments[1])+((o=arguments[2])^(r=arguments[3])^(n=arguments[4]))+(i=arguments[5])+arguments[7])<<(a=arguments[6])|t>>>32-a)+o;case 3:return((t=(t=arguments[1])+((r=arguments[3])^((o=arguments[2])|~(n=arguments[4])))+(i=arguments[5])+arguments[7])<<(a=arguments[6])|t>>>32-a)+o}}c=c.J=l.c({z:function(){this.K=new a.init([1732584193,4023233417,2562383102,271733878])},w:function(e,i){for(var a=0;16>a;a++){var s=e[d=i+a];e[d]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}a=this.K.g;var l,c,d=e[i+0],u=(s=e[i+1],e[i+2]),A=e[i+3],_=e[i+4],E=e[i+5],g=e[i+6],f=e[i+7],h=e[i+8],v=e[i+9],y=e[i+10],m=e[i+11],T=e[i+12],C=e[i+13],I=e[i+14],P=e[i+15],S=a[0],N=n(N=n(N=n(N=n(N=r(N=r(N=r(N=r(N=o(N=o(N=o(N=o(N=t(N=t(N=t(N=t(N=a[1],c=t(c=a[2],l=t(l=a[3],S=t(S,N,c,l,d,7,p[0]),N,c,s,12,p[1]),S,N,u,17,p[2]),l,S,A,22,p[3]),c=t(c,l=t(l,S=t(S,N,c,l,_,7,p[4]),N,c,E,12,p[5]),S,N,g,17,p[6]),l,S,f,22,p[7]),c=t(c,l=t(l,S=t(S,N,c,l,h,7,p[8]),N,c,v,12,p[9]),S,N,y,17,p[10]),l,S,m,22,p[11]),c=t(c,l=t(l,S=t(S,N,c,l,T,7,p[12]),N,c,C,12,p[13]),S,N,I,17,p[14]),l,S,P,22,p[15]),c=o(c,l=o(l,S=o(S,N,c,l,s,5,p[16]),N,c,g,9,p[17]),S,N,m,14,p[18]),l,S,d,20,p[19]),c=o(c,l=o(l,S=o(S,N,c,l,E,5,p[20]),N,c,y,9,p[21]),S,N,P,14,p[22]),l,S,_,20,p[23]),c=o(c,l=o(l,S=o(S,N,c,l,v,5,p[24]),N,c,I,9,p[25]),S,N,A,14,p[26]),l,S,h,20,p[27]),c=o(c,l=o(l,S=o(S,N,c,l,C,5,p[28]),N,c,u,9,p[29]),S,N,f,14,p[30]),l,S,T,20,p[31]),c=r(c,l=r(l,S=r(S,N,c,l,E,4,p[32]),N,c,h,11,p[33]),S,N,m,16,p[34]),l,S,I,23,p[35]),c=r(c,l=r(l,S=r(S,N,c,l,s,4,p[36]),N,c,_,11,p[37]),S,N,f,16,p[38]),l,S,y,23,p[39]),c=r(c,l=r(l,S=r(S,N,c,l,C,4,p[40]),N,c,d,11,p[41]),S,N,A,16,p[42]),l,S,g,23,p[43]),c=r(c,l=r(l,S=r(S,N,c,l,v,4,p[44]),N,c,T,11,p[45]),S,N,P,16,p[46]),l,S,u,23,p[47]),c=n(c,l=n(l,S=n(S,N,c,l,d,6,p[48]),N,c,f,10,p[49]),S,N,I,15,p[50]),l,S,E,21,p[51]),c=n(c,l=n(l,S=n(S,N,c,l,T,6,p[52]),N,c,A,10,p[53]),S,N,y,15,p[54]),l,S,s,21,p[55]),c=n(c,l=n(l,S=n(S,N,c,l,h,6,p[56]),N,c,P,10,p[57]),S,N,g,15,p[58]),l,S,C,21,p[59]),c=n(c,l=n(l,S=n(S,N,c,l,_,6,p[60]),N,c,m,10,p[61]),S,N,u,15,p[62]),l,S,v,21,p[63]);a[0]=a[0]+S|0,a[1]=a[1]+N|0,a[2]=a[2]+c|0,a[3]=a[3]+l|0},C:function(){var t=this.q,o=t.g,r=8*this.r,n=8*t.h;o[n>>>5]|=128<<24-n%32;var i=e.floor(r/4294967296);for(o[15+(n+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),o[14+(n+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),t.h=4*(o.length+1),this.t(),o=(t=this.K).g,r=0;4>r;r++)n=o[r],o[r]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8);return t},e:function(){var e=l.e.call(this);return e.K=this.K.e(),e}}),i.J=l.D(c),i.L=l.F(c)}(Math),o=(e=(t=s).a).b,r=e.f,n=(e=t.G).M=o.c({y:o.c({N:4,O:e.J,P:1}),init:function(e){this.y=this.y.c(e)},Q:function(e,t){for(var o=(s=this.y).O.create(),n=r.create(),i=n.g,a=s.N,s=s.P;i.length<a;){l&&o.A(l);var l=o.A(e).B(t);o.p();for(var c=1;c<s;c++)l=o.B(l),o.p();n.concat(l)}return n.h=4*a,n}}),t.M=function(e,t,o){return n.create(o).Q(e,t)},s.a.R||function(e){var t=(_=s).a,o=t.b,r=t.f,n=t.o,i=_.k.H,a=_.G.M,l=t.R=n.c({y:o.c(),S:function(e,t){return this.create(this.T,e,t)},U:function(e,t){return this.create(this.V,e,t)},init:function(e,t,o){this.y=this.y.c(o),this.W=e,this.X=t,this.p()},p:function(){n.p.call(this),this.z()},Y:function(e){return this.s(e),this.t()},B:function(e){return e&&this.s(e),this.C()},N:4,Z:4,T:1,V:2,D:function(e){return{$:function(t,o,r){for(var n="",i=0;i<"ǠǧǡǺǽǴ".length;i++)n+=String.fromCharCode(403^"ǠǧǡǺǽǴ".charCodeAt(i));return(n==typeof o?E:A).$(e,t,o,r)},_:function(t,o,r){for(var n="",i=0;i<"ࣘࣟࣙࣂࣅ࣌".length;i++)n+=String.fromCharCode(2219^"ࣘࣟࣙࣂࣅ࣌".charCodeAt(i));return(n==typeof o?E:A)._(e,t,o,r)}}}});t.aa=l.c({C:function(){return this.t(!0)},u:1});var c=_.ba={},p=function(e,t,o){var r=this.ca;r?this.ca=void 0:r=this.da;for(var n=0;n<o;n++)e[t+n]^=r[n]},d=(t.ea=o.c({S:function(e,t){return this.fa.create(e,t)},U:function(e,t){return this.ga.create(e,t)},init:function(e,t){this.ha=e,this.ca=t}})).c();d.fa=d.c({ia:function(e,t){var o=this.ha,r=o.u;p.call(this,e,t,r),o.ja(e,t),this.da=e.slice(t,t+r)}}),d.ga=d.c({ia:function(e,t){var o=this.ha,r=o.u,n=e.slice(t,t+r);o.ka(e,t),p.call(this,e,t,r),this.da=n}}),c=c.la=d,d=(_.na={}).ma={na:function(e,t){for(var o,n=(o=(o=4*t)-e.h%o)<<24|o<<16|o<<8|o,i=[],a=0;a<o;a+=4)i.push(n);o=r.create(i,o),e.concat(o)},oa:function(e){e.h-=255&e.g[e.h-1>>>2]}},t.pa=l.c({y:l.y.c({ba:c,qa:d}),p:function(){l.p.call(this);var e=(t=this.y).ra,t=t.ba;if(this.W==this.T)var o=t.S;else o=t.U,this.v=1;this.sa=o.call(t,this,e&&e.g)},w:function(e,t){this.sa.ia(e,t)},C:function(){var e=this.y.qa;if(this.W==this.T){e.na(this.q,this.u);var t=this.t(!0)}else t=this.t(!0),e.oa(t);return t},u:4});var u=t.ta=o.c({init:function(e){this.d(e)},toString:function(e){return(e||this.ua).i(this)}}),A=(c=(_.wa={}).va={i:function(e){var t=e.xa;return((e=e.ya)?r.create([1398893684,1701076831]).concat(e).concat(t):t).toString(i)},parse:function(e){var t=(e=i.parse(e)).g;if(1398893684==t[0]&&1701076831==t[1]){var o=r.create(t.slice(2,4));t.splice(0,4),e.h-=16}return u.create({xa:e,ya:o})}},t.za=o.c({y:o.c({wa:c}),$:function(e,t,o,r){r=this.y.c(r);var n=e.S(o,r);return t=n.B(t),n=n.y,u.create({xa:t,Aa:o,ra:n.ra,Ba:e,ba:n.ba,qa:n.qa,u:e.u,ua:r.wa})},_:function(e,t,o,r){return r=this.y.c(r),t=this.Ca(t,r.wa),e.U(o,r).B(t.xa)},Ca:function(e,t){for(var o="",r=0;r<"ࠕࠒࠔࠏࠈࠁ".length;r++)o+=String.fromCharCode(2150^"ࠕࠒࠔࠏࠈࠁ".charCodeAt(r));return o==typeof e?t.parse(e,this):e}})),_=(_.Da={}).va={Ea:function(e,t,o,n){return n||(n=r.random(8)),e=a.create({N:t+o}).Q(e,n),o=r.create(e.g.slice(t),4*o),e.h=4*t,u.create({Aa:e,ra:o,ya:n})}},E=t.Fa=A.c({y:A.y.c({Da:_}),$:function(e,t,o,r){return o=(r=this.y.c(r)).Da.Ea(o,e.N,e.Z),r.ra=o.ra,(e=A.$.call(this,e,t,o.Aa,r)).d(o),e},_:function(e,t,o,r){return r=this.y.c(r),t=this.Ca(t,r.wa),o=r.Da.Ea(o,e.N,e.Z,t.ya),r.ra=o.ra,A._.call(this,e,t,o.Aa,r)}})}(),function(){for(var e=s,t=e.a.pa,o=e.G,r=[],n=[],i=[],a=[],l=[],c=[],p=[],d=[],u=[],A=[],_=[],E=0;256>E;E++)_[E]=128>E?E<<1:E<<1^283;var g=0,f=0;for(E=0;256>E;E++){var h=(h=f^f<<1^f<<2^f<<3^f<<4)>>>8^255&h^99;r[g]=h,n[h]=g;var v=_[g],y=_[v],m=_[y],T=257*_[h]^16843008*h;i[g]=T<<24|T>>>8,a[g]=T<<16|T>>>16,l[g]=T<<8|T>>>24,c[g]=T,T=16843009*m^65537*y^257*v^16843008*g,p[h]=T<<24|T>>>8,d[h]=T<<16|T>>>16,u[h]=T<<8|T>>>24,A[h]=T,g?(g=v^_[_[_[m^v]]],f^=_[_[f]]):g=f=1}var C=[0,1,2,4,8,16,32,64,128,27,54];o=o.Ga=t.c({z:function(){for(var e=(o=this.X).g,t=o.h/4,o=4*((this.Ha=t+6)+1),n=this.Ia=[],i=0;i<o;i++)if(i<t)n[i]=e[i];else{var a=n[i-1];i%t?6<t&&4==i%t&&(a=r[a>>>24]<<24|r[a>>>16&255]<<16|r[a>>>8&255]<<8|r[255&a]):(a=r[(a=a<<8|a>>>24)>>>24]<<24|r[a>>>16&255]<<16|r[a>>>8&255]<<8|r[255&a],a^=C[i/t|0]<<24),n[i]=n[i-t]^a}for(e=this.Ja=[],t=0;t<o;t++)i=o-t,a=t%4?n[i]:n[i-4],e[t]=4>t||4>=i?a:p[r[a>>>24]]^d[r[a>>>16&255]]^u[r[a>>>8&255]]^A[r[255&a]]},ja:function(e,t){this.Ka(e,t,this.Ia,i,a,l,c,r)},ka:function(e,t){var o=e[t+1];e[t+1]=e[t+3],e[t+3]=o,this.Ka(e,t,this.Ja,p,d,u,A,n),o=e[t+1],e[t+1]=e[t+3],e[t+3]=o},Ka:function(e,t,o,r,n,i,a,s){for(var l=this.Ha,c=e[t]^o[0],p=e[t+1]^o[1],d=e[t+2]^o[2],u=e[t+3]^o[3],A=4,_=1;_<l;_++){var E=r[c>>>24]^n[p>>>16&255]^i[d>>>8&255]^a[255&u]^o[A++],g=r[p>>>24]^n[d>>>16&255]^i[u>>>8&255]^a[255&c]^o[A++],f=r[d>>>24]^n[u>>>16&255]^i[c>>>8&255]^a[255&p]^o[A++];u=r[u>>>24]^n[c>>>16&255]^i[p>>>8&255]^a[255&d]^o[A++],c=E,p=g,d=f}E=(s[c>>>24]<<24|s[p>>>16&255]<<16|s[d>>>8&255]<<8|s[255&u])^o[A++],g=(s[p>>>24]<<24|s[d>>>16&255]<<16|s[u>>>8&255]<<8|s[255&c])^o[A++],f=(s[d>>>24]<<24|s[u>>>16&255]<<16|s[c>>>8&255]<<8|s[255&p])^o[A++],u=(s[u>>>24]<<24|s[c>>>16&255]<<16|s[p>>>8&255]<<8|s[255&d])^o[A++],e[t]=E,e[t+1]=g,e[t+2]=f,e[t+3]=u},N:8}),e.Ga=t.D(o)}(),function(e,t,o,r,n){return c.call(this,5,e,t,o,r,n)}}(),_thumbplayerCkeyWasmFactory=(_scriptDir="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,function(e){var t,o,r;e=e||{},t||(t=void 0!==e?e:{}),t.ready=new Promise((function(e,t){o=e,r=t}));var n,i,a,s={};for(n in t)t.hasOwnProperty(n)&&(s[n]=t[n]);i="object"==typeof window,a="function"==typeof importScripts;var l,c="";(i||a)&&(a?c=self.location.href:"undefined"!=typeof document&&document.currentScript&&(c=document.currentScript.src),_scriptDir&&(c=_scriptDir),c=0!==c.indexOf("blob:")?c.substr(0,c.lastIndexOf("/")+1):"",a&&(l=function(e){try{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}catch(t){if(e=L(e))return e;throw t}}));var p,d=t.printErr||console.warn.bind(console);for(n in s)s.hasOwnProperty(n)&&(t[n]=s[n]);s=null,t.wasmBinary&&(p=t.wasmBinary),t.noExitRuntime;var u=!1;function A(e){var o=t["_"+e];return o||S("Assertion failed: Cannot call unknown function "+e+", make sure it is exported"),o}function _(e,t,o,r){var n={string:function(e){var t=0;if(null!=e&&0!==e){var o=1+(e.length<<2);g(e,t=B(o),o)}return t},array:function(e){var t=B(e.length);return f.set(e,t),t}},i=A(e),a=[];if(e=0,r)for(var s=0;s<r.length;s++){var l=n[o[s]];l?(0===e&&(e=V()),a[s]=l(r[s])):a[s]=r[s]}return o=function(e){if("string"===t)if(e){for(var o=h,r=e+NaN,n=e;o[n]&&!(n>=r);)++n;if(16<n-e&&o.subarray&&E)e=E.decode(o.subarray(e,n));else{for(r="";e<n;){var i=o[e++];if(128&i){var a=63&o[e++];if(192==(224&i))r+=String.fromCharCode((31&i)<<6|a);else{var s=63&o[e++];65536>(i=224==(240&i)?(15&i)<<12|a<<6|s:(7&i)<<18|a<<12|s<<6|63&o[e++])?r+=String.fromCharCode(i):(i-=65536,r+=String.fromCharCode(55296|i>>10,56320|1023&i))}}else r+=String.fromCharCode(i)}e=r}}else e="";else e="boolean"===t?!!e:e;return e}(o=i.apply(null,a)),0!==e&&k(e),o}var E="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function g(e,t,o){var r=h;if(0<o){o=t+o-1;for(var n=0;n<e.length;++n){var i=e.charCodeAt(n);if(55296<=i&&57343>=i&&(i=65536+((1023&i)<<10)|1023&e.charCodeAt(++n)),127>=i){if(t>=o)break;r[t++]=i}else{if(2047>=i){if(t+1>=o)break;r[t++]=192|i>>6}else{if(65535>=i){if(t+2>=o)break;r[t++]=224|i>>12}else{if(t+3>=o)break;r[t++]=240|i>>18,r[t++]=128|i>>12&63}r[t++]=128|i>>6&63}r[t++]=128|63&i}}r[t]=0}}var f,h,v,y=[],m=[],T=[];function C(){var e=t.preRun.shift();y.unshift(e)}var I=0,P=null;function S(e){throw t.onAbort&&t.onAbort(e),d(e),u=!0,e=new WebAssembly.RuntimeError("abort("+e+"). Build with -s ASSERTIONS=1 for more info."),r(e),e}t.preloadedImages={},t.preloadedAudios={};var N="data:application/octet-stream;base64,",D="data:application/octet-stream;base64,AGFzbQEAAAABcBFgAX8Bf2ACf38AYAN/f38AYAF/AGACf38Bf2AAAGADf39+AGAAAX9gA39/fgF/YAZ/f35/fn8Bf2AEf35/fwF/YAR/f39/AGAIf39/f39/f38AYAR/f39+AGACf34AYAN/f38Bf2AGf39/f39/AX8CGQQBYQFhAAUBYQFiAA8BYQFjAAABYQFkAAcDOTgAAQMAAQAAAgALAAECAQECBgQCAwADAQYABQMCAAAADAEAAAABAQECBQ0CAQ4AAAADBxAJCgQIBAQFAXABBgYFBgEBgAKAAgYJAX8BQbCVwAILByEIAWUCAAFmAB0BZwEAAWgANgFpADUBagA0AWsAMwFsACEJCwEAQQELBTs6OTg3CpW1AThkAQF/IwBBEGsiASAANgIMIAEgASgCDC0AADYCCCABIAEoAgggASgCDC0AAUEIdHI2AgggASABKAIIIAEoAgwtAAJBEHRyNgIIIAEgASgCCCABKAIMLQADQRh0cjYCCCABKAIIC3IBAX8jAEEQayICIAA2AgwgAiABNgIIIAIoAgwgAigCCDoAACACIAIoAghBCHY2AgggAigCDCACKAIIOgABIAIgAigCCEEIdjYCCCACKAIMIAIoAgg6AAIgAiACKAIIQQh2NgIIIAIoAgwgAigCCDoAAwsaAQF/IAAQDgRAIAAQJyEBIAAQJhogARAXCwszAQF/IwBBEGsiASQAIAEgADYCDCMAQRBrIgAgASgCDDYCDCAAKAIMIQAgAUEQaiQAIAALagEBfyMAQSBrIgIkACACIAA2AhwgAiABNgIYIAIoAhwiACACQRBqIAJBCGoQHyAAIAIoAhgCfyACKAIYIQEjAEEQayIAJAAgACABNgIMIAAoAgwQICEBIABBEGokACABCxArIAJBIGokAAuuAQEEfyMAQRBrIgQkACAEIAA2AgwgBCgCDCEBIwBBEGsiACQAIAAgATYCDCAAKAIMIQIjAEEQayIBJAAgASACNgIMAn8gASgCDCIDEA5BAXEEQCADEDIMAQsjAEEQayICJAAgAiADNgIMIAIoAgwQBxAHIQMgAkEQaiQAIAMLIQIgAUEQaiQAIAIhASMAQRBrIgIgATYCDCACKAIMIQEgAEEQaiQAIARBEGokACABCyYBAX8jAEEQayIBJAAgASAANgIMIAEoAgwQHCEAIAFBEGokACAAC4UBAQF/IwBBEGsiAyQAIAMgADYCDCADIAE2AgggAyACNgIEIAMoAgQoAgBBBGpBgAhJBEAgAygCDCADKAIEKAIAaiADKAIIIgBBCHRBgID8B3EgAEEYdHIgAEEIdkGA/gNxIABBGHZycjYCACADKAIEIgAgACgCAEEEajYCAAsgA0EQaiQAC08BAn9BlAooAgAiASAAQQNqQXxxIgJqIQACQCACQQAgACABTRsNACAAPwBBEHRLBEAgABACRQ0BC0GUCiAANgIAIAEPC0G4EUEwNgIAQX8LrwEBAX8jAEEQayIEJAAgBCAANgIMIAQgATYCCCAEIAI2AgQgBCADNgIAIAQoAgQgBCgCACgCAEECampBgAhJBEAgBCgCDCAEKAIAKAIAaiAEKAIEQf//A3EiAEEIdCAAQQh2cjsBACAEKAIAIgAgACgCAEECajYCACAEKAIMIAQoAgAoAgBqIAQoAgggBCgCBBAWIAQoAgAiACAEKAIEIAAoAgBqNgIACyAEQRBqJAALMAEBfyMAQRBrIgEkACABIAA2AgwgASgCDBAHLQALQYABcUEARyEAIAFBEGokACAAC4gBAQJ/IwBBEGsiAyQAIwBBEGsiAiADQQhqNgIMIAIoAgwaIwBBEGsiAiAANgIEIAIoAgQaAkAgARAORQRAIAEQByEBIAAQByIAIAEoAgg2AgggACABKQIANwIADAELIAACfyABEDIhACMAQRBrIgIgADYCDCACKAIMCyABEDEQKwsgA0EQaiQACw8AIAIEQCAAIAEgAhAWCwtcAQF/IwBBEGsiAiAANgIMIAIgATYCCCACIAIoAgw2AgQgAkEANgIAA0AgAigCACACKAIIT0UEQCACKAIEIQAgAiACKAIAIgFBAWo2AgAgACABakEAOgAADAELCwvWAgEBfwJAIAFFDQAgACABaiICQQFrQQA6AAAgAEEAOgAAIAFBA0kNACACQQJrQQA6AAAgAEEAOgABIAJBA2tBADoAACAAQQA6AAIgAUEHSQ0AIAJBBGtBADoAACAAQQA6AAMgAUEJSQ0AIABBACAAa0EDcSICaiIAQQA2AgAgACABIAJrQXxxIgJqIgFBBGtBADYCACACQQlJDQAgAEEANgIIIABBADYCBCABQQhrQQA2AgAgAUEMa0EANgIAIAJBGUkNACAAQQA2AhggAEEANgIUIABBADYCECAAQQA2AgwgAUEQa0EANgIAIAFBFGtBADYCACABQRhrQQA2AgAgAUEca0EANgIAIAIgAEEEcUEYciICayIBQSBJDQAgACACaiEAA0AgAEIANwMYIABCADcDECAAQgA3AwggAEIANwMAIABBIGohACABQSBrIgFBH0sNAAsLC3cBA38jAEEQayIFJAACQCACIAAQJSIEIAAQHCIDa00EQCACRQ0BIAAQGCIEIANqIAEgAhAQIAAgAiADaiIAECQgBUEAOgAPIAAgBGogBS0ADzoAAAwBCyAAIAQgAiADaiAEayADIANBACACIAEQIwsgBUEQaiQAC0UBAX8jAEEQayIDJAAgAyAANgIMIAMgATYCCCADIAI3AwAgAygCDCADKAIIIAMpAwBBhAooAgAoAgQRCAAaIANBEGokAAuDAQEBfyMAQSBrIgIgADYCHCACIAE2AhggAkGDATYCFCACQQA2AhAgAkEANgIMA0AgAigCDCACKAIYT0UEQCACKAIQIAIoAhRsIQAgAiACKAIcIgFBAWo2AhwgAiABLQAAIABqNgIQIAIgAigCDEEBajYCDAwBCwsgAigCEEH/////B3EL/wMBAn8gAkGABE8EQCAAIAEgAhABGg8LIAAgAmohAwJAIAAgAXNBA3FFBEACQCAAQQNxRQRAIAAhAgwBCyACQQFIBEAgACECDAELIAAhAgNAIAIgAS0AADoAACABQQFqIQEgAkEBaiICQQNxRQ0BIAIgA0kNAAsLAkAgA0F8cSIAQcAASQ0AIAIgAEFAaiIESw0AA0AgAiABKAIANgIAIAIgASgCBDYCBCACIAEoAgg2AgggAiABKAIMNgIMIAIgASgCEDYCECACIAEoAhQ2AhQgAiABKAIYNgIYIAIgASgCHDYCHCACIAEoAiA2AiAgAiABKAIkNgIkIAIgASgCKDYCKCACIAEoAiw2AiwgAiABKAIwNgIwIAIgASgCNDYCNCACIAEoAjg2AjggAiABKAI8NgI8IAFBQGshASACQUBrIgIgBE0NAAsLIAAgAk0NAQNAIAIgASgCADYCACABQQRqIQEgAkEEaiICIABJDQALDAELIANBBEkEQCAAIQIMAQsgACADQQRrIgRLBEAgACECDAELIAAhAgNAIAIgAS0AADoAACACIAEtAAE6AAEgAiABLQACOgACIAIgAS0AAzoAAyABQQRqIQEgAkEEaiICIARNDQALCyACIANJBEADQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADRw0ACwsLpwwBB38CQCAARQ0AIABBCGsiAyAAQQRrKAIAIgFBeHEiAGohBQJAIAFBAXENACABQQNxRQ0BIAMgAygCACIBayIDQdARKAIASQ0BIAAgAWohACADQdQRKAIARwRAIAFB/wFNBEAgAygCCCICIAFBA3YiBEEDdEHoEWpGGiACIAMoAgwiAUYEQEHAEUHAESgCAEF+IAR3cTYCAAwDCyACIAE2AgwgASACNgIIDAILIAMoAhghBgJAIAMgAygCDCIBRwRAIAMoAggiAiABNgIMIAEgAjYCCAwBCwJAIANBFGoiAigCACIEDQAgA0EQaiICKAIAIgQNAEEAIQEMAQsDQCACIQcgBCIBQRRqIgIoAgAiBA0AIAFBEGohAiABKAIQIgQNAAsgB0EANgIACyAGRQ0BAkAgAyADKAIcIgJBAnRB8BNqIgQoAgBGBEAgBCABNgIAIAENAUHEEUHEESgCAEF+IAJ3cTYCAAwDCyAGQRBBFCAGKAIQIANGG2ogATYCACABRQ0CCyABIAY2AhggAygCECICBEAgASACNgIQIAIgATYCGAsgAygCFCICRQ0BIAEgAjYCFCACIAE2AhgMAQsgBSgCBCIBQQNxQQNHDQBByBEgADYCACAFIAFBfnE2AgQgAyAAQQFyNgIEIAAgA2ogADYCAA8LIAMgBU8NACAFKAIEIgFBAXFFDQACQCABQQJxRQRAIAVB2BEoAgBGBEBB2BEgAzYCAEHMEUHMESgCACAAaiIANgIAIAMgAEEBcjYCBCADQdQRKAIARw0DQcgRQQA2AgBB1BFBADYCAA8LIAVB1BEoAgBGBEBB1BEgAzYCAEHIEUHIESgCACAAaiIANgIAIAMgAEEBcjYCBCAAIANqIAA2AgAPCyABQXhxIABqIQACQCABQf8BTQRAIAUoAggiAiABQQN2IgRBA3RB6BFqRhogAiAFKAIMIgFGBEBBwBFBwBEoAgBBfiAEd3E2AgAMAgsgAiABNgIMIAEgAjYCCAwBCyAFKAIYIQYCQCAFIAUoAgwiAUcEQCAFKAIIIgJB0BEoAgBJGiACIAE2AgwgASACNgIIDAELAkAgBUEUaiICKAIAIgQNACAFQRBqIgIoAgAiBA0AQQAhAQwBCwNAIAIhByAEIgFBFGoiAigCACIEDQAgAUEQaiECIAEoAhAiBA0ACyAHQQA2AgALIAZFDQACQCAFIAUoAhwiAkECdEHwE2oiBCgCAEYEQCAEIAE2AgAgAQ0BQcQRQcQRKAIAQX4gAndxNgIADAILIAZBEEEUIAYoAhAgBUYbaiABNgIAIAFFDQELIAEgBjYCGCAFKAIQIgIEQCABIAI2AhAgAiABNgIYCyAFKAIUIgJFDQAgASACNgIUIAIgATYCGAsgAyAAQQFyNgIEIAAgA2ogADYCACADQdQRKAIARw0BQcgRIAA2AgAPCyAFIAFBfnE2AgQgAyAAQQFyNgIEIAAgA2ogADYCAAsgAEH/AU0EQCAAQQN2IgFBA3RB6BFqIQACf0HAESgCACICQQEgAXQiAXFFBEBBwBEgASACcjYCACAADAELIAAoAggLIQIgACADNgIIIAIgAzYCDCADIAA2AgwgAyACNgIIDwtBHyECIANCADcCECAAQf///wdNBEAgAEEIdiIBIAFBgP4/akEQdkEIcSIBdCICIAJBgOAfakEQdkEEcSICdCIEIARBgIAPakEQdkECcSIEdEEPdiABIAJyIARyayIBQQF0IAAgAUEVanZBAXFyQRxqIQILIAMgAjYCHCACQQJ0QfATaiEBAkACQAJAQcQRKAIAIgRBASACdCIHcUUEQEHEESAEIAdyNgIAIAEgAzYCACADIAE2AhgMAQsgAEEAQRkgAkEBdmsgAkEfRht0IQIgASgCACEBA0AgASIEKAIEQXhxIABGDQIgAkEddiEBIAJBAXQhAiAEIAFBBHFqIgdBEGooAgAiAQ0ACyAHIAM2AhAgAyAENgIYCyADIAM2AgwgAyADNgIIDAELIAQoAggiACADNgIMIAQgAzYCCCADQQA2AhggAyAENgIMIAMgADYCCAtB4BFB4BEoAgBBAWsiAEF/IAAbNgIACwsSACAAEA4EQCAAECcPCyAAEAcLLwEBfyMAQRBrIgEkACABIAA2AgwgASgCDCIAIAFBCGogARAfIAAQHiABQRBqJAALCwAgABAHIAE2AgQL+AgBAX8jAEGAAWsiAyQAIAMgADYCfCADIAE2AnggAyACNwNwIANBAEGAgIAIIAMoAnwtAFAbNgJsIAMgAygCfCgCADYCaCADIAMoAnwoAgQ2AmQgAyADKAJ8KAIINgJgIAMgAygCfCgCDDYCXCADIAMoAnwoAhA2AlggAyADKAJkQQVsNgJUIAMgAygCYEEFbDYCUCADIAMoAlxBBWw2AkwgAyADKAJYQQVsNgJIIAMgAygCfCgCFDYCRCADIAMoAnwoAhg2AkAgAyADKAJ8KAIcNgI8IAMgAygCfCgCIDYCOCADIAMoAnwoAiQ2AjQDQCADKQNwQhBURQRAIAMgAygCeBAEQf///x9xIAMoAkRqNgJEIAMgAygCeEEDahAEQQJ2Qf///x9xIAMoAkBqNgJAIAMgAygCeEEGahAEQQR2Qf///x9xIAMoAjxqNgI8IAMgAygCeEEJahAEQQZ2IAMoAjhqNgI4IAMgAygCeEEMahAEQQh2IAMoAmxyIAMoAjRqNgI0IAMgAygCRK0gAygCaK1+IAMoAkCtIAMoAkitfnwgAygCPK0gAygCTK1+fCADKAI4rSADKAJQrX58IAMoAjStIAMoAlStfnw3AyggAyADKAJErSADKAJkrX4gAygCQK0gAygCaK1+fCADKAI8rSADKAJIrX58IAMoAjitIAMoAkytfnwgAygCNK0gAygCUK1+fDcDICADIAMoAkStIAMoAmCtfiADKAJArSADKAJkrX58IAMoAjytIAMoAmitfnwgAygCOK0gAygCSK1+fCADKAI0rSADKAJMrX58NwMYIAMgAygCRK0gAygCXK1+IAMoAkCtIAMoAmCtfnwgAygCPK0gAygCZK1+fCADKAI4rSADKAJorX58IAMoAjStIAMoAkitfnw3AxAgAyADKAJErSADKAJYrX4gAygCQK0gAygCXK1+fCADKAI8rSADKAJgrX58IAMoAjitIAMoAmStfnwgAygCNK0gAygCaK1+fDcDCCADIAMpAyhCGog+AgQgAyADKQMop0H///8fcTYCRCADIAMpAyAgAygCBK18NwMgIAMgAykDIEIaiD4CBCADIAMpAyCnQf///x9xNgJAIAMgAykDGCADKAIErXw3AxggAyADKQMYQhqIPgIEIAMgAykDGKdB////H3E2AjwgAyADKQMQIAMoAgStfDcDECADIAMpAxBCGog+AgQgAyADKQMQp0H///8fcTYCOCADIAMpAwggAygCBK18NwMIIAMgAykDCEIaiD4CBCADIAMpAwinQf///x9xNgI0IAMgAygCRCADKAIEQQVsajYCRCADIAMoAkRBGnY2AgQgAyADKAJEQf///x9xNgJEIAMgAygCBCADKAJAajYCQCADIAMoAnhBEGo2AnggAyADKQNwQhB9NwNwDAELCyADKAJ8IAMoAkQ2AhQgAygCfCADKAJANgIYIAMoAnwgAygCPDYCHCADKAJ8IAMoAjg2AiAgAygCfCADKAI0NgIkIANBgAFqJAALXAECfyMAQRBrIgIkACACIAA2AgwCfyACKAIMIgEQDkEBcQRAIAEQMQwBCyMAQRBrIgAkACAAIAE2AgwgACgCDBAHLQALIQEgAEEQaiQAIAELIQAgAkEQaiQAIAALAwABC18BAX8jAEEQayIBJAAgASAANgIMIAEgASgCDBAHNgIIIAFBADYCBANAIAEoAgRBA09FBEAgASgCCCABKAIEQQJ0akEANgIAIAEgASgCBEEBajYCBAwBCwsgAUEQaiQAC5gBAQF/IwBBIGsiAyQAIAMgADYCHCADIAE2AhggAyACNgIUIAMoAhwhASMAQRBrIgAgAygCGDYCDCAAKAIMGiMAQRBrIgAgATYCBCAAKAIEGiMAQRBrIgAgAygCFDYCDCAAKAIMGiMAQRBrIgAkACAAIAE2AgQjAEEQayIBIAAoAgQ2AgwgASgCDBogAEEQaiQAIANBIGokAAt/AQN/IAAhAQJAIABBA3EEQANAIAEtAABFDQIgAUEBaiIBQQNxDQALCwNAIAEiAkEEaiEBIAIoAgAiA0F/cyADQYGChAhrcUGAgYKEeHFFDQALIANB/wFxRQRAIAIgAGsPCwNAIAItAAEhAyACQQFqIgEhAiADDQALCyABIABrC5YtAQx/IwBBEGsiDCQAAkACQAJAAkACQAJAAkACQAJAAkACQAJAIABB9AFNBEBBwBEoAgAiBUEQIABBC2pBeHEgAEELSRsiCEEDdiICdiIBQQNxBEAgAUF/c0EBcSACaiIDQQN0IgFB8BFqKAIAIgRBCGohAAJAIAQoAggiAiABQegRaiIBRgRAQcARIAVBfiADd3E2AgAMAQsgAiABNgIMIAEgAjYCCAsgBCADQQN0IgFBA3I2AgQgASAEaiIBIAEoAgRBAXI2AgQMDQsgCEHIESgCACIKTQ0BIAEEQAJAQQIgAnQiAEEAIABrciABIAJ0cSIAQQAgAGtxQQFrIgAgAEEMdkEQcSICdiIBQQV2QQhxIgAgAnIgASAAdiIBQQJ2QQRxIgByIAEgAHYiAUEBdkECcSIAciABIAB2IgFBAXZBAXEiAHIgASAAdmoiA0EDdCIAQfARaigCACIEKAIIIgEgAEHoEWoiAEYEQEHAESAFQX4gA3dxIgU2AgAMAQsgASAANgIMIAAgATYCCAsgBEEIaiEAIAQgCEEDcjYCBCAEIAhqIgIgA0EDdCIBIAhrIgNBAXI2AgQgASAEaiADNgIAIAoEQCAKQQN2IgFBA3RB6BFqIQdB1BEoAgAhBAJ/IAVBASABdCIBcUUEQEHAESABIAVyNgIAIAcMAQsgBygCCAshASAHIAQ2AgggASAENgIMIAQgBzYCDCAEIAE2AggLQdQRIAI2AgBByBEgAzYCAAwNC0HEESgCACIGRQ0BIAZBACAGa3FBAWsiACAAQQx2QRBxIgJ2IgFBBXZBCHEiACACciABIAB2IgFBAnZBBHEiAHIgASAAdiIBQQF2QQJxIgByIAEgAHYiAUEBdkEBcSIAciABIAB2akECdEHwE2ooAgAiASgCBEF4cSAIayEDIAEhAgNAAkAgAigCECIARQRAIAIoAhQiAEUNAQsgACgCBEF4cSAIayICIAMgAiADSSICGyEDIAAgASACGyEBIAAhAgwBCwsgASAIaiIJIAFNDQIgASgCGCELIAEgASgCDCIERwRAIAEoAggiAEHQESgCAEkaIAAgBDYCDCAEIAA2AggMDAsgAUEUaiICKAIAIgBFBEAgASgCECIARQ0EIAFBEGohAgsDQCACIQcgACIEQRRqIgIoAgAiAA0AIARBEGohAiAEKAIQIgANAAsgB0EANgIADAsLQX8hCCAAQb9/Sw0AIABBC2oiAEF4cSEIQcQRKAIAIglFDQBBHyEFQQAgCGshAwJAAkACQAJ/IAhB////B00EQCAAQQh2IgAgAEGA/j9qQRB2QQhxIgJ0IgAgAEGA4B9qQRB2QQRxIgF0IgAgAEGAgA9qQRB2QQJxIgB0QQ92IAEgAnIgAHJrIgBBAXQgCCAAQRVqdkEBcXJBHGohBQsgBUECdEHwE2ooAgAiAkULBEBBACEADAELQQAhACAIQQBBGSAFQQF2ayAFQR9GG3QhAQNAAkAgAigCBEF4cSAIayIHIANPDQAgAiEEIAciAw0AQQAhAyACIQAMAwsgACACKAIUIgcgByACIAFBHXZBBHFqKAIQIgJGGyAAIAcbIQAgAUEBdCEBIAINAAsLIAAgBHJFBEBBAiAFdCIAQQAgAGtyIAlxIgBFDQMgAEEAIABrcUEBayIAIABBDHZBEHEiAnYiAUEFdkEIcSIAIAJyIAEgAHYiAUECdkEEcSIAciABIAB2IgFBAXZBAnEiAHIgASAAdiIBQQF2QQFxIgByIAEgAHZqQQJ0QfATaigCACEACyAARQ0BCwNAIAAoAgRBeHEgCGsiASADSSECIAEgAyACGyEDIAAgBCACGyEEIAAoAhAiAQR/IAEFIAAoAhQLIgANAAsLIARFDQAgA0HIESgCACAIa08NACAEIAhqIgYgBE0NASAEKAIYIQUgBCAEKAIMIgFHBEAgBCgCCCIAQdARKAIASRogACABNgIMIAEgADYCCAwKCyAEQRRqIgIoAgAiAEUEQCAEKAIQIgBFDQQgBEEQaiECCwNAIAIhByAAIgFBFGoiAigCACIADQAgAUEQaiECIAEoAhAiAA0ACyAHQQA2AgAMCQsgCEHIESgCACICTQRAQdQRKAIAIQMCQCACIAhrIgFBEE8EQEHIESABNgIAQdQRIAMgCGoiADYCACAAIAFBAXI2AgQgAiADaiABNgIAIAMgCEEDcjYCBAwBC0HUEUEANgIAQcgRQQA2AgAgAyACQQNyNgIEIAIgA2oiACAAKAIEQQFyNgIECyADQQhqIQAMCwsgCEHMESgCACIGSQRAQcwRIAYgCGsiATYCAEHYEUHYESgCACICIAhqIgA2AgAgACABQQFyNgIEIAIgCEEDcjYCBCACQQhqIQAMCwtBACEAIAhBL2oiCQJ/QZgVKAIABEBBoBUoAgAMAQtBpBVCfzcCAEGcFUKAoICAgIAENwIAQZgVIAxBDGpBcHFB2KrVqgVzNgIAQawVQQA2AgBB/BRBADYCAEGAIAsiAWoiBUEAIAFrIgdxIgIgCE0NCkH4FCgCACIEBEBB8BQoAgAiAyACaiIBIANNDQsgASAESw0LC0H8FC0AAEEEcQ0FAkACQEHYESgCACIDBEBBgBUhAANAIAMgACgCACIBTwRAIAEgACgCBGogA0sNAwsgACgCCCIADQALC0EAEAwiAUF/Rg0GIAIhBUGcFSgCACIDQQFrIgAgAXEEQCACIAFrIAAgAWpBACADa3FqIQULIAUgCE0NBiAFQf7///8HSw0GQfgUKAIAIgQEQEHwFCgCACIDIAVqIgAgA00NByAAIARLDQcLIAUQDCIAIAFHDQEMCAsgBSAGayAHcSIFQf7///8HSw0FIAUQDCIBIAAoAgAgACgCBGpGDQQgASEACwJAIABBf0YNACAIQTBqIAVNDQBBoBUoAgAiASAJIAVrakEAIAFrcSIBQf7///8HSwRAIAAhAQwICyABEAxBf0cEQCABIAVqIQUgACEBDAgLQQAgBWsQDBoMBQsgACIBQX9HDQYMBAsAC0EAIQQMBwtBACEBDAULIAFBf0cNAgtB/BRB/BQoAgBBBHI2AgALIAJB/v///wdLDQEgAhAMIQFBABAMIQAgAUF/Rg0BIABBf0YNASAAIAFNDQEgACABayIFIAhBKGpNDQELQfAUQfAUKAIAIAVqIgA2AgBB9BQoAgAgAEkEQEH0FCAANgIACwJAAkACQEHYESgCACIHBEBBgBUhAANAIAEgACgCACIDIAAoAgQiAmpGDQIgACgCCCIADQALDAILQdARKAIAIgBBACAAIAFNG0UEQEHQESABNgIAC0EAIQBBhBUgBTYCAEGAFSABNgIAQeARQX82AgBB5BFBmBUoAgA2AgBBjBVBADYCAANAIABBA3QiA0HwEWogA0HoEWoiAjYCACADQfQRaiACNgIAIABBAWoiAEEgRw0AC0HMESAFQShrIgNBeCABa0EHcUEAIAFBCGpBB3EbIgBrIgI2AgBB2BEgACABaiIANgIAIAAgAkEBcjYCBCABIANqQSg2AgRB3BFBqBUoAgA2AgAMAgsgAC0ADEEIcQ0AIAMgB0sNACABIAdNDQAgACACIAVqNgIEQdgRIAdBeCAHa0EHcUEAIAdBCGpBB3EbIgBqIgI2AgBBzBFBzBEoAgAgBWoiASAAayIANgIAIAIgAEEBcjYCBCABIAdqQSg2AgRB3BFBqBUoAgA2AgAMAQtB0BEoAgAgAUsEQEHQESABNgIACyABIAVqIQJBgBUhAAJAAkACQAJAAkACQANAIAIgACgCAEcEQCAAKAIIIgANAQwCCwsgAC0ADEEIcUUNAQtBgBUhAANAIAcgACgCACICTwRAIAIgACgCBGoiBCAHSw0DCyAAKAIIIQAMAAsACyAAIAE2AgAgACAAKAIEIAVqNgIEIAFBeCABa0EHcUEAIAFBCGpBB3EbaiIJIAhBA3I2AgQgAkF4IAJrQQdxQQAgAkEIakEHcRtqIgUgCCAJaiIGayECIAUgB0YEQEHYESAGNgIAQcwRQcwRKAIAIAJqIgA2AgAgBiAAQQFyNgIEDAMLIAVB1BEoAgBGBEBB1BEgBjYCAEHIEUHIESgCACACaiIANgIAIAYgAEEBcjYCBCAAIAZqIAA2AgAMAwsgBSgCBCIAQQNxQQFGBEAgAEF4cSEHAkAgAEH/AU0EQCAFKAIIIgMgAEEDdiIAQQN0QegRakYaIAMgBSgCDCIBRgRAQcARQcARKAIAQX4gAHdxNgIADAILIAMgATYCDCABIAM2AggMAQsgBSgCGCEIAkAgBSAFKAIMIgFHBEAgBSgCCCIAIAE2AgwgASAANgIIDAELAkAgBUEUaiIAKAIAIgMNACAFQRBqIgAoAgAiAw0AQQAhAQwBCwNAIAAhBCADIgFBFGoiACgCACIDDQAgAUEQaiEAIAEoAhAiAw0ACyAEQQA2AgALIAhFDQACQCAFIAUoAhwiA0ECdEHwE2oiACgCAEYEQCAAIAE2AgAgAQ0BQcQRQcQRKAIAQX4gA3dxNgIADAILIAhBEEEUIAgoAhAgBUYbaiABNgIAIAFFDQELIAEgCDYCGCAFKAIQIgAEQCABIAA2AhAgACABNgIYCyAFKAIUIgBFDQAgASAANgIUIAAgATYCGAsgBSAHaiEFIAIgB2ohAgsgBSAFKAIEQX5xNgIEIAYgAkEBcjYCBCACIAZqIAI2AgAgAkH/AU0EQCACQQN2IgBBA3RB6BFqIQICf0HAESgCACIBQQEgAHQiAHFFBEBBwBEgACABcjYCACACDAELIAIoAggLIQAgAiAGNgIIIAAgBjYCDCAGIAI2AgwgBiAANgIIDAMLQR8hACACQf///wdNBEAgAkEIdiIAIABBgP4/akEQdkEIcSIDdCIAIABBgOAfakEQdkEEcSIBdCIAIABBgIAPakEQdkECcSIAdEEPdiABIANyIAByayIAQQF0IAIgAEEVanZBAXFyQRxqIQALIAYgADYCHCAGQgA3AhAgAEECdEHwE2ohBAJAQcQRKAIAIgNBASAAdCIBcUUEQEHEESABIANyNgIAIAQgBjYCACAGIAQ2AhgMAQsgAkEAQRkgAEEBdmsgAEEfRht0IQAgBCgCACEBA0AgASIDKAIEQXhxIAJGDQMgAEEddiEBIABBAXQhACADIAFBBHFqIgQoAhAiAQ0ACyAEIAY2AhAgBiADNgIYCyAGIAY2AgwgBiAGNgIIDAILQcwRIAVBKGsiA0F4IAFrQQdxQQAgAUEIakEHcRsiAGsiAjYCAEHYESAAIAFqIgA2AgAgACACQQFyNgIEIAEgA2pBKDYCBEHcEUGoFSgCADYCACAHIARBJyAEa0EHcUEAIARBJ2tBB3EbakEvayIAIAAgB0EQakkbIgJBGzYCBCACQYgVKQIANwIQIAJBgBUpAgA3AghBiBUgAkEIajYCAEGEFSAFNgIAQYAVIAE2AgBBjBVBADYCACACQRhqIQADQCAAQQc2AgQgAEEIaiEBIABBBGohACABIARJDQALIAIgB0YNAyACIAIoAgRBfnE2AgQgByACIAdrIgRBAXI2AgQgAiAENgIAIARB/wFNBEAgBEEDdiIAQQN0QegRaiECAn9BwBEoAgAiAUEBIAB0IgBxRQRAQcARIAAgAXI2AgAgAgwBCyACKAIICyEAIAIgBzYCCCAAIAc2AgwgByACNgIMIAcgADYCCAwEC0EfIQAgB0IANwIQIARB////B00EQCAEQQh2IgAgAEGA/j9qQRB2QQhxIgJ0IgAgAEGA4B9qQRB2QQRxIgF0IgAgAEGAgA9qQRB2QQJxIgB0QQ92IAEgAnIgAHJrIgBBAXQgBCAAQRVqdkEBcXJBHGohAAsgByAANgIcIABBAnRB8BNqIQMCQEHEESgCACICQQEgAHQiAXFFBEBBxBEgASACcjYCACADIAc2AgAgByADNgIYDAELIARBAEEZIABBAXZrIABBH0YbdCEAIAMoAgAhAQNAIAEiAigCBEF4cSAERg0EIABBHXYhASAAQQF0IQAgAiABQQRxaiIDKAIQIgENAAsgAyAHNgIQIAcgAjYCGAsgByAHNgIMIAcgBzYCCAwDCyADKAIIIgAgBjYCDCADIAY2AgggBkEANgIYIAYgAzYCDCAGIAA2AggLIAlBCGohAAwFCyACKAIIIgAgBzYCDCACIAc2AgggB0EANgIYIAcgAjYCDCAHIAA2AggLQcwRKAIAIgAgCE0NAEHMESAAIAhrIgE2AgBB2BFB2BEoAgAiAiAIaiIANgIAIAAgAUEBcjYCBCACIAhBA3I2AgQgAkEIaiEADAMLQbgRQTA2AgBBACEADAILAkAgBUUNAAJAIAQoAhwiAkECdEHwE2oiACgCACAERgRAIAAgATYCACABDQFBxBEgCUF+IAJ3cSIJNgIADAILIAVBEEEUIAUoAhAgBEYbaiABNgIAIAFFDQELIAEgBTYCGCAEKAIQIgAEQCABIAA2AhAgACABNgIYCyAEKAIUIgBFDQAgASAANgIUIAAgATYCGAsCQCADQQ9NBEAgBCADIAhqIgBBA3I2AgQgACAEaiIAIAAoAgRBAXI2AgQMAQsgBCAIQQNyNgIEIAYgA0EBcjYCBCADIAZqIAM2AgAgA0H/AU0EQCADQQN2IgBBA3RB6BFqIQICf0HAESgCACIBQQEgAHQiAHFFBEBBwBEgACABcjYCACACDAELIAIoAggLIQAgAiAGNgIIIAAgBjYCDCAGIAI2AgwgBiAANgIIDAELQR8hACADQf///wdNBEAgA0EIdiIAIABBgP4/akEQdkEIcSICdCIAIABBgOAfakEQdkEEcSIBdCIAIABBgIAPakEQdkECcSIAdEEPdiABIAJyIAByayIAQQF0IAMgAEEVanZBAXFyQRxqIQALIAYgADYCHCAGQgA3AhAgAEECdEHwE2ohAgJAAkAgCUEBIAB0IgFxRQRAQcQRIAEgCXI2AgAgAiAGNgIAIAYgAjYCGAwBCyADQQBBGSAAQQF2ayAAQR9GG3QhACACKAIAIQgDQCAIIgEoAgRBeHEgA0YNAiAAQR12IQIgAEEBdCEAIAEgAkEEcWoiAigCECIIDQALIAIgBjYCECAGIAE2AhgLIAYgBjYCDCAGIAY2AggMAQsgASgCCCIAIAY2AgwgASAGNgIIIAZBADYCGCAGIAE2AgwgBiAANgIICyAEQQhqIQAMAQsCQCALRQ0AAkAgASgCHCICQQJ0QfATaiIAKAIAIAFGBEAgACAENgIAIAQNAUHEESAGQX4gAndxNgIADAILIAtBEEEUIAsoAhAgAUYbaiAENgIAIARFDQELIAQgCzYCGCABKAIQIgAEQCAEIAA2AhAgACAENgIYCyABKAIUIgBFDQAgBCAANgIUIAAgBDYCGAsCQCADQQ9NBEAgASADIAhqIgBBA3I2AgQgACABaiIAIAAoAgRBAXI2AgQMAQsgASAIQQNyNgIEIAkgA0EBcjYCBCADIAlqIAM2AgAgCgRAIApBA3YiAEEDdEHoEWohBEHUESgCACECAn9BASAAdCIAIAVxRQRAQcARIAAgBXI2AgAgBAwBCyAEKAIICyEAIAQgAjYCCCAAIAI2AgwgAiAENgIMIAIgADYCCAtB1BEgCTYCAEHIESADNgIACyABQQhqIQALIAxBEGokACAACzIBAX8gAEEBIAAbIQACQANAIAAQISIBDQFBvBEoAgAiAQRAIAERBQAMAQsLEAAACyABC6oCAQV/IwBBEGsiCCQAIAIgAUF/c0ERa00EQCAAEBghCQJ/IAFB5////wdJBEAgCCABQQF0NgIIIAggASACajYCDAJ/IwBBEGsiAiQAIAhBDGoiCigCACAIQQhqIgsoAgBJIQwgAkEQaiQAIAsgCiAMGygCACICQQtPCwR/IAJBEGpBcHEiAiACQQFrIgIgAkELRhsFQQoLDAELQW4LQQFqIgoQIiECIAQEQCACIAkgBBAQCyAGBEAgAiAEaiAHIAYQEAsgAyAEIAVqayIDBEAgAiAEaiAGaiAEIAlqIAVqIAMQEAsgAUEKRwRAIAkQFwsgACACECkgACAKECggACAEIAZqIANqIgAQGiAIQQA6AAcgACACaiAILQAHOgAAIAhBEGokAA8LECwACxYAIAAQDgRAIAAgARAaDwsgACABECoLGQEBf0EKIQEgABAOBH8gABAmQQFrBUEKCwsQACAAEAcoAghB/////wdxCwkAIAAQBygCAAsSACAAEAcgAUGAgICAeHI2AggLCwAgABAHIAE2AgALCwAgABAHIAE6AAsLkAEBA38jAEEQayIEJAAgAkFvTQRAAkAgAkEKTQRAIAAgAhAqIAAQByEDDAELIAAgAkELTwR/IAJBEGpBcHEiAyADQQFrIgMgA0ELRhsFQQoLQQFqIgUQIiIDECkgACAFECggACACEBoLIAMgASACEBAgBEEAOgAPIAIgA2ogBC0ADzoAACAEQRBqJAAPCxAsAAsFABAAAAuOHQEBfyMAQfABayIEJAAgBCAANgLsASAEIAE2AugBIAQgAjYC5AEgBCADNwPYASAEQQA2AlQgBCkD2AFQRQRAIAQpA9gBQsD/////B1YEQBAAAAsgBCAEKALsASgCADYClAEgBCAEKALsASgCBDYCkAEgBCAEKALsASgCCDYCjAEgBCAEKALsASgCDDYCiAEgBCAEKALsASgCEDYChAEgBCAEKALsASgCFDYCgAEgBCAEKALsASgCGDYCfCAEIAQoAuwBKAIcNgJ4IAQgBCgC7AEoAiA2AnQgBCAEKALsASgCJDYCcCAEIAQoAuwBKAIoNgJsIAQgBCgC7AEoAiw2AmggBCAEKALsASgCMDYCZCAEIAQoAuwBKAI0NgJgIAQgBCgC7AEoAjg2AlwgBCAEKALsASgCPDYCWANAIAQpA9gBQsAAVARAIARBEGoiAEIANwMAIABCADcDOCAAQgA3AzAgAEIANwMoIABCADcDICAAQgA3AxggAEIANwMQIABCADcDCCAEQQA2AgwDQCAEKQPYASAEKAIMrVhFBEAgBCgCDCAEQRBqaiAEKALoASAEKAIMai0AADoAACAEIAQoAgxBAWo2AgwMAQsLIAQgBEEQajYC6AEgBCAEKALkATYCVCAEIARBEGo2AuQBCyAEIAQoApQBNgLUASAEIAQoApABNgLQASAEIAQoAowBNgLMASAEIAQoAogBNgLIASAEIAQoAoQBNgLEASAEIAQoAoABNgLAASAEIAQoAnw2ArwBIAQgBCgCeDYCuAEgBCAEKAJ0NgK0ASAEIAQoAnA2ArABIAQgBCgCbDYCrAEgBCAEKAJoNgKoASAEIAQoAmQ2AqQBIAQgBCgCYDYCoAEgBCAEKAJcNgKcASAEIAQoAlg2ApgBIARBFDYCDANAIAQoAgwEQCAEIAQoAtQBIAQoAsQBajYC1AEgBCAEKAKkASAEKALUAXNBEHQgBCgCpAEgBCgC1AFzQRB2cjYCpAEgBCAEKAK0ASAEKAKkAWo2ArQBIAQgBCgCxAEgBCgCtAFzQQx0IAQoAsQBIAQoArQBc0EUdnI2AsQBIAQgBCgC1AEgBCgCxAFqNgLUASAEIAQoAqQBIAQoAtQBc0EIdCAEKAKkASAEKALUAXNBGHZyNgKkASAEIAQoArQBIAQoAqQBajYCtAEgBCAEKALEASAEKAK0AXNBB3QgBCgCxAEgBCgCtAFzQRl2cjYCxAEgBCAEKALQASAEKALAAWo2AtABIAQgBCgCoAEgBCgC0AFzQRB0IAQoAqABIAQoAtABc0EQdnI2AqABIAQgBCgCsAEgBCgCoAFqNgKwASAEIAQoAsABIAQoArABc0EMdCAEKALAASAEKAKwAXNBFHZyNgLAASAEIAQoAtABIAQoAsABajYC0AEgBCAEKAKgASAEKALQAXNBCHQgBCgCoAEgBCgC0AFzQRh2cjYCoAEgBCAEKAKwASAEKAKgAWo2ArABIAQgBCgCwAEgBCgCsAFzQQd0IAQoAsABIAQoArABc0EZdnI2AsABIAQgBCgCzAEgBCgCvAFqNgLMASAEIAQoApwBIAQoAswBc0EQdCAEKAKcASAEKALMAXNBEHZyNgKcASAEIAQoAqwBIAQoApwBajYCrAEgBCAEKAK8ASAEKAKsAXNBDHQgBCgCvAEgBCgCrAFzQRR2cjYCvAEgBCAEKALMASAEKAK8AWo2AswBIAQgBCgCnAEgBCgCzAFzQQh0IAQoApwBIAQoAswBc0EYdnI2ApwBIAQgBCgCrAEgBCgCnAFqNgKsASAEIAQoArwBIAQoAqwBc0EHdCAEKAK8ASAEKAKsAXNBGXZyNgK8ASAEIAQoAsgBIAQoArgBajYCyAEgBCAEKAKYASAEKALIAXNBEHQgBCgCmAEgBCgCyAFzQRB2cjYCmAEgBCAEKAKoASAEKAKYAWo2AqgBIAQgBCgCuAEgBCgCqAFzQQx0IAQoArgBIAQoAqgBc0EUdnI2ArgBIAQgBCgCyAEgBCgCuAFqNgLIASAEIAQoApgBIAQoAsgBc0EIdCAEKAKYASAEKALIAXNBGHZyNgKYASAEIAQoAqgBIAQoApgBajYCqAEgBCAEKAK4ASAEKAKoAXNBB3QgBCgCuAEgBCgCqAFzQRl2cjYCuAEgBCAEKALUASAEKALAAWo2AtQBIAQgBCgCmAEgBCgC1AFzQRB0IAQoApgBIAQoAtQBc0EQdnI2ApgBIAQgBCgCrAEgBCgCmAFqNgKsASAEIAQoAsABIAQoAqwBc0EMdCAEKALAASAEKAKsAXNBFHZyNgLAASAEIAQoAtQBIAQoAsABajYC1AEgBCAEKAKYASAEKALUAXNBCHQgBCgCmAEgBCgC1AFzQRh2cjYCmAEgBCAEKAKsASAEKAKYAWo2AqwBIAQgBCgCwAEgBCgCrAFzQQd0IAQoAsABIAQoAqwBc0EZdnI2AsABIAQgBCgC0AEgBCgCvAFqNgLQASAEIAQoAqQBIAQoAtABc0EQdCAEKAKkASAEKALQAXNBEHZyNgKkASAEIAQoAqgBIAQoAqQBajYCqAEgBCAEKAK8ASAEKAKoAXNBDHQgBCgCvAEgBCgCqAFzQRR2cjYCvAEgBCAEKALQASAEKAK8AWo2AtABIAQgBCgCpAEgBCgC0AFzQQh0IAQoAqQBIAQoAtABc0EYdnI2AqQBIAQgBCgCqAEgBCgCpAFqNgKoASAEIAQoArwBIAQoAqgBc0EHdCAEKAK8ASAEKAKoAXNBGXZyNgK8ASAEIAQoAswBIAQoArgBajYCzAEgBCAEKAKgASAEKALMAXNBEHQgBCgCoAEgBCgCzAFzQRB2cjYCoAEgBCAEKAK0ASAEKAKgAWo2ArQBIAQgBCgCuAEgBCgCtAFzQQx0IAQoArgBIAQoArQBc0EUdnI2ArgBIAQgBCgCzAEgBCgCuAFqNgLMASAEIAQoAqABIAQoAswBc0EIdCAEKAKgASAEKALMAXNBGHZyNgKgASAEIAQoArQBIAQoAqABajYCtAEgBCAEKAK4ASAEKAK0AXNBB3QgBCgCuAEgBCgCtAFzQRl2cjYCuAEgBCAEKALIASAEKALEAWo2AsgBIAQgBCgCnAEgBCgCyAFzQRB0IAQoApwBIAQoAsgBc0EQdnI2ApwBIAQgBCgCsAEgBCgCnAFqNgKwASAEIAQoAsQBIAQoArABc0EMdCAEKALEASAEKAKwAXNBFHZyNgLEASAEIAQoAsgBIAQoAsQBajYCyAEgBCAEKAKcASAEKALIAXNBCHQgBCgCnAEgBCgCyAFzQRh2cjYCnAEgBCAEKAKwASAEKAKcAWo2ArABIAQgBCgCxAEgBCgCsAFzQQd0IAQoAsQBIAQoArABc0EZdnI2AsQBIAQgBCgCDEECazYCDAwBCwsgBCAEKALUASAEKAKUAWo2AtQBIAQgBCgC0AEgBCgCkAFqNgLQASAEIAQoAswBIAQoAowBajYCzAEgBCAEKALIASAEKAKIAWo2AsgBIAQgBCgCxAEgBCgChAFqNgLEASAEIAQoAsABIAQoAoABajYCwAEgBCAEKAK8ASAEKAJ8ajYCvAEgBCAEKAK4ASAEKAJ4ajYCuAEgBCAEKAK0ASAEKAJ0ajYCtAEgBCAEKAKwASAEKAJwajYCsAEgBCAEKAKsASAEKAJsajYCrAEgBCAEKAKoASAEKAJoajYCqAEgBCAEKAKkASAEKAJkajYCpAEgBCAEKAKgASAEKAJgajYCoAEgBCAEKAKcASAEKAJcajYCnAEgBCAEKAKYASAEKAJYajYCmAEgBCAEKALUASAEKALoARAEczYC1AEgBCAEKALQASAEKALoAUEEahAEczYC0AEgBCAEKALMASAEKALoAUEIahAEczYCzAEgBCAEKALIASAEKALoAUEMahAEczYCyAEgBCAEKALEASAEKALoAUEQahAEczYCxAEgBCAEKALAASAEKALoAUEUahAEczYCwAEgBCAEKAK8ASAEKALoAUEYahAEczYCvAEgBCAEKAK4ASAEKALoAUEcahAEczYCuAEgBCAEKAK0ASAEKALoAUEgahAEczYCtAEgBCAEKAKwASAEKALoAUEkahAEczYCsAEgBCAEKAKsASAEKALoAUEoahAEczYCrAEgBCAEKAKoASAEKALoAUEsahAEczYCqAEgBCAEKAKkASAEKALoAUEwahAEczYCpAEgBCAEKAKgASAEKALoAUE0ahAEczYCoAEgBCAEKAKcASAEKALoAUE4ahAEczYCnAEgBCAEKAKYASAEKALoAUE8ahAEczYCmAEgBCAEKAJkQQFqNgJkIAQoAmRFBEAgBCAEKAJgQQFqNgJgCyAEKALkASAEKALUARAFIAQoAuQBQQRqIAQoAtABEAUgBCgC5AFBCGogBCgCzAEQBSAEKALkAUEMaiAEKALIARAFIAQoAuQBQRBqIAQoAsQBEAUgBCgC5AFBFGogBCgCwAEQBSAEKALkAUEYaiAEKAK8ARAFIAQoAuQBQRxqIAQoArgBEAUgBCgC5AFBIGogBCgCtAEQBSAEKALkAUEkaiAEKAKwARAFIAQoAuQBQShqIAQoAqwBEAUgBCgC5AFBLGogBCgCqAEQBSAEKALkAUEwaiAEKAKkARAFIAQoAuQBQTRqIAQoAqABEAUgBCgC5AFBOGogBCgCnAEQBSAEKALkAUE8aiAEKAKYARAFIAQpA9gBQsAAWARAIAQpA9gBQsAAVARAIARBADYCDANAIAQoAgwgBCkD2AGnT0UEQCAEKAJUIAQoAgxqIAQoAuQBIAQoAgxqLQAAOgAAIAQgBCgCDEEBajYCDAwBCwsLIAQoAuwBIAQoAmQ2AjAgBCgC7AEgBCgCYDYCNAUgBCAEKQPYAUJAfDcD2AEgBCAEKALkAUFAazYC5AEgBCAEKALoAUFAazYC6AEMAQsLCyAEQfABaiQAC5EBAQF/IwBBEGsiAyQAIAMgADYCDCADIAE2AgggAyACNgIEIAMoAgQEfyADKAIEEAQFQQALIQAgAygCDCAANgIwIAMoAgQEfyADKAIEQQRqEAQFQQALIQAgAygCDCAANgI0IAMoAggQBCEAIAMoAgwgADYCOCADKAIIQQRqEAQhACADKAIMIAA2AjwgA0EQaiQAC4cCAQF/IwBBEGsiAiQAIAIgADYCDCACIAE2AgggAigCDEHl8MGLBjYCACACKAIMQe7IgZkDNgIEIAIoAgxBstqIywc2AgggAigCDEH0yoHZBjYCDCACKAIIEAQhACACKAIMIAA2AhAgAigCCEEEahAEIQAgAigCDCAANgIUIAIoAghBCGoQBCEAIAIoAgwgADYCGCACKAIIQQxqEAQhACACKAIMIAA2AhwgAigCCEEQahAEIQAgAigCDCAANgIgIAIoAghBFGoQBCEAIAIoAgwgADYCJCACKAIIQRhqEAQhACACKAIMIAA2AiggAigCCEEcahAEIQAgAigCDCAANgIsIAJBEGokAAvaAQEBfyMAQRBrIgIgADYCDCACIAE3AwAgAigCDCACKQMAPAAAIAIgAikDAEIIiDcDACACKAIMIAIpAwA8AAEgAiACKQMAQgiINwMAIAIoAgwgAikDADwAAiACIAIpAwBCCIg3AwAgAigCDCACKQMAPAADIAIgAikDAEIIiDcDACACKAIMIAIpAwA8AAQgAiACKQMAQgiINwMAIAIoAgwgAikDADwABSACIAIpAwBCCIg3AwAgAigCDCACKQMAPAAGIAIgAikDAEIIiDcDACACKAIMIAIpAwA8AAcLKQEBfyMAQRBrIgEkACABIAA2AgwgASgCDBAHKAIEIQAgAUEQaiQAIAALKQEBfyMAQRBrIgEkACABIAA2AgwgASgCDBAHKAIAIQAgAUEQaiQAIAALEAAjACAAa0FwcSIAJAAgAAsGACAAJAALBAAjAAvKHwIGfwJ+IwBBkAJrIgYkACAGIAA2AogCIAYgATYChAIgBiACNgKAAiAGIAM2AvwBIAYgBDYC+AEgBiAFNgL0ASAGEAM2AvABAkAgBigC8AFFBEAgBkGhCTYCjAIMAQsgBkHgAWogBigC8AEQCCAGKALwARAXIAZB0AFqIAZB4AFqEA8gBkHAAWogBigChAIQCCAGQbABaiAGKAKAAhAIIAZBoAFqIAYoAvwBEAggBkGQAWogBigC+AEQCCAGQfAAaiAGQdABahAPIAYoAogCIQkgBkHgAGogBkHAAWoQDyAGQdAAaiAGQbABahAPIAYoAvQBIQogBkFAa0GkCRAIIAZBMGpBpAkQCCAGQSBqIAZBoAFqEA8gBkEQakGkCRAIIAYgBkGQAWoQDyAGQfAAaiEAIAZB4ABqIQEgBkHQAGohAyAGQTBqIQQgBkEgaiEHIAZBEGohCCMAQcAbayICJAAgAiAGQYABaiIFNgK8GyACIAk2ArgbIAJBADYCtBsgAiAKNgKwGyACQQA2AqwbIAJBADYCqBsgAkGYG2oQGSACQYAINgKUGyACQeX7lvYANgKQGyACQYAbakGFCBAIIAJB8BpqQYUIEAggAkHwEmpBgAgQEiACQfAKakGACBASIAIgBkFAayIJEAkgCRAKEBU2AuwKIAIgAkGAG2oQCSACQYAbahAKEBU2AugKIAIgAkHwGmoQCSACQfAaahAKEBU2AuQKAkAgAigCqBtBCkoEQCAFQYsIEAggAkEBNgLgCgwBCyACQQI2AtwKIAJB8BJqIAIoArQbIAJB3ApqEAsgAkHwEmogAigCkBsgAkHcCmoQCyACQfASaiACKAK4GyACQdwKahALIAJB8BJqIAIoAuwKIAJB3ApqEAsgAkHwEmogAigCsBsgAkHcCmoQCyACQfASaiAEEAkgBBAKIAJB3ApqEA0gAkHwEmogBxAJIAcQCiACQdwKahANIAJB8BJqIAEQCSABEAogAkHcCmoQDSACQfASaiADEAkgAxAKIAJB3ApqEA0gAkHwEmogABAJIAAQCiACQdwKahANIAJB8BJqIAIoAuQKIAJB3ApqEAsgAkHwEmogAigC6AogAkHcCmoQCyACQQA2AtgKIAJBADYC1AoDQCACKALUCiACKAKoG0gEQCACKAKsGyACKALUCkECdGooAgBBf0cEQCACIAIoAtgKQQEgAigC1Ap0cjYC2AoLIAIgAigC1ApBAWo2AtQKDAELCyACQfASaiACKALYCiACQdwKahALIAJBADYC0AoDQCACKALQCiACKAKoG0gEQCACKAKsGyACKALQCkECdGooAgBBf0cEQCACQfASaiACKAKsGyACKALQCkECdGooAgAgAkHcCmoQCwsgAiACKALQCkEBajYC0AoMAQsLIAJB8BJqIAgQCSAIEAogAkHcCmoQDSACQfASaiAGEAkgBhAKIAJB3ApqEA0gAiACKALcCkECa0H//wNxIgBBCHQgAEEIdnI7AfASIAIgAkHwEmogAigC3AoQFTYCzAogAkGgCmoiAEIANwMAIABCADcDGCAAQgA3AxAgAEIANwMIIAIoAtwKQYAISwRAIAVBjggQCCACQQE2AuAKDAELIAJBQGtBsAkQEiACQZgKakGVCCkAADcAACACQfAJaiIAQbYIKQAANwAYIABBrggpAAA3ABAgAEGmCCkAADcACCAAQZ4IKQAANwAAIAIoAtwKrSEMIwBB0ABrIgEkACABIAJBQGs2AkwgASACQThqNgJIIAEgAkHwEmo2AkQgASAMNwM4IAFBvwg2AjQgAUIQNwMoIAFBADYCJCABIAJBmApqNgIgIAEgAkHwCWo2AhwgAUIANwMQIAEpAzhCb1YEQBAAAAsgASgCTCEDIAEoAkwgASkDOKdqIQQgASgCRCEHIAEpAzghDCABKAI0IQggASkDKCENIAEoAiQhCSABKAIgIQogASgCHCELIwBBkANrIgAkACAAIAM2AowDIAAgBDYCiAMgAEEANgKEAyAAIAc2AoADIAAgDDcD+AIgACAINgL0AiAAIA03A+gCIAAgCTYC5AIgACAKNgLgAiAAIAs2AtwCIAAoAuACIQQgACgC3AIhByMAQSBrIgMkACADIABBEGo2AhwgA0LAADcDECADIAQ2AgwgAyAHNgIIIAMoAhwgAykDECADKAIMIAMoAghBkAooAgAoAgARCgAaIANBIGokACMAQRBrIgMkACADIABB0ABqNgIMIAMgAEEQajYCCCADKAIMIAMoAghBhAooAgAoAgARBAAaIANBEGokACAAQRBqQcAAEBEgAEHQAGogACgC9AIgACkD6AIQFCAAQQhqIAApA+gCEDAgAEHQAGogAEEIakIIEBQgACgCjAMhBCAAKAKAAyEHIAApA/gCIQwgACgC4AIhCCAAKALcAiEJIwBBMGsiAyQAIAMgBDYCLCADIAc2AiggAyAMNwMgIAMgCDYCHCADQgE3AxAgAyAJNgIMIAMoAiwgAygCKCADKQMgIAMoAhwgAykDECADKAIMQZAKKAIAKAIEEQkAGiADQTBqJAAgAEHQAGogACgCjAMgACkD+AIQFCAAQQhqIAApA/gCEDAgAEHQAGogAEEIakIIEBQgACgCiAMhBCMAQRBrIgMkACADIABB0ABqNgIMIAMgBDYCCCADKAIMIAMoAghBhAooAgAoAggRBAAaIANBEGokACAAQdAAakGAAhARIAAoAoQDBEAgACgChANCEDcDAAsgAEGQA2okACABQQA2AgwgASgCSARAIAEoAgxFBEAgASABKQM4QhB8NwMQCyABKAJIIAEpAxA3AwALIAEoAgwaIAFB0ABqJAAgAkIIIAIpAzhCB4N9PgI0IAJBADYCMANAIAIoAjAgAigCNEkEQCACKQM4pyACQUBraiACKAI0OgAAIAIgAikDOEIBfDcDOCACIAIoAjBBAWo2AjAMAQsLIAIpAzhQBEAgBUHQCBAIIAJBATYC4AoMAQsgAkEANgArIAJBADoALyACQQA2ACYgAkEAOgAqQbARIAIoArAbQQFrrTcDACACQQA2AiADQCACKAIgQQRIBEBBsBFBsBEpAwBCrf7V5NSF/ajYAH5CAXwiDDcDACACIAxCIYinQf8BcDoAHyACKAIgIAJBJmpqIAIoApQbIAIoAiBqLAAAIAItAB9zOgAAIAIoAiAgAkEramogAi0AHzoAACACIAIoAiBBAWo2AiAMAQsLIAJBEGoQGSACQRBqIAJBK2pBBBATIAJBEGogAkEmakEEEBMgAkEQaiACQUBrIAIpAzinEBMgAiACKALMCiIAQQh0QYCA/AdxIABBGHRyIABBCHZBgP4DcSAAQRh2cnI2AgwgAkEQaiACQQxqQQQQEyACQRBqEAkhASACQRBqEAohAyMAQTBrIgAgATYCLCAAIAM2AiggACACQfASajYCJCAAQYAINgIgAkAgACgCKEEASA0AIAAoAiBBAEgNACAAIAAoAiw2AhwgACAAKAIoQQNtNgIYIAAgACgCKCAAKAIYQQNsSjoAFyAAIAAoAiggACgCGEEDbEECakY6ABYgACAAKAIYIAAtABdBAXFqQQJ0NgIQAkAgACgCHARAIAAoAhAgACgCIEwNAQsgACgCJEEAOgAADAELIABBADYCDANAIAAoAgwgACgCGEgEQCAAKAIkIAAoAgxBAnRqIAAoAhwgACgCDEEDbGotAABBAnYtAOAIOgAAIAAoAiQgACgCDEECdEEBamogACgCHCAAKAIMQQNsai0AAEEDcUEEdCAAKAIcIAAoAgxBA2xBAWpqLQAAQQR2ci0A4Ag6AAAgACgCJCAAKAIMQQJ0QQJqaiAAKAIcIAAoAgxBA2xBAWpqLQAAQQJ0IAAoAhwgACgCDEEDbEECamotAABBBnZyQT9xLQDgCDoAACAAKAIkIAAoAgxBAnRBA2pqIAAoAhwgACgCDEEDbEECamotAABBP3EtAOAIOgAAIAAgACgCDEEBajYCDAwBCwsgAC0AF0EBcQRAIAAoAiQgACgCDEECdGogACgCHCAAKAIMQQNsai0AAEECdi0A4Ag6AAACQCAALQAWQQFxBEAgACgCJCAAKAIMQQJ0QQFqaiAAKAIcIAAoAgxBA2xqLQAAQQNxQQR0IAAoAhwgACgCDEEDbEEBamotAABBBHZyLQDgCDoAACAAKAIkIAAoAgxBAnRBAmpqIAAoAhwgACgCDEEDbEEBamotAABBAnRBP3EtAOAIOgAADAELIAAoAiQgACgCDEECdEEBamogACgCHCAAKAIMQQNsai0AAEEDcUEEdC0A4Ag6AAAgACAAKAIQQQFrNgIQCyAAIAAoAhBBAWs2AhALIAAoAiQgACgCEGpBADoAAAsgAhAZIAJB8BJqIQMgAkHwEmoQICEBIwBBEGsiByQAAkAgASACECUiAE0EQCACEBgiCSEEIAEiAARAAkAgAyAERg0AIAMgACAEaiIKa0EAIABBAXRrTQRAIAQgAyAAEBYMAQsgAyAEc0EDcSEIAkACQCADIARLBEAgCA0CIARBA3FFDQEDQCAARQ0EIAQgAy0AADoAACADQQFqIQMgAEEBayEAIARBAWoiBEEDcQ0ACwwBCwJAIAgNACAKQQNxBEADQCAARQ0FIAQgAEEBayIAaiIIIAAgA2otAAA6AAAgCEEDcQ0ACwsgAEEDTQ0AA0AgBCAAQQRrIgBqIAAgA2ooAgA2AgAgAEEDSw0ACwsgAEUNAgNAIAQgAEEBayIAaiAAIANqLQAAOgAAIAANAAsMAgsgAEEDTQ0AA0AgBCADKAIANgIAIANBBGohAyAEQQRqIQQgAEEEayIAQQNLDQALCyAARQ0AA0AgBCADLQAAOgAAIARBAWohBCADQQFqIQMgAEEBayIADQALCwsgB0EAOgAPIAEgCWogBy0ADzoAACACIAEQJAwBCyACIAAgASAAayACEBwiAEEAIAAgASADECMLIAdBEGokACMAQRBrIgAkACAAIAU2AgwgACACNgIIIAAoAgwiAQJ+IwBBEGsiAyAAKAIINgIMIAMoAgwiAykCAAs3AgAgASADKAIINgIIIAAoAggQHiAAQRBqJAAgAkEBNgLgCiACEAYgAkEQahAGCyACQfAaahAGIAJBgBtqEAYgAkGYG2oQBiACQcAbaiQAIAYQBiAGQRBqEAYgBkEgahAGIAZBMGoQBiAGQUBrEAYgBkHQAGoQBiAGQeAAahAGIAZB8ABqEAYgBiAGQYABahAJNgKMAiAGQYABahAGIAZBkAFqEAYgBkGgAWoQBiAGQbABahAGIAZBwAFqEAYgBkHQAWoQBiAGQeABahAGCyAGKAKMAiEAIAZBkAJqJAAgAAvKAQEBfyMAQYABayIGJAAgBiAANgJ4IAYgATYCdCAGIAI3A2ggBiADNgJkIAYgBDcDWCAGIAU2AlQCQCAGKQNoUARADAELIAYgBikDWEIgiD4CBCAGIAYpA1g+AgAgBkEIaiAGKAIAEAUgBkEMaiAGKAIEEAUgBkEQaiAGKAJUEC8gBkEQaiAGKAJkIAZBCGoQLiAGQRBqIAYoAnQgBigCeCAGKQNoEC0gBkEQakHAABARCyAGQQA2AnwgBigCfCEAIAZBgAFqJAAgAAuXAQEBfyMAQeAAayIEJAAgBCAANgJYIAQgATcDUCAEIAI2AkwgBCADNgJIAkAgBCkDUFAEQAwBCyAEQQhqIAQoAkgQLyAEQQhqIAQoAkxBABAuIAQoAlggBCkDUKcQEiAEQQhqIAQoAlggBCgCWCAEKQNQEC0gBEEIakHAABARCyAEQQA2AlwgBCgCXCEAIARB4ABqJAAgAAvVCQICfwF+IwBBEGsiAiQAIAIgADYCDCACIAE2AgggAigCDCEBIAIoAgghAyMAQdAAayIAJAAgACABNgJMIAAgAzYCSCAAKAJMKQM4QgBSBEAgACAAKAJMKQM4NwMAIAAoAkxBQGshASAAIAApAwAiBEIBfDcDACAEpyABakEBOgAAA0AgACkDAEIQVARAIAApAwCnIAAoAkxBQGtqQQA6AAAgACAAKQMAQgF8NwMADAELCyAAKAJMQQE6AFAgACgCTCAAKAJMQUBrQhAQGwsgACAAKAJMKAIUNgJEIAAgACgCTCgCGDYCQCAAIAAoAkwoAhw2AjwgACAAKAJMKAIgNgI4IAAgACgCTCgCJDYCNCAAIAAoAkBBGnY2AjAgACAAKAJAQf///x9xNgJAIAAgACgCMCAAKAI8ajYCPCAAIAAoAjxBGnY2AjAgACAAKAI8Qf///x9xNgI8IAAgACgCMCAAKAI4ajYCOCAAIAAoAjhBGnY2AjAgACAAKAI4Qf///x9xNgI4IAAgACgCMCAAKAI0ajYCNCAAIAAoAjRBGnY2AjAgACAAKAI0Qf///x9xNgI0IAAgACgCRCAAKAIwQQVsajYCRCAAIAAoAkRBGnY2AjAgACAAKAJEQf///x9xNgJEIAAgACgCMCAAKAJAajYCQCAAIAAoAkRBBWo2AiwgACAAKAIsQRp2NgIwIAAgACgCLEH///8fcTYCLCAAIAAoAkAgACgCMGo2AiggACAAKAIoQRp2NgIwIAAgACgCKEH///8fcTYCKCAAIAAoAjwgACgCMGo2AiQgACAAKAIkQRp2NgIwIAAgACgCJEH///8fcTYCJCAAIAAoAjggACgCMGo2AiAgACAAKAIgQRp2NgIwIAAgACgCIEH///8fcTYCICAAIAAoAjQgACgCMGpBgICAIGs2AhwgACAAKAIcQR92QQFrNgIMIAAgACgCDCAAKAIscTYCLCAAIAAoAgwgACgCKHE2AiggACAAKAIMIAAoAiRxNgIkIAAgACgCDCAAKAIgcTYCICAAIAAoAgwgACgCHHE2AhwgACAAKAIMQX9zNgIMIAAgACgCLCAAKAJEIAAoAgxxcjYCRCAAIAAoAiggACgCQCAAKAIMcXI2AkAgACAAKAIkIAAoAjwgACgCDHFyNgI8IAAgACgCICAAKAI4IAAoAgxxcjYCOCAAIAAoAhwgACgCNCAAKAIMcXI2AjQgACAAKAJEIAAoAkBBGnRyNgJEIAAgACgCPEEUdCAAKAJAQQZ2cjYCQCAAIAAoAjhBDnQgACgCPEEMdnI2AjwgACAAKAI0QQh0IAAoAjhBEnZyNgI4IAAgACgCRK0gACgCTCgCKK18NwMQIAAgACkDED4CRCAAIAAoAkCtIAAoAkwoAiytfCAAKQMQQiCIfDcDECAAIAApAxA+AkAgACAAKAI8rSAAKAJMKAIwrXwgACkDEEIgiHw3AxAgACAAKQMQPgI8IAAgACgCOK0gACgCTCgCNK18IAApAxBCIIh8NwMQIAAgACkDED4COCAAKAJIIAAoAkQQBSAAKAJIQQRqIAAoAkAQBSAAKAJIQQhqIAAoAjwQBSAAKAJIQQxqIAAoAjgQBSAAKAJMQdgAEBEgAEHQAGokACACQRBqJABBAAuFBAECfyMAQRBrIgMkACADIAA2AgwgAyABNgIIIAMgAjcDACADKAIMIQEgAygCCCEEIAMpAwAhAiMAQTBrIgAkACAAIAE2AiwgACAENgIoIAAgAjcDIAJAIAAoAiwpAzhCAFIEQCAAQhAgACgCLCkDOH03AxAgACkDECAAKQMgVgRAIAAgACkDIDcDEAsgAEIANwMYA0AgACkDGCAAKQMQVARAIAAoAiwpAzggACkDGHynIAAoAixBQGtqIAAoAiggACkDGKdqLQAAOgAAIAAgACkDGEIBfDcDGAwBCwsgACAAKQMgIAApAxB9NwMgIAAgACgCKCAAKQMQp2o2AiggACgCLCIBIAApAxAgASkDOHw3AzggACgCLCkDOEIQVA0BIAAoAiwgACgCLEFAa0IQEBsgACgCLEIANwM4CyAAKQMgQhBaBEAgACAAKQMgQnCDNwMIIAAoAiwgACgCKCAAKQMIEBsgACAAKAIoIAApAwinajYCKCAAIAApAyAgACkDCH03AyALIAApAyBQDQAgAEIANwMYA0AgACkDGCAAKQMgVARAIAAoAiwpAzggACkDGHynIAAoAixBQGtqIAAoAiggACkDGKdqLQAAOgAAIAAgACkDGEIBfDcDGAwBCwsgACgCLCIBIAApAyAgASkDOHw3AzgLIABBMGokACADQRBqJABBAAuCAwECfyMAQRBrIgIkACACIAA2AgwgAiABNgIIIAIoAgwhASACKAIIIQMjAEEQayIAJAAgACABNgIMIAAgAzYCCCAAKAIIEARB////H3EhASAAKAIMIAE2AgAgACgCCEEDahAEQQJ2QYP+/x9xIQEgACgCDCABNgIEIAAoAghBBmoQBEEEdkH/gf8fcSEBIAAoAgwgATYCCCAAKAIIQQlqEARBBnZB///AH3EhASAAKAIMIAE2AgwgACgCCEEMahAEQQh2Qf//P3EhASAAKAIMIAE2AhAgACgCDEEANgIUIAAoAgxBADYCGCAAKAIMQQA2AhwgACgCDEEANgIgIAAoAgxBADYCJCAAKAIIQRBqEAQhASAAKAIMIAE2AiggACgCCEEUahAEIQEgACgCDCABNgIsIAAoAghBGGoQBCEBIAAoAgwgATYCMCAAKAIIQRxqEAQhASAAKAIMIAE2AjQgACgCDEIANwM4IAAoAgxBADoAUCAAQRBqJAAgAkEQaiQAQQALC5oCAwBBgAgLUvJfTBoANG51bGwALTEAbGVuZXJyADhbO9vHjBtXAADrT+Ic05XnuxTuKB+RT4EzANhcQ63ef1cbfGq6zlKfAKn94gdxx4Wm29kgXlY+wS0ALTIAQeAIC5UBQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODlfLQAtMQAAYmFzaWNfc3RyaW5nAGFsbG9jYXRvcjxUPjo6YWxsb2NhdGUoc2l6ZV90IG4pICduJyBleGNlZWRzIG1heGltdW0gc3VwcG9ydGVkIHNpemUAQfgJCx8BAAAAAgAAAAMAAAD4BAAABAAAAAUAAAAIBQAAsApQ";if(!D.startsWith(N)){var O=D;D=t.locateFile?t.locateFile(O,c):c+O}function x(){var e=D;try{if(e==D&&p)return new Uint8Array(p);var t=L(e);if(t)return t;if(l)return l(e);throw"both async and sync fetching of the wasm failed"}catch(e){S(e)}}function R(e){for(;0<e.length;){var o=e.shift();if("function"==typeof o)o(t);else{var r=o.o;"number"==typeof r?void 0===o.m?v.get(r)():v.get(r)(o.m):r(void 0===o.m?null:o.m)}}}var b="function"==typeof atob?atob:function(e){var t="",o=0;e=e.replace(/[^A-Za-z0-9\+\/=]/g,"");do{var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(o++)),n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(o++)),i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(o++)),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(o++));r=r<<2|n>>4,n=(15&n)<<4|i>>2;var s=(3&i)<<6|a;t+=String.fromCharCode(r),64!==i&&(t+=String.fromCharCode(n)),64!==a&&(t+=String.fromCharCode(s))}while(o<e.length);return t};function L(e){if(e.startsWith(N)){try{var t=b(e.slice(N.length)),o=new Uint8Array(t.length);for(e=0;e<t.length;++e)o[e]=t.charCodeAt(e)}catch(e){throw Error("Converting base64 string to bytes failed.")}return o}}var w={a:function(){S()},b:function(e,t,o){h.copyWithin(e,t,t+o)},c:function(){S("OOM")},d:function(){function e(e){return e?48<e.length?e.substr(0,48):e:""}var t=function(){var t=document.URL,o=window.navigator.userAgent.toLowerCase(),r="";0<document.referrer.length&&(r=document.referrer);try{0==r.length&&0<window.opener.location.href.length&&(r=window.opener.location.href)}catch(e){}var n=window.navigator.appCodeName,i=window.navigator.appName,a=window.navigator.platform;return t=e(t),r=e(r),t+"|"+(o=e(o))+"|"+r+"|"+n+"|"+i+"|"+a}(),o=function(e){for(var t=0,o=0;o<e.length;++o){var r=e.charCodeAt(o);55296<=r&&57343>=r&&(r=65536+((1023&r)<<10)|1023&e.charCodeAt(++o)),127>=r?++t:t=2047>=r?t+2:65535>=r?t+3:t+4}return t}(t)+1,r=K(o);return g(t,r,o+1),r}};!function(){function e(e){t.asm=e.exports,e=t.asm.e.buffer,t.HEAP8=f=new Int8Array(e),t.HEAP16=new Int16Array(e),t.HEAP32=new Int32Array(e),t.HEAPU8=h=new Uint8Array(e),t.HEAPU16=new Uint16Array(e),t.HEAPU32=new Uint32Array(e),t.HEAPF32=new Float32Array(e),t.HEAPF64=new Float64Array(e),v=t.asm.g,m.unshift(t.asm.f),I--,t.monitorRunDependencies&&t.monitorRunDependencies(I),0==I&&P&&(e=P,P=null,e())}function o(t){e(t.instance)}function n(e){return(p||!i&&!a||"function"!=typeof fetch?Promise.resolve().then((function(){return x()})):fetch(D,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+D+"'";return e.arrayBuffer()})).catch((function(){return x()}))).then((function(e){return WebAssembly.instantiate(e,s)})).then(e,(function(e){d("failed to asynchronously prepare wasm: "+e),S(e)}))}var s={a:w};if(I++,t.monitorRunDependencies&&t.monitorRunDependencies(I),t.instantiateWasm)try{return t.instantiateWasm(s,e)}catch(e){return d("Module.instantiateWasm callback failed with error: "+e),!1}(p||"function"!=typeof WebAssembly.instantiateStreaming||D.startsWith(N)||"function"!=typeof fetch?n(o):fetch(D,{credentials:"same-origin"}).then((function(e){return WebAssembly.instantiateStreaming(e,s).then(o,(function(e){return d("wasm streaming compile failed: "+e),d("falling back to ArrayBuffer instantiation"),n(o)}))}))).catch(r)}(),t.___wasm_call_ctors=function(){return(t.___wasm_call_ctors=t.asm.f).apply(null,arguments)},t._getckey=function(){return(t._getckey=t.asm.h).apply(null,arguments)};var M,V=t.stackSave=function(){return(V=t.stackSave=t.asm.i).apply(null,arguments)},k=t.stackRestore=function(){return(k=t.stackRestore=t.asm.j).apply(null,arguments)},B=t.stackAlloc=function(){return(B=t.stackAlloc=t.asm.k).apply(null,arguments)},K=t._malloc=function(){return(K=t._malloc=t.asm.l).apply(null,arguments)};function Y(){function e(){if(!M&&(M=!0,t.calledRun=!0,!u)){if(R(m),o(t),t.onRuntimeInitialized&&t.onRuntimeInitialized(),t.postRun)for("function"==typeof t.postRun&&(t.postRun=[t.postRun]);t.postRun.length;){var e=t.postRun.shift();T.unshift(e)}R(T)}}if(!(0<I)){if(t.preRun)for("function"==typeof t.preRun&&(t.preRun=[t.preRun]);t.preRun.length;)C();R(y),0<I||(t.setStatus?(t.setStatus("Running..."),setTimeout((function(){setTimeout((function(){t.setStatus("")}),1),e()}),1)):e())}}if(t.ccall=_,t.cwrap=function(e,t,o,r){var n=(o=o||[]).every((function(e){return"number"===e}));return"string"!==t&&n&&!r?A(e):function(){return _(e,t,o,arguments)}},P=function e(){M||Y(),M||(P=e)},t.run=Y,t.preInit)for("function"==typeof t.preInit&&(t.preInit=[t.preInit]);0<t.preInit.length;)t.preInit.pop()();return Y(),e.ready}),_scriptDir,getCkey9;function updateCkey$2(e,t){return __awaiter(this,void 0,void 0,(function(){var o,r,n,i,a,s,l,c,p,d,u,A,_;return __generator(this,(function(E){switch(E.label){case 0:return o=t.tm,r=t.vid,n=void 0===r?"":r,i=t.appVer,a=void 0===i?"":i,s=t.guid,l=void 0===s?"":s,c=t.platform,p=void 0===c?"":c,u=o||getTimeStampStr(),e!==CKEY_VRE.CKEY_9?[3,3]:getCkey9?[3,2]:[4,_thumbplayerCkeyWasmFactory(void 0)];case 1:_=E.sent(),getCkey9=_.cwrap("getckey","string",["int","string","string","string","string","int"]),E.label=2;case 2:return A=getCkey9(+p,a,n,"",l,+u),d=CKEY_VRE.CKEY_9,[3,4];case 3:A=getckey(n,u,a,l,p),d=CKEY_VRE.CKEY_8,E.label=4;case 4:return t.tm=u,t.cKey=A,t.encryptVer=d,[2,t]}}))}))}var prepareRequestMiddleWare$1=function(e,t){return __awaiter(void 0,void 0,void 0,(function(){var o,r,n,i,a,s,l,c,p,d;return __generator(this,(function(u){switch(u.label){case 0:return o=e.reqParams,r=void 0===o?{}:o,n=e.config,i=e.player,a=e.isSetPlayerData,s=void 0===a||a,l=n.ckeyVer,[4,Promise.all([updateCkey$2(l,r),getRequestParamForDRM(r.drm)])];case 1:return c=u.sent(),p=c[1],r.drm=p,s&&i.setCommonKv(((d={})[VOD_GET_INFO_DATA_KEYS.ckey]=r.cKey,d[VOD_GET_INFO_DATA_KEYS.ckeyVersion]=l,d)),e.logger.log("request params is:",jsonTool.safelyStringify(e.reqParams)),[4,t()];case 2:return u.sent(),[2]}}))}))};function getRequestUrl$2(e,t){var o=e.test,r=e.path;if(o)return PATH.TEST;var n=r||PATH.COMMON;return"string"==typeof n?n:n[t%n.length]}var sendRequestMiddleWare$2=function(e,t){return __awaiter(void 0,void 0,void 0,(function(){var o,r,n,i,a,s,l,c,p,d,u,A,_,E,g;return __generator(this,(function(f){switch(f.label){case 0:e.logger.log("doRequest start..."),o=e.requestor,r=e.reqParams,n=e.config,i=n.ckeyVer,a=n.retryCount,s=void 0===a?3:a,l=n.timeout,c=void 0===l?DEFAULT_GETINFO_CONFIG$2.timeout:l,p=null,d=0,f.label=1;case 1:if(!(d<s+1))return[3,8];e.logger.log("retry... count is: ",d),f.label=2;case 2:return f.trys.push([2,5,,6]),p=null,e.reqPath=getRequestUrl$2(n,d),u=e,(A=e.resData)?[3,4]:[4,o.start(e.reqPath,r,c)];case 3:A=f.sent(),f.label=4;case 4:return u.resData=A,[3,6];case 5:return _=f.sent(),e.logger.log("the ".concat(d," retry err:"),_),"jsonp timeout"===(null==_?void 0:_.message)&&(p={code:exports.ErrorCode.GETINFO_TIMEOUT,message:compile(i18nConfig.h5player.ERROR_GETINFO_TIMEOUT)}),[3,6];case 6:if(e.alreadyRetryCount=d,e.resData)return[3,8];f.label=7;case 7:return d++,[3,1];case 8:return e.resData&&85==+e.resData.em&&-3==+e.resData.exem?(e.reqParams.tm=e.resData.curTime,[4,updateCkey$2(i,r)]):[3,13];case 9:f.sent(),f.label=10;case 10:return f.trys.push([10,12,,13]),e.logger.log("retry ckey... "),e.reqPath=getRequestUrl$2(n,0),E=e,[4,o.start(e.reqPath,r,c)];case 11:return E.resData=f.sent(),[3,13];case 12:return g=f.sent(),e.logger.log("retry ckey err:",g),[3,13];case 13:if(e.endTime=+new Date,!e.resData)return e.throw((null==p?void 0:p.code)||exports.ErrorCode.GETINFO_NET,(null==p?void 0:p.message)||compile(i18nConfig.h5player.ERROR_GETINFO_NET)),[2];try{e.logger.log("sendRequest over... ret is: ",JSON.stringify(e.resData,(function(e,t){return"m3u8"===e?"":t})))}catch(e){}return[4,t()];case 14:return f.sent(),[2]}}))}))},setPlayerDataMiddleWare$2=function(e,t){return __awaiter(void 0,void 0,void 0,(function(){var o,r,n,i,a,s,l,c,p,d,u,A,_,E,g,f;return __generator(this,(function(h){switch(h.label){case 0:return o=e.player,r=e.resData,n=void 0===r?{}:r,i=e.parseData,a=void 0===i?{}:i,s=e.isSetPlayerData,(void 0===s||s)&&o.setCommonKv(((l={})[COMMON_DATA_KEY.status]=null===(c=a.vitem)||void 0===c?void 0:c.vst,l[COMMON_DATA_KEY.type]=null===(p=a.vitem)||void 0===p?void 0:p.type,l.videoName=a.title,l.byteRate=a.byteRate,l[COMMON_DATA_KEY.duration]=a.duration,l.preview=a.preview,l.drm=getDrm(n),l[COMMON_DATA_KEY.p2p]=n.fp2p?1:0,l[COMMON_DATA_KEY.fmt]=null===(u=null===(d=a.definitionList)||void 0===d?void 0:d.find((function(e){return e.sl})))||void 0===u?void 0:u.id,l[COMMON_DATA_KEY.testid]=n.tstid,l[COMMON_DATA_KEY.cdnid]=null===(g=null===(E=null===(_=null===(A=a.vitem)||void 0===A?void 0:A.ul)||void 0===_?void 0:_.ui)||void 0===E?void 0:E[0])||void 0===g?void 0:g.vt,l[COMMON_DATA_KEY.rate]=a.byteRate,l[COMMON_DATA_KEY.dltype]=n.dltype,l[VOD_GET_INFO_DATA_KEYS.vurl]=null===(f=a.urls[0])||void 0===f?void 0:f.url,l)),[4,t()];case 1:return h.sent(),[2]}}))}))},VodGetInfo=function(){function e(e){var t;this.player=e,this._abort=!1,this._seq=0,this.cachedResult={},this._config=__assign$1(__assign$1({},DEFAULT_GETINFO_CONFIG$2),(null===(t=e.config)||void 0===t?void 0:t.getinfoConfig)||{}),this.logger=new Logger(e.config.instanceId,"GetInfoVod")}return e.prototype.getReqParams=function(e,t){var o=this,r=this.prepare(e,t);return compose([this._config.prepareRequestMiddleWare||prepareRequestMiddleWare$1])(r).then((function(){return o.onMiddlewareExecuteSuccess(r)})).catch((function(e){return o.onMiddlewareExecutionFail(r,e)}))},e.prototype.setVideoInfo=function(e,t){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(o){return t?this.parseExternalVideoInfo(e,t):this.cachedResult[e]=void 0,[2]}))}))},e.prototype.parseExternalVideoInfo=function(e,t){return __awaiter(this,void 0,void 0,(function(){var o,r,n,i,a=this;return __generator(this,(function(s){return(o=this.prepare(e)).resData=t,r=this._config.sendRequestMiddleWare||sendRequestMiddleWare$2,n=this._config.checkResponseMiddleWare||checkResponseMiddleWare$2,i=this._config.parseResponseMiddleWare||parseResponseMiddleWare$2,this.cachedResult[e]=compose([r,n,i,setPlayerDataMiddleWare$2])(o).then((function(){return a.onMiddlewareExecuteSuccess(o)})).catch((function(e){return a.onMiddlewareExecutionFail(o,e)})),[2]}))}))},e.prototype.parseVideoInfo=function(e,t,o){return __awaiter(this,void 0,void 0,(function(){var r,n,i,a,s=this;return __generator(this,(function(l){return(r=this.prepare(e,o)).resData=t,r.isSetPlayerData=!1,n=this._config.sendRequestMiddleWare||sendRequestMiddleWare$2,i=this._config.checkResponseMiddleWare||checkResponseMiddleWare$2,a=this._config.parseResponseMiddleWare||parseResponseMiddleWare$2,[2,compose([n,i,a])(r).then((function(){return s.onMiddlewareExecuteSuccess(r)})).catch((function(e){return s.onMiddlewareExecutionFail(r,e)}))]}))}))},e.prototype.request=function(e,t,o,r){return void 0===r&&(r=!0),__awaiter(this,void 0,void 0,(function(){var n,i,a,s,l,c,p,d,u=this;return __generator(this,(function(A){switch(A.label){case 0:return n=e,this._abort=!1,this.cachedResult[n]?[4,this.cachedResult[n]]:[3,2];case 1:return i=A.sent(),this.cachedResult[n]=void 0,[2,Promise.resolve(i)];case 2:return(a=this.prepare(n,t)).isSetPlayerData=r,(s=this.validateReqParams(a.reqParams))?(a.error={code:exports.ErrorCode.GETINFO_INNER,message:compile(i18nConfig.tvk.GETINFO_MISSING_PARAM,s)},[2,Promise.resolve(this.formatOutputData(a))]):(l=this._config.prepareRequestMiddleWare||prepareRequestMiddleWare$1,c=this._config.sendRequestMiddleWare||sendRequestMiddleWare$2,p=this._config.checkResponseMiddleWare||checkResponseMiddleWare$2,d=this._config.parseResponseMiddleWare||parseResponseMiddleWare$2,[2,compose((null==o?void 0:o.length)?o:[l,c,p,d,setPlayerDataMiddleWare$2])(a).then((function(){return u.onMiddlewareExecuteSuccess(a)})).catch((function(e){return u.onMiddlewareExecutionFail(a,e)}))])}}))}))},e.prototype.abort=function(){this._abort=!0},e.prototype.destroy=function(){this.abort(),this.cachedResult=null,this.player=null},e.prototype.validateReqParams=function(e){return["vid","platform","sdtfrom","flowid","guid"].find((function(t){return!e[t]}))},e.prototype.prepare=function(e,t){this._abort=!1,this._seq+=1;var o=this.createBaseContext();return Object.assign(o.reqParams,t,{vid:e}),o},e.prototype.onMiddlewareExecuteSuccess=function(e){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){return this._abort||this._seq!==e.seq?(this.cachedResult[e.vid]=void 0,[2,new Promise((function(){}))]):(this.logger.log("getinfo 成功: ",e),[2,this.formatOutputData(e)])}))}))},e.prototype.onMiddlewareExecutionFail=function(e,t){return __awaiter(this,void 0,void 0,(function(){var o,r;return __generator(this,(function(n){return this._abort||this._seq!==e.seq?(this.cachedResult[e.vid]=void 0,[2,new Promise((function(){}))]):(o=t.code,r=t.message,o||(this.logger.warn("getinfo 内部错误: ",t),o=exports.ErrorCode.GETINFO_INNER,r="".concat(compile(i18nConfig.h5player.ERROR_GETINFO_INNER),", err (").concat(t,")")),e.error={code:o,message:r},[2,this.formatOutputData(e)])}))}))},e.prototype.collectBaseRequestParam=function(){return __assign$1(__assign$1({},DEFAULT_REQ_PARAMS$2),{appVer:this.player.getCommonKv(COMMON_DATA_KEY.appVer),platform:this.player.getCommonKv(COMMON_DATA_KEY.platform),sdtfrom:this.player.getCommonKv(COMMON_DATA_KEY.sdtfrom),flowid:this.player.getCommonKv(COMMON_DATA_KEY.flowid),guid:this.player.getCommonKv(COMMON_DATA_KEY.guid)})},e.prototype.createBaseContext=function(){return{player:this.player,startTime:+new Date,endTime:0,alreadyRetryCount:0,config:this._config,reqParams:this.collectBaseRequestParam(),reqPath:void 0,resData:void 0,requestor:new JsonpRequestor("getinfo_callback_"),parseData:void 0,error:void 0,throw:function(e,t){var o=new Error("getinfo err");throw o.code=e,o.message=t,o},extraPlayConfig:{setLevelMode:SET_LEVEL_MODE.HARD},isSetPlayerData:!0,seq:this._seq,urlConfig:void 0,logger:this.logger}},e.prototype.formatOutputData=function(e){var t,o,r,n,i,a,s,l,c,p,d,u,A,_,E=e.reqParams,g=e.resData,f=e.parseData,h=e.isSetPlayerData,v=__assign$1({},e);["requestor","player","throw","isSetPlayerData"].forEach((function(e){delete v[e]}));var y=void 0,m=this.player.getCommonKv(COMMON_DATA_KEY.drm),T=parseCodecInfo$2(g),C=T.codec,I=T.vtype,P=T.vtypeKey,S=selectKernel$2(g);if(g&&f){var N=null==f?void 0:f.urls.map((function(e){return e.url})),D=N[0],O=N.slice(1),x=(null===(o=null===(t=null==f?void 0:f.vitem)||void 0===t?void 0:t.ckc)||void 0===o?void 0:o.split("|"))||[],R=x[0],b=x[1],L=g.fp2p>=0&&(null===(i=null===(n=null===(r=g.vl)||void 0===r?void 0:r.vi)||void 0===n?void 0:n[0])||void 0===i?void 0:i.keyid),w=g.downloadmode;y={url:D,backupUrls:O,m3u8:null==f?void 0:f.urls.m3u8,p2pConfig:L?this.prepareP2PConfig({keyId:"hls.".concat(L),useP2P:2===g.fp2p,flowId:E.flowid,downloadMode:w,encoding:P}):void 0,drmConfig:R?this.prepareDRMConfig({drmType:m,licenseUrl:R,certificateUrl:b,vid:null===(a=null==f?void 0:f.vitem)||void 0===a?void 0:a.vid}):void 0,chachaParam:m===DRM_TYPE.CHACHA?{linkvid:null===(s=null==f?void 0:f.vitem)||void 0===s?void 0:s.lnk,base:null===(l=null==f?void 0:f.vitem)||void 0===l?void 0:l.base,appVer:E.appVer,tm:null==g?void 0:g.tm,platform:E.platform}:null,defaultAudioTrack:null===(d=null===(p=null===(c=null==f?void 0:f.additionalTrackInfo)||void 0===c?void 0:c.altAudioTrack)||void 0===p?void 0:p.find((function(e){return e.selected})))||void 0===d?void 0:d.name,drmType:m,kernelName:S,vcodec:C,setLevelMode:null===(u=v.extraPlayConfig)||void 0===u?void 0:u.setLevelMode,expireTimeStamp:+new Date+URL_EXPIRE_TIME},uaTool.browser.safari&&(y.insertableStreams=this.prepareInsertableStreams(L,null===(_=null===(A=f.supplementaryInfo)||void 0===A?void 0:A.contentInfo)||void 0===_?void 0:_.ad))}return h&&this.player.setCommonKv(COMMON_DATA_KEY.codec,I),__assign$1(__assign$1({},v),{kernelName:S,urlConfig:y})},e.prototype.prepareInsertableStreams=function(e,t){var o=comTool.mergeTimeRanges(null!=t?t:[]),r=0;return o.map((function(t,o){var n=t.start,i=t.end,a={startTime:n-r,endTime:i-r,url:"keyid://".concat(e,".ad.").concat(o,".m3u8")};return r+=i-n,a}))},e.prototype.prepareDRMConfig=function(e){var t,o,r=e.drmType,n=e.licenseUrl,i=e.certificateUrl,a=e.vid,s=this.player.getCommonKv,l=((t={})[DRM_TYPE.FAIR_PLAY]=KeySystems.FairPlayWebKit,t[DRM_TYPE.WIDEVINE]=KeySystems.Widevine,t),c={licenseUrl:n,certificate:{},keySystem:l[r],licenseRequestSetup:function(e){if(e.responseType="json",r===DRM_TYPE.FAIR_PLAY){var t={guid:s(COMMON_DATA_KEY.guid),fmt:s(COMMON_DATA_KEY.fmt),vid:a},o=Object.keys(t).map((function(e){return"".concat(e,"=").concat(t[e])})).join("&");return e.body="".concat(e.body,"&").concat(o),e}return e},licenseResponseSetup:function(e){var t=e.code,o=e.ckc,r=e.msg;if(0===t)return stringTool.base64ToUint8Array(o);throw{code:t,message:r}}};return r===DRM_TYPE.FAIR_PLAY&&(c.certificate=((o={})[l[r]]=i,o)),c},e.prototype.prepareP2PConfig=function(e){return __assign$1({playerInfo:this.getPlayerInfo()},e)},e.prototype.getPlayerInfo=function(){var e={platform:this.player.getCommonKv(COMMON_DATA_KEY.platform)||"",osVer:this.player.getCommonKv(COMMON_DATA_KEY.osver)||"",broVer:this.player.getCommonKv(COMMON_DATA_KEY.ua)||"",playerVer:this.player.getCommonKv(COMMON_DATA_KEY.playerver)||"",guid:this.player.getCommonKv(COMMON_DATA_KEY.guid)||"",qq:"",wx:"",vip:!1},t=this.player.getCommonKv(COMMON_DATA_KEY.hc_main_login);return"qq"===t?e.qq=this.player.getCommonKv(COMMON_DATA_KEY.hc_vuserid):"wx"===t&&(e.wx=this.player.getCommonKv(COMMON_DATA_KEY.hc_vuserid)),e},e}(),DEFAULT_GETINFO_CONFIG$1={path:"",retryCount:3,zbtype:0,test:0,timeout:6e3},DEFAULT_REQ_PARAMS$1={cmd:2,cnlid:"",pla:0,stream:STREAM_TYPE$1.HLS,system:0,appVer:"1.0.0.0",encryptVer:"",qq:0,device:"PC",guid:"",flowid:"",defn:"",host:location.host,livepid:"",logintype:1,vip_status:1,livequeue:1,fntick:"",tm:"",sdtfrom:"10201",platform:"10201",cKey:"",queueStatus:0,sphttps:getSpHttps(),vkey:"",user:"",playbacktime:0,auth_from:"",auth_ext:"",logintoken:"",forcedefn:"",defauto:1};function isNormalCode(e){return-1!==[0,10,11,13].indexOf(e)}function isRetryCode(e){return-1!==[9,23,24,26,27,28,32,44,47,50,52,56,57,62,-80004,-80003].indexOf(e)}function getPayActionData$1(e){void 0===e&&(e={});var t=e.errinfo||compile(i18nConfig.h5player.ERROR_GETINFO_CODE);return 1!==e.ispay||1===e.iretdetailcode?1===e.iretdetailcode?{name:"execVIPRight",params:{msg:t,type:"backplay",refer:113}}:{downgradeLevel:!0,name:"unlock1080p",params:{msg:t,type:"flash.live.1080p"}}:{name:"showPayTips",params:{msg:t,cmd:3}}}function getErrorData$1(e){void 0===e&&(e={});var t={};t[1]=playErrDataMap.get("videoPlayError"),t[2]=playErrDataMap.get("areaLimit"),t[3]=playErrDataMap.get("areaLimit"),t[4]=playErrDataMap.get("bandWidthLimit"),t[5]=playErrDataMap.get("areaLimit"),t[6]=playErrDataMap.get("msgInterrupt"),t[7]=playErrDataMap.get("videoNotBegin"),t[8]=playErrDataMap.get("videoIsOver"),t[9]=playErrDataMap.get("numOfPeopleLimit"),t[16]=playErrDataMap.get("mustLogin"),t[18]=playErrDataMap.get("isNotInPlayList");var o=getPayActionData$1(e);t[25]=o,t[28]=playErrDataMap.get("getLoginInfoFailed"),t[30]=o,t[31]=o,t[32]=playErrDataMap.get("getLoginInfoFailed"),t[45]=playErrDataMap.get("showPayTip"),t[51]=playErrDataMap.get("videoCannotFind"),t[67]=playErrDataMap.get("copyrightLimit"),t[97]=playErrDataMap.get("notSptDrm");var r=e.iretcode,n=e.errinfo,i=void 0===n?compile(i18nConfig.h5player.ERROR_GETINFO_CODE):n,a=t[String(r)];return(a=a||playErrDataMap.get("universalTip")).params&&(a.params.msg=i),a}function parseCodecInfo$1(e){var t=CODEC.H264,o=null==e?void 0:e.vcode;return 2===o&&(t=CODEC.H265),{vtypeKey:o,vtype:VideoType$2[o]||"unknown",codec:t}}function selectKernel$1(e){var t=(e||{}).drmtype;return commonSelectKernel({codec:parseCodecInfo$1(e).codec,dltype:3,drm:t})}var checkResponseMiddleWare$1=function(e,t){return __awaiter(void 0,void 0,void 0,(function(){var o,r,n,i,a;return __generator(this,(function(s){switch(s.label){case 0:return o=e.resData,r=o.iretcode,n=o.errinfo,i=void 0===n?compile(i18nConfig.h5player.ERROR_GETINFO_CODE):n,void 0===r?(e.throw(exports.ErrorCode.GETINFO_PARSE,compile(i18nConfig.h5player.ERROR_GETINFO_PARSE),getErrorData$1(e.resData)),[2]):isNormalCode(r)?[4,t()]:(a="".concat(exports.ErrorCode.GETINFO_LIVE_SERVER_CODE_PREFIX).concat("000".concat(r).slice(-3)),e.throw(a,i,getErrorData$1(e.resData)),[2]);case 1:return s.sent(),[2]}}))}))},parseResponseMiddleWare$1=function(e,t){return __awaiter(void 0,void 0,void 0,(function(){var o,r,n,i;return __generator(this,(function(a){switch(a.label){case 0:return o=e.resData,n=(r=void 0===o?{}:o).formats instanceof Array?r.formats:[],e.parseData={preview:+r.playtime,previewRemainCount:0,urls:[{url:r.playurl}].concat(r.backurl_list),definitionList:n.map((function(e){return{id:e.id,name:e.fn,cname:e.fnname,sname:e.defnname,resolution:e.defnrate,sl:e.fn===r.defn?1:0,lmt:e.vip||0}})),watermarkList:{wi:r.brandpos?[r.brandpos]:[]},supplementaryInfo:{contentInfo:{},previewList:[],watermarkList:[],definitionList:[],posterList:[]}},null===(i=e.parseData.definitionList)||void 0===i||i.reverse(),1===r.fwflag&&r.ukey&&(e.parseData.supplementaryInfo.contentInfo.protectionWatermark=r.ukey),e.logger.log("parse ",e.parseData),[4,t()];case 1:return a.sent(),[2]}}))}))},Qvsec={};function updateCkey$1(e,t){var o=e.cnlid,r=e.platform,n=e.sdtfrom,i=(new Date).getDay(),a="7.".concat(0===i?7:i),s=(null==t?void 0:t.svrtick)>0?"".concat(1e3*(null==t?void 0:t.svrtick)).substring(0,10):getTimeStampStr(),l=Qvsec.$xx(r,o,n,1,s,a);return e.tm=s,e.fntick=s,e.cKey=l,e.encryptVer=a,e}Qvsec.ha=function(e){for(var t=[],o=0;o<64;)t[o]=0|4294967296*Math.abs(Math.sin(++o));function r(e,t){return((e>>1)+(t>>1)<<1)+(1&e)+(1&t)}return function(e){for(var o,n,i,a,s=[],l=unescape(encodeURI(e)),c=l.length,p=[o=1732584193,n=-271733879,~o,~n],d=0;d<=c;)s[d>>2]|=(l.charCodeAt(d)||128)<<d++%4*8;for(s[e=16*(c+8>>6)+14]=8*c,d=0;d<e;d+=16){for(c=p,a=0;a<64;)c=[i=c[3],r(o=c[1],(i=r(r(c[0],[o&(n=c[2])|~o&i,i&o|~i&n,o^n^i,n^(o|~i)][c=a>>4]),r(t[a],s[[a,5*a+1,3*a+5,7*a][c]%16+d])))<<(c=[7,12,17,22,5,9,14,20,4,11,16,23,6,10,15,21][4*c+a++%4])|i>>>32-c),o,n];for(a=4;a;)p[--a]=r(p[a],c[a])}for(e="";a<32;)e+=(p[a>>3]>>4*(1^7&a++)&15).toString(16);return e}}(),Qvsec.stringToHex=function(e){for(var t="",o=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"),r=0;r<e.length;r++)t+=o[e.charCodeAt(r)>>4]+o[15&e.charCodeAt(r)];return t},Qvsec.hexToString=function(e){for(var t="",o="0x"==e.substr(0,2)?2:0;o<e.length;o+=2)t+=String.fromCharCode(parseInt(e.substr(o,2),16));return t},Qvsec._Seed="#$#@#*ad",Qvsec.tempcalc=function(e,t){for(var o="",r=0;r<e.length;r++)o+=String.fromCharCode(e.charCodeAt(r)^t.charCodeAt(r%4));return o},Qvsec.u1=function(e,t){for(var o="",r=t;r<e.length;r+=2)o+=e.charAt(r);return o},Qvsec._urlStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Qvsec.urlenc=function(e,t,o){for(var r,n,i,a,s,l,c,p="",d=0;d<e.length;)r=e.charCodeAt(d++),n=e.charCodeAt(d++),i=e.charCodeAt(d++),15==d&&(p="".concat(p,"A"),p+=t,p+=o),a=r>>2,s=(3&r)<<4|n>>4,l=(15&n)<<2|i>>6,c=63&i,isNaN(n)?l=c=64:isNaN(i)&&(c=64),p=p+Qvsec._urlStr.charAt(a)+Qvsec._urlStr.charAt(s)+Qvsec._urlStr.charAt(l)+Qvsec._urlStr.charAt(c);return p},Qvsec.$xx=function(e,t,o,r,n,i){var a="123456";if(i.length<3)return"err";if("7."!=i.substr(0,2))return"err";var s=i.substr(2);"1"==s&&(a="06fc1464"),"2"==s&&(a="4244ce1b"),"3"==s&&(a="77de31c5"),"4"==s&&(a="e0149fa2"),"5"==s&&(a="60394ced"),"6"==s&&(a="2da639f0"),"7"==s&&(a="c2f0cf9f");n=n||parseInt(+new Date/1e3);return Qvsec.ha("".concat(a+t+n,"*#06#").concat(e))};var prepareRequestMiddleWare=function(e,t){return __awaiter(void 0,void 0,void 0,(function(){var o,r,n,i;return __generator(this,(function(a){switch(a.label){case 0:return o=e.reqParams,(r=void 0===o?{}:o).queueStatus=(null===(i=e.resData)||void 0===i?void 0:i.queue_status)||0,updateCkey$1(r,e.resData),[4,getRequestParamForDRM(r.livedrm)];case 1:return n=a.sent(),r.livedrm=n,r.playbackdrm=n,e.logger.log("request params is:",jsonTool.safelyStringify(e.reqParams)),[4,t()];case 2:return a.sent(),[2]}}))}))};function getRequestUrl$1(e,t){var o=e.test,r=e.path,n=e.zbtype;if(o)return ZB_CGI_TEST$1;var i=r||ZB_CGI_MAP[void 0===n?0:n];return"string"==typeof i?i:i[t%i.length]}var sendRequestMiddleWare$1=function(e,t){return __awaiter(void 0,void 0,void 0,(function(){var o,r,n,i,a,s,l,c,p,d,u,A;return __generator(this,(function(_){switch(_.label){case 0:e.logger.log("doRequest start..."),o=e.requestor,r=e.reqParams,n=void 0===r?{}:r,i=e.config,a=i.retryCount,s=i.timeout,l=void 0===s?DEFAULT_GETINFO_CONFIG$1.timeout:s,c=null,p=0,_.label=1;case 1:if(!(p<a+1))return[3,7];e.logger.log("retry... count is: ",p),_.label=2;case 2:return _.trys.push([2,4,,5]),c=null,e.reqPath=getRequestUrl$1(i,p),d=e,[4,o.start(e.reqPath,n,l)];case 3:return d.resData=_.sent(),[3,5];case 4:return u=_.sent(),e.resData=void 0,e.logger.log("the ".concat(p," retry err:"),u),"jsonp timeout"===(null==u?void 0:u.message)&&(c={code:exports.ErrorCode.GETINFO_TIMEOUT,message:compile(i18nConfig.h5player.ERROR_GETINFO_TIMEOUT)}),[3,5];case 5:if(e.endTime=+new Date,e.alreadyRetryCount=p,e.resData){if(isNormalCode(A=e.resData.iretcode)||!isRetryCode(A))return[3,7];updateCkey$1(n,e.resData)}_.label=6;case 6:return p++,[3,1];case 7:return e.endTime=+new Date,e.resData?(e.logger.log("sendRequest over... ret is: ",jsonTool.safelyStringify(e.resData)),[4,t()]):(e.throw((null==c?void 0:c.code)||exports.ErrorCode.GETINFO_NET,(null==c?void 0:c.message)||compile(i18nConfig.h5player.ERROR_GETINFO_NET)),[2]);case 8:return _.sent(),[2]}}))}))},setPlayerDataMiddleWare$1=function(e,t){return __awaiter(void 0,void 0,void 0,(function(){var o,r,n,i,a,s;return __generator(this,(function(l){switch(l.label){case 0:return o=e.player,r=e.resData,n=void 0===r?{}:r,i=e.parseData,a=void 0===i?{}:i,o.setCommonKv(((s={preview:a.preview,drm:n.drmtype})[COMMON_DATA_KEY.cdnid]=n.cdn_name,s[LIVE_GET_INFO_DATA_KEYS$1.isuserpay]=n.isuserpay,s[LIVE_GET_INFO_DATA_KEYS$1.livesid]=n.livesid,s[LIVE_GET_INFO_DATA_KEYS$1.playtime]=n.playtime,s[LIVE_GET_INFO_DATA_KEYS$1.cpay]=n.ispay,s[LIVE_GET_INFO_DATA_KEYS$1.restpreviewcnt]=n.restpreviewcnt,s)),[4,t()];case 1:return l.sent(),[2]}}))}))},LiveGetInfo=function(){function e(e){var t;this.player=e,this._abort=!1,this._seq=0,this._config=__assign$1(__assign$1({},DEFAULT_GETINFO_CONFIG$1),(null===(t=e.config)||void 0===t?void 0:t.getinfoLiveConfig)||{}),this.logger=new Logger(e.config.instanceId,"GetInfoLive")}return e.prototype.request=function(e,t){var o=this,r=e,n=__assign$1(__assign$1(__assign$1({},DEFAULT_REQ_PARAMS$1),{appVer:this.player.getCommonKv(COMMON_DATA_KEY.appVer),platform:this.player.getCommonKv(COMMON_DATA_KEY.platform),sdtfrom:this.player.getCommonKv(COMMON_DATA_KEY.sdtfrom),flowid:this.player.getCommonKv(COMMON_DATA_KEY.flowid),guid:this.player.getCommonKv(COMMON_DATA_KEY.guid),livepid:this.player.getCommonKv(COMMON_DATA_KEY.livepid),cnlid:r}),t);this._abort=!1,this._seq+=1;var i={player:this.player,startTime:+new Date,endTime:0,alreadyRetryCount:0,config:this._config,reqParams:n,reqPath:void 0,resData:void 0,requestor:new JsonpRequestor("livegetinfo_callback_"),parseData:void 0,error:void 0,throw:function(e,t,o){var r=new Error("getinfo err");throw r.code=e,r.message=t,r.data=o,r},seq:this._seq,urlConfig:void 0,logger:this.logger},a=["cnlid","platform","sdtfrom","guid"].find((function(e){return!n[e]}));if(a)return i.error={code:exports.ErrorCode.GETINFO_INNER,message:compile(i18nConfig.tvk.GETINFO_MISSING_PARAM,a)},Promise.resolve(this.formatOutputData(i));var s=this._config.prepareRequestMiddleWare||prepareRequestMiddleWare,l=this._config.sendRequestMiddleWare||sendRequestMiddleWare$1,c=this._config.checkResponseMiddleWare||checkResponseMiddleWare$1,p=this._config.parseResponseMiddleWare||parseResponseMiddleWare$1;this._middlewares=[s,l,c,p,setPlayerDataMiddleWare$1];var d=compose(this._middlewares),u=new Promise((function(){}));return d(i).then((function(){return o._abort||o._seq!==i.seq?u:(o.logger.log("getinfo 成功: ",i),o.formatOutputData(i))})).catch((function(e){if(o._abort||o._seq!==i.seq)return u;var t=e.code,r=e.message;return t||(o.logger.warn("getinfo 内部错误: ",e),t=exports.ErrorCode.GETINFO_INNER,r="".concat(compile(i18nConfig.h5player.ERROR_GETINFO_INNER),", err (").concat(e,")")),i.error={code:t,message:r,data:e.data},o.formatOutputData(i)}))},e.prototype.abort=function(){this._abort=!0},e.prototype.destroy=function(){this.abort(),this._middlewares=null,this.player=null},e.prototype.formatOutputData=function(e){var t,o,r=e.resData,n=e.parseData,i=__assign$1({},e);["requestor","player","throw"].forEach((function(e){delete i[e]}));var a=void 0,s=this.player.getCommonKv(COMMON_DATA_KEY.drm),l=parseCodecInfo$1(r),c=l.codec,p=l.vtype,d=l.vtypeKey,u=selectKernel$1(r);if(r&&n){var A=null==n?void 0:n.urls.map((function(e){return e.url})),_=A[0],E=A.slice(1),g=(null===(t=null==r?void 0:r.drmckc)||void 0===t?void 0:t.split("|"))||[],f=g[0],h=g[1];a={url:_,backupUrls:E,drmConfig:f?this.prepareDRMConfig({drmType:s,licenseUrl:f,certificateUrl:h}):void 0,chachaParam:s===DRM_TYPE.CHACHA?{cnlid:null===(o=e.reqParams.cnlid)||void 0===o?void 0:o.substring(0,e.reqParams.cnlid.length-2),baseKey:null==r?void 0:r.deckey,randoms:null==r?void 0:r.randoms}:null,p2pConfig:s===DRM_TYPE.NONE?this.prepareP2PConfig({keyId:r.livesid,useP2P:!!r.hlsp2p,downloadMode:0,encoding:d}):void 0,drmType:s,vcodec:c}}return this.player.setCommonKv(COMMON_DATA_KEY.codec,p),__assign$1(__assign$1({},i),{kernelName:u,urlConfig:a})},e.prototype.prepareDRMConfig=function(e){var t,o,r=e.drmType,n=e.licenseUrl,i=e.certificateUrl,a=this.player.getCommonKv,s=((t={})[DRM_TYPE.FAIR_PLAY]=KeySystems.FairPlayWebKit,t[DRM_TYPE.WIDEVINE]=KeySystems.Widevine,t),l={licenseUrl:n,certificate:{},keySystem:s[r],licenseRequestSetup:function(e){if(r===DRM_TYPE.FAIR_PLAY){e.responseType="text";var t={guid:a(COMMON_DATA_KEY.guid)},o=Object.keys(t).map((function(e){return"".concat(e,"=").concat(t[e])})).join("&");return e.body="".concat(e.body,"&").concat(o),e}return e},licenseResponseSetup:function(e){return r===DRM_TYPE.FAIR_PLAY?stringTool.base64ToUint8Array(e):e}};return r===DRM_TYPE.FAIR_PLAY&&(l.certificate=((o={})[s[r]]=i,o)),l},e.prototype.prepareP2PConfig=function(e){return __assign$1({flowId:this.player.getCommonKv(COMMON_DATA_KEY.flowid),playerInfo:this.getPlayerInfo()},e)},e.prototype.getPlayerInfo=function(){var e={platform:this.player.getCommonKv(COMMON_DATA_KEY.platform)||"",osVer:this.player.getCommonKv(COMMON_DATA_KEY.osver)||"",broVer:this.player.getCommonKv(COMMON_DATA_KEY.ua)||"",playerVer:this.player.getCommonKv(COMMON_DATA_KEY.playerver)||"",guid:this.player.getCommonKv(COMMON_DATA_KEY.guid)||"",qq:"",wx:"",vip:!1},t=this.player.getCommonKv(COMMON_DATA_KEY.hc_main_login);return"qq"===t?e.qq=this.player.getCommonKv(COMMON_DATA_KEY.hc_vuserid):"wx"===t&&(e.wx=this.player.getCommonKv(COMMON_DATA_KEY.hc_vuserid)),e},e}(),STREAM_TYPE;!function(e){e[e.AUTO=0]="AUTO",e[e.FLV=1]="FLV",e[e.HLS=2]="HLS",e[e.RTMP=4]="RTMP",e[e.DASH=8]="DASH",e[e.WEB_RTC=16]="WEB_RTC",e[e.T_RTC=32]="T_RTC"}(STREAM_TYPE||(STREAM_TYPE={}));var ZB_CGI_ARR=["https://infozb6.video.qq.com/cgi-bin/getliveinfo?","https://bkinfozb6.video.qq.com/cgi-bin/getliveinfo?"],ZB_CGI_TEST="https://test.zb.video.qq.com/cgi-bin/getliveinfo?",LIVE_GET_INFO_DATA_KEYS;!function(e){e.playtime="live-getinfo:playtime",e.livesid="live-getinfo:livesid",e.isuserpay="live-getinfo:isuserpay",e.cpay="live-getinfo:cpay",e.restpreviewcnt="live-getinfo:resetpreviewcnt"}(LIVE_GET_INFO_DATA_KEYS||(LIVE_GET_INFO_DATA_KEYS={}));var NECESSARY_REQ_PARAMS=["flowid","pid","guid"],VideoType={1:"H264",2:"H265",4:"SDR",22:"DolbyVisionTs",23:"DolbyVisionFmp4"},XhrRequestor=function(){function e(){}return e.prototype.start=function(e,t,o){var r="".concat(e).concat(urlTool.object2string(t,"&"));return netTool.xhr({url:r,timeout:o,method:"GET",withCredentials:!0,responseType:"json"})},e}(),DEFAULT_GETINFO_CONFIG={retryCount:3,test:0,timeout:6e3},DEFAULT_REQ_PARAMS={flowid:"",cmd:2,roomid:"",anchorid:0,pid:"",chid:"",defn:"auto",ufps:"auto",playbacktime:0,ckey:"",appver:"1.0.0.0",encrypt_ver:"",uin:"",country_code:0,lang_code:0,guid:"",appid:0,platform:"",playbackdrm:0,format_support:videoTool.supportMSE()&&!uaTool.mobile?STREAM_TYPE.FLV|STREAM_TYPE.HLS:STREAM_TYPE.HLS,caplv:0,hevclv:0,net_type:0,bandwidth:0,sphttps:getSpHttps(),unicomtype:0,unicom:"",telcom:"",cmcc:"",toushe:0,from_platform:0,tm:"",scene:"",spaudio:0,spvideo:0,atmos:0,sdclive_info:"",cnlid:"",host:location.host,sdtfrom:""};function getPayActionData(e){void 0===e&&(e={});var t=e.errmsg||compile(i18nConfig.h5player.ERROR_GETINFO_CODE);return 1===e.iretdetailcode?{name:"execVIPRight",params:{msg:t,type:"backplay",refer:113}}:{name:"showPayTips",params:{msg:t,cmd:3}}}function getErrorData(e){void 0===e&&(e={});var t=compile(i18nConfig.h5player.ERROR_GETINFO_CODE),o=e.retcode,r=e.errmsg,n=void 0===r?t:r;switch(+o){case 5:case 16:case 18:case 51:case 52:case 67:case 97:default:return{name:"setErrorView",params:{msg:n}};case 7:return{name:"setErrorView",params:{msg:n,hideRefresh:!0,hideCode:!0}};case 8:return{name:"setErrorView",params:{msg:n,hideRefresh:!0,hideCode:!0,isOver:!0}};case 46:return{name:"showPayTips",params:{msg:n}};case 25:case 30:case 45:return getPayActionData(e)}}function parseUrls(e,t){if(!t)return[];var o=t.urls;return(void 0===o?[]:o).map((function(e){return{url:e}}))}function parseDefnList(e,t){return t?t.map((function(t){return{id:t.sid,name:t.defn,cname:"".concat(t.defn_name," ").concat(t.defn_rate),sname:t.defn_name,resolution:t.defn_rate,sl:t.defn===e?1:0,lmt:t.vip||0}})).reverse():[]}function parseBrandLogo(e){return{wi:e?[e]:[]}}function parseCodecInfo(e){var t,o=CODEC.H264,r=null===(t=null==e?void 0:e.codec_param)||void 0===t?void 0:t.vcode;return 2===r&&(o=CODEC.H265),{vtype:VideoType[r]||"unknown",vtypeKey:r,codec:o}}function selectKernel(e){var t,o=null===(t=null==e?void 0:e.crypt_param)||void 0===t?void 0:t.drmtype;return commonSelectKernel({codec:parseCodecInfo(e).codec,dltype:3,drm:o})}var checkResponseMiddleWare=function(e,t){return __awaiter(void 0,void 0,void 0,(function(){var o,r,n,i,a;return __generator(this,(function(s){switch(s.label){case 0:return o=e.resData,r=o.retcode,n=o.errmsg,i=void 0===n?compile(i18nConfig.h5player.ERROR_GETINFO_CODE):n,void 0===r?(e.throw(exports.ErrorCode.GETINFO_PARSE,compile(i18nConfig.h5player.ERROR_GETINFO_PARSE),getErrorData(e.resData)),[2]):0!==r?(a="".concat(exports.ErrorCode.GETINFO_LIVE_SERVER_CODE_PREFIX).concat("000".concat(r).slice(-3)),e.throw(a,i,getErrorData(e.resData)),[2]):[4,t()];case 1:return s.sent(),[2]}}))}))},parseResponseMiddleWare=function(e,t){return __awaiter(void 0,void 0,void 0,(function(){var o,r,n,i,a,s,l,c,p;return __generator(this,(function(d){switch(d.label){case 0:return o=e.resData,n=(r=void 0===o?{}:o).suggest_defn,i=r.format_list,a=r.play_list,s=r.preview_info,l=r.brandlogo,(c=null==a?void 0:a.find((function(e){return e.defn===n})))?(r.playback&&(r.playback.svrtick=r.svrtick),e.parseData={vitem:c,preview:s?+s.playtime:0,previewRemainCount:s?+s.restpreviewcnt:0,urls:parseUrls(n,c),definitionList:parseDefnList(n,i),watermarkList:parseBrandLogo(l),supplementaryInfo:{contentInfo:{},previewList:[],watermarkList:[],definitionList:[],posterList:[]}},1===(null===(p=r.float_mark)||void 0===p?void 0:p.fwflag)&&(e.parseData.supplementaryInfo.contentInfo.protectionWatermark=r.float_mark.uin),e.logger.log("parse ",e.parseData),[4,t()]):(e.throw(exports.ErrorCode.GETINFO_PARSE,compile(i18nConfig.h5player.ERROR_GETINFO_PARSE)),[2]);case 1:return d.sent(),[2]}}))}))};function updateCkey(e,t){var o=e.roomid,r=e.chid,n=e.cnlid,i=e.platform,a=e.sdtfrom,s=o?r:n,l=(new Date).getDay(),c="7.".concat(0===l?7:l),p=(null==t?void 0:t.svrtick)>0?"".concat(1e3*(null==t?void 0:t.svrtick)).substring(0,10):getTimeStampStr(),d=Qvsec.$xx(i,s,a,1,p,c);return e.tm=p,e.ckey=d,e.encrypt_ver=c,e}function updateDrm(e){return __awaiter(this,void 0,void 0,(function(){var t;return __generator(this,(function(o){switch(o.label){case 0:return[4,getRequestParamForDRM(e.livedrm)];case 1:return t=o.sent(),e.livedrm=t,e.playbackdrm=t,[2]}}))}))}var perpareRequestMiddleWare=function(e,t){return __awaiter(void 0,void 0,void 0,(function(){var o,r;return __generator(this,(function(n){switch(n.label){case 0:return o=e.reqParams,updateCkey(r=void 0===o?{}:o,e.resData),[4,updateDrm(r)];case 1:return n.sent(),e.logger.log("request params is:",e.reqParams),[4,t()];case 2:return n.sent(),[2]}}))}))};function getRequestUrl(e,t){return e.test?ZB_CGI_TEST:ZB_CGI_ARR[t%ZB_CGI_ARR.length]}var sendRequestMiddleWare=function(e,t){return __awaiter(void 0,void 0,void 0,(function(){var o,r,n,i,a,s,l,c,p,d,u;return __generator(this,(function(A){switch(A.label){case 0:e.logger.log("doRequest start..."),o=e.requestor,r=e.reqParams,n=void 0===r?{}:r,i=e.config,a=i.retryCount,s=i.timeout,l=void 0===s?DEFAULT_GETINFO_CONFIG.timeout:s,c=null,p=0,A.label=1;case 1:if(!(p<a+1))return[3,7];e.logger.log("retry... count is: ",p),A.label=2;case 2:return A.trys.push([2,4,,5]),c=null,e.reqPath=getRequestUrl(i,p),[4,o.start(e.reqPath,n,l)];case 3:return d=A.sent(),e.resData=d.data,[3,5];case 4:return u=A.sent(),e.resData=void 0,e.logger.log("the ".concat(p," retry err:"),u),"xhrTimeoutError"===(null==u?void 0:u.error)&&(c={code:exports.ErrorCode.GETINFO_TIMEOUT,message:compile(i18nConfig.h5player.ERROR_GETINFO_TIMEOUT)}),[3,5];case 5:if(e.endTime=+new Date,e.alreadyRetryCount=p,e.resData){if(32!==e.resData.retcode)return[3,7];updateCkey(n,e.resData)}A.label=6;case 6:return p++,[3,1];case 7:return e.endTime=+new Date,e.resData?(e.logger.log("sendRequest over... ret is: ",e.resData),[4,t()]):(e.throw((null==c?void 0:c.code)||exports.ErrorCode.GETINFO_NET,(null==c?void 0:c.message)||compile(i18nConfig.h5player.ERROR_GETINFO_NET)),[2]);case 8:return A.sent(),[2]}}))}))},setPlayerDataMiddleWare=function(e,t){return __awaiter(void 0,void 0,void 0,(function(){var o,r,n,i,a,s,l,c,p;return __generator(this,(function(d){switch(d.label){case 0:return o=e.player,r=e.resData,n=void 0===r?{}:r,i=e.parseData,s=(a=void 0===i?{}:i).vitem,o.setCommonKv(((l={preview:a.preview})[COMMON_DATA_KEY.drm]=null===(c=s.crypt_param)||void 0===c?void 0:c.drmtype,l[LIVE_GET_INFO_DATA_KEYS.isuserpay]=n.isuserpay,l[LIVE_GET_INFO_DATA_KEYS.livesid]=s.sid,l[LIVE_GET_INFO_DATA_KEYS.playtime]=a.preview,l[LIVE_GET_INFO_DATA_KEYS.restpreviewcnt]=null===(p=n.preview_info)||void 0===p?void 0:p.restpreviewcnt,l)),[4,t()];case 1:return d.sent(),[2]}}))}))},UnifiedLiveGetInfo=function(){function e(e){var t;this.player=e,this._abort=!1,this._seq=0,this._config=__assign$1(__assign$1({},DEFAULT_GETINFO_CONFIG),(null===(t=e.config)||void 0===t?void 0:t.getinfoLiveConfig)||{}),this.logger=new Logger(e.config.instanceId,"UnifiedLiveGetInfo")}return e.prototype.request=function(e,t){var o=this,r=__assign$1(__assign$1({},DEFAULT_REQ_PARAMS),t),n=this.handlerIds(e,r);r=__assign$1(__assign$1({},r),n),this._abort=!1,this._seq+=1;var i={player:this.player,startTime:+new Date,endTime:0,alreadyRetryCount:0,config:this._config,reqParams:r,reqPath:void 0,resData:void 0,requestor:new XhrRequestor,parseData:void 0,error:void 0,throw:function(e,t,o){var r=new Error("getinfo err");throw r.code=e,r.message=t,r.data=o,r},seq:this._seq,urlConfig:void 0,logger:this.logger},a=NECESSARY_REQ_PARAMS.find((function(e){return!r[e]}));if(a)return i.error={code:exports.ErrorCode.GETINFO_INNER,message:compile(i18nConfig.tvk.GETINFO_MISSING_PARAM,a)},Promise.resolve(this.formatOutputData(i));var s=this._config.prepareRequestMiddleWare||perpareRequestMiddleWare,l=this._config.sendRequestMiddleWare||sendRequestMiddleWare,c=this._config.checkResponseMiddleWare||checkResponseMiddleWare,p=this._config.parseResponseMiddleWare||parseResponseMiddleWare;this._middlewares=[s,l,c,p,setPlayerDataMiddleWare];var d=compose(this._middlewares),u=new Promise((function(){}));return d(i).then((function(){return o._abort||o._seq!==i.seq?u:(o.logger.log("getinfo 成功: ",i),o.formatOutputData(i))})).catch((function(e){if(o._abort||o._seq!==i.seq)return u;var t=e.code,r=e.message;return t||(o.logger.warn("getinfo 内部错误: ",e),t=exports.ErrorCode.GETINFO_INNER,r="".concat(compile(i18nConfig.h5player.ERROR_GETINFO_INNER),", err (").concat(e,")")),i.error={code:t,message:r,data:e.data},o.formatOutputData(i)}))},e.prototype.abort=function(){this._abort=!0},e.prototype.destroy=function(){this.abort(),this._middlewares=null,this.player=null},e.prototype.formatOutputData=function(e){var t,o=e.resData,r=e.parseData,n=__assign$1({},e);if(["requestor","player","throw"].forEach((function(e){delete n[e]})),!o||!r)return __assign$1({},n);var i=r.vitem,a=r.urls,s=i.crypt_param,l=this.player.getCommonKv(COMMON_DATA_KEY.drm),c=parseCodecInfo(i),p=c.codec,d=c.vtype,u=c.vtypeKey,A=selectKernel(i),_=a.map((function(e){return e.url})),E=_[0],g=_.slice(1),f=(null===(t=null==s?void 0:s.drmckc)||void 0===t?void 0:t.split("|"))||[],h=f[0],v=f[1],y={url:E,backupUrls:g,headers:null==o?void 0:o.trans_headers,drmConfig:h?this.prepareDRMConfig({drmType:l,licenseUrl:h,certificateUrl:v}):void 0,chachaParam:l===DRM_TYPE.CHACHA?{cnlid:i.sid,baseKey:s.deckey,randoms:s.randoms}:null,p2pConfig:l===DRM_TYPE.NONE?this.prepareP2PConfig({keyId:i.sid,useP2P:!!i.usep2p,downloadMode:0,encoding:u}):void 0,drmType:l,vcodec:p};return this.player.setCommonKv(COMMON_DATA_KEY.codec,d),__assign$1(__assign$1({},n),{kernelName:A,urlConfig:y})},e.prototype.handlerIds=function(e,t){var o,r=t.roomid,n=t.livepid,i=void 0===n?"":n,a=t.anchorid;return r?(o={pid:i,chid:e,roomid:r,anchorid:void 0===a?"":a},delete t.cnlid):o={pid:i,cnlid:e},delete t.livepid,o},e.prototype.prepareDRMConfig=function(e){var t,o,r=e.drmType,n=e.licenseUrl,i=e.certificateUrl,a=this.player.getCommonKv,s=((t={})[DRM_TYPE.FAIR_PLAY]=KeySystems.FairPlayWebKit,t[DRM_TYPE.WIDEVINE]=KeySystems.Widevine,t),l={licenseUrl:n,certificate:{},keySystem:s[r],licenseRequestSetup:function(e){if(r===DRM_TYPE.FAIR_PLAY){e.responseType="text";var t={guid:a(COMMON_DATA_KEY.guid)},o=Object.keys(t).map((function(e){return"".concat(e,"=").concat(t[e])})).join("&");return e.body="".concat(e.body,"&").concat(o),e}return e},licenseResponseSetup:function(e){return r===DRM_TYPE.FAIR_PLAY?stringTool.base64ToUint8Array(e):e}};return r===DRM_TYPE.FAIR_PLAY&&(l.certificate=((o={})[s[r]]=i,o)),l},e.prototype.prepareP2PConfig=function(e){return __assign$1({flowId:this.player.getCommonKv(COMMON_DATA_KEY.flowid),playerInfo:this.getPlayerInfo()},e)},e.prototype.getPlayerInfo=function(){var e={platform:this.player.getCommonKv(COMMON_DATA_KEY.platform)||"",osVer:this.player.getCommonKv(COMMON_DATA_KEY.osver)||"",broVer:this.player.getCommonKv(COMMON_DATA_KEY.ua)||"",playerVer:this.player.getCommonKv(COMMON_DATA_KEY.playerver)||"",guid:this.player.getCommonKv(COMMON_DATA_KEY.guid)||"",qq:"",wx:"",vip:!1},t=this.player.getCommonKv(COMMON_DATA_KEY.hc_main_login);return"qq"===t?e.qq=this.player.getCommonKv(COMMON_DATA_KEY.hc_vuserid):"wx"===t&&(e.wx=this.player.getCommonKv(COMMON_DATA_KEY.hc_vuserid)),e},e}(),TVK=function(){function e(e,t){this.controllers=[],this.message=new s,this.destroyed=!1,this.config=this.prepareConfig(t),this.player=e,this.logger=new Logger(e.config.instanceId,"tvk"),this.initializeAllControllers(),this.initDebugMode()}return e.prototype.destroy=function(){this.controllers.forEach((function(e){return e.destroy()})),this.player=null,this.controllers=null,this.destroyed=!0},e.prototype.initializeAllControllers=function(){return __awaiter(this,void 0,void 0,(function(){var e,t=this;return __generator(this,(function(o){switch(o.label){case 0:return e=[NetworkController,ReporterController,GuardController,this.config.definitionController,this.config.audioTrackController].map((function(e){return e?new e(t.player,t):null})).filter((function(e){return null!==e})),[4,Promise.all(e.map((function(e){return e.ready.then((function(o){return t.onControllerReady(e)})).catch((function(o){return t.onControllerFailed(e,o)}))})))];case 1:return[2,o.sent()]}}))}))},e.prototype.onControllerReady=function(e){this.checkDestroyed(e),this.logger.log("".concat(e.constructor.moduleName," ready")),e.init(),this.controllers.push(e)},e.prototype.onControllerFailed=function(e,t){this.logger.error("".concat(e.constructor.moduleName," failed, reason: ").concat(t))},e.prototype.checkDestroyed=function(e){var t=e.constructor.moduleName;if(this.destroyed)throw e.destroy(),new Error("TVK has been destroyed, ".concat(t," initialization is aborted"))},e.prototype.prepareConfig=function(e){var t=defaultTVKConfig;return Object.assign({},t,e)},e.prototype.initDebugMode=function(){var e=!1;try{e=!!lsTool.getData("__thumbplayer_tvk_debug")}catch(e){this.logger.log("failed to get debug mode from local storage")}(this.config.debug||e)&&(window.tvk=this)},e.prototype.on=function(e,t){this.message.on(e,t)},e.prototype.off=function(e,t){this.message.off(e,t)},e.prototype.emit=function(e){for(var t,o,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];(t=this.message).emit.apply(t,__spreadArray([e],r,!1)),(o=this.player.pluginMsg).emit.apply(o,__spreadArray([e],r,!1))},e.prototype.removeAllListeners=function(){this.message.removeAllListeners()},e}();function enableTVK(e,t){return void 0===t&&(t={}),new TVK(e,t)}var TVK$1=Object.freeze({__proto__:null,AudioTrackController:AudioTrackController,get COOKIE_NAME(){return COOKIE_NAME},get DRM_CODE_FROM_VINFO(){return DRM_CODE_FROM_VINFO},get DRM_REQUEST_VALUE(){return DRM_REQUEST_VALUE},DefinitionController:DefinitionController,get LOGIN_METHOD(){return LOGIN_METHOD},LiveGetInfo:LiveGetInfo,get PAID_FORMAT(){return exports.PAID_FORMAT},TVK:TVK,UnifiedLiveGetInfo:UnifiedLiveGetInfo,VQQ_COOKIE_PREFIX:VQQ_COOKIE_PREFIX,VodGetInfo:VodGetInfo,commonSelectKernel:commonSelectKernel,enableTVK:enableTVK,getRequestParamForDRM:getRequestParamForDRM,getRequestParamForPaidFormat:getRequestParamForPaidFormat,getUserCookies:getUserCookies}),webAdVersion="3.2.30",h5AdVersion="3.2.30",adGlobalName="CreativePlayerPlugin",adVersion=uaTool.mobile?h5AdVersion:webAdVersion,adScriptMaxLoadTime=1e4,skipAdDomainWhiteList=["e.news.qq.com"],isInDomainWhiteList=skipAdDomainWhiteList.includes(window.location.hostname),ErrorPagePluginName="error-page",ErrorPagePluginEvents={REPORT_LOG:"error-page:report-log"},defaultErrorText="出错啦",defaultErrorMsg="这个视频被外星人劫走，暂时看不了了~",dataRoleMap={error:"txp-ui-error",errorMsg:"txp-ui-error-msg",errorHandler:"txp-ui-error-handler",errorRefresh:"txp-ui-error-refresh",errorCode:"txp-ui-error-code",background:"txp-ui-error-background",clientBtn:"txp-ui-error-client-btn",browserTip:"txp-ui-error-browser"},__assign=function(){return __assign=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},__assign.apply(this,arguments)};exports.HOTPOINT_EVENTS=void 0,function(e){e.HOT_MOUSE_OVER="ctrl:hotpoint-mouseover",e.HOT_MOUSE_MOVE="ctrl:hotpoint-mousemove",e.HOT_MOUSE_OUT="ctrl:hotpoint-mouseout"}(exports.HOTPOINT_EVENTS||(exports.HOTPOINT_EVENTS={}));var CtrlbarPluginName="ctrlbar",CTRL_EVENTS=__assign(__assign({FULLSCREEN_CHANGE:"windowFullscreenChange",FULLSCREEN_ERROR:"fullscreenError",FAKE_FULLSCREEN_CHANGE:"browserFullscreenChange",CLICK_PIPBTN:"ctrl:click-pipbtn",CLICK_NEXTBTN:"ctrl:click-nextbtn",CLICK_PLAYBTN:"ctrl:click-playbtn",CLICK_REPLAY:"ctrl:click-replay",SET_LANGUAGE:"ctrl:set-language",SET_LEVEL:"ctrl:set-level",SET_AUDIO:"ctrl:set-audio",SET_PLAYRATE:"ctrl:set-playrate",SET_VOLUME:"ctrl:set-volume",TOGGLE_OVERLAY:"ctrl:toggle-overlay",MOUSE_DONW:"ctrl:progress-mousedown",MOUSE_DOWN:"ctrl:progress-mousedown",MOUSE_MOVE:"ctrl:progress-mousemove",MOUSE_UP:"ctrl:progress-mouseup",SHOW:"ctrl:show",HIDE:"ctrl:hide"},exports.HOTPOINT_EVENTS),{TEST_EVENT:"ctrl:inner-test-event",RESIZE:"ctrl:resize",SHOW_LEVELS:"ctrl:show-levels",HOVER_PROGRESS:"ctrl:hover-progress"}),pcRootClassName=".plugin_ctrl_txp_bottom",mobileRootClassName=".plugin_ctrl_mobile_txp_bottom",getRootClassName=function(e){return e?mobileRootClassName:pcRootClassName},shadowClassName=".plugin_ctrl_txp_shadow",gradientClassName=".plugin_ctrl_txp_gradient_bottom",containerClassName="_mod_thumbplayer_container_",largeSizeClassName="plugin_ctrl--large",bodyOverflowClassName="plugin_ctrl_fake_fullscreen";exports.CTRL_SIZE=void 0,function(e){e.LARGE="large",e.NORMAL="normal"}(exports.CTRL_SIZE||(exports.CTRL_SIZE={})),exports.PlayBtnStatus=void 0,function(e){e.PAUSE="pause",e.PLAY="play",e.REPLAY="replay",e.STOP="stop"}(exports.PlayBtnStatus||(exports.PlayBtnStatus={}));var INFO_SVG_DOM_STR='<div class="txp_info_icon txp_none">\n  <svg\n  viewBox="0 0 1024 1024"\n  version="1.1"\n  xmlns="http://www.w3.org/2000/svg"\n  >\n  <path\n    d="M512 958.016C266.08 958.016 65.984 757.952 65.984 512 65.984 266.08 266.08 65.984 512 65.984c245.952 0 446.016 200.064 446.016 446.016C958.016 757.952 757.952 958.016 512 958.016zM512 129.984C301.344 129.984 129.984 301.344 129.984 512c0 210.624 171.36 382.016 382.016 382.016 210.624 0 382.016-171.36 382.016-382.016C894.016 301.344 722.624 129.984 512 129.984z"\n  ></path>\n  <path\n    d="M512 304m-48 0a1.5 1.5 0 1 0 96 0 1.5 1.5 0 1 0-96 0Z"\n  ></path>\n  <path\n    d="M512 768c-17.664 0-32-14.304-32-32l0-288c0-17.664 14.336-32 32-32s32 14.336 32 32l0 288C544 753.696 529.664 768 512 768z"\n  ></path>\n  </svg>\n</div>\n',InfoPanelPluginName="info-panel",InfoPanelEvents={CLICK_UPLOAD:"contextmenu:click-upload"},DEFAULT_SHOW_QUERY="show_info_panel",PosterPluginName="poster",hideClass="txp_none",POSTER_IMAGE_ALT="Thumbplayer Poster Plugin Image",POSTER_IMAGE_CLASS_NAME="txp_poster_img",defaultShowTime=3,classNameOnCtrlHide="ctrl_hide",classNameOnCtrlResize="ctrl_resize",TipsPluginName="tips",UIContextMenuPluginName="context-menu",WaterMarkCoverClassName="thumbplayer-watermark-cover",WatermarkPluginName="ui-watermark",MaxRequestRetry=3,RequestTimeout=5e3;exports.WatermarkError=void 0,function(e){e.ActionWatermarkRequestFailed="001"}(exports.WatermarkError||(exports.WatermarkError={}));var PLUGINS_URL="//vm.gtimg.cn/thumbplayer/plugins/thumbplayer-plugin-super-player-plugins/".concat("1.4.197","/index.min.js"),LAZY_PLUGINS=[TipsPluginName,ErrorPagePluginName,PosterPluginName,CtrlbarPluginName,InfoPanelPluginName,WatermarkPluginName,UIContextMenuPluginName],PLAY_CODEC={AUTO:0,H264:1,H265:2},HEVC_LV_VALUE,SUPER_END_STATE,SUPER_DATA_KEY;exports.HEVC_LV_VALUE=void 0,HEVC_LV_VALUE=exports.HEVC_LV_VALUE||(exports.HEVC_LV_VALUE={}),HEVC_LV_VALUE[HEVC_LV_VALUE.AUTO=void 0]="AUTO",HEVC_LV_VALUE[HEVC_LV_VALUE.NOT_SPT=0]="NOT_SPT",HEVC_LV_VALUE[HEVC_LV_VALUE.SD=11]="SD",HEVC_LV_VALUE[HEVC_LV_VALUE.HD=16]="HD",HEVC_LV_VALUE[HEVC_LV_VALUE.SHD=21]="SHD",HEVC_LV_VALUE[HEVC_LV_VALUE.FHD=26]="FHD",HEVC_LV_VALUE[HEVC_LV_VALUE.UHD=28]="UHD",HEVC_LV_VALUE[HEVC_LV_VALUE.UHD_ONLY=31]="UHD_ONLY",exports.SUPER_END_STATE=void 0,SUPER_END_STATE=exports.SUPER_END_STATE||(exports.SUPER_END_STATE={}),SUPER_END_STATE.PREVIEW="preview",exports.SUPER_DATA_KEY=void 0,SUPER_DATA_KEY=exports.SUPER_DATA_KEY||(exports.SUPER_DATA_KEY={}),SUPER_DATA_KEY.vodCGIUsed="super:cgiUsed",SUPER_DATA_KEY.getinfoAdInfo="getinfoAdInfo",SUPER_DATA_KEY.hlsAdRanges="hlsAdRanges";var LOCAL_STORAGE_KEY={ENV_CACHE:"__thumbplayer_env_cache",RENDER_STATS_INFO:"__thumbplayer_render_stats_info",DEGRADE_CODEC_TIME:"__thumbplayer_degradecodec_time",DYNAMIC_CONFIG:"__thumbplayer_dynamic_config"},ctrlbarPluginName=CtrlbarPluginName,contextMenuPluginName=UIContextMenuPluginName,SuperPlayerEnum=Object.freeze({__proto__:null,PLAY_CODEC:PLAY_CODEC,get HEVC_LV_VALUE(){return exports.HEVC_LV_VALUE},get SUPER_END_STATE(){return exports.SUPER_END_STATE},get SUPER_DATA_KEY(){return exports.SUPER_DATA_KEY},LOCAL_STORAGE_KEY:LOCAL_STORAGE_KEY,ctrlbarPluginName:ctrlbarPluginName,contextMenuPluginName:contextMenuPluginName,adGlobalName:adGlobalName,adVersion:adVersion,adScriptMaxLoadTime:adScriptMaxLoadTime,skipAdDomainWhiteList:skipAdDomainWhiteList,isInDomainWhiteList:isInDomainWhiteList,CTRL_EVENTS:CTRL_EVENTS,get CTRL_SIZE(){return exports.CTRL_SIZE},CtrlbarPluginName:CtrlbarPluginName,DEFAULT_SHOW_QUERY:DEFAULT_SHOW_QUERY,ErrorPagePluginEvents:ErrorPagePluginEvents,ErrorPagePluginName:ErrorPagePluginName,get HOTPOINT_EVENTS(){return exports.HOTPOINT_EVENTS},INFO_SVG_DOM_STR:INFO_SVG_DOM_STR,InfoPanelEvents:InfoPanelEvents,InfoPanelPluginName:InfoPanelPluginName,MaxRequestRetry:MaxRequestRetry,POSTER_IMAGE_ALT:POSTER_IMAGE_ALT,POSTER_IMAGE_CLASS_NAME:POSTER_IMAGE_CLASS_NAME,get PlayBtnStatus(){return exports.PlayBtnStatus},PosterPluginName:PosterPluginName,RequestTimeout:RequestTimeout,TipsPluginName:TipsPluginName,UIContextMenuPluginName:UIContextMenuPluginName,WaterMarkCoverClassName:WaterMarkCoverClassName,get WatermarkError(){return exports.WatermarkError},WatermarkPluginName:WatermarkPluginName,bodyOverflowClassName:bodyOverflowClassName,classNameOnCtrlHide:classNameOnCtrlHide,classNameOnCtrlResize:classNameOnCtrlResize,containerClassName:containerClassName,dataRoleMap:dataRoleMap,defaultErrorMsg:defaultErrorMsg,defaultErrorText:defaultErrorText,defaultShowTime:defaultShowTime,getRootClassName:getRootClassName,gradientClassName:gradientClassName,hideClass:hideClass,largeSizeClassName:largeSizeClassName,mobileRootClassName:mobileRootClassName,pcRootClassName:pcRootClassName,shadowClassName:shadowClassName,PLUGINS_URL:PLUGINS_URL,LAZY_PLUGINS:LAZY_PLUGINS}),SUPER_EVENTS;exports.SUPER_EVENTS=void 0,SUPER_EVENTS=exports.SUPER_EVENTS||(exports.SUPER_EVENTS={}),SUPER_EVENTS.DEGRADE_CODEC="degradeCodec",SUPER_EVENTS.PREVIEW_START="previewStart",SUPER_EVENTS.PREVIEW_END="previewEnd",SUPER_EVENTS.GET_VIDEO_MARK_ALL_OVER="getVideoMarkAllOver",SUPER_EVENTS.ENTER_HLS_AD="enterHlsAd",SUPER_EVENTS.EXIT_HLS_AD="exitHlsAd";var SuperPlayerEvt=Object.freeze({__proto__:null,get SUPER_EVENTS(){return exports.SUPER_EVENTS}}),coreExportKeys=["PLAY_EVENT","VIDEO_STATE","KERNEL_NAME","PLAY_MODE","END_STATE","EvtEmitter","kernelEvtBus","preloadEvtBus","PAUSE_TYPE","commonTool","uaTool","Logger","cookieTool","lsTool","urlTool","domTool","netTool","videoTool","stringTool","VIDEO_CODEC","AUDIO_CODEC","CONTAINER_FORMAT"],h5ExportKeys=["H5_PLAY_EVENT","COMMON_DATA_KEY","DATA_EVENTS","DRM_TYPE","DRM_VALUE","H5_EXT_EVENT","AdPluginName","FullScreenMode","Plugin"],superPlayerExportKeys=["PLAY_CODEC","CTRL_EVENTS","SUPER_END_STATE","SUPER_EVENTS","ctrlbarPluginName","contextMenuPluginName"],tvkExportKeys=["TVK_EVENTS","TVK_EVENT_DETAILS"],_a,STATE;function bindExports(e){var t=__spreadArray$1(__spreadArray$1(__spreadArray$1(__spreadArray$1([],coreExportKeys,!0),h5ExportKeys,!0),superPlayerExportKeys,!0),tvkExportKeys,!0);(t=t.filter((function(t){return void 0===e[t]}))).forEach((function(t){[ThumbPlayerH5$1,ThumbPlayerCore,SuperPlayerEnum,SuperPlayerEvt,TVK$1].forEach((function(o){(null==o?void 0:o[t])&&(e[t]=o[t])}))}))}!function(e){e[e.enabled=0]="enabled",e[e.disabled=1]="disabled"}(STATE||(STATE={}));var AdType={MidRoll:"ZC",HlsAd:"PHLS",BeforePlay:exports.AD_TYPE.PRE,BeforePlayCodeName:"LD",AfterPlay:exports.AD_TYPE.POST,AfterPlayCodeName:"HT"},AD_INFO_OP_TYPE;!function(e){e[e.HLS_AD=2]="HLS_AD"}(AD_INFO_OP_TYPE||(AD_INFO_OP_TYPE={}));var disabledCtrlBarComps=["playrate","definition","audiotrack","language","PlayBtn","NextBtn","Progress","CtrlShow","PictureInPicture"],disabledCtrlBarCompsWhenHlsAd=["playrate","definition","audiotrack","language"],disabledCtrlBarCompsMap=(_a={},_a[AdType.AfterPlay]=disabledCtrlBarComps,_a[AdType.BeforePlay]=disabledCtrlBarComps,_a[AdType.MidRoll]=disabledCtrlBarComps,_a[AdType.HlsAd]=disabledCtrlBarCompsWhenHlsAd,_a);function parseGetinfoHlsAdRanges(e){var t,o=[];if(!(null==e?void 0:e.adpinfo))return o;var r=null;try{r=JSON.parse(e.adpinfo)}catch(e){}return null===(t=null==r?void 0:r.plugin_info)||void 0===t||t.forEach((function(e){+e.optype===AD_INFO_OP_TYPE.HLS_AD&&o.push({start:e.ad_offset_time,end:e.ad_offset_time+e.ad_dura})})),o}var AdLogic=function(){function e(e,t){var o=this;this.player=e,this.corePlayer=t,this.isHlsAdPlaying=!1,this.adSlotInfo=[],this.logger=new Logger(this.player.config.instanceId,"AdLogic"),this.setEvts(!0),this.player.pluginMsg.once("pluginsetup:".concat(AdPluginName),(function(){var e,t;o.adPlugin=getAdPlugin(o.player.config.instanceId),uaTool.browser.safari&&(null===(t=(e=o.adPlugin).setPhlsPlayType)||void 0===t||t.call(e)),o.setAdPluginEvts(!0)}))}return e.prototype.destroy=function(){getAdPlugin(this.player.config.instanceId)&&this.setAdPluginEvts(!1),this.setEvts(!1),this.player=null,this.corePlayer=null},e.prototype.setEvts=function(e){var t,o,r=this;this.evtMap||(this.evtMap={player:(t={},t[exports.H5_PLAY_EVENT.AD_PLAYING]=this.onAdPlaying.bind(this),t[exports.H5_PLAY_EVENT.AD_END]=this.onAdEnd.bind(this),t[exports.H5_PLAY_EVENT.AD_AUTOPLAY_BLOCKED]=this.onAdAutoplayBlocked.bind(this),t[exports.H5_PLAY_EVENT.VIDEO_TIMEUPDATE]=this.onVideoTimeUpdate.bind(this),t[exports.H5_PLAY_EVENT.AD_PAUSE]=this.onAdPaused.bind(this),t[exports.H5_PLAY_EVENT.AD_RESUME]=this.onAdResume.bind(this),t[exports.PLAY_EVENT.ENTER_INSERT_STREAM]=this.onEnterInsertStream.bind(this),t[exports.PLAY_EVENT.EXIT_INSERT_STREAM]=this.onExitInsertStream.bind(this),t),adPlugin:{enterCountdownCompleteEvt:this.onWillPlayMidRollAd.bind(this),enterCountdownEvt:this.onEnterMidRollAdCountdown.bind(this)},msg:(o={},o[exports.PLAY_EVENT_EXT.GETINFO_OVER]=this.onVideoReqInfoEnd.bind(this),o)});var n=e?this.player.on:this.player.off;Object.keys(this.evtMap.player).forEach((function(e){n.apply(r.player,[e,r.evtMap.player[e]])}));var i=e?this.player.on:this.player.off;Object.keys(this.evtMap.msg).forEach((function(e){i.apply(r.player.pluginMsg,[e,r.evtMap.msg[e]])}))},e.prototype.setAdPluginEvts=function(e){var t=this,o=getAdPlugin(this.player.config.instanceId),r=e?o.on:o.off;Object.keys(this.evtMap.adPlugin).forEach((function(e){r.apply(o,[e,t.evtMap.adPlugin[e]])}))},e.prototype.onAdPlaying=function(e){var t,o,r,n,i=this;null===(r=((t={})[AdType.BeforePlay]=function(){return i.setCtrlBarState(STATE.disabled,AdType.BeforePlay)},t[AdType.MidRoll]=function(){return i.setCtrlBarState(STATE.disabled,AdType.MidRoll)},t[AdType.AfterPlay]=function(){return i.setCtrlBarState(STATE.disabled,AdType.AfterPlay)},t)[null===(o=e.data)||void 0===o?void 0:o.adType])||void 0===r||r.apply(this),null===(n=this.player.loadingPlugin)||void 0===n||n.hide()},e.prototype.onAdPaused=function(){var e=this.player.ctrlbarPlugin;e&&!uaTool.mobile&&(e.show(!0),e.setCompDisable("PlayBtn",!1))},e.prototype.onAdResume=function(e){var t=e.data.adtype,o=[AdType.AfterPlayCodeName,AdType.MidRoll,AdType.BeforePlayCodeName],r=this.player.ctrlbarPlugin;r&&!uaTool.mobile&&o.includes(t)&&r.setCompDisable("PlayBtn")},e.prototype.onAdEnd=function(e){var t,o,r,n=this;null===(r=((t={})[AdType.BeforePlay]=function(){return n.setCtrlBarState(STATE.enabled,AdType.BeforePlay)},t[AdType.MidRoll]=function(){n.setCtrlBarState(STATE.enabled,AdType.MidRoll),n.player.play()},t[AdType.AfterPlay]=function(){return n.setCtrlBarState(STATE.enabled,AdType.AfterPlay)},t)[null===(o=e.data)||void 0===o?void 0:o.adType])||void 0===r||r.apply(this)},e.prototype.onAdAutoplayBlocked=function(e){var t;if(e.data.adType===AdType.BeforePlay){null===(t=this.player.loadingPlugin)||void 0===t||t.hide();var o=this.player.ctrlbarPlugin;o&&(o.show(!0),o.setCompDisable("PlayBtn",!1),o.setCompDisable(["PictureInPicture","playrate"],!0))}},e.prototype.onWillPlayMidRollAd=function(){this.player.pause(),getAdPlugin(this.player.config.instanceId).playAd({adType:AdType.MidRoll})},e.prototype.onEnterMidRollAdCountdown=function(){this.setCtrlBarState(STATE.disabled,AdType.MidRoll)},e.prototype.setCtrlBarState=function(e,t){var o=this.player.plugins[CtrlbarPluginName];if(o){var r=disabledCtrlBarCompsMap[t];if(o.setCompDisable(r,!!e),t===AdType.HlsAd);else o.setHotKeysDisable(!!e)}},e.prototype.onVideoReqInfoEnd=function(e){var t,o,r,n,i=e.data,a=((null==i?void 0:i.parseData)||{}).vitem;if(!(null==i?void 0:i.error)){if(!a||!a.ad)return this.player.setCommonKv(exports.SUPER_DATA_KEY.hlsAdRanges,null),void this.player.setCommonKv(exports.SUPER_DATA_KEY.getinfoAdInfo,null);var s=parseGetinfoHlsAdRanges(a.ad);this.player.setCommonKv(exports.SUPER_DATA_KEY.hlsAdRanges,s),this.player.setCommonKv(exports.SUPER_DATA_KEY.getinfoAdInfo,a.ad),this.adSlotInfo=comTool.mergeTimeRanges(null!==(n=null===(r=null===(o=null===(t=i.parseData)||void 0===t?void 0:t.supplementaryInfo)||void 0===o?void 0:o.contentInfo)||void 0===r?void 0:r.ad)&&void 0!==n?n:[]),this.logger.log("hlsAdRanges from getinfo is ",s)}},e.prototype.onVideoTimeUpdate=function(e){var t=(e.data||{}).playtime;uaTool.browser.safari||t<=0||this.checkWhetherEnterOrExitHlsAd(t)},e.prototype.checkWhetherEnterOrExitHlsAd=function(e){var t=this.player.getCommonKv(exports.SUPER_DATA_KEY.hlsAdRanges);if(!t||t.length<=0)this.exitHlsAd();else{var o=t.find((function(t){return t.start<=e&&e<=t.end}));!this.isHlsAdPlaying&&o?this.enterHlsAd(e,o):this.isHlsAdPlaying&&!o&&this.exitHlsAd()}},e.prototype.enterHlsAd=function(e,t){this.isHlsAdPlaying||(this.logger.log("enter hlsAd, playtime=".concat(e,", range="),t),this.isHlsAdPlaying=!0,this.player.emit(exports.SUPER_EVENTS.ENTER_HLS_AD,{hlsAdRange:t}))},e.prototype.exitHlsAd=function(){this.isHlsAdPlaying&&(this.logger.log("exit hlsAd...."),this.isHlsAdPlaying=!1,this.player.emit(exports.SUPER_EVENTS.EXIT_HLS_AD))},e.prototype.onEnterInsertStream=function(e){var t,o,r,n,i=(null!==(t=null==e?void 0:e.data)&&void 0!==t?t:{}).index;this.logger.log("enter insert stream",this.adSlotInfo[i]);var a=null===(o=this.adSlotInfo)||void 0===o?void 0:o[i];a&&(this.setCtrlBarState(STATE.disabled,AdType.HlsAd),null===(n=null===(r=this.adPlugin)||void 0===r?void 0:r.startSoloPlayPhls)||void 0===n||n.call(r,a.start),this.player.emit(exports.H5_PLAY_EVENT.AD_PLAYING,{adType:AdType.HlsAd}))},e.prototype.onExitInsertStream=function(e){var t,o,r,n=(null!==(t=null==e?void 0:e.data)&&void 0!==t?t:{}).index;this.logger.log("exit insert stream",this.adSlotInfo[n]),this.setCtrlBarState(STATE.enabled,AdType.HlsAd),null===(r=null===(o=this.adPlugin)||void 0===o?void 0:o.endSoloPlayPhls)||void 0===r||r.call(o),this.player.emit(exports.H5_PLAY_EVENT.AD_END,{code:exports.ErrorCode.SUC,adType:AdType.HlsAd})},e}(),PosterLogic=function(){function e(e){this.player=e,this.hasPostAdInPlaySession=!1,this.setEvts(!0),this.showDefaultPoster()}return e.prototype.destroy=function(){this.setEvts(!1),this.player=null},e.prototype.showDefaultPoster=function(){var e=this,t=this.player.config,o=t.videoId,r=t.type,n=t.lazyInitPlugins,i=t.videoInitConfig,a=o;if(i)if("string"==typeof i)a=i;else{var s=i.vid;s&&(a=s)}var l=function(){r===exports.PLAY_MODE.VOD&&a&&e.showPoster(a)};n?this.player.pluginMsg.once("pluginsetup:".concat(PosterPluginName),(function(){l()})):l()},e.prototype.showPoster=function(e){var t=this.player.config,o=t.poster,r=t.disablePoster,n=t.type,i=this.player.getPlugin(PosterPluginName);!r&&i&&((null==o?void 0:o.src)?i.show(o.src):n!==exports.PLAY_MODE.VOD?i.show("https://puui.qpic.cn/vupload/0/20171225_1514277750947.jpeg/0"):e&&"string"==typeof e&&i.showByVid(__assign$2(__assign$2({},o),{vid:e})))},e.prototype.setEvts=function(e){var t,o=this;this.evtMap||(this.evtMap=((t={})[exports.H5_PLAY_EVENT.AD_AUTOPLAY_BLOCKED]=this.onAdAutoplayBlocked.bind(this),t[exports.H5_PLAY_EVENT.AD_PLAYING]=this.onAdPlaying.bind(this),t[exports.H5_PLAY_EVENT.PLAY_SESSION_END]=this.onPlaySessionEnd.bind(this),t));var r=e?this.player.on:this.player.off;Object.keys(this.evtMap).forEach((function(e){r.apply(o.player,[e,o.evtMap[e]])}))},e.prototype.onAdAutoplayBlocked=function(e){e.data.adType===exports.AD_TYPE.PRE&&this.showPoster(this.player.vid)},e.prototype.onAdPlaying=function(e){e.data.adType===exports.AD_TYPE.POST&&(this.hasPostAdInPlaySession=!0)},e.prototype.waitSessionStart=function(){var e=this;return new Promise((function(t){var o=function(){return t(!0)};e.player.once(exports.H5_PLAY_EVENT.PLAY_SESSION_START,o),setTimeout((function(){var r;null===(r=e.player)||void 0===r||r.off(exports.H5_PLAY_EVENT.PLAY_SESSION_START,o),t(!1)}),SESSION_DURATION)}))},e.prototype.onPlaySessionEnd=function(e){var t=e.data;return __awaiter$1(this,void 0,void 0,(function(){var e,o;return __generator$1(this,(function(r){switch(r.label){case 0:return e=t.curFlowNodeName,o=t.endState,this.hasPostAdInPlaySession?(this.hasPostAdInPlaySession=!1,this.showPoster(this.player.vid),[2]):AD_FLOW_NODE_NAME_REG.test(e)&&o!==exports.END_STATE.NORMAL?[4,this.waitSessionStart()]:[3,2];case 1:!r.sent()&&this.showPoster(this.player.vid),r.label=2;case 2:return[2]}}))}))},e}(),AD_FLOW_NODE_NAME_REG=/AdFlowNode/i,SESSION_DURATION=400,UrlParamKey;function checkParams(e,t,o){if(t&&o)for(var r=i18nConfig.superPlayer,n=[{checker:function(){return e===exports.PLAY_MODE.LIVE&&"load"===t},msg:compile(r.ERROR_LOAD_PARAM_NOT_SUPPORT)},{checker:function(){return e===exports.PLAY_MODE.LIVE&&"play"===t&&o.vid},msg:compile(r.ERROR_VID_NOT_SUPPORT)},{checker:function(){return e===exports.PLAY_MODE.VOD&&o.cnlid},msg:compile(r.ERROR_CNLID_NOT_SUPPORT)},{checker:function(){return o.vid&&!/^\w{11}$/.test(o.vid)},msg:compile(r.ERROR_VID_INVALID)}],i=0,a=n.length;i<a;i++)if(n[i].checker())throw new Error(n[i].msg)}function formatDefnName(e,t){if(void 0===t&&(t=!1),t)return formatLiveDefnName(e);var o=null==e?void 0:e.match(/(.*);\((.*)\)/);return(null==o?void 0:o.length)>=3?[o[1],o[2]]:[null!=e?e:"",""]}function formatLiveDefnName(e){var t=e.split(" ");return[t[0],t[1]]}function getIsOfficialScenes(){return[/^http(s?):\/\/v\.qq(\.com)\/x\/(cover|page)\//.test(location.href),uaTool.browser.qqlive].some((function(e){return e}))}function isOfficialDomain(){return/^http(s?):\/\/(.*)\.(qq|woa|oa)\.com/.test(location.href)}function getTxVideoPageURLByVid(e,t,o){if(!e)return"";t="0"!==t?"_".concat(t):"";var r=e.substr(0,1),n=e.substr(e.length-2,1),i=e.substr(e.length-1,1),a="".concat("//v.qq.com/page","/").concat(r,"/").concat(n,"/").concat(i,"/").concat(e).concat(t,".html");return o&&(a+="?start=".concat(o)),a}function getEnvVals(){var e="npm";try{e="cdn"}catch(e){}var t="";try{t="1.15.22"}catch(e){}var o="";try{o="1678263458113"}catch(e){}var r=!1;try{r="1"===process.env.__LOCAL_DEV__}catch(e){}return{CHANNEL:e,VERSION:t,BUILD_TIME:o,LOCAL_DEV:r}}function getDebugModeFromUrl(){return"1"===urlTool.getUrlParamByKey(location.href,UrlParamKey.debugSuper)}function getLogLevelFromUrl(){var e=+urlTool.getUrlParamByKey(location.href,UrlParamKey.logLevel);return isNaN(e)?PLAYER_LOG_LEVEL.NONE:e}function getForceCodecFromUrl(){return urlTool.getUrlParamByKey(location.href,UrlParamKey.forceCodec)}!function(e){e.debugSuper="__debugSuper",e.logLevel="__logLevel",e.downloadKit="__downloadKit",e.forceCodec="__forceCodec"}(UrlParamKey||(UrlParamKey={}));var PreviewLogic=function(){function e(e){var t=this;this.player=e,this.previewDuration=NO_PREVIEW_FLAG,this.isPreviewEnd=!1,this.lastHotKeysDisabled=!1,this.lastCtrlShowDisabled=!1,this.previewStartTimeOnLive=0,this.previewRemainCount=0,this.onVideoSessionStart=function(){t.ctrlPlugin&&t.isVod&&(t.ctrlPlugin.duration=void 0)},this.onVideoReqInfoEnd=function(e){var o=e.data,r=o.code,n=o.data;if(r===exports.ErrorCode.SUC){var i=(null==n?void 0:n.parseData)||{},a=i.preview,s=i.duration,l=i.previewRemainCount;Number.isNaN(a)||a<=0||(t.previewDuration=a,t.previewRemainCount=l,t.isVod?(t.showTips(),t.ctrlPlugin&&(t.player.ctrlbarPlugin.duration=uaTool.mobile?t.previewDuration:s,uaTool.mobile||t.setCtrlMaxPercent(a/s))):t.showTips(),t.player.emit(exports.SUPER_EVENTS.PREVIEW_START,{previewDuration:a}))}},this.onVideoPlaying=function(e){if(e.data.isFirst&&(t.previewStartTimeOnLive=+new Date),t.isPreviewEnd){if(t.isPreviewEnd=!1,!t.ctrlPlugin)return;t.restoreCtrlBarAction()}},this.onVideoTimeUpdate=function(e){var o=e.data.playtime;(t.isVod?t.checkPreviewOverOnVodMode(o):t.checkPreviewOverOnLiveMode())&&(t.isPreviewEnd=!0,t.player.emit(exports.SUPER_EVENTS.PREVIEW_END,{previewDuration:t.previewDuration,previewRemainCount:t.previewRemainCount}))},this.onPlaySessionEnd=function(){var e;t.previewDuration!==NO_PREVIEW_FLAG&&(null===(e=t.player.tipsPlugin)||void 0===e||e.hide()),t.previewDuration=NO_PREVIEW_FLAG,t.previewStartTimeOnLive=0,t.ctrlPlugin&&(t.setCtrlMaxPercent(1),t.restoreCtrlBarAction())},this.onVideoPause=function(){t.isPreviewEnd&&t.setCtrlPlayBtnStatus(exports.PlayBtnStatus.REPLAY)},this.setPreviewListener(!0)}return e.prototype.destroy=function(){this.setPreviewListener(!1),this.player=null},e.prototype.setPreviewListener=function(e){var t=e?this.player.on.bind(this.player):this.player.off.bind(this.player);t(exports.H5_PLAY_EVENT.PLAY_SESSION_START,this.onVideoSessionStart),t(exports.H5_PLAY_EVENT.VIDEO_REQ_INFO_END,this.onVideoReqInfoEnd),t(exports.H5_PLAY_EVENT.VIDEO_PLAYING,this.onVideoPlaying),t(exports.H5_PLAY_EVENT.VIDEO_TIMEUPDATE,this.onVideoTimeUpdate),t(exports.H5_PLAY_EVENT.VIDEO_PAUSE,this.onVideoPause),t(exports.H5_PLAY_EVENT.PLAY_SESSION_END,this.onPlaySessionEnd)},e.prototype.checkPreviewOverOnVodMode=function(e){var t=this;return!(this.previewDuration===NO_PREVIEW_FLAG||e<this.previewDuration||this.isPreviewEnd)&&(uaTool.mobile?setTimeout((function(){t.player.corePlayer.stop(exports.SUPER_END_STATE.PREVIEW)})):(this.player.pause(),this.disableCtrlAction()),!0)},e.prototype.checkPreviewOverOnLiveMode=function(){var e=this;return!(this.previewDuration===NO_PREVIEW_FLAG||this.previewStartTimeOnLive<=0||this.isPreviewEnd||+new Date-this.previewStartTimeOnLive<=1e3*this.previewDuration)&&(setTimeout((function(){e.player.corePlayer.stop(exports.SUPER_END_STATE.PREVIEW)})),!0)},e.prototype.setCtrlPlayBtnStatus=function(e){var t,o,r=null===(o=null===(t=this.ctrlPlugin)||void 0===t?void 0:t.instances)||void 0===o?void 0:o.PlayBtn;r&&(r.el.dataset.status=e)},e.prototype.setCtrlMaxPercent=function(e){var t,o;void 0===e&&(e=1);var r=null===(o=null===(t=this.ctrlPlugin)||void 0===t?void 0:t.instances)||void 0===o?void 0:o.Progress;r&&(r.maxPercent=e)},e.prototype.disableCtrlAction=function(){this.ctrlPlugin&&(this.lastHotKeysDisabled=this.ctrlPlugin.getIsHotKeysDisabled(),this.lastCtrlShowDisabled=this.ctrlShow.shadowClickDisabled,this.ctrlShow.shadowClickDisabled=!0,this.ctrlPlugin.setHotKeysDisable(!0))},e.prototype.restoreCtrlBarAction=function(){this.ctrlPlugin&&(this.ctrlPlugin.setHotKeysDisable(this.lastHotKeysDisabled),this.ctrlShow.shadowClickDisabled=this.lastCtrlShowDisabled)},e.prototype.showTips=function(){var e;if(!getIsOfficialScenes()){var t=comTool.formatPlayTime(this.previewDuration),o=getTxVideoPageURLByVid(this.player.vid,"0");null===(e=this.player.tipsPlugin)||void 0===e||e.show({text:compile(i18nConfig.superPlayer.PREVIEW_TIPS,t,o),time:-1})}},Object.defineProperty(e.prototype,"isVod",{get:function(){return this.player.config.type===exports.PLAY_MODE.VOD},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ctrlShow",{get:function(){var e,t;return null===(t=null===(e=this.ctrlPlugin)||void 0===e?void 0:e.instances)||void 0===t?void 0:t.CtrlShow},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ctrlPlugin",{get:function(){return this.player.plugins[CtrlbarPluginName]},enumerable:!1,configurable:!0}),e}(),NO_PREVIEW_FLAG=0,PROXY_HTTP_PATH={COMMON:["//vd6.l.qq.com/proxyhttp","//vi.l.qq.com/proxyhttp"]},DEFAULT_CONFIG={retryCount:3},PROXY_HTTP_REQ_BUID;!function(e){e.onlyvinfo="onlyvinfo",e.onlyad="onlyad",e.vinfoad="vinfoad"}(PROXY_HTTP_REQ_BUID||(PROXY_HTTP_REQ_BUID={}));var PROXY_HTTP_CODE={NET:"70015001",TIMEOUT:"70015002",RES_CODE:"70015003"},FORMAT,REQ_VOD_STREAM_TYPE,DEGRADE_CODEC_REASON;!function(e){e.SD="sd",e.HD="hd",e.SHD="shd",e.FHD="fhd",e.UHD="uhd",e.DOLBY="dolby",e.HDR10="hdr10",e.SFR_HDR="sfr_hdr"}(FORMAT||(FORMAT={})),function(e){e[e.mp4=1]="mp4",e[e.hls=3]="hls"}(REQ_VOD_STREAM_TYPE||(REQ_VOD_STREAM_TYPE={})),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.FRAME_DROP=1]="FRAME_DROP",e[e.WASM_RENDER=2]="WASM_RENDER",e[e.WASM_SPT_ERR=3]="WASM_SPT_ERR",e[e.ORG_SPT_ERR=4]="ORG_SPT_ERR",e[e.USER=5]="USER"}(DEGRADE_CODEC_REASON||(DEGRADE_CODEC_REASON={}));var DROP_FRAME_COUNT=60,PLAY_TIME_2_BUFFER_MIN_GAP=3,RetryNames={CheckFrameDropRate:"CheckFrameDropRate",CheckNoH264Error:"CheckNoH264Error",CheckOriginPlayHevcError:"CheckOriginPlayHevcError",CheckRenderPerformance:"CheckRenderPerformance",CheckSafariHlsError:"CheckSafariHlsError",CheckWasmError:"CheckWasmError"},SuperBaseCheck=function(e){function t(t){var o=e.call(this,t)||this;return o.isRetryedInSession=!1,o.superPlayer=t,o}return __extends$1(t,e),t.prototype.onSessionStart=function(){this.isRetryedInSession=!1},t.prototype.getRetryConfig=function(t,o){var r,n=null===(r=e.prototype.getRetryConfig)||void 0===r?void 0:r.call(this,t),i=o||{},a=i.degradeCodecExpireTime,s=void 0===a?0:a,l=i.degradeReason,c=void 0===l?DEGRADE_CODEC_REASON.UNKNOWN:l;return n&&c!==DEGRADE_CODEC_REASON.UNKNOWN&&this.canDegradeCodecDefn()?n.updatePlayParam.videoReqInfoParam.hevclv=exports.HEVC_LV_VALUE.NOT_SPT:(s=0,c=DEGRADE_CODEC_REASON.UNKNOWN),__assign$2(__assign$2({},n),{degradeCodecExpireTime:s,degradeReason:c})},t.prototype.canDegradeCodecDefn=function(e){return e||(e=this.superPlayer.getCommonKv(COMMON_DATA_KEY.currentDefn)),-1!==[FORMAT.SD,FORMAT.HD,FORMAT.SHD,FORMAT.FHD].indexOf(e)},t}(BaseCheck),CheckFrameDropRate=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name=RetryNames.CheckFrameDropRate,t.checkEvt=exports.PLAY_EVENT.TIME_UPDATE,t.intervalFrameDroppedArr=[],t}return __extends$1(t,e),t.prototype.check=function(e){return this.needIgnore(e)||this.needIgnoreBecausePlayTimeCloseToBuffer()?null:this.checkFrameDrop()?this.getRetryConfig(e.data.videoInfo,{degradeCodecExpireTime:this.superPlayer.config.maxDegradeCodecExpireTime,degradeReason:DEGRADE_CODEC_REASON.FRAME_DROP}):null},t.prototype.needIgnore=function(e){var t=e.data.videoInfo;return!(this.superPlayer.config.enableDegradeOnLowPerformance&&this.player&&this.player.currentVideoInfo&&t.config.vcodec!==CODEC.H264&&this.player.kernelName!==exports.KERNEL_NAME.WASM&&this.canDegradeCodecDefn())||!!this.isRetryedInSession},t.prototype.needIgnoreBecausePlayTimeCloseToBuffer=function(){for(var e=this.player,t=e.playtime,o=e.videoBuffered,r=0;r<o.length;r++)if(Math.abs(o[r].end-t)<PLAY_TIME_2_BUFFER_MIN_GAP)return!0;return!1},t.prototype.checkFrameDrop=function(){var e,t=this.superPlayer.config.maxFrameDropRate,o=((null===(e=this.player.currentVideoInfo)||void 0===e?void 0:e.qualityInfo)||{}).intervalFrameDropped,r=void 0===o?0:o;if(this.intervalFrameDroppedArr.push(r),this.intervalFrameDroppedArr.length>=DROP_FRAME_COUNT){var n=this.intervalFrameDroppedArr.reduce((function(e,t){return e+t}))/DROP_FRAME_COUNT,i=[].concat(this.intervalFrameDroppedArr);if(this.intervalFrameDroppedArr.length=0,n>=t)return this.logger.log("dropframe rate ".concat(n," is more than ").concat(t,"\n        intervalFrameDroppedArrForLog=").concat(i)),this.isRetryedInSession=!0,!0}return!1},t}(SuperBaseCheck),CheckNoH264Error=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name=RetryNames.CheckNoH264Error,t.checkEvt=exports.PLAY_EVENT.ERROR,t}return __extends$1(t,e),t.prototype.check=function(e){var t,o,r=e.data.videoInfo,n=r.error,i=this.superPlayer.config.enableDegradeOnLowPerformance;if(this.isRetryedInSession)return null;if(!r.config||r.config.vcodec===CODEC.H264||!i)return null;var a=null===(o=null===(t=n.code)||void 0===t?void 0:t.split)||void 0===o?void 0:o.call(t,".")[0];return a!==ERROR_CODE.MEDIA_ERR_DECODE&&a!==ERROR_CODE.MEDIA_ERR_SRC_NOT_SUPPORTED?null:(this.isRetryedInSession=!0,this.getRetryConfig(r,{degradeCodecExpireTime:0,degradeReason:DEGRADE_CODEC_REASON.ORG_SPT_ERR}))},t}(SuperBaseCheck),CheckOriginPlayHevcError=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name=RetryNames.CheckOriginPlayHevcError,t.checkEvt=exports.PLAY_EVENT.ERROR,t}return __extends$1(t,e),t.prototype.check=function(e){var t,o=e.data.videoInfo,r=o.playtime,n=o.error;if(this.isRetryedInSession)return null;var i=null===(t=null==n?void 0:n.code)||void 0===t?void 0:t.split(".")[0];return!this.superPlayer.config.retryHevcByWasmIfOriginErr||!o.config||o.config.vcodec!==CODEC.H265||this.player.kernelName===exports.KERNEL_NAME.WASM||i!==ERROR_CODE.MEDIA_ERR_DECODE&&i!==ERROR_CODE.MEDIA_ERR_SRC_NOT_SUPPORTED?null:(this.isRetryedInSession=!0,{error:n,updatePlayParam:{videoLoadParam:{startTime:r,kernelName:exports.KERNEL_NAME.WASM}}})},t}(SuperBaseCheck),CheckRenderPerformance=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name=RetryNames.CheckRenderPerformance,t.checkEvt=exports.PLAY_EVENT.VIDEO_FRAME_RENDER,t.lowRenderFrameCount=0,t.lowRenderFrameTimeCostArr=[],t.renderTotalCount=0,t}return __extends$1(t,e),t.prototype.onSessionStart=function(){this.lowRenderFrameCount=0,this.renderTotalCount=0,e.prototype.onSessionStart.call(this)},t.prototype.check=function(e){var t=this.superPlayer.config,o=t.minRenderFrameRate,r=t.maxLowRenderFrameRate,n=t.enableDegradeOnLowPerformance,i=t.maxDegradeCodecExpireTime,a=e.data.videoInfo;if(!n||!(o<1&&o>0&&r<1&&r>0)||this.player.kernelName!==exports.KERNEL_NAME.WASM||!this.canDegradeCodecDefn())return null;var s=(this.player.currentVideoInfo||{}).videoFrameRate;if(!s||s<0)return null;if(this.isRetryedInSession)return null;var l=1e3/s*o,c=e.data.renderCostTime;if(this.lowRenderFrameTimeCostArr.push(c),c<l&&this.lowRenderFrameCount++,this.renderTotalCount++,this.renderTotalCount>=1e3){var p=this.recordStats(),d=this.lowRenderFrameCount/this.renderTotalCount;if(this.renderTotalCount=0,this.lowRenderFrameCount=0,d>r)return this.logger.log("low render frame rate ".concat(d," is more than ").concat(r)),this.writeStats(p),this.isRetryedInSession=!0,this.getRetryConfig(a,{degradeCodecExpireTime:i,degradeReason:DEGRADE_CODEC_REASON.WASM_RENDER})}return null},t.prototype.recordStats=function(){var e=this.superPlayer.config,t=e.minRenderFrameRate,o=e.maxLowRenderFrameRate,r={lowRenderFrameTimeCostArr:this.lowRenderFrameTimeCostArr.slice(-200),lowRenderFrameCount:this.lowRenderFrameCount,renderTotalCount:this.renderTotalCount,maxLowRenderFrameRate:o,minRenderFrameRate:t};return this.lowRenderFrameTimeCostArr.length=0,r},t.prototype.writeStats=function(e){try{var t=JSON.stringify(e);lsTool.setData(LOCAL_STORAGE_KEY.RENDER_STATS_INFO,t)}catch(e){}},t}(SuperBaseCheck),CheckSafariHlsError=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name=RetryNames.CheckSafariHlsError,t.checkEvt=exports.PLAY_EVENT.ERROR,t}return __extends$1(t,e),t.prototype.check=function(e){var t,o,r=e.data.videoInfo,n=r.playtime,i=r.error;if(this.isRetryedInSession)return null;var a=null===(t=null==i?void 0:i.code)||void 0===t?void 0:t.split(".")[0];return uaTool.browser.safari&&this.player.kernelName===exports.KERNEL_NAME.HLS_JS&&(null===(o=r.config)||void 0===o?void 0:o.vcodec)===CODEC.H264&&a===ERROR_CODE.MEDIA_ERR_DECODE?(this.isRetryedInSession=!0,{error:i,updatePlayParam:{videoLoadParam:{startTime:n,kernelName:exports.KERNEL_NAME.ORIGIN}}}):null},t}(SuperBaseCheck),CheckWasmError=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name=RetryNames.CheckWasmError,t.checkEvt=exports.PLAY_EVENT.ERROR,t}return __extends$1(t,e),t.prototype.check=function(e){var t=e.data.videoInfo,o=t.error.code;if(this.isRetryedInSession)return null;return this.superPlayer.config.enableDegradeOnLowPerformance?"70060003"!==o?null:(this.isRetryedInSession=!0,this.getRetryConfig(t,{degradeCodecExpireTime:0,degradeReason:DEGRADE_CODEC_REASON.WASM_SPT_ERR})):null},t}(SuperBaseCheck);function writeDegradeCodecToLocal(e,t,o){var r=JSON.stringify(__assign$2({time:Date.now(),degradeExpireTime:e,degradeReason:t},o));lsTool.setData(LOCAL_STORAGE_KEY.DEGRADE_CODEC_TIME,r)}function readDegradeCodecFromLocal(){var e=NaN,t=NaN,o=DEGRADE_CODEC_REASON.UNKNOWN;try{var r=lsTool.getData(LOCAL_STORAGE_KEY.DEGRADE_CODEC_TIME),n=JSON.parse(r||"{}");e=+n.time,t=+n.degradeExpireTime,o=n.degradeReason}catch(e){}return Number.isNaN(e)||Number.isNaN(t)||Date.now()>=e+t?{needDegrade:!1}:{needDegrade:!0,degradeReason:o}}function getDefaultVodPlatform(){if(uaTool.mobile)return"11001";var e=isOfficialSite();return uaTool.os.windows&&e?"10201":uaTool.os.windows&&!e?"70201":uaTool.os.mac&&e?"10901":uaTool.os.mac&&!e?"70901":e?"10901":"70901"}function isOfficialSite(){var e=urlTool.getTopFrameUrl(),t=urlTool.getDomainOfURL(e);return["v.qq.com","film.qq.com"].includes(t)}function getDefautVodSdtfrom(e){if("11001"===e){if(uaTool.os.iphone||uaTool.os.ipod)return"v3010";if(uaTool.os.ipad)return"v4010";if(uaTool.os.tablet)return"v6010";if(uaTool.os.android)return"v5010";if(uaTool.browser.IEMobile)return"v7010"}return{70201:"v1104",70901:"v1103"}[e]||"v1010"}var VERSION$1=getEnvVals().VERSION,defaultVodPlatform=getDefaultVodPlatform(),defautVodSdtfrom=getDefautVodSdtfrom(defaultVodPlatform),defaultVodBusinessConfig={platform:defaultVodPlatform,sdtfrom:defautVodSdtfrom},defaultSuperConfig={enableDegradeOnLowPerformance:!0,maxDegradeCodecExpireTime:432e5,minRenderFrameRate:.8,maxLowRenderFrameRate:.3,maxFrameDropRate:.2,enableTVK:!0,enableP2P:!0},defaultLiveBusinessConfig={platform:"10201",sdtfrom:"10201"};function getBuiltInPlugins(e,t){var o,r;void 0===e&&(e=exports.PLAY_MODE.VOD);var n=t.removeComponents,i=void 0===n?[]:n,a=i.includes(PosterPluginName)||!!t.disablePoster,s=i.includes(CtrlbarPluginName)||!!t.disableCtrlbar,l=i.includes(ErrorPagePluginName)||!!t.disableErrorPage,c=i.includes(TipsPluginName)||!!t.disableTips,p=i.includes(UILoadingPlugin.pluginName)||!!t.disableLoading,d=i.includes(UIContextMenuPluginName)||!!t.disableCtxMenu,u=i.includes(WatermarkPluginName)||!!t.disableWatermark,A=i.includes(InfoPanelPluginName),_=((o={})[PosterPluginName]={isEnabled:!a,config:t.poster},o[CtrlbarPluginName]={isEnabled:!s},o[ErrorPagePluginName]={isEnabled:!l,config:{showOnError:!0}},o[TipsPluginName]={isEnabled:!c},o[UILoadingPlugin.pluginName]={isEnabled:!p},o[UIContextMenuPluginName]={isEnabled:!isMobile&&!d,config:{menus:[{role:"version",label:VERSION$1||"1.3.0"}]}},o[InfoPanelPluginName]={isEnabled:!A,config:{defaultInfo:!0}},o[LivepollPlugin.pluginName]={isEnabled:e===exports.PLAY_MODE.LIVE,config:{livepid:null===(r=t.livepollConfig)||void 0===r?void 0:r.livepid}},o[WatermarkPluginName]={isEnabled:!u},o),E=[];return Object.keys(_).forEach((function(e){var t=_[e],o=t.isEnabled,r=t.config;o&&E.push(r?[e,r]:e)})),E}function getSuperConfig(e){var t,o,r,n=e.plugins,i=void 0===n?[]:n,a=e.mode,s=void 0===a?exports.PLAY_MODE.VOD:a,l=e.businessConfig,c=void 0===l?{}:l,p=e.coreConfig,d=void 0===p?{}:p,u=e.pluginConfig,A=void 0===u?{}:u,_=e.dynamicConfig,E=void 0===_?{}:_;e.type=null!==(t=e.type)&&void 0!==t?t:s;var g=e.type,f=e.lazyInitPlugins,h=g===exports.PLAY_MODE.VOD?defaultVodBusinessConfig:defaultLiveBusinessConfig,v=__assign$2(__assign$2({},h),c),y=__spreadArray$1(__spreadArray$1([],getBuiltInPlugins(g,e),!0),i,!0),m=v.platform,T=__assign$2(__assign$2(__assign$2(__assign$2(__assign$2(__assign$2({},defaultSuperConfig),{supportedPaidFormat:isOfficialSite()?[exports.PAID_FORMAT.FHD,exports.PAID_FORMAT.DOLBY,exports.PAID_FORMAT.SFR_HDR,exports.PAID_FORMAT.UHD]:[],logLevel:getLogLevelFromUrl(),videoElementConfig:{playsinline:!0},maxVideoNodeCount:isMobile||g===exports.PLAY_MODE.LIVE?1:2}),A),d),e),{businessConfig:v,plugins:y,offlineConfig:__assign$2({platform:m},e.offlineConfig),errorPageConfig:__assign$2({useBrowserTip:isOfficialSite(),useClientBtn:isOfficialSite()},e.errorPageConfig),ctrlConfig:__assign$2(__assign$2({disableNextBtn:!0,hidePopupOnClick:!0},A.ctrlConfig),e.ctrlConfig),infoPanelConfig:__assign$2({defaultInfo:!0},e.infoPanelConfig),vodQaReporterConfig:__assign$2(__assign$2({},null==e?void 0:e.vodQaReporterConfig),{paramsKey:__assign$2(__assign$2({},null===(o=A.vodQaReporterConfig)||void 0===o?void 0:o.paramsKey),null===(r=null==e?void 0:e.vodQaReporterConfig)||void 0===r?void 0:r.paramsKey)})});e.isPrivateDeployment&&(T.enableTVK=!1);var C=[],I={superPlayerConfig:mergeDynamicConfig(T,getLocalDynamicConfig()||E),lazyPlugins:C};return f?(I.superPlayerConfig.plugins=I.superPlayerConfig.plugins.filter((function(e){var t="string"==typeof e?e:e[0];return!LAZY_PLUGINS.includes(t)||(C.push(e),!1)})),I):I}function getAdInitConfig(e){var t,o=e.adKernelName,r=void 0===o?exports.KERNEL_NAME.DEMUX_2_FMP4:o,n=e.adInitConfig,i=e.useSingleVideoElement,a=!!KernelFactory$1.getKernelByName(exports.KERNEL_NAME.DEMUX_2_FMP4),s=!uaTool.browser.safari&&a&&r===exports.KERNEL_NAME.DEMUX_2_FMP4;return __assign$2(__assign$2({},n),{playerData:__assign$2(__assign$2({},null==n?void 0:n.playerData),{playerVideoDom:(null!=i?i:uaTool.mobile)?null===(t=e.videoElements)||void 0===t?void 0:t[0]:void 0}),isUseDemuxKernel:s,opencache:s})}function getLocalDynamicConfig(){var e=window.SUPER_PLAYER_DYNAMIC_CONFIG_ID;if(!e)return null;try{var t=lsTool.getData(LOCAL_STORAGE_KEY.DYNAMIC_CONFIG);if(!t)return null;var o=JSON.parse(t)[e];return o&&o.app_config&&"{}"!==o.app_config&&""!==o.app_config?JSON.parse(o.app_config):null}catch(e){}return null}function mergeDynamicConfig(e,t){var o=e;return Object.keys(t).forEach((function(e){var r=o[e];"[object Object]"===Object.prototype.toString.call(r)?o[e]=__assign$2(__assign$2({},r),t[e]):o[e]=t[e]})),o}var extInfoCgi="//h5vv6.video.qq.com/getextinfo";function requestVideoExtInfo(e){return __awaiter$1(this,void 0,void 0,(function(){var t,o,r,n,i,a,s,l,c;return __generator$1(this,(function(p){switch(p.label){case 0:return t=e.vid,o=e.platform,r={vid:t,platform:void 0===o?"11001":o,h5flag:1,otype:"json"},n="".concat(extInfoCgi,"?").concat(urlTool.object2string(r,"&")),[4,netTool.jsonp(n)];case 1:return"o"!==(i=p.sent()).s||i.em&&0!=+i.em?[2,null]:(a=i.limit,s=i.td,l=i.preview,c=i.fs,[2,{duration:0==+a?+s:+l,payLimit:+a,fileSize:c}])}}))}))}var EnvCache=function(){function e(){}return e.get=function(e){var t;return null===(t=getEnvData())||void 0===t?void 0:t[e]},e.set=function(e,t){var o,r=null!==(o=getEnvData())&&void 0!==o?o:{};r[e]=t,lsTool.setData(LOCAL_STORAGE_KEY.ENV_CACHE,JSON.stringify(r))},e.clear=function(){lsTool.setData(LOCAL_STORAGE_KEY.ENV_CACHE,"")},e}(),EnvCacheKeys;function getEnvData(){var e=lsTool.getData(LOCAL_STORAGE_KEY.ENV_CACHE);if(""!==e)try{var t=JSON.parse(e);if("[object Object]"===Object.prototype.toString.call(t))return t;EnvCache.clear()}catch(e){}}function sptAV1OnTx(){return videoTool.supportAV1()?{spav1:15}:null}function getHevcLevelRequestValue(e,t,o,r){var n,i=e.enableTxHevc,a=e.supportedPaidFormat,s=o.defn;return t.roomid?null:videoTool.supportHevc()&&!uaTool.mobile&&hevcCanaryReleaseStrategy(e,t,o)?-1!==a.indexOf(exports.PAID_FORMAT.UHD)&&(uaTool.browser.chrome||uaTool.browser.safari)?{hevclv:exports.HEVC_LV_VALUE.UHD}:{hevclv:exports.HEVC_LV_VALUE.FHD}:i&&(null===(n=KernelFactory$1.kernelMap[exports.KERNEL_NAME.WASM])||void 0===n?void 0:n.isEnvSupport)&&sptWasmHevcOnTx()&&(void 0===s||-1!==[FORMAT.SD,FORMAT.HD].indexOf(s))?{hevclv:exports.HEVC_LV_VALUE.HD}:null}function hevcCanaryReleaseStrategy(e,t,o,r){var n=t.livepid,i=e.enableHevcRateOnPid,a=void 0===i?0:i,s=e.enableHevcPids;if(e.type===exports.PLAY_MODE.VOD||!s)return!0;if(!n||-1===s.indexOf(n))return!1;var l=o.guid;return!(a<=0||a>1||!l)&&isCanaryTarget(l,a)}function sptWasmHevcOnTx(){var e=uaTool.browser.chrome&&comTool.compareVersion(uaTool.browser.chrome.version,"92.0")>=0,t=EnvCache.get(EnvCacheKeys.enableHevc);void 0===t&&(t=1);var o=navigator.hardwareConcurrency>8;return e&&1===t&&o}function getCodecParams(e,t,o,r,n){var i,a=e.preferCodec,s=t.playCodec,l=getForceCodecFromUrl();l&&(s=+l);var c={};if(s===PLAY_CODEC.H264)return{};if(s===PLAY_CODEC.H265)return{hevclv:exports.HEVC_LV_VALUE.UHD};if(n)return{};if(0===(null==a?void 0:a.length))return{};for(var p=!!a,d=a||[exports.VIDEO_CODEC.AV1,exports.VIDEO_CODEC.H265],u=((i={})[exports.VIDEO_CODEC.AV1]=sptAV1OnTx,i[exports.VIDEO_CODEC.H265]=function(){return getHevcLevelRequestValue(e,t,o)},i),A=0;A<d.length;A++){var _=u[d[A]],E=null==_?void 0:_();if(E&&(Object.assign(c,E),p))break}return c}function isCanaryTarget(e,t){return parseInt(e.slice(0,4),16)<=65535*t}function getSptAdSegParam(e){return void 0===e&&(e=!1),e?3:2}function getDtypeParam(e){if(uaTool.mobile){var t=e.businessConfig,o=void 0===t?{}:t,r=e.enableP2PChannlType,n=void 0===r?[]:r,i=e.enableP2P,a=void 0!==i&&i,s=o.type;return a||-1!==n.indexOf(s)?REQ_VOD_STREAM_TYPE.hls:REQ_VOD_STREAM_TYPE.mp4}return REQ_VOD_STREAM_TYPE.hls}function getBuiltInVideoReqInfoParam(e,t,o,r,n){return void 0===n&&(n=!0),__awaiter$1(this,void 0,void 0,(function(){return __generator$1(this,(function(i){return e.type===exports.PLAY_MODE.VOD?[2,getVodBuiltInVideoReqInfoParam(e,t,o,r,n)]:[2,getLiveBuiltInVideoReqInfoParam(e,t,o,r)]}))}))}function getVodBuiltInVideoReqInfoParam(e,t,o,r,n){var i,a;return void 0===n&&(n=!0),__awaiter$1(this,void 0,void 0,(function(){var s,l,c,p,d,u,A,_,E;return __generator$1(this,(function(g){return s=e.businessConfig,l=getUserCookies(),c={guid:o(COMMON_DATA_KEY.guid),platform:s.platform,sdtfrom:s.sdtfrom,appVer:o(COMMON_DATA_KEY.appVer)},(p=o(exports.PersistedUserSettings.definition))&&(c.defn=p),d=t||{},uaTool.mobile||(c.sphls=2),c.spvvpay=1,c.spadseg=getSptAdSegParam(!0),(u=o(exports.SUPER_DATA_KEY.getinfoAdInfo))&&n&&(c.adsid=u.adsid||"",c.adpinfo=u.adpinfo||""),c.dtype=getDtypeParam(e),A=getCodecParams(e,d,c,l,r),Object.assign(c,A),(_=e.supportedPaidFormat)&&(E=getRequestParamForPaidFormat(_),Object.assign(c,E)),c.logintoken=Object.keys(l).length>0?jsonTool.safelyStringify(l):"",e.enableTVK&&(c.spm3u8tag=67,c.spmasterm3u8=3,uaTool.mobile||(c.sphls=2),(null===(i=e.tvkConfig)||void 0===i?void 0:i.showUHDClientGuide)&&(null===(a=e.supportedPaidFormat)||void 0===a?void 0:a.includes(exports.PAID_FORMAT.UHD))&&(!c.hevclv||c.hevclv<exports.HEVC_LV_VALUE.UHD)&&!videoTool.supportHevc()&&(c.hevclv=exports.HEVC_LV_VALUE.UHD_ONLY)),[2,c]}))}))}function getLiveBuiltInVideoReqInfoParam(e,t,o,r){return __awaiter$1(this,void 0,void 0,(function(){var n,i,a,s,l,c;return __generator$1(this,(function(p){return n=e.businessConfig,i=getUserCookies(),a={guid:o(COMMON_DATA_KEY.guid),platform:n.platform,sdtfrom:n.sdtfrom,appver:o(COMMON_DATA_KEY.appVer)},(s=o(exports.PersistedUserSettings.definition))&&(a.defn=s),l=t||{},a.livepid=l.livepid||"",a.roomid=l.roomid||"",a.defnswitch=1,c=getCodecParams(e,l,a,i,r),Object.assign(a,c),Object.assign(a,{defauto:a.defnswitch,appVer:a.appver}),[2,a]}))}))}!function(e){e.drm="drm",e.hdr="hdr",e.enableHevc="enableHevc_20220822"}(EnvCacheKeys||(EnvCacheKeys={}));var ProxyHttpRequestor=function(e){function t(t,o){var r=e.call(this)||this;return r.playerConfig=t,r.pluginMsg=o,r.destroyed=!1,r.logger=new Logger(r.playerConfig.instanceId,"ProxyHttp"),r}return __extends$1(t,e),t.prototype.request=function(e,t,o){return __awaiter$1(this,void 0,void 0,(function(){var r,n,i,a,s,l;return __generator$1(this,(function(c){switch(c.label){case 0:r=__assign$2(__assign$2({},o||{}),DEFAULT_CONFIG).retryCount,n={},e&&Object.assign(e,getUserCookies(((l={})[COOKIE_NAME.MAIN_LOGIN]="lt",l[COOKIE_NAME.OPENID]="opid",l[COOKIE_NAME.APPID]="appid",l[COOKIE_NAME.ACCESS_TOKEN]="atkn",l[COOKIE_NAME.VUSERID]="uid",l[COOKIE_NAME.VUSESSION]="tkn",l))),n.reqParams=this.getRequestParams(e,t),this.logger.log("proxyhttp reqParams(ad)",jsonTool.safelyStringify(e)),this.logger.log("proxyhttp reqParams(vinfo)",jsonTool.safelyStringify(t));try{this.pluginMsg.emit(exports.PLAY_EVENT_EXT.PROXY_HTTP_START,n.reqParams)}catch(e){this.logger.warn("H5_EXT_EVENT.PROXY_HTTP_START err, ".concat(e))}i=0,c.label=1;case 1:if(!(i<r+1))return[3,7];c.label=2;case 2:return c.trys.push([2,4,,5]),n.reqPath=this.getRequestUrl(i),this.logger.log("proxyhttp request start, num=".concat(i,", url=").concat(n.reqPath)),[4,netTool.xhr({responseType:"text",timeout:8e3,withCredentials:!0,method:"post",url:n.reqPath,retryCount:0,body:JSON.stringify(n.reqParams)})];case 3:return a=c.sent(),n.resData=JSON.parse(a.data),n.xhrReqData=a.data,[3,5];case 4:return s=c.sent(),this.logger.log("proxyhttp(num=".concat(i,") request err:"),s),n.error=null,[3,5];case 5:if(this.destroyed)return[2,new Promise((function(){}))];if(n.alreadyRetryCount=i,n.resData)return[3,7];c.label=6;case 6:return i++,[3,1];case 7:this.parseResponseData(n);try{this.pluginMsg.emit(exports.PLAY_EVENT_EXT.PROXY_HTTP_END,n)}catch(e){this.logger.warn("H5_EXT_EVENT.PROXY_HTTP_END err, ".concat(e))}return[2,n]}}))}))},t.prototype.destroy=function(){this.destroyed=!0,this.logger=null},t.prototype.getRequestUrl=function(e){if(this.playerConfig.proxyHttpPath)return this.playerConfig.proxyHttpPath;var t=PROXY_HTTP_PATH.COMMON;return t[e%t.length]},t.prototype.getRequestParams=function(e,t){var o=t?urlTool.convertUrlParam(t):null,r=null,n=null;(null==e?void 0:e.adparam)?(r=urlTool.convertUrlParam(e.adparam),n=JSON.stringify(e.sspAdParam)):r=e?urlTool.convertUrlParam(e):null;var i=n?{sspAdParam:n,adparam:r}:{adparam:r};return r&&o?__assign$2({buid:PROXY_HTTP_REQ_BUID.vinfoad,vinfoparam:o},i):r?__assign$2({buid:PROXY_HTTP_REQ_BUID.onlyad},i):o?{buid:PROXY_HTTP_REQ_BUID.onlyvinfo,vinfoparam:o}:void 0},t.prototype.parseResponseData=function(e){var t,o;if(e.resData)if(0===e.resData.errCode){if(e.parseData={},e.resData.ad){this.logger.log("proxyhttp result(ad): ",null===(t=e.resData)||void 0===t?void 0:t.ad);try{e.parseData.ad=JSON.parse(e.resData.ad)}catch(t){this.logger.warn("can not parse ad data, res=".concat(e.resData.ad))}}if(e.resData.vinfo){this.logger.log("proxyhttp result(vinfo): ",null===(o=e.resData)||void 0===o?void 0:o.vinfo);try{e.parseData.vinfo=JSON.parse(e.resData.vinfo)}catch(t){this.logger.warn("can not parse vinfo data, res=".concat(e.resData.vinfo))}}}else e.error={code:PROXY_HTTP_CODE.RES_CODE,message:compile(i18nConfig.superPlayer.PROXY_HTTP_PARSE_ERROR,e.resData.errCode)};else e.error={code:PROXY_HTTP_CODE.NET}},t}(s),ProxyHttpFlowNode=function(e){function t(t,o,r){var n=e.call(this,t)||this;return n.doRequestCallback=o,n.adType=r,n}return __extends$1(t,e),t.prototype.destroy=function(){e.prototype.destroy.call(this),this.doRequestCallback=null},t.prototype.getName=function(){return"ProxyHttpFlowNode"},t.prototype.start=function(){return __awaiter$1(this,void 0,void 0,(function(){var e=this;return __generator$1(this,(function(t){switch(t.label){case 0:return this.emit(exports.FLOW_NODE_EVENT.START,{name:this.getName()}),this.isPreload=!1,this.loadDefer?[4,this.loadDefer]:[3,2];case 1:return t.sent(),this.emit(exports.FLOW_NODE_EVENT.END,{name:this.getName()}),[3,3];case 2:this.request().then((function(){e.emit(exports.FLOW_NODE_EVENT.END,{name:e.getName()})})),t.label=3;case 3:return[2]}}))}))},t.prototype.pause=function(){},t.prototype.resume=function(){},t.prototype.preload=function(){var e=this;return this.emit(exports.FLOW_NODE_EVENT.PRELOAD,{name:this.getName()}),this.isPreload=!0,this.loadDefer=this.request().then((function(){e.emit(exports.FLOW_NODE_EVENT.PRELOAD_NEXT,{forcePreload:e.adType===exports.AD_TYPE.PRE,name:e.getName()})})),this.loadDefer},t.prototype.request=function(){var e=this;return this.doRequestCallback().catch((function(t){e.emit(exports.FLOW_NODE_EVENT.ABORT,__assign$2(__assign$2({},t),{name:e.getName()}))}))},t}(BaseFlowNode),envVals=getEnvVals(),adInitDefer,logMethodCall=logMethodCallDecoratorCreator("SuperPlayer"),hlsADShift=1,SuperPlayer=function(e){function t(o){var r,n=this,i=getSuperConfig(o),a=i.superPlayerConfig,s=i.lazyPlugins;a.isPrivateDeployment||ReferenceReport.getReporter().collectUsage(2,envVals.CHANNEL,null===(r=a.businessConfig)||void 0===r?void 0:r.platform);(n=e.call(this,a)||this).type=exports.PLAY_MODE.VOD,n.lazyPlugins=[],n.videoLoadParamModifier=function(e){var t,o;if(n.config.keepOriginalStartTime)return e;var r=null!==(t=n.getCommonKv(exports.SUPER_DATA_KEY.hlsAdRanges))&&void 0!==t?t:[],i=comTool.findDiscontinuityTimeRangeAtPlaytime(e.startTime,r);if(i&&e.startTime){var a=i.start-hlsADShift;return n.log("start time modified due to hls ad, origin: ".concat(e.startTime,", new: ").concat(a)),__assign$2(__assign$2({},e),{startTime:a})}return(null===(o=n.removedAdRange)||void 0===o?void 0:o.length)?__assign$2(__assign$2({},e),{startTime:n.getVVIPOffsetTime(e.startTime)}):e},n.logger=new Logger(n.config.instanceId,"SuperPlayer"),n.log("new SuperPlayer(), input config=",jsonTool.safelyStringify(o));var l=o.mode,c=void 0===l?exports.PLAY_MODE.VOD:l,p=o.type;return n.lazyPlugins=s,n.type=p||c,n.adLogic=new AdLogic(n,n.corePlayer),n.previewLogic=new PreviewLogic(n),n.posterLogic=new PosterLogic(n),n.writeGlobalCommonKvs(),n.initPlugins(),n.initInnerEvts(),n.reqExtInfoOnMobile(),n.setupRemovedAdRange(),getDebugModeFromUrl()&&(t._instances[n.config.instanceId]=n),(o.videoId||o.adInitConfig)&&n.loadAdPlugin(),a.enableTVK&&(n.tvk=enableTVK(n,a.tvkConfig)),n}return __extends$1(t,e),Object.defineProperty(t.prototype,"vinfo",{get:function(){return this.currentVideoInfo},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ctrlbarPlugin",{get:function(){return this.plugins[CtrlbarPluginName]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tipsPlugin",{get:function(){return this.plugins[TipsPluginName]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"loadingPlugin",{get:function(){return this.plugins[UILoadingPlugin.pluginName]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"errorPagePlugin",{get:function(){return this.plugins[ErrorPagePluginName]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"posterPlugin",{get:function(){return this.plugins[PosterPluginName]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"config",{get:function(){return this.corePlayer.config},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"previewDuration",{get:function(){return this.previewLogic.previewDuration},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"core",{get:function(){return this},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"coreConfig",{get:function(){return this.config},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"getinfoPlugin",{get:function(){return this.videoReqInfoPlugin},enumerable:!1,configurable:!0}),t.prototype.log=function(){for(var e,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];(e=this.logger).log.apply(e,t)},t.prototype.warn=function(){for(var e,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];(e=this.logger).warn.apply(e,t)},Object.defineProperty(t.prototype,"videoSize",{get:function(){var e;return this.videoSizeFromGetInfo||(null===(e=this.corePlayer)||void 0===e?void 0:e.videoSize)||{width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cnlid",{get:function(){return this.config.type===exports.PLAY_MODE.LIVE?this.vid:""},enumerable:!1,configurable:!0}),t.prototype.degradeCodecRetry=function(e){var t;return void 0===e&&(e=0),null===(t=this.startGetinfoRetry)||void 0===t?void 0:t.call(this,{updatePlayParam:{videoReqInfoParam:{hevclv:exports.HEVC_LV_VALUE.NOT_SPT},videoLoadParam:{startTime:this.playtime,kernelName:void 0}},degradeCodecExpireTime:e,degradeReason:DEGRADE_CODEC_REASON.USER},!1)},t.prototype.clearLocalstorage=function(e){return-1!==Object.keys(LOCAL_STORAGE_KEY).findIndex((function(t){return LOCAL_STORAGE_KEY[t]===e}))&&(lsTool.delData(e),!0)},t.prototype.destroy=function(){var o,r,n,i,a,s;return null===(o=this.tvk)||void 0===o||o.destroy(),this.tvk=null,null===(r=this.adLogic)||void 0===r||r.destroy(),this.adLogic=null,null===(n=this.previewLogic)||void 0===n||n.destroy(),this.previewLogic=null,null===(i=this.posterLogic)||void 0===i||i.destroy(),this.posterLogic=null,null===(a=this.proxyHttpRequestor)||void 0===a||a.destroy(),this.proxyHttpRequestor=null,(null===(s=this.config)||void 0===s?void 0:s.instanceId)&&t._instances[this.config.instanceId]&&delete t._instances[this.config.instanceId],clearTimeout(this.mouseMoveTimerSuperPlayer),e.prototype.destroy.call(this)},t.prototype.play=function(e,t){var o,r;return __awaiter$1(this,void 0,void 0,(function(){var n;return __generator$1(this,(function(i){return e?(null===(o=this.loadingPlugin)||void 0===o||o.show(),(n=null===(r=this.ctrlbarPlugin)||void 0===r?void 0:r.instances.CenterBtn)&&n.hideEl(n.playBtn),[2,this.loadOrPlay(e,t,"play")]):[2,this.playByInitConfig()]}))}))},t.prototype.loadOrPlay=function(t,o,r){var n,i;return void 0===r&&(r="load"),__awaiter$1(this,void 0,void 0,(function(){var a,s,l,c,p,d,u,A,_;return __generator$1(this,(function(E){switch(E.label){case 0:return t?(this.clearBeforeReplay(),a=t,this.replayConfig=t,checkParams(this.type,r,a),"string"==typeof t&&(this.type===exports.PLAY_MODE.LIVE?(s=(null===(n=this.currentPlayItem)||void 0===n?void 0:n.cnlid)?this.currentPlayItem:{},a=__assign$2(__assign$2({},s),{cnlid:t})):(s=(null===(i=this.currentPlayItem)||void 0===i?void 0:i.vid)?this.currentPlayItem:{},a=__assign$2(__assign$2({},s),{vid:t}))),c=(l=a).vid,p=l.cnlid,d=l.livepid,u=this.isH5PlayParam(o)?o:{videoLoadParam:o},this.currentPlayItem=c||p||a,this.playtimeLimiter.clearAllConfig(),this.getinfoPlugin&&(c||p)?[4,getBuiltInVideoReqInfoParam(this.config,a,this.getCommonKv.bind(this),this.checkDegradeCodecFromLocal())]:[3,3]):[2];case 1:return A=E.sent(),this._destroyed?[2]:(u.videoReqInfoParam=__assign$2(__assign$2({},A),u.videoReqInfoParam),[4,this.loadAdPlugin()]);case 2:return E.sent(),this._destroyed?[2]:(p?(u.videoReqInfoParam.cnlid=p,this.getPlugin(LivepollPlugin.pluginName).livepid=d,this.setCommonKv(COMMON_DATA_KEY.livepid,d)):c&&(u.videoReqInfoParam.vid=c),[2,e.prototype[r].call(this,c||p,u)]);case 3:return _=a.levels,this.setLevelOptions(_,a.url),[2,e.prototype[r].call(this,a,u)]}}))}))},t.prototype.replay=function(){var e,t,o;null===(t=null===(e=this.loadParam)||void 0===e?void 0:e.videoLoadParam)||void 0===t||delete t.startTime;var r=this.getCommonKv(COMMON_DATA_KEY.currentDefn);return this.vid&&r?this.play(this.replayConfig,__assign$2(__assign$2({},this.loadParam),{videoReqInfoParam:__assign$2(__assign$2({},null===(o=this.loadParam)||void 0===o?void 0:o.videoReqInfoParam),{defn:r})})):this.play(this.replayConfig,this.loadParam)},t.prototype.load=function(t,o){return __awaiter$1(this,void 0,void 0,(function(){return __generator$1(this,(function(r){return t?[2,this.loadOrPlay(t,o,"load")]:[2,e.prototype.load.call(this)]}))}))},t.prototype.preload=function(t,o,r){return __awaiter$1(this,void 0,void 0,(function(){var n,i,a;return __generator$1(this,(function(s){switch(s.label){case 0:return t?(checkParams(this.type,"load",t),n="string"==typeof t?t:null==t?void 0:t.vid,i=this.isH5PlayParam(o)?o:{videoLoadParam:o},this.getinfoPlugin&&n?[4,getBuiltInVideoReqInfoParam(this.config,t,this.getCommonKv.bind(this),this.checkDegradeCodecFromLocal(),!1)]:[2]):[2];case 1:return a=s.sent(),this._destroyed?[2]:(i.videoReqInfoParam=__assign$2(__assign$2({},a),null==i?void 0:i.videoReqInfoParam),[2,e.prototype.preload.call(this,n,i,r)])}}))}))},t.prototype.seek=function(t){var o=t;uaTool.mobile||this.previewDuration===NO_PREVIEW_FLAG||(o=Math.min(t,this.previewDuration-1));var r=this.getCommonKv(exports.SUPER_DATA_KEY.hlsAdRanges);if(r){var n=comTool.findDiscontinuityTimeRangeAtPlaytime(o,r);n&&(o=n.start-hlsADShift)}return e.prototype.seek.call(this,o)},t.prototype.setLevel=function(t,o){return void 0===o&&(o={}),__awaiter$1(this,void 0,void 0,(function(){var r,n,i,a,s,l,c,p,d,u,A,_,E,g,f,h,v=this;return __generator$1(this,(function(y){return"string"!=typeof t?[2,Promise.reject("setLevel received illegal parameter")]:this.getinfoPlugin&&this.vid?(this.state===exports.VIDEO_STATE.PAUSE&&this.type===exports.PLAY_MODE.VOD&&this.play(),r=this.getCommonKv(COMMON_DATA_KEY.currentDefn),o.userTrigger&&this.setCommonKv(exports.PersistedUserSettings.definition,t),n={flowid:this.getCommonKv(COMMON_DATA_KEY.flowid),defn:t,logintoken:jsonTool.safelyStringify(getUserCookies())},i=void 0,this.type===exports.PLAY_MODE.LIVE?(a=__assign$2(__assign$2({},n),{defnswitch:o.userTrigger?1:0}),Object.assign(a,{defauto:+!a.defnswitch}),i=a):(s=__assign$2({fhdswitch:o.userTrigger?1:0},n),(l=this.getCommonKv(exports.SUPER_DATA_KEY.getinfoAdInfo))&&(s.adsid=l.adsid||"",s.adpinfo=l.adpinfo||""),c=this.currentVideoInfo,p=c.audioTracks,d=c.currentAudioTrack,p.length>1&&(u=p.find((function(e){return e.id===d})))&&Object.assign(s,{track:u.name}),i=s),A=[FORMAT.DOLBY,FORMAT.HDR10,FORMAT.SFR_HDR],_=o.setLevelMode,-1===A.indexOf(r)&&-1===A.indexOf(t)||(_=SET_LEVEL_MODE.HARD),[2,e.prototype.setLevel.call(this,i,{setLevelMode:_}).catch((function(e){v.log(e),v.ctrlbarPlugin&&(v.ctrlbarPlugin.level=r),v.setCommonKv(COMMON_DATA_KEY.currentDefn,r)}))]):(E=this.getCommonKv(COMMON_DATA_KEY.currentDefnList),g=null==E?void 0:E.findIndex((function(e){return e.value===t})),(f=E[g])?(!(h=f.url)&&this.defnIdToUrl&&(h=this.defnIdToUrl(t),f.url=h),h?(this.setCommonKv(COMMON_DATA_KEY.currentDefn,t),this.levelList=E,this.level=f.value,this.replayConfig.url=h,[2,e.prototype.setLevel.call(this,__assign$2(__assign$2({},this.replayConfig),{levels:void 0,defn:f.value,url:f.url,level:f,levelIndex:g}))]):[2,Promise.reject(new Error("definition must contains url"))]):[2,Promise.reject(new Error("no definition info"))])}))}))},t.prototype.getPlugin=function(e){return this.plugins[e]},t.prototype.closePayTipsCallback=function(e){var t=getAdPlugin(this.config.instanceId);"ad"===e&&"function"==typeof(null==t?void 0:t.resumeAd)&&t.resumeAd()},t.prototype.createPlugin=function(t,o){void 0===o&&(o={});var r=o.pluginName;(void 0===r?t:r)===AdPluginName?e.prototype.createPlugin.call(this,t,__assign$2(__assign$2({},o),{requestProxyHttp:this.requestAdProxyHttp.bind(this)})):e.prototype.createPlugin.call(this,t,o)},t.prototype.setAdConfig=function(e){return this.waitAdPlugin().then((function(t){return t.setConf(e)}))},t.prototype.resizeAd=function(){return this.waitAdPlugin().then((function(e){var t;return null===(t=e.resizeAd)||void 0===t?void 0:t.call(e)}))},t.prototype.hideAdBeforeResize=function(){return this.waitAdPlugin().then((function(e){var t;return null===(t=e.hideAdBeforeResize)||void 0===t?void 0:t.call(e)}))},t.prototype.getVVIPOffsetTime=function(e,t){void 0===t&&(t=!1);var o=this.removedAdRange;if(!(null==o?void 0:o.length))return e;if(t)return this.getPlusAdOffsetTime(e);for(var r=0,n=0;n<o.length;n++){var i=o[n],a=i.start,s=i.end;if(a>e)break;if(s>e){r+=e-a;break}r+=s-a}return e-r},t.prototype.startGetinfoRetry=function(t,o){var r,n=t.degradeCodecExpireTime,i=void 0===n?0:n,a=t.degradeReason,s=void 0===a?DEGRADE_CODEC_REASON.UNKNOWN:a;if(s===DEGRADE_CODEC_REASON.USER&&!this.canGetinfoRetry())return!1;if(i>0){var l={playerSize:domTool.getDomSize(this.player.container),videoSize:this.player.videoSize,url:location.href,topUrl:urlTool.getTopFrameUrl(),kernelName:this.player.kernelName,flowid:this.player.getCommonKv(COMMON_DATA_KEY.flowid),guid:this.player.getCommonKv(COMMON_DATA_KEY.guid),playtime:this.player.playtime,duration:this.player.duration,vid:this.player.vid,loadingUrl:null===(r=this.player.currentVideoInfo)||void 0===r?void 0:r.loadingUrl};this.logger.log("start degrade retry, degradeReason=".concat(s,", extraInfo=").concat(jsonTool.safelyStringify(l))),writeDegradeCodecToLocal(i,s,l)}return e.prototype.startGetinfoRetry.call(this,t,o)},t.prototype.getRetryCheckClasses=function(){return __spreadArray$1([CheckFrameDropRate,CheckRenderPerformance,CheckWasmError,CheckOriginPlayHevcError,CheckSafariHlsError,CheckNoH264Error],e.prototype.getRetryCheckClasses.call(this),!0)},t.prototype.getPlusAdOffsetTime=function(e){return this.removedAdRange.reduce((function(e,t){var o=t.start,r=t.end;return o<=e&&(e+=r-o),e}),e)},t.prototype.waitAdPlugin=function(){var e,t=this,o=getAdPlugin(null===(e=this.config)||void 0===e?void 0:e.instanceId);return o?Promise.resolve(o):new Promise((function(e){t.pluginMsg.on("pluginsetup:".concat(AdPluginName),(function(){e(getAdPlugin(t.config.instanceId))}))}))},t.prototype.playByInitConfig=function(){var t=this.config,o=t.videoId,r=t.videoInitConfig,n=void 0===r?o:r;return!n||this.currentPlayItem?e.prototype.play.call(this):this.play(n)},t.prototype.nodeBeforePreAd=function(t){return t.vid?this.getProxyHttpFlowNode({reqInfo:t,adType:exports.AD_TYPE.PRE}):e.prototype.nodeBeforePreAd.call(this,t)},t.prototype.nodeBeforePostAd=function(t){return t.vid?this.getProxyHttpFlowNode({reqInfo:t,adType:exports.AD_TYPE.POST}):e.prototype.nodeBeforePostAd.call(this,t)},t.prototype.setupRemovedAdRange=function(){var e=this;this.on(exports.H5_PLAY_EVENT.VIDEO_REQ_INFO_END,(function(t){var o=t.data;if(o.code===exports.ErrorCode.SUC&&e.config.type!==exports.PLAY_MODE.LIVE)try{var r=o.data,n=r.parseData,i=r.reqParams,a=n.vitem,s=a.purevid,l=a.dotinfo,c=void 0===l?"":l;s&&i.vid!==s&&c?e.removedAdRange=JSON.parse(c).dot_time.map((function(e){return{start:+e.start_time/1e3,end:+e.end_time/1e3}})):e.removedAdRange=null}catch(t){e.log("set ad range err,",t),e.removedAdRange=null}}))},t.prototype.selectGetinfoModule=function(e){var t=e.type,o=void 0===t?exports.PLAY_MODE.VOD:t,r=e.getinfoModule;return e.enableTVK?r||(o===exports.PLAY_MODE.VOD?VodGetInfo:e.enableUnifiedGetinfoLive?UnifiedLiveGetInfo:LiveGetInfo):null},t.prototype.initPlugins=function(){return __awaiter$1(this,void 0,void 0,(function(){return __generator$1(this,(function(e){switch(e.label){case 0:return this.config.lazyInitPlugins?(this.setCacheStatus(!0),this.setReplayType(0),[4,this.waitLoadStart()]):[3,3];case 1:return e.sent(),[4,this.loadPlayerPlugins()];case 2:e.sent(),e.label=3;case 3:return this.initAdPlugin(),this.initErrorPage(),this.initTipsPlugin(),this.initCtrlbarPlugin(),this.initLivepoll(),this.initLoadingPlugin(),this.clearCache(),[2]}}))}))},t.prototype.waitLoadStart=function(){var e=this;return new Promise((function(t){e.once(exports.H5_PLAY_EVENT.VIDEO_LOAD_START,(function(){return t()})),setTimeout((function(){t()}),200)}))},t.prototype.initAdPlugin=function(){var e=this,t=this.ctrlbarPlugin;t&&(t.on(CTRL_EVENTS.FAKE_FULLSCREEN_CHANGE,(function(){return e.resizeAd()})),t.on(CTRL_EVENTS.FULLSCREEN_CHANGE,(function(){e.hideAdBeforeResize();setTimeout((function(){e.resizeAd()}),300)})))},t.prototype.reqExtInfoOnMobile=function(){return __awaiter$1(this,void 0,void 0,(function(){var e,t,o,r,n;return __generator$1(this,(function(i){switch(i.label){case 0:return e=this.config,t=e.videoId,o=e.enableGetExtInfo,(void 0===o||o)&&uaTool.mobile&&"string"==typeof t?(r=this.getCommonKv(COMMON_DATA_KEY.platform),[4,requestVideoExtInfo({vid:t,platform:r})]):[2];case 1:return n=i.sent().duration,this.state===exports.VIDEO_STATE.IDLE&&!this.played&&this.ctrlbarPlugin&&(this.ctrlbarPlugin.duration=n),[2]}}))}))},t.prototype.initLoadingPlugin=function(){var e=this;this.on(exports.H5_PLAY_EVENT.VIDEO_SETLEVEL_START,(function(){var t;return null===(t=e.loadingPlugin)||void 0===t?void 0:t.show()})),this.on(exports.H5_PLAY_EVENT.VIDEO_SETLEVEL_END,(function(){var t;return null===(t=e.loadingPlugin)||void 0===t?void 0:t.hide()})),this.pluginMsg.on(exports.PLAY_EVENT_EXT.RETRY_PLAY,(function(t){var o,r,n=t.data;null===(o=e.loadingPlugin)||void 0===o||o.show(),null===(r=e.tipsPlugin)||void 0===r||r.show((null==n?void 0:n.degradeReason)?compile(i18nConfig.superPlayer.TIPS_DEGRADE_TEXT_REASON):compile(i18nConfig.superPlayer.TIPS_DEGRADE_TEXT_NO_REASON))}))},t.prototype.initLivepoll=function(){var e=this,t=this.plugins[LivepollPlugin.pluginName];t&&t.on(LIVE_EVENTS.statusChange,(function(t){var o;t.data.new===LIVE_STATUS.OVER&&(null===(o=e.errorPagePlugin)||void 0===o||o.show({text:compile(i18nConfig.superPlayer.LIVE_STREAM_END),hideRefresh:!0}))}))},t.prototype.isUsingCustomGetInfo=function(){var e;return!!(null===(e=this.config.getinfoConfig)||void 0===e?void 0:e.path)},t.prototype.shouldUseProxyHttpForGetInfo=function(){var e,t=this.type===exports.PLAY_MODE.VOD&&!this.isUsingCustomGetInfo();return this.type===exports.PLAY_MODE.VOD&&this.setCommonKv(exports.SUPER_DATA_KEY.vodCGIUsed,t?"proxyhttp":null===(e=this.config.getinfoConfig)||void 0===e?void 0:e.path),t},t.prototype.initErrorPage=function(){var e=this;if(this.errorPagePlugin){var t=i18nConfig.superPlayer;this.errorPagePlugin.on(ErrorPagePluginEvents.REPORT_LOG,(function(){e.offlineLog.report(!0,"error-page:click").then((function(o){var r,n=o||{},i=n.status,a=n.msg;null===(r=e.tipsPlugin)||void 0===r||r.show(i?compile(t.ERROR_PAGE_REPORT_SUCCESS):compile(t.ERROR_PAGE_REPORT_FAILED,a))})).catch((function(o){var r;null===(r=e.tipsPlugin)||void 0===r||r.show(compile(t.ERROR_PAGE_REPORT_FAILED,null==o?void 0:o.message))}))}))}},t.prototype.initTipsPlugin=function(){var e=this;this.tipsPlugin&&this.on(exports.H5_PLAY_EVENT.VIDEO_SETLEVEL_END,(function(t){var o,r,n,i=t.data,a=e.getCommonKv(COMMON_DATA_KEY.currentDefn),s=null===(o=e.levelList)||void 0===o?void 0:o.find((function(e){return e.value===a})),l=(null===(n=null===(r=null==s?void 0:s.payload)||void 0===r?void 0:r.trim)||void 0===n?void 0:n.call(r))||(null==s?void 0:s.label);e.tipsPlugin.show(i.code!==exports.ErrorCode.SUC?"".concat(i.message||compile(i18nConfig.superPlayer.DEFN_SWITCH_FAILED)):compile(i18nConfig.superPlayer.DEFN_SWITCH_SUCCESS,l))}))},t.prototype.initCtrlbarPlugin=function(){var e=this,t=i18nConfig.superPlayer;if(this.ctrlbarPlugin){this.ctrlbarPlugin.level=this.getCommonKv(COMMON_DATA_KEY.currentDefn),this.ctrlbarPlugin.audio=this.getCommonKv(COMMON_DATA_KEY.currentAudioTrack),this.ctrlbarPlugin.lang=this.getCommonKv(COMMON_DATA_KEY.currentSubtitle),this.pluginMsg.on(exports.PLAY_EVENT_EXT.DATASET_UPDATE,(function(t){var o,r=t.data,n=r.key,i=r.newVal;if(i!==r.oldVal)switch(n){case COMMON_DATA_KEY.currentAudioTrackList:e.ctrlbarPlugin.audioOpts=i;break;case COMMON_DATA_KEY.currentAudioTrack:e.ctrlbarPlugin.audio=i;break;case COMMON_DATA_KEY.currentDefn:e.ctrlbarPlugin.level=i,e.level=i;break;case COMMON_DATA_KEY.currentDefnList:if(!i||i.length<=1){e.ctrlbarPlugin.levelOpts=[];break}o=[].concat(i),e.ctrlbarPlugin.levelOpts=o,e.levelList=o}})),this.ctrlbarPlugin.on(CTRL_EVENTS.SET_LEVEL,(function(o){var r,n;if(e.checkCanSetLevel()){var i=o.data,a=i.value,s=i.payload,l=i.label;null===(r=e.tipsPlugin)||void 0===r||r.show({text:compile(t.DEFN_SWITCHING,(null===(n=null==s?void 0:s.trim)||void 0===n?void 0:n.call(s))||l),time:-1}),e.setLevel(a,{userTrigger:!0})}}));var o=function(){e.tipsPlugin.show(compile(t.AUDIO_SWITCH_FAILED)),e.ctrlbarPlugin.audio=e.currentVideoInfo.currentAudioTrack};this.ctrlbarPlugin.on(CTRL_EVENTS.SET_AUDIO,(function(r){var n,i=r.data,a=i.label,s=i.value;null===(n=e.tipsPlugin)||void 0===n||n.show({text:compile(t.AUDIO_SWITCHING,a),time:-1}),e.setAudioTrack(s).then((function(r){r.fail?o():function(o){e.tipsPlugin.show(compile(t.AUDIO_SWITCH_SUCCESS,o))}(a)})).catch((function(){o()}))})),this.on(exports.PLAY_EVENT.SET_AUDIO_TRACK_OVER,(function(t){e.setCommonKv(COMMON_DATA_KEY.currentAudioTrack,t.data.id)})),this.ctrlbarPlugin.on(CTRL_EVENTS.TEST_EVENT,(function(){var t;null===(t=e.getPlugin(InfoPanelPluginName))||void 0===t||t.show()}));this.container.addEventListener("mousemove",(function(){clearTimeout(e.mouseMoveTimerSuperPlayer),e.mouseMoveTimerSuperPlayer=setTimeout(e.hideMouseOnSuperPlayer.bind(e),5e3)}))}},t.prototype.hideMouseOnSuperPlayer=function(){var e,t;if(this.ctrlbarPlugin){var o=this.ctrlbarPlugin.instances.CtrlShow.isMouseHoverControl;this.config.autoHideMouse||(null===(e=this.ctrlbarPlugin.instances.Fullscreen)||void 0===e?void 0:e.isFullScreen)&&this.state===exports.VIDEO_STATE.PLAYING?o&&(this.container.style.cursor="auto"):(null===(t=this.ctrlbarPlugin.instances.FakeFullscreen)||void 0===t?void 0:t.isFullScreen)&&this.state===exports.VIDEO_STATE.PLAYING&&!o&&(this.container.style.cursor="none")}},t.prototype.setLevelOptions=function(e,t){var o;if(e){var r=e.list,n=(null===(o=r.find((function(e){return e.default||e.url===t})))||void 0===o?void 0:o.value)||r[0].value;this.setCommonKv(COMMON_DATA_KEY.currentDefn,n),this.setCommonKv(COMMON_DATA_KEY.currentDefnList,r),this.levelList=r,this.level=n,this.defnIdToUrl=e.callback}else this.setCommonKv(COMMON_DATA_KEY.currentDefn,void 0),this.setCommonKv(COMMON_DATA_KEY.currentDefnList,void 0),this.levelList=void 0,this.level=void 0,this.defnIdToUrl=void 0},t.prototype.isH5PlayParam=function(e){void 0===e&&(e={});var t=e;return!!(t.videoReqInfoParam||t.videoLoadParam||t.adParam||t.playTimeLimit)},t.prototype.initInnerEvts=function(){var e=this;this.pluginMsg.on(exports.PLAY_EVENT_EXT.GETINFO_OVER,(function(t){var o,r=(t.data||{}).resData,n=((null===(o=null==r?void 0:r.vl)||void 0===o?void 0:o.vi)||[])[0];if(n){var i=n.vw,a=n.vh;e.videoSizeFromGetInfo={width:i,height:a}}})),uaTool.mobile&&this.on(exports.H5_PLAY_EVENT.VIDEO_TIMEUPDATE,(function(t){var o=t.data;if(e.previewDuration!==NO_PREVIEW_FLAG){o.playtime>=e.previewDuration-10&&e.loadPostAd()}}))},t.prototype.writeGlobalCommonKvs=function(){this.setCommonKv(COMMON_DATA_KEY.appVer,"3.5.57"),this.setCommonKv(this.config.businessConfig),this.writeLoginCommonKV()},t.prototype.getDefnNameById=function(e){var t,o,r=null===(o=null===(t=this.getinfoCtx)||void 0===t?void 0:t.parseData)||void 0===o?void 0:o.definitionList.find((function(t){return t.name===e}));if(r){var n=formatDefnName(r.cname,this.type===exports.PLAY_MODE.LIVE),i=n[0],a=void 0===i?"":i,s=n[1];return"".concat(void 0===s?"":s," ").concat(a).trim()}return""},t.prototype.requestAdProxyHttp=function(e,t){var o;return __awaiter$1(this,void 0,void 0,(function(){var r,n,i,a,s;return __generator$1(this,(function(l){switch(l.label){case 0:if(r=new ProxyHttpRequestor(this.config,this.pluginMsg),!(n=getAdPlugin(this.config.instanceId)))return[2];i=n.getAdParams(__assign$2(__assign$2(__assign$2({},this.curReqInfo.getAdParam(e)),t),{vid:this.curReqInfo.vid,adType:e})),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,r.request(i,null)];case 2:return a=l.sent(),[3,4];case 3:return s=l.sent(),this.warn("proxyhttp request err in catch, ".concat(s)),[3,4];case 4:return(null===(o=null==a?void 0:a.parseData)||void 0===o?void 0:o.ad)&&n.setAdInfo(a.parseData.ad),[2,a]}}))}))},t.prototype.requestProxyHttp=function(e,t){var o,r,n,i;return __awaiter$1(this,void 0,void 0,(function(){var a,s,l,c,p,d;return __generator$1(this,(function(u){switch(u.label){case 0:return null===(o=this.proxyHttpRequestor)||void 0===o||o.destroy(),this.proxyHttpRequestor=new ProxyHttpRequestor(this.config,this.pluginMsg),"function"==typeof(null==(l=getAdPlugin(this.config.instanceId))?void 0:l.getAdParams)&&(a=l.getAdParams(__assign$2(__assign$2({},e.getAdParam(t)),{vid:e.vid,adType:t}))),"function"!=typeof(null===(r=this.videoReqInfoPlugin)||void 0===r?void 0:r.getReqParams)?[3,2]:[4,this.getinfoPlugin.getReqParams(e.vid,__assign$2(__assign$2({},e.videoReqInfoParam),{flowid:e.flowid}))];case 1:c=u.sent(),(s=c.reqParams).otype="ojson",u.label=2;case 2:return u.trys.push([2,4,,5]),[4,this.proxyHttpRequestor.request(a,s)];case 3:return p=u.sent(),[3,5];case 4:return d=u.sent(),this.warn("proxyhttp request err in catch, ".concat(d)),[3,5];case 5:return(null==p?void 0:p.error)?(this.warn("proxyhttp request error data: ",JSON.stringify(p.error)),[2]):((null===(n=null==p?void 0:p.parseData)||void 0===n?void 0:n.vinfo)?e.vinfoCache=Promise.resolve(p.parseData.vinfo):e.requestRawVod(),(null===(i=null==p?void 0:p.parseData)||void 0===i?void 0:i.ad)&&(e.adCache=p.parseData.ad),[2])}}))}))},t.prototype.stop=function(t){var o;return null===(o=this.proxyHttpRequestor)||void 0===o||o.destroy(),this.videoSizeFromGetInfo=null,e.prototype.stop.call(this,t)},t.prototype.emit=function(t,o){return e.prototype.emit.call(this,t,o)},t.prototype.on=function(t,o,r){return e.prototype.on.call(this,t,o,r)},t.prototype.once=function(t,o){return e.prototype.once.call(this,t,o)},t.prototype.off=function(t,o){return e.prototype.off.call(this,t,o)},t.prototype.listeners=function(t){return e.prototype.listeners.call(this,t)},t.prototype.listenerCount=function(t){return e.prototype.listenerCount.call(this,t)},t.prototype.writeLoginCommonKV=function(){var e,t,o,r=function(e){return cookieTool.get(e)},n=getUserCookies();this.setCommonKv(((e={})[COMMON_DATA_KEY.hc_main_login]=n[COOKIE_NAME.MAIN_LOGIN],e[COMMON_DATA_KEY.hc_vuserid]=n[COOKIE_NAME.VUSERID],e[COMMON_DATA_KEY.hc_openid]=n[COOKIE_NAME.OPENID],e[COMMON_DATA_KEY.hc_appid]=n[COOKIE_NAME.APPID],e[COMMON_DATA_KEY.hc_access_token]=n[COOKIE_NAME.ACCESS_TOKEN],e));var i=n[COOKIE_NAME.GUID]||cookieTool.get(COOKIE_NAME.GUID);i&&(this.setCommonKv(COMMON_DATA_KEY.guid,i),lsTool.setData(exports.LOCAL_KEY.GUID,i));var a="qq"===n[COOKIE_NAME.MAIN_LOGIN],s=null===(o=r("luin")||r("uin"))||void 0===o?void 0:o.replace(/\D/g,"").replace(/^0+/,"");this.setCommonKv(((t={})[COMMON_DATA_KEY.loginid]=a?s:r("openid"),t[COMMON_DATA_KEY.loginex]=a?r("openid"):s,t));this.setCommonKv(COMMON_DATA_KEY.logintype,{qq:1,wx:2}[n[COOKIE_NAME.MAIN_LOGIN]]||0),this.setCommonKv(COMMON_DATA_KEY.hc_vuession,n[COOKIE_NAME.VUSESSION])},t.prototype.getProxyHttpFlowNode=function(e){var t=this,o=e.reqInfo,r=e.adType,n=r===exports.AD_TYPE.PRE?function(){return o.vinfoCache?o.vinfoCache:t.shouldUseProxyHttpForGetInfo()?t.requestProxyHttp(o,exports.AD_TYPE.PRE):t.requestAdProxyHttp(exports.AD_TYPE.PRE)}:function(){return uaTool.mobile||t.previewLogic.previewDuration===NO_PREVIEW_FLAG?t.requestAdProxyHttp(exports.AD_TYPE.POST):Promise.resolve()};return new ProxyHttpFlowNode({flowid:o.flowid},n,r)},t.prototype.loadAdPlugin=function(){var e=this,t=this.config.enableCreativePlugin;if(!(void 0===t||t)||envVals.LOCAL_DEV||isInDomainWhiteList)return Promise.resolve();var o=getAdInitConfig(this.config);if(adInitDefer)return adInitDefer.then((function(){!getAdPlugin(e.config.instanceId)&&H5Player.getPlugin(AdPluginName)&&e.createPlugin(AdPluginName,o)}));var r=isOfficialDomain()&&this.config.adVersion?this.config.adVersion:adVersion,n="https://vm.gtimg.cn/thumbplayer/creative/".concat(r,"/creative-player-").concat(uaTool.mobile?"m":"v",".js");return adInitDefer=this.loadPlugin({url:n,globalName:adGlobalName,pluginName:AdPluginName,timeout:adScriptMaxLoadTime,config:o,crossOrigin:"anonymous"}).catch((function(t){e.log("adPlugin load fail. ".concat(null==t?void 0:t.message))}))},t.prototype.loadPlayerPlugins=function(e){return void 0===e&&(e=2),__awaiter$1(this,void 0,void 0,(function(){var t,o,r;return __generator$1(this,(function(n){switch(n.label){case 0:if(e<=0||!this.lazyPlugins.length)return[2];t=this.lazyPlugins.map((function(e){return"string"==typeof e?e:e[0]})),o=H5Player.getPlugins(t)||{},n.label=1;case 1:return n.trys.push([1,4,,5]),Object.keys(o).length===t.length?[3,3]:[4,domTool.loadScript(PLUGINS_URL,void 0,1e4)];case 2:n.sent(),n.label=3;case 3:return[2,this.createPlugins(this.lazyPlugins)];case 4:return r=n.sent(),this.log("super-player-plugins load fail. ".concat(null==r?void 0:r.message)),[3,5];case 5:return[4,this.loadPlayerPlugins(e-1)];case 6:return n.sent(),[2]}}))}))},t.prototype.clearBeforeReplay=function(){this.setCommonKv(exports.SUPER_DATA_KEY.hlsAdRanges,null),this.setCommonKv(exports.SUPER_DATA_KEY.getinfoAdInfo,null)},t.prototype.checkDegradeCodecFromLocal=function(){var e=readDegradeCodecFromLocal(),t=e.needDegrade,o=e.degradeReason;return this.log("codec degrade cache",t,o),t},t._instances={},__decorate([logMethodCall,__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],t.prototype,"destroy",null),__decorate([logMethodCall,__metadata("design:type",Function),__metadata("design:paramtypes",[Object,Object]),__metadata("design:returntype",Promise)],t.prototype,"play",null),__decorate([logMethodCall,__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],t.prototype,"replay",null),__decorate([logMethodCall,__metadata("design:type",Function),__metadata("design:paramtypes",[Object,Object]),__metadata("design:returntype",Promise)],t.prototype,"load",null),__decorate([logMethodCall,__metadata("design:type",Function),__metadata("design:paramtypes",[Object,Object,Number]),__metadata("design:returntype",Promise)],t.prototype,"preload",null),__decorate([logMethodCall,__metadata("design:type",Function),__metadata("design:paramtypes",[Number]),__metadata("design:returntype",void 0)],t.prototype,"seek",null),__decorate([logMethodCall,__metadata("design:type",Function),__metadata("design:paramtypes",[String,Object]),__metadata("design:returntype",Promise)],t.prototype,"setLevel",null),__decorate([logMethodCall,__metadata("design:type",Function),__metadata("design:paramtypes",[String]),__metadata("design:returntype",void 0)],t.prototype,"closePayTipsCallback",null),__decorate([logMethodCall,__metadata("design:type",Function),__metadata("design:paramtypes",[String,Object]),__metadata("design:returntype",void 0)],t.prototype,"createPlugin",null),__decorate([logMethodCall,__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",void 0)],t.prototype,"setAdConfig",null),__decorate([logMethodCall,__metadata("design:type",Function),__metadata("design:paramtypes",[String]),__metadata("design:returntype",void 0)],t.prototype,"stop",null),t}(H5Player),BUILD_TIME=envVals.BUILD_TIME,VERSION=envVals.VERSION;window.SuperPlayer=SuperPlayer,bindExports(SuperPlayer),exports.AdPluginName=AdPluginName,exports.BUILD_TIME=BUILD_TIME,exports.BaseCheck=BaseCheck,exports.BaseFlowNode=BaseFlowNode,exports.BaseReporter=BaseReporter,exports.BeaconRequest=BeaconRequest,exports.COMMON_DATA_KEY=COMMON_DATA_KEY,exports.CTRL_EVENTS=CTRL_EVENTS,exports.CtrlbarPluginName=CtrlbarPluginName,exports.DEFAULT_KEY=DEFAULT_KEY,exports.DEFAULT_SHOW_QUERY=DEFAULT_SHOW_QUERY,exports.DRM_TYPE=DRM_TYPE,exports.DRM_VALUE=DRM_VALUE,exports.ErrorPagePluginEvents=ErrorPagePluginEvents,exports.ErrorPagePluginName=ErrorPagePluginName,exports.EvtEmitter=s,exports.H5Player=H5Player,exports.H5_EXT_EVENT=exports.PLAY_EVENT_EXT,exports.INFO_SVG_DOM_STR=INFO_SVG_DOM_STR,exports.ImageRequest=report,exports.InfoPanelEvents=InfoPanelEvents,exports.InfoPanelPluginName=InfoPanelPluginName,exports.LAZY_PLUGINS=LAZY_PLUGINS,exports.LOCAL_STORAGE_KEY=LOCAL_STORAGE_KEY,exports.MaxRequestRetry=MaxRequestRetry,exports.OFFICIAL_PLUGIN=OFFICIAL_PLUGIN,exports.PLAY_CODEC=PLAY_CODEC,exports.PLUGINS_URL=PLUGINS_URL,exports.PLUGIN_MAP=PLUGIN_MAP,exports.POSTER_IMAGE_ALT=POSTER_IMAGE_ALT,exports.POSTER_IMAGE_CLASS_NAME=POSTER_IMAGE_CLASS_NAME,exports.Plugin=Plugin,exports.PosterPluginName=PosterPluginName,exports.RequestTimeout=RequestTimeout,exports.TipsPluginName=TipsPluginName,exports.UIContextMenuPluginName=UIContextMenuPluginName,exports.VERSION=VERSION,exports.VideoReqInfoPluginName=VideoReqInfoPluginName,exports.WaterMarkCoverClassName=WaterMarkCoverClassName,exports.WatermarkPluginName=WatermarkPluginName,exports.adEvents=adEvents,exports.adGlobalName=adGlobalName,exports.adScriptMaxLoadTime=adScriptMaxLoadTime,exports.adVersion=adVersion,exports.autobind=autobind,exports.bodyOverflowClassName=bodyOverflowClassName,exports.classNameOnCtrlHide=classNameOnCtrlHide,exports.classNameOnCtrlResize=classNameOnCtrlResize,exports.containerClassName=containerClassName,exports.contextMenuPluginName=contextMenuPluginName,exports.createH5Player=createH5Player,exports.createPluginFactory=createPluginFactory,exports.ctrlbarPluginName=ctrlbarPluginName,exports.dataRoleMap=dataRoleMap,exports.default=SuperPlayer,exports.defaultErrorMsg=defaultErrorMsg,exports.defaultErrorText=defaultErrorText,exports.defaultLiveBusinessConfig=defaultLiveBusinessConfig,exports.defaultShowTime=defaultShowTime,exports.defaultSuperConfig=defaultSuperConfig,exports.defaultVodBusinessConfig=defaultVodBusinessConfig,exports.defaultVodPlatform=defaultVodPlatform,exports.defautVodSdtfrom=defautVodSdtfrom,exports.definePlugins=definePlugins,exports.deregisterPlugin=deregisterPlugin,exports.formatDefnName=formatDefnName,exports.getAdInitConfig=getAdInitConfig,exports.getAdPlugin=getAdPlugin,exports.getBuiltInPlugins=getBuiltInPlugins,exports.getHookMethodName=getHookMethodName,exports.getLocalDynamicConfig=getLocalDynamicConfig,exports.getPlugin=getPlugin,exports.getPlugins=getPlugins,exports.getRootClassName=getRootClassName,exports.getSuperConfig=getSuperConfig,exports.gradientClassName=gradientClassName,exports.hideClass=hideClass,exports.i18nConfig=i18nConfig,exports.isFunctionPlugin=isFunctionPlugin,exports.isInDomainWhiteList=isInDomainWhiteList,exports.isPreOrPostAd=isPreOrPostAd,exports.isVideoId=isVideoId,exports.kernelEvtBus=kernelEvtBus,exports.largeSizeClassName=largeSizeClassName,exports.logApiInvoke=logApiInvoke,exports.mergeDynamicConfig=mergeDynamicConfig,exports.mobileRootClassName=mobileRootClassName,exports.once=once,exports.pcRootClassName=pcRootClassName,exports.pluginExists=pluginExists,exports.preloadEvtBus=preloadEvtBus,exports.registerPlugin=registerPlugin,exports.shadowClassName=shadowClassName,exports.skipAdDomainWhiteList=skipAdDomainWhiteList,exports.t=compile,Object.defineProperty(exports,"__esModule",{value:!0})}));

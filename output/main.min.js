"use strict";var support={localStorage:"localStorage"in window&&null!==window.localStorage},deftabsend={},tabajax={"rside-new":"ajax","rside-pop":"ajax","rside-newest":"ajax",poster:"ajax",fanart:"ajax",epinfo:"ajax",download:"ajax",similar:"ajax"},tabhash={settings:"hash"},tabhide={review:"hide",comments:"hide"},rewindInit=!1;function PlayerjsEvents(a,t,e){"new"==a&&svfunc.player.stat(),"play"==a&&markAuto.start(),"new"==a&&markAuto.stop(),"pause"==a&&markAuto.stop(),"stop"==a&&markAuto.stop(),"end"==a&&markAuto.stop(),"init"==a&&($("[data-player='wrap']").hasClass("premhd")?$("#htmlPlayer_control_hdout_text").css({color:"#f5b50c"}):$("#htmlPlayer_control_hdout_text").css({color:"#fff"})),"reload"==a&&svfunc.errorCorruption(),"error"==a&&"corruption"==e&&svfunc.errorCorruption(),"playlist"==a&&0==rewindInit&&(rewindInit=!0,svfunc.player.goToHash())}var svfunc={ulogin:function(){if(null==svfunc.loadUlogin){var a=document.createElement("script");a.setAttribute("src","//ulogin.ru/js/ulogin.js"),document.head.appendChild(a),svfunc.loadUlogin=1}},boxModal:function(a){var t=a.attr("href");null==t&&(t=a.data("modal")),void 0!==t&&svfunc.svmodal(t,"ajax"),(t.indexOf("mod=login")+1||t.indexOf("mod=reg")+1)&&svfunc.ulogin()},svmodal:function(a,t){$("#svmodal-o").add($("#svmodal")).remove(),$('<div id="svmodal"><div id="svmodal-in"></div><div id="svmodal-o" data-click="svmodalClose"><div id="svmodal-c">x</div></div></div>').appendTo("body");var e=$("#svmodal"),i=$("#svmodal-in"),n=$("#svmodal-o").add($("#svmodal-c"));if(i.html('<div class="svload"></div>'),"img"==t){var o=$('<img src="'+a+'" id="svmodal-in" data-click="svmodalClose">').fadeIn();e=i.replaceWith(o)}else"html"==t?i.html(a):$.ajax({url:a,dataType:"html",beforeSend:function(){i.html('<div class="svload"></div>')}}).done(function(a){i.html(a)});e.add(n).fadeIn()},svmodalClose:function(a){$("#svmodal").add($("#svmodal-o")).add($("#svmodal-c")).fadeOut(),$("#svmodal-in").remove()},notify:function(a){if(void 0!==a.txt){$(".svnotify").remove();var t=$("<div/>",{class:"svnotify",html:a.txt});a.type&&t.addClass(a.type),"function"==typeof a.callback?(t.appendTo("body"),a.callback(t)):t.appendTo("body").slideDown().delay(2e3).slideUp("slow",function(){$(this).remove()})}},msgClose:function(a){a.parent().hide(),Cookies.set("premiumend","know",{path:"/",expires:3})},tabcook:function(){var a=Cookies.get("hide");return a=null==a?{}:JSON.parse(a)},tabstoggle:function(a){var t=a.data("tabc"),e=svfunc.tabcook();!0!==e[t]?(e[t]=!0,$("[data-tabr="+t+"]").hide(),$("[data-tabc="+t+"]").addClass("act")):(e[t]=!1,$("[data-tabr="+t+"]").show(),$("[data-tabc="+t+"]").removeClass("act"),"comments"==t&&$("html, body").trigger("scroll")),Cookies.set("hide",JSON.stringify(e),{path:"/"})},"tabs-sh":function(){var a=svfunc.tabcook();for(var t in a)1==a[t]?($("[data-tabr="+t+"]").hide(),$("[data-tabc="+t+"]").addClass("act")):($("[data-tabr="+t+"]").show(),$("[data-tabc="+t+"]").removeClass("act"))},showRules:function(a){var t=a.data("rules")+"-rules";svfunc.svmodal($('[data-rules="'+t+'"]').html(),"html")},newsSw:function(a){svfunc.newsSwich(a),a.children().attr("disabled",function(a,t){return!t}),void 0!==Cookies.get("news")?Cookies.remove("news"):Cookies.set("news","img")},newsSwich:function(){var a=$(".news");a&&(a.toggleClass("img"),a.find(".news_i").length||a.find("a").each(function(a,t){$(this).prepend('<div class="pst news_i" style="background-image:url(http://cdn.seasonvar.ru/oblojka/small/'+$(this).data("id")+'.jpg)"></div>')}))},"index-blog-close":function(a){svfunc.userLogin?(Cookies.set("shownews",a.data("newsid"),{path:"/",expires:30}),a.parent().remove()):svfunc.svmodal("/?mod=login&nologin5=1")}};function viewHD(a){svfunc.player.swichHD()}function SvComplete(){this.click="",this.select=function(){var a=this.ul.find("li[aria-selected=true]");return"function"==typeof this.click?this.click(a.data("complete-id")):(this.input.val(a.text()),this.ul.hide()),!1},this.show=function(a){var t=this.ul,e=t.find("li[aria-selected=true]"),i=t.find("li");if(13==a)return e.length?this.select():t.closest("form").submit(),!1;if(27==a)return t.hide(),!1;if(i.attr("aria-selected",!1),38==a?(e.length||(e=i.first()),0==e.prev().length?e.siblings().last().attr("aria-selected",!0):e.prev().attr("aria-selected",!0)):40==a&&(e.length||(e=i.last()),0==e.next().length?e.siblings().first().attr("aria-selected",!0):e.next().attr("aria-selected",!0)),t.find("li[aria-selected=true]").length||(e=i.first().attr("aria-selected",!0)),e.length){e=i.first();var n=t.find("li[aria-selected=true]").position().top,o=t.scrollTop()+n;(n<0||n>t.height())&&t.scrollTop(o)}},this.res=[],this.input="",this.ul="",this.config=function(a){var t=this,e=$("<ul data-complite=list></ul>");a.input.attr("autocomplete","off").wrap('<div class="awesomplete"></div>'),a.input.after(e),this.ul=e,this.input=a.input,this.click=a.click,a.input.on("focus",function(){e.show()}),a.input.on("focusout",function(a){setTimeout(function(){e.hide()},1e3)}),e.on("click","li",function(){e.find("li").attr("aria-selected",!1),$(this).attr("aria-selected",!0),t.select()})}}svfunc.player={inside:$("[data-player=inside]").first(),load:function(a){"legal"!=a&&(a="html5"),$.ajax({url:"player.php",type:"POST",data:{id:svfunc.idSeason,serial:svfunc.idSerial,type:a,secure:data4play.secureMark,time:data4play.time},beforeSend:function(){svfunc.player.inside.html('<div class="svload"></div>')}}).done(function(a){svfunc.player.inside.html(a),svfunc["extPlayer-load"]()})},getSeries:function(){var a=0;return $("[data-player=html]").length&&(a=player.api("playlist_id")),a},getTime:function(){var a=0;return $("[data-player=html]").length&&-1==(a=player.api("time"))&&(a=0),a},parseHash:function(a){if(null==a)a=window.location.hash;var t={};return-1!=a.indexOf("rewind")&&(t.mark=a.split("=")[1],t.arMark=t.mark.split("_"),t.ser=t.arMark[0]+"_"+t.arMark[1],-1!=t.mark.indexOf("minute")?t.min=t.arMark[3]:t.min=0,-1!=t.mark.indexOf("sekunde")?t.sec=t.arMark[5]:t.sec=0),t},goToHash:function(a){window.countSeek=0;var t=svfunc.player.parseHash(),e=arEpisodes[mark.trans][t.ser];if(t.mark){var i=1;void 0!==(i="-1_seriya"==t.ser?1:void 0!==e?0==t.sec&&0==t.min&&void 0!==e.next?e.next:void 0!==e.next&&0!=e.d&&e.d-(60*t.min+parseInt(t.sec))<120?e.next:e.n:void 0)&&($(window).scrollTop($("[data-player=inside]").offset().top),svfunc.player.start(i))}},start:function(a){if($("[data-player=html]").length){var t=!0,e=svfunc.player.parseHash();if(e.min>0||e.sec>0){var i=60*e.min+parseInt(e.sec);player.api("play","id:"+a+"[seek:"+i+"]"),t=!1}else player.api("play","id:"+a),t=!1;t&&player.api("play","id:1")}},swichHDno:function(){svfunc.svmodal('<div class="pgs-player-tohd">HD качество доступно только для зарегистрированных пользователей с премиум аккаунтом<br><a href="http://seasonvar.ru/premium" target=_blank id="butonPremHD">Купить премиум</a></div>',"html")},swichHD:function(){null==Cookies.get("hdq")?(Cookies.set("hdq",1,{path:"/"}),$("[data-player=wrap]").removeClass("premhd"),$("[data-player=marks]").removeClass("premhd")):(Cookies.remove("hdq",{path:"/"}),$("[data-player=wrap]").addClass("premhd"),$("[data-player=marks]").addClass("premhd"));try{player.api("stop")}catch(a){}svfunc.player.load(void 0)},stat:function(){if($("[data-player=html]").length)var a=player.api("vars");var t=$("[data-click=translate].act").data("translate");if(void 0===t)var e=-1;else e=t;$.post("plStat.php",{id_season:svfunc.idSeason,file_id:a,serial_id:svfunc.idSerial,svid1:document.cookie.indexOf("svid1"),idTrans:e,page:window.popup})}},svfunc.errorCorruption=function(){$.post("ajax.php",{errorCorruption:svfunc.idSeason,file:player.api("vars"),time:player.api("time"),countryOnPage:$(".player-extBtn-getcode").text(),addrOnPage:data4play.addr},function(){},"json")},svfunc.masonry=function(a,t){null==a&&(a="[data-masonry=img]:visible",t="[data-click=imgShow]");var e=$(a).masonry();e.imagesLoaded(function(){e.masonry({itemSelector:t,gutter:0,isResizable:!1,isAnimated:!0})})},svfunc.fChange=function(a,t){var e=$("[data-filter=cName]:checked").val(),i=$("[data-filter=cRusLat]");"eng"==e?(i.parent().css({opacity:"1"}),i.prop("disabled",!1)):(i.parent().css({opacity:"0.5"}),i.prop("disabled",!0).prop("checked",!1));var n={quotG:[],notQuotG:[],quotC:[],notQuotC:[],quotY:[],moreY:[],underY:[],quotS:[],moreS:[],underS:[],quotR:[],moreR:[],underR:[],sortTo:[],engName:i.prop("checked")?"yes":"",only:e,rait:$("[data-filter=raitingW]:checked").val(),hd:$("[data-filter=hd]").prop("checked")?"yes":"",sub:$("[data-filter=sub]").prop("checked")?"yes":"",block:$("[data-filter=block]").prop("checked")?"yes":"",history:$("[data-filter=history]").prop("checked")?"yes":"",mark:$("[data-filter=mark]").prop("checked")?"yes":"",nw:$("[data-filter=notwatched]").prop("checked")?"yes":"",exp:$("[data-filter=notout]").prop("checked")?"yes":"",quotT:[]},o=$("[data-filter=countryNot]").prop("checked");return $("[data-filter=country]").each(function(){var a=$(this).val();"all"!=a&&(o?n.notQuotC.push(a):n.quotC.push(a))}),$("[data-filter=genre]").each(function(a,t){var e=$(this).val(),i=$(this).next().find("[data-filter=genreNot]").prop("checked");"all"!=e&&(i?n.notQuotG.push(e):n.quotG.push(e))}),$("[data-filter=year]").each(function(a,t){var e=$(this).val();if("all"!=e){var i=$(this).closest("[data-filter=yearWrap]").find("[data-filter=yearMore]:checked").val();"="==i?n.quotY.push(e):">"==i?n.moreY.push(e):"<"==i&&n.underY.push(e)}}),$("[data-filter=seasc]").each(function(a,t){var e=$(this).val();if("all"!=e){var i=$(this).closest("[data-filter=seascWrap]").find("[data-filter=seascMore]:checked").val();"="==i?n.quotS.push(e):">"==i?n.moreS.push(e):"<"==i&&n.underS.push(e)}}),$("[data-filter=raiting]").each(function(a,t){var e=$(this).val();if("all"!=e){var i=$(this).closest("[data-filter=raitingWrap]").find("[data-filter=raitingMore]:checked").val();"="==i?n.quotR.push(e):">"==i?n.moreR.push(e):"<"==i&&n.underR.push(e)}}),$("[data-filter=golosa]").each(function(a,t){var e=$(this).val();"all"!=e&&n.quotT.push(e)}),$("[data-filter=sort]").each(function(a,t){var e=$(this).val();"all"!=e&&n.sortTo.push(e)}),$.post("index.php",{filter:n,countFilter:"yes"},function(a){$("[data-filter=count]").text(a)}),n},svfunc.fShowResult=function(a,t){$.post("index.php",{filter:svfunc.fChange(),beforeSend:function(){$("[data-filter=result]").empty().html('<div class="svload"></div>')}},function(a){$("[data-filter=result]").empty().html(a),$("[data-filter=count]").text()>50?$("[data-tabg=letter]").first().trigger("click"):$("[data-tabg=letter]").trigger("click")})},svfunc.fGenreAdd=function(a){window.tmp=a;var t=$("[data-filter=genre]").first().closest("div").clone();t.find("label").last().remove(),a.closest("div").after(t)},svfunc.fShowRandom=function(){$.ajax({url:"/ajax.php",type:"POST",dataType:"html",data:{randSeasId:"30023"},beforeSend:function(){svfunc.svmodal('<div class="svload"></div>',"html")}}).done(function(a){svfunc.svmodal(a,"html")})},svfunc.editDiv=function(a){a.closest(".b-contenteditable").find("[data-editcall]").focus()},svfunc.showSerialInfo=function(a,t){var e=-15,i="right";if(1==t&&(i="top",e=0),a.hasClass("tooltipstered"))return!0;a.tooltipster({content:'<div class="svload"></div>',position:i,animation:"grow",delay:0,speed:0,offsetX:e,contentAsHTML:!0,updateAnimation:!1,functionBefore:function(t,e){e(),"cached"!==t.data("ajax")&&$.ajax({url:"/serialinfo/"+a.data("id")+"/",success:function(a){t.data("trailer")&&(a='<div class="serial-info">у данного сериала есть только трейлер</div>'+a),t.tooltipster("content",a).data("ajax","cached")}})}}).tooltipster("show")},svfunc.menuSH=function(a){var t=a.data("menubtn");$("[data-menures="+t+"]").hasClass("act")?($("[data-menures="+t+"]").hide().removeClass("act"),$("[data-menubtn="+t+"]").removeClass("act"),a.data("menuafter")&&svfunc[a.data("menuafter")](a)):($("[data-menures="+t+"]").show().addClass("act"),$("[data-menubtn="+t+"]").addClass("act"),a.data("menubefore")&&svfunc[a.data("menubefore")](a))};var $body=$("body");function addonBox(){if(window.chrome&&window.chrome.webstore&&window.chrome.runtime&&!Cookies.get("addon")){var a={type:"infoBox",txt:'<a href="https://chrome.google.com/webstore/detail/nabjlccebfffbgmmoadelclcoaflbhnn" class="pgs-extensions_download-chrome">Хотите получать уведомления о новых сериях? Установите расширение для браузера</a>',callback:function(a){a.show(),$('<div class="svnotify_close">&#10005;</div>').on("click",function(){a.hide(),Cookies.set("addon","alreadyshow",{path:"/"})}).appendTo(a)}};svfunc.notify(a)}}$(function(){$('[data-click="newsSw"]').length&&Cookies.get("news")&&svfunc.newsSwich();var a=$('[data-info="count"]');if(support.localStorage){var t=a.html();a.html().length>10?localStorage.setItem("sv_infoCount",t):a.html(localStorage.getItem("sv_infoCount"))}svfunc["tabs-sh"](),$body.on("mouseenter.tooltip","[data-serial=list] a",function(){svfunc.showSerialInfo($(this))});var e=$("[data-chgroup=filter]");e.length>0&&e.on("change","select, input",function(a){svfunc.fChange($(this),a)}),$body.on("mouseenter.tooltip","[data-help]",function(){if($(this).hasClass("tooltipstered"))return!0;$(this).tooltipster({content:'<div class="svload"></div>',animation:"grow",delay:0,speed:0,contentAsHTML:!0,functionBefore:function(a,t){t(),"cached"!==a.data("ajax")&&$.ajax({url:$(this).data("help"),success:function(t){a.tooltipster("content",t).data("ajax","cached")}})}}).tooltipster("show")}),$("[data-chgroup=filter]").length&&($("[data-chgroup=filter] [title]").tooltipster({animation:"fade",delay:300,speed:0}),$("[data-chgroup=filter] .btn_grp").on("click",function(a){if($(this).find("input").length>1){a.preventDefault();var t=$(this).find("input:checked").prop("checked",!1).parent().next().find("input").prop("checked",!0);0==t.length?$(this).find("input").first().prop("checked",!0):t.prop("checked",!0),svfunc.fChange()}}));$("[data-menu]").on("click mouseenter",function(a){a.preventDefault();var t=$(this).data("menu");"click"==a.type?($("[data-menur="+t+"]").slideToggle(100),$(this).toggleClass("act")):($("[data-menur="+t+"]").slideDown(100),$(this).addClass("act"))}),$("[data-menur]").on("mouseleave",function(){var a=$(this).data("menur");$("[data-menur="+a+"]").slideUp(100).removeClass("act"),$("[data-menu="+a+"]").removeClass("act")}),$(".headblock-menu").on("mouseleave",function(){if($("[data-menur=head]:hover").length)return!0;$("[data-menur=head]").slideUp(100).removeClass("act"),$("[data-menu=head]").removeClass("act")}),$body.on("click","[data-click]",function(a){a.preventDefault();var t=window[$(this).data("click")],e=svfunc[$(this).data("click")];"function"==typeof e?e($(this)):"function"==typeof t?t($(this)):console.log("Что-то ты не то кликаешь ибо сие не работает аки функция. Толи недописана, толи кто-то накосячил")}),$body.on("change","[data-change]",function(a){var t=svfunc[$(this).data("change")];"function"==typeof t?t($(this),a):"function"==typeof window[$(this).data("change")]?window[funcname]($(this),a):console.log("сие не работает аки функция, то ли недописана, то ли кто-то накосячил")}),$body.on("click","[data-tabt]",function(a){var t=$(this).prop("href");location.href!==t&&void 0!==t?location.href=t:a.preventDefault();var e=$(this).data("tabt"),i=$('[data-tabt="'+e+'"]'),n=$(this).data("tabg"),o=$('[data-tabc="'+e+'"]'),s=$('[data-tabr="'+e+'"]');if("letter"==n&&!$(this).hasClass("btn"))return i.toggleClass("act"),s.toggleClass("act").toggle(),!0;$('[data-tabg="'+n+'"]').removeClass("act");if(i.addClass("act"),void 0!==n){$("[data-tabgr="+n+"]").removeClass("act").hide(),"hash"==tabhash[n]&&(location.hash=e);$("[data-tabgc]").hide()}if(o.removeClass("act").show(),"hide"==tabhide[e]){var r=svfunc.tabcook();r[e]=!1,Cookies.set("hide",JSON.stringify(r),{path:"/"})}if(s.toggleClass("act").toggle(),"ajax"==tabajax[e])if("rightside"==n)s.html('<div id="svload"></div>'),s.load("/ajax.php?mode="+e.replace("rside-",""),{ganre:"",country:"",block:"0",main:"1"});else{var l={};null==deftabsend[e]?l[e]=svfunc.idSeason:l[e]=deftabsend[e],$.ajax({url:"/ajax.php",type:"POST",dataType:"html",data:l,success:function(a){s.html(a),"poster"==e||"fanart"==e?svfunc.masonry():"similar"==e&&svfunc.masonry(".pgs-afterplay-similar","a")},error:function(){s.html('<div class="pgs-msg">ошибка загрузки</div>')}}),delete l[e]}else"marks"==n?svfunc.masonry("[data-layout=marks]:visible","[data-marksel]"):"poster"==e||"fanart"==e?svfunc.masonry():"similar"==e&&svfunc.masonry(".pgs-afterplay-similar","a");"dopinfo"==n&&(null!=$(".spoilerText").html()&&($("#tab_dopinfo .spoiler").removeClass("spoiler"),$("#tab_dopinfo .show_spoiler").remove(),$("#tab_dopinfo .spoilerText").show().css({border:"0",padding:"0 0 0  2em"})))});var i=$("input[data-input=search]"),n=new SvComplete;n.config({input:i,click:function(a){""==n.res[a].url||null==n.res[a].url?n.input.val(""):(n.input.val(n.res[a].name.replace(/<.*>/g,"").replace(/\(.*сезон\)/,"")),location.href="/"+n.res[a].url)}});var o=null;i.on("keyup",function(a){var t=this.value,e=a.keyCode;if(38==e||40==e||13==e||39==e||37==e||27==e)return a.preventDefault(),n.show(e),!1;n.res=[];var i=$(this).next("[data-complite=list]");i.find("li").remove(),t.length>2&&(o=$.ajax({url:"/autocomplete.php?query="+t,type:"GET",dataType:"json",beforeSend:function(){null!=o&&o.abort()}}).done(function(a){a.id&&$.each(a.suggestions.valu,function(e,o){n.res.push({name:o,url:a.data[e],id:a.id[e]}),i.append("<li data-complete-id="+e+">"+o.replace(new RegExp(t,"i"),"<mark>$&</mark>")+a.suggestions.kp[e]+"</li>")})}))}),$(".awesomplete").on("mouseenter","[title]",function(){$(this).tooltipster({position:"right",animation:"fade",delay:300,speed:0}).tooltipster("show")});var s=$(".profile-menu");s.length>0&&(s.find('a[href="/'+profile+'"]').addClass("act"),s.find('a[href="/?mod='+profile+'"]').addClass("act")),svfunc.userLogin=!$('[data-click="boxModal"][href="/?mod=login"]').length;var r=$(".wrapper").position().top,l=$("<div/>",{html:"<span></span><div>наверх</div>",click:function(){$("html, body").stop().animate({scrollTop:r},"500","swing")}}).addClass("uppage"),d=r+500;l.appendTo($body),$(window).scroll(function(){$(this).scrollTop()>d?l.fadeIn("500"):l.fadeOut("500")}),$body.on("focusout","[contenteditable]",function(){var a=$(this),t=a.data("editcall");t.length>0&&svfunc[t](a)})}),$(window).on("load",function(){var a=$(".rside-result");if(a.length){var t=$(".content").outerHeight()-$(".rside-title").outerHeight();t<2e3&&(t=2e3),a.height()>t&&a.css({"max-height":t,overflow:"hidden"}).addClass("is-bottomhide")}}).on("click",function(a){var t=$(a.target);t.data("menubtn")||t.data("menures")||($("[data-menures]").hide().removeClass("act"),$("[data-menubtn]").removeClass("act"))});
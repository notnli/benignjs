!function(){"use strict";var R,o={n:function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(n,{a:n}),n},d:function(e,n){for(var t in n)o.o(n,t)&&!o.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},o:function(e,n){return Object.prototype.hasOwnProperty.call(e,n)}},n=Roblox,e=o.n(n),N=React,P=o.n(N),p=ReactDOM,A=ReactStyleGuide,D=ReactUtilities,I="enterEmail",B="enterCode",g="Label.Email",C="Response.InvalidEmail",T="Action.SendCode",L="Label.SixDigitCode",M="Label.CodeSent",V="Action.Resend",G="Action.Continue",U="Action.ChangeEmail",F="Description.EnterCodeHelpV3",H="Action.DidntReceiveCode",K="Response.TooManyAttemptsPleaseWait",W="Response.ErrorUseCorporateNetwork",j="Response.UnknownError",X="Response.IncorrectOtpCode",Y=3,z=6,$=8,q=2,J=429,Q="email",i=function(){return(i=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e}).apply(this,arguments)};function r(e,n){var t=i({},e);switch(n.type){case R.SET_ENTER_EMAIL_PAGE:return t.emailVerifyCodeModalPage=I,t;case R.SET_ENTER_CODE_PAGE:return t.emailVerifyCodeModalPage=B,t;case R.SET_EMAIL:return t.email=n.email,t;case R.SET_SESSION_TOKEN:return t.sessionToken=n.sessionToken,t;case R.SET_OTP_CODE:return t.code=n.code,t;case R.SET_LEGAL_CHECK:return t.isChecked=n.isChecked,t;case R.SET_CODE_VALID:return t.isCodeValid=n.isCodeValid,t;case R.SET_LOADING:return t.isLoading=n.isLoading,t;case R.SET_CHECKBOX_AND_CONTINUE_BUTTON_STATE:return t.isContinueButtonEnabled=n.isContinueButtonEnabled,t.isCheckboxEnabled=n.isCheckboxEnabled,t;case R.SET_ERROR:return t.errorMessage=n.errorMessage,t;case R.CLOSE_MODAL:return t.isModalOpen=!1,t;default:return e}}function f(e){var n=e.children,e=(t=(0,N.useReducer)(r,a))[0],t=t[1];return P().createElement(l.Provider,{value:{state:e,dispatch:t}},n)}function v(e){return new RegExp("^\\w+([-_+.]\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*$").test(e)}function Z(e){var n=e.ctx,t=e.field,o=e.btn,i=e.aType,r=e.errorCode,a=e.origin;(e={}).field=t,o&&(e.btn=o),i&&(e.aType=i),r&&(e.errorCode=r),a&&(e.origin=a),le.eventStreamService.sendEventWithTarget(se.formInteraction,n,e)}function ee(e,n,t){Z({ctx:e,field:ae.field.errorMessage,aType:ae.aType.shown,errorCode:n,origin:t})}function ne(e,n,t){le.eventStreamService.sendEventWithTarget(se.buttonClick,e,{btn:n,origin:t})}function te(e,n,t){le.eventStreamService.sendEventWithTarget(se.modalAction,e,{aType:n,origin:t})}function oe(e){var n=e.id,t=e.legalText,o=void 0!==(i=e.isChecked)&&i,i=void 0!==(i=e.disabled)&&i,e=e.onCheckBoxChanged;return P().createElement("div",{className:"legal-text-container"},P().createElement("div",{className:"terms-agreement terms-agreement-checkbox"},P().createElement("input",{id:n,className:"checkbox",type:"checkbox",checked:o,onChange:e,disabled:i}),P().createElement("label",{htmlFor:n,dangerouslySetInnerHTML:{__html:t}})))}function ie(e){return n.EnvironmentUrls.apiGatewayUrl+"/otp-service/v1/"+e}(t=R=R||{})[t.SET_ENTER_EMAIL_PAGE=0]="SET_ENTER_EMAIL_PAGE",t[t.SET_ENTER_CODE_PAGE=1]="SET_ENTER_CODE_PAGE",t[t.SET_EMAIL=2]="SET_EMAIL",t[t.SET_SESSION_TOKEN=3]="SET_SESSION_TOKEN",t[t.SET_OTP_CODE=4]="SET_OTP_CODE",t[t.SET_LEGAL_CHECK=5]="SET_LEGAL_CHECK",t[t.SET_CODE_VALID=6]="SET_CODE_VALID",t[t.SET_LOADING=7]="SET_LOADING",t[t.SET_CHECKBOX_AND_CONTINUE_BUTTON_STATE=8]="SET_CHECKBOX_AND_CONTINUE_BUTTON_STATE",t[t.SET_ERROR=9]="SET_ERROR",t[t.CLOSE_MODAL=10]="CLOSE_MODAL";var a={emailVerifyCodeModalPage:I,email:"",sessionToken:"",code:"",isChecked:!1,isCheckboxEnabled:!1,isLoading:!1,isCodeValid:!1,isContinueButtonEnabled:!1,errorMessage:"",isModalOpen:!0},l=(0,N.createContext)(null),re=function(){var e=(0,N.useContext)(l);if(null===e)throw new Error("EmailVerifyCodeModalContext was not provided in the current scope");return e},t={common:["Common.Captcha"],feature:"Authentication.Login"},ae={eventName:{loginOtherDevice:"loginOtherDevice",formValidation:"formValidation"},context:{loginPage:"loginPage",loginForm:"LoginForm",landingPage:"Multiverse",signupForm:"MultiverseSignupForm",sendOTP:"sendOTP",enterOTP:"enterOTP",validateOTP:"validateOTP",disambiguationOTP:"disambiguationOTP",disambiguationEmail:"disambiguationEmail",disambiguationPhone:"disambiguationPhone"},aType:{buttonClick:"buttonClick",click:"click",offFocus:"offFocus",focus:"focus",shown:"shown",dismissed:"dismissed"},field:{loginOtherDevice:"loginOtherDevice",loginOTP:"loginOTP",loginSubmitButtonName:"loginSubmit",password:"password",username:"username",signupSubmitButtonName:"signupSubmit",appButtonClickName:"AppLink",showPassword:"showPassword",hidePassword:"hidePassword",birthdayDay:"birthdayDay",birthdayMonth:"birthdayMonth",birthdayYear:"birthdayYear",signupUsername:"signupUsername",signupPassword:"signupPassword",signupEmail:"signupEmail",parentEmail:"parentEmail",genderMale:"genderMale",genderFemale:"genderFemale",email:"email",otpCode:"OTPcode",errorMessage:"errorMessage",accountSelection:"accountSelection",checked:"checked",unchecked:"unchecked",usernameValid:"usernameValid"},btn:{cancel:"cancel",sendCode:"sendCode",resendCode:"resendCode",login:"login",signup:"signup",continue:"continue",changeEmail:"changeEmail",parentalConsentCheckbox:"pc_checkbox",termsOfServiceCheckbox:"tos_checkbox",privacyPolicyCheckbox:"pp_checkbox"},input:{redacted:"[Redacted]"},origin:{webVerifiedSignup:"WebVerifiedSignup",signup:"signup",login:"login"}},le=CoreRobloxUtilities,se=le.eventStreamService.eventTypes,ce=(0,D.withTranslations)(function(e){function n(){p(!0),ne(f,ae.btn.sendCode,t),r()}var t=e.origin,o=e.titleText,i=e.descriptionText,r=e.onSendCode,a=e.errorMessage,l=e.onClose,s=e.translate,e=re(),c=e.state.email,d=e.dispatch,e=(0,N.useState)(!0),u=e[0],E=e[1],e=(0,N.useState)(!1),m=e[0],p=e[1],f=ae.context.sendOTP,h=(0,D.useDebounce)(c,200);(0,N.useEffect)(function(){var e;u&&0<c.length&&(E(!1),e=t,Z({ctx:ae.context.sendOTP,field:ae.field.email,origin:e})),!v(h)&&0<h.length?d({type:R.SET_ERROR,errorMessage:s(C)}):d({type:R.SET_ERROR,errorMessage:""})},[h]),(0,N.useEffect)(function(){a&&p(!1)},[a]);return(0,N.useEffect)(function(){te(f,ae.aType.shown,t)},[]),P().createElement(N.Fragment,null,P().createElement(A.Modal.Header,{title:o,onClose:function(){ne(f,ae.btn.cancel,t),te(f,ae.aType.dismissed,t),l()}}),P().createElement(A.Modal.Body,null,P().createElement("p",{className:"email-verify-code-help-text"},i),P().createElement("input",{placeholder:s(g),onChange:function(e){return e=e.target.value,void d({type:R.SET_EMAIL,email:e})},type:"email",autoFocus:!0,className:"form-control input-field email-verify-code-input",autoComplete:"email",maxLength:320,onKeyPress:function(e){"Enter"===e.key&&v(c)&&!m&&n()},value:c}),P().createElement("p",{className:"text-error input-validation email-verify-code-error-text"},a),P().createElement(A.Button,{className:"email-verify-code-button",variant:A.Button.variants.secondary,isDisabled:m||!v(c),onClick:n},s(T))))},t),de=(0,D.withTranslations)(function(e){function n(){var n;S(!1),0===_&&(n=setInterval(function(){O(function(e){return 1===e&&(clearInterval(n),S(!0)),e-1})},1e3)),O(30)}function t(){ne(w,ae.btn.resendCode,i),m(),n()}function o(e){var n,t,o;b({type:R.SET_LEGAL_CHECK,isChecked:e.target.checked}),n=w,t=ae.btn.parentalConsentCheckbox,o=e.target.checked,e=i,le.eventStreamService.sendEventWithTarget(se.buttonClick,n,{btn:t,field:o?ae.field.checked:ae.field.unchecked,origin:e})}var i=e.origin,r=e.titleText,a=e.descriptionText,l=e.legalCheckboxLabel,s=e.code,c=e.codeLength,d=e.isCheckboxEnabled,u=e.isContinueButtonEnabled,E=e.onContinueButtonPressed,m=e.onResendCode,p=e.onClose,f=e.translate,h=e.isChangeEmailEnabled,g=re(),C=g.state,e=C.email,T=C.isChecked,v=C.isLoading,C=C.errorMessage,b=g.dispatch,g=(0,N.useState)(!0),y=g[0],S=g[1],g=(0,N.useState)(0),_=g[0],O=g[1],g=(0,N.useState)(!0),k=g[0],x=g[1],g=(0,D.useDebounce)(s,200),w=ae.context.enterOTP;(0,N.useEffect)(function(){var e;k&&0<s.length&&(x(!1),e=i,Z({ctx:ae.context.enterOTP,field:ae.field.otpCode,origin:e}))},[g]);e=P().createElement("div",{className:"email-verify-code-help-text",dangerouslySetInnerHTML:{__html:"<p className='email-verify-code-help-text'>"+f(F,{email:"<b>"+e+"</b>"})+"</p>"}});return(0,N.useEffect)(function(){te(w,ae.aType.shown,i),n()},[]),P().createElement(N.Fragment,null,P().createElement(A.Modal.Header,{title:r,onClose:function(){ne(w,ae.btn.cancel,i),te(w,ae.aType.dismissed,i),p()}}),P().createElement(A.Modal.Body,null,h?P().createElement(N.Fragment,null,e,P().createElement("div",{className:"email-verify-code-email-display"},P().createElement("button",{className:"email-verify-code-change-email-link text-link",type:"button",onClick:function(){b({type:R.SET_ENTER_EMAIL_PAGE}),ne(w,ae.btn.changeEmail,i)}},f(U)))):P().createElement("p",{className:"email-verify-code-help-text"},a),P().createElement("input",{placeholder:f(L),onChange:function(e){return function(e){b({type:R.SET_ERROR,errorMessage:""});e=e.replace(/\D/g,"");b({type:R.SET_OTP_CODE,code:e})}(e.target.value)},type:"text",inputMode:"numeric",maxLength:c,autoFocus:!0,className:"form-control input-field email-verify-code-input",value:s,disabled:v}),P().createElement("p",{className:"text-error email-verify-code-error-text"},C),P().createElement(function(){return l?P().createElement("div",{className:"legal-checkbox-container"},P().createElement(oe,{id:"parent-consent",legalText:l,isChecked:T,disabled:!d,onCheckBoxChanged:o})):null},null),P().createElement(function(){return l?P().createElement(A.Button,{className:"email-verify-code-button",variant:A.Button.variants.primary,onClick:E,isDisabled:!u},f(G)):null},null),P().createElement(function(){return v?P().createElement(A.Loading,null):P().createElement(A.Button,{className:"email-verify-code-button",variant:A.Button.variants.secondary,onClick:t,isDisabled:!y},y?f(V):f(M)+" ("+_+")")},null),P().createElement(function(){return l?null:P().createElement("div",{className:"font-caption-header email-verify-code-help-link"},P().createElement("a",{className:"text-link",href:"https://en.help.roblox.com/hc/articles/11014749736980",target:"_blank",rel:"noreferrer"},f(H)))},null)))},{common:[],feature:"Authentication.OneTimePasscode"}),ue=CoreUtilities,Ee=function(e,a,l,s){return new(l=l||Promise)(function(t,n){function o(e){try{r(s.next(e))}catch(e){n(e)}}function i(e){try{r(s.throw(e))}catch(e){n(e)}}function r(e){var n;e.done?t(e.value):((n=e.value)instanceof l?n:new l(function(e){e(n)})).then(o,i)}r((s=s.apply(e,a||[])).next())})},me=function(t,o){var i,r,a,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:n(0),throw:n(1),return:n(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function n(n){return function(e){return function(n){if(i)throw new TypeError("Generator is already executing.");for(;l;)try{if(i=1,r&&(a=2&n[0]?r.return:n[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,n[1])).done)return a;switch(r=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return l.label++,{value:n[1],done:!1};case 5:l.label++,r=n[1],n=[0];continue;case 7:n=l.ops.pop(),l.trys.pop();continue;default:if(!(a=0<(a=l.trys).length&&a[a.length-1])&&(6===n[0]||2===n[0])){l=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){l.label=n[1];break}if(6===n[0]&&l.label<a[1]){l.label=a[1],a=n;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(n);break}a[2]&&l.ops.pop(),l.trys.pop();continue}n=o.call(t,l)}catch(e){n=[6,e],r=0}finally{i=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,e])}}},pe=function(e,a,l,s){return new(l=l||Promise)(function(t,n){function o(e){try{r(s.next(e))}catch(e){n(e)}}function i(e){try{r(s.throw(e))}catch(e){n(e)}}function r(e){var n;e.done?t(e.value):((n=e.value)instanceof l?n:new l(function(e){e(n)})).then(o,i)}r((s=s.apply(e,a||[])).next())})},fe=function(t,o){var i,r,a,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:n(0),throw:n(1),return:n(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function n(n){return function(e){return function(n){if(i)throw new TypeError("Generator is already executing.");for(;l;)try{if(i=1,r&&(a=2&n[0]?r.return:n[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,n[1])).done)return a;switch(r=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return l.label++,{value:n[1],done:!1};case 5:l.label++,r=n[1],n=[0];continue;case 7:n=l.ops.pop(),l.trys.pop();continue;default:if(!(a=0<(a=l.trys).length&&a[a.length-1])&&(6===n[0]||2===n[0])){l=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){l.label=n[1];break}if(6===n[0]&&l.label<a[1]){l.label=a[1],a=n;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(n);break}a[2]&&l.ops.pop(),l.trys.pop();continue}n=o.call(t,l)}catch(e){n=[6,e],r=0}finally{i=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,e])}}},h=(0,D.withTranslations)(function(e){e.containerId;var n=e.codeLength,t=e.onEmailCodeEntered,o=e.onComplete,i=e.onModalAbandoned,r=e.enterEmailTitle,a=e.enterEmailDescription,l=e.enterCodeTitle,s=e.enterCodeDescription,c=e.legalCheckboxLabel,d=e.origin,u=e.translate,E=e.isChangeEmailEnabled,m=void 0!==E&&E,p=re(),f=p.state,h=f.emailVerifyCodeModalPage,g=f.email,C=f.sessionToken,T=f.code,v=f.isChecked,b=f.isCheckboxEnabled,y=f.isLoading,S=f.isCodeValid,e=f.errorMessage,E=f.isModalOpen,_=f.isContinueButtonEnabled,O=p.dispatch,k=(0,D.useDebounce)(T,200);(0,N.useEffect)(function(){t&&!c&&k.length===n?(M(),O({type:R.SET_LOADING,isLoading:!0}),ne(ae.context.enterOTP,ae.btn.login,d)):c&&O({type:R.SET_CHECKBOX_AND_CONTINUE_BUTTON_STATE,isContinueButtonEnabled:k.length===n&&v,isCheckboxEnabled:k.length===n})},[k,v]),(0,N.useEffect)(function(){c&&o&&S?(O({type:R.CLOSE_MODAL}),te(ae.context.enterOTP,ae.aType.dismissed,d),ne(ae.context.enterOTP,ae.btn.signup,d),o({otpSessionToken:C,otpContactType:Q})):t&&t(C,k)},[S]),(0,N.useEffect)(function(){function e(e){if(e.detail){if(e.detail.shouldCloseModal)return void w();O({type:R.SET_ERROR,errorMessage:e.detail.errorMessage})}O({type:R.SET_OTP_CODE,code:""}),O({type:R.SET_LOADING,isLoading:!1})}return window.addEventListener("onEnterEmailVerifyCodeError",e),function(){window.removeEventListener("onEnterEmailVerifyCodeError",e)}},[]),(0,N.useEffect)(function(){window.addEventListener("closeEmailVerifyCodeModal",w)},[]);function x(e,n){var t=e.data,e=e.status;return O({type:R.SET_LOADING,isLoading:!1}),t===z?(O({type:R.SET_ERROR,errorMessage:u(K)}),void ee(n,String(t),d)):t===$?(O({type:R.SET_ERROR,errorMessage:u(W)}),void ee(n,String(t),d)):t===q?(O({type:R.SET_ERROR,errorMessage:u(X)}),void ee(n,String(t),d)):e===J?(O({type:R.SET_ERROR,errorMessage:u(K)}),void ee(n,String(e),d)):t===Y?(ee(n,String(t),d),void L()):(ee(n,String(t),d),void O({type:R.SET_ERROR,errorMessage:u(j)}))}var w=function(){i(),O({type:R.CLOSE_MODAL})},L=function(){return pe(void 0,void 0,void 0,function(){var n;return fe(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,(t={origin:d,contactType:Q,contactValue:g},Ee(void 0,void 0,Promise,function(){var n;return me(this,function(e){switch(e.label){case 0:return n=ie("sendCode"),n={url:n,withCredentials:!0},[4,ue.httpService.post(n,t)];case 1:return[2,e.sent().data]}})}))];case 1:return n=e.sent(),O({type:R.SET_SESSION_TOKEN,sessionToken:null!==(n=null==n?void 0:n.otpSessionToken)&&void 0!==n?n:""}),O({type:R.SET_ERROR,errorMessage:""}),O({type:R.SET_ENTER_CODE_PAGE}),[3,3];case 2:return n=e.sent(),x(n,ae.context.sendOTP),[3,3];case 3:return[2]}var t})})},M=function(){return pe(void 0,void 0,void 0,function(){var n;return fe(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,(t={passCode:k,otpSessionToken:C,contactType:Q,origin:d},Ee(void 0,void 0,Promise,function(){var n;return me(this,function(e){switch(e.label){case 0:return n=ie("validateCode"),n={url:n,withCredentials:!0},[4,ue.httpService.post(n,t)];case 1:return[2,e.sent().data]}})}))];case 1:return e.sent(),O({type:R.SET_CODE_VALID,isCodeValid:!0}),[3,3];case 2:return n=e.sent(),x(n,ae.context.validateOTP),[3,3];case 3:return[2]}var t})})};return P().createElement(A.Modal,{className:"email-verify-code-modal",show:E,size:"lg",backdrop:"static",onHide:w},P().createElement(N.Fragment,null,h===I&&P().createElement(ce,{origin:d,titleText:r,descriptionText:a,onSendCode:L,errorMessage:e,onClose:w,translate:u}),h===B&&C&&P().createElement(de,{origin:d,titleText:l,descriptionText:s,legalCheckboxLabel:c,code:T,codeLength:n,onContinueButtonPressed:function(){_&&(ne(ae.context.enterOTP,ae.btn.continue,d),M())},onResendCode:function(){return pe(void 0,void 0,void 0,function(){var n;return fe(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,(t={contactType:Q,origin:d,otpSessionToken:C},Ee(void 0,void 0,Promise,function(){var n;return me(this,function(e){switch(e.label){case 0:return n=ie("resendCode"),n={url:n,withCredentials:!0},[4,ue.httpService.post(n,t)];case 1:return[2,e.sent().data]}})}))];case 1:return n=e.sent(),O({type:R.SET_SESSION_TOKEN,sessionToken:null!==(n=null==n?void 0:n.otpSessionToken)&&void 0!==n?n:""}),O({type:R.SET_ERROR,errorMessage:""}),[3,3];case 2:return n=e.sent(),x(n,ae.context.enterOTP),[3,3];case 3:return[2]}var t})})},isLoading:y,isContinueButtonEnabled:_,isCheckboxEnabled:b,isChecked:v,errorMessage:e,onClose:w,translate:u,isChangeEmailEnabled:m})))},t),t={renderEmailVerifyCodeModal:t=function(e){var n=e.containerId,t=e.codeLength,o=e.onEmailCodeEntered,i=e.onComplete,r=e.onModalAbandoned,a=e.enterEmailTitle,l=e.enterEmailDescription,s=e.enterCodeTitle,c=e.enterCodeDescription,d=e.legalCheckboxLabel,u=e.origin,E=e.translate,m=e.isChangeEmailEnabled,e=document.getElementById(n);return null!=e&&((0,p.unmountComponentAtNode)(e),(0,p.render)(P().createElement(f,null,P().createElement(h,{containerId:n,codeLength:t,onEmailCodeEntered:o,onModalAbandoned:r,legalCheckboxLabel:d,onComplete:i,enterEmailTitle:a,enterEmailDescription:l,enterCodeTitle:s,enterCodeDescription:c,origin:u,translate:E,isChangeEmailEnabled:m})),e),!0)}};Object.assign(e(),{EmailVerifyCodeModalService:t})}();
//# sourceMappingURL=https://js.rbxcdn.com/ee9e6ae1c3c46607817fe67c469c4c7f-emailVerifyCodeModal.bundle.min.js.map

/* Bundle detector */
window.Roblox && window.Roblox.BundleDetector && window.Roblox.BundleDetector.bundleDetected("EmailVerifyCodeModal");
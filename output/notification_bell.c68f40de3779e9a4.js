!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("CAAS_AOLCOM",[],t):"object"==typeof exports?exports.CAAS_AOLCOM=t():e.CAAS_AOLCOM=t()}(self,(function(){return function(){"use strict";var e={d:function(t,n){for(var i in n)e.o(n,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:n[i]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r:function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function a(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,a=function(e,t){if("object"!==n(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,"string");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key),"symbol"===n(a)?a:String(a)),o)}var a}e.r(t),e.d(t,{default:function(){return l}});var r="aol_already_seen",c="aol-notifications-wrap-overlay",s={chrome:"https://s.yimg.com/cv/apiv2/default/20190821/settings-chrome.png",firefox:"https://s.yimg.com/cv/apiv2/default/20190821/settings-firefox.png",edge:"https://s.yimg.com/cv/apiv2/default/20190821/settings-edge.png",safari:"https://s.yimg.com/cv/apiv2/default/20190821/settings-safari.png"},l=new(function(){function e(t){var n=t.selector;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.elems=function(e,t,n){if(t&&!Array.isArray(t)&&"number"==typeof t.length){var i=t.length;return o(t,i)}return e(t,n)}(i,document.querySelectorAll(n)),this.elems.length){try{this.notifications=JSON.parse(this.elems[0].dataset.configObject)}catch(e){return void console.log("Issue parsing notifications ".concat(e))}this.notificationPanel=document.getElementById("header-notification-panel"),this.notificationBadge=document.getElementById("header-notification-badge"),this.userBrowser=window.NEXUtils.getBrowser(window.navigator.userAgent),this.init()}}var t,n;return t=e,(n=[{key:"init",value:function(){this.countNewNotifications(),this.eventListeners(),this.buildPanel()}},{key:"eventListeners",value:function(){var e=this,t=document.getElementById("aol-bell-notifications");t.addEventListener("mouseleave",(function(){e.notificationPanel.classList.remove("active"),e.notificationBadge.classList.remove("activeBadge");for(var t=document.getElementsByClassName("breaking-notification"),n=0;n<t.length;++n)t[n].classList.add("already_seen");e.writeIdsToStorage()})),t.addEventListener("mouseenter",(function(){e.notificationPanel.classList.add("active")}))}},{key:"writeIdsToStorage",value:function(){var e=[];this.notifications.forEach((function(t){e.push(t.id)})),window.localStorage.setItem(r,JSON.stringify(e))}},{key:"onClickNotifyMe",value:function(e){var t=this,n=window.document.getElementById("aol-blocked-notifications");e.addEventListener("click",(function(){var i=document.getElementById(c),o=document.getElementById("aol-permission-notification-banner"),a=document.getElementById("aol-blocked-notifications-body");window.NEXUtils.requestPermission(c,(function(r){if(t.notificationPanel.removeChild(e),i.classList.remove("shown"),o.classList.remove("shown"),a.childElementCount>1&&a.removeChild(a.lastChild),!r){var c=s[t.userBrowser];if(c){var l=window.document.createElement("img");l.classList.add("blocked-notifications-body-image"),l.src=c,a.appendChild(l)}else{var d=window.document.createElement("p");d.classList.add("blocked-notifications-body-text"),d.textContent="If you’d like to allow notifications, please go into your browser’s Website or Privacy settings and set the permissions for AOL.com to “Allow.”",a.appendChild(d)}n.classList.add("shown"),n.addEventListener("click",(function(){n.classList.remove("shown")}))}}))}))}},{key:"checkPermission",value:function(){if(Notification&&"default"===Notification.permission){var e=document.createElement("div");e.classList.add("notifications-section"),e.classList.add("notifications-activate");var t=document.createElement("p");t.classList.add("notifications-text"),t.textContent="Get breaking news and big stories on your desktop.",e.appendChild(t);var n=document.createElement("div");n.id="activate-notifications",n.classList.add("btn"),n.classList.add("notifications-cta"),n.textContent="Notify Me",e.appendChild(n),this.notificationPanel.appendChild(e),this.onClickNotifyMe(e),document.addEventListener("NotificationPermissionBanner:click",(function(){e&&e.parentNode.removeChild(e)}))}}},{key:"buildPanel",value:function(){var e=this,t=window.localStorage.getItem(r)||"[]";try{t=JSON.parse(t)}catch(e){return void window.localStorage.removeItem(r)}var n=t.reduce((function(e,t){return e[t]=t,e}),{});this.checkPermission(),this.notifications.forEach((function(t){var i=document.createElement("div");i.classList.add("breaking-notification"),n[t.id]&&i.classList.add("already_seen");var o=document.createElement("div");o.classList.add("breaking-notification_image");var a=document.createElement("a");a.href=t.click_url;var r=document.createElement("img");r.src=t.image_url,a.appendChild(r),o.appendChild(a);var c=document.createElement("div");c.classList.add("breaking-notification_text");var s=document.createElement("a");s.href=t.click_url,s.textContent=t.text,c.appendChild(s);var l=document.createElement("div");l.classList.add("breaking-notification_time");var d=document.createElement("p");d.textContent=t.days_from_publish,l.appendChild(d),i.appendChild(o),i.appendChild(c),i.appendChild(l),e.notificationPanel.appendChild(i)}))}},{key:"countNewNotifications",value:function(){var e=0,t=window.localStorage.getItem(r);if(t){try{t=JSON.parse(t)}catch(e){this.addValueToBadge(5)}var n=t.reduce((function(e,t){return e[t]=t,e}),{});this.notifications.forEach((function(t){n[t.id]||(e+=1)})),e>0&&this.addValueToBadge(e)}else e=5,this.addValueToBadge(e)}},{key:"addValueToBadge",value:function(e){this.notificationBadge.textContent=e,this.notificationBadge.classList.add("activeBadge")}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}())({selector:".aol-notification-bell"});return t}()}));
//# sourceMappingURL=notification_bell.js.map
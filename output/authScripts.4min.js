Authenticate={};Authenticate.returnTo=null;Authenticate.promoCouponCode=null;(function(a){a.fn.loginForm=function(){return this.each(function(){var f=a(this);var e=a(".jsInputLogin",f);var b=a(".jsInputPassword",f);var c=a(".jsErrorPlace",f).hide();var d=a(".capsWarning",f).hide();var g=false;e.add(b).keydown(function(){if(event.keyCode==13){f.submit();return false}});f.submit(function(){if(g){return true}var h=e.val();var i=b.val();c.text("").hide();a.ajax({type:"get",url:Config.mainSiteUrlHttpsPath+"web/login/validate",data:{login:h,password:i},dataType:"jsonp",success:function(j){g=j.success;if(!g){c.text(j.errorMessage).show()}else{f.submit()}},error:function(j){g=true;f.submit()}});return false});b.caps(function(h){h?d.slideDown("slow"):d.slideUp("slow")})})}}(jQuery));(function(){var c="postAuthenticate=";var d={};Authenticate.showPopup=function(f){f=$.extend({returnTo:null,isSignUp:false,title:"",promoCouponCode:null,postAuthenticateParams:null,showLoginPopup:!Config.is4Sync},f);var j={};if(f.postAuthenticateParams&&f.postAuthenticateParams.eventName){if(!f.returnTo){f.returnTo=document.location.href}var h=JSON.stringify(f.postAuthenticateParams);var g=encodeURIComponent(h).replace(/'/g,"%27");f.returnTo+=(f.returnTo.indexOf("#")!=-1?"&":"#")+c+g}if(f.returnTo){j.returnTo=encodeURIComponent(f.returnTo)}if(f.promoCouponCode){j.promoCouponCode=f.promoCouponCode}if(f.showLoginPopup){Authenticate.returnTo=f.returnTo;Authenticate.promoCouponCode=f.promoCouponCode;e(f)}else{i(f)}function i(){$("body").css("cursor","wait");$.get("/authPopup.jsp",j,function(m){$("body").css("cursor","");m=$("<div/>").html(m);var l=PopupModule.popup({title:$(".jsAuthTitle",m).val(),element:m});k(l,f.isSignUp)});function k(l,n){$("form.jsLoginForm",l).loginForm();$("#loginSide",l).bind("click focus",function(){$(this).addClass("active");$("#signupSide").removeClass("active")});$("#signupSide",l).bind("click focus",function(){$(this).addClass("active");$("#loginSide").removeClass("active")});var m=n?$("#signupEmailField, #signupPassField, #signupPassFieldRepeat"):$("#loginfield, #passfield");m.focusP();m.click();m=n?$("#signupEmailField"):$("#loginfield");m.focusP()}}function e(k){if(k.isSignUp){$("#signupPopup").modal("show")}else{$("#loginPopup").modal("show")}}};Authenticate.fillLoginPopup=function(e){var g=Authenticate.returnTo||decodeURIComponent(e.find(".jsReturnToOriginal").val());if(g){if(g.indexOf("#")==-1){g=g+document.location.hash}var f=encodeURIComponent(g);$(".jsReturnTo",e).val(f);var i=$(".jsTwBtn",e);if(i.length){i.attr("href",Utils.padURLParameter(i.attr("href"),"fp",g))}var j=$(".jsFbBtn",e);if(j.length){j.attr("href",Utils.padURLParameter(j.attr("href"),"fp",f))}var h=$(".jsGpBtn",e);if(h.length){h.attr("href",Utils.padURLParameter(h.attr("href"),"fp",f))}}if(Authenticate.promoCouponCode){$("jsPromoCouponCode").find("input").removeAttr("disabled");$("input[name=couponcode]",e).val(Authenticate.promoCouponCode)}};Authenticate.addPostAuthenticateListener=function(e,f){Events.addListener(e,f)};Authenticate.isPostAuthentication=function(e){return !!d[e]};function a(){var l=document.location.hash;var h=l.indexOf(c);if(h!=-1){var i=l.substr(h+c.length,l.length);if(i){var k=decodeURIComponent(i).replace("%27","'");try{var f=JSON.parse(k);var g=f.eventName;var m=f.params||{};if(!g){throw"event name absent"}d[g]=m}catch(j){Utils.log("Something wrong happend during execute hash-callback, "+j)}}if(!($.browser.msie&&$.browser.version<9)){if(l.indexOf("&"+c)){h--}document.location.hash=l.substr(0,h)}}}function b(){for(var e in d){Events.fireEvent(e,d[e])}}a();$(function(){setTimeout(b,1)})})();(function(){Authenticate.showPopupSocial=function(a){$("body").css("cursor","wait");$.get("/web/login/simplePopup",function(d){$("body").css("cursor","");var c=PopupModule.popup({element:$("<div/>").html(d)});b(c,a)});function b(c,d){$("form.jsLoginForm",c).loginForm();$("#loginSide",c).bind("click focus",function(){$(this).animate({width:"298px"},400);$("#signupSide").animate({width:"198px"},400)});$("#signupSide",c).bind("click focus",function(){$(this).animate({width:"298px"},400);$("#loginSide").animate({width:"198px"},400)});$(".socialLoginBigButtons .gaClick").click(function(){Events.fireEvent("send.g.a",["SocialDownloads",$(this).attr("data-element")])})}}})();$(function(){(function(){$("form.jsLoginForm").loginForm()})();$(".jsSignOutLink").click(function(){var a=$(this).attr("returnTo");var b=document.location.hash;if(a&&a.length&&decodeURIComponent(a).indexOf("/web/q")>-1&&b.indexOf("#")!=-1){a+=b}document.location=a})});